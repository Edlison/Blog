{"meta":{"version":1,"warehouse":"3.0.2"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schedule.js","path":"js/schedule.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/images/man-32x32.png","path":"images/man-32x32.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/man-16x16.png","path":"images/man-16x16.png","modified":1,"renderable":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"4064502551f0eebbaf22c5e1fcb8be10a0a83fe0","modified":1633876141244},{"_id":"source/CNAME","hash":"6dbfbd4adf65c9db3b3a207892d9818bedbed9da","modified":1630471185210},{"_id":"themes/next/.eslintrc.json","hash":"9c0762486f24a8c5e60f8b6c875e4c4728942649","modified":1605115670147},{"_id":"themes/next/.editorconfig","hash":"8570735a8d8d034a3a175afd1dd40b39140b3e6a","modified":1605115670147},{"_id":"themes/next/.DS_Store","hash":"f02d676802b44685b8d4b0fd6ce9221fb2cb5ec0","modified":1634326436570},{"_id":"themes/next/.gitattributes","hash":"ec43734985e1cafd53d88ded3020103f7416123c","modified":1605115670147},{"_id":"themes/next/.gitignore","hash":"10fa9758d8f934669c1781564ed9ce83436b11f7","modified":1605115670151},{"_id":"themes/next/.npmignore","hash":"b5753ace1856548855d1f2c31c05da85781629e6","modified":1605115670151},{"_id":"themes/next/.stylintrc","hash":"2cf4d637b56d8eb423f59656a11f6403aa90f550","modified":1605115670152},{"_id":"themes/next/README.md","hash":"1fe48a23734bb659ee8a5f93070a4ab9c45c6b44","modified":1605115670152},{"_id":"themes/next/_vendors.yml","hash":"744133cdb17c7a91649c343d6e1a05d3d30854b9","modified":1605115670154},{"_id":"themes/next/LICENSE.md","hash":"63ea7df5a8dc1b23cc92ca9de3ed16d53367f360","modified":1605115670152},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1605115670154},{"_id":"themes/next/_config.yml","hash":"a5ae44bb9bad628d629f1eb34b790e364748ec45","modified":1634325607402},{"_id":"themes/next/package.json","hash":"4141b58d7146be5faa8deaf9c48f34c1885680f2","modified":1605115670191},{"_id":"themes/next/renovate.json","hash":"cb29cc16e61b0b8a6dac34657d76822ae29ad5aa","modified":1605115670191},{"_id":"source/_posts/.DS_Store","hash":"cd942a0cbc64e01feda6b55a00a9d8b227b70e2e","modified":1634327040757},{"_id":"source/_posts/hello-world.md","hash":"7d98d6592de80fdcd2949bd7401cec12afd98cdf","modified":1585887162264},{"_id":"source/_posts/test.md","hash":"05d22e07c79eb2204619636ae3ae99800876a403","modified":1625560277115},{"_id":"source/tags/index.md","hash":"bcfbebac036272d3fccada41e5f4dabdd9674018","modified":1605118532409},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"81dbb25800165f68c21859cd3c09276b9f4cc417","modified":1605115670148},{"_id":"source/categories/index.md","hash":"e0eb015d258169a1bbf2a140876a7cd8e8d23297","modified":1605118486603},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"eefd073dfb68884cd946f7ec6d3b3619031d7650","modified":1605115670148},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"3e9fbb78e3dee0ca1dc886d0c28b0148ba0ca499","modified":1605115670149},{"_id":"themes/next/.github/config.yml","hash":"7984e665e9de481a0e0e51fca5668337713f810b","modified":1605115670149},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"fca600ddef6f80c5e61aeed21722d191e5606e5b","modified":1605115670150},{"_id":"themes/next/.github/label-commenter-config.yml","hash":"1097fc47beeacfc1edb0248c27b17bf64bde3565","modified":1605115670150},{"_id":"themes/next/.github/labeler.yml","hash":"a45e489c62bf5bb5eb1866371af331b8cb9c6320","modified":1605115670150},{"_id":"themes/next/.github/release-drafter.yml","hash":"7662e31224a24154c4fe06b95ccbdff51ab8f2cc","modified":1605115670150},{"_id":"themes/next/.github/stale.yml","hash":"0e40b9975455152a690eaf7047135be348966e39","modified":1605115670150},{"_id":"themes/next/docs/AUTHORS.md","hash":"a648823121563c34a177ae91f5a774b5e29f01a0","modified":1605115670155},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1605115670155},{"_id":"themes/next/docs/LICENSE.txt","hash":"8ef5fc1147c196680b06e1accab80c8d236ab951","modified":1605115670155},{"_id":"themes/next/layout/_layout.njk","hash":"bf7e6ca826b6c3f85e14da61d56d7b836d2414c4","modified":1605115670164},{"_id":"themes/next/layout/archive.njk","hash":"08885f48d5878c92c910f8c41e3209eb07b9b80e","modified":1605115670189},{"_id":"themes/next/layout/category.njk","hash":"434fc2b27120ebae91522002eb40e16f2158bd4f","modified":1605115670190},{"_id":"themes/next/layout/page.njk","hash":"4f8f377e4f5511e27de1c2e4a1c13374b6a5d9bd","modified":1605115670190},{"_id":"themes/next/layout/index.njk","hash":"d8fa14549fa061e7bdba4ec1472cb45ecea96382","modified":1605115670190},{"_id":"themes/next/layout/.DS_Store","hash":"bfa6865ffdbbada83c42ae0d446232f46c22b29c","modified":1634325622109},{"_id":"themes/next/layout/tag.njk","hash":"09075c80b53b06826e7eb9ce838bca9dc363fac1","modified":1605115670191},{"_id":"themes/next/layout/post.njk","hash":"6abeb85fb3e4c382ed4bb6049b12a807e6226e67","modified":1605115670190},{"_id":"themes/next/languages/ar.yml","hash":"7a62243ec54196e3d1bea7364f05aded490bc234","modified":1605115670157},{"_id":"themes/next/languages/README.md","hash":"b2567e32805dda79601157351a07e5ca9fe01315","modified":1605115670157},{"_id":"themes/next/languages/de.yml","hash":"dc448f724c7d436233e9567711a09e0d56e60e3b","modified":1605115670157},{"_id":"themes/next/languages/default.yml","hash":"48a76170d70ef7c1fac96720bc5064b43061708d","modified":1605115670158},{"_id":"themes/next/languages/es.yml","hash":"c3506dfaa771e827ae6adb322477c6e835cd0f09","modified":1605115670158},{"_id":"themes/next/languages/fa.yml","hash":"649823297167b902455c0aec8ddebb462df71c7d","modified":1605115670158},{"_id":"themes/next/languages/en.yml","hash":"48a76170d70ef7c1fac96720bc5064b43061708d","modified":1605115670158},{"_id":"themes/next/languages/fr.yml","hash":"8ddfe98e7847ee8f1eaba9119f9fbdc42d7ec120","modified":1605115670159},{"_id":"themes/next/languages/it.yml","hash":"82a93c32b3fcf6517441cdc73f75bc6173beb392","modified":1605115670160},{"_id":"themes/next/languages/id.yml","hash":"ac018805190bc4bdc06091f5a6444e612fc700b0","modified":1605115670159},{"_id":"themes/next/languages/ja.yml","hash":"fec1e1c15ad2df7ed1249173cc719ccba6d3b842","modified":1605115670160},{"_id":"themes/next/languages/pt.yml","hash":"e0e2675261e2e80f7ce7d19c945c08217b068d81","modified":1605115670161},{"_id":"themes/next/languages/pt-BR.yml","hash":"47daeaa23c4db073e77761c9a6f62d3932af06ec","modified":1605115670161},{"_id":"themes/next/languages/nl.yml","hash":"0d3b56613197cb190900311507535db41daec7d4","modified":1605115670160},{"_id":"themes/next/languages/ko.yml","hash":"8342df2f4190ba4ee004b70d1d6ccd341033dbe7","modified":1605115670160},{"_id":"themes/next/languages/ru.yml","hash":"fdf5c623890db24cb56ab5ffe0c49db3542477c8","modified":1605115670161},{"_id":"themes/next/languages/tr.yml","hash":"54de3d8d85e3c7b14b163c3d322411b7301a09b3","modified":1605115670162},{"_id":"themes/next/languages/vi.yml","hash":"1f9657b58e11db21f93eb895c90123b8f91751a7","modified":1605115670162},{"_id":"themes/next/languages/uk.yml","hash":"1c9a0b8d8160c77cc62064207d57f460f365cae9","modified":1605115670162},{"_id":"themes/next/languages/zh-CN.yml","hash":"6f7c742316c96d5b71da50fddfb060ff7ec1ea99","modified":1605115670163},{"_id":"themes/next/languages/zh-HK.yml","hash":"149fccd0afdbc8db76e372cbc73d7b5f07bb7515","modified":1605115670163},{"_id":"themes/next/scripts/renderer.js","hash":"c53dbede2ad5f68d7349bc5ed8ac7157d723e987","modified":1605115670202},{"_id":"themes/next/languages/zh-TW.yml","hash":"d534f321ee0c235e1ebfea383eb1892bbd7d7e95","modified":1605115670163},{"_id":"themes/next/test/index.js","hash":"6bf0289846538be3e9a63809af98f00e1fbdd90b","modified":1605115670259},{"_id":"themes/next/source/.DS_Store","hash":"6a3a7261a70fdd8bb922026c528b720c4dc5bf10","modified":1630484797680},{"_id":"source/_posts/algorithm/[DP]LCS.md","hash":"a40a86341d28fc68a38da68a6ad5df12509d93f4","modified":1588091476026},{"_id":"source/_posts/anno_reflect/anno-start.md","hash":"84b916dbb7bd3d396ef1cdb613ed9996fa6421ec","modified":1612243431791},{"_id":"source/_posts/anno_reflect/reflect-anno.md","hash":"88fbdf865a4789843bf807dceb6df1aa9c067ccd","modified":1612253477630},{"_id":"source/_posts/anno_reflect/reflect-class.md","hash":"4bb17b43c9f26df0a62bd49b5148e475c2ff5999","modified":1612251442092},{"_id":"source/_posts/blockchain/blockchain.md","hash":"620823fd104d18b54caa80fc07a9060740933ecc","modified":1613993235027},{"_id":"source/_posts/anno_reflect/reflect-start.md","hash":"b02db2a3cfd54732c1aebc389e786737035b7c9a","modified":1612247781497},{"_id":"source/_posts/blockchain/consensus.md","hash":"4fffc67f4d8ba25f9eec01af62bdeecc0993fd91","modified":1614005706762},{"_id":"source/_posts/blockchain/eth-token.md","hash":"616d9aa7a13c13905ad07e6a3af5afe983489dbf","modified":1613995674803},{"_id":"source/_posts/algorithm/[DP]MSM.md","hash":"f8d87346318a166901fa612b3560120f39cce535","modified":1588080461421},{"_id":"source/_posts/blockchain/eth-dev.md","hash":"451c84dd6de70b6e7bfb6a1cb7a2e3c883d47134","modified":1614014104904},{"_id":"source/_posts/blockchain/ipfs.md","hash":"7f3e78f2dcdf80b718e2e47bfd0b9a1fef99e396","modified":1614006912259},{"_id":"source/_posts/blockchain/mine-start.md","hash":"274b09c090e1f75d6e972d79d05b0432a172e816","modified":1613980401246},{"_id":"source/_posts/blockchain/mine.md","hash":"820e0e7c4c820aaee1fb0b1573e07540ce2625c3","modified":1613998945925},{"_id":"source/_posts/cybersecurity/protocal-sec.md","hash":"ded3a3f9413db562eef89147395834ac415b3d95","modified":1615964644281},{"_id":"source/_posts/cybersecurity/tcpip.md","hash":"d27cea61bbb9509dfa4f61760bc24d3a5ca6a9a5","modified":1615225265988},{"_id":"source/_posts/design/abstractfactory.md","hash":"744f1c1929afa80ce36e5c914e9ed3e0ad012c66","modified":1611828720094},{"_id":"source/_posts/design/builder.md","hash":"b93cf317cf00f532c9384fbf70c996eeb9c4cdd7","modified":1612170447228},{"_id":"source/_posts/design/singleton.md","hash":"284c5473b6edd0a98221e6f34a16989e37bc4674","modified":1612174863470},{"_id":"source/_posts/docker/docker-anaconda.md","hash":"d198d5c2ca7e13afe00337f22b08de02d2af33e3","modified":1594740664196},{"_id":"source/_posts/docker/.DS_Store","hash":"cf06b447300b59d18e226a2eaef76bbd3598a7b3","modified":1611819600834},{"_id":"source/_posts/docker/docker-chevereto.md","hash":"206f9160f8b8c834fef9002c3e8110a4d921b993","modified":1594740664197},{"_id":"source/_posts/docker/docker-gitlab.md","hash":"980c818a2cb22dd66f1b10e8d9367ed236745a50","modified":1594740664197},{"_id":"source/_posts/docker/docker-compose.md","hash":"fc743fc01185b6b93addaa9d50c563f74f2bda90","modified":1633758078263},{"_id":"source/_posts/docker/docker-neo4j.md","hash":"83b2afb7027491cea60b8a6c5a01284fc995e445","modified":1628159279581},{"_id":"source/_posts/docker/docker-lineloss.md","hash":"a838639d461f30a766ca883a6c10c6adfc437f57","modified":1600260726402},{"_id":"source/_posts/docker/docker-v2ray.md","hash":"3def15adaf080e882d3eb1216dbedd4acfbef22a","modified":1613155909134},{"_id":"source/_posts/docker/docker-mariadb.md","hash":"52e2e52d602d3f0ccfd879ca1437dd4547dd45b1","modified":1627117336208},{"_id":"source/_posts/docker/docker-nextcloud.md","hash":"c03ca150d9868ea2067b6bded68307e40c827573","modified":1595699330486},{"_id":"source/_posts/docker/docker-nginx.md","hash":"dcf54d6078e1f3a76f86c1c3afcd25bb0ba10963","modified":1633796115154},{"_id":"source/_posts/deep_learning/BatchNorm.md","hash":"f6fe88fdabdc308912dc37766e2d80dc29214472","modified":1634326719034},{"_id":"source/_posts/deep_learning/.DS_Store","hash":"7dee8955889681b0441fb536fb424371c543b3cc","modified":1633876151569},{"_id":"source/_posts/docker/docker-wordpress.md","hash":"e29a79b95b63dcdea0b77ead1e7b1d1580ee29b3","modified":1614324453552},{"_id":"source/_posts/docker/docker.md","hash":"9bcbffde3a0563d592e1c39c4437726f8d9d4dca","modified":1614324428307},{"_id":"source/_posts/deep_learning/Conv.md","hash":"3b0ced604dfad500bdbac499ed698fe8376e2aff","modified":1634326713405},{"_id":"source/_posts/finance/exchange.md","hash":"656b333127b13f8dea6987c8519efc4f7bab0f5c","modified":1614065308318},{"_id":"source/_posts/deep_learning/Dropout.md","hash":"c1fb17bb57a2c8f63a063319141947e071a858cd","modified":1634326766296},{"_id":"source/_posts/deep_learning/teacher-forcing.md","hash":"b1899048b919b3aaad56920d2b83ab7bfd4fae84","modified":1634326697639},{"_id":"source/_posts/deep_learning/term.md","hash":"8e97c226ac110ca936316073441e34a655f34a0b","modified":1634326724528},{"_id":"source/_posts/finance/k-line.md","hash":"6b963e986815f3300ae53f835475a80e42b31951","modified":1614142258102},{"_id":"source/_posts/hadoop/hdfs.md","hash":"48cb87fb61e6154a4e31651daeb7a22f925dbbf0","modified":1611801828338},{"_id":"source/_posts/hadoop/mapreduce.md","hash":"41233fe071adc515e82522b4479ded742a0ac441","modified":1611803384552},{"_id":"source/_posts/hadoop/start.md","hash":"58688e64947a8bcd17e74ec75c31d78ec8013666","modified":1611742829762},{"_id":"source/_posts/leetcode/buystock.md","hash":"199cff89b3926b3ab667975b17c7f91f81932eba","modified":1583504758109},{"_id":"source/_posts/leetcode/binarysearch.md","hash":"442543b8a5dd1da9c42953f1118facf7074cefbc","modified":1584974987423},{"_id":"source/_posts/leetcode/addtwolist.md","hash":"26e8ef4f249d95ece6133faf7ad1aaf2952b4aef","modified":1583850890332},{"_id":"source/_posts/leetcode/buystockii.md","hash":"2e506b840e257481ff49aa908b86b9dd30944d2d","modified":1585144844970},{"_id":"source/_posts/leetcode/deletelistduplicates.md","hash":"ace04eca1e8823737a46c9f28ea76a486a80238e","modified":1583645403961},{"_id":"source/_posts/leetcode/deleteduplicates.md","hash":"3857861d98ee1296edbfd8ae344762958542fcfb","modified":1583417452263},{"_id":"source/_posts/leetcode/delivercookies.md","hash":"a90d1db971ee56fc91a5c1e9a9d87961de71ae89","modified":1585308335134},{"_id":"source/_posts/leetcode/gasstation.md","hash":"ce829cfb567f8d7b96f7d79884170c6638a0c501","modified":1585490757240},{"_id":"source/_posts/leetcode/jumpgame.md","hash":"c558376d2f9ea4707250994c51f7a6c0f3f3efef","modified":1585384950574},{"_id":"source/_posts/leetcode/hascycle.md","hash":"a2945f0917c9aed7593bfdcc563d112e9c89d941","modified":1583748213108},{"_id":"source/_posts/leetcode/inordertraversal.md","hash":"c84763d4978a8036b7adfcbbceaeea6ceb5d9570","modified":1584886504775},{"_id":"source/_posts/leetcode/longestsubstring.md","hash":"79a352ad9e59ccfd0fea4b9ea488976692d01328","modified":1584369218645},{"_id":"source/_posts/leetcode/longestpalindromicsubstring.md","hash":"00b4a7b733912896bf63baecd3296541500890c0","modified":1584459328371},{"_id":"source/_posts/leetcode/matching.md","hash":"d308363be28c16c56d3b84000d35310c462dc948","modified":1585628169849},{"_id":"source/_posts/leetcode/mergeklist.md","hash":"625821623717d44a92412179c467b4227a27e44b","modified":1584023319098},{"_id":"source/_posts/leetcode/maxdepth.md","hash":"11058c11751147212e4cf3c1491f1858c2e2ee7b","modified":1584806455240},{"_id":"source/_posts/leetcode/mostclose.md","hash":"941b536f660e1fb4a599fc2c90257c848fa03105","modified":1583417684440},{"_id":"source/_posts/leetcode/mergelist.md","hash":"defb04815fda5fec73e50065d38aca7b92a3aa68","modified":1583591423868},{"_id":"source/_posts/leetcode/recoverbinarytree.md","hash":"d6a110f2a8fec012a1dc18efae8ab11be8669e7d","modified":1585062686121},{"_id":"source/_posts/leetcode/maxpublicex.md","hash":"a15b5e01517441c66826bd642d194c9ae4d58330","modified":1584197949229},{"_id":"source/_posts/leetcode/removeelements.md","hash":"c02bbf6e5c6b1422f23ae1903623f1cfd8a4dcf8","modified":1583417433548},{"_id":"source/_posts/leetcode/regularexpressionmatching.md","hash":"b7ef39cf413cc07e129f0a47d66a8ac2cff6fadc","modified":1584538987639},{"_id":"source/_posts/leetcode/removeend.md","hash":"1235d109cb9583bea6504f3f56a93aec3974e1b7","modified":1583932794572},{"_id":"source/_posts/leetcode/romantointeger.md","hash":"f359924c1ffc67ec986ae7112e89e17953ceccb4","modified":1584092101403},{"_id":"source/_posts/leetcode/sametree.md","hash":"da85ebb35954b09944c196fab104aabe9c08ae12","modified":1584632932468},{"_id":"source/_posts/leetcode/substring.md","hash":"189b28ae94e0a08b7790d56d0b186623c339ae0b","modified":1585199189417},{"_id":"source/_posts/leetcode/twosum.md","hash":"22c305292094a5ac054241d3edcc5c751abc38f7","modified":1583417389594},{"_id":"source/_posts/leetcode/symmetric.md","hash":"af45d3fbbe1ebb292be96e8e6d9e6c94287b2db4","modified":1584716717023},{"_id":"source/_posts/leetcode/threesum.md","hash":"bd40c805256ec0488ded422ebfa7121b273b1b27","modified":1583417401139},{"_id":"source/_posts/linux/.DS_Store","hash":"94815b7fe7a7dc0a596a72ff8e83f0d5beeabdc0","modified":1611819539813},{"_id":"source/_posts/leetcode/validparentheses.md","hash":"97273171129bfc75372755d22221c01e9ceb80c5","modified":1584283606915},{"_id":"source/_posts/linux/linux-chmod.md","hash":"495142484013f0b14c2c82385b7914b51eacc142","modified":1611728310916},{"_id":"source/_posts/linux/linux-dir.md","hash":"de747b9dede3e825e3716dc9badc09a46f48c3fa","modified":1611888455889},{"_id":"source/_posts/linux/linux-brokenpipe.md","hash":"14ae328f6a26a1dc21a124fcd7531448b856e560","modified":1627126266111},{"_id":"source/_posts/linux/linux-firewall.md","hash":"7818e0586752f2e992118ae5c260a44d84a90d84","modified":1617758024543},{"_id":"source/_posts/linux/linux-host.md","hash":"f715def109a1748cfb69839e31d47fe477a102ad","modified":1615294775851},{"_id":"source/_posts/linux/linux-ftp.md","hash":"345d0b75adcb4ef0591bf09785a9b0818255c05b","modified":1611733037952},{"_id":"source/_posts/linux/linux-info.md","hash":"a384b1182be54f1af6b5bd0fba8c5e9f9427653f","modified":1611714209880},{"_id":"source/_posts/linux/linux-link.md","hash":"0fe7123d4dba34b61ee4eaff0340c245fd383874","modified":1611819048585},{"_id":"source/_posts/linux/linux-java.md","hash":"9fa7a2fd8badae8f323557c90d7d6a08b710bd5e","modified":1587123667903},{"_id":"source/_posts/linux/linux-mariadb.md","hash":"59b2839618c3350e1bdef9c5c9a61fd08c903be9","modified":1615316526972},{"_id":"source/_posts/linux/linux-path-1.md","hash":"400a4e5cc9c0d293c1ac3fdae792808e00af3189","modified":1611736508088},{"_id":"source/_posts/linux/linux-nohup.md","hash":"fb0207affee0d23afc04491dda759b6ae83b2e74","modified":1611626380771},{"_id":"source/_posts/linux/linux-port.md","hash":"8e671e481150aea4d4a402020f4ce3f77a9690c5","modified":1617759112495},{"_id":"source/_posts/linux/linux-path.md","hash":"7b129fd57cf08da10e23b09cb0061c7ec9d8094d","modified":1605118712709},{"_id":"source/_posts/linux/linux-redis.md","hash":"069c1f41df5fa6beda00a5d3f9ec0ea8365c6405","modified":1611222094800},{"_id":"source/_posts/linux/linux-systemd.md","hash":"ffa543b40a39955ae9f4ac9018d599793079f485","modified":1611728125794},{"_id":"source/_posts/linux/linux-ssh.md","hash":"f842751d31dc9f91577738a3cf6f3af125c6bd50","modified":1611904451612},{"_id":"source/_posts/magic/pass.md","hash":"e016b3ae8887c76e62279e14f78aa4af837eb1e0","modified":1617331708434},{"_id":"source/_posts/linux/linux-user.md","hash":"49ec7afdf74b8622e13fdad3ca121dacce1eb0c7","modified":1584536270275},{"_id":"source/_posts/matlab/path.md","hash":"dfa694fef5581dc797e16d131a25091ee83b07c4","modified":1629994951194},{"_id":"source/_posts/magic/cut.md","hash":"c3cb1e4e31126f0e6aaf2b4d4324f17c2c6bd5b6","modified":1617534315498},{"_id":"source/_posts/mlsec/.DS_Store","hash":"9d450b938119370b18e7f7354793991f77a779d9","modified":1589705179735},{"_id":"source/_posts/mlsec/KNN-手写体数字数据集.md","hash":"2e6bc7d700fd4eacd25a8262dbd729c271a1d87a","modified":1589704689444},{"_id":"source/_posts/mlsec/KNN-手动实现.md","hash":"2b79963f4ae5f83a77b8ef3099fae2410802eb0b","modified":1589704565677},{"_id":"source/_posts/mlsec/KNN-鸢尾花数据集.md","hash":"d251984091b8dd884220bf77fe5ae75004b2be43","modified":1589704629945},{"_id":"source/_posts/mlsec/Python-数据探索之可视化分析.md","hash":"6f57acc97d7e7a16bee7612f217463f38dca9f91","modified":1589704394793},{"_id":"source/_posts/notebook/Fluent-Python-1.18-1.md","hash":"a6a601a269947c3ddbbff7e5002d413f2802ae18","modified":1610959754710},{"_id":"source/_posts/notebook/.DS_Store","hash":"6c4c722195615296af8e000b0e17c13127610c30","modified":1611831299816},{"_id":"source/_posts/notebook/Fluent-Python-1.18.md","hash":"72029ed59fff201cc93f7fe3e968d2be9b16a367","modified":1610953359327},{"_id":"source/_posts/mlsec/使用-Pandas-进行数据探索.md","hash":"2ba917d97a97cc833c34eee786cce440c5491e5c","modified":1589704427773},{"_id":"source/_posts/notebook/Schedule.md","hash":"87a2814f22f8bb043191eb7ae1c9b9fced107fa6","modified":1611294381005},{"_id":"source/_posts/notebook/anaconda.md","hash":"c5c18f9fdaba5d8186bfd1ac24ee47f6c5824900","modified":1628165392619},{"_id":"source/_posts/notebook/anaconda-rename.md","hash":"aa83a3e8949ac00988e32ad19c69093d89af76bd","modified":1628167138519},{"_id":"source/_posts/notebook/aop.md","hash":"468a1aea4dda0658854b05dc9f3896466a87e5cd","modified":1583248621575},{"_id":"source/_posts/notebook/base64.md","hash":"1cfb557352521404ec34a88158287ed90f1722fb","modified":1625472337054},{"_id":"source/_posts/notebook/ce-start.md","hash":"b2e980fcafead2807e7918d3a440adad079219f1","modified":1613546593892},{"_id":"source/_posts/notebook/craftbrew.md","hash":"04538f15ceec5fa5c3861251fe1a0669996b6442","modified":1614868617555},{"_id":"source/_posts/notebook/design-pattern.md","hash":"b6b6ed6517bede995ca4b87ef3a364aa815169d1","modified":1583248030288},{"_id":"source/_posts/notebook/druid-pwd.md","hash":"6167544a2a3d6f0560e0795b04be2ea9a9e1e1df","modified":1615212642723},{"_id":"source/_posts/notebook/coffee.md","hash":"41d0814ecd13f21f64fb1026db89b160cf4419e9","modified":1614585464045},{"_id":"source/_posts/notebook/authentication_authorization.md","hash":"32648321df85087203eddd6d667f476e65a29492","modified":1634326622927},{"_id":"source/_posts/notebook/git-ssl.md","hash":"235b1360affdc1c8adb8d840921ef8c8d3088569","modified":1625660626856},{"_id":"source/_posts/notebook/final.md","hash":"e01e780c785366bfef7ffa01b86058bc93b1a95c","modified":1583943048039},{"_id":"source/_posts/notebook/flask-start.md","hash":"fcfab2593ee9fa2df47f0d521f026444cc81d520","modified":1609341735178},{"_id":"source/_posts/notebook/github-slow.md","hash":"85804f9b318dfdc49a56db05ebcf4cb48b04bb83","modified":1615737320577},{"_id":"source/_posts/notebook/gitignore.md","hash":"e02583c227d89f02cbe07e02afa2a274045f237a","modified":1616850777299},{"_id":"source/_posts/notebook/grpc.md","hash":"152d3ef19db8109d20b66679fef8c7e1322c699d","modified":1594740664198},{"_id":"source/_posts/notebook/git.md","hash":"0a5108fd3dc5f0669151c019e00ac9b6c0b93e36","modified":1605461965569},{"_id":"source/_posts/notebook/github-ssh.md","hash":"826555d4bb8bc3c11a422c650a81668c21991cd6","modified":1629492300232},{"_id":"source/_posts/notebook/idea-jdk-version.md","hash":"d6c3f50675b7c1674b9e09937d87608d21c62963","modified":1612279325414},{"_id":"source/_posts/notebook/hexo.md","hash":"ac905d1ef8b5b961ca5479f7c59a6b3e79b36a87","modified":1629490877782},{"_id":"source/_posts/notebook/guide.md","hash":"7ad38a8677b75b0738843e831a8c22c5b246893a","modified":1583243107262},{"_id":"source/_posts/notebook/ioc.md","hash":"325c96123479d7f5809613f8d876b1eb4e66a4b9","modified":1583248404424},{"_id":"source/_posts/notebook/innerclass.md","hash":"bee05382db6458d757395dfc246aaa7398d14553","modified":1583941951602},{"_id":"source/_posts/notebook/java-class.md","hash":"ce7ce86558b4e55f372c2c520610180e192f1ecf","modified":1586352574765},{"_id":"source/_posts/notebook/jupyter-kernel.md","hash":"2b3a5c96f90a2e0490b42197d004ede27570025b","modified":1604684321165},{"_id":"source/_posts/notebook/implements-extends.md","hash":"9a9043f618e2c30c3871e79cbc3b26e9cfe54f0c","modified":1583941732517},{"_id":"source/_posts/notebook/keycap.md","hash":"4c9167d2745e202c78f04928cf762cdcf2170e27","modified":1615302158218},{"_id":"source/_posts/notebook/live-bilibili.md","hash":"8684859e0a48728a3529ef0e9b961fe10d8481f2","modified":1613890956696},{"_id":"source/_posts/notebook/implements-extends-2.md","hash":"469e80c2e5fdd14ef62da1d3afd6185c58279268","modified":1600229659685},{"_id":"source/_posts/notebook/mysql-pwd.md","hash":"13070cb650ba6f7a3362205c29b45d9e6f3d30ea","modified":1617757128205},{"_id":"source/_posts/notebook/mac-shortcut.md","hash":"e2a474c6091df096a42e7c0d6c7a9aea6c3d7501","modified":1630208648206},{"_id":"source/_posts/notebook/mac-default.md","hash":"066e24add9cfd9a14ca9671bc72fb38eb02eb731","modified":1630208791847},{"_id":"source/_posts/notebook/nginx.md","hash":"84a8e2c6150f9d17ad876ad3d6b60748f298d624","modified":1633875708970},{"_id":"source/_posts/notebook/py-decorator.md","hash":"57239ae21d95a1b8ec4ee4e519cbfca34dcf400b","modified":1609350089911},{"_id":"source/_posts/notebook/py-*args**kwargs.md","hash":"876b8ef86b4683724a700b2983507ec351a57682","modified":1609347277837},{"_id":"source/_posts/notebook/notion.md","hash":"7bf5fa242444081a4436bed5be39c0accfffcf28","modified":1614444562501},{"_id":"source/_posts/notebook/pt.md","hash":"4fdc800de5a2101ba17537a2990cbfdf70cadbe6","modified":1633516570087},{"_id":"source/_posts/notebook/py-init.md","hash":"0f35867296db7cb605e8be0341d6fd1070246057","modified":1612977164618},{"_id":"source/_posts/notebook/py_sys_path.md","hash":"a49a3cfc87a8c356da84fbf9ba8bc74401972a88","modified":1622371592532},{"_id":"source/_posts/notebook/scala-start.md","hash":"ddea0d1b328b91517d225de7a47b7ea192e53287","modified":1611910789388},{"_id":"source/_posts/notebook/static.md","hash":"d4c7fa017b763da07c5a7d1655a4af038c4c99f7","modified":1583944899484},{"_id":"source/_posts/notebook/sh.md","hash":"98305d45bb2dca86c1f63715f71f2a472cc1bdd4","modified":1611137091562},{"_id":"source/_posts/notebook/tx-ubuntu.md","hash":"2d93a653c983c23b12abfdd2763826acb266e848","modified":1611891146790},{"_id":"source/_posts/notebook/sql.md","hash":"26fd7ed011f41a819dd9ad8a83f4329513e98f17","modified":1603721145038},{"_id":"source/_posts/notebook/tensorflow-start.md","hash":"d2a25e9561f0e8e5c0b0daa236528f6d4a56dd4c","modified":1634326743696},{"_id":"source/_posts/notebook/websocket-start.md","hash":"3e0b7a825d3989471fb9be5de41332512678ec2e","modified":1611309819073},{"_id":"source/_posts/notebook/vpn.md","hash":"98f43ad4656766d358f5bd87da449ed0f5837beb","modified":1614345170570},{"_id":"source/_posts/paper/paper-content.md","hash":"e5079b115590a2371ee98aeb5c1ad7915afc429a","modified":1629996251734},{"_id":"source/_posts/notebook/zotero.md","hash":"1be1c098103502a9b36b6c631baf1362c376b9ac","modified":1621676170604},{"_id":"source/_posts/ml/lesson1.md","hash":"8c04fe868561a9852434987851ff0b04e2279993","modified":1587739331514},{"_id":"source/_posts/paper_exp/batch.md","hash":"ff2175c14d0e51f400166c4b2ad898588d355ae0","modified":1612808589629},{"_id":"source/_posts/paper/paper-intro.md","hash":"c60e605497a6252cbab17f9d334a0ad8ca6092ca","modified":1629996686529},{"_id":"source/_posts/paper_exp/buildin.md","hash":"3e30c6c5f2b90c7bb817bf4e0d9bec543d0e596b","modified":1614933962722},{"_id":"source/_posts/paper_exp/features.md","hash":"0511e07e79c41391d750a02897945d25b88e0c87","modified":1623059964081},{"_id":"source/_posts/paper_exp/gan.md","hash":"786295e3f745b3404a53497b58fbef1632821cb0","modified":1612981896694},{"_id":"source/_posts/ml/numpy-training.md","hash":"025a6dd67dac727eeea48be52458a924ab08f278","modified":1587739561346},{"_id":"source/_posts/paper_exp/conv.md","hash":"dc7626adf9d6234098c8dae5da500713bd884caf","modified":1613190515246},{"_id":"source/_posts/paper_exp/logits.md","hash":"51ee742fdfaab358577139f69de48600ec0a342e","modified":1620734838173},{"_id":"source/_posts/paper_exp/loss.md","hash":"17177788f5ed970ca81c125c9fa1776ef363adec","modified":1613203524335},{"_id":"source/_posts/paper_exp/math.md","hash":"77b17b05926662538d573974fb6d1b9fa83cb499","modified":1614190204560},{"_id":"source/_posts/paper_exp/mv_gan.md","hash":"be2ad76aeea865fec91aa764fae8ca5c8a051a7f","modified":1614840685178},{"_id":"source/_posts/paper_exp/metric.md","hash":"15ad5cc0d2c75d3fa9e0fa1d028c8b7732791357","modified":1615631331445},{"_id":"source/_posts/paper_exp/mvadg.md","hash":"f5b70b720c1549f93be943955130175115ac25dc","modified":1615997684480},{"_id":"source/_posts/paper_exp/plt.md","hash":"01bf47797e5f3c117529d10547bb816178e48f7c","modified":1614844062792},{"_id":"source/_posts/paper_exp/tensor.md","hash":"9e51ffbc400463b53572625674cfc78c1c1ebfe6","modified":1615222427921},{"_id":"source/_posts/paper_exp/pt_save_load.md","hash":"116ffccb636d6a692c744e7f35c1211f852d6ba1","modified":1614840702467},{"_id":"source/_posts/paper_exp/pre_process.md","hash":"69c0d6acf5a96946110d3298c22512ac0ac1ba5e","modified":1623140612300},{"_id":"source/_posts/paper_exp/tensor_inplace.md","hash":"8cf2150688525f57915498205072d2e731ed223c","modified":1612894879928},{"_id":"source/_posts/paper_exp/tensor_shape.md","hash":"749547a3d281b98ce5df480c5e12fe5733c11bc6","modified":1612957912214},{"_id":"source/_posts/paper_exp/thoughts.md","hash":"fccdad43eedf328dbdf29df70c2e89dcae21b176","modified":1623135894091},{"_id":"source/_posts/paper_exp/torch_random.md","hash":"bb903fd7c24bb9b875271f7a763e382bcebde13c","modified":1614955522310},{"_id":"source/_posts/nlp/.DS_Store","hash":"27b8ddd1b06a7f7e318c68dfa63398ee5dd26d1d","modified":1605114932152},{"_id":"source/_posts/nlp/chatbot.md","hash":"02a97b81094d7ba071a3ab500fe9c5577fbdd284","modified":1627182864412},{"_id":"source/_posts/nlp/BERT.md","hash":"00cf07ef474fb10d8a96f5531892f59144dd9781","modified":1600870682838},{"_id":"source/_posts/nlp/week-1.md","hash":"0c1dca899bc23d470e2d97b0620a2d5e9fdf5b0f","modified":1611653112987},{"_id":"source/_posts/nlp/Transformer.md","hash":"10230243f3f59d4d0b734cd2ce768402320755d3","modified":1633876509158},{"_id":"source/_posts/nlp/word2vec.md","hash":"d6d569596bd119fc32b4223852c275572b5fe9c4","modified":1596431197005},{"_id":"source/_posts/nlp/week-2.md","hash":"d18c5cd75091d5e84499aaa709ba9dfb0975adac","modified":1597378232196},{"_id":"source/_posts/nlp/文本表示.md","hash":"1919ecd8a75c56d731df3be6c33df230588564fa","modified":1605112247196},{"_id":"source/_posts/paper_read/AnomalyDetectionViaRobust.md","hash":"8e6a0a22b6515b4a5dd3d3a0e33e8be3e06c9d9e","modified":1612417775465},{"_id":"source/_posts/paper_read/Attention-Transformer.md","hash":"e5f50fc77da7c805d792431f3daf381539321698","modified":1600436418024},{"_id":"source/_posts/paper_read/Attention.md","hash":"7fb1f7e04604e2c4fbe1d45264f4826be0fef0fd","modified":1612417768793},{"_id":"source/_posts/paper_read/XLNet.md","hash":"e35b40b8045b1b468ef8b968f16ea0244bc870d0","modified":1612417756689},{"_id":"source/_posts/paper_reprod/ClusterGAN.md","hash":"d594a644b724af33a3e8b72722bf8ab7b24e2627","modified":1612417686192},{"_id":"source/_posts/research/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1633875883555},{"_id":"source/_posts/spark/start.md","hash":"7b2207cd2cdebf199ff9e9836dbf175a9219f432","modified":1611891164040},{"_id":"source/_posts/spark/deploy.md","hash":"aab6b38d9dd83c733dd0b7fc75bb37de21e4a6ef","modified":1611904773671},{"_id":"source/_posts/paper_reprod/ClusteringGANSiamese.md","hash":"8dbcf41c4b959223349195c483f89b9ed498bc36","modified":1614427129735},{"_id":"source/_posts/spark/rdd.md","hash":"2e9051b0e4e5df38c635bf59ad9b03b03d9f360f","modified":1611914255868},{"_id":"source/_posts/spring/aop-proxy.md","hash":"4420ac401891ccd0a5dedea4b90fd44d0cfe23c5","modified":1612259609625},{"_id":"source/_posts/spring/aop-one.md","hash":"4a357a3afc47ffc51707a0803a842a76b1a76c80","modified":1612276464453},{"_id":"source/_posts/spring/aop-start.md","hash":"41605d76a481d2947abe807f7d1548f44358ce21","modified":1612255666891},{"_id":"source/_posts/spring/ioc-bean.md","hash":"0ab4db025443a98c8435e2c89d2ed31916dd819c","modified":1612228814574},{"_id":"source/_posts/spring/aop-three.md","hash":"87319787778bbb812ebfdd8920e4db5d17b1f4ef","modified":1612281490095},{"_id":"source/_posts/spring/aop-two.md","hash":"4d0d525bbccb2d5f3b2c84c1297216badfdf9f69","modified":1612277733362},{"_id":"source/_posts/spring/ioc-di.md","hash":"615fdf344e53014804af4a7a2108db7fbfe9fb14","modified":1612158102723},{"_id":"source/_posts/static/.DS_Store","hash":"97a11d1064453bc0ec154680f911a788a56d39c0","modified":1597543887597},{"_id":"source/_posts/spring/ioc-start.md","hash":"8d5788ad2c663f7d57a339f93dcc9bf69db721f5","modified":1612158002433},{"_id":"source/_posts/poets/deadpoetssociety.md","hash":"fd26237b1fa8f3cd85a915f9395a67affcd263db","modified":1611941080984},{"_id":"source/_posts/toefl/toefl-gona.md","hash":"a011cc698c49c5b2d3389d8254e3738651d82196","modified":1615632576472},{"_id":"source/_posts/toefl/toefl-l-bio-word.md","hash":"de229279e0f581d588b96a8313c2c3f7c287bb7c","modified":1615631459872},{"_id":"source/_posts/toefl/word-conn.md","hash":"563150280f508ba4c83ab68f7cd65877b20660bc","modified":1614348369975},{"_id":"source/_posts/toefl/toefl-conn.md","hash":"74ae973c5cdc6688255b65a712ec4e8db83f9bfb","modified":1618494811097},{"_id":"source/_posts/toefl/toefl-school.md","hash":"9602f3915002df6334265b7205883a3590605232","modified":1618367010445},{"_id":"source/_posts/toefl/toefl-socialmetavalue.md","hash":"0441c2f4d2d3295a26ff83cc90c84505a6c4faf9","modified":1634325768102},{"_id":"source/_posts/vim/vim-config.md","hash":"9216dce73b7df1365463eb693c3c000c20bdbe6a","modified":1627124912305},{"_id":"source/_posts/vim/vim-frequent.md","hash":"ca7cdf90b568dc700c05bd21b301489e8df4ba94","modified":1627125780916},{"_id":"source/_posts/vim/vim-mode.md","hash":"383b608c60709a89a60276f1024d95a3aaf13085","modified":1622108499203},{"_id":"source/_posts/vim/vim-nerdtree.md","hash":"146cd478a7121be182aa56be68337ff81583a0a3","modified":1627125562532},{"_id":"source/_posts/vim/vim-pymode.md","hash":"0b391c22157638418c28356ceecc8249f1a823d9","modified":1622118780064},{"_id":"source/_posts/vim/vim-start.md","hash":"a46f5f58fed82723f5bdaacd0a8e8a452d05dc17","modified":1622088014396},{"_id":"source/_posts/vps/aria.md","hash":"b94b218c210b846cd47df41268d9488ee624af07","modified":1634292610366},{"_id":"source/_posts/vps/cos.md","hash":"8e19082c1d61953bc0c5844ea45012f489e8dfe0","modified":1633890709310},{"_id":"source/_posts/vps/docker.md","hash":"b255107d59cd6e966e78c1babe231d78fc33d843","modified":1633930092112},{"_id":"source/_posts/vps/first-conf.md","hash":"1857732a8f96f41e1c4442478d14413a8cdc77d8","modified":1633928773287},{"_id":"source/_posts/vps/bbr.md","hash":"07dae1da74adca194f01fb1be442cdb3030da616","modified":1633770527883},{"_id":"source/_posts/vps/git+hook.md","hash":"c5d15d84d59da7492f9e882a86328409b83e7fdb","modified":1633875715832},{"_id":"source/_posts/vps/nginx.md","hash":"2eaa73d5c7b5585c963b962bdf1ef1c1301a8986","modified":1633875713274},{"_id":"source/_posts/vps/freenom-auto.md","hash":"dd37475eca3c4af5b102d114bb2e816e4261c744","modified":1634107132657},{"_id":"source/_posts/vps/gihubactions.md","hash":"f543f235800efe4d7815016ea5a323f236b20e55","modified":1634306943859},{"_id":"source/_posts/vps/performance.md","hash":"6af08b1fd79cf7920d9195bf35bd2cecee952624","modified":1633753255505},{"_id":"source/_posts/vps/rclone.md","hash":"625174fcf5c7d77a85dae943e5c61fd00b22f718","modified":1634276610017},{"_id":"source/_posts/vps/usage.md","hash":"3f10d44922de7430873b6b924577d9f03361852e","modified":1633861350591},{"_id":"source/_posts/vps/v2ray-lite.md","hash":"fed11286b47b5cd7e925157f5c6f93aeac3042db","modified":1633795957280},{"_id":"source/_posts/vps/v2ray-xui.md","hash":"293055158a024c40ad2286c1496b2f0a170a54be","modified":1633795974088},{"_id":"source/_posts/v2ray/v2ray-tls.md","hash":"1386b4d7266d4c21ac7b6b9ab2563aefc3936825","modified":1585507109021},{"_id":"source/_posts/v2ray/v2rayu.md","hash":"56672cab3019d6d2353a2dbedb5314d909ff8b96","modified":1633764736406},{"_id":"source/_posts/v2ray/v2ray.md","hash":"baafa7c679eaa30cf4f076a1a0d26d3466469c9a","modified":1585982497742},{"_id":"source/_posts/web/socketio.md","hash":"299c5050bc7c5aa30be8df575535c1e28752a89f","modified":1625978039880},{"_id":"source/_posts/web/http.md","hash":"3b163e9459f3f8216a5df183b657c866b6927f36","modified":1625994697525},{"_id":"source/_posts/web/socketio-dev.md","hash":"d7cc2ec4be43836b51557c5bd4af42043385b4c5","modified":1626147567318},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"b47f529d059ef337b4f14ddf746c3a42744028f0","modified":1605115670149},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"fc4dce84ed9a5d21d3a8833ff6d776c46f876115","modified":1605115670148},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"4ecac91716eac59d7c2bc53cf6e95612d44da97b","modified":1605115670149},{"_id":"themes/next/.github/ISSUE_TEMPLATE/question.md","hash":"d0d16ae88623d33946c16cfb68beb6ecab1ba69b","modified":1605115670149},{"_id":"themes/next/.github/workflows/labeler.yml","hash":"3acd5189488e720f23e904f2d9d24cf4b15ac1de","modified":1605115670151},{"_id":"themes/next/.github/workflows/label-commenter.yml","hash":"b6d8162264dc4d6d31f1f9c2a940718f12cff874","modified":1605115670150},{"_id":"themes/next/.github/workflows/linter.yml","hash":"f499ad31aea9ec598308475ef0b19b7e4177103c","modified":1605115670151},{"_id":"themes/next/.github/workflows/lock.yml","hash":"70bd0be3f33774e4b0ada3a59c901f8f9cff1013","modified":1605115670151},{"_id":"themes/next/.github/workflows/release-drafter.yml","hash":"4f3af81009cb922be91f718a67425377515ea69d","modified":1605115670151},{"_id":"themes/next/.github/workflows/tester.yml","hash":"3a740e76151cc0a696273594731d7864a8db5374","modified":1605115670151},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"0e204dde6d21f100cba6ca7751de71848490759e","modified":1605115670156},{"_id":"themes/next/docs/zh-CN/README.md","hash":"040de4b35cf548d265b1bd85c60ca699b12acf3a","modified":1605115670156},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"8ee5ca39ac4a372a5c0f16e344bbe578af4aeae4","modified":1605115670156},{"_id":"themes/next/layout/_macro/post-collapse.njk","hash":"1a30d751871dabfa80940042ddb1f77d07d830b9","modified":1605115670165},{"_id":"themes/next/docs/ru/README.md","hash":"618709b37699088b8758a60b58a8548e3609144a","modified":1605115670155},{"_id":"themes/next/layout/_macro/sidebar.njk","hash":"c0a843a3019f0bb8f2e734dc173028ead732b3c0","modified":1605115670166},{"_id":"themes/next/layout/_macro/post.njk","hash":"0a6e47fc04d211c416e00119011f7614d98c31cf","modified":1605115670165},{"_id":"themes/next/layout/_partials/footer.njk","hash":"44060deff92a8fe331548dafeb27e5c188a8a6c2","modified":1605115670167},{"_id":"themes/next/layout/_partials/comments.njk","hash":"334e8d8117a46c8c097788811322a62627952219","modified":1605115670167},{"_id":"themes/next/layout/_partials/.DS_Store","hash":"6e01d697c8ec7a53c01e388bc69c3bfef2724f51","modified":1629488053600},{"_id":"themes/next/layout/_partials/languages.njk","hash":"ba9e272f1065b8f0e8848648caa7dea3f02c6be1","modified":1605115670173},{"_id":"themes/next/layout/_partials/pagination.njk","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1605115670176},{"_id":"themes/next/layout/_partials/widgets.njk","hash":"24eb5b683310810f93c1d7f68f8f70f1a29fd217","modified":1605115670180},{"_id":"themes/next/layout/_scripts/index.njk","hash":"48cbbca0e4f97b8c25f2a5c408071603cd257a65","modified":1605115670180},{"_id":"themes/next/layout/_scripts/baidu_push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1634325703576},{"_id":"themes/next/layout/_scripts/noscript.njk","hash":"4f250d0bf80be06dd2c95c1d4c2ba2624b59cf2a","modified":1605115670180},{"_id":"themes/next/layout/_scripts/pjax.njk","hash":"28a3bcb1ce50924a5a48b0f3756ac3a8736867f1","modified":1605115670181},{"_id":"themes/next/layout/_scripts/vendors.njk","hash":"bada07da2a47ed6de6081796367b19dd9e906cfb","modified":1605115670181},{"_id":"themes/next/layout/_third-party/baidu-push.njk","hash":"8627c8c8b031ecee16c522433b66fa4d6979b8ea","modified":1605115670182},{"_id":"themes/next/layout/_third-party/index.njk","hash":"4ca039707745c6a22615741b7411ff2cb0763e6d","modified":1605115670184},{"_id":"themes/next/layout/_third-party/nprogress.njk","hash":"271139c3896a6d294f46f767cb21b2e848050841","modified":1605115670185},{"_id":"themes/next/layout/_third-party/quicklink.njk","hash":"294b7f6a4fa566e369d8be0ce7b28f35b6c14563","modified":1605115670185},{"_id":"themes/next/layout/_third-party/rating.njk","hash":"2731e262a6b88eaee2a3ca61e6a3583a7f594702","modified":1605115670185},{"_id":"themes/next/scripts/events/index.js","hash":"89091bc943cd8b8c63b8af3d26fb0a027048e9ba","modified":1605115670192},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"872f01cb10e422a648ea505436532e776e92926b","modified":1605115670198},{"_id":"themes/next/scripts/filters/locals.js","hash":"fa1e558f058f93455acdd553ab1be30b26f137e4","modified":1605115670199},{"_id":"themes/next/scripts/filters/minify.js","hash":"be0574c64a38210e449c99d38a760452015060a3","modified":1605115670199},{"_id":"themes/next/scripts/filters/post.js","hash":"bac5646993153f9f6a630c9f0052bb17fa760a9c","modified":1605115670199},{"_id":"themes/next/scripts/helpers/font.js","hash":"9cf01a3cf62d9b5a1a0db8145088774bf94045c8","modified":1605115670200},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"413c51fa3caa87fe95d1d8f95e6023f096515632","modified":1605115670201},{"_id":"themes/next/scripts/helpers/engine.js","hash":"682a8e16b5182c123c96b04222d967407e1fd6d6","modified":1605115670200},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"577c510374cf9bcfa8d3a1027e42411a9324805e","modified":1605115670201},{"_id":"themes/next/scripts/helpers/next-vendors.js","hash":"afdd6a188a74c188f0dd154fac70efd4080ca262","modified":1605115670201},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"935a311142a409c1896b3ae3f01fe7a9e2db1134","modified":1605115670203},{"_id":"themes/next/scripts/tags/button.js","hash":"c6ad2ed544fbb25ecb5d820c36e76302504271b7","modified":1605115670202},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"92c19d796bdb3320df9caea59bf52df7a95d9da9","modified":1605115670203},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"9836e3212f889e94ada4c354c7b83f7d7caa9aa7","modified":1605115670204},{"_id":"themes/next/scripts/tags/index.js","hash":"17f9451ce1f10f78437f52218757d38d4e1591b0","modified":1605115670204},{"_id":"themes/next/scripts/tags/label.js","hash":"8a73348186113bae0a51ea2f891c1bb882fab05a","modified":1605115670206},{"_id":"themes/next/scripts/tags/link-grid.js","hash":"9e2c58d1a4d1dd84fa86144e5b4576b2fd10a37f","modified":1605115670207},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"464effc08e757ce8e1bb094707d06ad829af9d62","modified":1605115670207},{"_id":"themes/next/scripts/tags/note.js","hash":"7b94ddb46b7d4b0fe815f2fbe4bd375f07f55363","modified":1605115670209},{"_id":"themes/next/scripts/tags/pdf.js","hash":"27129fc4014d723ba93ac77b11342da2ee445d96","modified":1605115670209},{"_id":"themes/next/scripts/tags/tabs.js","hash":"2bf00d56b3b289a7dd27e9b5820430a2457a19f3","modified":1605115670210},{"_id":"themes/next/scripts/tags/video.js","hash":"2ee926448583be8f95af1f2884ae2c9c4830151d","modified":1605115670211},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1605115670247},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1605115670247},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1605115670247},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1605115670247},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1605115670247},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1605115670248},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1605115670248},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1605115670249},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1605115670249},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1605115670249},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1605115670250},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1605115670250},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1605115670250},{"_id":"themes/next/source/js/algolia-search.js","hash":"7c6c966cdbe6e46d5f885606b0b9daf2ea3f757d","modified":1605115670251},{"_id":"themes/next/source/js/bookmark.js","hash":"e45e1fbb7c6d645e9c410759486216e570d02bef","modified":1605115670251},{"_id":"themes/next/source/js/local-search.js","hash":"9f4fe7bbe0f16be72d26ccb8b22bd33767f83cff","modified":1605115670251},{"_id":"themes/next/source/js/motion.js","hash":"6d4bd07a6f8e1b4083119dca0acb5b289533b619","modified":1605115670251},{"_id":"themes/next/source/js/next-boot.js","hash":"c2a04055d8edec03dc74e1c45d83bd3b51467de0","modified":1605115670252},{"_id":"themes/next/source/js/schedule.js","hash":"ababd67895ce49049271601c6928fce56a1c6bbb","modified":1605115670252},{"_id":"themes/next/source/js/utils.js","hash":"bc4217f9779b81c0f56de985c46d73c21d3992d5","modified":1605115670252},{"_id":"themes/next/source/css/_colors.styl","hash":"b37f9847d2f95632e911df670b51921a7d748068","modified":1605115670211},{"_id":"themes/next/source/images/man-32x32.png","hash":"210e98985f58e7707e6ea51b7dcf25b3ebc50335","modified":1629485912471},{"_id":"themes/next/source/images/man-16x16.png","hash":"7a44c1ab8a00f93d6b8901e69f3d72ec632a187b","modified":1629485892101},{"_id":"themes/next/source/css/main.styl","hash":"766d406beffa0c2cdbd64518262286baaeb8ec3b","modified":1605115670246},{"_id":"themes/next/test/helpers/font.js","hash":"8930b1f16facc18dc6764bf6efd753ca50d3f1cb","modified":1605115670259},{"_id":"themes/next/source/css/_mixins.styl","hash":"b9c3d3087a917c94cf34ffd6621528d377af8fc9","modified":1605115670240},{"_id":"themes/next/test/helpers/index.js","hash":"63ba28afed697f7b3574436b1133b8ecc9c0c357","modified":1605115670259},{"_id":"themes/next/test/helpers/next-url.js","hash":"abc4ee5149df6172b2c36b6e85d1993ec748ddea","modified":1605115670259},{"_id":"themes/next/test/tags/button.js","hash":"48f2aa4c513e9e24bd6a811410520b74cd7ea88b","modified":1605115670259},{"_id":"themes/next/test/tags/caniuse.js","hash":"aa5e728445caeaf7c2ccd0f3fcb2cad0c93ca6d1","modified":1605115670260},{"_id":"themes/next/test/tags/center-quote.js","hash":"7667342fd1a1417eaf6a254012b84ae40e8d13dd","modified":1605115670260},{"_id":"themes/next/test/tags/group-pictures.js","hash":"caf9f6b9a72e41fb30aa24468a54496fba1fcdd8","modified":1605115670260},{"_id":"themes/next/test/tags/label.js","hash":"4ebf3698c258ca978b997acbdd0dece44069c09d","modified":1605115670260},{"_id":"themes/next/test/tags/link-grid.js","hash":"88ec69e4dc1d493d21254ed9296a2514e91f0f8b","modified":1605115670260},{"_id":"themes/next/test/tags/index.js","hash":"e8779e54f0979b221858f8bb74dd081bb503b910","modified":1605115670260},{"_id":"themes/next/test/tags/mermaid.js","hash":"ed5b5a70ee49842501c952c4d62483f1fc8eba6b","modified":1605115670261},{"_id":"themes/next/test/tags/note.js","hash":"3dcfcd65bf9f326972ea7571fdb1444200f5d07e","modified":1605115670261},{"_id":"themes/next/test/tags/pdf.js","hash":"bac003317e5bb5e046848522c5c4a7cf231e53f6","modified":1605115670261},{"_id":"themes/next/test/tags/tabs.js","hash":"d63722919f9da2e44d6b952801e10a2915ea9c12","modified":1605115670261},{"_id":"themes/next/test/tags/video.js","hash":"b796fc4dceb20a30e730c322bb5474c0162464cc","modified":1605115670262},{"_id":"themes/next/test/validate/index.js","hash":"ef716c1db8e3c93c320f73b6da4010e03b4eb0ae","modified":1605115670262},{"_id":"source/_posts/mlsec/data/.DS_Store","hash":"d493f8e83ec63243343c074b027dcc9cc74c5b5f","modified":1589704659245},{"_id":"source/_posts/mlsec/data/output_25_1.png","hash":"0648266b0bf1df9a3e0fdee4663945bcf89dedb7","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_21_1.png","hash":"c402e492afa55fca78557c35d8d434464c58d2b0","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_28_1.png","hash":"89607d01397ded8dbdcc93cc3dd141b37abdb23f","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_34_1.png","hash":"9e3e999abb92eb89146cd62cfd3b1b549b98d130","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_26_1.png","hash":"879cf7e4bd006d538d1ea437e3eaccdd3067b6a2","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_53_1.png","hash":"adf77d67f4d1d6f5978d196b526c241317f248f2","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_63_1.png","hash":"0d72c8768730bf6008de6378df3620b7a7761631","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_39_1.png","hash":"e2e9a3464ad43115cb308c96219f4a03e55152ef","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_5_1.png","hash":"17b31774639e266a22506a4ca588f599942d62df","modified":1589704640000},{"_id":"source/_posts/mlsec/data/output_65_1.png","hash":"0175b954aa2a822f46f51c94da907247350628e8","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_6_1.png","hash":"8bb3b77b4182b7c17e2166cc0ef6c0375951e64d","modified":1589704474000},{"_id":"source/_posts/mlsec/data/output_70_1.png","hash":"5f5ee1ca87341dc21c2a2b0916cdebce063361b8","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_72_1.png","hash":"d7a85134942a84c65d8c4f58511fe0fdf80b3d8f","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_67_1.png","hash":"20febf271e0ff3e0cf578252e49b06af10462ddc","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_75_1.png","hash":"99b192e1b78dcaeb79329a885fb50eff4413c36f","modified":1589704068000},{"_id":"source/_posts/mlsec/data/output_79_1.png","hash":"175deb3129a61cf4789d2195857cf25385f13609","modified":1589704068000},{"_id":"source/_posts/mlsec/data/output_7_0.png","hash":"443ed4f848652228f9899f1160b5038074c804e8","modified":1589704474000},{"_id":"source/_posts/mlsec/data/output_79_2.png","hash":"5287330dc54f6d966c3e0e1a8d3e7f4b60450420","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_83_1.png","hash":"22a311dcd2f45b99309a40900824d986e26bd591","modified":1589704068000},{"_id":"source/_posts/mlsec/data/output_85_1.png","hash":"9feb1860282cb74eb10d377310460e756c4e651c","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_82_2.png","hash":"ea643f8d12702935f12e19bef2272bf1a5465b68","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_89_1.png","hash":"5a9295df4489b6e4e42cf2d35e66fc8d025fefc8","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_94_1.png","hash":"622170fb4e7d4fa18014f6c128290eca61a5c03e","modified":1589704084000},{"_id":"source/_posts/mlsec/data/output_97_1.png","hash":"3510cda9b59defe04da9aabb126b9cd714216bd0","modified":1589704084000},{"_id":"source/_posts/ml/data/lesson1.py","hash":"ec39ad95a26a3df61a8e2be0b0afb6d61bc52e6d","modified":1586966440473},{"_id":"source/_posts/ml/data/housing.data","hash":"adfa6b6dca24a63fe166a9e7fa01cee4335857d1","modified":1586959784585},{"_id":"source/_posts/static/img/.DS_Store","hash":"832a2efbab91c085f4fdc711ed80c9da55600e95","modified":1597544936798},{"_id":"source/_posts/static/img/1.png","hash":"538585e9318102bbf196a06b932f2adeafe328a4","modified":1583503383374},{"_id":"source/_posts/static/img/container.jpeg","hash":"a898204b411c074616cd52cdccb8c38cb8050a09","modified":1583747782498},{"_id":"themes/next/layout/_partials/head/head-unique.njk","hash":"37bdf020591feb0cf72327c9efd755bf78a0afd6","modified":1605115670168},{"_id":"themes/next/layout/_partials/head/head.njk","hash":"e8a73353f1343d2354b1612bf9dbb3b41085a8ed","modified":1605115670169},{"_id":"themes/next/layout/_partials/header/brand.njk","hash":"c082a16163d1fb5d7cf858fb7522fca9d18f1ba6","modified":1605115670170},{"_id":"themes/next/layout/_partials/header/index.njk","hash":"53895b3af95667edc5bf5d7356f8a2b4fe091447","modified":1605115670171},{"_id":"themes/next/layout/_partials/header/menu-item.njk","hash":"61eec1fb84711369b9dabd1d2cae64858844c2eb","modified":1605115670172},{"_id":"themes/next/layout/_partials/header/sub-menu.njk","hash":"75a158a5b54a3a76ee6590f5e0e2dd4a9f0be869","modified":1605115670172},{"_id":"themes/next/layout/_partials/header/menu.njk","hash":"c9390824b57f23b7c8a5c23a9834514123673766","modified":1605115670172},{"_id":"themes/next/layout/_partials/page/breadcrumb.njk","hash":"edb3bb6d644b7407673c5ef3a426a244e98fcf89","modified":1605115670173},{"_id":"themes/next/layout/_partials/page/categories.njk","hash":"17156d99941f28a225951ffdcfa9a115e20dc2d2","modified":1605115670174},{"_id":"themes/next/layout/_partials/page/page-header.njk","hash":"789915339a6234d6dd7c710cc1f8e728d9b81d35","modified":1605115670174},{"_id":"themes/next/layout/_partials/page/tags.njk","hash":"a18d1598e36cc72f2b0b24c3cc3c5990dfaa3254","modified":1605115670175},{"_id":"themes/next/layout/_partials/page/schedule.njk","hash":"9d650333160ad1977fe42d9770869ff1660a95fe","modified":1605115670175},{"_id":"themes/next/layout/_partials/post/post-copyright.njk","hash":"133942922e34abae9e4de7ea5591d77c0caa4b37","modified":1605115670176},{"_id":"themes/next/layout/_partials/post/post-followme.njk","hash":"154df0bb323c332d8c25343f258ee865e5553423","modified":1605115670177},{"_id":"themes/next/layout/_partials/post/post-meta.njk","hash":"fbdb5cdbd80970f201f5c75369eaa00aea369235","modified":1605115670177},{"_id":"themes/next/layout/_partials/post/post-footer.njk","hash":"8f14f3f8a1b2998d5114cc56b680fb5c419a6b07","modified":1605115670177},{"_id":"themes/next/layout/_partials/post/post-related.njk","hash":"f79c44692451db26efce704813f7a8872b7e63a0","modified":1605115670178},{"_id":"themes/next/layout/_partials/search/algolia-search.njk","hash":"c2ccaac9caeea1a43dc31f4f8368f8f548aab0af","modified":1605115670178},{"_id":"themes/next/layout/_partials/search/index.njk","hash":"b7a66a465e897c27624f0c441375c95c4cb7a5aa","modified":1605115670179},{"_id":"themes/next/layout/_partials/search/localsearch.njk","hash":"90156f42d6e6e326ed38482d6623a0aac0352016","modified":1605115670179},{"_id":"themes/next/layout/_partials/post/post-reward.njk","hash":"a9bb52d0537d27cfe670d80e716da6780786ab8a","modified":1605115670178},{"_id":"themes/next/layout/_partials/sidebar/site-overview.njk","hash":"c419158e19805e2db614a5f5651e3e534e4a5e4e","modified":1605115670179},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.njk","hash":"4790058691b7d36cf6d2d6b4e93795a7b8d608ad","modified":1605115670182},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.njk","hash":"ad197fd728dd7ac90f910fdf80ce848eab3ff187","modified":1605115670182},{"_id":"themes/next/layout/_third-party/analytics/growingio.njk","hash":"5adea065641e8c55994dd2328ddae53215604928","modified":1605115670182},{"_id":"themes/next/layout/_third-party/analytics/index.njk","hash":"d87df68dff14cfb4d91a77230cd1ac795c2a22d5","modified":1605115670182},{"_id":"themes/next/layout/_third-party/chat/tidio.njk","hash":"cba0e6e0fad08568a9e74ba9a5bee5341cfc04c1","modified":1605115670183},{"_id":"themes/next/layout/_third-party/chat/chatra.njk","hash":"f910618292c63871ca2e6c6e66c491f344fa7b1f","modified":1605115670182},{"_id":"themes/next/layout/_third-party/comments/disqusjs.njk","hash":"54eab4840443262432ec7c47e56e9859ace2a902","modified":1605115670183},{"_id":"themes/next/layout/_third-party/comments/disqus.njk","hash":"cc1450d62d76e59968bdd25836694b8339207384","modified":1605115670183},{"_id":"themes/next/layout/_third-party/comments/changyan.njk","hash":"5c2cd9b6f02bcb6248d3f18638a58e329fe8c0d1","modified":1605115670183},{"_id":"themes/next/layout/_third-party/comments/valine.njk","hash":"72d7abe567fab181725d120cb27eb6a6379611ea","modified":1605115670184},{"_id":"themes/next/layout/_third-party/comments/livere.njk","hash":"6252b0353c6a36d03c68ebec1073293442221bd1","modified":1605115670183},{"_id":"themes/next/layout/_third-party/comments/gitalk.njk","hash":"ec0474e23ca122b34858ffb0bb8c99f241749c61","modified":1605115670183},{"_id":"themes/next/layout/_third-party/math/index.njk","hash":"b0efe26601037e621b5cb16f0fe2f347ee27acdb","modified":1605115670184},{"_id":"themes/next/layout/_third-party/math/katex.njk","hash":"b6746dfad32cc8a46ff8f4194a7a16ca41744803","modified":1605115670184},{"_id":"themes/next/layout/_third-party/math/mathjax.njk","hash":"a8239f99b316e6c060bad8173be3a25c67138697","modified":1605115670184},{"_id":"themes/next/layout/_third-party/search/localsearch.njk","hash":"767b6c714c22588bcd26ba70b0fc19b6810cbacd","modified":1605115670186},{"_id":"themes/next/layout/_third-party/search/algolia-search.njk","hash":"97035261aa85c7d39c6ce1211cdefc6248c0446d","modified":1605115670185},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"a4bc501da0f22f7e420f0ca47e83988ce90b1368","modified":1605115670187},{"_id":"themes/next/layout/_third-party/statistics/cnzz-analytics.njk","hash":"a17ace37876822327a2f9306a472974442c9005d","modified":1605115670187},{"_id":"themes/next/layout/_third-party/search/swiftype.njk","hash":"ba0dbc06b9d244073a1c681ff7a722dcbf920b51","modified":1605115670186},{"_id":"themes/next/layout/_third-party/statistics/firestore.njk","hash":"8635b13aa1092c22252af4743fa194272f089b59","modified":1605115670188},{"_id":"themes/next/layout/_third-party/statistics/index.njk","hash":"8b956fb56284e8fa4a4731b1efd1f25e1b2b4a78","modified":1605115670188},{"_id":"themes/next/layout/_third-party/tags/pdf.njk","hash":"67d80a57f6b2cf23d56276ca8f30f25e3e8707e9","modified":1605115670189},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.njk","hash":"811a3ad58c0a15550100bdc199bef8add1ad526c","modified":1605115670188},{"_id":"themes/next/layout/_third-party/tags/mermaid.njk","hash":"007da98b913a62946c03a87f8fa25b3db856caa1","modified":1605115670189},{"_id":"themes/next/scripts/events/lib/config.js","hash":"5a1dd04ea7124494110b3c79f9880f55d899977b","modified":1605115670192},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"7b0ea8d28ced63977dc6539920eb044b1098adcb","modified":1605115670194},{"_id":"themes/next/scripts/events/lib/utils.js","hash":"e227174a8ebab8d5b6e8e26faf4fd66c43f045ca","modified":1605115670194},{"_id":"themes/next/scripts/events/lib/vendors.js","hash":"f76c7e13fc4304f86260068c9d83d3477b64ee4b","modified":1605115670194},{"_id":"themes/next/scripts/events/lib/highlight.js","hash":"6aec7b2c38c50989a23bfaa0d560e75c7f553e12","modified":1605115670193},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"199fa9a70914d0019cf0e47f55491183d53d1533","modified":1605115670195},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"2486f3e0150c753e5f3af1a3665d074704b8ee2c","modified":1605115670196},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"93ee5f9109dad885dc38c49bcee630c10f9dce6e","modified":1605115670196},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"a9b18b7447cd5a56cb692c574463a27356eb7fa6","modified":1605115670197},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"387e59cd396c62fe095b388c8ff8d4191cfbdeb9","modified":1605115670197},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"7b8ce8e9a71cf083f5337fb7c9586be8f7c316e8","modified":1605115670197},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"1198cb63375a53400431c2e65e3361416cdf8eb6","modified":1605115670198},{"_id":"themes/next/scripts/filters/comment/valine.js","hash":"c67984fc868d4799b3aa6d3b3cd060e5260b3a98","modified":1605115670198},{"_id":"themes/next/source/js/schemes/muse.js","hash":"d7a6c12bb534810eb748d0ba28aff67cccf0bb3f","modified":1605115670252},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"f4e694e5db81e57442c7e34505a416d818b3044a","modified":1605115670245},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"77dddb398fb1beefc2b824bec7b094030fdc3df9","modified":1605115670245},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"e3be898f5ebcf435a26542653a9297ff2c71aeb0","modified":1605115670245},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"c65536a128b9bc9dbe2fbb1b235a3cded2891002","modified":1605115670246},{"_id":"themes/next/source/css/_variables/base.styl","hash":"efbeee48d208a3960b4e352fab3feb2b2dab7ef8","modified":1605115670246},{"_id":"source/_posts/ml/data/lesson1.ipynb","hash":"71b5b2e8b65b4488616d055f067fa66df298643b","modified":1589703899431},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"92915560810c0311dada43ed629b8fc4ff0fc7a4","modified":1605115670214},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"1c75a837faae9aa2d0a5f30d2078aa8d2ccc2552","modified":1605115670217},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"d4809783ded05625675b1b4bbd9e99d7f5f7d7f9","modified":1605115670213},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"ee8fb8348aa76a9b346927ba4cae5666d8d777f7","modified":1605115670225},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"a042571d85ff7265f799004239a45f36b716b8a6","modified":1605115670234},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"ea96e86b6bcb160351c18a7edc4a561918a820cb","modified":1605115670234},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"e4fecc889ba3317a64e9abba5842c79dff9b7827","modified":1605115670234},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1605115670236},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"a472fb1afc6486266b85f773501a290e0a80c370","modified":1605115670236},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1605115670236},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"e1c85ab2831fd7d4bb84aea1850a0160be0023e8","modified":1605115670236},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"572a41499391677d84b16d8dbd6a996a3d5ce041","modified":1605115670240},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"28368ac06d04ccf0bbf3dc9e0dfcf341c200b28c","modified":1605115670230},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"0c9f72ad98807521cbdcee7b5bbe2e884311db39","modified":1605115670230},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"7ad04d5a02a7618ebb09c1d5a435d46c4df2c620","modified":1605115670240},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"06786e1ed8774f8f08cbfc711296cf189aaf1b8c","modified":1605115670241},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"5604ac1e161099a4d3e5657d53507268866dc717","modified":1605115670241},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"f6d165dae928c12bde3f271d299a93b334116433","modified":1605115670241},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"faadd1616a18d626f145e9fbdbfb770deab35b2c","modified":1605115670242},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"ab16a3dcdc0393b9b582ef59dcc13db9320e917c","modified":1605115670242},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"06080fd963c904d96c00eff098a284e337953013","modified":1605115670242},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"82a29572dd90451f75358a2ee2522b87304a0bb8","modified":1605115670242},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"c706733f5196776fe2657a9bebe0a727cf8fe8e5","modified":1605115670242},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"a57dca7008b1f4721359a2a3b420ed2eec02b0a1","modified":1605115670243},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1605115670243},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"be5c46b983df08b9dbac1b4749b1a101b54b6b50","modified":1605115670244},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1605115670243},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"6eee86c8f0175d6c09e434053516cd8556f78d44","modified":1605115670244},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"031765bd4564d97ba694c1b73615ed631f1c64aa","modified":1605115670244},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"c435cfd858bf82726fff2c85d384e2207bea0370","modified":1605115670244},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"78f0b6edc296a9ed5144da9f9752c0b96bebfaa5","modified":1605115670244},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"8000075b227749a7495eaf417cac6ccfbe441580","modified":1605115670245},{"_id":"source/_posts/static/img/accesstoken.png","hash":"8a0fd57b96f97ea2e2b199b64db84096c74baba9","modified":1597543700913},{"_id":"source/_posts/static/img/jwt.png","hash":"a3bf8e9227654429720984809e74563d7ae63ca0","modified":1597544887542},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"b6e2eb1550a7845cb2adf86081a4ab6c7bde1e68","modified":1605115670220},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"8afdc311c6b8db121758371f95cf1c5e77354f42","modified":1605115670219},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1605115670220},{"_id":"themes/next/source/css/_common/components/post/post-body.styl","hash":"5d61dedb3bec1021d52894f9b379e4d0953f6a35","modified":1605115670222},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"1a81d1a71fcf0699629ce6e72dfd0a15f3a2dd0a","modified":1605115670221},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8998a07acf0dbd10811835c8dfc91d92e680bcae","modified":1605115670222},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"19fc5ca0784f5d2befddb9d8bc463b916c5c2518","modified":1605115670221},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"76d0dfb3a8b873a6180604ac6daecf38b6a963a2","modified":1605115670222},{"_id":"themes/next/source/css/_common/components/post/post-footer.styl","hash":"8a2e724df3d5cd14765eb951f0a9e1dba399fd35","modified":1605115670223},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"d6ecc5dfd15c588782ba5e1df9f915b305622aef","modified":1605115670223},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"cf6540e12c2de5befcfb7e92d915e3b75fd53dfa","modified":1605115670224},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"aa366d37389760c8595529b850f461569577a1c5","modified":1605115670223},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"27001ad06f69ff035639210ab2f614861b21a4f4","modified":1605115670224},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"48ee817d05ddc788423d7f10e9823e23fda81d04","modified":1605115670226},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"b3fa752f72ca1413289b76c56fbd33a00e3d25d7","modified":1605115670224},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"8a7fc03a568b95be8d3337195e38bc7ec5ba2b23","modified":1605115670226},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5b5649b9749e3fd8b63aef22ceeece0a6e1df605","modified":1605115670224},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"2c534d2b2dbc932ad65d335a720a7ba9612bac04","modified":1605115670226},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"2896840ab8ac8ab2a7f76d18df893f290ac31625","modified":1605115670226},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"5d8fc91cdb7ee313eb367dcec7d5b2429f98242f","modified":1605115670227},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"83ee4993710fc8daa1c8dbfccd5d5091fd244c30","modified":1605115670235},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"15a5e273a8137550c93c8d2a60f9fcf86e04a89e","modified":1605115670236},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"393ff96234e4196b569d4b11496774eb78e147de","modified":1605115670237},{"_id":"themes/next/source/css/_common/scaffolding/highlight/highlight.styl","hash":"920f21dc03b28f006aef7e9d0fd444c2cd283efc","modified":1605115670235},{"_id":"themes/next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"3c029a003e9bf747e1b9cc7c0c127f6028374876","modified":1605115670238},{"_id":"themes/next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"acfdec45e56cdd6a5ea61e0154f8a6d1bc068214","modified":1605115670238},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"f09bc97e3681d73c38d7d3c5c271486c2c6537e2","modified":1605115670237},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"29bef220307d86b1eafbb3714381df32d48b5a60","modified":1605115670238},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"dcf426c2a4836386c0c27235de3f9a95c5de67cc","modified":1605115670239},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b49c64f8e9a6ca1c45c0ba98febf1974fdd03616","modified":1605115670239},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"8cb89864e8245a356d08ef0fee3133810f646fea","modified":1605115670228},{"_id":"themes/next/source/css/_common/scaffolding/tags/tags.styl","hash":"cef4e779473daa3761709958243c6b8a57bbd814","modified":1605115670239},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"254e781e7b25e31a1a589c8b38dc608802f1cc6e","modified":1605115670229},{"_id":"themes/next/source/css/_common/outline/footer/footer.styl","hash":"f11dca93e334b68a29e792f7abe682993fab7568","modified":1605115670228},{"_id":"themes/next/source/css/_common/outline/header/header.styl","hash":"f1778d2c56974b96dae429456d5c55be325c4946","modified":1605115670229},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"6d8afd8e23c40bb2b2a2edbe4eb0d2671cd81188","modified":1605115670229},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"a83a1236564b81eab9a23dba9a634a6de90d4726","modified":1605115670229},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"9c8abc55c9d94d384a245013951aba5ecca2f4fe","modified":1605115670230},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"5b38ac4a0f1ade0e681aff0e3366c481d9cf3dcd","modified":1605115670231},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"66782e68f1c74a7d0aecef20e2ca16bbe6b52592","modified":1605115670231},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"9950c3188a28e1c63b5498b7bdcd14b12ace3e28","modified":1605115670231},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"521b36ea7bb3a843029cbfbb6b5e76e91c40a19f","modified":1605115670232},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"ab715dbf2b98bfeb5e7b7c43e92e5c02496cc2ea","modified":1605115670232},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"f7ff85fe6c4efb8ff036fab2c3277b7d8bed69a8","modified":1605115670232},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"469855a72d2c2b63a21df8fbcb8cc41d32cb9bde","modified":1605115670232},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar.styl","hash":"3378f4d1640033ebde25798f602fddf88f3dcadd","modified":1605115670233},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"432e73bc4f99322af6af1852e0ea6e674919c31a","modified":1605115670233},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"497fc002d7415d9bed8cad26ba74ac66045397b7","modified":1605115670233},{"_id":"source/_posts/static/img/refreshtoken.png","hash":"ca4b6b223d3cf3943de91138846e99e87ba59aa5","modified":1597543862605},{"_id":"source/_posts/static/img/dp.png","hash":"088dc7ddb5946b75aef8c6dc748891018e45dc4a","modified":1584458836308},{"_id":"source/_posts/mlsec/data/output_76_1.png","hash":"8cf03775d39783c333f546cdd455ff9921c31beb","modified":1589704084000},{"_id":"public/sitemap.xml","hash":"4311209c03fb1e4a5a83f2b9acdfef1a9d8fe5d4","modified":1634396127646},{"_id":"public/categories/index.html","hash":"fd4cd0d59f03bd806587f9428813045f65beaee1","modified":1634396127646},{"_id":"public/vps/freenom-auto/index.html","hash":"b72748ed3d86465afcb13d5054f49b9ff8a8c237","modified":1634396127646},{"_id":"public/vps/docker/index.html","hash":"b91d88622ea3a380e91d88151d1dedf503e2e48b","modified":1634396127646},{"_id":"public/vps/cos/index.html","hash":"d5a57b2174dac5887bc119fe727f202285f752de","modified":1634396127646},{"_id":"public/vps/bbr/index.html","hash":"054f4f13eb8264d4b181a2513fe4baf01e2723b8","modified":1634396127646},{"_id":"public/vps/usage/index.html","hash":"16291e0272b937b450f6a5cc6254b92f276bf8ac","modified":1634396127646},{"_id":"public/v2ray/v2rayu/index.html","hash":"d361d6d3870b694f625619a8f4dab2c9e649347d","modified":1634396127646},{"_id":"public/notebook/pt/index.html","hash":"54171385c086eb63c2c79cda37b2e87e8ec736be","modified":1634396127646},{"_id":"public/notebook/mac-default/index.html","hash":"53d42449616e0fff2aa6b5ce064c4e9c15d8e41b","modified":1634396127646},{"_id":"public/notebook/mac-shortcut/index.html","hash":"357730b17ad124f531e75b3c37136a65abb56d88","modified":1634396127646},{"_id":"public/paper/paper-content/index.html","hash":"56add4e0ab942ac5c6e85da00bf64292ccb3785d","modified":1634396127646},{"_id":"public/paper/paper-intro/index.html","hash":"a19b38b77ff56add6cc5bb2fe5e054a8c54cc37d","modified":1634396127646},{"_id":"public/matlab/path/index.html","hash":"cae0db3010948d93e8721e3dc112b3b60e04d15a","modified":1634396127646},{"_id":"public/notebook/github-ssh/index.html","hash":"ccdce705078d182a2c8d37f7467b444c71bef54e","modified":1634396127646},{"_id":"public/deep_learning/teacher-forcing/index.html","hash":"55c4670c4ee51819443efd038abb7adf790b2948","modified":1634396127646},{"_id":"public/notebook/anaconda-rename/index.html","hash":"96ffa315938b00c1d1bdf06b8f7719ea0866d26c","modified":1634396127646},{"_id":"public/nlp/chatbot/index.html","hash":"647024d10c2309b1204c7a52b565cef36a12a7f6","modified":1634396127646},{"_id":"public/vim/vim-frequent/index.html","hash":"7c7d3e035e8982a09bf4390a1c34096dff4a54ea","modified":1634396127646},{"_id":"public/vim/vim-nerdtree/index.html","hash":"3098074ba99914f7a4339c18e18a65fdae0b4b8f","modified":1634396127646},{"_id":"public/web/socketio-dev/index.html","hash":"8ef7342ec3350c3019c69aa76bd06d8065a4ea6d","modified":1634396127646},{"_id":"public/deep_learning/Dropout/index.html","hash":"5a29ab27235f1fbe248b04490828253cd5725f7f","modified":1634396127646},{"_id":"public/deep_learning/BatchNorm/index.html","hash":"865d52729d4d8dd8d669ad0fda6fcf963f751864","modified":1634396127646},{"_id":"public/deep_learning/term/index.html","hash":"e42532dac7d10208d031bc2a3e36d3d89bcc2877","modified":1634396127646},{"_id":"public/deep_learning/Conv/index.html","hash":"2b5eafe7af86afbc19c79431a8c2619fff13a806","modified":1634396127646},{"_id":"public/notebook/git-ssl/index.html","hash":"5ef28cfbad79dc1a8f7733715650887c6fc6a6ef","modified":1634396127646},{"_id":"public/notebook/base64/index.html","hash":"3742e43ba191294e4262e4eaf0eb1e309d772c9d","modified":1634396127646},{"_id":"public/notebook/tensorflow-start/index.html","hash":"36f79a50788a96d43916027c322881110a202e9a","modified":1634396127646},{"_id":"public/notebook/py_sys_path/index.html","hash":"0ea97c0e20b1006e258ba15c17795869693c8c3f","modified":1634396127646},{"_id":"public/vim/vim-pymode/index.html","hash":"5e81642da0a7d2ca29d3b61948c0af442c4045e6","modified":1634396127646},{"_id":"public/vim/vim-mode/index.html","hash":"4c35e11ef8b38c3547f6cefffacb4a9ba5362b80","modified":1634396127646},{"_id":"public/paper_exp/logits/index.html","hash":"52c3123a967194181880222420b746dc5a4297da","modified":1634396127646},{"_id":"public/notebook/zotero/index.html","hash":"cc56549c3c2e9bebbfeb90edc67d57e06220e871","modified":1634396127646},{"_id":"public/toefl/toefl-socialmetavalue/index.html","hash":"53a831b7b03f5067a8e7b20541da83dcf957fc51","modified":1634396127646},{"_id":"public/toefl/toefl-conn/index.html","hash":"6bfe730abae8d328b4a482b1bf999182a5793224","modified":1634396127646},{"_id":"public/toefl/toefl-school/index.html","hash":"be0df908eb0bd747bec99be2c370ac24d2b80f48","modified":1634396127646},{"_id":"public/linux/linux-port/index.html","hash":"e96c02d7b7a7c2a6ed2ea0e0df163a85b0deda07","modified":1634396127646},{"_id":"public/notebook/mysql-pwd/index.html","hash":"053ee39a5c9d13e4d2abf85913e35706c7d26144","modified":1634396127646},{"_id":"public/magic/cut/index.html","hash":"ddb5115db9654600fcc785527d003337e04168a6","modified":1634396127646},{"_id":"public/notebook/gitignore/index.html","hash":"3d63c7e607bd4c32add13f1a8db62d6103b28763","modified":1634396127646},{"_id":"public/cybersecurity/protocal-sec/index.html","hash":"4b97d0e41c92f241461010c3b5259534e9108a4c","modified":1634396127646},{"_id":"public/toefl/toefl-l-bio-word/index.html","hash":"d9061988be2b579f501176954e5b7bcd7c3f65bf","modified":1634396127646},{"_id":"public/notebook/github-slow/index.html","hash":"9c59f92a4ab4ff75c6bee93e45636fc126e67d51","modified":1634396127646},{"_id":"public/notebook/keycap/index.html","hash":"6fc9873d9b0e5daad9a1bc4fa3fdbc70224b1038","modified":1634396127646},{"_id":"public/linux/linux-host/index.html","hash":"81bac11b83e193627c48d2f35a9eeba19f7d14eb","modified":1634396127646},{"_id":"public/notebook/druid-pwd/index.html","hash":"7c1e2de87d499af8345209e39c41db901e341577","modified":1634396127646},{"_id":"public/cybersecurity/tcpip/index.html","hash":"6c3ab39fbf10a10a97cf35d841c24455db186361","modified":1634396127646},{"_id":"public/paper_exp/pre_process/index.html","hash":"ec1245a1e21b94fcb3d1ff9471cb609d6f2244a6","modified":1634396127646},{"_id":"public/paper_exp/torch_random/index.html","hash":"b80e45a7901827388abbdadb6c7bdf4bf722cb8c","modified":1634396127646},{"_id":"public/notebook/notion/index.html","hash":"4010fcd6db2c992bb3a76ad8b548ada897abef89","modified":1634396127646},{"_id":"public/toefl/word-conn/index.html","hash":"ebb61bf5a34bcf992e229bf8e4c043ea6082a796","modified":1634396127646},{"_id":"public/notebook/vpn/index.html","hash":"bd7c288cb186419956b923ce59087964fdb21f49","modified":1634396127646},{"_id":"public/linux/linux-brokenpipe/index.html","hash":"32c4f495e5ad98e9a1c95149193fdb5108769600","modified":1634396127646},{"_id":"public/finance/exchange/index.html","hash":"ff6aef1f910c75346dd24bc5ba4eae85bebb4e71","modified":1634396127646},{"_id":"public/blockchain/eth-dev/index.html","hash":"05f697f591dabc27d75616d7a3d7c0e01eb794da","modified":1634396127646},{"_id":"public/blockchain/ipfs/index.html","hash":"ebabb23895a983287ff3c3f1bf1f16d752fa0738","modified":1634396127646},{"_id":"public/blockchain/mine/index.html","hash":"7df6a7967593e830b8a2d8c70f94c8336b926629","modified":1634396127646},{"_id":"public/blockchain/mine-start/index.html","hash":"e334e85ce266f1b4ac241547ecc477a200070570","modified":1634396127646},{"_id":"public/notebook/live-bilibili/index.html","hash":"2222d371596566133da2b4fafaae6f7eab23ab32","modified":1634396127646},{"_id":"public/paper_exp/loss/index.html","hash":"d696d4629c31bbff357e010c2f42cadf2a5b982e","modified":1634396127646},{"_id":"public/paper_exp/conv/index.html","hash":"1e1f023ac4e6be4110200cd8271d2f78c4ec8814","modified":1634396127646},{"_id":"public/notebook/py-init/index.html","hash":"c19bf265fc7ce886ac573dc8f9685410f4aa0084","modified":1634396127646},{"_id":"public/paper_exp/batch/index.html","hash":"d4b15efbd663b425ac9fda54bf3c8c16433bb87d","modified":1634396127646},{"_id":"public/paper_exp/tensor_inplace/index.html","hash":"47839d391c64c96bdfa789d451aa603323e514e3","modified":1634396127646},{"_id":"public/poets/deadpoetssociety/index.html","hash":"33dab95052db5908eeb115454bc5eb25fb2fc707","modified":1634396127646},{"_id":"public/notebook/scala-start/index.html","hash":"2d04f59a8cecfbec36a352a445e88976ba026d3b","modified":1634396127646},{"_id":"public/spark/rdd/index.html","hash":"c0d63996b713edb3bb6c76f4da01b37c6132ebec","modified":1634396127646},{"_id":"public/notebook/tx-ubuntu/index.html","hash":"2234f0328b3affecc5dffd397ae85842324b469b","modified":1634396127646},{"_id":"public/linux/linux-path-1/index.html","hash":"7e807deb892bf9168a68695b4f512865cb88b96e","modified":1634396127646},{"_id":"public/linux/linux-chmod/index.html","hash":"b5a814616def0fdcd81b380c60eb1db54398d2e2","modified":1634396127646},{"_id":"public/linux/linux-systemd/index.html","hash":"e4773009fcab42aabb26bdc2a3bab95f99ece622","modified":1634396127646},{"_id":"public/linux/linux-nohup/index.html","hash":"6cceddf5822d19e74bf008a9aa0742c80bb60ac9","modified":1634396127646},{"_id":"public/notebook/websocket-start/index.html","hash":"a0e5bef96abb5c738d05620703d2c6c44c59dcdf","modified":1634396127646},{"_id":"public/notebook/Fluent-Python-1.18/index.html","hash":"bfd75c4538dbb2425f929a10861b172155087c6d","modified":1634396127646},{"_id":"public/notebook/jupyter-kernel/index.html","hash":"cefe863f68199dff8117ae556c9b061922275f86","modified":1634396127646},{"_id":"public/paper_reprod/ClusteringGANSiamese/index.html","hash":"533cceddf77a21446f9c543665a693a331805b8b","modified":1634396127646},{"_id":"public/nlp/BERT/index.html","hash":"36ed8361c9ee4c7d527718dffc9075f40f00d8cf","modified":1634396127646},{"_id":"public/paper_read/Attention-Transformer/index.html","hash":"6e396f2ca2c22bfea73e2df36f93063ed99a560f","modified":1634396127646},{"_id":"public/notebook/implements-extends-2/index.html","hash":"8a756b4a25264825c3c788ebb03b2c438f0ce5bd","modified":1634396127646},{"_id":"public/nlp/word2vec/index.html","hash":"bcf9d503982e5279fa6bb8d25f5dd4da1e987963","modified":1634396127646},{"_id":"public/docker/docker-nextcloud/index.html","hash":"b77a9bbe9f8963844f6629f4048f9a7fecb00754","modified":1634396127646},{"_id":"public/linux/linux-java/index.html","hash":"6003660adb29bb821a8fb4f83e09813ccd5fed9f","modified":1634396127646},{"_id":"public/notebook/java-class/index.html","hash":"fc7fc911c1bea24eeaff9487f25d5daa14ff449a","modified":1634396127646},{"_id":"public/test/index.html","hash":"a348b021264e3b3a53323dd5af744acbad351518","modified":1634396127646},{"_id":"public/categories/Notebook/page/6/index.html","hash":"b0e9a0e5cc152fc7d5d1dd73d9f2444002574416","modified":1634396127646},{"_id":"public/categories/Docker/index.html","hash":"f5da97aaab77d7287694127a1f2fd598d14348e9","modified":1634396127646},{"_id":"public/categories/Deep-Learning/index.html","hash":"98d5a9e686ea9d48dc81c82b6d6712dd8603587e","modified":1634396127646},{"_id":"public/categories/Finance/index.html","hash":"e5ab9239401190bdc98b7ab06884e6ea24b4e233","modified":1634396127646},{"_id":"public/categories/Matlab/index.html","hash":"fa31812eb5f3123b4b24119608cf4e8a617926a6","modified":1634396127646},{"_id":"public/categories/Notebook/Error/index.html","hash":"d5eb6862cc5bbac49d5273840d8cec40f01d669f","modified":1634396127646},{"_id":"public/categories/NLP/index.html","hash":"e556a854a8c5c1dafa0c773ab7028193b9d8952d","modified":1634396127646},{"_id":"public/categories/Paper/NLP/index.html","hash":"ded5b3e013ba91ab56df0790ce4f3f19a89e0a42","modified":1634396127646},{"_id":"public/categories/Notebook/Spring/index.html","hash":"ea1d56e21c8d83ffc5fc513148912b152bcfe2c8","modified":1634396127646},{"_id":"public/categories/Poets/index.html","hash":"22b3ca06f23075defb1b2a08a86379c790841e44","modified":1634396127646},{"_id":"public/categories/Vim/index.html","hash":"bba4dce62d1a10605f413c579c55dfe95f85b84a","modified":1634396127646},{"_id":"public/categories/VPS/page/2/index.html","hash":"0005574726efc892dbd8a219aa5fc17ba75c72c8","modified":1634396127646},{"_id":"public/categories/Web/index.html","hash":"74f0f5279c535eb7f8b601a275add35052a20c21","modified":1634396127646},{"_id":"public/categories/V2ray/index.html","hash":"56f9f8e397a726a4dc5c6b505b81bb82ed034607","modified":1634396127646},{"_id":"public/archives/page/23/index.html","hash":"b13bf9361cb8472422413abe0fa9fe4c85ae1244","modified":1634396127646},{"_id":"public/archives/2020/page/9/index.html","hash":"c841c92725f6ecc4a94e9b5759c404b9461c08c2","modified":1634396127646},{"_id":"public/archives/2020/04/index.html","hash":"480bd1a6b1e3082329a6bbb3fc10235305404bb7","modified":1634396127646},{"_id":"public/archives/2020/05/index.html","hash":"e7684da15cf955d23a2b068afb37a86ba6f18673","modified":1634396127646},{"_id":"public/archives/2020/07/index.html","hash":"3e84e09bf42b57c5769f9b628e4835a833ca77fc","modified":1634396127646},{"_id":"public/archives/2020/08/index.html","hash":"60a8a95c4700e04dae887fb304b7e36bd7bb4907","modified":1634396127646},{"_id":"public/archives/2020/09/index.html","hash":"aef318162479865bf3f86d0d0e92bedffec35f6d","modified":1634396127646},{"_id":"public/archives/2020/10/index.html","hash":"3c318c29d76a979a2963595486d0a19285d5a728","modified":1634396127646},{"_id":"public/archives/2020/11/index.html","hash":"6a93407cca564fad7c1187212074e80516f24684","modified":1634396127646},{"_id":"public/archives/2020/12/index.html","hash":"a58b8912bb1b4ac9a7e8a4a202d80d40c6d4901f","modified":1634396127646},{"_id":"public/archives/2021/page/15/index.html","hash":"d8f4de2f65243be8bc55d44db6cbfad1e8c5babf","modified":1634396127646},{"_id":"public/archives/2021/01/page/3/index.html","hash":"f56c6b743fba77d1eb250ddad59e7891c233577a","modified":1634396127646},{"_id":"public/archives/2021/02/page/5/index.html","hash":"3c7f15b15200d2b3f9caeafe764ff75ca985fa76","modified":1634396127646},{"_id":"public/archives/2021/03/page/2/index.html","hash":"47192d7d695dc9d3b5167d7481ac88aabd41d7e5","modified":1634396127646},{"_id":"public/archives/2021/04/index.html","hash":"4447e8cb12a61de423e8c130970bcc9ec13fd630","modified":1634396127646},{"_id":"public/archives/2021/05/index.html","hash":"f28db28db4c05b232f90a26736ce6d8e464b72f6","modified":1634396127646},{"_id":"public/archives/2021/06/index.html","hash":"3a5774a03f34450400b5a06803620d44a47d4c01","modified":1634396127646},{"_id":"public/archives/2021/07/page/2/index.html","hash":"93a459a9e1c64483a0d785f6e34fc503817c98f7","modified":1634396127646},{"_id":"public/archives/2021/08/index.html","hash":"3f2e31dc59a7cc6e797e0019d386a19916bca862","modified":1634396127646},{"_id":"public/archives/2021/10/page/2/index.html","hash":"f7a04670cbf3ffba15a034aa3313e9dfcc7e6682","modified":1634396127646},{"_id":"public/tags/java/page/2/index.html","hash":"0b08bc4fb4353a994111303054ff0443e4520ff9","modified":1634396127646},{"_id":"public/tags/注解/index.html","hash":"b3103a3d664aa22489446b517632f4495e02fbc2","modified":1634396127646},{"_id":"public/tags/反射/index.html","hash":"7bd3af052bfa1ad54790bf4f4c11be13e0eeffdd","modified":1634396127646},{"_id":"public/tags/consensus/index.html","hash":"8bffda999de6397aff9afce6092fc9faaacb3d1d","modified":1634396127646},{"_id":"public/tags/eth/index.html","hash":"f84493004f1c1321e290aa3d13ac8749e18fbf7e","modified":1634396127646},{"_id":"public/tags/mine/index.html","hash":"03fcffb680d4c236cca1b7453c27e73372c29e2e","modified":1634396127646},{"_id":"public/tags/security/index.html","hash":"7eb939037494b98344532d71757246db44f7a69b","modified":1634396127646},{"_id":"public/tags/design/index.html","hash":"92ea9dd2184ef1932bce3c9cf3ca0faaa3f492f5","modified":1634396127646},{"_id":"public/tags/builder/index.html","hash":"1662939666592b807f261e518607b5edb04884ef","modified":1634396127646},{"_id":"public/tags/abstractfactory/index.html","hash":"d946920d89762e76909cda1ce1e2efe03e501dc2","modified":1634396127646},{"_id":"public/tags/ipfs/index.html","hash":"42f6eaf0deb0facf41e96b77c526c5eab282d9b2","modified":1634396127646},{"_id":"public/tags/singleton/index.html","hash":"30a77e2d53671f68ed63208c2a0dce9dda97d4ea","modified":1634396127646},{"_id":"public/tags/compose/index.html","hash":"2ae2f85167b5dee8926b7c91ca7f04d8b0488fce","modified":1634396127646},{"_id":"public/tags/linux/page/3/index.html","hash":"f9af2883d58cd00a4ccb9171a0fc5ff6865fea43","modified":1634396127646},{"_id":"public/tags/neo4j/index.html","hash":"d9faa136d4c6dc1abf33e5329b5f2166ebebb125","modified":1634396127646},{"_id":"public/tags/docker/index.html","hash":"f417d7c02f5128444defbf3a0937d9cc49aabea4","modified":1634396127646},{"_id":"public/tags/v2ray/index.html","hash":"32b1403f987b6f60549748e8d0fb3d4287713c1b","modified":1634396127646},{"_id":"public/tags/mariadb/index.html","hash":"4a2385775188b3a6b3f8dcc8bd74ad40c7b00060","modified":1634396127646},{"_id":"public/tags/nginx/index.html","hash":"a92168fe084cff1e4e91b89c95ee6763e66561ba","modified":1634396127646},{"_id":"public/tags/wordpress/index.html","hash":"a835ada9d79c24980d0d94725468b1759790194d","modified":1634396127646},{"_id":"public/tags/conv/index.html","hash":"5205a4d99697e725f31c5abc41a2530a9e95bd6b","modified":1634396127646},{"_id":"public/tags/order/index.html","hash":"50ba217a58dd557ecfe082582798fbb3b4a18da1","modified":1634396127646},{"_id":"public/tags/rnn/index.html","hash":"8e4191f4619e447001345b1d149669bfab6c7503","modified":1634396127646},{"_id":"public/tags/k-line/index.html","hash":"1fa2f8ccfdc8333f03b0d45aa4645077820064b3","modified":1634396127646},{"_id":"public/tags/hadoop/index.html","hash":"6f50307fd84d1700c58c3b762c9da1572d67fb91","modified":1634396127646},{"_id":"public/tags/hdfs/index.html","hash":"74dd2a991c186007487896f258439a37b10a14be","modified":1634396127646},{"_id":"public/tags/mapreduce/index.html","hash":"e619bb606c2df62c6e96b4ffc20d4ee2be99d82e","modified":1634396127646},{"_id":"public/tags/ssh/index.html","hash":"b6f6fb9dd9a7bfb1a812233a7f2dc6f1711c8d69","modified":1634396127646},{"_id":"public/tags/firewall/index.html","hash":"3765d7cc2ae8879fb360f8003a9c54fc2aae8132","modified":1634396127646},{"_id":"public/tags/ubuntu/index.html","hash":"42ba3274c290f2ece61c5330c185e6cb51c3482c","modified":1634396127646},{"_id":"public/tags/host/index.html","hash":"10fb8127427f2c6f069a4cffd911910eb69c9ead","modified":1634396127646},{"_id":"public/tags/port/index.html","hash":"c11e729a7b0abd3bb253c63157e9df1484265ed1","modified":1634396127646},{"_id":"public/tags/redis/index.html","hash":"97998208b2dd529e3bd54a4a4aebb7c4323be697","modified":1634396127646},{"_id":"public/tags/ftp/index.html","hash":"33fc3640506a817e487825d186d787584ff956b7","modified":1634396127646},{"_id":"public/tags/cards/index.html","hash":"a8cfce335e41bdd06df8fae27a88e69418ebd001","modified":1634396127646},{"_id":"public/tags/pass/index.html","hash":"070f1e04a15d0bcecd10fc01027093a7bbe22d8a","modified":1634396127646},{"_id":"public/tags/cut/index.html","hash":"4106cbb3f587808653b59f9f4029e92a45677bde","modified":1634396127646},{"_id":"public/tags/python/page/3/index.html","hash":"a2e20954f848e2250736149cd90b519f44d22281","modified":1634396127646},{"_id":"public/tags/design-pattern/index.html","hash":"ede8ea1cf3c1220c3b23245fd573e80ad9bd6e3c","modified":1634396127646},{"_id":"public/tags/springboot/index.html","hash":"b47f920f4a99c81927d75b57b9c31a4a865e572a","modified":1634396127646},{"_id":"public/tags/anaconda/index.html","hash":"1abea57305b88cc1a4d32d64ebc7325017c6be43","modified":1634396127646},{"_id":"public/tags/conda/index.html","hash":"fb83b79e2bb46036ab812edbf81795c379aaaa5b","modified":1634396127646},{"_id":"public/tags/base64/index.html","hash":"aa104ce7eaf345a6cc5630f30ee954e8743176ca","modified":1634396127646},{"_id":"public/tags/reverse/index.html","hash":"6bb3e427816ac0e27e18bc09a30fdcec2100ee6b","modified":1634396127646},{"_id":"public/tags/cheatengine/index.html","hash":"b5b19b1b80146e6eec6adb75d71beceb25db7780","modified":1634396127646},{"_id":"public/tags/craftbrew/index.html","hash":"d2841ab2ec09b8d9dd2e01bf7e65a8ad4dda30a4","modified":1634396127646},{"_id":"public/tags/coffee/index.html","hash":"add1d3664065ff0aebfde1d305d4d5f971662eb9","modified":1634396127646},{"_id":"public/tags/git/index.html","hash":"44a39a57a8ce2f470d5855e49bc8ba98925a0ed0","modified":1634396127646},{"_id":"public/tags/github/index.html","hash":"7fd6bd96e3ff91529c50df0cdab82c0b69e01ba6","modified":1634396127646},{"_id":"public/tags/flask/index.html","hash":"05af0e84be98c70dbac94e517bd66faeb7ef217d","modified":1634396127646},{"_id":"public/tags/idea/index.html","hash":"7d2b29bacc26030be8bb7b8db04f975d08e11174","modified":1634396127646},{"_id":"public/tags/hexo/index.html","hash":"acc7a3a0b87de6c58efafd57e3b3643d19d1ba56","modified":1634396127646},{"_id":"public/tags/keyboard/index.html","hash":"2c6239fe45ea3a906bd174daeb9fcf0a00cbea3c","modified":1634396127646},{"_id":"public/tags/keycap/index.html","hash":"4f2711cc5a052174766b1872219b55e966fdb96a","modified":1634396127646},{"_id":"public/tags/live/index.html","hash":"49e285b5f19a7bd61e1e9433c94dc84dd6fd014c","modified":1634396127646},{"_id":"public/tags/obs/index.html","hash":"c73baa7b3949b9b8a5ae82376f30383deb991008","modified":1634396127646},{"_id":"public/tags/Mysql/index.html","hash":"8813df8c49fc0072ead1c9676c1331f5d6b568ee","modified":1634396127646},{"_id":"public/tags/mac/index.html","hash":"01465e0285450a415ace569bdae3ab6ce4400c92","modified":1634396127646},{"_id":"public/tags/notion/index.html","hash":"80ae9a8ce3c3c19fe68fe1cf191b803eee30f264","modified":1634396127646},{"_id":"public/tags/sys/index.html","hash":"4236e88e5643167e19278f5414c2f6908286a7a7","modified":1634396127646},{"_id":"public/tags/scala/index.html","hash":"dd4109e25a0bc1c95625443893610b197b55136b","modified":1634396127646},{"_id":"public/tags/shell/index.html","hash":"022735720f015ad0a07f2eed1251bb1f5821fe64","modified":1634396127646},{"_id":"public/tags/zsh/index.html","hash":"ca600d02eacf0ae840a29520209c103f0f8bd834","modified":1634396127646},{"_id":"public/tags/cloud/index.html","hash":"4a2b02030a295818d1e632f490142aa1a7d6fa23","modified":1634396127646},{"_id":"public/tags/vps/index.html","hash":"b46b1727ef054b908d4b51fe7e37e9c6e770f981","modified":1634396127646},{"_id":"public/tags/tensorflow/index.html","hash":"f9c09791f95ec08279f33fb7cb6b74d025594228","modified":1634396127646},{"_id":"public/tags/websocket/index.html","hash":"c5f40e650a07aecfc8cbf3db46a70db029b3cbd0","modified":1634396127646},{"_id":"public/tags/vpn/index.html","hash":"17cdb2c2dec9a089ccde13f39b8b9b6ac734256e","modified":1634396127646},{"_id":"public/tags/batch-size/index.html","hash":"8ee326baab819de4860e984c9dde8ad1fbebf5a7","modified":1634396127646},{"_id":"public/tags/buildin/index.html","hash":"f04755330fc99074bcaf62d37da6181471210398","modified":1634396127646},{"_id":"public/tags/features/index.html","hash":"0d4c1543efb24ceb36735ff1baf7e035d956ed46","modified":1634396127646},{"_id":"public/tags/gan/index.html","hash":"25658d9c27d2c9365212ef16216e992af343ddbe","modified":1634396127646},{"_id":"public/tags/loss/index.html","hash":"95bc6fd80e2dd856893547dd1592dfb2572621b0","modified":1634396127646},{"_id":"public/tags/pytorch/index.html","hash":"0e8cced3e0d71400d324f80c8973e6fe98f811f2","modified":1634396127646},{"_id":"public/tags/math/index.html","hash":"f265a5828bf799469e0424eeb762a4d258dd4096","modified":1634396127646},{"_id":"public/tags/multi-view/index.html","hash":"b8b1b015834417a944c4dfcb0976e58500d3d85f","modified":1634396127646},{"_id":"public/tags/metric/index.html","hash":"6c37f37b7d7a0859efcf129f49928e3aeeb0f414","modified":1634396127646},{"_id":"public/tags/anomaly/index.html","hash":"de33e5e4c3eccf798634108f478f58c2d35bef8b","modified":1634396127646},{"_id":"public/tags/matplotlib/index.html","hash":"807265013c51ebcda8ad2b25583ff35c4c76f65e","modified":1634396127646},{"_id":"public/tags/tensor/index.html","hash":"2192e5e342fed847b136d063359803074c8c80f4","modified":1634396127646},{"_id":"public/tags/random/index.html","hash":"641209ef095ccc5e9363278ee8bab60b9a578c41","modified":1634396127646},{"_id":"public/tags/chatbot/index.html","hash":"46d22960cae5edee3a5d06bd33a14a2c3581d046","modified":1634396127646},{"_id":"public/tags/seq2seq/index.html","hash":"848046c152a18a46111e6ce78c15b7093b990020","modified":1634396127646},{"_id":"public/tags/nlp/index.html","hash":"8bb97879f9d5afbf57a50cab4a0bea6fac1df1f4","modified":1634396127646},{"_id":"public/tags/paper/index.html","hash":"2eecf7d21caee842e82270599f40cd1b4cc059d1","modified":1634396127646},{"_id":"public/tags/attention/index.html","hash":"12aaabf7cba6055a89f1d99ac005fffe2fd08d37","modified":1634396127646},{"_id":"public/tags/XLNet/index.html","hash":"cf4bd1b8ba6b8d1c8ff4023f48b5e86069dedf62","modified":1634396127646},{"_id":"public/tags/spark/index.html","hash":"26a33b71d650bdc6cd8367532f91675e434285f0","modified":1634396127646},{"_id":"public/tags/rdd/index.html","hash":"c9afc9ebc833bf984e79035079b5ed3f7ccbe765","modified":1634396127646},{"_id":"public/tags/spring/index.html","hash":"7b48589d75465f2761046be5376e05b86b734ce7","modified":1634396127646},{"_id":"public/tags/aop/index.html","hash":"f36143704eb6d7047d4acb62f72fe9669c42db2e","modified":1634396127646},{"_id":"public/tags/proxy/index.html","hash":"725f93d4ed8b65ead8b40e7ad1ab675f170bfb1a","modified":1634396127646},{"_id":"public/tags/ioc/index.html","hash":"fb54776f86576917664bc3169baba385fc86e01d","modified":1634396127646},{"_id":"public/tags/bean/index.html","hash":"32b89626b603adb4cdabf3148886d60d51eb7d10","modified":1634396127646},{"_id":"public/tags/deadpoetssociety/index.html","hash":"4440969ba6ac0b9232b8dbc108dd75e221dc9b30","modified":1634396127646},{"_id":"public/tags/speaking/index.html","hash":"d028ff5926804e605512530ae6fdaad824045e15","modified":1634396127646},{"_id":"public/tags/vim/index.html","hash":"167a3fca069d70bfb9929100bf8db6131e70d96d","modified":1634396127646},{"_id":"public/tags/config/index.html","hash":"64c3d9315519b6fe018f00d76dec0b8b28eff505","modified":1634396127646},{"_id":"public/tags/nerdtree/index.html","hash":"df29d2888374c874376307b9ba6d0a5343453613","modified":1634396127646},{"_id":"public/tags/aria2/index.html","hash":"1dc2968a07843a9ad5c12f735c15577a97dba471","modified":1634396127646},{"_id":"public/tags/ariang/index.html","hash":"a977a308829e5ab90b564e65c122bbe6d71ed754","modified":1634396127646},{"_id":"public/tags/ci/index.html","hash":"d04e76bad2687c8457b6a481bbf0ef82d968c022","modified":1634396127646},{"_id":"public/tags/bbr/index.html","hash":"84ca05293a3415b931f335d9545f53f324deaea9","modified":1634396127646},{"_id":"public/tags/domain/index.html","hash":"26867db2c1d3d08082cc3dbd6a7f44a7f68dd18a","modified":1634396127646},{"_id":"public/tags/webhook/index.html","hash":"717656ce203875262214368d8e664211480f9b91","modified":1634396127646},{"_id":"public/tags/sh/index.html","hash":"92fd80597db473a60d333ac332b4d58f3ddb4c74","modified":1634396127646},{"_id":"public/tags/x-ui/index.html","hash":"cfa0991f9ae04d2402992ce3292a57b5dc323f8b","modified":1634396127646},{"_id":"public/tags/macos/index.html","hash":"f2ad3a81ff80223661432610b7ca259f61a3f456","modified":1634396127646},{"_id":"public/tags/mount/index.html","hash":"713b00821ec5e5b30e8dc5836345d955c6fac8e9","modified":1634396127646},{"_id":"public/tags/socket/index.html","hash":"f85e8e0d6ecfa1ec68e861fa3422c9011120c589","modified":1634396127646},{"_id":"public/tags/http/index.html","hash":"479d2e05a7a49c9ee962b42b1de98b1713d82788","modified":1634396127646},{"_id":"public/tags/index.html","hash":"69cee4fe3e14ff90f298a80d2a46705d023307f7","modified":1634396127646},{"_id":"public/vps/gihubactions/index.html","hash":"23f0ee0d2d8145f62e374d05c495aadc81b5f2b3","modified":1634396127646},{"_id":"public/vps/git+hook/index.html","hash":"dbae98d200ce3f117a1e93bc44cae05b51818d74","modified":1634396127646},{"_id":"public/vps/nginx/index.html","hash":"8e59567e6d684274d75779799d25a1196b574ada","modified":1634396127646},{"_id":"public/vps/aria/index.html","hash":"c4c4bd74d205ef1b41950c68c3728bd60289ba24","modified":1634396127646},{"_id":"public/vps/rclone/index.html","hash":"5bf22ca188286593e2b190e0c9a75df02a301742","modified":1634396127646},{"_id":"public/vps/v2ray-xui/index.html","hash":"8940183293a33704305f346ca85fb6848d74a8db","modified":1634396127646},{"_id":"public/vps/v2ray-lite/index.html","hash":"012b9711cd3cb0ec6b4af8a09a904e17a0d3a678","modified":1634396127646},{"_id":"public/vps/first-conf/index.html","hash":"9a0471bdbb6453fabcfa49265d56b1503119d2dc","modified":1634396127646},{"_id":"public/vps/performance/index.html","hash":"e360d1ccd825d005660b87bf290bce728d74d56b","modified":1634396127646},{"_id":"public/notebook/hexo/index.html","hash":"ceade094b762b6431fa4123b57adbde0c22863ca","modified":1634396127646},{"_id":"public/docker/docker-neo4j/index.html","hash":"caffc54b8c9f6d32fcceb26d353e38d95c858256","modified":1634396127646},{"_id":"public/docker/docker-nginx/index.html","hash":"0e090795aa468308894cc76c82c0d2333b425abc","modified":1634396127646},{"_id":"public/web/http/index.html","hash":"b4841778b4526f1483483d318c5a15c75579133e","modified":1634396127646},{"_id":"public/web/socketio/index.html","hash":"49d3b58c52ae32883ace561ceeda2e583925a4cb","modified":1634396127646},{"_id":"public/paper_exp/features/index.html","hash":"1bdf297ff5baab1028a1bd3fb7698e49eddef8a6","modified":1634396127646},{"_id":"public/vim/vim-config/index.html","hash":"8fc740e5c5ac78b174ad8188247ee4055d635b70","modified":1634396127646},{"_id":"public/paper_exp/thoughts/index.html","hash":"0a7c15bc9bb89cf179773da1a19684e3ece88def","modified":1634396127646},{"_id":"public/linux/linux-firewall/index.html","hash":"777d46bfbdfa971a8fe8cacf9b87c9944faea9c8","modified":1634396127646},{"_id":"public/magic/pass/index.html","hash":"ef76466c22e57471306d03f5ec743b3bd4039117","modified":1634396127646},{"_id":"public/toefl/toefl-gona/index.html","hash":"87aad23edafe744298e4efddecb9b33b3cd4715e","modified":1634396127646},{"_id":"public/paper_exp/buildin/index.html","hash":"6e5d7d396e538198973b01aeaa42d8d768b8ce87","modified":1634396127646},{"_id":"public/paper_exp/plt/index.html","hash":"74b51378ad7cdb5251e2bb6ff19b64e4a5bec087","modified":1634396127646},{"_id":"public/notebook/craftbrew/index.html","hash":"7142a8ca7abddd43a932212df93da21e632d6b5a","modified":1634396127646},{"_id":"public/notebook/coffee/index.html","hash":"c1566eaf0887bfba0eb86b3428f1b16ed1ae5c48","modified":1634396127646},{"_id":"public/docker/docker-mariadb/index.html","hash":"19d23b7c8b99521fde8ab228303e3af2dfb3c174","modified":1634396127646},{"_id":"public/docker/docker-wordpress/index.html","hash":"c49c49155b2005d4cd77a82fb14fe2445db93612","modified":1634396127646},{"_id":"public/paper_exp/math/index.html","hash":"a7bf6dc4cff3c656038b20a5d4a98e3268a3fb02","modified":1634396127646},{"_id":"public/paper_exp/metric/index.html","hash":"192cd295eaac3ea9f4d31352345588a280dd8379","modified":1634396127646},{"_id":"public/finance/k-line/index.html","hash":"b5d310b67fa7d0949ccf255d8b61a22fd766f3d5","modified":1634396127646},{"_id":"public/blockchain/consensus/index.html","hash":"fdb6053efa35b8a3b4af6d089db77589d6bae06f","modified":1634396127646},{"_id":"public/blockchain/blockchain/index.html","hash":"556e4eee0daffa0b08e38246988d8e89266c9bed","modified":1634396127646},{"_id":"public/blockchain/eth-token/index.html","hash":"e24d78b77dfbfb59bbcb2ad45dcd1a4fb25ca121","modified":1634396127646},{"_id":"public/paper_exp/pt_save_load/index.html","hash":"d4313a01f3ecd4d807df5e421500941c950d55dd","modified":1634396127646},{"_id":"public/notebook/ce-start/index.html","hash":"16694ce35badeea69194fa47be3c7b29b9d66d79","modified":1634396127646},{"_id":"public/docker/docker-v2ray/index.html","hash":"c335af3ba974a53ad802e99ba9d7dad7c262a2a7","modified":1634396127646},{"_id":"public/paper_exp/mvadg/index.html","hash":"223763fdde5b7b81a1572f69013a68bc88deed4b","modified":1634396127646},{"_id":"public/paper_exp/mv_gan/index.html","hash":"fa816e65a529c862decbe77322a376f6b14e450a","modified":1634396127646},{"_id":"public/paper_exp/tensor/index.html","hash":"cacbc6d392aca89a035960008c37df9d202d74d7","modified":1634396127646},{"_id":"public/paper_exp/gan/index.html","hash":"9473d0150a838bf7c66d8426e9eacde892002caa","modified":1634396127646},{"_id":"public/paper_exp/tensor_shape/index.html","hash":"f984ecfaa183535a85aca17a0f8689c4e6c5b43f","modified":1634396127646},{"_id":"public/notebook/idea-jdk-version/index.html","hash":"15eee195c2b278a81da3b445a742d1ebf652b865","modified":1634396127646},{"_id":"public/spring/aop-three/index.html","hash":"bc37a00f3a1f5ac4b561cab250eb855b5e524283","modified":1634396127646},{"_id":"public/spring/aop-two/index.html","hash":"567b5118de193e188152c69888ce5fc0dc133092","modified":1634396127646},{"_id":"public/spring/aop-one/index.html","hash":"2a431cf519f420b7c53da767b36da088cec55cb9","modified":1634396127646},{"_id":"public/spring/aop-proxy/index.html","hash":"caade23159b0f59f24960a4af38d0d72da63dd28","modified":1634396127646},{"_id":"public/anno_reflect/reflect-anno/index.html","hash":"69d1a424120c7b364a58047975a53ab562bae4b5","modified":1634396127646},{"_id":"public/anno_reflect/reflect-class/index.html","hash":"907151bad739159f688d7b178c3702b2f4bac43a","modified":1634396127646},{"_id":"public/anno_reflect/reflect-start/index.html","hash":"a0ae9165f3d07b493a651579f168c1234ccd01b9","modified":1634396127646},{"_id":"public/anno_reflect/anno-start/index.html","hash":"e481646a584ff5a84cb925c137601e6e5f95a28e","modified":1634396127646},{"_id":"public/spring/aop-start/index.html","hash":"b7de97b3655670fcb7052da0c58fbbc7f9d6ad15","modified":1634396127646},{"_id":"public/design/singleton/index.html","hash":"e8e008dac9bc249790b3062677e419a69860a63b","modified":1634396127646},{"_id":"public/spring/ioc-bean/index.html","hash":"105871410935a22163de785b345cb55c77192dc6","modified":1634396127646},{"_id":"public/spring/ioc-di/index.html","hash":"363139447363eac3fab260f2500ccc3c1143551d","modified":1634396127646},{"_id":"public/spring/ioc-start/index.html","hash":"cedd6c61bc4269b8620d5c8b7dee3ee8ba73c245","modified":1634396127646},{"_id":"public/linux/linux-ssh/index.html","hash":"1009885a716bd861bce53510f9cae4a2db2e7964","modified":1634396127646},{"_id":"public/spark/deploy/index.html","hash":"14fa7fc93586ca9c201f032f517b15c9c8024293","modified":1634396127646},{"_id":"public/linux/linux-dir/index.html","hash":"1a6f6826dbd09266b6b4fbed7a47ea20de8852f8","modified":1634396127646},{"_id":"public/design/builder/index.html","hash":"45bcfdbf15236bcf28d16aea3c93e1ccebca20bf","modified":1634396127646},{"_id":"public/linux/linux-link/index.html","hash":"c9808eef457836eb41d8d1a4544423f7e3fe88a1","modified":1634396127646},{"_id":"public/hadoop/hdfs/index.html","hash":"71626c8864cf22ebfccc637c801dc12f749fe6b8","modified":1634396127646},{"_id":"public/hadoop/mapreduce/index.html","hash":"9e8d833022539dcb51065f20bb662c5b5017d374","modified":1634396127646},{"_id":"public/linux/linux-ftp/index.html","hash":"0be5a5cc412bbd4cb3cd600424c4726854b43d29","modified":1634396127646},{"_id":"public/spark/start/index.html","hash":"d551a7327e1adf58d18075f31679f55455bcfd6b","modified":1634396127646},{"_id":"public/hadoop/start/index.html","hash":"ecab1e84de546e92fb6908d322ae6381120e69a8","modified":1634396127646},{"_id":"public/design/abstractfactory/index.html","hash":"bf72964f92ba6dda36c4e8e8e1b3876ac00fe570","modified":1634396127646},{"_id":"public/notebook/Schedule/index.html","hash":"f7aff40e33990daad810a2ad93e9b41085ea6390","modified":1634396127646},{"_id":"public/linux/linux-redis/index.html","hash":"52575bb9253d77fcf26ea3666cf273ae11e928e9","modified":1634396127646},{"_id":"public/linux/linux-info/index.html","hash":"3d790bdc90578992576fdee6fd8f0010057b3b32","modified":1634396127646},{"_id":"public/paper_reprod/ClusterGAN/index.html","hash":"1ef00bd9999e95ce0b67897e8c78c0fd2af85126","modified":1634396127646},{"_id":"public/notebook/sh/index.html","hash":"e2bcb73d50e9b1648e357a3ce36be370cb07a00b","modified":1634396127646},{"_id":"public/vim/vim-start/index.html","hash":"4e11b02d89a5fa46421128cd0a7022ca70d76895","modified":1634396127646},{"_id":"public/notebook/Fluent-Python-1.18-1/index.html","hash":"355a4c3569de175d16cd006fa5d5241d5a6895d2","modified":1634396127646},{"_id":"public/notebook/py-*args**kwargs/index.html","hash":"5aa2d2be79bafa8e55dd333c1df2d68089f94568","modified":1634396127646},{"_id":"public/paper_read/AnomalyDetectionViaRobust/index.html","hash":"09c141a821ea47f25c467edb5f6aa7cb75751af0","modified":1634396127646},{"_id":"public/notebook/py-decorator/index.html","hash":"e4a281fb7ff18826a9adda85e1a67749f7630b6d","modified":1634396127646},{"_id":"public/notebook/flask-start/index.html","hash":"b83579506a3cd1f85868b70e4daec76670b8c64a","modified":1634396127646},{"_id":"public/linux/linux-path/index.html","hash":"48cc6e8d109953dfe65486759ed77e18bb676341","modified":1634396127646},{"_id":"public/notebook/git/index.html","hash":"c84fc3ac17b559247a3b4c3e1c7fe5bce35c5ea4","modified":1634396127646},{"_id":"public/notebook/sql/index.html","hash":"e75b5c5c973298051c50c806db3ad5b2e4b17556","modified":1634396127646},{"_id":"public/nlp/Transformer/index.html","hash":"8331c40933a36cb0148bf910d76ea122aa5f4b63","modified":1634396127646},{"_id":"public/nlp/文本表示/index.html","hash":"f3815beca6bf23662cc0f504c353a4737afc009c","modified":1634396127646},{"_id":"public/paper_read/XLNet/index.html","hash":"2dc3dc4d84101fe2535164cc7009c9b9ce997f97","modified":1634396127646},{"_id":"public/docker/docker-lineloss/index.html","hash":"c07feba8413df613f40c65a1b94345988aafc94c","modified":1634396127646},{"_id":"public/paper_read/Attention/index.html","hash":"1e980bbb2ad338be5964cb711659e83231df5b29","modified":1634396127646},{"_id":"public/notebook/authentication_authorization/index.html","hash":"b3f68e69202a5033d21773feb0c7aa52f7cc46f4","modified":1634396127646},{"_id":"public/nlp/week-2/index.html","hash":"2f768df6b7864ffdd9ae6c86469bff3ffaf16730","modified":1634396127646},{"_id":"public/notebook/grpc/index.html","hash":"f40b9aea82dd955ed5081077838cc6e5ea69c482","modified":1634396127646},{"_id":"public/notebook/nginx/index.html","hash":"5af386758658f8edf2dcd26dd8743cfefed1353e","modified":1634396127646},{"_id":"public/docker/docker-gitlab/index.html","hash":"8fb284f769a17747fd34c8c4de189eeb006edb8a","modified":1634396127646},{"_id":"public/docker/docker-compose/index.html","hash":"c7ab74f2fca9e18c591af6e16ef619fee7ad2588","modified":1634396127646},{"_id":"public/docker/docker/index.html","hash":"65325dfcca8bd19157011c153d031cff0cc1693e","modified":1634396127646},{"_id":"public/docker/docker-chevereto/index.html","hash":"6948f214f6b45f637e98152d080569265422521b","modified":1634396127646},{"_id":"public/docker/docker-anaconda/index.html","hash":"7567ff049aa7419e2847126eac81122cbd86eac3","modified":1634396127646},{"_id":"public/nlp/week-1/index.html","hash":"a551c7fa05d14d01058fc6151fa836aa41ebd9e1","modified":1634396127646},{"_id":"public/mlsec/KNN-鸢尾花数据集/index.html","hash":"ba4cc20a1e2a3035c51672573fbd344676f7f010","modified":1634396127646},{"_id":"public/mlsec/KNN-手写体数字数据集/index.html","hash":"0cdcf0b4c3f69c6d6ee2ad06f036576ffb87072a","modified":1634396127646},{"_id":"public/mlsec/KNN-手动实现/index.html","hash":"f5e21d4ebaa62542cd67ee379176e445f1c66673","modified":1634396127646},{"_id":"public/mlsec/Python-数据探索之可视化分析/index.html","hash":"ccb58083a25212a5ede1fa766323729866a7ea57","modified":1634396127646},{"_id":"public/mlsec/使用-Pandas-进行数据探索/index.html","hash":"677ac4945822cfe86a4451c8975fc258903656d3","modified":1634396127646},{"_id":"public/notebook/anaconda/index.html","hash":"3e6f4efed2a37a9bb2ff9821a27fd051a620e1e7","modified":1634396127646},{"_id":"public/algorithm/[DP]MSM/index.html","hash":"ce5d790d55da1a7abe4a510b7efe7e88224a6165","modified":1634396127646},{"_id":"public/algorithm/[DP]LCS/index.html","hash":"6740771225670b9f6141efce0b516c01a25634fc","modified":1634396127646},{"_id":"public/ml/numpy-training/index.html","hash":"7175e18ae283f10b8e1927e38898941a7957d4d7","modified":1634396127646},{"_id":"public/linux/linux-mariadb/index.html","hash":"bfffd6eac02f7c7c919e145f55ac26ddd17923f5","modified":1634396127646},{"_id":"public/ml/lesson1/index.html","hash":"8bfa072b32114e1b5346d46f6d4d7c7fba655ac7","modified":1634396127646},{"_id":"public/v2ray/v2ray/index.html","hash":"b624eb7022d60167c4ca5de354316d46f704a722","modified":1634396127646},{"_id":"public/hello-world/index.html","hash":"c1823a736700f848fa12bec254e30cec4ae787d4","modified":1634396127646},{"_id":"public/leetcode/matching/index.html","hash":"85e9fe5b5a2acb4e8577db0a99bd8e07caa8d72c","modified":1634396127646},{"_id":"public/v2ray/v2ray-tls/index.html","hash":"d95f67cf5d625fa5ad31361edfa14266f3a66181","modified":1634396127646},{"_id":"public/leetcode/gasstation/index.html","hash":"09b95a2500dd12c1208b243467cb2078c91e1428","modified":1634396127646},{"_id":"public/leetcode/jumpgame/index.html","hash":"26af6a2af1ae38e9f7ebc2f40dca0a128f0575ba","modified":1634396127646},{"_id":"public/leetcode/delivercookies/index.html","hash":"cfa2512d9ad9f3931f57e902e98b41ecb98bfbe6","modified":1634396127646},{"_id":"public/leetcode/substring/index.html","hash":"4051a53ee7c6635d95be697330b7775619987e75","modified":1634396127646},{"_id":"public/leetcode/buystockii/index.html","hash":"025d2caf56a97c6bb979e09e9e4609adc74a266f","modified":1634396127646},{"_id":"public/leetcode/recoverbinarytree/index.html","hash":"1088d61c844152b5ec7f1842dd2d5dcf363b6c6d","modified":1634396127646},{"_id":"public/leetcode/binarysearch/index.html","hash":"8edb513221a2513d746ac276dfbc16cf92f6aac3","modified":1634396127646},{"_id":"public/leetcode/inordertraversal/index.html","hash":"85ceefecb3b8da51c94d447c1449b23fe309361a","modified":1634396127646},{"_id":"public/leetcode/maxdepth/index.html","hash":"f28e4d1cfd002b12116c3ff4a67defa96a336878","modified":1634396127646},{"_id":"public/leetcode/symmetric/index.html","hash":"bdf4537613d382e3fc52e8b9c2e5f978cb9a4f37","modified":1634396127646},{"_id":"public/leetcode/sametree/index.html","hash":"1295b7197779b53c47d0bf52ea248fbcd31960e3","modified":1634396127646},{"_id":"public/leetcode/regularexpressionmatching/index.html","hash":"f0e773e8e346a8a747868cbae8a61b2743a3a790","modified":1634396127646},{"_id":"public/linux/linux-user/index.html","hash":"30cf858d503d32c872c80eea1648a1ac303e3730","modified":1634396127646},{"_id":"public/leetcode/longestpalindromicsubstring/index.html","hash":"3b638dbbcea7aecc3c3186a3b06105a8914e33db","modified":1634396127646},{"_id":"public/leetcode/longestsubstring/index.html","hash":"04f3c5219889cf362c83f0b23bd0f7191838dd22","modified":1634396127646},{"_id":"public/leetcode/validparentheses/index.html","hash":"121a75a0cc414bdd896366647afb8042fe51a6b4","modified":1634396127646},{"_id":"public/leetcode/maxpublicex/index.html","hash":"944e0c56420039a8c7e425cddf5bf3806110fed6","modified":1634396127646},{"_id":"public/leetcode/romantointeger/index.html","hash":"acbfba7c96caa118a5b8657432ddca9780c5dc7b","modified":1634396127646},{"_id":"public/leetcode/mergeklist/index.html","hash":"388aa60e838776d100bbc7e47e56accf5471bc4e","modified":1634396127646},{"_id":"public/notebook/static/index.html","hash":"515c4cbce1b33e72189c3cb64e3e5ef5cc1ca693","modified":1634396127646},{"_id":"public/notebook/innerclass/index.html","hash":"13cada8d438ee54b05d1876f0ab7571ef958904b","modified":1634396127646},{"_id":"public/notebook/final/index.html","hash":"97ca0facdc49625486419b60304b7f459536da46","modified":1634396127646},{"_id":"public/leetcode/removeend/index.html","hash":"34b82e2d6201f45bed3d1d6ac6588e1b415ee17b","modified":1634396127646},{"_id":"public/leetcode/addtwolist/index.html","hash":"5e4d1d0f49d83ded926011763962769581281173","modified":1634396127646},{"_id":"public/leetcode/hascycle/index.html","hash":"576c8c2c5bb394c84b06dad0a6272b8da8db62ad","modified":1634396127646},{"_id":"public/notebook/implements-extends/index.html","hash":"30874501e88f3726a89644690f10c90b3e87489c","modified":1634396127646},{"_id":"public/leetcode/deletelistduplicates/index.html","hash":"77f67e1f3babdf5b9c52c01e53ead350b671ac80","modified":1634396127646},{"_id":"public/leetcode/mergelist/index.html","hash":"23fc1cbda1ec8c713d92f6ede2644052bedb50ae","modified":1634396127646},{"_id":"public/leetcode/buystock/index.html","hash":"51ae357d0f0090d7f9c6214db01688598f46b5d5","modified":1634396127646},{"_id":"public/leetcode/mostclose/index.html","hash":"9f18fc52cb079573720ee85b247e213e4605d3ae","modified":1634396127646},{"_id":"public/leetcode/threesum/index.html","hash":"c80e2b31def82e79e4164dc8c969ae3d07abf245","modified":1634396127646},{"_id":"public/notebook/aop/index.html","hash":"d3e131535d9227c708f5adb5a1ce6eb9ba7090ff","modified":1634396127646},{"_id":"public/notebook/ioc/index.html","hash":"132a220cd066a671822ce49762e4f4c97691db64","modified":1634396127646},{"_id":"public/notebook/design-pattern/index.html","hash":"13bcdb60b260c358fd7c009d1fcb033da59d5c47","modified":1634396127646},{"_id":"public/leetcode/removeelements/index.html","hash":"5aa4e44c0b0afe634ef358a0200e5e644cc75771","modified":1634396127646},{"_id":"public/leetcode/deleteduplicates/index.html","hash":"9b58c4628af5fa2aba9a11f354b4e4bdfdc89835","modified":1634396127646},{"_id":"public/leetcode/twosum/index.html","hash":"c65dd87054c76829c071c419152c26dd7250a5c0","modified":1634396127646},{"_id":"public/notebook/guide/index.html","hash":"9c9f6dc323d078eaf4444d3fd5352064bf1d76c3","modified":1634396127646},{"_id":"public/categories/Notebook/index.html","hash":"f48e9e78676b596c2716d84f8f4d7740ed446f44","modified":1634396127646},{"_id":"public/categories/Notebook/page/2/index.html","hash":"292d74a7124bdad4ae6df672b1a26c4d2e600e24","modified":1634396127646},{"_id":"public/categories/Notebook/page/3/index.html","hash":"801ed6844a03cb029aa03151fab2ec9d8787c70b","modified":1634396127646},{"_id":"public/categories/Notebook/page/4/index.html","hash":"db5cd4b051a504d19880378db8786e3b34c3e21c","modified":1634396127646},{"_id":"public/categories/Notebook/page/5/index.html","hash":"8288e4c5bf242b42b1798e4ea87c414f0248c8d1","modified":1634396127646},{"_id":"public/categories/Paper/index.html","hash":"b823eca768751ab92e9fce7f34fead49cd3ee63e","modified":1634396127646},{"_id":"public/categories/Paper/page/2/index.html","hash":"65e8732cbe879885f7200a1afa52525b30a9fe1c","modified":1634396127646},{"_id":"public/categories/VPS/index.html","hash":"8b174c3612a5203361950924ca965f38488e511e","modified":1634396127646},{"_id":"public/index.html","hash":"50577547c8a6e28c302fc73a2adc5cafc40a9fc5","modified":1634396127646},{"_id":"public/page/2/index.html","hash":"d5b4ba97eff88c25d5fe27cc357145c6150e6c6f","modified":1634396127646},{"_id":"public/page/3/index.html","hash":"fa240f504c35598253aacf3fb1b62084390f2ab1","modified":1634396127646},{"_id":"public/page/4/index.html","hash":"707635333988f76c58cde6c3c16f6ebfbb959b8a","modified":1634396127646},{"_id":"public/page/5/index.html","hash":"25003ef4b40f2234959e3bbf92b0e4a800a29e1d","modified":1634396127646},{"_id":"public/page/6/index.html","hash":"5322deeb279a667c6a1032983592973e3afdfa40","modified":1634396127646},{"_id":"public/page/7/index.html","hash":"900d143ae17e60c54bbad1c28cafd80fdc54c3b0","modified":1634396127646},{"_id":"public/page/8/index.html","hash":"e2d938cc6653a29475957733ba2d495eaf7a446b","modified":1634396127646},{"_id":"public/page/9/index.html","hash":"b0319cac2ddc6943be15fb0c78c2de1d666ae897","modified":1634396127646},{"_id":"public/page/10/index.html","hash":"7c0db79652fa13b260cf778523467ae83615a3f0","modified":1634396127646},{"_id":"public/page/11/index.html","hash":"570fbd4674e8899e38a3c2af38d5d1b63e96f4d4","modified":1634396127646},{"_id":"public/page/12/index.html","hash":"e3cd7afb0e35ad697f6b9c8598f2c81ac412dbf3","modified":1634396127646},{"_id":"public/page/13/index.html","hash":"8ee2889748f4b844e460df05b10d8cc31db44167","modified":1634396127646},{"_id":"public/page/14/index.html","hash":"ecf36c6bf3e1478f89d4ef75a02007adf122d4e0","modified":1634396127646},{"_id":"public/page/15/index.html","hash":"6ea0fe6a274b7ea0d18db584b4a6c8d3c07369f4","modified":1634396127646},{"_id":"public/page/16/index.html","hash":"91eaea737fe70da83e0e31286ceb42fd835c8d95","modified":1634396127646},{"_id":"public/page/17/index.html","hash":"174ebd95ad1d3e16755f0add73251e778d27d04d","modified":1634396127646},{"_id":"public/page/18/index.html","hash":"b4d6c4ce93d237f4d1105f5d3e3149e1fa421074","modified":1634396127646},{"_id":"public/page/19/index.html","hash":"a76b08c08c0e172c0bc0095663718ab6b1ef4de7","modified":1634396127646},{"_id":"public/page/20/index.html","hash":"13c93dea80c7bc3688045a7ce6b61dca44c0b5d1","modified":1634396127646},{"_id":"public/page/21/index.html","hash":"b75a7ab2fcad53185ce5387fa1c4932bf26131cc","modified":1634396127646},{"_id":"public/page/22/index.html","hash":"f9ff1ef14d55d1bc1ab04aef332c5b9f433cff04","modified":1634396127646},{"_id":"public/page/23/index.html","hash":"bd7337bb18285afbf2ac1f744328246100847cd9","modified":1634396127646},{"_id":"public/page/24/index.html","hash":"e5774a757498fc79ff0acc1c3cb46f60b4d837d1","modified":1634396127646},{"_id":"public/page/25/index.html","hash":"55abb32932b7f0b33e2e2dbcb6ec0e719dcfb152","modified":1634396127646},{"_id":"public/page/26/index.html","hash":"304f05821f4f15cad91bbc6f875295ec8e9b5360","modified":1634396127646},{"_id":"public/page/27/index.html","hash":"32899244053d825dc006dba325698f80891d8872","modified":1634396127646},{"_id":"public/page/28/index.html","hash":"4e86ef307dad8f46f3b7d41ba8360fdc5043d8da","modified":1634396127646},{"_id":"public/page/29/index.html","hash":"4713c92dc3e42f210b353d3a15f956dddc6952ce","modified":1634396127646},{"_id":"public/page/30/index.html","hash":"82845558cd2b20949ee24606092dc6786682fa1a","modified":1634396127646},{"_id":"public/page/31/index.html","hash":"165e37a540eded886f7799af206f951d22fe675e","modified":1634396127646},{"_id":"public/page/32/index.html","hash":"4a3f59224e1cb613cb7c3c9e9ed3c5f6eec2e762","modified":1634396127646},{"_id":"public/page/33/index.html","hash":"63bb3eab15591fd267245697869e0c3f0b50cd11","modified":1634396127646},{"_id":"public/page/34/index.html","hash":"f095415f8e9276a2cc71896f30996a7f5eea2371","modified":1634396127646},{"_id":"public/page/35/index.html","hash":"46ed26fe5e688306214bc24b1e4c78d064c158de","modified":1634396127646},{"_id":"public/page/36/index.html","hash":"b2d1dbba45d745bee7002a8a3278f170cb02e508","modified":1634396127646},{"_id":"public/page/37/index.html","hash":"607be92f2e3de4b5b7bbcdd3d60767dcbebeebff","modified":1634396127646},{"_id":"public/page/38/index.html","hash":"a4f1619e3be0b66088f1ef3bf9cb1e1dd4d259ad","modified":1634396127646},{"_id":"public/page/39/index.html","hash":"f8659d604ba07e6b0eff6c5b5ec74e33fca7658d","modified":1634396127646},{"_id":"public/page/40/index.html","hash":"c1461e20fcb751567584cc8d735fea61ce42be8d","modified":1634396127646},{"_id":"public/page/41/index.html","hash":"40ab45ffc9ea0013e58414f6716e0788df35831b","modified":1634396127646},{"_id":"public/page/42/index.html","hash":"d4f8fc26f1a79821fc10962e0d446972ec8dd4a0","modified":1634396127646},{"_id":"public/page/43/index.html","hash":"3d3d074fd2e1799bc14aacf3c1e9a0da3ff703f7","modified":1634396127646},{"_id":"public/page/44/index.html","hash":"dba7c0eb1f795766f7b3c4dcf86ed1a1169b89e8","modified":1634396127646},{"_id":"public/page/45/index.html","hash":"890673b700c44e040b4c7085f40ebe935c53ee8f","modified":1634396127646},{"_id":"public/page/46/index.html","hash":"8004ca8930154a8c1a103219368f3b873e1cee6d","modified":1634396127646},{"_id":"public/archives/index.html","hash":"12c560bef2ba88d4d27ad7224532fe6446df3191","modified":1634396127646},{"_id":"public/archives/page/2/index.html","hash":"9268de78d580653c13e6c5ba4ad6c73f97a74d8f","modified":1634396127646},{"_id":"public/archives/page/3/index.html","hash":"9780bef813fefc403d1dae436c5b09f8cbaacee1","modified":1634396127646},{"_id":"public/archives/page/4/index.html","hash":"6d9474887c431180a6469392770e9ef81798cf61","modified":1634396127646},{"_id":"public/archives/page/5/index.html","hash":"726b7123187bfc97e238031df76ad0d50849dabb","modified":1634396127646},{"_id":"public/archives/page/6/index.html","hash":"30502de212b9ed320bf06882bd536b103004a105","modified":1634396127646},{"_id":"public/archives/page/7/index.html","hash":"e955d3f87cf5131b878f8117d174fb734e657e2f","modified":1634396127646},{"_id":"public/archives/page/8/index.html","hash":"feeaa14a6c41361b12eeb3e58c9b80aff17332a0","modified":1634396127646},{"_id":"public/archives/page/9/index.html","hash":"e6e75590c740ca3cbcb8b49f08fc737b6f9f3d9c","modified":1634396127646},{"_id":"public/archives/page/10/index.html","hash":"d57658af2607a6f5098a713997aa02d7cdcdd311","modified":1634396127646},{"_id":"public/archives/page/11/index.html","hash":"50272a18732f5d87feecd89905b29c4d924ea44c","modified":1634396127646},{"_id":"public/archives/page/12/index.html","hash":"04883f75bbca2c064297ff8370b0b804cba1cd15","modified":1634396127646},{"_id":"public/archives/page/13/index.html","hash":"bc84bb25f635c2723587dc2f12a0f2ca3af89271","modified":1634396127646},{"_id":"public/archives/page/15/index.html","hash":"21bcada294d7ecdb464e1e3da6be36aea9970a74","modified":1634396127646},{"_id":"public/archives/page/14/index.html","hash":"94e00076081ea44f34fc25074096825e886641fd","modified":1634396127646},{"_id":"public/archives/page/16/index.html","hash":"4269091e30fdf78d422034969cd51ed8ff580ff2","modified":1634396127646},{"_id":"public/archives/page/17/index.html","hash":"54694cf81a8fe46ec2e949805f6054878d7661ae","modified":1634396127646},{"_id":"public/archives/page/18/index.html","hash":"1a6a9f70c9218e3f653bd165aadf7e919ace071c","modified":1634396127646},{"_id":"public/archives/page/20/index.html","hash":"ec0f83ce4ac4eed1e90a4a9179cbab66c6855e02","modified":1634396127646},{"_id":"public/archives/page/19/index.html","hash":"012788ed0617d0a334c2ba139eda01940a6fa4c2","modified":1634396127646},{"_id":"public/archives/page/21/index.html","hash":"0ba43bf5ac7aef5aafd3c7d64ce369487ab11a74","modified":1634396127646},{"_id":"public/archives/page/22/index.html","hash":"514a2b684b5dcdd8c8d0d17c8cad3fc29ad0fa54","modified":1634396127646},{"_id":"public/archives/2020/index.html","hash":"13cbe7d91c88af70b82adf8b23ae97fecb1da000","modified":1634396127646},{"_id":"public/archives/2020/page/2/index.html","hash":"9ae26ab59883f51b11c1aa59f286a6e982c0c41b","modified":1634396127646},{"_id":"public/archives/2020/page/3/index.html","hash":"980b8932d738958d2152609b1930bc2af2474c76","modified":1634396127646},{"_id":"public/archives/2020/page/4/index.html","hash":"3f836038bcd19ef87e6aafe231f59aae5c9247ee","modified":1634396127646},{"_id":"public/archives/2020/page/5/index.html","hash":"b5480a24d8e62c7607e191052f394d33e75fb20b","modified":1634396127646},{"_id":"public/archives/2020/page/6/index.html","hash":"c97bddae9708a443407980c500d3af2b5a68a0c9","modified":1634396127646},{"_id":"public/archives/2020/page/7/index.html","hash":"18f5b8d2eeda3e3cc8852d98050a086257472166","modified":1634396127646},{"_id":"public/archives/2020/page/8/index.html","hash":"d628501fa0c3bad4f6c815ce309a58710cd8496f","modified":1634396127646},{"_id":"public/archives/2020/03/index.html","hash":"39573add748bc66aec74a1032884b42bc4498854","modified":1634396127646},{"_id":"public/archives/2020/03/page/2/index.html","hash":"4981d1a86bba686a89427ea66fbe9917b5d5915b","modified":1634396127646},{"_id":"public/archives/2020/03/page/3/index.html","hash":"3eb2e0b4ed5350b32bdf4810060a52844ef080d3","modified":1634396127646},{"_id":"public/archives/2020/03/page/4/index.html","hash":"e784b4ff6ea6ddf678b14aa2d9ce1127f8402dcd","modified":1634396127646},{"_id":"public/archives/2021/index.html","hash":"2bb2c2703b863c5a084b53535cf64789e2ef2a9a","modified":1634396127646},{"_id":"public/archives/2021/page/2/index.html","hash":"44af20c5d7f3e0d64e946832a332038fbbfca703","modified":1634396127646},{"_id":"public/archives/2021/page/3/index.html","hash":"b275916a1bc959053a2a70d122ff33f5e73e35a5","modified":1634396127646},{"_id":"public/archives/2021/page/4/index.html","hash":"a23a4f626327c7e3d838cce7363c094d8dbd6ba6","modified":1634396127646},{"_id":"public/archives/2021/page/5/index.html","hash":"4b420d82cb08fb7f39bde26c42f25b082eeacad2","modified":1634396127646},{"_id":"public/archives/2021/page/6/index.html","hash":"18cf96361149f251dc927513ff77264aaebfa28d","modified":1634396127646},{"_id":"public/archives/2021/page/7/index.html","hash":"9a4202893e884ef86311260f404beab3db8e44a4","modified":1634396127646},{"_id":"public/archives/2021/page/8/index.html","hash":"a32a490abf7735a116b7607218e3141ac05ae079","modified":1634396127646},{"_id":"public/archives/2021/page/9/index.html","hash":"7463b7bf9f74df07f59c5ad0991c1ce00fbbde42","modified":1634396127646},{"_id":"public/archives/2021/page/10/index.html","hash":"010edd050e9683cdb95dee124f74f8481c7a887d","modified":1634396127646},{"_id":"public/archives/2021/page/11/index.html","hash":"80614e4d5ce931020552806d0add92c3b7978a41","modified":1634396127646},{"_id":"public/archives/2021/page/12/index.html","hash":"b588c70ba6e7ef58cc4bc545d2d708f97ee353a0","modified":1634396127646},{"_id":"public/archives/2021/page/13/index.html","hash":"84e1eadb4294fb790a0510b5bd22eeac7636f0c5","modified":1634396127646},{"_id":"public/archives/2021/page/14/index.html","hash":"0744a614ac2c5737222fb6c8cfc1bc7b47946864","modified":1634396127646},{"_id":"public/archives/2021/01/index.html","hash":"9652944a3fb16cd419c3f7db2e00b2dbd96720cf","modified":1634396127646},{"_id":"public/archives/2021/01/page/2/index.html","hash":"1c6ff6d2a2513a42e2b5c53bf94214678afd7452","modified":1634396127646},{"_id":"public/archives/2021/02/index.html","hash":"49490e026b95ed64d7524a49e7434b01d17bf951","modified":1634396127646},{"_id":"public/archives/2021/02/page/2/index.html","hash":"4549209b1382ddec4cd252d2370aed24791617c3","modified":1634396127646},{"_id":"public/archives/2021/02/page/3/index.html","hash":"48fdd57c56a383696e0d98568da6399f94917cff","modified":1634396127646},{"_id":"public/archives/2021/02/page/4/index.html","hash":"79fd2917b97c7dad1e103f4b0eb4263be0619963","modified":1634396127646},{"_id":"public/archives/2021/03/index.html","hash":"93592a56076e98956cccc7bd8718288d5b14cfa7","modified":1634396127646},{"_id":"public/archives/2021/07/index.html","hash":"b35871a1912000e51e112371b324a59652a99b6a","modified":1634396127646},{"_id":"public/archives/2021/10/index.html","hash":"bde36ad2ce9614e6454dab702b5776b45931c630","modified":1634396127646},{"_id":"public/tags/java/index.html","hash":"01762513f2cbf56973a69abd33a6930f492a54e1","modified":1634396127646},{"_id":"public/tags/linux/index.html","hash":"e23da41fe68775b5c7ddabd3b334a45c1cc5b622","modified":1634396127646},{"_id":"public/tags/linux/page/2/index.html","hash":"df5e49c650adbd8cbf59bf8e7d2f68ad6d8e45c0","modified":1634396127646},{"_id":"public/tags/python/page/2/index.html","hash":"107aa35146d2b9754eb1ceaf1da4f2b791cd9263","modified":1634396127646},{"_id":"public/tags/python/index.html","hash":"bce754ef39a3a512bbd66968d10b851ce4a201a3","modified":1634396127646},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1634396127646},{"_id":"public/CNAME","hash":"6dbfbd4adf65c9db3b3a207892d9818bedbed9da","modified":1634396127646},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1634396127646},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1634396127646},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1634396127646},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1634396127646},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1634396127646},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1634396127646},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1634396127646},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1634396127646},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1634396127646},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1634396127646},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1634396127646},{"_id":"public/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1634396127646},{"_id":"public/images/man-32x32.png","hash":"210e98985f58e7707e6ea51b7dcf25b3ebc50335","modified":1634396127646},{"_id":"public/images/man-16x16.png","hash":"7a44c1ab8a00f93d6b8901e69f3d72ec632a187b","modified":1634396127646},{"_id":"public/js/bookmark.js","hash":"e45e1fbb7c6d645e9c410759486216e570d02bef","modified":1634396127646},{"_id":"public/js/local-search.js","hash":"9f4fe7bbe0f16be72d26ccb8b22bd33767f83cff","modified":1634396127646},{"_id":"public/js/next-boot.js","hash":"c2a04055d8edec03dc74e1c45d83bd3b51467de0","modified":1634396127646},{"_id":"public/js/algolia-search.js","hash":"7c6c966cdbe6e46d5f885606b0b9daf2ea3f757d","modified":1634396127646},{"_id":"public/js/schedule.js","hash":"ababd67895ce49049271601c6928fce56a1c6bbb","modified":1634396127646},{"_id":"public/js/utils.js","hash":"bc4217f9779b81c0f56de985c46d73c21d3992d5","modified":1634396127646},{"_id":"public/js/motion.js","hash":"6d4bd07a6f8e1b4083119dca0acb5b289533b619","modified":1634396127646},{"_id":"public/js/schemes/muse.js","hash":"d7a6c12bb534810eb748d0ba28aff67cccf0bb3f","modified":1634396127646},{"_id":"public/css/main.css","hash":"b99e33299ff77ed9588dc9337b4552ebd3f6b08e","modified":1634396127646}],"Category":[{"name":"Notebook","_id":"ckutx97xg0007018o1j7a72h0"},{"name":"Docker","_id":"ckutx97y2001m018o48vvek6x"},{"name":"Deep Learning","_id":"ckutx97y70022018ocevj08cg"},{"name":"Finance","_id":"ckutx97yf002d018oclkj9ofd"},{"name":"Matlab","_id":"ckutx97zo0066018o0766a1nj"},{"name":"Error","parent":"ckutx97xg0007018o1j7a72h0","_id":"ckutx9809007z018o61ez9ir9"},{"name":"Paper","_id":"ckutx981j00b7018odfnub5sx"},{"name":"NLP","_id":"ckutx982b00d5018o0f4qh7e9"},{"name":"NLP","parent":"ckutx981j00b7018odfnub5sx","_id":"ckutx982m00dr018o24o33euq"},{"name":"Spring","parent":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982s00ee018o0pw37vhs"},{"name":"Poets","_id":"ckutx982z00ez018oav3c5i60"},{"name":"Vim","_id":"ckutx983700fo018o1js36klc"},{"name":"VPS","_id":"ckutx983e00g9018oaoip3ok2"},{"name":"V2ray","_id":"ckutx983q00hm018odd7redrj"},{"name":"Web","_id":"ckutx983t00hx018ohy5t88uv"}],"Data":[],"Page":[{"title":"tags","date":"2020-11-11T18:12:19.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2020-11-12 02:12:19\ntype: tags\n---\n","updated":"2020-11-11T18:15:32.409Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckutx97wj0001018o6ma8duo8","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"categories","date":"2020-11-11T18:11:42.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2020-11-12 02:11:42\ntype: categories\n---\n","updated":"2020-11-11T18:14:46.603Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckutx97wm0003018o9kclhbj8","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"date":"2020-04-03T04:12:42.264Z","updated":"2020-04-03T04:12:42.264Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97wc0000018o3q554ief","content":"<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo<i class=\"fa fa-external-link-alt\"></i></span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation<i class=\"fa fa-external-link-alt\"></i></span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting<i class=\"fa fa-external-link-alt\"></i></span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub<i class=\"fa fa-external-link-alt\"></i></span>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo<i class=\"fa fa-external-link-alt\"></i></span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation<i class=\"fa fa-external-link-alt\"></i></span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting<i class=\"fa fa-external-link-alt\"></i></span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub<i class=\"fa fa-external-link-alt\"></i></span>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Test\n\nJust for test","source":"_posts/test.md","raw":"# Test\n\nJust for test","slug":"test","published":1,"date":"2020-04-03T09:50:37.295Z","updated":"2021-07-06T08:31:17.115Z","title":"test","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97wl0002018obcs49vyx","content":"<h1 id=\"Test\"><a href=\"#Test\" class=\"headerlink\" title=\"Test\"></a>Test</h1><p>Just for test</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Test\"><a href=\"#Test\" class=\"headerlink\" title=\"Test\"></a>Test</h1><p>Just for test</p>\n"},{"_content":"# 最长公共子序列 (Longest Common Subsequence)\n\n给定两个字符串 text1 和 text2，返回这两个字符串的最长公共子序列的长度。\n\n一个字符串的 子序列 是指这样一个新的字符串：它是由原字符串在不改变字符的相对顺序的情况下删除某些字符（也可以不删除任何字符）后组成的新字符串。\n例如，\"ace\" 是 \"abcde\" 的子序列，但 \"aec\" 不是 \"abcde\" 的子序列。两个字符串的「公共子序列」是这两个字符串所共同拥有的子序列。\n\n若这两个字符串没有公共子序列，则返回 0。\n\n示例:\n\n输入：text1 = \"abcde\", text2 = \"ace\"   \n输出：3    \n解释：最长公共子序列是 \"ace\"，它的长度为 3。  \n\n```java\npublic class DynamicProgramming {\n\n\tpublic static void main(String[] args) {\n\t\tString A = \"xzyzzyx\";\n\t\tString B = \"zxyyzxz\";\n\t\tString res = \"\";\n\t\t\n\t\tint[][] dp = new int[A.length() + 1][B.length() + 1];\n\t\t\n\t\tfor (int i = 0; i <= A.length(); i++) {\n\t\t\tfor (int j = 0; j <= B.length(); j++) {\n\t\t\t\tif (i == 0 || j == 0) {\n\t\t\t\t\tdp[i][j] = 0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (A.charAt(i - 1) == B.charAt(j - 1)) {\n\t\t\t\t\tdp[i][j] = dp[i - 1][j - 1] + 1;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (A.charAt(i - 1) != B.charAt(j - 1)) {\n\t\t\t\t\tdp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint row = A.length();\n\t\tint col = B.length();\n\t\t\n\t\twhile (row > 0 && col > 0) {\n\t\t\tif (dp[row - 1][col - 1] < dp[row][col]) {\n\t\t\t\tres = res + A.charAt(row - 1);\n\t\t\t\trow--; col--;\n\t\t\t} else {\n\t\t\t\trow--;\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.println(\"DP matrix is below: \");\n\t\tfor (int i = 0; i <= A.length(); i++) {\n\t\t\tfor (int j = 0; j <= B.length(); j++) {\n\t\t\t\tSystem.out.print(dp[i][j] + \" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t\tSystem.out.print(\"One of th LCS is: \");\n\t\tfor (int i = res.length() - 1; i >= 0; i--) {\n\t\t\tSystem.out.print(res.charAt(i));\n\t\t}\n\t}\n}\n\n/* result\n\nDP matrix is below: \n0 0 0 0 0 0 0 0 \n0 0 1 1 1 1 1 1 \n0 1 1 1 1 2 2 2 \n0 1 1 2 2 2 2 2 \n0 1 1 2 2 3 3 3 \n0 1 1 2 2 3 3 4 \n0 1 1 2 3 3 3 4 \n0 1 2 2 3 3 4 4 \n\nOne of th LCS is: xyzx\n\n*/\n\n```\n\n典型的动态规划问题\n\n首先声明一个以字符串A为行B为列的二维数组。\n- 当`i=0`或`j=0`时`dp[i][j]=0`\n- 当`ai=bi`时`dp[i][j]=dp[i-1][j-1]`(对应位置相等的话公共子串在`row-1`,`col-1`的情况下加1.)\n- 当`ai!=bi`时`dp[i][j]=max{dp[i-1][j], dp[i][j-1]}`(不想等则取字符串A,B上一个相邻字符最长公共子串.)\n\n最后显示一个最长子串时必须**从后向前**判断\b，顺序判断出的可能不是最长的子串。","source":"_posts/algorithm/[DP]LCS.md","raw":"# 最长公共子序列 (Longest Common Subsequence)\n\n给定两个字符串 text1 和 text2，返回这两个字符串的最长公共子序列的长度。\n\n一个字符串的 子序列 是指这样一个新的字符串：它是由原字符串在不改变字符的相对顺序的情况下删除某些字符（也可以不删除任何字符）后组成的新字符串。\n例如，\"ace\" 是 \"abcde\" 的子序列，但 \"aec\" 不是 \"abcde\" 的子序列。两个字符串的「公共子序列」是这两个字符串所共同拥有的子序列。\n\n若这两个字符串没有公共子序列，则返回 0。\n\n示例:\n\n输入：text1 = \"abcde\", text2 = \"ace\"   \n输出：3    \n解释：最长公共子序列是 \"ace\"，它的长度为 3。  \n\n```java\npublic class DynamicProgramming {\n\n\tpublic static void main(String[] args) {\n\t\tString A = \"xzyzzyx\";\n\t\tString B = \"zxyyzxz\";\n\t\tString res = \"\";\n\t\t\n\t\tint[][] dp = new int[A.length() + 1][B.length() + 1];\n\t\t\n\t\tfor (int i = 0; i <= A.length(); i++) {\n\t\t\tfor (int j = 0; j <= B.length(); j++) {\n\t\t\t\tif (i == 0 || j == 0) {\n\t\t\t\t\tdp[i][j] = 0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (A.charAt(i - 1) == B.charAt(j - 1)) {\n\t\t\t\t\tdp[i][j] = dp[i - 1][j - 1] + 1;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (A.charAt(i - 1) != B.charAt(j - 1)) {\n\t\t\t\t\tdp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint row = A.length();\n\t\tint col = B.length();\n\t\t\n\t\twhile (row > 0 && col > 0) {\n\t\t\tif (dp[row - 1][col - 1] < dp[row][col]) {\n\t\t\t\tres = res + A.charAt(row - 1);\n\t\t\t\trow--; col--;\n\t\t\t} else {\n\t\t\t\trow--;\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.println(\"DP matrix is below: \");\n\t\tfor (int i = 0; i <= A.length(); i++) {\n\t\t\tfor (int j = 0; j <= B.length(); j++) {\n\t\t\t\tSystem.out.print(dp[i][j] + \" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t\tSystem.out.print(\"One of th LCS is: \");\n\t\tfor (int i = res.length() - 1; i >= 0; i--) {\n\t\t\tSystem.out.print(res.charAt(i));\n\t\t}\n\t}\n}\n\n/* result\n\nDP matrix is below: \n0 0 0 0 0 0 0 0 \n0 0 1 1 1 1 1 1 \n0 1 1 1 1 2 2 2 \n0 1 1 2 2 2 2 2 \n0 1 1 2 2 3 3 3 \n0 1 1 2 2 3 3 4 \n0 1 1 2 3 3 3 4 \n0 1 2 2 3 3 4 4 \n\nOne of th LCS is: xyzx\n\n*/\n\n```\n\n典型的动态规划问题\n\n首先声明一个以字符串A为行B为列的二维数组。\n- 当`i=0`或`j=0`时`dp[i][j]=0`\n- 当`ai=bi`时`dp[i][j]=dp[i-1][j-1]`(对应位置相等的话公共子串在`row-1`,`col-1`的情况下加1.)\n- 当`ai!=bi`时`dp[i][j]=max{dp[i-1][j], dp[i][j-1]}`(不想等则取字符串A,B上一个相邻字符最长公共子串.)\n\n最后显示一个最长子串时必须**从后向前**判断\b，顺序判断出的可能不是最长的子串。","slug":"algorithm/[DP]LCS","published":1,"date":"2020-04-26T13:48:21.868Z","updated":"2020-04-28T16:31:16.026Z","title":"algorithm/[DP]LCS","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xd0004018o3c10fawv","content":"<h1 id=\"最长公共子序列-Longest-Common-Subsequence\"><a href=\"#最长公共子序列-Longest-Common-Subsequence\" class=\"headerlink\" title=\"最长公共子序列 (Longest Common Subsequence)\"></a>最长公共子序列 (Longest Common Subsequence)</h1><p>给定两个字符串 text1 和 text2，返回这两个字符串的最长公共子序列的长度。</p>\n<p>一个字符串的 子序列 是指这样一个新的字符串：它是由原字符串在不改变字符的相对顺序的情况下删除某些字符（也可以不删除任何字符）后组成的新字符串。<br>例如，”ace” 是 “abcde” 的子序列，但 “aec” 不是 “abcde” 的子序列。两个字符串的「公共子序列」是这两个字符串所共同拥有的子序列。</p>\n<p>若这两个字符串没有公共子序列，则返回 0。</p>\n<p>示例:</p>\n<p>输入：text1 = “abcde”, text2 = “ace”<br>输出：3<br>解释：最长公共子序列是 “ace”，它的长度为 3。  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicProgramming</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tString A = <span class=\"string\">\"xzyzzyx\"</span>;</span><br><span class=\"line\">\t\tString B = <span class=\"string\">\"zxyyzxz\"</span>;</span><br><span class=\"line\">\t\tString res = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[A.length() + <span class=\"number\">1</span>][B.length() + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= A.length(); i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt;= B.length(); j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (i == <span class=\"number\">0</span> || j == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (A.charAt(i - <span class=\"number\">1</span>) == B.charAt(j - <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = dp[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (A.charAt(i - <span class=\"number\">1</span>) != B.charAt(j - <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = Math.max(dp[i - <span class=\"number\">1</span>][j], dp[i][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> row = A.length();</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> col = B.length();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> (row &gt; <span class=\"number\">0</span> &amp;&amp; col &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dp[row - <span class=\"number\">1</span>][col - <span class=\"number\">1</span>] &lt; dp[row][col]) &#123;</span><br><span class=\"line\">\t\t\t\tres = res + A.charAt(row - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\trow--; col--;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\trow--;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"DP matrix is below: \"</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= A.length(); i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt;= B.length(); j++) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.print(dp[i][j] + <span class=\"string\">\" \"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.print(<span class=\"string\">\"One of th LCS is: \"</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = res.length() - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.print(res.charAt(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* result</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">DP matrix is below: </span></span><br><span class=\"line\"><span class=\"comment\">0 0 0 0 0 0 0 0 </span></span><br><span class=\"line\"><span class=\"comment\">0 0 1 1 1 1 1 1 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 1 1 2 2 2 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 2 2 2 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 3 3 3 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 3 3 4 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 3 3 3 4 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 2 2 3 3 4 4 </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">One of th LCS is: xyzx</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>典型的动态规划问题</p>\n<p>首先声明一个以字符串A为行B为列的二维数组。</p>\n<ul>\n<li>当<code>i=0</code>或<code>j=0</code>时<code>dp[i][j]=0</code></li>\n<li>当<code>ai=bi</code>时<code>dp[i][j]=dp[i-1][j-1]</code>(对应位置相等的话公共子串在<code>row-1</code>,<code>col-1</code>的情况下加1.)</li>\n<li>当<code>ai!=bi</code>时<code>dp[i][j]=max{dp[i-1][j], dp[i][j-1]}</code>(不想等则取字符串A,B上一个相邻字符最长公共子串.)</li>\n</ul>\n<p>最后显示一个最长子串时必须<strong>从后向前</strong>判断\b，顺序判断出的可能不是最长的子串。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"最长公共子序列-Longest-Common-Subsequence\"><a href=\"#最长公共子序列-Longest-Common-Subsequence\" class=\"headerlink\" title=\"最长公共子序列 (Longest Common Subsequence)\"></a>最长公共子序列 (Longest Common Subsequence)</h1><p>给定两个字符串 text1 和 text2，返回这两个字符串的最长公共子序列的长度。</p>\n<p>一个字符串的 子序列 是指这样一个新的字符串：它是由原字符串在不改变字符的相对顺序的情况下删除某些字符（也可以不删除任何字符）后组成的新字符串。<br>例如，”ace” 是 “abcde” 的子序列，但 “aec” 不是 “abcde” 的子序列。两个字符串的「公共子序列」是这两个字符串所共同拥有的子序列。</p>\n<p>若这两个字符串没有公共子序列，则返回 0。</p>\n<p>示例:</p>\n<p>输入：text1 = “abcde”, text2 = “ace”<br>输出：3<br>解释：最长公共子序列是 “ace”，它的长度为 3。  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicProgramming</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\tString A = <span class=\"string\">\"xzyzzyx\"</span>;</span><br><span class=\"line\">\t\tString B = <span class=\"string\">\"zxyyzxz\"</span>;</span><br><span class=\"line\">\t\tString res = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[A.length() + <span class=\"number\">1</span>][B.length() + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= A.length(); i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt;= B.length(); j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (i == <span class=\"number\">0</span> || j == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (A.charAt(i - <span class=\"number\">1</span>) == B.charAt(j - <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = dp[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (A.charAt(i - <span class=\"number\">1</span>) != B.charAt(j - <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">\t\t\t\t\tdp[i][j] = Math.max(dp[i - <span class=\"number\">1</span>][j], dp[i][j - <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> row = A.length();</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> col = B.length();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> (row &gt; <span class=\"number\">0</span> &amp;&amp; col &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dp[row - <span class=\"number\">1</span>][col - <span class=\"number\">1</span>] &lt; dp[row][col]) &#123;</span><br><span class=\"line\">\t\t\t\tres = res + A.charAt(row - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\trow--; col--;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\trow--;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"DP matrix is below: \"</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt;= A.length(); i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt;= B.length(); j++) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.print(dp[i][j] + <span class=\"string\">\" \"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.print(<span class=\"string\">\"One of th LCS is: \"</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = res.length() - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.print(res.charAt(i));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* result</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">DP matrix is below: </span></span><br><span class=\"line\"><span class=\"comment\">0 0 0 0 0 0 0 0 </span></span><br><span class=\"line\"><span class=\"comment\">0 0 1 1 1 1 1 1 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 1 1 2 2 2 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 2 2 2 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 3 3 3 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 2 3 3 4 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 1 2 3 3 3 4 </span></span><br><span class=\"line\"><span class=\"comment\">0 1 2 2 3 3 4 4 </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">One of th LCS is: xyzx</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>典型的动态规划问题</p>\n<p>首先声明一个以字符串A为行B为列的二维数组。</p>\n<ul>\n<li>当<code>i=0</code>或<code>j=0</code>时<code>dp[i][j]=0</code></li>\n<li>当<code>ai=bi</code>时<code>dp[i][j]=dp[i-1][j-1]</code>(对应位置相等的话公共子串在<code>row-1</code>,<code>col-1</code>的情况下加1.)</li>\n<li>当<code>ai!=bi</code>时<code>dp[i][j]=max{dp[i-1][j], dp[i][j-1]}</code>(不想等则取字符串A,B上一个相邻字符最长公共子串.)</li>\n</ul>\n<p>最后显示一个最长子串时必须<strong>从后向前</strong>判断\b，顺序判断出的可能不是最长的子串。</p>\n"},{"title":"注解 - Start","_content":"\n# 元注解\n\nJava内置了几个元注解\n\n- `@Target`定义了**作用域**，可以使用的范围。\n- `@Retention`定义了注解的**生命周期**。\n- `@Document`定义注解将被包含在JavaDoc中。\n- `@Inherited`说明子类可以**继承**父类的注解。\n\n\n\n# 自定义注解\n\n注解内可以规定要传哪些值。\n\n```java\n@Target(value = {ElementType.METHOD, ElementType.TYPE})\n@Retention(value = RetentionPolicy.RUNTIME)\n@interface MyAnnoPlus {\n    String value();\n    String name() default \"edlison\";\n    int id() default -1;\n    int age();\n}\n```\n\n- `value`对应的可以不用写`value = \"\"`, 可以直接传值。\n- `default`默认则可以不传值。\n- 传值的顺序没有要求。\n\n\n\n# 用处\n\n注解可以添加在package, class, method, field上，相当于给他们**添加了额外的信息**，我们可以通过**反射机制**编程来实现对这些元数据的访问。","source":"_posts/anno_reflect/anno-start.md","raw":"---\ntitle: 注解 - Start\ncategories:\n- Notebook\ntags:\n- java\n- 注解\n---\n\n# 元注解\n\nJava内置了几个元注解\n\n- `@Target`定义了**作用域**，可以使用的范围。\n- `@Retention`定义了注解的**生命周期**。\n- `@Document`定义注解将被包含在JavaDoc中。\n- `@Inherited`说明子类可以**继承**父类的注解。\n\n\n\n# 自定义注解\n\n注解内可以规定要传哪些值。\n\n```java\n@Target(value = {ElementType.METHOD, ElementType.TYPE})\n@Retention(value = RetentionPolicy.RUNTIME)\n@interface MyAnnoPlus {\n    String value();\n    String name() default \"edlison\";\n    int id() default -1;\n    int age();\n}\n```\n\n- `value`对应的可以不用写`value = \"\"`, 可以直接传值。\n- `default`默认则可以不传值。\n- 传值的顺序没有要求。\n\n\n\n# 用处\n\n注解可以添加在package, class, method, field上，相当于给他们**添加了额外的信息**，我们可以通过**反射机制**编程来实现对这些元数据的访问。","slug":"anno_reflect/anno-start","published":1,"date":"2021-02-02T03:40:10.293Z","updated":"2021-02-02T05:23:51.791Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xd0005018obiwz1q4i","content":"<h1 id=\"元注解\"><a href=\"#元注解\" class=\"headerlink\" title=\"元注解\"></a>元注解</h1><p>Java内置了几个元注解</p>\n<ul>\n<li><code>@Target</code>定义了<strong>作用域</strong>，可以使用的范围。</li>\n<li><code>@Retention</code>定义了注解的<strong>生命周期</strong>。</li>\n<li><code>@Document</code>定义注解将被包含在JavaDoc中。</li>\n<li><code>@Inherited</code>说明子类可以<strong>继承</strong>父类的注解。</li>\n</ul>\n<h1 id=\"自定义注解\"><a href=\"#自定义注解\" class=\"headerlink\" title=\"自定义注解\"></a>自定义注解</h1><p>注解内可以规定要传哪些值。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(value = &#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(value = RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> MyAnnoPlus &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">name</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"edlison\"</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> -1</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">age</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>value</code>对应的可以不用写<code>value = &quot;&quot;</code>, 可以直接传值。</li>\n<li><code>default</code>默认则可以不传值。</li>\n<li>传值的顺序没有要求。</li>\n</ul>\n<h1 id=\"用处\"><a href=\"#用处\" class=\"headerlink\" title=\"用处\"></a>用处</h1><p>注解可以添加在package, class, method, field上，相当于给他们<strong>添加了额外的信息</strong>，我们可以通过<strong>反射机制</strong>编程来实现对这些元数据的访问。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"元注解\"><a href=\"#元注解\" class=\"headerlink\" title=\"元注解\"></a>元注解</h1><p>Java内置了几个元注解</p>\n<ul>\n<li><code>@Target</code>定义了<strong>作用域</strong>，可以使用的范围。</li>\n<li><code>@Retention</code>定义了注解的<strong>生命周期</strong>。</li>\n<li><code>@Document</code>定义注解将被包含在JavaDoc中。</li>\n<li><code>@Inherited</code>说明子类可以<strong>继承</strong>父类的注解。</li>\n</ul>\n<h1 id=\"自定义注解\"><a href=\"#自定义注解\" class=\"headerlink\" title=\"自定义注解\"></a>自定义注解</h1><p>注解内可以规定要传哪些值。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(value = &#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(value = RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> MyAnnoPlus &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">name</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"edlison\"</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> -1</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">age</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>value</code>对应的可以不用写<code>value = &quot;&quot;</code>, 可以直接传值。</li>\n<li><code>default</code>默认则可以不传值。</li>\n<li>传值的顺序没有要求。</li>\n</ul>\n<h1 id=\"用处\"><a href=\"#用处\" class=\"headerlink\" title=\"用处\"></a>用处</h1><p>注解可以添加在package, class, method, field上，相当于给他们<strong>添加了额外的信息</strong>，我们可以通过<strong>反射机制</strong>编程来实现对这些元数据的访问。</p>\n"},{"title":"Java反射 - 通过反射获取注解的值","_content":"\n# 一个ORM例子\n\n## 定义注解\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@interface Table {\n    String value();\n}\n\n@Target(ElementType.FIELD)\n@Retention(RetentionPolicy.RUNTIME)\n@interface Field {\n    String colName();\n    String type();\n    int length();\n}\n```\n\n## 实体类\n\n```java\n@Table(\"user\")\nclass User {\n    @Field(colName = \"user_id\", type = \"int\", length = 10)\n    private int id;\n    @Field(colName = \"user_name\", type = \"varchar\", length = 10)\n    private String name;\n    @Field(colName = \"user_password\", type = \"varchar\", length = 64)\n    private String password;\n}\n```\n\n## 获取注解进行处理\n\n```java\npublic class ReflectAnno {\n    public static void main(String[] args) throws NoSuchFieldException, NoSuchMethodException {\n        Class<User> c = User.class;\n\n        // 获得类上的注解\n        Annotation[] annotations = c.getAnnotations();\n        for (Annotation annotation : annotations) {\n            System.out.println(\"annotation = \" + annotation);\n        }\n\n        // 获取注解的值\n        Table target = c.getAnnotation(Table.class);\n        System.out.println(target.value());\n\n        // 获取类的Field\n        java.lang.reflect.Field name = c.getDeclaredField(\"name\");\n        // 获取Field上的注解\n        Field nameAnnotation = name.getAnnotation(Field.class);\n        // 获取注解的值\n        System.out.println(\"nameAnnotation.colName() = \" + nameAnnotation.colName());\n        System.out.println(\"nameAnnotation.type() = \" + nameAnnotation.type());\n        System.out.println(\"nameAnnotation.length() = \" + nameAnnotation.length());\n\n        // 获取类的Method\n        Method setPassword = c.getDeclaredMethod(\"setPassword\", String.class);\n        // 获取Method上的注解\n        setPassword.getAnnotations();\n    }\n}\n```\n\n","source":"_posts/anno_reflect/reflect-anno.md","raw":"---\ntitle: Java反射 - 通过反射获取注解的值\ncategories:\n- Notebook\ntags:\n- java\n- 反射\n- 注解\n---\n\n# 一个ORM例子\n\n## 定义注解\n\n```java\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@interface Table {\n    String value();\n}\n\n@Target(ElementType.FIELD)\n@Retention(RetentionPolicy.RUNTIME)\n@interface Field {\n    String colName();\n    String type();\n    int length();\n}\n```\n\n## 实体类\n\n```java\n@Table(\"user\")\nclass User {\n    @Field(colName = \"user_id\", type = \"int\", length = 10)\n    private int id;\n    @Field(colName = \"user_name\", type = \"varchar\", length = 10)\n    private String name;\n    @Field(colName = \"user_password\", type = \"varchar\", length = 64)\n    private String password;\n}\n```\n\n## 获取注解进行处理\n\n```java\npublic class ReflectAnno {\n    public static void main(String[] args) throws NoSuchFieldException, NoSuchMethodException {\n        Class<User> c = User.class;\n\n        // 获得类上的注解\n        Annotation[] annotations = c.getAnnotations();\n        for (Annotation annotation : annotations) {\n            System.out.println(\"annotation = \" + annotation);\n        }\n\n        // 获取注解的值\n        Table target = c.getAnnotation(Table.class);\n        System.out.println(target.value());\n\n        // 获取类的Field\n        java.lang.reflect.Field name = c.getDeclaredField(\"name\");\n        // 获取Field上的注解\n        Field nameAnnotation = name.getAnnotation(Field.class);\n        // 获取注解的值\n        System.out.println(\"nameAnnotation.colName() = \" + nameAnnotation.colName());\n        System.out.println(\"nameAnnotation.type() = \" + nameAnnotation.type());\n        System.out.println(\"nameAnnotation.length() = \" + nameAnnotation.length());\n\n        // 获取类的Method\n        Method setPassword = c.getDeclaredMethod(\"setPassword\", String.class);\n        // 获取Method上的注解\n        setPassword.getAnnotations();\n    }\n}\n```\n\n","slug":"anno_reflect/reflect-anno","published":1,"date":"2021-02-02T08:07:01.540Z","updated":"2021-02-02T08:11:17.630Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xe0006018o5rd6913r","content":"<h1 id=\"一个ORM例子\"><a href=\"#一个ORM例子\" class=\"headerlink\" title=\"一个ORM例子\"></a>一个ORM例子</h1><h2 id=\"定义注解\"><a href=\"#定义注解\" class=\"headerlink\" title=\"定义注解\"></a>定义注解</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> Table &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.FIELD)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> Field &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">colName</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">type</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">length</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实体类\"><a href=\"#实体类\" class=\"headerlink\" title=\"实体类\"></a>实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Table</span>(<span class=\"string\">\"user\"</span>)</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_id\"</span>, type = <span class=\"string\">\"int\"</span>, length = <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_name\"</span>, type = <span class=\"string\">\"varchar\"</span>, length = <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_password\"</span>, type = <span class=\"string\">\"varchar\"</span>, length = <span class=\"number\">64</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取注解进行处理\"><a href=\"#获取注解进行处理\" class=\"headerlink\" title=\"获取注解进行处理\"></a>获取注解进行处理</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectAnno</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchFieldException, NoSuchMethodException </span>&#123;</span><br><span class=\"line\">        Class&lt;User&gt; c = User<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类上的注解</span></span><br><span class=\"line\">        Annotation[] annotations = c.getAnnotations();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Annotation annotation : annotations) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"annotation = \"</span> + annotation);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取注解的值</span></span><br><span class=\"line\">        Table target = c.getAnnotation(Table<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        System.out.println(target.value());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取类的Field</span></span><br><span class=\"line\">        java.lang.reflect.Field name = c.getDeclaredField(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 获取Field上的注解</span></span><br><span class=\"line\">        Field nameAnnotation = name.getAnnotation(Field<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 获取注解的值</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.colName() = \"</span> + nameAnnotation.colName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.type() = \"</span> + nameAnnotation.type());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.length() = \"</span> + nameAnnotation.length());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取类的Method</span></span><br><span class=\"line\">        Method setPassword = c.getDeclaredMethod(<span class=\"string\">\"setPassword\"</span>, String<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 获取Method上的注解</span></span><br><span class=\"line\">        setPassword.getAnnotations();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"一个ORM例子\"><a href=\"#一个ORM例子\" class=\"headerlink\" title=\"一个ORM例子\"></a>一个ORM例子</h1><h2 id=\"定义注解\"><a href=\"#定义注解\" class=\"headerlink\" title=\"定义注解\"></a>定义注解</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> Table &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.FIELD)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@interface</span> Field &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">colName</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">type</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">length</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实体类\"><a href=\"#实体类\" class=\"headerlink\" title=\"实体类\"></a>实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Table</span>(<span class=\"string\">\"user\"</span>)</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_id\"</span>, type = <span class=\"string\">\"int\"</span>, length = <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_name\"</span>, type = <span class=\"string\">\"varchar\"</span>, length = <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Field</span>(colName = <span class=\"string\">\"user_password\"</span>, type = <span class=\"string\">\"varchar\"</span>, length = <span class=\"number\">64</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取注解进行处理\"><a href=\"#获取注解进行处理\" class=\"headerlink\" title=\"获取注解进行处理\"></a>获取注解进行处理</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectAnno</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchFieldException, NoSuchMethodException </span>&#123;</span><br><span class=\"line\">        Class&lt;User&gt; c = User<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类上的注解</span></span><br><span class=\"line\">        Annotation[] annotations = c.getAnnotations();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Annotation annotation : annotations) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"annotation = \"</span> + annotation);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取注解的值</span></span><br><span class=\"line\">        Table target = c.getAnnotation(Table<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        System.out.println(target.value());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取类的Field</span></span><br><span class=\"line\">        java.lang.reflect.Field name = c.getDeclaredField(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 获取Field上的注解</span></span><br><span class=\"line\">        Field nameAnnotation = name.getAnnotation(Field<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 获取注解的值</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.colName() = \"</span> + nameAnnotation.colName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.type() = \"</span> + nameAnnotation.type());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"nameAnnotation.length() = \"</span> + nameAnnotation.length());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取类的Method</span></span><br><span class=\"line\">        Method setPassword = c.getDeclaredMethod(<span class=\"string\">\"setPassword\"</span>, String<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 获取Method上的注解</span></span><br><span class=\"line\">        setPassword.getAnnotations();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Java反射 - 获取及使用属性与方法","_content":"\n# 获取\n\n```java\npublic class ReflectGet {\n    public static void main(String[] args) throws NoSuchMethodException {\n        Class c = Person.class;\n\n        // 获得类名\n        System.out.println(\"c.getName() = \" + c.getName());\n        System.out.println(\"c.getSimpleName() = \" + c.getSimpleName());\n\n        // 获得类的属性\n        Field[] fields = c.getFields();  // public属性\n        for (Field field : fields) {\n            System.out.println(\"field = \" + field);\n        }\n        fields = c.getDeclaredFields();  // 所有属性\n        for (Field field : fields) {\n            System.out.println(\"declaredField = \" + field);\n        }\n\n        // 获得类的方法\n        Method[] methods = c.getMethods();  // 本类及父类全部的public方法\n        for (Method method : methods) {\n            System.out.println(\"method = \" + method);\n        }\n        methods = c.getDeclaredMethods();  // 本类的所有方法\n        for (Method method : methods) {\n            System.out.println(\"method = \" + method);\n        }\n        Method method = c.getMethod(\"setAge\", int.class);  // 需要指定形参的类型，因为可能会重载！！！\n        System.out.println(\"method = \" + method);\n\n        // 获得构造器\n        Constructor[] constructors = c.getConstructors();  // 获得public方法\n        for (Constructor constructor : constructors) {\n            System.out.println(\"constructor = \" + constructor);\n        }\n        constructors = c.getDeclaredConstructors();  // 获得本类全部\n        for (Constructor constructor : constructors) {\n            System.out.println(\"constructor = \" + constructor);\n        }\n        Constructor constructor = c.getConstructor(String.class, int.class);  // 获取指定构造器，同样需要传形参的class类，可能会重载！！！\n        System.out.println(\"constructor = \" + constructor);\n    }\n}\n```\n\n\n\n\n\n# 使用\n\n```java\npublic class ReflectUse {\n    public static void main(String[] args) throws IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException {\n        // 拿到类的Class对象\n        Class c = Person.class;\n\n        // 获取构造器（在Java9后使用Class对象直接创建实例的方法已经被抛弃了）\n        Constructor constructorA = c.getDeclaredConstructor(null);\n        Constructor constructorB = c.getDeclaredConstructor(String.class, int.class);\n\n        // 通过构造器创建实例\n        Person person = (Person) constructorA.newInstance(null);\n        System.out.println(\"person = \" + person);\n        Person personB = (Person) constructorB.newInstance(\"Edlison\", 18);\n        System.out.println(\"personB = \" + personB);\n\n        // 通过Class对象获取其中的方法\n        Method setName = c.getMethod(\"setName\", String.class);\n\n        // 执行该方法： 执行的对象 形参\n        setName.invoke(personB, \"edlison\");\n        System.out.println(\"personB = \" + personB);\n\n        // 通过Class对象获取其中的属性\n        Field age = c.getDeclaredField(\"age\");\n        age.setAccessible(true);  // 由于private限制 需要先设置Accessible才可以对其进行操作\n        age.set(personB, 10);\n        System.out.println(\"personB = \" + personB);\n    }\n}\n```\n\n**注意**：\n\n- 通过`invoke`执行获得的类的方法：(需要执行的对象，形参...)\n- 通过`set`对类的属性进行赋值：(需要赋值的对象，形参)\n- 如果属性或方法的可见性为`private`，可以通过设置`setAccessible(true)`来访问。\n\n","source":"_posts/anno_reflect/reflect-class.md","raw":"---\ntitle: Java反射 - 获取及使用属性与方法\ncategories:\n- Notebook\ntags:\n- java\n- 反射\n---\n\n# 获取\n\n```java\npublic class ReflectGet {\n    public static void main(String[] args) throws NoSuchMethodException {\n        Class c = Person.class;\n\n        // 获得类名\n        System.out.println(\"c.getName() = \" + c.getName());\n        System.out.println(\"c.getSimpleName() = \" + c.getSimpleName());\n\n        // 获得类的属性\n        Field[] fields = c.getFields();  // public属性\n        for (Field field : fields) {\n            System.out.println(\"field = \" + field);\n        }\n        fields = c.getDeclaredFields();  // 所有属性\n        for (Field field : fields) {\n            System.out.println(\"declaredField = \" + field);\n        }\n\n        // 获得类的方法\n        Method[] methods = c.getMethods();  // 本类及父类全部的public方法\n        for (Method method : methods) {\n            System.out.println(\"method = \" + method);\n        }\n        methods = c.getDeclaredMethods();  // 本类的所有方法\n        for (Method method : methods) {\n            System.out.println(\"method = \" + method);\n        }\n        Method method = c.getMethod(\"setAge\", int.class);  // 需要指定形参的类型，因为可能会重载！！！\n        System.out.println(\"method = \" + method);\n\n        // 获得构造器\n        Constructor[] constructors = c.getConstructors();  // 获得public方法\n        for (Constructor constructor : constructors) {\n            System.out.println(\"constructor = \" + constructor);\n        }\n        constructors = c.getDeclaredConstructors();  // 获得本类全部\n        for (Constructor constructor : constructors) {\n            System.out.println(\"constructor = \" + constructor);\n        }\n        Constructor constructor = c.getConstructor(String.class, int.class);  // 获取指定构造器，同样需要传形参的class类，可能会重载！！！\n        System.out.println(\"constructor = \" + constructor);\n    }\n}\n```\n\n\n\n\n\n# 使用\n\n```java\npublic class ReflectUse {\n    public static void main(String[] args) throws IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException {\n        // 拿到类的Class对象\n        Class c = Person.class;\n\n        // 获取构造器（在Java9后使用Class对象直接创建实例的方法已经被抛弃了）\n        Constructor constructorA = c.getDeclaredConstructor(null);\n        Constructor constructorB = c.getDeclaredConstructor(String.class, int.class);\n\n        // 通过构造器创建实例\n        Person person = (Person) constructorA.newInstance(null);\n        System.out.println(\"person = \" + person);\n        Person personB = (Person) constructorB.newInstance(\"Edlison\", 18);\n        System.out.println(\"personB = \" + personB);\n\n        // 通过Class对象获取其中的方法\n        Method setName = c.getMethod(\"setName\", String.class);\n\n        // 执行该方法： 执行的对象 形参\n        setName.invoke(personB, \"edlison\");\n        System.out.println(\"personB = \" + personB);\n\n        // 通过Class对象获取其中的属性\n        Field age = c.getDeclaredField(\"age\");\n        age.setAccessible(true);  // 由于private限制 需要先设置Accessible才可以对其进行操作\n        age.set(personB, 10);\n        System.out.println(\"personB = \" + personB);\n    }\n}\n```\n\n**注意**：\n\n- 通过`invoke`执行获得的类的方法：(需要执行的对象，形参...)\n- 通过`set`对类的属性进行赋值：(需要赋值的对象，形参)\n- 如果属性或方法的可见性为`private`，可以通过设置`setAccessible(true)`来访问。\n\n","slug":"anno_reflect/reflect-class","published":1,"date":"2021-02-02T06:44:51.844Z","updated":"2021-02-02T07:37:22.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xh0009018ogjw41es0","content":"<h1 id=\"获取\"><a href=\"#获取\" class=\"headerlink\" title=\"获取\"></a>获取</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectGet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchMethodException </span>&#123;</span><br><span class=\"line\">        Class c = Person<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类名</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"c.getName() = \"</span> + c.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"c.getSimpleName() = \"</span> + c.getSimpleName());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类的属性</span></span><br><span class=\"line\">        Field[] fields = c.getFields();  <span class=\"comment\">// public属性</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"field = \"</span> + field);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fields = c.getDeclaredFields();  <span class=\"comment\">// 所有属性</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"declaredField = \"</span> + field);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类的方法</span></span><br><span class=\"line\">        Method[] methods = c.getMethods();  <span class=\"comment\">// 本类及父类全部的public方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        methods = c.getDeclaredMethods();  <span class=\"comment\">// 本类的所有方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Method method = c.getMethod(<span class=\"string\">\"setAge\"</span>, <span class=\"keyword\">int</span><span class=\"class\">.<span class=\"keyword\">class</span>)</span>;  <span class=\"comment\">// 需要指定形参的类型，因为可能会重载！！！</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得构造器</span></span><br><span class=\"line\">        Constructor[] constructors = c.getConstructors();  <span class=\"comment\">// 获得public方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Constructor constructor : constructors) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        constructors = c.getDeclaredConstructors();  <span class=\"comment\">// 获得本类全部</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Constructor constructor : constructors) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Constructor constructor = c.getConstructor(String<span class=\"class\">.<span class=\"keyword\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;  <span class=\"comment\">// 获取指定构造器，同样需要传形参的class类，可能会重载！！！</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectUse</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 拿到类的Class对象</span></span><br><span class=\"line\">        Class c = Person<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取构造器（在Java9后使用Class对象直接创建实例的方法已经被抛弃了）</span></span><br><span class=\"line\">        Constructor constructorA = c.getDeclaredConstructor(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        Constructor constructorB = c.getDeclaredConstructor(String<span class=\"class\">.<span class=\"keyword\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过构造器创建实例</span></span><br><span class=\"line\">        Person person = (Person) constructorA.newInstance(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person = \"</span> + person);</span><br><span class=\"line\">        Person personB = (Person) constructorB.newInstance(<span class=\"string\">\"Edlison\"</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过Class对象获取其中的方法</span></span><br><span class=\"line\">        Method setName = c.getMethod(<span class=\"string\">\"setName\"</span>, String<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 执行该方法： 执行的对象 形参</span></span><br><span class=\"line\">        setName.invoke(personB, <span class=\"string\">\"edlison\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过Class对象获取其中的属性</span></span><br><span class=\"line\">        Field age = c.getDeclaredField(<span class=\"string\">\"age\"</span>);</span><br><span class=\"line\">        age.setAccessible(<span class=\"keyword\">true</span>);  <span class=\"comment\">// 由于private限制 需要先设置Accessible才可以对其进行操作</span></span><br><span class=\"line\">        age.set(personB, <span class=\"number\">10</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：</p>\n<ul>\n<li>通过<code>invoke</code>执行获得的类的方法：(需要执行的对象，形参…)</li>\n<li>通过<code>set</code>对类的属性进行赋值：(需要赋值的对象，形参)</li>\n<li>如果属性或方法的可见性为<code>private</code>，可以通过设置<code>setAccessible(true)</code>来访问。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"获取\"><a href=\"#获取\" class=\"headerlink\" title=\"获取\"></a>获取</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectGet</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchMethodException </span>&#123;</span><br><span class=\"line\">        Class c = Person<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类名</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"c.getName() = \"</span> + c.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"c.getSimpleName() = \"</span> + c.getSimpleName());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类的属性</span></span><br><span class=\"line\">        Field[] fields = c.getFields();  <span class=\"comment\">// public属性</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"field = \"</span> + field);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fields = c.getDeclaredFields();  <span class=\"comment\">// 所有属性</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"declaredField = \"</span> + field);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得类的方法</span></span><br><span class=\"line\">        Method[] methods = c.getMethods();  <span class=\"comment\">// 本类及父类全部的public方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        methods = c.getDeclaredMethods();  <span class=\"comment\">// 本类的所有方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Method method = c.getMethod(<span class=\"string\">\"setAge\"</span>, <span class=\"keyword\">int</span><span class=\"class\">.<span class=\"keyword\">class</span>)</span>;  <span class=\"comment\">// 需要指定形参的类型，因为可能会重载！！！</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"method = \"</span> + method);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获得构造器</span></span><br><span class=\"line\">        Constructor[] constructors = c.getConstructors();  <span class=\"comment\">// 获得public方法</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Constructor constructor : constructors) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        constructors = c.getDeclaredConstructors();  <span class=\"comment\">// 获得本类全部</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Constructor constructor : constructors) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Constructor constructor = c.getConstructor(String<span class=\"class\">.<span class=\"keyword\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;  <span class=\"comment\">// 获取指定构造器，同样需要传形参的class类，可能会重载！！！</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"constructor = \"</span> + constructor);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReflectUse</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 拿到类的Class对象</span></span><br><span class=\"line\">        Class c = Person<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取构造器（在Java9后使用Class对象直接创建实例的方法已经被抛弃了）</span></span><br><span class=\"line\">        Constructor constructorA = c.getDeclaredConstructor(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        Constructor constructorB = c.getDeclaredConstructor(String<span class=\"class\">.<span class=\"keyword\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过构造器创建实例</span></span><br><span class=\"line\">        Person person = (Person) constructorA.newInstance(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person = \"</span> + person);</span><br><span class=\"line\">        Person personB = (Person) constructorB.newInstance(<span class=\"string\">\"Edlison\"</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过Class对象获取其中的方法</span></span><br><span class=\"line\">        Method setName = c.getMethod(<span class=\"string\">\"setName\"</span>, String<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 执行该方法： 执行的对象 形参</span></span><br><span class=\"line\">        setName.invoke(personB, <span class=\"string\">\"edlison\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通过Class对象获取其中的属性</span></span><br><span class=\"line\">        Field age = c.getDeclaredField(<span class=\"string\">\"age\"</span>);</span><br><span class=\"line\">        age.setAccessible(<span class=\"keyword\">true</span>);  <span class=\"comment\">// 由于private限制 需要先设置Accessible才可以对其进行操作</span></span><br><span class=\"line\">        age.set(personB, <span class=\"number\">10</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"personB = \"</span> + personB);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：</p>\n<ul>\n<li>通过<code>invoke</code>执行获得的类的方法：(需要执行的对象，形参…)</li>\n<li>通过<code>set</code>对类的属性进行赋值：(需要赋值的对象，形参)</li>\n<li>如果属性或方法的可见性为<code>private</code>，可以通过设置<code>setAccessible(true)</code>来访问。</li>\n</ul>\n"},{"title":"反射 - Start","_content":"\n# 介绍\n\nJava是静态语言。\n\n反射机制的引入，使Java能在执行期借助反射API**获取任何类**的内部信息，并能直接操作任何类的内部属性及方法。\n\n正常方法：\n\n引入'包类'名称 -> new实例化 -> 获得实例化对象\n\n反射方法：\n\n实例化对象 -> `getClass()`方法 -> 得到'包类'名称\n\n**优点**：实现动态创建对象和编译。\n\n**缺点**：性能有影响。\n\n\n\n# 获得反射对象\n\n```java\nClass c1 = Class.forName(\"com.edlison.design.v1.reflection.User\");\nClass c2 = Class.forName(\"com.edlison.design.v1.reflection.User\");\n\nSystem.out.println(c1 == c2);  // true\n```\n\n- **一个类**在内存中只有**一个**`Class`对象\n- 类被加载后，类的**所有信息**都封装在`Class`对象中\n\n## 1. 通过对象获得\n\n```java\nClass c1 = person.getClass();\n```\n\n## 2. 通过`forName`获得\n\n```java\nClass c2=Class.forName(\"com.edlison.design.v1.reflection.Student\");\n```\n\n## 3. 通过类.class获得\n\n```java\nClass c3 = Student.class;\n```\n\n## 4. 内置类型的Type属性\n\n```java\nClass c4 = Integer.TYPE;\n```\n\n## 5. 通过子类获取父类\n\n```java\nClass c5 = Student.class.getSuperclass();\n```\n\n\n\n# 类的初始化\n\n## 过程\n\n加载 -> 链接 -> 初始化\n\n- 类的主动引用（一定会发生类的初始化）\n- 类的被动引用（不会发生类的初始化）\n\n结合JVM进行理解。\n\n\n\n# 类加载器\n\n类加载器是用来把类(Class)装载进内存的，JVM自顶向下定义了如下加载器。\n\n- 引导类加载器：C++编写，负责Java核心库，**类加载器获取不到**。\n- 扩展类加载器：负责`jre/lib/ext`下的Jar包的导入。\n- 系统类加载器：负责`java --classpath`所指目录下类与Jar包的导入。\n\n系统类加载器 -父类> 扩展类加载器 -父类> 引导类加载器\n\n可以依次根据`ClassLoader.getParent()`取得其父类。\n\n**注意**：\n\n- 只有类加载器加载的路径下的Jar包才可以使用。\n- 双亲委派机制。\n\n\n\n","source":"_posts/anno_reflect/reflect-start.md","raw":"---\ntitle: 反射 - Start\ncategories:\n- Notebook\ntags:\n- java\n- 反射\n---\n\n# 介绍\n\nJava是静态语言。\n\n反射机制的引入，使Java能在执行期借助反射API**获取任何类**的内部信息，并能直接操作任何类的内部属性及方法。\n\n正常方法：\n\n引入'包类'名称 -> new实例化 -> 获得实例化对象\n\n反射方法：\n\n实例化对象 -> `getClass()`方法 -> 得到'包类'名称\n\n**优点**：实现动态创建对象和编译。\n\n**缺点**：性能有影响。\n\n\n\n# 获得反射对象\n\n```java\nClass c1 = Class.forName(\"com.edlison.design.v1.reflection.User\");\nClass c2 = Class.forName(\"com.edlison.design.v1.reflection.User\");\n\nSystem.out.println(c1 == c2);  // true\n```\n\n- **一个类**在内存中只有**一个**`Class`对象\n- 类被加载后，类的**所有信息**都封装在`Class`对象中\n\n## 1. 通过对象获得\n\n```java\nClass c1 = person.getClass();\n```\n\n## 2. 通过`forName`获得\n\n```java\nClass c2=Class.forName(\"com.edlison.design.v1.reflection.Student\");\n```\n\n## 3. 通过类.class获得\n\n```java\nClass c3 = Student.class;\n```\n\n## 4. 内置类型的Type属性\n\n```java\nClass c4 = Integer.TYPE;\n```\n\n## 5. 通过子类获取父类\n\n```java\nClass c5 = Student.class.getSuperclass();\n```\n\n\n\n# 类的初始化\n\n## 过程\n\n加载 -> 链接 -> 初始化\n\n- 类的主动引用（一定会发生类的初始化）\n- 类的被动引用（不会发生类的初始化）\n\n结合JVM进行理解。\n\n\n\n# 类加载器\n\n类加载器是用来把类(Class)装载进内存的，JVM自顶向下定义了如下加载器。\n\n- 引导类加载器：C++编写，负责Java核心库，**类加载器获取不到**。\n- 扩展类加载器：负责`jre/lib/ext`下的Jar包的导入。\n- 系统类加载器：负责`java --classpath`所指目录下类与Jar包的导入。\n\n系统类加载器 -父类> 扩展类加载器 -父类> 引导类加载器\n\n可以依次根据`ClassLoader.getParent()`取得其父类。\n\n**注意**：\n\n- 只有类加载器加载的路径下的Jar包才可以使用。\n- 双亲委派机制。\n\n\n\n","slug":"anno_reflect/reflect-start","published":1,"date":"2021-02-02T05:22:59.705Z","updated":"2021-02-02T06:36:21.497Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xi000a018o71oc73ow","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Java是静态语言。</p>\n<p>反射机制的引入，使Java能在执行期借助反射API<strong>获取任何类</strong>的内部信息，并能直接操作任何类的内部属性及方法。</p>\n<p>正常方法：</p>\n<p>引入’包类’名称 -&gt; new实例化 -&gt; 获得实例化对象</p>\n<p>反射方法：</p>\n<p>实例化对象 -&gt; <code>getClass()</code>方法 -&gt; 得到’包类’名称</p>\n<p><strong>优点</strong>：实现动态创建对象和编译。</p>\n<p><strong>缺点</strong>：性能有影响。</p>\n<h1 id=\"获得反射对象\"><a href=\"#获得反射对象\" class=\"headerlink\" title=\"获得反射对象\"></a>获得反射对象</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c1 = Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.User\"</span>);</span><br><span class=\"line\">Class c2 = Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.User\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">System.out.println(c1 == c2);  <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>一个类</strong>在内存中只有<strong>一个</strong><code>Class</code>对象</li>\n<li>类被加载后，类的<strong>所有信息</strong>都封装在<code>Class</code>对象中</li>\n</ul>\n<h2 id=\"1-通过对象获得\"><a href=\"#1-通过对象获得\" class=\"headerlink\" title=\"1. 通过对象获得\"></a>1. 通过对象获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c1 = person.getClass();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-通过forName获得\"><a href=\"#2-通过forName获得\" class=\"headerlink\" title=\"2. 通过forName获得\"></a>2. 通过<code>forName</code>获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c2=Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.Student\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-通过类-class获得\"><a href=\"#3-通过类-class获得\" class=\"headerlink\" title=\"3. 通过类.class获得\"></a>3. 通过类.class获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c3 = Student<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-内置类型的Type属性\"><a href=\"#4-内置类型的Type属性\" class=\"headerlink\" title=\"4. 内置类型的Type属性\"></a>4. 内置类型的Type属性</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c4 = Integer.TYPE;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-通过子类获取父类\"><a href=\"#5-通过子类获取父类\" class=\"headerlink\" title=\"5. 通过子类获取父类\"></a>5. 通过子类获取父类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c5 = Student<span class=\"class\">.<span class=\"keyword\">class</span>.<span class=\"title\">getSuperclass</span>()</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"类的初始化\"><a href=\"#类的初始化\" class=\"headerlink\" title=\"类的初始化\"></a>类的初始化</h1><h2 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h2><p>加载 -&gt; 链接 -&gt; 初始化</p>\n<ul>\n<li>类的主动引用（一定会发生类的初始化）</li>\n<li>类的被动引用（不会发生类的初始化）</li>\n</ul>\n<p>结合JVM进行理解。</p>\n<h1 id=\"类加载器\"><a href=\"#类加载器\" class=\"headerlink\" title=\"类加载器\"></a>类加载器</h1><p>类加载器是用来把类(Class)装载进内存的，JVM自顶向下定义了如下加载器。</p>\n<ul>\n<li>引导类加载器：C++编写，负责Java核心库，<strong>类加载器获取不到</strong>。</li>\n<li>扩展类加载器：负责<code>jre/lib/ext</code>下的Jar包的导入。</li>\n<li>系统类加载器：负责<code>java --classpath</code>所指目录下类与Jar包的导入。</li>\n</ul>\n<p>系统类加载器 -父类&gt; 扩展类加载器 -父类&gt; 引导类加载器</p>\n<p>可以依次根据<code>ClassLoader.getParent()</code>取得其父类。</p>\n<p><strong>注意</strong>：</p>\n<ul>\n<li>只有类加载器加载的路径下的Jar包才可以使用。</li>\n<li>双亲委派机制。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Java是静态语言。</p>\n<p>反射机制的引入，使Java能在执行期借助反射API<strong>获取任何类</strong>的内部信息，并能直接操作任何类的内部属性及方法。</p>\n<p>正常方法：</p>\n<p>引入’包类’名称 -&gt; new实例化 -&gt; 获得实例化对象</p>\n<p>反射方法：</p>\n<p>实例化对象 -&gt; <code>getClass()</code>方法 -&gt; 得到’包类’名称</p>\n<p><strong>优点</strong>：实现动态创建对象和编译。</p>\n<p><strong>缺点</strong>：性能有影响。</p>\n<h1 id=\"获得反射对象\"><a href=\"#获得反射对象\" class=\"headerlink\" title=\"获得反射对象\"></a>获得反射对象</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c1 = Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.User\"</span>);</span><br><span class=\"line\">Class c2 = Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.User\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">System.out.println(c1 == c2);  <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>一个类</strong>在内存中只有<strong>一个</strong><code>Class</code>对象</li>\n<li>类被加载后，类的<strong>所有信息</strong>都封装在<code>Class</code>对象中</li>\n</ul>\n<h2 id=\"1-通过对象获得\"><a href=\"#1-通过对象获得\" class=\"headerlink\" title=\"1. 通过对象获得\"></a>1. 通过对象获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c1 = person.getClass();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-通过forName获得\"><a href=\"#2-通过forName获得\" class=\"headerlink\" title=\"2. 通过forName获得\"></a>2. 通过<code>forName</code>获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c2=Class.forName(<span class=\"string\">\"com.edlison.design.v1.reflection.Student\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-通过类-class获得\"><a href=\"#3-通过类-class获得\" class=\"headerlink\" title=\"3. 通过类.class获得\"></a>3. 通过类.class获得</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c3 = Student<span class=\"class\">.<span class=\"keyword\">class</span></span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-内置类型的Type属性\"><a href=\"#4-内置类型的Type属性\" class=\"headerlink\" title=\"4. 内置类型的Type属性\"></a>4. 内置类型的Type属性</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c4 = Integer.TYPE;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-通过子类获取父类\"><a href=\"#5-通过子类获取父类\" class=\"headerlink\" title=\"5. 通过子类获取父类\"></a>5. 通过子类获取父类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class c5 = Student<span class=\"class\">.<span class=\"keyword\">class</span>.<span class=\"title\">getSuperclass</span>()</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"类的初始化\"><a href=\"#类的初始化\" class=\"headerlink\" title=\"类的初始化\"></a>类的初始化</h1><h2 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h2><p>加载 -&gt; 链接 -&gt; 初始化</p>\n<ul>\n<li>类的主动引用（一定会发生类的初始化）</li>\n<li>类的被动引用（不会发生类的初始化）</li>\n</ul>\n<p>结合JVM进行理解。</p>\n<h1 id=\"类加载器\"><a href=\"#类加载器\" class=\"headerlink\" title=\"类加载器\"></a>类加载器</h1><p>类加载器是用来把类(Class)装载进内存的，JVM自顶向下定义了如下加载器。</p>\n<ul>\n<li>引导类加载器：C++编写，负责Java核心库，<strong>类加载器获取不到</strong>。</li>\n<li>扩展类加载器：负责<code>jre/lib/ext</code>下的Jar包的导入。</li>\n<li>系统类加载器：负责<code>java --classpath</code>所指目录下类与Jar包的导入。</li>\n</ul>\n<p>系统类加载器 -父类&gt; 扩展类加载器 -父类&gt; 引导类加载器</p>\n<p>可以依次根据<code>ClassLoader.getParent()</code>取得其父类。</p>\n<p><strong>注意</strong>：</p>\n<ul>\n<li>只有类加载器加载的路径下的Jar包才可以使用。</li>\n<li>双亲委派机制。</li>\n</ul>\n"},{"title":"共识机制","catagories":["BlockChain"],"_content":"\n# 开始\n\n共识机制(Consensus Mechanism)，是一种确定某种共识的方式。\n\n区块链的本质是去中心化，去中心化的核心是共识机制，这决定了区块链的运作方式。如果所有人都信任这种方式，那也就会信任之于它上的服务。\n\n# POW\n\n工作量证明机制(Proof of Work)。\n\n谁先计算出下一个区块就归谁。没有计算出来的只能归零，重新计算。\n\n# POS\n\n权益证明机制(Proof of Stake)。\n\n通过持有的Token数量和时长来决定获得记账的几率。\n\n# PBFT\n\n拜占庭共识算法(Practical Byzantine Fault Tolerance)。\n\n以计算为基础，但是没有Token奖励，由链上所有人参与投票，少于(N-1)/3个节点反对就获得公示信息的权利。\n\n# POA\n\nProof of Activity = POW+POS\n\n所有活跃的节点进行计算，找到满足条件的区块后对所有的活跃节点进行广播验证。在所有活跃节点中选出N个节点，他们共同决定？\n\n# DPOS\n\n委托权益证明机制(Delegated Proof of Stake)。\n\n类似于董事会投票，拥有Token的人投票给固定的节点，选取代理人，代理人负责验证和记账。\n\n# Pool\n\n验证池共识机制。\n\n传统的分布式一致性技术，加上数据验证的机制。\n\n# 硬分叉与软分叉\n\n分叉就是在原有的链条上出现了无法达成共识的部分。\n\n**硬分叉**是指区块链发生永久性分歧，在新共识规则发布之后，部分没有升级的节点无法验证已经升级的节点生产的区块，已经升级的节点可以验证，**大家各自延续自己认为正确的链**，分成了两条链。\n\n**软分叉**是指在新共识发布后，没有升级的节点因为不知道新共识的规则，而产生不合法的区块，就会产生临时性的分叉。\n\n# 总结\n\n每一种共识机制都不能同时满足**安全**，**效率**。\n\n去中心化程度越低，安全性越低，速度越快。\n\n去中心化程度越高，安全性越高，速度越慢。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/question/351103433\n\n\n\n\n\n","source":"_posts/blockchain/consensus.md","raw":"---\ntitle: 共识机制\ncatagories:\n- BlockChain\ntags: \n- consensus\n---\n\n# 开始\n\n共识机制(Consensus Mechanism)，是一种确定某种共识的方式。\n\n区块链的本质是去中心化，去中心化的核心是共识机制，这决定了区块链的运作方式。如果所有人都信任这种方式，那也就会信任之于它上的服务。\n\n# POW\n\n工作量证明机制(Proof of Work)。\n\n谁先计算出下一个区块就归谁。没有计算出来的只能归零，重新计算。\n\n# POS\n\n权益证明机制(Proof of Stake)。\n\n通过持有的Token数量和时长来决定获得记账的几率。\n\n# PBFT\n\n拜占庭共识算法(Practical Byzantine Fault Tolerance)。\n\n以计算为基础，但是没有Token奖励，由链上所有人参与投票，少于(N-1)/3个节点反对就获得公示信息的权利。\n\n# POA\n\nProof of Activity = POW+POS\n\n所有活跃的节点进行计算，找到满足条件的区块后对所有的活跃节点进行广播验证。在所有活跃节点中选出N个节点，他们共同决定？\n\n# DPOS\n\n委托权益证明机制(Delegated Proof of Stake)。\n\n类似于董事会投票，拥有Token的人投票给固定的节点，选取代理人，代理人负责验证和记账。\n\n# Pool\n\n验证池共识机制。\n\n传统的分布式一致性技术，加上数据验证的机制。\n\n# 硬分叉与软分叉\n\n分叉就是在原有的链条上出现了无法达成共识的部分。\n\n**硬分叉**是指区块链发生永久性分歧，在新共识规则发布之后，部分没有升级的节点无法验证已经升级的节点生产的区块，已经升级的节点可以验证，**大家各自延续自己认为正确的链**，分成了两条链。\n\n**软分叉**是指在新共识发布后，没有升级的节点因为不知道新共识的规则，而产生不合法的区块，就会产生临时性的分叉。\n\n# 总结\n\n每一种共识机制都不能同时满足**安全**，**效率**。\n\n去中心化程度越低，安全性越低，速度越快。\n\n去中心化程度越高，安全性越高，速度越慢。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/question/351103433\n\n\n\n\n\n","slug":"blockchain/consensus","published":1,"date":"2021-02-22T11:03:56.705Z","updated":"2021-02-22T14:55:06.762Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xj000b018o7o6442ji","content":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>共识机制(Consensus Mechanism)，是一种确定某种共识的方式。</p>\n<p>区块链的本质是去中心化，去中心化的核心是共识机制，这决定了区块链的运作方式。如果所有人都信任这种方式，那也就会信任之于它上的服务。</p>\n<h1 id=\"POW\"><a href=\"#POW\" class=\"headerlink\" title=\"POW\"></a>POW</h1><p>工作量证明机制(Proof of Work)。</p>\n<p>谁先计算出下一个区块就归谁。没有计算出来的只能归零，重新计算。</p>\n<h1 id=\"POS\"><a href=\"#POS\" class=\"headerlink\" title=\"POS\"></a>POS</h1><p>权益证明机制(Proof of Stake)。</p>\n<p>通过持有的Token数量和时长来决定获得记账的几率。</p>\n<h1 id=\"PBFT\"><a href=\"#PBFT\" class=\"headerlink\" title=\"PBFT\"></a>PBFT</h1><p>拜占庭共识算法(Practical Byzantine Fault Tolerance)。</p>\n<p>以计算为基础，但是没有Token奖励，由链上所有人参与投票，少于(N-1)/3个节点反对就获得公示信息的权利。</p>\n<h1 id=\"POA\"><a href=\"#POA\" class=\"headerlink\" title=\"POA\"></a>POA</h1><p>Proof of Activity = POW+POS</p>\n<p>所有活跃的节点进行计算，找到满足条件的区块后对所有的活跃节点进行广播验证。在所有活跃节点中选出N个节点，他们共同决定？</p>\n<h1 id=\"DPOS\"><a href=\"#DPOS\" class=\"headerlink\" title=\"DPOS\"></a>DPOS</h1><p>委托权益证明机制(Delegated Proof of Stake)。</p>\n<p>类似于董事会投票，拥有Token的人投票给固定的节点，选取代理人，代理人负责验证和记账。</p>\n<h1 id=\"Pool\"><a href=\"#Pool\" class=\"headerlink\" title=\"Pool\"></a>Pool</h1><p>验证池共识机制。</p>\n<p>传统的分布式一致性技术，加上数据验证的机制。</p>\n<h1 id=\"硬分叉与软分叉\"><a href=\"#硬分叉与软分叉\" class=\"headerlink\" title=\"硬分叉与软分叉\"></a>硬分叉与软分叉</h1><p>分叉就是在原有的链条上出现了无法达成共识的部分。</p>\n<p><strong>硬分叉</strong>是指区块链发生永久性分歧，在新共识规则发布之后，部分没有升级的节点无法验证已经升级的节点生产的区块，已经升级的节点可以验证，<strong>大家各自延续自己认为正确的链</strong>，分成了两条链。</p>\n<p><strong>软分叉</strong>是指在新共识发布后，没有升级的节点因为不知道新共识的规则，而产生不合法的区块，就会产生临时性的分叉。</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>每一种共识机制都不能同时满足<strong>安全</strong>，<strong>效率</strong>。</p>\n<p>去中心化程度越低，安全性越低，速度越快。</p>\n<p>去中心化程度越高，安全性越高，速度越慢。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM1MTEwMzQzMw==\">https://www.zhihu.com/question/351103433<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>共识机制(Consensus Mechanism)，是一种确定某种共识的方式。</p>\n<p>区块链的本质是去中心化，去中心化的核心是共识机制，这决定了区块链的运作方式。如果所有人都信任这种方式，那也就会信任之于它上的服务。</p>\n<h1 id=\"POW\"><a href=\"#POW\" class=\"headerlink\" title=\"POW\"></a>POW</h1><p>工作量证明机制(Proof of Work)。</p>\n<p>谁先计算出下一个区块就归谁。没有计算出来的只能归零，重新计算。</p>\n<h1 id=\"POS\"><a href=\"#POS\" class=\"headerlink\" title=\"POS\"></a>POS</h1><p>权益证明机制(Proof of Stake)。</p>\n<p>通过持有的Token数量和时长来决定获得记账的几率。</p>\n<h1 id=\"PBFT\"><a href=\"#PBFT\" class=\"headerlink\" title=\"PBFT\"></a>PBFT</h1><p>拜占庭共识算法(Practical Byzantine Fault Tolerance)。</p>\n<p>以计算为基础，但是没有Token奖励，由链上所有人参与投票，少于(N-1)/3个节点反对就获得公示信息的权利。</p>\n<h1 id=\"POA\"><a href=\"#POA\" class=\"headerlink\" title=\"POA\"></a>POA</h1><p>Proof of Activity = POW+POS</p>\n<p>所有活跃的节点进行计算，找到满足条件的区块后对所有的活跃节点进行广播验证。在所有活跃节点中选出N个节点，他们共同决定？</p>\n<h1 id=\"DPOS\"><a href=\"#DPOS\" class=\"headerlink\" title=\"DPOS\"></a>DPOS</h1><p>委托权益证明机制(Delegated Proof of Stake)。</p>\n<p>类似于董事会投票，拥有Token的人投票给固定的节点，选取代理人，代理人负责验证和记账。</p>\n<h1 id=\"Pool\"><a href=\"#Pool\" class=\"headerlink\" title=\"Pool\"></a>Pool</h1><p>验证池共识机制。</p>\n<p>传统的分布式一致性技术，加上数据验证的机制。</p>\n<h1 id=\"硬分叉与软分叉\"><a href=\"#硬分叉与软分叉\" class=\"headerlink\" title=\"硬分叉与软分叉\"></a>硬分叉与软分叉</h1><p>分叉就是在原有的链条上出现了无法达成共识的部分。</p>\n<p><strong>硬分叉</strong>是指区块链发生永久性分歧，在新共识规则发布之后，部分没有升级的节点无法验证已经升级的节点生产的区块，已经升级的节点可以验证，<strong>大家各自延续自己认为正确的链</strong>，分成了两条链。</p>\n<p><strong>软分叉</strong>是指在新共识发布后，没有升级的节点因为不知道新共识的规则，而产生不合法的区块，就会产生临时性的分叉。</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>每一种共识机制都不能同时满足<strong>安全</strong>，<strong>效率</strong>。</p>\n<p>去中心化程度越低，安全性越低，速度越快。</p>\n<p>去中心化程度越高，安全性越高，速度越慢。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM1MTEwMzQzMw==\">https://www.zhihu.com/question/351103433<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"ETH - 发行自己的Token","catagories":["BlockChain"],"_content":"\n# 开始\n\n通过以太坊的**智能合约**可以编写自己的代币(Token)，可以代表任何可以交易的东西，如：积分，财产，证书等等。\n\n# 合约代码\n\n如果想要在以太坊的区块链上创建代币，就需要实现它的**代币标准**。\n\n## ZZC Token源码\n\n```solidity\npragma solidity ^0.4.16;\n\ninterface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; }\n\ncontract TokenERC20 {\n    string public name;\n    string public symbol;\n    uint8 public decimals = 18;  // 18 是建议的默认值\n    uint256 public totalSupply;\n\n    mapping (address => uint256) public balanceOf;  //\n    mapping (address => mapping (address => uint256)) public allowance;\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n\n    event Burn(address indexed from, uint256 value);\n\n\n    function TokenERC20(uint256 initialSupply, string tokenName, string tokenSymbol) public {\n        totalSupply = initialSupply * 10 ** uint256(decimals);\n        balanceOf[msg.sender] = totalSupply;\n        name = tokenName;\n        symbol = tokenSymbol;\n    }\n\n\n    function _transfer(address _from, address _to, uint _value) internal {\n        require(_to != 0x0);\n        require(balanceOf[_from] >= _value);\n        require(balanceOf[_to] + _value > balanceOf[_to]);\n        uint previousBalances = balanceOf[_from] + balanceOf[_to];\n        balanceOf[_from] -= _value;\n        balanceOf[_to] += _value;\n        Transfer(_from, _to, _value);\n        assert(balanceOf[_from] + balanceOf[_to] == previousBalances);\n    }\n\n    function transfer(address _to, uint256 _value) public returns (bool) {\n        _transfer(msg.sender, _to, _value);\n        return true;\n    }\n\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        require(_value <= allowance[_from][msg.sender]);     // Check allowance\n        allowance[_from][msg.sender] -= _value;\n        _transfer(_from, _to, _value);\n        return true;\n    }\n\n    function approve(address _spender, uint256 _value) public\n        returns (bool success) {\n        allowance[msg.sender][_spender] = _value;\n        return true;\n    }\n\n    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n        tokenRecipient spender = tokenRecipient(_spender);\n        if (approve(_spender, _value)) {\n            spender.receiveApproval(msg.sender, _value, this, _extraData);\n            return true;\n        }\n    }\n\n    function burn(uint256 _value) public returns (bool success) {\n        require(balanceOf[msg.sender] >= _value);\n        balanceOf[msg.sender] -= _value;\n        totalSupply -= _value;\n        Burn(msg.sender, _value);\n        return true;\n    }\n\n    function burnFrom(address _from, uint256 _value) public returns (bool success) {\n        require(balanceOf[_from] >= _value);\n        require(_value <= allowance[_from][msg.sender]);\n        balanceOf[_from] -= _value;\n        allowance[_from][msg.sender] -= _value;\n        totalSupply -= _value;\n        Burn(_from, _value);\n        return true;\n    }\n}\n\n```\n\n# 部署合约\n\n## 方式\n\n1. Geth编译代码\n2. etherrum wallet钱包部署合约\n3. MetaMask钱包 + Remix Solidity IDE部署\n\n## Meta Mask + Remix Solidity IDE\n\n1. 创建钱包，转到测试网络Ropsten.\n2. 在Remix Solidity IDE中对合约代码进行编程。\n3. 对其**编译**\n\n选择对应的编译器版本。\n\n4. 进行**发布**\n\nEnvironment: Injected Web3\n\nAccount: xxxxx(会自动读取Meta Mask的账户)\n\n选择编译好的文件\n\n构造函数传参\n\n在Meta Mask中对合约部署进行确认。\n\n5. 添加自定义的Token\n\n# 公布源码\n\n在etherscan.io上进入到合约地址。\n\n贴上源代码，它会对**源码进行编译**，将字节码与区块`DATA`内的**字节码进行比对**，需要完全一样。\n\n之后就可以ICO了。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://learnblockchain.cn/2018/01/12/create_token\n\nhttps://blog.csdn.net/java_hhhh/article/details/79771752","source":"_posts/blockchain/eth-token.md","raw":"---\ntitle: ETH - 发行自己的Token\ncatagories:\n- BlockChain\ntags:\n- eth\n---\n\n# 开始\n\n通过以太坊的**智能合约**可以编写自己的代币(Token)，可以代表任何可以交易的东西，如：积分，财产，证书等等。\n\n# 合约代码\n\n如果想要在以太坊的区块链上创建代币，就需要实现它的**代币标准**。\n\n## ZZC Token源码\n\n```solidity\npragma solidity ^0.4.16;\n\ninterface tokenRecipient { function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; }\n\ncontract TokenERC20 {\n    string public name;\n    string public symbol;\n    uint8 public decimals = 18;  // 18 是建议的默认值\n    uint256 public totalSupply;\n\n    mapping (address => uint256) public balanceOf;  //\n    mapping (address => mapping (address => uint256)) public allowance;\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n\n    event Burn(address indexed from, uint256 value);\n\n\n    function TokenERC20(uint256 initialSupply, string tokenName, string tokenSymbol) public {\n        totalSupply = initialSupply * 10 ** uint256(decimals);\n        balanceOf[msg.sender] = totalSupply;\n        name = tokenName;\n        symbol = tokenSymbol;\n    }\n\n\n    function _transfer(address _from, address _to, uint _value) internal {\n        require(_to != 0x0);\n        require(balanceOf[_from] >= _value);\n        require(balanceOf[_to] + _value > balanceOf[_to]);\n        uint previousBalances = balanceOf[_from] + balanceOf[_to];\n        balanceOf[_from] -= _value;\n        balanceOf[_to] += _value;\n        Transfer(_from, _to, _value);\n        assert(balanceOf[_from] + balanceOf[_to] == previousBalances);\n    }\n\n    function transfer(address _to, uint256 _value) public returns (bool) {\n        _transfer(msg.sender, _to, _value);\n        return true;\n    }\n\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) {\n        require(_value <= allowance[_from][msg.sender]);     // Check allowance\n        allowance[_from][msg.sender] -= _value;\n        _transfer(_from, _to, _value);\n        return true;\n    }\n\n    function approve(address _spender, uint256 _value) public\n        returns (bool success) {\n        allowance[msg.sender][_spender] = _value;\n        return true;\n    }\n\n    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) {\n        tokenRecipient spender = tokenRecipient(_spender);\n        if (approve(_spender, _value)) {\n            spender.receiveApproval(msg.sender, _value, this, _extraData);\n            return true;\n        }\n    }\n\n    function burn(uint256 _value) public returns (bool success) {\n        require(balanceOf[msg.sender] >= _value);\n        balanceOf[msg.sender] -= _value;\n        totalSupply -= _value;\n        Burn(msg.sender, _value);\n        return true;\n    }\n\n    function burnFrom(address _from, uint256 _value) public returns (bool success) {\n        require(balanceOf[_from] >= _value);\n        require(_value <= allowance[_from][msg.sender]);\n        balanceOf[_from] -= _value;\n        allowance[_from][msg.sender] -= _value;\n        totalSupply -= _value;\n        Burn(_from, _value);\n        return true;\n    }\n}\n\n```\n\n# 部署合约\n\n## 方式\n\n1. Geth编译代码\n2. etherrum wallet钱包部署合约\n3. MetaMask钱包 + Remix Solidity IDE部署\n\n## Meta Mask + Remix Solidity IDE\n\n1. 创建钱包，转到测试网络Ropsten.\n2. 在Remix Solidity IDE中对合约代码进行编程。\n3. 对其**编译**\n\n选择对应的编译器版本。\n\n4. 进行**发布**\n\nEnvironment: Injected Web3\n\nAccount: xxxxx(会自动读取Meta Mask的账户)\n\n选择编译好的文件\n\n构造函数传参\n\n在Meta Mask中对合约部署进行确认。\n\n5. 添加自定义的Token\n\n# 公布源码\n\n在etherscan.io上进入到合约地址。\n\n贴上源代码，它会对**源码进行编译**，将字节码与区块`DATA`内的**字节码进行比对**，需要完全一样。\n\n之后就可以ICO了。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://learnblockchain.cn/2018/01/12/create_token\n\nhttps://blog.csdn.net/java_hhhh/article/details/79771752","slug":"blockchain/eth-token","published":1,"date":"2021-02-22T07:50:50.637Z","updated":"2021-02-22T12:07:54.803Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xm000e018o6r9g6wf2","content":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>通过以太坊的<strong>智能合约</strong>可以编写自己的代币(Token)，可以代表任何可以交易的东西，如：积分，财产，证书等等。</p>\n<h1 id=\"合约代码\"><a href=\"#合约代码\" class=\"headerlink\" title=\"合约代码\"></a>合约代码</h1><p>如果想要在以太坊的区块链上创建代币，就需要实现它的<strong>代币标准</strong>。</p>\n<h2 id=\"ZZC-Token源码\"><a href=\"#ZZC-Token源码\" class=\"headerlink\" title=\"ZZC Token源码\"></a>ZZC Token源码</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pragma solidity ^0.4.16;</span><br><span class=\"line\"></span><br><span class=\"line\">interface tokenRecipient &#123; function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">contract TokenERC20 &#123;</span><br><span class=\"line\">    string public name;</span><br><span class=\"line\">    string public symbol;</span><br><span class=\"line\">    uint8 public decimals &#x3D; 18;  &#x2F;&#x2F; 18 是建议的默认值</span><br><span class=\"line\">    uint256 public totalSupply;</span><br><span class=\"line\"></span><br><span class=\"line\">    mapping (address &#x3D;&gt; uint256) public balanceOf;  &#x2F;&#x2F;</span><br><span class=\"line\">    mapping (address &#x3D;&gt; mapping (address &#x3D;&gt; uint256)) public allowance;</span><br><span class=\"line\"></span><br><span class=\"line\">    event Transfer(address indexed from, address indexed to, uint256 value);</span><br><span class=\"line\"></span><br><span class=\"line\">    event Burn(address indexed from, uint256 value);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    function TokenERC20(uint256 initialSupply, string tokenName, string tokenSymbol) public &#123;</span><br><span class=\"line\">        totalSupply &#x3D; initialSupply * 10 ** uint256(decimals);</span><br><span class=\"line\">        balanceOf[msg.sender] &#x3D; totalSupply;</span><br><span class=\"line\">        name &#x3D; tokenName;</span><br><span class=\"line\">        symbol &#x3D; tokenSymbol;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    function _transfer(address _from, address _to, uint _value) internal &#123;</span><br><span class=\"line\">        require(_to !&#x3D; 0x0);</span><br><span class=\"line\">        require(balanceOf[_from] &gt;&#x3D; _value);</span><br><span class=\"line\">        require(balanceOf[_to] + _value &gt; balanceOf[_to]);</span><br><span class=\"line\">        uint previousBalances &#x3D; balanceOf[_from] + balanceOf[_to];</span><br><span class=\"line\">        balanceOf[_from] -&#x3D; _value;</span><br><span class=\"line\">        balanceOf[_to] +&#x3D; _value;</span><br><span class=\"line\">        Transfer(_from, _to, _value);</span><br><span class=\"line\">        assert(balanceOf[_from] + balanceOf[_to] &#x3D;&#x3D; previousBalances);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function transfer(address _to, uint256 _value) public returns (bool) &#123;</span><br><span class=\"line\">        _transfer(msg.sender, _to, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(_value &lt;&#x3D; allowance[_from][msg.sender]);     &#x2F;&#x2F; Check allowance</span><br><span class=\"line\">        allowance[_from][msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        _transfer(_from, _to, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function approve(address _spender, uint256 _value) public</span><br><span class=\"line\">        returns (bool success) &#123;</span><br><span class=\"line\">        allowance[msg.sender][_spender] &#x3D; _value;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) &#123;</span><br><span class=\"line\">        tokenRecipient spender &#x3D; tokenRecipient(_spender);</span><br><span class=\"line\">        if (approve(_spender, _value)) &#123;</span><br><span class=\"line\">            spender.receiveApproval(msg.sender, _value, this, _extraData);</span><br><span class=\"line\">            return true;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function burn(uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(balanceOf[msg.sender] &gt;&#x3D; _value);</span><br><span class=\"line\">        balanceOf[msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        totalSupply -&#x3D; _value;</span><br><span class=\"line\">        Burn(msg.sender, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function burnFrom(address _from, uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(balanceOf[_from] &gt;&#x3D; _value);</span><br><span class=\"line\">        require(_value &lt;&#x3D; allowance[_from][msg.sender]);</span><br><span class=\"line\">        balanceOf[_from] -&#x3D; _value;</span><br><span class=\"line\">        allowance[_from][msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        totalSupply -&#x3D; _value;</span><br><span class=\"line\">        Burn(_from, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"部署合约\"><a href=\"#部署合约\" class=\"headerlink\" title=\"部署合约\"></a>部署合约</h1><h2 id=\"方式\"><a href=\"#方式\" class=\"headerlink\" title=\"方式\"></a>方式</h2><ol>\n<li>Geth编译代码</li>\n<li>etherrum wallet钱包部署合约</li>\n<li>MetaMask钱包 + Remix Solidity IDE部署</li>\n</ol>\n<h2 id=\"Meta-Mask-Remix-Solidity-IDE\"><a href=\"#Meta-Mask-Remix-Solidity-IDE\" class=\"headerlink\" title=\"Meta Mask + Remix Solidity IDE\"></a>Meta Mask + Remix Solidity IDE</h2><ol>\n<li>创建钱包，转到测试网络Ropsten.</li>\n<li>在Remix Solidity IDE中对合约代码进行编程。</li>\n<li>对其<strong>编译</strong></li>\n</ol>\n<p>选择对应的编译器版本。</p>\n<ol start=\"4\">\n<li>进行<strong>发布</strong></li>\n</ol>\n<p>Environment: Injected Web3</p>\n<p>Account: xxxxx(会自动读取Meta Mask的账户)</p>\n<p>选择编译好的文件</p>\n<p>构造函数传参</p>\n<p>在Meta Mask中对合约部署进行确认。</p>\n<ol start=\"5\">\n<li>添加自定义的Token</li>\n</ol>\n<h1 id=\"公布源码\"><a href=\"#公布源码\" class=\"headerlink\" title=\"公布源码\"></a>公布源码</h1><p>在etherscan.io上进入到合约地址。</p>\n<p>贴上源代码，它会对<strong>源码进行编译</strong>，将字节码与区块<code>DATA</code>内的<strong>字节码进行比对</strong>，需要完全一样。</p>\n<p>之后就可以ICO了。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybmJsb2NrY2hhaW4uY24vMjAxOC8wMS8xMi9jcmVhdGVfdG9rZW4=\">https://learnblockchain.cn/2018/01/12/create_token<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phdmFfaGhoaC9hcnRpY2xlL2RldGFpbHMvNzk3NzE3NTI=\">https://blog.csdn.net/java_hhhh/article/details/79771752<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>通过以太坊的<strong>智能合约</strong>可以编写自己的代币(Token)，可以代表任何可以交易的东西，如：积分，财产，证书等等。</p>\n<h1 id=\"合约代码\"><a href=\"#合约代码\" class=\"headerlink\" title=\"合约代码\"></a>合约代码</h1><p>如果想要在以太坊的区块链上创建代币，就需要实现它的<strong>代币标准</strong>。</p>\n<h2 id=\"ZZC-Token源码\"><a href=\"#ZZC-Token源码\" class=\"headerlink\" title=\"ZZC Token源码\"></a>ZZC Token源码</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pragma solidity ^0.4.16;</span><br><span class=\"line\"></span><br><span class=\"line\">interface tokenRecipient &#123; function receiveApproval(address _from, uint256 _value, address _token, bytes _extraData) public; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">contract TokenERC20 &#123;</span><br><span class=\"line\">    string public name;</span><br><span class=\"line\">    string public symbol;</span><br><span class=\"line\">    uint8 public decimals &#x3D; 18;  &#x2F;&#x2F; 18 是建议的默认值</span><br><span class=\"line\">    uint256 public totalSupply;</span><br><span class=\"line\"></span><br><span class=\"line\">    mapping (address &#x3D;&gt; uint256) public balanceOf;  &#x2F;&#x2F;</span><br><span class=\"line\">    mapping (address &#x3D;&gt; mapping (address &#x3D;&gt; uint256)) public allowance;</span><br><span class=\"line\"></span><br><span class=\"line\">    event Transfer(address indexed from, address indexed to, uint256 value);</span><br><span class=\"line\"></span><br><span class=\"line\">    event Burn(address indexed from, uint256 value);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    function TokenERC20(uint256 initialSupply, string tokenName, string tokenSymbol) public &#123;</span><br><span class=\"line\">        totalSupply &#x3D; initialSupply * 10 ** uint256(decimals);</span><br><span class=\"line\">        balanceOf[msg.sender] &#x3D; totalSupply;</span><br><span class=\"line\">        name &#x3D; tokenName;</span><br><span class=\"line\">        symbol &#x3D; tokenSymbol;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    function _transfer(address _from, address _to, uint _value) internal &#123;</span><br><span class=\"line\">        require(_to !&#x3D; 0x0);</span><br><span class=\"line\">        require(balanceOf[_from] &gt;&#x3D; _value);</span><br><span class=\"line\">        require(balanceOf[_to] + _value &gt; balanceOf[_to]);</span><br><span class=\"line\">        uint previousBalances &#x3D; balanceOf[_from] + balanceOf[_to];</span><br><span class=\"line\">        balanceOf[_from] -&#x3D; _value;</span><br><span class=\"line\">        balanceOf[_to] +&#x3D; _value;</span><br><span class=\"line\">        Transfer(_from, _to, _value);</span><br><span class=\"line\">        assert(balanceOf[_from] + balanceOf[_to] &#x3D;&#x3D; previousBalances);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function transfer(address _to, uint256 _value) public returns (bool) &#123;</span><br><span class=\"line\">        _transfer(msg.sender, _to, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(_value &lt;&#x3D; allowance[_from][msg.sender]);     &#x2F;&#x2F; Check allowance</span><br><span class=\"line\">        allowance[_from][msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        _transfer(_from, _to, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function approve(address _spender, uint256 _value) public</span><br><span class=\"line\">        returns (bool success) &#123;</span><br><span class=\"line\">        allowance[msg.sender][_spender] &#x3D; _value;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function approveAndCall(address _spender, uint256 _value, bytes _extraData) public returns (bool success) &#123;</span><br><span class=\"line\">        tokenRecipient spender &#x3D; tokenRecipient(_spender);</span><br><span class=\"line\">        if (approve(_spender, _value)) &#123;</span><br><span class=\"line\">            spender.receiveApproval(msg.sender, _value, this, _extraData);</span><br><span class=\"line\">            return true;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function burn(uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(balanceOf[msg.sender] &gt;&#x3D; _value);</span><br><span class=\"line\">        balanceOf[msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        totalSupply -&#x3D; _value;</span><br><span class=\"line\">        Burn(msg.sender, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function burnFrom(address _from, uint256 _value) public returns (bool success) &#123;</span><br><span class=\"line\">        require(balanceOf[_from] &gt;&#x3D; _value);</span><br><span class=\"line\">        require(_value &lt;&#x3D; allowance[_from][msg.sender]);</span><br><span class=\"line\">        balanceOf[_from] -&#x3D; _value;</span><br><span class=\"line\">        allowance[_from][msg.sender] -&#x3D; _value;</span><br><span class=\"line\">        totalSupply -&#x3D; _value;</span><br><span class=\"line\">        Burn(_from, _value);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"部署合约\"><a href=\"#部署合约\" class=\"headerlink\" title=\"部署合约\"></a>部署合约</h1><h2 id=\"方式\"><a href=\"#方式\" class=\"headerlink\" title=\"方式\"></a>方式</h2><ol>\n<li>Geth编译代码</li>\n<li>etherrum wallet钱包部署合约</li>\n<li>MetaMask钱包 + Remix Solidity IDE部署</li>\n</ol>\n<h2 id=\"Meta-Mask-Remix-Solidity-IDE\"><a href=\"#Meta-Mask-Remix-Solidity-IDE\" class=\"headerlink\" title=\"Meta Mask + Remix Solidity IDE\"></a>Meta Mask + Remix Solidity IDE</h2><ol>\n<li>创建钱包，转到测试网络Ropsten.</li>\n<li>在Remix Solidity IDE中对合约代码进行编程。</li>\n<li>对其<strong>编译</strong></li>\n</ol>\n<p>选择对应的编译器版本。</p>\n<ol start=\"4\">\n<li>进行<strong>发布</strong></li>\n</ol>\n<p>Environment: Injected Web3</p>\n<p>Account: xxxxx(会自动读取Meta Mask的账户)</p>\n<p>选择编译好的文件</p>\n<p>构造函数传参</p>\n<p>在Meta Mask中对合约部署进行确认。</p>\n<ol start=\"5\">\n<li>添加自定义的Token</li>\n</ol>\n<h1 id=\"公布源码\"><a href=\"#公布源码\" class=\"headerlink\" title=\"公布源码\"></a>公布源码</h1><p>在etherscan.io上进入到合约地址。</p>\n<p>贴上源代码，它会对<strong>源码进行编译</strong>，将字节码与区块<code>DATA</code>内的<strong>字节码进行比对</strong>，需要完全一样。</p>\n<p>之后就可以ICO了。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybmJsb2NrY2hhaW4uY24vMjAxOC8wMS8xMi9jcmVhdGVfdG9rZW4=\">https://learnblockchain.cn/2018/01/12/create_token<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phdmFfaGhoaC9hcnRpY2xlL2RldGFpbHMvNzk3NzE3NTI=\">https://blog.csdn.net/java_hhhh/article/details/79771752<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 矩阵连乘 (Multiplying a sequence of matrices)\n\n我们想从两个以上矩阵连乘的式子中得到最佳的次序，使得计算时乘法运算最少。\n\n```java\npublic class DynamicProgramming {\n\n\tprivate static final int N = 5;\n\t\n\tpublic static void main(String[] args) {\n\t\tint[][] C = new int[N][N];\n\t\tint[][] S = new int[N][N];\n\t\tint[] r = {4, 5, 3, 6, 4, 5};\n\t\t\n\t\tfor (int i = 0; i < N; i++) {// 初始化 最小乘运算数组\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tC[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < N; i++) {// 初始化 分割位置\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tS[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int p = 2; p <= N; p++) {// P 为间隔\n\t\t\tfor (int i = 0, j; i < N - p + 1; i++) {// i 为起始值\n\t\t\t\tj = i + p - 1;// j 为终止值\n\t\t\t\tC[i][j] = C[i][i] + C[i + 1][j] + r[i] * r[i + 1] * r[j + 1];// 赋 C[i][j] 的初值方便下文比较取得最小值\n\t\t\t\tS[i][j] = i;\n\t\t\t\tfor (int k = i; k< j; k++) {// k 为中间分割值 \n\t\t\t\t\tint temp = C[i][k] + C[k + 1][j] + r[i] * r[k + 1] * r[j + 1];\n\t\t\t\t\t\n\t\t\t\t\tif (temp < C[i][j]) {// 取得每次分割后的最小值\n\t\t\t\t\t\tC[i][j] = temp;\n\t\t\t\t\t\tS[i][j] = k;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tSystem.out.print(C[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t\tSystem.out.println();\n\t\t\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tif (j > i) System.out.print(S[i][j] + 1 + \"\\t\");\n\t\t\t\telse System.out.print(0 + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}\n\n/* result\n0\t60\t132\t180\t252\t\n0\t0\t90\t132\t207\t\n0\t0\t0\t72\t132\t\n0\t0\t0\t0\t120\t\n0\t0\t0\t0\t0\t\n\n0\t1\t2\t2\t2\t\n0\t0\t2\t2\t2\t\n0\t0\t0\t3\t4\t\n0\t0\t0\t0\t4\t\n0\t0\t0\t0\t0\n\n(A1 * A2) * ((A3 * A4) * A5)\n*/\n```","source":"_posts/algorithm/[DP]MSM.md","raw":"# 矩阵连乘 (Multiplying a sequence of matrices)\n\n我们想从两个以上矩阵连乘的式子中得到最佳的次序，使得计算时乘法运算最少。\n\n```java\npublic class DynamicProgramming {\n\n\tprivate static final int N = 5;\n\t\n\tpublic static void main(String[] args) {\n\t\tint[][] C = new int[N][N];\n\t\tint[][] S = new int[N][N];\n\t\tint[] r = {4, 5, 3, 6, 4, 5};\n\t\t\n\t\tfor (int i = 0; i < N; i++) {// 初始化 最小乘运算数组\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tC[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < N; i++) {// 初始化 分割位置\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tS[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int p = 2; p <= N; p++) {// P 为间隔\n\t\t\tfor (int i = 0, j; i < N - p + 1; i++) {// i 为起始值\n\t\t\t\tj = i + p - 1;// j 为终止值\n\t\t\t\tC[i][j] = C[i][i] + C[i + 1][j] + r[i] * r[i + 1] * r[j + 1];// 赋 C[i][j] 的初值方便下文比较取得最小值\n\t\t\t\tS[i][j] = i;\n\t\t\t\tfor (int k = i; k< j; k++) {// k 为中间分割值 \n\t\t\t\t\tint temp = C[i][k] + C[k + 1][j] + r[i] * r[k + 1] * r[j + 1];\n\t\t\t\t\t\n\t\t\t\t\tif (temp < C[i][j]) {// 取得每次分割后的最小值\n\t\t\t\t\t\tC[i][j] = temp;\n\t\t\t\t\t\tS[i][j] = k;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tSystem.out.print(C[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t\tSystem.out.println();\n\t\t\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\tif (j > i) System.out.print(S[i][j] + 1 + \"\\t\");\n\t\t\t\telse System.out.print(0 + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}\n\n/* result\n0\t60\t132\t180\t252\t\n0\t0\t90\t132\t207\t\n0\t0\t0\t72\t132\t\n0\t0\t0\t0\t120\t\n0\t0\t0\t0\t0\t\n\n0\t1\t2\t2\t2\t\n0\t0\t2\t2\t2\t\n0\t0\t0\t3\t4\t\n0\t0\t0\t0\t4\t\n0\t0\t0\t0\t0\n\n(A1 * A2) * ((A3 * A4) * A5)\n*/\n```","slug":"algorithm/[DP]MSM","published":1,"date":"2020-04-28T13:22:24.685Z","updated":"2020-04-28T13:27:41.421Z","title":"algorithm/[DP]MSM","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xm000f018o7yxecflz","content":"<h1 id=\"矩阵连乘-Multiplying-a-sequence-of-matrices\"><a href=\"#矩阵连乘-Multiplying-a-sequence-of-matrices\" class=\"headerlink\" title=\"矩阵连乘 (Multiplying a sequence of matrices)\"></a>矩阵连乘 (Multiplying a sequence of matrices)</h1><p>我们想从两个以上矩阵连乘的式子中得到最佳的次序，使得计算时乘法运算最少。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicProgramming</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] C = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N][N];</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] S = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N][N];</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] r = &#123;<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">3</span>, <span class=\"number\">6</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;<span class=\"comment\">// 初始化 最小乘运算数组</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tC[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;<span class=\"comment\">// 初始化 分割位置</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tS[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> p = <span class=\"number\">2</span>; p &lt;= N; p++) &#123;<span class=\"comment\">// P 为间隔</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j; i &lt; N - p + <span class=\"number\">1</span>; i++) &#123;<span class=\"comment\">// i 为起始值</span></span><br><span class=\"line\">\t\t\t\tj = i + p - <span class=\"number\">1</span>;<span class=\"comment\">// j 为终止值</span></span><br><span class=\"line\">\t\t\t\tC[i][j] = C[i][i] + C[i + <span class=\"number\">1</span>][j] + r[i] * r[i + <span class=\"number\">1</span>] * r[j + <span class=\"number\">1</span>];<span class=\"comment\">// 赋 C[i][j] 的初值方便下文比较取得最小值</span></span><br><span class=\"line\">\t\t\t\tS[i][j] = i;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> k = i; k&lt; j; k++) &#123;<span class=\"comment\">// k 为中间分割值 </span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">int</span> temp = C[i][k] + C[k + <span class=\"number\">1</span>][j] + r[i] * r[k + <span class=\"number\">1</span>] * r[j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t\t\t</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (temp &lt; C[i][j]) &#123;<span class=\"comment\">// 取得每次分割后的最小值</span></span><br><span class=\"line\">\t\t\t\t\t\tC[i][j] = temp;</span><br><span class=\"line\">\t\t\t\t\t\tS[i][j] = k;</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.print(C[i][j] + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.println();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (j &gt; i) System.out.print(S[i][j] + <span class=\"number\">1</span> + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> System.out.print(<span class=\"number\">0</span> + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* result</span></span><br><span class=\"line\"><span class=\"comment\">0\t60\t132\t180\t252\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t90\t132\t207\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t72\t132\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t120\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t0\t</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">0\t1\t2\t2\t2\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t2\t2\t2\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t3\t4\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t4\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t0</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">(A1 * A2) * ((A3 * A4) * A5)</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"矩阵连乘-Multiplying-a-sequence-of-matrices\"><a href=\"#矩阵连乘-Multiplying-a-sequence-of-matrices\" class=\"headerlink\" title=\"矩阵连乘 (Multiplying a sequence of matrices)\"></a>矩阵连乘 (Multiplying a sequence of matrices)</h1><p>我们想从两个以上矩阵连乘的式子中得到最佳的次序，使得计算时乘法运算最少。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicProgramming</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] C = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N][N];</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[][] S = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N][N];</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] r = &#123;<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">3</span>, <span class=\"number\">6</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;<span class=\"comment\">// 初始化 最小乘运算数组</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tC[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;<span class=\"comment\">// 初始化 分割位置</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tS[i][j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> p = <span class=\"number\">2</span>; p &lt;= N; p++) &#123;<span class=\"comment\">// P 为间隔</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j; i &lt; N - p + <span class=\"number\">1</span>; i++) &#123;<span class=\"comment\">// i 为起始值</span></span><br><span class=\"line\">\t\t\t\tj = i + p - <span class=\"number\">1</span>;<span class=\"comment\">// j 为终止值</span></span><br><span class=\"line\">\t\t\t\tC[i][j] = C[i][i] + C[i + <span class=\"number\">1</span>][j] + r[i] * r[i + <span class=\"number\">1</span>] * r[j + <span class=\"number\">1</span>];<span class=\"comment\">// 赋 C[i][j] 的初值方便下文比较取得最小值</span></span><br><span class=\"line\">\t\t\t\tS[i][j] = i;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> k = i; k&lt; j; k++) &#123;<span class=\"comment\">// k 为中间分割值 </span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">int</span> temp = C[i][k] + C[k + <span class=\"number\">1</span>][j] + r[i] * r[k + <span class=\"number\">1</span>] * r[j + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t\t\t</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (temp &lt; C[i][j]) &#123;<span class=\"comment\">// 取得每次分割后的最小值</span></span><br><span class=\"line\">\t\t\t\t\t\tC[i][j] = temp;</span><br><span class=\"line\">\t\t\t\t\t\tS[i][j] = k;</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\tSystem.out.print(C[i][j] + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSystem.out.println();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; N; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; N; j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (j &gt; i) System.out.print(S[i][j] + <span class=\"number\">1</span> + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> System.out.print(<span class=\"number\">0</span> + <span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tSystem.out.println();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* result</span></span><br><span class=\"line\"><span class=\"comment\">0\t60\t132\t180\t252\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t90\t132\t207\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t72\t132\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t120\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t0\t</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">0\t1\t2\t2\t2\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t2\t2\t2\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t3\t4\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t4\t</span></span><br><span class=\"line\"><span class=\"comment\">0\t0\t0\t0\t0</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">(A1 * A2) * ((A3 * A4) * A5)</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>"},{"title":"区块链技术","catagories":["BlockChain"],"_content":"\n# 对区块链技术新的理解\n\n底层技术目前都是一样的，通过chain将block连起来，通过代码确定**共识机制**，采取分布式的策略达到不可篡改性。\n\n目前感觉技术上有很大不同的是有两个代表。**比特币**与**以太坊**。\n\n# 比特币与以太坊对比\n\n## 比特币\n\n### 交易\n\n比特币的职能只有一个，**传递价值并存储价值**。\n\n其交易过程为：\n\n- TO: 发给谁\n- FROM: 谁发送的\n- AMOUNT: 发送的数量\n\n## 以太坊\n\n### 交易\n\n以太坊最大的不同在于它在交易的时候还有一个`DATA`字段。\n\n1. 传递价值（与比特币相同）\n- - TO: 发送给谁\n  - FROM: 谁发送的\n  - AMOUNT: 发送的数量\n2. 创建合约\n- - TO: nil(空白为触发创建智能合约)\n  - FROM: 谁创建的\n  - AMOUNT: 可以是0或是任意数量的以太币，它是我们想要给合约的存款。\n  - DATA: 包含编译为字节码的智能合约代码\n3. 调用合约函数\n- - TO: 目标合约账户地址\n  - FROM: 谁调用的\n  - AMOUNT: 可以是零或是任意数量的以太币，例如**可以支付合约服务费用**。\n  - DATA: 包含函数名和参数（标识如何调用智能合约函数）\n\n**理解**：每次进行代币（Token）交易的时候都会**对合约进行请求**，比如交易时的费用等。\n\n**问题**：超发，被盗等操作如何实现？\n\n### 智能合约\n\n由于ETH最大的区别在于可以传`DATA`, 因此**衍生出来了一个智能合约的概念**。\n\n**其本质就是可以在区块链上运行代码。**\n\n#### 用户账户\n\n- 地址\n- 余额\n\n该余额就是用户的钱。\n\n#### 合约账户\n\n- 地址\n- 余额\n- 状态\n- 代码\n\n合约账户也拥有**余额**，意味着一个**实例化出来的合约对象**可以**通过代码管理余额**，如果代码有问题，则会产生错误。\n\n合约账户的**状态**是只能合约中生声明的所有变量和变量的当前状态，**就如同实例化的一个对象中的变量**。这个对象将永远存在区块链网络中，除非程序自毁。\n\n合约账户的**代码**是编译后可以在客户端和节点可以运行的字节码，它在**合约创建时实例化**。\n\n智能合约是**图灵完备**的，理论上可以做任何事情。\n\n### GAS\n\n在链上的操作（转账，合约的部署，合约的执行）都是需要占用资源的，这个GAS将被付给矿工。\n\nGAS可以自己设定，出价越高被执行的就越快。\n\n# 理解\n\n区块存储任何东西\n\n账户可以用**地址**表示，交易可以用**地址**表示，合约账户内的代码等都可以用**地址**表示。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://learnblockchain.cn/2018/01/04/understanding-smart-contracts","source":"_posts/blockchain/blockchain.md","raw":"---\ntitle: 区块链技术\ncatagories:\n- BlockChain\n---\n\n# 对区块链技术新的理解\n\n底层技术目前都是一样的，通过chain将block连起来，通过代码确定**共识机制**，采取分布式的策略达到不可篡改性。\n\n目前感觉技术上有很大不同的是有两个代表。**比特币**与**以太坊**。\n\n# 比特币与以太坊对比\n\n## 比特币\n\n### 交易\n\n比特币的职能只有一个，**传递价值并存储价值**。\n\n其交易过程为：\n\n- TO: 发给谁\n- FROM: 谁发送的\n- AMOUNT: 发送的数量\n\n## 以太坊\n\n### 交易\n\n以太坊最大的不同在于它在交易的时候还有一个`DATA`字段。\n\n1. 传递价值（与比特币相同）\n- - TO: 发送给谁\n  - FROM: 谁发送的\n  - AMOUNT: 发送的数量\n2. 创建合约\n- - TO: nil(空白为触发创建智能合约)\n  - FROM: 谁创建的\n  - AMOUNT: 可以是0或是任意数量的以太币，它是我们想要给合约的存款。\n  - DATA: 包含编译为字节码的智能合约代码\n3. 调用合约函数\n- - TO: 目标合约账户地址\n  - FROM: 谁调用的\n  - AMOUNT: 可以是零或是任意数量的以太币，例如**可以支付合约服务费用**。\n  - DATA: 包含函数名和参数（标识如何调用智能合约函数）\n\n**理解**：每次进行代币（Token）交易的时候都会**对合约进行请求**，比如交易时的费用等。\n\n**问题**：超发，被盗等操作如何实现？\n\n### 智能合约\n\n由于ETH最大的区别在于可以传`DATA`, 因此**衍生出来了一个智能合约的概念**。\n\n**其本质就是可以在区块链上运行代码。**\n\n#### 用户账户\n\n- 地址\n- 余额\n\n该余额就是用户的钱。\n\n#### 合约账户\n\n- 地址\n- 余额\n- 状态\n- 代码\n\n合约账户也拥有**余额**，意味着一个**实例化出来的合约对象**可以**通过代码管理余额**，如果代码有问题，则会产生错误。\n\n合约账户的**状态**是只能合约中生声明的所有变量和变量的当前状态，**就如同实例化的一个对象中的变量**。这个对象将永远存在区块链网络中，除非程序自毁。\n\n合约账户的**代码**是编译后可以在客户端和节点可以运行的字节码，它在**合约创建时实例化**。\n\n智能合约是**图灵完备**的，理论上可以做任何事情。\n\n### GAS\n\n在链上的操作（转账，合约的部署，合约的执行）都是需要占用资源的，这个GAS将被付给矿工。\n\nGAS可以自己设定，出价越高被执行的就越快。\n\n# 理解\n\n区块存储任何东西\n\n账户可以用**地址**表示，交易可以用**地址**表示，合约账户内的代码等都可以用**地址**表示。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://learnblockchain.cn/2018/01/04/understanding-smart-contracts","slug":"blockchain/blockchain","published":1,"date":"2021-02-22T10:43:55.581Z","updated":"2021-02-22T11:27:15.027Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xo000j018ogvvm1ub2","content":"<h1 id=\"对区块链技术新的理解\"><a href=\"#对区块链技术新的理解\" class=\"headerlink\" title=\"对区块链技术新的理解\"></a>对区块链技术新的理解</h1><p>底层技术目前都是一样的，通过chain将block连起来，通过代码确定<strong>共识机制</strong>，采取分布式的策略达到不可篡改性。</p>\n<p>目前感觉技术上有很大不同的是有两个代表。<strong>比特币</strong>与<strong>以太坊</strong>。</p>\n<h1 id=\"比特币与以太坊对比\"><a href=\"#比特币与以太坊对比\" class=\"headerlink\" title=\"比特币与以太坊对比\"></a>比特币与以太坊对比</h1><h2 id=\"比特币\"><a href=\"#比特币\" class=\"headerlink\" title=\"比特币\"></a>比特币</h2><h3 id=\"交易\"><a href=\"#交易\" class=\"headerlink\" title=\"交易\"></a>交易</h3><p>比特币的职能只有一个，<strong>传递价值并存储价值</strong>。</p>\n<p>其交易过程为：</p>\n<ul>\n<li>TO: 发给谁</li>\n<li>FROM: 谁发送的</li>\n<li>AMOUNT: 发送的数量</li>\n</ul>\n<h2 id=\"以太坊\"><a href=\"#以太坊\" class=\"headerlink\" title=\"以太坊\"></a>以太坊</h2><h3 id=\"交易-1\"><a href=\"#交易-1\" class=\"headerlink\" title=\"交易\"></a>交易</h3><p>以太坊最大的不同在于它在交易的时候还有一个<code>DATA</code>字段。</p>\n<ol>\n<li>传递价值（与比特币相同）</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: 发送给谁</li>\n<li>FROM: 谁发送的</li>\n<li>AMOUNT: 发送的数量</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>创建合约</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: nil(空白为触发创建智能合约)</li>\n<li>FROM: 谁创建的</li>\n<li>AMOUNT: 可以是0或是任意数量的以太币，它是我们想要给合约的存款。</li>\n<li>DATA: 包含编译为字节码的智能合约代码</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>调用合约函数</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: 目标合约账户地址</li>\n<li>FROM: 谁调用的</li>\n<li>AMOUNT: 可以是零或是任意数量的以太币，例如<strong>可以支付合约服务费用</strong>。</li>\n<li>DATA: 包含函数名和参数（标识如何调用智能合约函数）</li>\n</ul>\n</li>\n</ul>\n<p><strong>理解</strong>：每次进行代币（Token）交易的时候都会<strong>对合约进行请求</strong>，比如交易时的费用等。</p>\n<p><strong>问题</strong>：超发，被盗等操作如何实现？</p>\n<h3 id=\"智能合约\"><a href=\"#智能合约\" class=\"headerlink\" title=\"智能合约\"></a>智能合约</h3><p>由于ETH最大的区别在于可以传<code>DATA</code>, 因此<strong>衍生出来了一个智能合约的概念</strong>。</p>\n<p><strong>其本质就是可以在区块链上运行代码。</strong></p>\n<h4 id=\"用户账户\"><a href=\"#用户账户\" class=\"headerlink\" title=\"用户账户\"></a>用户账户</h4><ul>\n<li>地址</li>\n<li>余额</li>\n</ul>\n<p>该余额就是用户的钱。</p>\n<h4 id=\"合约账户\"><a href=\"#合约账户\" class=\"headerlink\" title=\"合约账户\"></a>合约账户</h4><ul>\n<li>地址</li>\n<li>余额</li>\n<li>状态</li>\n<li>代码</li>\n</ul>\n<p>合约账户也拥有<strong>余额</strong>，意味着一个<strong>实例化出来的合约对象</strong>可以<strong>通过代码管理余额</strong>，如果代码有问题，则会产生错误。</p>\n<p>合约账户的<strong>状态</strong>是只能合约中生声明的所有变量和变量的当前状态，<strong>就如同实例化的一个对象中的变量</strong>。这个对象将永远存在区块链网络中，除非程序自毁。</p>\n<p>合约账户的<strong>代码</strong>是编译后可以在客户端和节点可以运行的字节码，它在<strong>合约创建时实例化</strong>。</p>\n<p>智能合约是<strong>图灵完备</strong>的，理论上可以做任何事情。</p>\n<h3 id=\"GAS\"><a href=\"#GAS\" class=\"headerlink\" title=\"GAS\"></a>GAS</h3><p>在链上的操作（转账，合约的部署，合约的执行）都是需要占用资源的，这个GAS将被付给矿工。</p>\n<p>GAS可以自己设定，出价越高被执行的就越快。</p>\n<h1 id=\"理解\"><a href=\"#理解\" class=\"headerlink\" title=\"理解\"></a>理解</h1><p>区块存储任何东西</p>\n<p>账户可以用<strong>地址</strong>表示，交易可以用<strong>地址</strong>表示，合约账户内的代码等都可以用<strong>地址</strong>表示。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybmJsb2NrY2hhaW4uY24vMjAxOC8wMS8wNC91bmRlcnN0YW5kaW5nLXNtYXJ0LWNvbnRyYWN0cw==\">https://learnblockchain.cn/2018/01/04/understanding-smart-contracts<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"对区块链技术新的理解\"><a href=\"#对区块链技术新的理解\" class=\"headerlink\" title=\"对区块链技术新的理解\"></a>对区块链技术新的理解</h1><p>底层技术目前都是一样的，通过chain将block连起来，通过代码确定<strong>共识机制</strong>，采取分布式的策略达到不可篡改性。</p>\n<p>目前感觉技术上有很大不同的是有两个代表。<strong>比特币</strong>与<strong>以太坊</strong>。</p>\n<h1 id=\"比特币与以太坊对比\"><a href=\"#比特币与以太坊对比\" class=\"headerlink\" title=\"比特币与以太坊对比\"></a>比特币与以太坊对比</h1><h2 id=\"比特币\"><a href=\"#比特币\" class=\"headerlink\" title=\"比特币\"></a>比特币</h2><h3 id=\"交易\"><a href=\"#交易\" class=\"headerlink\" title=\"交易\"></a>交易</h3><p>比特币的职能只有一个，<strong>传递价值并存储价值</strong>。</p>\n<p>其交易过程为：</p>\n<ul>\n<li>TO: 发给谁</li>\n<li>FROM: 谁发送的</li>\n<li>AMOUNT: 发送的数量</li>\n</ul>\n<h2 id=\"以太坊\"><a href=\"#以太坊\" class=\"headerlink\" title=\"以太坊\"></a>以太坊</h2><h3 id=\"交易-1\"><a href=\"#交易-1\" class=\"headerlink\" title=\"交易\"></a>交易</h3><p>以太坊最大的不同在于它在交易的时候还有一个<code>DATA</code>字段。</p>\n<ol>\n<li>传递价值（与比特币相同）</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: 发送给谁</li>\n<li>FROM: 谁发送的</li>\n<li>AMOUNT: 发送的数量</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>创建合约</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: nil(空白为触发创建智能合约)</li>\n<li>FROM: 谁创建的</li>\n<li>AMOUNT: 可以是0或是任意数量的以太币，它是我们想要给合约的存款。</li>\n<li>DATA: 包含编译为字节码的智能合约代码</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>调用合约函数</li>\n</ol>\n<ul>\n<li><ul>\n<li>TO: 目标合约账户地址</li>\n<li>FROM: 谁调用的</li>\n<li>AMOUNT: 可以是零或是任意数量的以太币，例如<strong>可以支付合约服务费用</strong>。</li>\n<li>DATA: 包含函数名和参数（标识如何调用智能合约函数）</li>\n</ul>\n</li>\n</ul>\n<p><strong>理解</strong>：每次进行代币（Token）交易的时候都会<strong>对合约进行请求</strong>，比如交易时的费用等。</p>\n<p><strong>问题</strong>：超发，被盗等操作如何实现？</p>\n<h3 id=\"智能合约\"><a href=\"#智能合约\" class=\"headerlink\" title=\"智能合约\"></a>智能合约</h3><p>由于ETH最大的区别在于可以传<code>DATA</code>, 因此<strong>衍生出来了一个智能合约的概念</strong>。</p>\n<p><strong>其本质就是可以在区块链上运行代码。</strong></p>\n<h4 id=\"用户账户\"><a href=\"#用户账户\" class=\"headerlink\" title=\"用户账户\"></a>用户账户</h4><ul>\n<li>地址</li>\n<li>余额</li>\n</ul>\n<p>该余额就是用户的钱。</p>\n<h4 id=\"合约账户\"><a href=\"#合约账户\" class=\"headerlink\" title=\"合约账户\"></a>合约账户</h4><ul>\n<li>地址</li>\n<li>余额</li>\n<li>状态</li>\n<li>代码</li>\n</ul>\n<p>合约账户也拥有<strong>余额</strong>，意味着一个<strong>实例化出来的合约对象</strong>可以<strong>通过代码管理余额</strong>，如果代码有问题，则会产生错误。</p>\n<p>合约账户的<strong>状态</strong>是只能合约中生声明的所有变量和变量的当前状态，<strong>就如同实例化的一个对象中的变量</strong>。这个对象将永远存在区块链网络中，除非程序自毁。</p>\n<p>合约账户的<strong>代码</strong>是编译后可以在客户端和节点可以运行的字节码，它在<strong>合约创建时实例化</strong>。</p>\n<p>智能合约是<strong>图灵完备</strong>的，理论上可以做任何事情。</p>\n<h3 id=\"GAS\"><a href=\"#GAS\" class=\"headerlink\" title=\"GAS\"></a>GAS</h3><p>在链上的操作（转账，合约的部署，合约的执行）都是需要占用资源的，这个GAS将被付给矿工。</p>\n<p>GAS可以自己设定，出价越高被执行的就越快。</p>\n<h1 id=\"理解\"><a href=\"#理解\" class=\"headerlink\" title=\"理解\"></a>理解</h1><p>区块存储任何东西</p>\n<p>账户可以用<strong>地址</strong>表示，交易可以用<strong>地址</strong>表示，合约账户内的代码等都可以用<strong>地址</strong>表示。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWFybmJsb2NrY2hhaW4uY24vMjAxOC8wMS8wNC91bmRlcnN0YW5kaW5nLXNtYXJ0LWNvbnRyYWN0cw==\">https://learnblockchain.cn/2018/01/04/understanding-smart-contracts<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"ETH - 开发","catagories":["BlockChain"],"_content":"\n# Truffle Suite\n\nTruffle Suite包含三个产品\n\n- Truffle\n- Ganache\n- Drizzle\n\n**Truffle**是一个开发框架，包括合约编译，链接，部署，二进制文件管理等。\n\n**Ganache**可以创建一个本地的区块链，用于存储我们在本地部署的合约。\n\n**Drizzle**是一个js库，可以很方便的处理合约中的各种值，进行Web开发。\n\n# Truffle\n\n下载`truffle`\n\n```sh\nnpm install truffle -g\n```\n\n新建项目\n\n```sh\ntruffle init\n```\n\n之后会在当前目录下新建一个truffle项目。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://truffle.tryblockchain.org/","source":"_posts/blockchain/eth-dev.md","raw":"---\ntitle: ETH - 开发\ncatagories:\n- BlockChain\ntags:\n- eth\n---\n\n# Truffle Suite\n\nTruffle Suite包含三个产品\n\n- Truffle\n- Ganache\n- Drizzle\n\n**Truffle**是一个开发框架，包括合约编译，链接，部署，二进制文件管理等。\n\n**Ganache**可以创建一个本地的区块链，用于存储我们在本地部署的合约。\n\n**Drizzle**是一个js库，可以很方便的处理合约中的各种值，进行Web开发。\n\n# Truffle\n\n下载`truffle`\n\n```sh\nnpm install truffle -g\n```\n\n新建项目\n\n```sh\ntruffle init\n```\n\n之后会在当前目录下新建一个truffle项目。\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://truffle.tryblockchain.org/","slug":"blockchain/eth-dev","published":1,"date":"2021-02-22T15:09:34.198Z","updated":"2021-02-22T17:15:04.904Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xp000m018o8by38md3","content":"<h1 id=\"Truffle-Suite\"><a href=\"#Truffle-Suite\" class=\"headerlink\" title=\"Truffle Suite\"></a>Truffle Suite</h1><p>Truffle Suite包含三个产品</p>\n<ul>\n<li>Truffle</li>\n<li>Ganache</li>\n<li>Drizzle</li>\n</ul>\n<p><strong>Truffle</strong>是一个开发框架，包括合约编译，链接，部署，二进制文件管理等。</p>\n<p><strong>Ganache</strong>可以创建一个本地的区块链，用于存储我们在本地部署的合约。</p>\n<p><strong>Drizzle</strong>是一个js库，可以很方便的处理合约中的各种值，进行Web开发。</p>\n<h1 id=\"Truffle\"><a href=\"#Truffle\" class=\"headerlink\" title=\"Truffle\"></a>Truffle</h1><p>下载<code>truffle</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install truffle -g</span><br></pre></td></tr></table></figure>\n\n<p>新建项目</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">truffle init</span><br></pre></td></tr></table></figure>\n\n<p>之后会在当前目录下新建一个truffle项目。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90cnVmZmxlLnRyeWJsb2NrY2hhaW4ub3JnLw==\">https://truffle.tryblockchain.org/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Truffle-Suite\"><a href=\"#Truffle-Suite\" class=\"headerlink\" title=\"Truffle Suite\"></a>Truffle Suite</h1><p>Truffle Suite包含三个产品</p>\n<ul>\n<li>Truffle</li>\n<li>Ganache</li>\n<li>Drizzle</li>\n</ul>\n<p><strong>Truffle</strong>是一个开发框架，包括合约编译，链接，部署，二进制文件管理等。</p>\n<p><strong>Ganache</strong>可以创建一个本地的区块链，用于存储我们在本地部署的合约。</p>\n<p><strong>Drizzle</strong>是一个js库，可以很方便的处理合约中的各种值，进行Web开发。</p>\n<h1 id=\"Truffle\"><a href=\"#Truffle\" class=\"headerlink\" title=\"Truffle\"></a>Truffle</h1><p>下载<code>truffle</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install truffle -g</span><br></pre></td></tr></table></figure>\n\n<p>新建项目</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">truffle init</span><br></pre></td></tr></table></figure>\n\n<p>之后会在当前目录下新建一个truffle项目。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90cnVmZmxlLnRyeWJsb2NrY2hhaW4ub3JnLw==\">https://truffle.tryblockchain.org/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"挖矿 - Start","catagories":["BlockChain"],"_content":"\n","source":"_posts/blockchain/mine-start.md","raw":"---\ntitle: 挖矿 - Start\ncatagories:\n- BlockChain\ntags:\n- mine\n---\n\n","slug":"blockchain/mine-start","published":1,"date":"2021-02-22T07:52:54.315Z","updated":"2021-02-22T07:53:21.246Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xq000q018o8vfw2ov2","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"CyberSecurity 协议的安全","catagories":["CyberSecurity"],"_content":"\n# Denial of Service (Dos)\n\n## 网络层\n\n\n\n## 传输层\n\n\n\n## 应用层\n\n\n\n","source":"_posts/cybersecurity/protocal-sec.md","raw":"---\ntitle: CyberSecurity 协议的安全\ncatagories:\n- CyberSecurity\ntags:\n- security\n---\n\n# Denial of Service (Dos)\n\n## 网络层\n\n\n\n## 传输层\n\n\n\n## 应用层\n\n\n\n","slug":"cybersecurity/protocal-sec","published":1,"date":"2021-03-17T06:49:19.005Z","updated":"2021-03-17T07:04:04.281Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xr000r018ob2gwc60e","content":"<h1 id=\"Denial-of-Service-Dos\"><a href=\"#Denial-of-Service-Dos\" class=\"headerlink\" title=\"Denial of Service (Dos)\"></a>Denial of Service (Dos)</h1><h2 id=\"网络层\"><a href=\"#网络层\" class=\"headerlink\" title=\"网络层\"></a>网络层</h2><h2 id=\"传输层\"><a href=\"#传输层\" class=\"headerlink\" title=\"传输层\"></a>传输层</h2><h2 id=\"应用层\"><a href=\"#应用层\" class=\"headerlink\" title=\"应用层\"></a>应用层</h2>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Denial-of-Service-Dos\"><a href=\"#Denial-of-Service-Dos\" class=\"headerlink\" title=\"Denial of Service (Dos)\"></a>Denial of Service (Dos)</h1><h2 id=\"网络层\"><a href=\"#网络层\" class=\"headerlink\" title=\"网络层\"></a>网络层</h2><h2 id=\"传输层\"><a href=\"#传输层\" class=\"headerlink\" title=\"传输层\"></a>传输层</h2><h2 id=\"应用层\"><a href=\"#应用层\" class=\"headerlink\" title=\"应用层\"></a>应用层</h2>"},{"title":"挖矿计算的本质","catagories":["BlockChain"],"_content":"\n\n\n----\n\nReference\n\nhttps://www.bilibili.com/video/BV1E7411V7UM","source":"_posts/blockchain/mine.md","raw":"---\ntitle: 挖矿计算的本质\ncatagories:\n- BlockChain\ntags:\n- mine\n---\n\n\n\n----\n\nReference\n\nhttps://www.bilibili.com/video/BV1E7411V7UM","slug":"blockchain/mine","published":1,"date":"2021-02-22T11:04:04.140Z","updated":"2021-02-22T13:02:25.925Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xs000u018o7rak9bgb","content":"<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMUU3NDExVjdVTQ==\">https://www.bilibili.com/video/BV1E7411V7UM<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMUU3NDExVjdVTQ==\">https://www.bilibili.com/video/BV1E7411V7UM<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Network TCP/IP","_content":"\n# 开始\n\n![img](https://pic3.zhimg.com/80/v2-4fe0b5f06fc89af2f98ebd2690bc87ea_720w.jpg)\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/33889997\n\n","source":"_posts/cybersecurity/tcpip.md","raw":"---\ntitle: Network TCP/IP\n---\n\n# 开始\n\n![img](https://pic3.zhimg.com/80/v2-4fe0b5f06fc89af2f98ebd2690bc87ea_720w.jpg)\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/33889997\n\n","slug":"cybersecurity/tcpip","published":1,"date":"2021-03-08T08:39:08.936Z","updated":"2021-03-08T17:41:05.988Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xt000v018o6m4bdnmn","content":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p><img src=\"https://pic3.zhimg.com/80/v2-4fe0b5f06fc89af2f98ebd2690bc87ea_720w.jpg\" alt=\"img\"></p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMzg4OTk5Nw==\">https://zhuanlan.zhihu.com/p/33889997<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p><img src=\"https://pic3.zhimg.com/80/v2-4fe0b5f06fc89af2f98ebd2690bc87ea_720w.jpg\" alt=\"img\"></p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMzg4OTk5Nw==\">https://zhuanlan.zhihu.com/p/33889997<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Builder生产器模式","_content":"\n# 简介\n\n用于复杂对象的初始化工作，其通常有诸多的成员变量，嵌套对象。\n\n\n\n# 模式架构\n\n## 生成器\n\n一个通用的产品构造器，接口中的步骤都需要进行构造。\n\n## 具体生成器\n\n提供具体的实现，生成器**亦**可以构造**不遵循接口的产品**，取决于生成器内的getRes()方法返回的对象。\n\n## 产品\n\n最终生成的产品，**不需要属于同一类层次结构或接口**。\n\n## 主管\n\n这里定义所有的产品的生产(初始化)步骤，传参可以是通用的接口，也可以传自定义的接口。\n\n可以都是`void`方法，**重点是传的接口类型以及方法内初始化的步骤**。\n\n## 客户端\n\n首先需要初始化一个主管。只需要关心让主管使用哪一个生产(初始化)步骤，以及传给主管的生成器，而生成器决定了最终生产的产品类型。\n\n只需要初始化**一次**主管，和**一个**生成器就可以通过主管的不同生产方法，产生不同的对象。**每一次调用都会产生一个新的对象**。\n\n\n\n----\n\nReference\n\nhttps://refactoringguru.cn/design-patterns/builder","source":"_posts/design/builder.md","raw":"---\ntitle: Builder生产器模式\ncategories:\n- Notebook\ntags:\n- design\n- builder\n---\n\n# 简介\n\n用于复杂对象的初始化工作，其通常有诸多的成员变量，嵌套对象。\n\n\n\n# 模式架构\n\n## 生成器\n\n一个通用的产品构造器，接口中的步骤都需要进行构造。\n\n## 具体生成器\n\n提供具体的实现，生成器**亦**可以构造**不遵循接口的产品**，取决于生成器内的getRes()方法返回的对象。\n\n## 产品\n\n最终生成的产品，**不需要属于同一类层次结构或接口**。\n\n## 主管\n\n这里定义所有的产品的生产(初始化)步骤，传参可以是通用的接口，也可以传自定义的接口。\n\n可以都是`void`方法，**重点是传的接口类型以及方法内初始化的步骤**。\n\n## 客户端\n\n首先需要初始化一个主管。只需要关心让主管使用哪一个生产(初始化)步骤，以及传给主管的生成器，而生成器决定了最终生产的产品类型。\n\n只需要初始化**一次**主管，和**一个**生成器就可以通过主管的不同生产方法，产生不同的对象。**每一次调用都会产生一个新的对象**。\n\n\n\n----\n\nReference\n\nhttps://refactoringguru.cn/design-patterns/builder","slug":"design/builder","published":1,"date":"2021-01-28T10:10:38.713Z","updated":"2021-02-01T09:07:27.228Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xt000x018oedougqvx","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>用于复杂对象的初始化工作，其通常有诸多的成员变量，嵌套对象。</p>\n<h1 id=\"模式架构\"><a href=\"#模式架构\" class=\"headerlink\" title=\"模式架构\"></a>模式架构</h1><h2 id=\"生成器\"><a href=\"#生成器\" class=\"headerlink\" title=\"生成器\"></a>生成器</h2><p>一个通用的产品构造器，接口中的步骤都需要进行构造。</p>\n<h2 id=\"具体生成器\"><a href=\"#具体生成器\" class=\"headerlink\" title=\"具体生成器\"></a>具体生成器</h2><p>提供具体的实现，生成器<strong>亦</strong>可以构造<strong>不遵循接口的产品</strong>，取决于生成器内的getRes()方法返回的对象。</p>\n<h2 id=\"产品\"><a href=\"#产品\" class=\"headerlink\" title=\"产品\"></a>产品</h2><p>最终生成的产品，<strong>不需要属于同一类层次结构或接口</strong>。</p>\n<h2 id=\"主管\"><a href=\"#主管\" class=\"headerlink\" title=\"主管\"></a>主管</h2><p>这里定义所有的产品的生产(初始化)步骤，传参可以是通用的接口，也可以传自定义的接口。</p>\n<p>可以都是<code>void</code>方法，<strong>重点是传的接口类型以及方法内初始化的步骤</strong>。</p>\n<h2 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h2><p>首先需要初始化一个主管。只需要关心让主管使用哪一个生产(初始化)步骤，以及传给主管的生成器，而生成器决定了最终生产的产品类型。</p>\n<p>只需要初始化<strong>一次</strong>主管，和<strong>一个</strong>生成器就可以通过主管的不同生产方法，产生不同的对象。<strong>每一次调用都会产生一个新的对象</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2J1aWxkZXI=\">https://refactoringguru.cn/design-patterns/builder<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>用于复杂对象的初始化工作，其通常有诸多的成员变量，嵌套对象。</p>\n<h1 id=\"模式架构\"><a href=\"#模式架构\" class=\"headerlink\" title=\"模式架构\"></a>模式架构</h1><h2 id=\"生成器\"><a href=\"#生成器\" class=\"headerlink\" title=\"生成器\"></a>生成器</h2><p>一个通用的产品构造器，接口中的步骤都需要进行构造。</p>\n<h2 id=\"具体生成器\"><a href=\"#具体生成器\" class=\"headerlink\" title=\"具体生成器\"></a>具体生成器</h2><p>提供具体的实现，生成器<strong>亦</strong>可以构造<strong>不遵循接口的产品</strong>，取决于生成器内的getRes()方法返回的对象。</p>\n<h2 id=\"产品\"><a href=\"#产品\" class=\"headerlink\" title=\"产品\"></a>产品</h2><p>最终生成的产品，<strong>不需要属于同一类层次结构或接口</strong>。</p>\n<h2 id=\"主管\"><a href=\"#主管\" class=\"headerlink\" title=\"主管\"></a>主管</h2><p>这里定义所有的产品的生产(初始化)步骤，传参可以是通用的接口，也可以传自定义的接口。</p>\n<p>可以都是<code>void</code>方法，<strong>重点是传的接口类型以及方法内初始化的步骤</strong>。</p>\n<h2 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h2><p>首先需要初始化一个主管。只需要关心让主管使用哪一个生产(初始化)步骤，以及传给主管的生成器，而生成器决定了最终生产的产品类型。</p>\n<p>只需要初始化<strong>一次</strong>主管，和<strong>一个</strong>生成器就可以通过主管的不同生产方法，产生不同的对象。<strong>每一次调用都会产生一个新的对象</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2J1aWxkZXI=\">https://refactoringguru.cn/design-patterns/builder<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"AbstractFactory抽象工厂模式","_content":"\n# 项目架构\n\n**抽象产品**\n\n每一种产品都有一个产品的声明接口。\n\n**具体产品**\n\n每一个产品下有不同类型的实现，每一个产品都实现对应的产品接口。\n\n**抽象工厂**\n\n用于创建所有产品的声明接口。\n\n**具体工厂**\n\n具体的工厂对应产生具体的产品，用于创建这种产品。\n\n**客户端类**\n\n抽象工厂作为数据成员，其中可以执行各种抽象工厂定义的方法，及各种客户端需要处理的业务。\n\n**运行类**\n\n首先需要准备配置（具体工厂类），在配置文件中根据当前的需求实例话对应的具体工厂。\n\n在运行时实例化客户端类，并对其传入配置文件（具体工厂类）。\n\n此时客户端就可以根据当前的实际情况运行。\n\n\n\n----\n\nReference\n\nhttps://refactoringguru.cn/design-patterns/abstract-factory","source":"_posts/design/abstractfactory.md","raw":"---\n\ntitle: AbstractFactory抽象工厂模式\ncategories:\n- Notebook\ntags:\n- design\n- abstractfactory\n---\n\n# 项目架构\n\n**抽象产品**\n\n每一种产品都有一个产品的声明接口。\n\n**具体产品**\n\n每一个产品下有不同类型的实现，每一个产品都实现对应的产品接口。\n\n**抽象工厂**\n\n用于创建所有产品的声明接口。\n\n**具体工厂**\n\n具体的工厂对应产生具体的产品，用于创建这种产品。\n\n**客户端类**\n\n抽象工厂作为数据成员，其中可以执行各种抽象工厂定义的方法，及各种客户端需要处理的业务。\n\n**运行类**\n\n首先需要准备配置（具体工厂类），在配置文件中根据当前的需求实例话对应的具体工厂。\n\n在运行时实例化客户端类，并对其传入配置文件（具体工厂类）。\n\n此时客户端就可以根据当前的实际情况运行。\n\n\n\n----\n\nReference\n\nhttps://refactoringguru.cn/design-patterns/abstract-factory","slug":"design/abstractfactory","published":1,"date":"2021-01-26T06:57:30.032Z","updated":"2021-01-28T10:12:00.094Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xu000z018ofp3y4343","content":"<h1 id=\"项目架构\"><a href=\"#项目架构\" class=\"headerlink\" title=\"项目架构\"></a>项目架构</h1><p><strong>抽象产品</strong></p>\n<p>每一种产品都有一个产品的声明接口。</p>\n<p><strong>具体产品</strong></p>\n<p>每一个产品下有不同类型的实现，每一个产品都实现对应的产品接口。</p>\n<p><strong>抽象工厂</strong></p>\n<p>用于创建所有产品的声明接口。</p>\n<p><strong>具体工厂</strong></p>\n<p>具体的工厂对应产生具体的产品，用于创建这种产品。</p>\n<p><strong>客户端类</strong></p>\n<p>抽象工厂作为数据成员，其中可以执行各种抽象工厂定义的方法，及各种客户端需要处理的业务。</p>\n<p><strong>运行类</strong></p>\n<p>首先需要准备配置（具体工厂类），在配置文件中根据当前的需求实例话对应的具体工厂。</p>\n<p>在运行时实例化客户端类，并对其传入配置文件（具体工厂类）。</p>\n<p>此时客户端就可以根据当前的实际情况运行。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2Fic3RyYWN0LWZhY3Rvcnk=\">https://refactoringguru.cn/design-patterns/abstract-factory<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"项目架构\"><a href=\"#项目架构\" class=\"headerlink\" title=\"项目架构\"></a>项目架构</h1><p><strong>抽象产品</strong></p>\n<p>每一种产品都有一个产品的声明接口。</p>\n<p><strong>具体产品</strong></p>\n<p>每一个产品下有不同类型的实现，每一个产品都实现对应的产品接口。</p>\n<p><strong>抽象工厂</strong></p>\n<p>用于创建所有产品的声明接口。</p>\n<p><strong>具体工厂</strong></p>\n<p>具体的工厂对应产生具体的产品，用于创建这种产品。</p>\n<p><strong>客户端类</strong></p>\n<p>抽象工厂作为数据成员，其中可以执行各种抽象工厂定义的方法，及各种客户端需要处理的业务。</p>\n<p><strong>运行类</strong></p>\n<p>首先需要准备配置（具体工厂类），在配置文件中根据当前的需求实例话对应的具体工厂。</p>\n<p>在运行时实例化客户端类，并对其传入配置文件（具体工厂类）。</p>\n<p>此时客户端就可以根据当前的实际情况运行。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2Fic3RyYWN0LWZhY3Rvcnk=\">https://refactoringguru.cn/design-patterns/abstract-factory<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"IPFS - Start","catagories":["BlockChain"],"_content":"\n# IPFS介绍\n\n星际文件系统(Inter Planetary File System)。\n\n基于区块链技术的互联网。\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/151386178","source":"_posts/blockchain/ipfs.md","raw":"---\ntitle: IPFS - Start\ncatagories:\n- BlockChain\ntags:\n- ipfs\n---\n\n# IPFS介绍\n\n星际文件系统(Inter Planetary File System)。\n\n基于区块链技术的互联网。\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/151386178","slug":"blockchain/ipfs","published":1,"date":"2021-02-22T12:10:18.651Z","updated":"2021-02-22T15:15:12.259Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xv0012018o1qyh9ifh","content":"<h1 id=\"IPFS介绍\"><a href=\"#IPFS介绍\" class=\"headerlink\" title=\"IPFS介绍\"></a>IPFS介绍</h1><p>星际文件系统(Inter Planetary File System)。</p>\n<p>基于区块链技术的互联网。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNTEzODYxNzg=\">https://zhuanlan.zhihu.com/p/151386178<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"IPFS介绍\"><a href=\"#IPFS介绍\" class=\"headerlink\" title=\"IPFS介绍\"></a>IPFS介绍</h1><p>星际文件系统(Inter Planetary File System)。</p>\n<p>基于区块链技术的互联网。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNTEzODYxNzg=\">https://zhuanlan.zhihu.com/p/151386178<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Singleton单例模式","_content":"\n# 饿汉模式\n\n在项目一开始就初始化对象。\n\n```java\npublic class Hungry {\n    private final static Hungry HUNGRY = new Hungry();\n    private Hungry() {\n\n    }\n    public static Hungry getInstance() {\n        return HUNGRY;\n    }\n}\n```\n\n使用私有的构造方式确保对象无法在外部被实例化。使用一个静态方法获取内部的静态实例。\n\n\n\n**不足**：的是如果对象太大，会造成大量资源被占用。\n\n\n\n# 懒汉模式\n\n在需要时实例化对象。\n\n```java\npublic class Lazy {\n    private static Lazy LAZY;\n    private Lazy() {\n\n    }\n    public static Lazy getInstance() {\n        if (LAZY == null) {\n            LAZY = new Lazy();\n        }\n        return LAZY;\n    }\n}\n```\n\n此时线程不安全\n\n\n\n# 双重检验锁的懒汉模式\n\nDouble-Checked locking Lazy Mode\n\n```java\npublic class LazyDCL {\n    private volatile static LazyDCL LAZYDCL;\n    private LazyDCL() {\n\n    }\n    public static LazyDCL getInstance() {\n        if (LAZYDCL == null) {\n            synchronized (LazyDCL.class) {\n                if (LAZYDCL == null) {\n                    LAZYDCL = new LazyDCL();\n                }\n            }\n        }\n        return LAZYDCL;\n    }\n}\n```\n\n此时线程安全，但**还是有问题**，`new LazyDCL()`的时候不是**原子操作**。\n\n实例化需要经过的步骤：\n\n1. 分配内存空间\n2. 执行构造方法 初始化对象\n3. 把这个对象指向这个空间\n\n也就会在底层，CPU执行时发生**指令重排**的错误。\n\n1->2->3（正确）\n\n1->3->2\n\n如果有以上的顺序，当线程A执行到3步骤，此时如果有线程B进来，则会误判`LAZYDCL==null`从而直接返回。由于线程A并没有完成实例化的操作，因此可能会发生错误。\n\n**注意**：此时必须对`LAZYDCL`加上`volatile`从而避免指令重排而产生的错误！！！\n\n\n\n# 终极懒汉模式\n\n## 1.0\n\n**破坏方式**：通过**反射**可以强行改变构造器的可视性。以此再来新建一个对象。\n\n```java\npublic class UltimateLazy {\n\n    private volatile static UltimateLazy ULTIMATELAZY;\n\n    private UltimateLazy() {\n        synchronized (UltimateLazy.class) {\n            if (ULTIMATELAZY != null) {\n                throw new RuntimeException(\"error\");\n            }\n        }\n    }\n\n    private static UltimateLazy getInstance() {\n        ...\n    }\n}\n```\n\n**解决方案**：但是可以再在私有的构造方法里**再加一层判断**。\n\n\n\n## 2.0\n\n**破坏方式**：如果**都使用反射**来破坏单例模式。\n\n```java\npublic class UltimateLazy {\n\n    private volatile static UltimateLazy ULTIMATELAZY;\n\n    private UltimateLazy() {\n        synchronized (UltimateLazy.class) {\n            if (flag == false) {\n                flag = true;\n            } else {\n                throw new RuntimeException(\"error\");\n            }\n        }\n    }\n\n    private static UltimateLazy getInstance() {\n        ...\n    }\n}\n```\n\n**解决方案**：可以加一个标志位来确保单例。\n\n\n\n## 3.0 终极解决方案\n\n**破坏方式**：使用**反射**来改变标志位的值。\n\n```java\npublic enum EnumLazy {\n    INSTANCE;\n\n    public EnumLazy getInstance() {\n        return INSTANCE;\n    }\n}\n\nclass Test {\n    public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {\n        EnumLazy instanceA = EnumLazy.INSTANCE;\n        Constructor<EnumLazy> constructor = EnumLazy.class.getDeclaredConstructor(String.class, int.class);\n        constructor.setAccessible(true);\n        EnumLazy instanceB = constructor.newInstance();\n\n        System.out.println(instanceA == instanceB);\n    }\n}\n```\n\n**解决方案**：使用单例模式来解决。看源码可以得知，**不能使用反射来构建枚举类**。\n\n\n\n----\n\nReference\n\nhttps://www.bilibili.com/video/BV1K54y197iS\n\n","source":"_posts/design/singleton.md","raw":"---\ntitle: Singleton单例模式\ncategories:\n- Notebook\ntags:\n- design\n- singleton\n---\n\n# 饿汉模式\n\n在项目一开始就初始化对象。\n\n```java\npublic class Hungry {\n    private final static Hungry HUNGRY = new Hungry();\n    private Hungry() {\n\n    }\n    public static Hungry getInstance() {\n        return HUNGRY;\n    }\n}\n```\n\n使用私有的构造方式确保对象无法在外部被实例化。使用一个静态方法获取内部的静态实例。\n\n\n\n**不足**：的是如果对象太大，会造成大量资源被占用。\n\n\n\n# 懒汉模式\n\n在需要时实例化对象。\n\n```java\npublic class Lazy {\n    private static Lazy LAZY;\n    private Lazy() {\n\n    }\n    public static Lazy getInstance() {\n        if (LAZY == null) {\n            LAZY = new Lazy();\n        }\n        return LAZY;\n    }\n}\n```\n\n此时线程不安全\n\n\n\n# 双重检验锁的懒汉模式\n\nDouble-Checked locking Lazy Mode\n\n```java\npublic class LazyDCL {\n    private volatile static LazyDCL LAZYDCL;\n    private LazyDCL() {\n\n    }\n    public static LazyDCL getInstance() {\n        if (LAZYDCL == null) {\n            synchronized (LazyDCL.class) {\n                if (LAZYDCL == null) {\n                    LAZYDCL = new LazyDCL();\n                }\n            }\n        }\n        return LAZYDCL;\n    }\n}\n```\n\n此时线程安全，但**还是有问题**，`new LazyDCL()`的时候不是**原子操作**。\n\n实例化需要经过的步骤：\n\n1. 分配内存空间\n2. 执行构造方法 初始化对象\n3. 把这个对象指向这个空间\n\n也就会在底层，CPU执行时发生**指令重排**的错误。\n\n1->2->3（正确）\n\n1->3->2\n\n如果有以上的顺序，当线程A执行到3步骤，此时如果有线程B进来，则会误判`LAZYDCL==null`从而直接返回。由于线程A并没有完成实例化的操作，因此可能会发生错误。\n\n**注意**：此时必须对`LAZYDCL`加上`volatile`从而避免指令重排而产生的错误！！！\n\n\n\n# 终极懒汉模式\n\n## 1.0\n\n**破坏方式**：通过**反射**可以强行改变构造器的可视性。以此再来新建一个对象。\n\n```java\npublic class UltimateLazy {\n\n    private volatile static UltimateLazy ULTIMATELAZY;\n\n    private UltimateLazy() {\n        synchronized (UltimateLazy.class) {\n            if (ULTIMATELAZY != null) {\n                throw new RuntimeException(\"error\");\n            }\n        }\n    }\n\n    private static UltimateLazy getInstance() {\n        ...\n    }\n}\n```\n\n**解决方案**：但是可以再在私有的构造方法里**再加一层判断**。\n\n\n\n## 2.0\n\n**破坏方式**：如果**都使用反射**来破坏单例模式。\n\n```java\npublic class UltimateLazy {\n\n    private volatile static UltimateLazy ULTIMATELAZY;\n\n    private UltimateLazy() {\n        synchronized (UltimateLazy.class) {\n            if (flag == false) {\n                flag = true;\n            } else {\n                throw new RuntimeException(\"error\");\n            }\n        }\n    }\n\n    private static UltimateLazy getInstance() {\n        ...\n    }\n}\n```\n\n**解决方案**：可以加一个标志位来确保单例。\n\n\n\n## 3.0 终极解决方案\n\n**破坏方式**：使用**反射**来改变标志位的值。\n\n```java\npublic enum EnumLazy {\n    INSTANCE;\n\n    public EnumLazy getInstance() {\n        return INSTANCE;\n    }\n}\n\nclass Test {\n    public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {\n        EnumLazy instanceA = EnumLazy.INSTANCE;\n        Constructor<EnumLazy> constructor = EnumLazy.class.getDeclaredConstructor(String.class, int.class);\n        constructor.setAccessible(true);\n        EnumLazy instanceB = constructor.newInstance();\n\n        System.out.println(instanceA == instanceB);\n    }\n}\n```\n\n**解决方案**：使用单例模式来解决。看源码可以得知，**不能使用反射来构建枚举类**。\n\n\n\n----\n\nReference\n\nhttps://www.bilibili.com/video/BV1K54y197iS\n\n","slug":"design/singleton","published":1,"date":"2021-02-01T09:06:47.547Z","updated":"2021-02-01T10:21:03.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xv0014018o8vb81axl","content":"<h1 id=\"饿汉模式\"><a href=\"#饿汉模式\" class=\"headerlink\" title=\"饿汉模式\"></a>饿汉模式</h1><p>在项目一开始就初始化对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hungry</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> Hungry HUNGRY = <span class=\"keyword\">new</span> Hungry();</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Hungry</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Hungry <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> HUNGRY;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用私有的构造方式确保对象无法在外部被实例化。使用一个静态方法获取内部的静态实例。</p>\n<p><strong>不足</strong>：的是如果对象太大，会造成大量资源被占用。</p>\n<h1 id=\"懒汉模式\"><a href=\"#懒汉模式\" class=\"headerlink\" title=\"懒汉模式\"></a>懒汉模式</h1><p>在需要时实例化对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Lazy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Lazy LAZY;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Lazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Lazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LAZY == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            LAZY = <span class=\"keyword\">new</span> Lazy();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> LAZY;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时线程不安全</p>\n<h1 id=\"双重检验锁的懒汉模式\"><a href=\"#双重检验锁的懒汉模式\" class=\"headerlink\" title=\"双重检验锁的懒汉模式\"></a>双重检验锁的懒汉模式</h1><p>Double-Checked locking Lazy Mode</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LazyDCL</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> LazyDCL LAZYDCL;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">LazyDCL</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> LazyDCL <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LAZYDCL == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (LazyDCL<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (LAZYDCL == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    LAZYDCL = <span class=\"keyword\">new</span> LazyDCL();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> LAZYDCL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时线程安全，但<strong>还是有问题</strong>，<code>new LazyDCL()</code>的时候不是<strong>原子操作</strong>。</p>\n<p>实例化需要经过的步骤：</p>\n<ol>\n<li>分配内存空间</li>\n<li>执行构造方法 初始化对象</li>\n<li>把这个对象指向这个空间</li>\n</ol>\n<p>也就会在底层，CPU执行时发生<strong>指令重排</strong>的错误。</p>\n<p>1-&gt;2-&gt;3（正确）</p>\n<p>1-&gt;3-&gt;2</p>\n<p>如果有以上的顺序，当线程A执行到3步骤，此时如果有线程B进来，则会误判<code>LAZYDCL==null</code>从而直接返回。由于线程A并没有完成实例化的操作，因此可能会发生错误。</p>\n<p><strong>注意</strong>：此时必须对<code>LAZYDCL</code>加上<code>volatile</code>从而避免指令重排而产生的错误！！！</p>\n<h1 id=\"终极懒汉模式\"><a href=\"#终极懒汉模式\" class=\"headerlink\" title=\"终极懒汉模式\"></a>终极懒汉模式</h1><h2 id=\"1-0\"><a href=\"#1-0\" class=\"headerlink\" title=\"1.0\"></a>1.0</h2><p><strong>破坏方式</strong>：通过<strong>反射</strong>可以强行改变构造器的可视性。以此再来新建一个对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UltimateLazy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> UltimateLazy ULTIMATELAZY;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">UltimateLazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (UltimateLazy<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ULTIMATELAZY != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> UltimateLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：但是可以再在私有的构造方法里<strong>再加一层判断</strong>。</p>\n<h2 id=\"2-0\"><a href=\"#2-0\" class=\"headerlink\" title=\"2.0\"></a>2.0</h2><p><strong>破坏方式</strong>：如果<strong>都使用反射</strong>来破坏单例模式。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UltimateLazy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> UltimateLazy ULTIMATELAZY;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">UltimateLazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (UltimateLazy<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag == <span class=\"keyword\">false</span>) &#123;</span><br><span class=\"line\">                flag = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> UltimateLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：可以加一个标志位来确保单例。</p>\n<h2 id=\"3-0-终极解决方案\"><a href=\"#3-0-终极解决方案\" class=\"headerlink\" title=\"3.0 终极解决方案\"></a>3.0 终极解决方案</h2><p><strong>破坏方式</strong>：使用<strong>反射</strong>来改变标志位的值。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> EnumLazy &#123;</span><br><span class=\"line\">    INSTANCE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> EnumLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> INSTANCE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException </span>&#123;</span><br><span class=\"line\">        EnumLazy instanceA = EnumLazy.INSTANCE;</span><br><span class=\"line\">        Constructor&lt;EnumLazy&gt; constructor = EnumLazy<span class=\"class\">.<span class=\"keyword\">class</span>.<span class=\"title\">getDeclaredConstructor</span>(<span class=\"title\">String</span>.<span class=\"title\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;</span><br><span class=\"line\">        constructor.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        EnumLazy instanceB = constructor.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(instanceA == instanceB);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：使用单例模式来解决。看源码可以得知，<strong>不能使用反射来构建枚举类</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMUs1NHkxOTdpUw==\">https://www.bilibili.com/video/BV1K54y197iS<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"饿汉模式\"><a href=\"#饿汉模式\" class=\"headerlink\" title=\"饿汉模式\"></a>饿汉模式</h1><p>在项目一开始就初始化对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hungry</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> Hungry HUNGRY = <span class=\"keyword\">new</span> Hungry();</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Hungry</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Hungry <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> HUNGRY;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用私有的构造方式确保对象无法在外部被实例化。使用一个静态方法获取内部的静态实例。</p>\n<p><strong>不足</strong>：的是如果对象太大，会造成大量资源被占用。</p>\n<h1 id=\"懒汉模式\"><a href=\"#懒汉模式\" class=\"headerlink\" title=\"懒汉模式\"></a>懒汉模式</h1><p>在需要时实例化对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Lazy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Lazy LAZY;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Lazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Lazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LAZY == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            LAZY = <span class=\"keyword\">new</span> Lazy();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> LAZY;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时线程不安全</p>\n<h1 id=\"双重检验锁的懒汉模式\"><a href=\"#双重检验锁的懒汉模式\" class=\"headerlink\" title=\"双重检验锁的懒汉模式\"></a>双重检验锁的懒汉模式</h1><p>Double-Checked locking Lazy Mode</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LazyDCL</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> LazyDCL LAZYDCL;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">LazyDCL</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> LazyDCL <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LAZYDCL == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (LazyDCL<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (LAZYDCL == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    LAZYDCL = <span class=\"keyword\">new</span> LazyDCL();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> LAZYDCL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时线程安全，但<strong>还是有问题</strong>，<code>new LazyDCL()</code>的时候不是<strong>原子操作</strong>。</p>\n<p>实例化需要经过的步骤：</p>\n<ol>\n<li>分配内存空间</li>\n<li>执行构造方法 初始化对象</li>\n<li>把这个对象指向这个空间</li>\n</ol>\n<p>也就会在底层，CPU执行时发生<strong>指令重排</strong>的错误。</p>\n<p>1-&gt;2-&gt;3（正确）</p>\n<p>1-&gt;3-&gt;2</p>\n<p>如果有以上的顺序，当线程A执行到3步骤，此时如果有线程B进来，则会误判<code>LAZYDCL==null</code>从而直接返回。由于线程A并没有完成实例化的操作，因此可能会发生错误。</p>\n<p><strong>注意</strong>：此时必须对<code>LAZYDCL</code>加上<code>volatile</code>从而避免指令重排而产生的错误！！！</p>\n<h1 id=\"终极懒汉模式\"><a href=\"#终极懒汉模式\" class=\"headerlink\" title=\"终极懒汉模式\"></a>终极懒汉模式</h1><h2 id=\"1-0\"><a href=\"#1-0\" class=\"headerlink\" title=\"1.0\"></a>1.0</h2><p><strong>破坏方式</strong>：通过<strong>反射</strong>可以强行改变构造器的可视性。以此再来新建一个对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UltimateLazy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> UltimateLazy ULTIMATELAZY;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">UltimateLazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (UltimateLazy<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ULTIMATELAZY != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> UltimateLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：但是可以再在私有的构造方法里<strong>再加一层判断</strong>。</p>\n<h2 id=\"2-0\"><a href=\"#2-0\" class=\"headerlink\" title=\"2.0\"></a>2.0</h2><p><strong>破坏方式</strong>：如果<strong>都使用反射</strong>来破坏单例模式。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UltimateLazy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> UltimateLazy ULTIMATELAZY;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">UltimateLazy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (UltimateLazy<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag == <span class=\"keyword\">false</span>) &#123;</span><br><span class=\"line\">                flag = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> UltimateLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：可以加一个标志位来确保单例。</p>\n<h2 id=\"3-0-终极解决方案\"><a href=\"#3-0-终极解决方案\" class=\"headerlink\" title=\"3.0 终极解决方案\"></a>3.0 终极解决方案</h2><p><strong>破坏方式</strong>：使用<strong>反射</strong>来改变标志位的值。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> EnumLazy &#123;</span><br><span class=\"line\">    INSTANCE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> EnumLazy <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> INSTANCE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException </span>&#123;</span><br><span class=\"line\">        EnumLazy instanceA = EnumLazy.INSTANCE;</span><br><span class=\"line\">        Constructor&lt;EnumLazy&gt; constructor = EnumLazy<span class=\"class\">.<span class=\"keyword\">class</span>.<span class=\"title\">getDeclaredConstructor</span>(<span class=\"title\">String</span>.<span class=\"title\">class</span>, <span class=\"title\">int</span>.<span class=\"title\">class</span>)</span>;</span><br><span class=\"line\">        constructor.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        EnumLazy instanceB = constructor.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(instanceA == instanceB);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案</strong>：使用单例模式来解决。看源码可以得知，<strong>不能使用反射来构建枚举类</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMUs1NHkxOTdpUw==\">https://www.bilibili.com/video/BV1K54y197iS<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 使用Docker搭建图床\n\n安装容器编排工具Compose  \n`pip3 install docker-compose`\n\npull镜像  \n`docker pull mariadb:latest`  \n`docker pull nmtan/chevereto:latest`  \n\n使用Docker-Compose启动  \n`mkdir cheverto/`  \n`cd cheverto`  \n`touch docker-compose.yaml`\n\ndocker-compose.yaml配置文件\n\n```yml\nversion: '3'\n\nservices:\n  db:\n    image: mariadb\n    volumes:\n      - database:/var/lib/mysql:rw\n    restart: always\n    networks:\n      - private\n    environment:\n      MYSQL_ROOT_PASSWORD: chevereto_root\n      MYSQL_DATABASE: chevereto\n      MYSQL_USER: chevereto\n      MYSQL_PASSWORD: chevereto\n\n  chevereto:\n    depends_on:\n      - db\n    image: nmtan/chevereto\n    restart: always\n    networks:\n      - private\n    environment:\n      CHEVERETO_DB_HOST: db\n      CHEVERETO_DB_USERNAME: chevereto\n      CHEVERETO_DB_PASSWORD: chevereto\n      CHEVERETO_DB_NAME: chevereto\n      CHEVERETO_DB_PREFIX: chv_\n    volumes:\n      - chevereto_images:/var/www/html/images:rw\n      - chevereto_php_config:/usr/local/etc/php:rw\n    ports:\n      - 12000:80\n\nnetworks:\n  private:\nvolumes:\n  database:\n  chevereto_images:\n  chevereto_php_config:\n```\n\n对应挂载到当前文件夹中的php.ini文件(**注意** php.ini文件需要先创建 否则docker会自动创建同名文件夹)\n`- ./php.ini:/usr/local/etc/php/php.ini:rw`\n\nphp.ini\n```ini\nmemory_limit = 256M;\nupload_max_filesize = 100M;\npost_max_size = 100M;\n```\n\n运行Docker-Compose  \n`docker-compose up -d`","source":"_posts/docker/docker-chevereto.md","raw":"# 使用Docker搭建图床\n\n安装容器编排工具Compose  \n`pip3 install docker-compose`\n\npull镜像  \n`docker pull mariadb:latest`  \n`docker pull nmtan/chevereto:latest`  \n\n使用Docker-Compose启动  \n`mkdir cheverto/`  \n`cd cheverto`  \n`touch docker-compose.yaml`\n\ndocker-compose.yaml配置文件\n\n```yml\nversion: '3'\n\nservices:\n  db:\n    image: mariadb\n    volumes:\n      - database:/var/lib/mysql:rw\n    restart: always\n    networks:\n      - private\n    environment:\n      MYSQL_ROOT_PASSWORD: chevereto_root\n      MYSQL_DATABASE: chevereto\n      MYSQL_USER: chevereto\n      MYSQL_PASSWORD: chevereto\n\n  chevereto:\n    depends_on:\n      - db\n    image: nmtan/chevereto\n    restart: always\n    networks:\n      - private\n    environment:\n      CHEVERETO_DB_HOST: db\n      CHEVERETO_DB_USERNAME: chevereto\n      CHEVERETO_DB_PASSWORD: chevereto\n      CHEVERETO_DB_NAME: chevereto\n      CHEVERETO_DB_PREFIX: chv_\n    volumes:\n      - chevereto_images:/var/www/html/images:rw\n      - chevereto_php_config:/usr/local/etc/php:rw\n    ports:\n      - 12000:80\n\nnetworks:\n  private:\nvolumes:\n  database:\n  chevereto_images:\n  chevereto_php_config:\n```\n\n对应挂载到当前文件夹中的php.ini文件(**注意** php.ini文件需要先创建 否则docker会自动创建同名文件夹)\n`- ./php.ini:/usr/local/etc/php/php.ini:rw`\n\nphp.ini\n```ini\nmemory_limit = 256M;\nupload_max_filesize = 100M;\npost_max_size = 100M;\n```\n\n运行Docker-Compose  \n`docker-compose up -d`","slug":"docker/docker-chevereto","published":1,"date":"2020-07-14T15:31:04.196Z","updated":"2020-07-14T15:31:04.197Z","title":"docker/docker-chevereto","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xw0017018o9wad5jty","content":"<h1 id=\"使用Docker搭建图床\"><a href=\"#使用Docker搭建图床\" class=\"headerlink\" title=\"使用Docker搭建图床\"></a>使用Docker搭建图床</h1><p>安装容器编排工具Compose<br><code>pip3 install docker-compose</code></p>\n<p>pull镜像<br><code>docker pull mariadb:latest</code><br><code>docker pull nmtan/chevereto:latest</code>  </p>\n<p>使用Docker-Compose启动<br><code>mkdir cheverto/</code><br><code>cd cheverto</code><br><code>touch docker-compose.yaml</code></p>\n<p>docker-compose.yaml配置文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mariadb</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">database:/var/lib/mysql:rw</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">private</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD:</span> <span class=\"string\">chevereto_root</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_DATABASE:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_USER:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_PASSWORD:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">chevereto:</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">nmtan/chevereto</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">private</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_HOST:</span> <span class=\"string\">db</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_USERNAME:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_PASSWORD:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_NAME:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_PREFIX:</span> <span class=\"string\">chv_</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">chevereto_images:/var/www/html/images:rw</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">chevereto_php_config:/usr/local/etc/php:rw</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">12000</span><span class=\"string\">:80</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">networks:</span></span><br><span class=\"line\">  <span class=\"attr\">private:</span></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">database:</span></span><br><span class=\"line\">  <span class=\"attr\">chevereto_images:</span></span><br><span class=\"line\">  <span class=\"attr\">chevereto_php_config:</span></span><br></pre></td></tr></table></figure>\n\n<p>对应挂载到当前文件夹中的php.ini文件(<strong>注意</strong> php.ini文件需要先创建 否则docker会自动创建同名文件夹)<br><code>- ./php.ini:/usr/local/etc/php/php.ini:rw</code></p>\n<p>php.ini</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">memory_limit</span> = <span class=\"number\">256</span>M<span class=\"comment\">;</span></span><br><span class=\"line\"><span class=\"attr\">upload_max_filesize</span> = <span class=\"number\">100</span>M<span class=\"comment\">;</span></span><br><span class=\"line\"><span class=\"attr\">post_max_size</span> = <span class=\"number\">100</span>M<span class=\"comment\">;</span></span><br></pre></td></tr></table></figure>\n\n<p>运行Docker-Compose<br><code>docker-compose up -d</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"使用Docker搭建图床\"><a href=\"#使用Docker搭建图床\" class=\"headerlink\" title=\"使用Docker搭建图床\"></a>使用Docker搭建图床</h1><p>安装容器编排工具Compose<br><code>pip3 install docker-compose</code></p>\n<p>pull镜像<br><code>docker pull mariadb:latest</code><br><code>docker pull nmtan/chevereto:latest</code>  </p>\n<p>使用Docker-Compose启动<br><code>mkdir cheverto/</code><br><code>cd cheverto</code><br><code>touch docker-compose.yaml</code></p>\n<p>docker-compose.yaml配置文件</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mariadb</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">database:/var/lib/mysql:rw</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">private</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD:</span> <span class=\"string\">chevereto_root</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_DATABASE:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_USER:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_PASSWORD:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">chevereto:</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">nmtan/chevereto</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">private</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_HOST:</span> <span class=\"string\">db</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_USERNAME:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_PASSWORD:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_NAME:</span> <span class=\"string\">chevereto</span></span><br><span class=\"line\">      <span class=\"attr\">CHEVERETO_DB_PREFIX:</span> <span class=\"string\">chv_</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">chevereto_images:/var/www/html/images:rw</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">chevereto_php_config:/usr/local/etc/php:rw</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">12000</span><span class=\"string\">:80</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">networks:</span></span><br><span class=\"line\">  <span class=\"attr\">private:</span></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">database:</span></span><br><span class=\"line\">  <span class=\"attr\">chevereto_images:</span></span><br><span class=\"line\">  <span class=\"attr\">chevereto_php_config:</span></span><br></pre></td></tr></table></figure>\n\n<p>对应挂载到当前文件夹中的php.ini文件(<strong>注意</strong> php.ini文件需要先创建 否则docker会自动创建同名文件夹)<br><code>- ./php.ini:/usr/local/etc/php/php.ini:rw</code></p>\n<p>php.ini</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">memory_limit</span> = <span class=\"number\">256</span>M<span class=\"comment\">;</span></span><br><span class=\"line\"><span class=\"attr\">upload_max_filesize</span> = <span class=\"number\">100</span>M<span class=\"comment\">;</span></span><br><span class=\"line\"><span class=\"attr\">post_max_size</span> = <span class=\"number\">100</span>M<span class=\"comment\">;</span></span><br></pre></td></tr></table></figure>\n\n<p>运行Docker-Compose<br><code>docker-compose up -d</code></p>\n"},{"_content":"# 使用Docker配置Anaconda环境运行Jupyter\n\n## 配置Anaconda环境\n\n**挂载**\n- 文件夹挂载\n`-v /root/notebook:/notebook`\n(宿主机目录:镜像内挂载目录)\n\n- *配置文件挂载*(生成的文件夹)\n`-v /root/docker/config/anaconda3/jupyter_notebook_config.json:/root/.jupyter/jupyter_notebook_config.json`\n\n**Example**  \n`docker run -i -t -p 11000:8888 -v ~/notebook:/notebook -v ~/docker/config/jupyter:/root/.jupyter continuumio/anaconda3 /bin/bash`  \n挂载参数要在容器前\n\n\n\n## 配置Jupyter Notebook\n\n`jupyter notebook --allow-root`\n\n启动Notebook\n`jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root`\n\n后台运行Notebook\n`nohup jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root &`\n\n**相关配置**\n\n配置文件\n```py\nc = get_config()\nc.IPKernelApp.pylab = \"inline\"\nc.NotebookApp.ip = \"*\"\nc.NotebookAPp.open_browser = False\nc.NotebookApp.password = 'sha1:5295d47ebd06:cdca9499f90b4b4616c935fdff61dda71e1e4393'\n# c.NotebookApp.certfile = u'/root/.jupyter/mycert.pem'\nc.NotebookApp.port= 8888\nc.NotebookApp.notebook_dir = \"/\"\n```\n\n\n\n*docker-compose配置出问题？*\n```yml\nversion: '3'\n\nservices:\n  notebook:\n    image: continuumio/anaconda3\n    restart: \"no\"\n    volumes:\n      - ~/notebook:/notebook\n      - ~/docker/config/jupyter:/root/.jupyter\n    ports:\n      - \"11000:80\"\n```","source":"_posts/docker/docker-anaconda.md","raw":"# 使用Docker配置Anaconda环境运行Jupyter\n\n## 配置Anaconda环境\n\n**挂载**\n- 文件夹挂载\n`-v /root/notebook:/notebook`\n(宿主机目录:镜像内挂载目录)\n\n- *配置文件挂载*(生成的文件夹)\n`-v /root/docker/config/anaconda3/jupyter_notebook_config.json:/root/.jupyter/jupyter_notebook_config.json`\n\n**Example**  \n`docker run -i -t -p 11000:8888 -v ~/notebook:/notebook -v ~/docker/config/jupyter:/root/.jupyter continuumio/anaconda3 /bin/bash`  \n挂载参数要在容器前\n\n\n\n## 配置Jupyter Notebook\n\n`jupyter notebook --allow-root`\n\n启动Notebook\n`jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root`\n\n后台运行Notebook\n`nohup jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root &`\n\n**相关配置**\n\n配置文件\n```py\nc = get_config()\nc.IPKernelApp.pylab = \"inline\"\nc.NotebookApp.ip = \"*\"\nc.NotebookAPp.open_browser = False\nc.NotebookApp.password = 'sha1:5295d47ebd06:cdca9499f90b4b4616c935fdff61dda71e1e4393'\n# c.NotebookApp.certfile = u'/root/.jupyter/mycert.pem'\nc.NotebookApp.port= 8888\nc.NotebookApp.notebook_dir = \"/\"\n```\n\n\n\n*docker-compose配置出问题？*\n```yml\nversion: '3'\n\nservices:\n  notebook:\n    image: continuumio/anaconda3\n    restart: \"no\"\n    volumes:\n      - ~/notebook:/notebook\n      - ~/docker/config/jupyter:/root/.jupyter\n    ports:\n      - \"11000:80\"\n```","slug":"docker/docker-anaconda","published":1,"date":"2020-07-14T15:31:04.196Z","updated":"2020-07-14T15:31:04.196Z","title":"docker/docker-anaconda","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xx001a018odza02gbc","content":"<h1 id=\"使用Docker配置Anaconda环境运行Jupyter\"><a href=\"#使用Docker配置Anaconda环境运行Jupyter\" class=\"headerlink\" title=\"使用Docker配置Anaconda环境运行Jupyter\"></a>使用Docker配置Anaconda环境运行Jupyter</h1><h2 id=\"配置Anaconda环境\"><a href=\"#配置Anaconda环境\" class=\"headerlink\" title=\"配置Anaconda环境\"></a>配置Anaconda环境</h2><p><strong>挂载</strong></p>\n<ul>\n<li><p>文件夹挂载<br><code>-v /root/notebook:/notebook</code><br>(宿主机目录:镜像内挂载目录)</p>\n</li>\n<li><p><em>配置文件挂载</em>(生成的文件夹)<br><code>-v /root/docker/config/anaconda3/jupyter_notebook_config.json:/root/.jupyter/jupyter_notebook_config.json</code></p>\n</li>\n</ul>\n<p><strong>Example</strong><br><code>docker run -i -t -p 11000:8888 -v ~/notebook:/notebook -v ~/docker/config/jupyter:/root/.jupyter continuumio/anaconda3 /bin/bash</code><br>挂载参数要在容器前</p>\n<h2 id=\"配置Jupyter-Notebook\"><a href=\"#配置Jupyter-Notebook\" class=\"headerlink\" title=\"配置Jupyter Notebook\"></a>配置Jupyter Notebook</h2><p><code>jupyter notebook --allow-root</code></p>\n<p>启动Notebook<br><code>jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root</code></p>\n<p>后台运行Notebook<br><code>nohup jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root &amp;</code></p>\n<p><strong>相关配置</strong></p>\n<p>配置文件</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c = get_config()</span><br><span class=\"line\">c.IPKernelApp.pylab = <span class=\"string\">\"inline\"</span></span><br><span class=\"line\">c.NotebookApp.ip = <span class=\"string\">\"*\"</span></span><br><span class=\"line\">c.NotebookAPp.open_browser = <span class=\"literal\">False</span></span><br><span class=\"line\">c.NotebookApp.password = <span class=\"string\">'sha1:5295d47ebd06:cdca9499f90b4b4616c935fdff61dda71e1e4393'</span></span><br><span class=\"line\"><span class=\"comment\"># c.NotebookApp.certfile = u'/root/.jupyter/mycert.pem'</span></span><br><span class=\"line\">c.NotebookApp.port= <span class=\"number\">8888</span></span><br><span class=\"line\">c.NotebookApp.notebook_dir = <span class=\"string\">\"/\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><em>docker-compose配置出问题？</em></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">notebook:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">continuumio/anaconda3</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">\"no\"</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/notebook:/notebook</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker/config/jupyter:/root/.jupyter</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"11000:80\"</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"使用Docker配置Anaconda环境运行Jupyter\"><a href=\"#使用Docker配置Anaconda环境运行Jupyter\" class=\"headerlink\" title=\"使用Docker配置Anaconda环境运行Jupyter\"></a>使用Docker配置Anaconda环境运行Jupyter</h1><h2 id=\"配置Anaconda环境\"><a href=\"#配置Anaconda环境\" class=\"headerlink\" title=\"配置Anaconda环境\"></a>配置Anaconda环境</h2><p><strong>挂载</strong></p>\n<ul>\n<li><p>文件夹挂载<br><code>-v /root/notebook:/notebook</code><br>(宿主机目录:镜像内挂载目录)</p>\n</li>\n<li><p><em>配置文件挂载</em>(生成的文件夹)<br><code>-v /root/docker/config/anaconda3/jupyter_notebook_config.json:/root/.jupyter/jupyter_notebook_config.json</code></p>\n</li>\n</ul>\n<p><strong>Example</strong><br><code>docker run -i -t -p 11000:8888 -v ~/notebook:/notebook -v ~/docker/config/jupyter:/root/.jupyter continuumio/anaconda3 /bin/bash</code><br>挂载参数要在容器前</p>\n<h2 id=\"配置Jupyter-Notebook\"><a href=\"#配置Jupyter-Notebook\" class=\"headerlink\" title=\"配置Jupyter Notebook\"></a>配置Jupyter Notebook</h2><p><code>jupyter notebook --allow-root</code></p>\n<p>启动Notebook<br><code>jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root</code></p>\n<p>后台运行Notebook<br><code>nohup jupyter notebook --port 8888 --ip 0.0.0.0 --allow-root &amp;</code></p>\n<p><strong>相关配置</strong></p>\n<p>配置文件</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c = get_config()</span><br><span class=\"line\">c.IPKernelApp.pylab = <span class=\"string\">\"inline\"</span></span><br><span class=\"line\">c.NotebookApp.ip = <span class=\"string\">\"*\"</span></span><br><span class=\"line\">c.NotebookAPp.open_browser = <span class=\"literal\">False</span></span><br><span class=\"line\">c.NotebookApp.password = <span class=\"string\">'sha1:5295d47ebd06:cdca9499f90b4b4616c935fdff61dda71e1e4393'</span></span><br><span class=\"line\"><span class=\"comment\"># c.NotebookApp.certfile = u'/root/.jupyter/mycert.pem'</span></span><br><span class=\"line\">c.NotebookApp.port= <span class=\"number\">8888</span></span><br><span class=\"line\">c.NotebookApp.notebook_dir = <span class=\"string\">\"/\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><em>docker-compose配置出问题？</em></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">notebook:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">continuumio/anaconda3</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">\"no\"</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/notebook:/notebook</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker/config/jupyter:/root/.jupyter</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"11000:80\"</span></span><br></pre></td></tr></table></figure>"},{"_content":"# Docker-GitLab\n\n## 注意\n\n若容器端口号设置为80，如果你这时修改external_url地址为http://ip:8080.  \n那GitLab肯定访问不了，因为已经将内部的端口号修改为8080端口了，而映射的是容器的80端口。\n\n## 故一定要将容器内部端口号与宿主机端口号映射一致！！！\nexternal_utl 'http://119.23.107.61:13000'  \nports:\n      - \"13000:13000\"\n```yml\nversion: '3'\n\nservices:\n  gitlab:\n    image: gitlab/gitlab-ce\n    restart: always\n    environment:\n      TZ: \"Asia/Shanghai\"\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'http://119.23.107.61:13000' // 好像需要手动改\n    volumes:\n      - ~/docker_gitlab/config:/etc/gitlab \n      - ~/docker_gitlab/logs:/var/log/gitlab \n      - ~/docker_gitlab/data:/var/opt/gitlab\n    ports:\n      - \"13000:13000\"\n      - \"13443:443\"\n      - \"13022:22\"\n```","source":"_posts/docker/docker-gitlab.md","raw":"# Docker-GitLab\n\n## 注意\n\n若容器端口号设置为80，如果你这时修改external_url地址为http://ip:8080.  \n那GitLab肯定访问不了，因为已经将内部的端口号修改为8080端口了，而映射的是容器的80端口。\n\n## 故一定要将容器内部端口号与宿主机端口号映射一致！！！\nexternal_utl 'http://119.23.107.61:13000'  \nports:\n      - \"13000:13000\"\n```yml\nversion: '3'\n\nservices:\n  gitlab:\n    image: gitlab/gitlab-ce\n    restart: always\n    environment:\n      TZ: \"Asia/Shanghai\"\n      GITLAB_OMNIBUS_CONFIG: |\n        external_url 'http://119.23.107.61:13000' // 好像需要手动改\n    volumes:\n      - ~/docker_gitlab/config:/etc/gitlab \n      - ~/docker_gitlab/logs:/var/log/gitlab \n      - ~/docker_gitlab/data:/var/opt/gitlab\n    ports:\n      - \"13000:13000\"\n      - \"13443:443\"\n      - \"13022:22\"\n```","slug":"docker/docker-gitlab","published":1,"date":"2020-07-14T15:31:04.197Z","updated":"2020-07-14T15:31:04.197Z","title":"docker/docker-gitlab","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97xy001d018ohvs141lo","content":"<h1 id=\"Docker-GitLab\"><a href=\"#Docker-GitLab\" class=\"headerlink\" title=\"Docker-GitLab\"></a>Docker-GitLab</h1><h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p>若容器端口号设置为80，如果你这时修改external_url地址为<span class=\"exturl\" data-url=\"aHR0cDovL2lwOjgwODA=\">http://ip:8080<i class=\"fa fa-external-link-alt\"></i></span>.<br>那GitLab肯定访问不了，因为已经将内部的端口号修改为8080端口了，而映射的是容器的80端口。</p>\n<h2 id=\"故一定要将容器内部端口号与宿主机端口号映射一致！！！\"><a href=\"#故一定要将容器内部端口号与宿主机端口号映射一致！！！\" class=\"headerlink\" title=\"故一定要将容器内部端口号与宿主机端口号映射一致！！！\"></a>故一定要将容器内部端口号与宿主机端口号映射一致！！！</h2><p>external_utl ‘<span class=\"exturl\" data-url=\"aHR0cDovLzExOS4yMy4xMDcuNjE6MTMwMDAmIzM5Ow==\">http://119.23.107.61:13000&#39;<i class=\"fa fa-external-link-alt\"></i></span><br>ports:<br>      - “13000:13000”</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">gitlab/gitlab-ce</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">TZ:</span> <span class=\"string\">\"Asia/Shanghai\"</span></span><br><span class=\"line\">      <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\">        <span class=\"string\">external_url</span> <span class=\"string\">'http://119.23.107.61:13000'</span> <span class=\"string\">//</span> <span class=\"string\">好像需要手动改</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/config:/etc/gitlab</span> </span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/logs:/var/log/gitlab</span> </span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/data:/var/opt/gitlab</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13000:13000\"</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13443:443\"</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13022:22\"</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-GitLab\"><a href=\"#Docker-GitLab\" class=\"headerlink\" title=\"Docker-GitLab\"></a>Docker-GitLab</h1><h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p>若容器端口号设置为80，如果你这时修改external_url地址为<span class=\"exturl\" data-url=\"aHR0cDovL2lwOjgwODA=\">http://ip:8080<i class=\"fa fa-external-link-alt\"></i></span>.<br>那GitLab肯定访问不了，因为已经将内部的端口号修改为8080端口了，而映射的是容器的80端口。</p>\n<h2 id=\"故一定要将容器内部端口号与宿主机端口号映射一致！！！\"><a href=\"#故一定要将容器内部端口号与宿主机端口号映射一致！！！\" class=\"headerlink\" title=\"故一定要将容器内部端口号与宿主机端口号映射一致！！！\"></a>故一定要将容器内部端口号与宿主机端口号映射一致！！！</h2><p>external_utl ‘<span class=\"exturl\" data-url=\"aHR0cDovLzExOS4yMy4xMDcuNjE6MTMwMDAmIzM5Ow==\">http://119.23.107.61:13000&#39;<i class=\"fa fa-external-link-alt\"></i></span><br>ports:<br>      - “13000:13000”</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">gitlab/gitlab-ce</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">TZ:</span> <span class=\"string\">\"Asia/Shanghai\"</span></span><br><span class=\"line\">      <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\">        <span class=\"string\">external_url</span> <span class=\"string\">'http://119.23.107.61:13000'</span> <span class=\"string\">//</span> <span class=\"string\">好像需要手动改</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/config:/etc/gitlab</span> </span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/logs:/var/log/gitlab</span> </span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">~/docker_gitlab/data:/var/opt/gitlab</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13000:13000\"</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13443:443\"</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">\"13022:22\"</span></span><br></pre></td></tr></table></figure>"},{"title":"Docker compose","catagories":["Docker"],"_content":"\n# Docker-Compose\n\nupdate: 2021/10/9\n\nurl: +v2.0.1\n\n# 安装\n\n```sh\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.0.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n```\n\n有可能会遇到权限不足的问题\n\n```sh\nchmod +x /usr/local/bin/docker-compose\n```\n\n如果不在环境路径下 创建软连接\n\n```sh\nln -s /usr/bin /usr/local/bin/docker-compose\n```\n\n# 运行指令\n\n\b`docker-compose`指令**默认执行**当前文件夹下docker-compose.yml文件\n\n## 项目运行 \n\n```sh\nsudo docker-compose -f app.yml up -d\n```\n\n## 项目停止 \n\n```sh\nsudo docker-compose -f app.yml down\n```\n\n## 挂载\n\n`host:container`\n\nvolumes声明过的名称才能用在镜像的volumes挂载 \n镜像中volumes挂载地址也可以使用相对路径\n\n## 更多指令\n\nhttps://www.jianshu.com/p/658911a8cff3\n","source":"_posts/docker/docker-compose.md","raw":"---\ntitle: Docker compose\ncatagories:\n- Docker\ntags:\n- compose\n---\n\n# Docker-Compose\n\nupdate: 2021/10/9\n\nurl: +v2.0.1\n\n# 安装\n\n```sh\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.0.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n```\n\n有可能会遇到权限不足的问题\n\n```sh\nchmod +x /usr/local/bin/docker-compose\n```\n\n如果不在环境路径下 创建软连接\n\n```sh\nln -s /usr/bin /usr/local/bin/docker-compose\n```\n\n# 运行指令\n\n\b`docker-compose`指令**默认执行**当前文件夹下docker-compose.yml文件\n\n## 项目运行 \n\n```sh\nsudo docker-compose -f app.yml up -d\n```\n\n## 项目停止 \n\n```sh\nsudo docker-compose -f app.yml down\n```\n\n## 挂载\n\n`host:container`\n\nvolumes声明过的名称才能用在镜像的volumes挂载 \n镜像中volumes挂载地址也可以使用相对路径\n\n## 更多指令\n\nhttps://www.jianshu.com/p/658911a8cff3\n","slug":"docker/docker-compose","published":1,"date":"2020-07-14T15:31:04.197Z","updated":"2021-10-09T05:41:18.263Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y0001g018o55ei3pqs","content":"<h1 id=\"Docker-Compose\"><a href=\"#Docker-Compose\" class=\"headerlink\" title=\"Docker-Compose\"></a>Docker-Compose</h1><p>update: 2021/10/9</p>\n<p>url: +v2.0.1</p>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L <span class=\"string\">\"https://github.com/docker/compose/releases/download/v2.0.1/docker-compose-<span class=\"variable\">$(uname -s)</span>-<span class=\"variable\">$(uname -m)</span>\"</span> -o /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p>有可能会遇到权限不足的问题</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p>如果不在环境路径下 创建软连接</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -s /usr/bin /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"运行指令\"><a href=\"#运行指令\" class=\"headerlink\" title=\"运行指令\"></a>运行指令</h1><p>\b<code>docker-compose</code>指令<strong>默认执行</strong>当前文件夹下docker-compose.yml文件</p>\n<h2 id=\"项目运行\"><a href=\"#项目运行\" class=\"headerlink\" title=\"项目运行\"></a>项目运行</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f app.yml up -d</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"项目停止\"><a href=\"#项目停止\" class=\"headerlink\" title=\"项目停止\"></a>项目停止</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f app.yml down</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"挂载\"><a href=\"#挂载\" class=\"headerlink\" title=\"挂载\"></a>挂载</h2><p><code>host:container</code></p>\n<p>volumes声明过的名称才能用在镜像的volumes挂载<br>镜像中volumes挂载地址也可以使用相对路径</p>\n<h2 id=\"更多指令\"><a href=\"#更多指令\" class=\"headerlink\" title=\"更多指令\"></a>更多指令</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82NTg5MTFhOGNmZjM=\">https://www.jianshu.com/p/658911a8cff3<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-Compose\"><a href=\"#Docker-Compose\" class=\"headerlink\" title=\"Docker-Compose\"></a>Docker-Compose</h1><p>update: 2021/10/9</p>\n<p>url: +v2.0.1</p>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L <span class=\"string\">\"https://github.com/docker/compose/releases/download/v2.0.1/docker-compose-<span class=\"variable\">$(uname -s)</span>-<span class=\"variable\">$(uname -m)</span>\"</span> -o /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p>有可能会遇到权限不足的问题</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p>如果不在环境路径下 创建软连接</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -s /usr/bin /usr/<span class=\"built_in\">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"运行指令\"><a href=\"#运行指令\" class=\"headerlink\" title=\"运行指令\"></a>运行指令</h1><p>\b<code>docker-compose</code>指令<strong>默认执行</strong>当前文件夹下docker-compose.yml文件</p>\n<h2 id=\"项目运行\"><a href=\"#项目运行\" class=\"headerlink\" title=\"项目运行\"></a>项目运行</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f app.yml up -d</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"项目停止\"><a href=\"#项目停止\" class=\"headerlink\" title=\"项目停止\"></a>项目停止</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f app.yml down</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"挂载\"><a href=\"#挂载\" class=\"headerlink\" title=\"挂载\"></a>挂载</h2><p><code>host:container</code></p>\n<p>volumes声明过的名称才能用在镜像的volumes挂载<br>镜像中volumes挂载地址也可以使用相对路径</p>\n<h2 id=\"更多指令\"><a href=\"#更多指令\" class=\"headerlink\" title=\"更多指令\"></a>更多指令</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82NTg5MTFhOGNmZjM=\">https://www.jianshu.com/p/658911a8cff3<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Install Neo4j on linux by Docker","_content":"\n# Java Environment\n\nMake sure the java environment on you server is updated to `java11`, if you are going to install neo4j-4.0 or above.\n\n```\nsudo apt install openjdk-11-jre-headless\n```\n\n\n\n# docker-compose\n\n```\nversion: '3'\nservices:\n\n  neo4j:\n    image: neo4j\n    volumes:\n      - ./conf:/var/lib/neo4j/conf\n      - ./mnt:/var/lib/neo4j/import\n      - ./plugins:/plugins\n      - ./data:/data\n      - ./logs:/var/lib/neo4j/logs\n    restart: always\n    ports:\n      - 7474:7474\n      - 7687:7687\n    environment:\n      - NEO4J_dbms_memory_heap_maxSize=2G\n      - NEO4J_AUTH=neo4j/123456  #修改默认用户密码\n```\n\n\n\n\n\n\n\n---\n\nhttps://blog.csdn.net/Blanchedingding/article/details/89890663","source":"_posts/docker/docker-neo4j.md","raw":"---\ntitle: Install Neo4j on linux by Docker\ncategories:\n- Docker\ntags:\n- linux\n- neo4j\n---\n\n# Java Environment\n\nMake sure the java environment on you server is updated to `java11`, if you are going to install neo4j-4.0 or above.\n\n```\nsudo apt install openjdk-11-jre-headless\n```\n\n\n\n# docker-compose\n\n```\nversion: '3'\nservices:\n\n  neo4j:\n    image: neo4j\n    volumes:\n      - ./conf:/var/lib/neo4j/conf\n      - ./mnt:/var/lib/neo4j/import\n      - ./plugins:/plugins\n      - ./data:/data\n      - ./logs:/var/lib/neo4j/logs\n    restart: always\n    ports:\n      - 7474:7474\n      - 7687:7687\n    environment:\n      - NEO4J_dbms_memory_heap_maxSize=2G\n      - NEO4J_AUTH=neo4j/123456  #修改默认用户密码\n```\n\n\n\n\n\n\n\n---\n\nhttps://blog.csdn.net/Blanchedingding/article/details/89890663","slug":"docker/docker-neo4j","published":1,"date":"2021-08-05T09:41:29.466Z","updated":"2021-08-05T10:27:59.581Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y1001j018ohcc9aw4j","content":"<h1 id=\"Java-Environment\"><a href=\"#Java-Environment\" class=\"headerlink\" title=\"Java Environment\"></a>Java Environment</h1><p>Make sure the java environment on you server is updated to <code>java11</code>, if you are going to install neo4j-4.0 or above.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install openjdk-11-jre-headless</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3&#39;</span><br><span class=\"line\">services:</span><br><span class=\"line\"></span><br><span class=\"line\">  neo4j:</span><br><span class=\"line\">    image: neo4j</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - .&#x2F;conf:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;conf</span><br><span class=\"line\">      - .&#x2F;mnt:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;import</span><br><span class=\"line\">      - .&#x2F;plugins:&#x2F;plugins</span><br><span class=\"line\">      - .&#x2F;data:&#x2F;data</span><br><span class=\"line\">      - .&#x2F;logs:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;logs</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 7474:7474</span><br><span class=\"line\">      - 7687:7687</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - NEO4J_dbms_memory_heap_maxSize&#x3D;2G</span><br><span class=\"line\">      - NEO4J_AUTH&#x3D;neo4j&#x2F;123456  #修改默认用户密码</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JsYW5jaGVkaW5nZGluZy9hcnRpY2xlL2RldGFpbHMvODk4OTA2NjM=\">https://blog.csdn.net/Blanchedingding/article/details/89890663<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Java-Environment\"><a href=\"#Java-Environment\" class=\"headerlink\" title=\"Java Environment\"></a>Java Environment</h1><p>Make sure the java environment on you server is updated to <code>java11</code>, if you are going to install neo4j-4.0 or above.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install openjdk-11-jre-headless</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3&#39;</span><br><span class=\"line\">services:</span><br><span class=\"line\"></span><br><span class=\"line\">  neo4j:</span><br><span class=\"line\">    image: neo4j</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - .&#x2F;conf:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;conf</span><br><span class=\"line\">      - .&#x2F;mnt:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;import</span><br><span class=\"line\">      - .&#x2F;plugins:&#x2F;plugins</span><br><span class=\"line\">      - .&#x2F;data:&#x2F;data</span><br><span class=\"line\">      - .&#x2F;logs:&#x2F;var&#x2F;lib&#x2F;neo4j&#x2F;logs</span><br><span class=\"line\">    restart: always</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - 7474:7474</span><br><span class=\"line\">      - 7687:7687</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      - NEO4J_dbms_memory_heap_maxSize&#x3D;2G</span><br><span class=\"line\">      - NEO4J_AUTH&#x3D;neo4j&#x2F;123456  #修改默认用户密码</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JsYW5jaGVkaW5nZGluZy9hcnRpY2xlL2RldGFpbHMvODk4OTA2NjM=\">https://blog.csdn.net/Blanchedingding/article/details/89890663<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Docker 部署 Lineloss\n\n## 1 拉取redhat镜像\n`docker pull yjjy0921/redhat7.2`\n\n\n\n## 2 进入镜像换yum源\n- rpm安装wget(docker cp host.path cotainer:container.path)\n- wget下载yum相关包\n- rpm安装下载的相关包\n\n**报错：**\npython-urlgrabber >= 3.10-8 is needed by yum-3.4.3-167.el7.centos.noarch  \nrpm >= 0:4.11.3-22 is needed by yum-3.4.3-167.el7.centos.noarch\n\n查询存在的python-urlgrabber包\n`rpm -q python-urlgrabber`~~\n\n删除python-urlgrabber包\n`rpm -e python-urlgrabber`\n\n更新rpm包\n`rpm -Uvh rpm-4.11.3-43.el7.x86_64.rpm --nodeps`\n\n\n\n## 3 创建aliyun.repo\n`cd /etc/yum.repo.d/`\n`vim aliyun.repo`\n\n```\n[base]\nname=CentOS-$releasever - Base\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/os/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n\n#released updates\n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/updates/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n\n[extras]\nname=CentOS-$releasever - Extras\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/extras//$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n[centosplus]\nname=CentOS-$releasever - Plus\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/centosplus//$basearch/\ngpgcheck=1\nenabled=0\n```\n\n清除redhat.repo\n`mv redhat.repo redhat.temp`\n\n检验yum配置成功\n`yum update -y --skip-broken`\n\n\n\n## 4 安装mariadb\n\n安装\n`yum install -y mysql`\n\n**注意**\ndocker无法使用systemctl指令使mysql后台运行\n\n查看容器配置文件\n`docker inspect containerID`\n\n*修改已经运行的容器配置文件*\n`/usr/lib/docker...`\n\n运行镜像时需要\n`docker run --privileged --name=lineloss -d -it edlison/lineloss /usr/sbin/init`\n\n`--privileged`赋予额外权限\n`/usr/sbin/init`将cmd设置为这个 dbus服务就会运行\n\n`systemctl start mariadb` 启动服务\n`systemctl enable mariadb` 设置开机启动\n`systemctl restart mariadb` 重新启动\n`systemctl stop mariadb.service` 停止MariaDB\n\n初始化数据库\n`mysql_secure_installation`\n\n设置密码\n`mysqladmin -u root password 'newpassword'`\n\n导入数据\n`create database lineloss;`\n`use lineloss;`\n`source /home/xs_project/sql/lineloss.sql`\n\n\n\n## 5 Java环境\n\n安装Java\n`yum install java`\n\n\n\n## 6 Python环境\n\n安装python3\n`yum install python3`\n\n安装依赖\n`pip3 install Flask`\n`pip3 install flask_sqlalchemy`\n`pip3 install pymysql`\n`pip3 install numpy`\n`pip3 install sklearn`\n`pip3 install jieba`\n`pip3 install pandas`\n`pip3 install statsmodels`\n\n\n\n## 7 运行测试\n\n运行镜像\n`docker run --privileged --name=lineloss -d -p 18084:18084 -it edlison/lineloss /usr/sbin/init`\n\nJava\n`cd /home/xs_project/java`\n`java -jar RuoYi.jar`\n\nPython\n`cd /home/xs_project/python/LineLoss`\n`python3 service.py`\n\n\n\n## 8 Dockerfile\n\n只是构建镜像？？？不便于执行镜像内程序？？？\n\n\n\n## 9 其他\n## 复制文件\n\n容器内新建文件夹\n`mkdir /home/xs_project/java`\n`mkdir /home/xs_project/python`\n`mkdir /home/xs_project/sql`\n\n将文件复制到容器内\n`cp RuoYi.jar containerID:/home/xs_project/java`\n`cp LineLoss.zip containerID:/home/xs_project/python`\n`cp lineloss.sql containerID:/home/xs_project/sql`\n\n## 容器提交成镜像\n\n`docker commit -a \"userid\" -m \"comment\" containerID imageName:tag`\n\n## 镜像上传仓库\n\n`docker push userName/imageName`\n\n**注意**\n\ntag命令修改为规范的镜像名\n`docker tag lineloss:latest edlison/lineloss`\n\npush到用户仓库\n`docker push edlison/lineloss`\n\n\n## 镜像导出导入\n\n导出镜像\n`docker save -o lineloss.tar edlison/lineloss`或\n`docker save edlison/lineloss>/home/lineloss.tar`\n\n导入镜像\n`docker load<lineloss.tar`\n\n","source":"_posts/docker/docker-lineloss.md","raw":"# Docker 部署 Lineloss\n\n## 1 拉取redhat镜像\n`docker pull yjjy0921/redhat7.2`\n\n\n\n## 2 进入镜像换yum源\n- rpm安装wget(docker cp host.path cotainer:container.path)\n- wget下载yum相关包\n- rpm安装下载的相关包\n\n**报错：**\npython-urlgrabber >= 3.10-8 is needed by yum-3.4.3-167.el7.centos.noarch  \nrpm >= 0:4.11.3-22 is needed by yum-3.4.3-167.el7.centos.noarch\n\n查询存在的python-urlgrabber包\n`rpm -q python-urlgrabber`~~\n\n删除python-urlgrabber包\n`rpm -e python-urlgrabber`\n\n更新rpm包\n`rpm -Uvh rpm-4.11.3-43.el7.x86_64.rpm --nodeps`\n\n\n\n## 3 创建aliyun.repo\n`cd /etc/yum.repo.d/`\n`vim aliyun.repo`\n\n```\n[base]\nname=CentOS-$releasever - Base\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/os/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n\n#released updates\n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/updates/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n\n[extras]\nname=CentOS-$releasever - Extras\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/extras//$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/RPM-GPG-KEY-CentOS-7\n\n[centosplus]\nname=CentOS-$releasever - Plus\nbaseurl=http://mirrors.aliyun.com/centos/7.8.2003/centosplus//$basearch/\ngpgcheck=1\nenabled=0\n```\n\n清除redhat.repo\n`mv redhat.repo redhat.temp`\n\n检验yum配置成功\n`yum update -y --skip-broken`\n\n\n\n## 4 安装mariadb\n\n安装\n`yum install -y mysql`\n\n**注意**\ndocker无法使用systemctl指令使mysql后台运行\n\n查看容器配置文件\n`docker inspect containerID`\n\n*修改已经运行的容器配置文件*\n`/usr/lib/docker...`\n\n运行镜像时需要\n`docker run --privileged --name=lineloss -d -it edlison/lineloss /usr/sbin/init`\n\n`--privileged`赋予额外权限\n`/usr/sbin/init`将cmd设置为这个 dbus服务就会运行\n\n`systemctl start mariadb` 启动服务\n`systemctl enable mariadb` 设置开机启动\n`systemctl restart mariadb` 重新启动\n`systemctl stop mariadb.service` 停止MariaDB\n\n初始化数据库\n`mysql_secure_installation`\n\n设置密码\n`mysqladmin -u root password 'newpassword'`\n\n导入数据\n`create database lineloss;`\n`use lineloss;`\n`source /home/xs_project/sql/lineloss.sql`\n\n\n\n## 5 Java环境\n\n安装Java\n`yum install java`\n\n\n\n## 6 Python环境\n\n安装python3\n`yum install python3`\n\n安装依赖\n`pip3 install Flask`\n`pip3 install flask_sqlalchemy`\n`pip3 install pymysql`\n`pip3 install numpy`\n`pip3 install sklearn`\n`pip3 install jieba`\n`pip3 install pandas`\n`pip3 install statsmodels`\n\n\n\n## 7 运行测试\n\n运行镜像\n`docker run --privileged --name=lineloss -d -p 18084:18084 -it edlison/lineloss /usr/sbin/init`\n\nJava\n`cd /home/xs_project/java`\n`java -jar RuoYi.jar`\n\nPython\n`cd /home/xs_project/python/LineLoss`\n`python3 service.py`\n\n\n\n## 8 Dockerfile\n\n只是构建镜像？？？不便于执行镜像内程序？？？\n\n\n\n## 9 其他\n## 复制文件\n\n容器内新建文件夹\n`mkdir /home/xs_project/java`\n`mkdir /home/xs_project/python`\n`mkdir /home/xs_project/sql`\n\n将文件复制到容器内\n`cp RuoYi.jar containerID:/home/xs_project/java`\n`cp LineLoss.zip containerID:/home/xs_project/python`\n`cp lineloss.sql containerID:/home/xs_project/sql`\n\n## 容器提交成镜像\n\n`docker commit -a \"userid\" -m \"comment\" containerID imageName:tag`\n\n## 镜像上传仓库\n\n`docker push userName/imageName`\n\n**注意**\n\ntag命令修改为规范的镜像名\n`docker tag lineloss:latest edlison/lineloss`\n\npush到用户仓库\n`docker push edlison/lineloss`\n\n\n## 镜像导出导入\n\n导出镜像\n`docker save -o lineloss.tar edlison/lineloss`或\n`docker save edlison/lineloss>/home/lineloss.tar`\n\n导入镜像\n`docker load<lineloss.tar`\n\n","slug":"docker/docker-lineloss","published":1,"date":"2020-09-15T04:11:47.114Z","updated":"2020-09-16T12:52:06.402Z","title":"docker/docker-lineloss","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y1001l018ofdkuhj0b","content":"<h1 id=\"Docker-部署-Lineloss\"><a href=\"#Docker-部署-Lineloss\" class=\"headerlink\" title=\"Docker 部署 Lineloss\"></a>Docker 部署 Lineloss</h1><h2 id=\"1-拉取redhat镜像\"><a href=\"#1-拉取redhat镜像\" class=\"headerlink\" title=\"1 拉取redhat镜像\"></a>1 拉取redhat镜像</h2><p><code>docker pull yjjy0921/redhat7.2</code></p>\n<h2 id=\"2-进入镜像换yum源\"><a href=\"#2-进入镜像换yum源\" class=\"headerlink\" title=\"2 进入镜像换yum源\"></a>2 进入镜像换yum源</h2><ul>\n<li>rpm安装wget(docker cp host.path cotainer:container.path)</li>\n<li>wget下载yum相关包</li>\n<li>rpm安装下载的相关包</li>\n</ul>\n<p><strong>报错：</strong><br>python-urlgrabber &gt;= 3.10-8 is needed by yum-3.4.3-167.el7.centos.noarch<br>rpm &gt;= 0:4.11.3-22 is needed by yum-3.4.3-167.el7.centos.noarch</p>\n<p>查询存在的python-urlgrabber包<br><code>rpm -q python-urlgrabber</code>~~</p>\n<p>删除python-urlgrabber包<br><code>rpm -e python-urlgrabber</code></p>\n<p>更新rpm包<br><code>rpm -Uvh rpm-4.11.3-43.el7.x86_64.rpm --nodeps</code></p>\n<h2 id=\"3-创建aliyun-repo\"><a href=\"#3-创建aliyun-repo\" class=\"headerlink\" title=\"3 创建aliyun.repo\"></a>3 创建aliyun.repo</h2><p><code>cd /etc/yum.repo.d/</code><br><code>vim aliyun.repo</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[base]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Base</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#released updates</span><br><span class=\"line\">[updates]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Updates</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;updates&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[extras]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Extras</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;extras&#x2F;&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\">[centosplus]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Plus</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;centosplus&#x2F;&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">enabled&#x3D;0</span><br></pre></td></tr></table></figure>\n\n<p>清除redhat.repo<br><code>mv redhat.repo redhat.temp</code></p>\n<p>检验yum配置成功<br><code>yum update -y --skip-broken</code></p>\n<h2 id=\"4-安装mariadb\"><a href=\"#4-安装mariadb\" class=\"headerlink\" title=\"4 安装mariadb\"></a>4 安装mariadb</h2><p>安装<br><code>yum install -y mysql</code></p>\n<p><strong>注意</strong><br>docker无法使用systemctl指令使mysql后台运行</p>\n<p>查看容器配置文件<br><code>docker inspect containerID</code></p>\n<p><em>修改已经运行的容器配置文件</em><br><code>/usr/lib/docker...</code></p>\n<p>运行镜像时需要<br><code>docker run --privileged --name=lineloss -d -it edlison/lineloss /usr/sbin/init</code></p>\n<p><code>--privileged</code>赋予额外权限<br><code>/usr/sbin/init</code>将cmd设置为这个 dbus服务就会运行</p>\n<p><code>systemctl start mariadb</code> 启动服务<br><code>systemctl enable mariadb</code> 设置开机启动<br><code>systemctl restart mariadb</code> 重新启动<br><code>systemctl stop mariadb.service</code> 停止MariaDB</p>\n<p>初始化数据库<br><code>mysql_secure_installation</code></p>\n<p>设置密码<br><code>mysqladmin -u root password &#39;newpassword&#39;</code></p>\n<p>导入数据<br><code>create database lineloss;</code><br><code>use lineloss;</code><br><code>source /home/xs_project/sql/lineloss.sql</code></p>\n<h2 id=\"5-Java环境\"><a href=\"#5-Java环境\" class=\"headerlink\" title=\"5 Java环境\"></a>5 Java环境</h2><p>安装Java<br><code>yum install java</code></p>\n<h2 id=\"6-Python环境\"><a href=\"#6-Python环境\" class=\"headerlink\" title=\"6 Python环境\"></a>6 Python环境</h2><p>安装python3<br><code>yum install python3</code></p>\n<p>安装依赖<br><code>pip3 install Flask</code><br><code>pip3 install flask_sqlalchemy</code><br><code>pip3 install pymysql</code><br><code>pip3 install numpy</code><br><code>pip3 install sklearn</code><br><code>pip3 install jieba</code><br><code>pip3 install pandas</code><br><code>pip3 install statsmodels</code></p>\n<h2 id=\"7-运行测试\"><a href=\"#7-运行测试\" class=\"headerlink\" title=\"7 运行测试\"></a>7 运行测试</h2><p>运行镜像<br><code>docker run --privileged --name=lineloss -d -p 18084:18084 -it edlison/lineloss /usr/sbin/init</code></p>\n<p>Java<br><code>cd /home/xs_project/java</code><br><code>java -jar RuoYi.jar</code></p>\n<p>Python<br><code>cd /home/xs_project/python/LineLoss</code><br><code>python3 service.py</code></p>\n<h2 id=\"8-Dockerfile\"><a href=\"#8-Dockerfile\" class=\"headerlink\" title=\"8 Dockerfile\"></a>8 Dockerfile</h2><p>只是构建镜像？？？不便于执行镜像内程序？？？</p>\n<h2 id=\"9-其他\"><a href=\"#9-其他\" class=\"headerlink\" title=\"9 其他\"></a>9 其他</h2><h2 id=\"复制文件\"><a href=\"#复制文件\" class=\"headerlink\" title=\"复制文件\"></a>复制文件</h2><p>容器内新建文件夹<br><code>mkdir /home/xs_project/java</code><br><code>mkdir /home/xs_project/python</code><br><code>mkdir /home/xs_project/sql</code></p>\n<p>将文件复制到容器内<br><code>cp RuoYi.jar containerID:/home/xs_project/java</code><br><code>cp LineLoss.zip containerID:/home/xs_project/python</code><br><code>cp lineloss.sql containerID:/home/xs_project/sql</code></p>\n<h2 id=\"容器提交成镜像\"><a href=\"#容器提交成镜像\" class=\"headerlink\" title=\"容器提交成镜像\"></a>容器提交成镜像</h2><p><code>docker commit -a &quot;userid&quot; -m &quot;comment&quot; containerID imageName:tag</code></p>\n<h2 id=\"镜像上传仓库\"><a href=\"#镜像上传仓库\" class=\"headerlink\" title=\"镜像上传仓库\"></a>镜像上传仓库</h2><p><code>docker push userName/imageName</code></p>\n<p><strong>注意</strong></p>\n<p>tag命令修改为规范的镜像名<br><code>docker tag lineloss:latest edlison/lineloss</code></p>\n<p>push到用户仓库<br><code>docker push edlison/lineloss</code></p>\n<h2 id=\"镜像导出导入\"><a href=\"#镜像导出导入\" class=\"headerlink\" title=\"镜像导出导入\"></a>镜像导出导入</h2><p>导出镜像<br><code>docker save -o lineloss.tar edlison/lineloss</code>或<br><code>docker save edlison/lineloss&gt;/home/lineloss.tar</code></p>\n<p>导入镜像<br><code>docker load&lt;lineloss.tar</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-部署-Lineloss\"><a href=\"#Docker-部署-Lineloss\" class=\"headerlink\" title=\"Docker 部署 Lineloss\"></a>Docker 部署 Lineloss</h1><h2 id=\"1-拉取redhat镜像\"><a href=\"#1-拉取redhat镜像\" class=\"headerlink\" title=\"1 拉取redhat镜像\"></a>1 拉取redhat镜像</h2><p><code>docker pull yjjy0921/redhat7.2</code></p>\n<h2 id=\"2-进入镜像换yum源\"><a href=\"#2-进入镜像换yum源\" class=\"headerlink\" title=\"2 进入镜像换yum源\"></a>2 进入镜像换yum源</h2><ul>\n<li>rpm安装wget(docker cp host.path cotainer:container.path)</li>\n<li>wget下载yum相关包</li>\n<li>rpm安装下载的相关包</li>\n</ul>\n<p><strong>报错：</strong><br>python-urlgrabber &gt;= 3.10-8 is needed by yum-3.4.3-167.el7.centos.noarch<br>rpm &gt;= 0:4.11.3-22 is needed by yum-3.4.3-167.el7.centos.noarch</p>\n<p>查询存在的python-urlgrabber包<br><code>rpm -q python-urlgrabber</code>~~</p>\n<p>删除python-urlgrabber包<br><code>rpm -e python-urlgrabber</code></p>\n<p>更新rpm包<br><code>rpm -Uvh rpm-4.11.3-43.el7.x86_64.rpm --nodeps</code></p>\n<h2 id=\"3-创建aliyun-repo\"><a href=\"#3-创建aliyun-repo\" class=\"headerlink\" title=\"3 创建aliyun.repo\"></a>3 创建aliyun.repo</h2><p><code>cd /etc/yum.repo.d/</code><br><code>vim aliyun.repo</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[base]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Base</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#released updates</span><br><span class=\"line\">[updates]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Updates</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;updates&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[extras]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Extras</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;extras&#x2F;&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">gpgkey&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;os&#x2F;x86_64&#x2F;RPM-GPG-KEY-CentOS-7</span><br><span class=\"line\"></span><br><span class=\"line\">[centosplus]</span><br><span class=\"line\">name&#x3D;CentOS-$releasever - Plus</span><br><span class=\"line\">baseurl&#x3D;http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.8.2003&#x2F;centosplus&#x2F;&#x2F;$basearch&#x2F;</span><br><span class=\"line\">gpgcheck&#x3D;1</span><br><span class=\"line\">enabled&#x3D;0</span><br></pre></td></tr></table></figure>\n\n<p>清除redhat.repo<br><code>mv redhat.repo redhat.temp</code></p>\n<p>检验yum配置成功<br><code>yum update -y --skip-broken</code></p>\n<h2 id=\"4-安装mariadb\"><a href=\"#4-安装mariadb\" class=\"headerlink\" title=\"4 安装mariadb\"></a>4 安装mariadb</h2><p>安装<br><code>yum install -y mysql</code></p>\n<p><strong>注意</strong><br>docker无法使用systemctl指令使mysql后台运行</p>\n<p>查看容器配置文件<br><code>docker inspect containerID</code></p>\n<p><em>修改已经运行的容器配置文件</em><br><code>/usr/lib/docker...</code></p>\n<p>运行镜像时需要<br><code>docker run --privileged --name=lineloss -d -it edlison/lineloss /usr/sbin/init</code></p>\n<p><code>--privileged</code>赋予额外权限<br><code>/usr/sbin/init</code>将cmd设置为这个 dbus服务就会运行</p>\n<p><code>systemctl start mariadb</code> 启动服务<br><code>systemctl enable mariadb</code> 设置开机启动<br><code>systemctl restart mariadb</code> 重新启动<br><code>systemctl stop mariadb.service</code> 停止MariaDB</p>\n<p>初始化数据库<br><code>mysql_secure_installation</code></p>\n<p>设置密码<br><code>mysqladmin -u root password &#39;newpassword&#39;</code></p>\n<p>导入数据<br><code>create database lineloss;</code><br><code>use lineloss;</code><br><code>source /home/xs_project/sql/lineloss.sql</code></p>\n<h2 id=\"5-Java环境\"><a href=\"#5-Java环境\" class=\"headerlink\" title=\"5 Java环境\"></a>5 Java环境</h2><p>安装Java<br><code>yum install java</code></p>\n<h2 id=\"6-Python环境\"><a href=\"#6-Python环境\" class=\"headerlink\" title=\"6 Python环境\"></a>6 Python环境</h2><p>安装python3<br><code>yum install python3</code></p>\n<p>安装依赖<br><code>pip3 install Flask</code><br><code>pip3 install flask_sqlalchemy</code><br><code>pip3 install pymysql</code><br><code>pip3 install numpy</code><br><code>pip3 install sklearn</code><br><code>pip3 install jieba</code><br><code>pip3 install pandas</code><br><code>pip3 install statsmodels</code></p>\n<h2 id=\"7-运行测试\"><a href=\"#7-运行测试\" class=\"headerlink\" title=\"7 运行测试\"></a>7 运行测试</h2><p>运行镜像<br><code>docker run --privileged --name=lineloss -d -p 18084:18084 -it edlison/lineloss /usr/sbin/init</code></p>\n<p>Java<br><code>cd /home/xs_project/java</code><br><code>java -jar RuoYi.jar</code></p>\n<p>Python<br><code>cd /home/xs_project/python/LineLoss</code><br><code>python3 service.py</code></p>\n<h2 id=\"8-Dockerfile\"><a href=\"#8-Dockerfile\" class=\"headerlink\" title=\"8 Dockerfile\"></a>8 Dockerfile</h2><p>只是构建镜像？？？不便于执行镜像内程序？？？</p>\n<h2 id=\"9-其他\"><a href=\"#9-其他\" class=\"headerlink\" title=\"9 其他\"></a>9 其他</h2><h2 id=\"复制文件\"><a href=\"#复制文件\" class=\"headerlink\" title=\"复制文件\"></a>复制文件</h2><p>容器内新建文件夹<br><code>mkdir /home/xs_project/java</code><br><code>mkdir /home/xs_project/python</code><br><code>mkdir /home/xs_project/sql</code></p>\n<p>将文件复制到容器内<br><code>cp RuoYi.jar containerID:/home/xs_project/java</code><br><code>cp LineLoss.zip containerID:/home/xs_project/python</code><br><code>cp lineloss.sql containerID:/home/xs_project/sql</code></p>\n<h2 id=\"容器提交成镜像\"><a href=\"#容器提交成镜像\" class=\"headerlink\" title=\"容器提交成镜像\"></a>容器提交成镜像</h2><p><code>docker commit -a &quot;userid&quot; -m &quot;comment&quot; containerID imageName:tag</code></p>\n<h2 id=\"镜像上传仓库\"><a href=\"#镜像上传仓库\" class=\"headerlink\" title=\"镜像上传仓库\"></a>镜像上传仓库</h2><p><code>docker push userName/imageName</code></p>\n<p><strong>注意</strong></p>\n<p>tag命令修改为规范的镜像名<br><code>docker tag lineloss:latest edlison/lineloss</code></p>\n<p>push到用户仓库<br><code>docker push edlison/lineloss</code></p>\n<h2 id=\"镜像导出导入\"><a href=\"#镜像导出导入\" class=\"headerlink\" title=\"镜像导出导入\"></a>镜像导出导入</h2><p>导出镜像<br><code>docker save -o lineloss.tar edlison/lineloss</code>或<br><code>docker save edlison/lineloss&gt;/home/lineloss.tar</code></p>\n<p>导入镜像<br><code>docker load&lt;lineloss.tar</code></p>\n"},{"title":"制作V2ray的Dockerfile","_content":"\n# Dockerfile\n\n```dockerfile\nFROM ubuntu:latest\n\nWORKDIR /root\nCOPY v2ray.sh /root\n\nRUN mkdir -p /etc/v2ray /usr/local/share/v2ray /var/log/v2ray \\\n\t\t\t\t\t&& chmod +x /root/v2ray.sh \\\n\t\t\t\t\t&& /root/v2ray.sh\n\nVOLUME /etc/v2ray\nCMD [ \"v2ray\", \"-config\", \"/etc/v2ray/config.json\" ]\n```\n\n# sh\n\n```sh\napt update \\\n&& apt install wget zip \\\n&& wget https://github.com/v2fly/v2ray-core/releases/download/${TAG}/${V2RAY_FILE} \\\n&& unzip v2ray.zip \\\n&& chmod +x v2ray v2ctl \\\n&& mv v2ray v2ctl /usr/bin \\\n&& mv geosite.dat geoip.dat /usr/local/share/v2ray \\\n&& mv config.json /etc/v2ray/config.json\n\necho 'Done'\n```\n\n","source":"_posts/docker/docker-v2ray.md","raw":"---\ntitle: 制作V2ray的Dockerfile\ncategories:\n- Notebook\ntags:\n- docker\n- v2ray\n---\n\n# Dockerfile\n\n```dockerfile\nFROM ubuntu:latest\n\nWORKDIR /root\nCOPY v2ray.sh /root\n\nRUN mkdir -p /etc/v2ray /usr/local/share/v2ray /var/log/v2ray \\\n\t\t\t\t\t&& chmod +x /root/v2ray.sh \\\n\t\t\t\t\t&& /root/v2ray.sh\n\nVOLUME /etc/v2ray\nCMD [ \"v2ray\", \"-config\", \"/etc/v2ray/config.json\" ]\n```\n\n# sh\n\n```sh\napt update \\\n&& apt install wget zip \\\n&& wget https://github.com/v2fly/v2ray-core/releases/download/${TAG}/${V2RAY_FILE} \\\n&& unzip v2ray.zip \\\n&& chmod +x v2ray v2ctl \\\n&& mv v2ray v2ctl /usr/bin \\\n&& mv geosite.dat geoip.dat /usr/local/share/v2ray \\\n&& mv config.json /etc/v2ray/config.json\n\necho 'Done'\n```\n\n","slug":"docker/docker-v2ray","published":1,"date":"2021-02-12T18:42:39.512Z","updated":"2021-02-12T18:51:49.134Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y2001n018oc0lmgliy","content":"<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> ubuntu:latest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /root</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> v2ray.sh /root</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir -p /etc/v2ray /usr/<span class=\"built_in\">local</span>/share/v2ray /var/<span class=\"built_in\">log</span>/v2ray \\</span></span><br><span class=\"line\"><span class=\"bash\">\t\t\t\t\t&amp;&amp; chmod +x /root/v2ray.sh \\</span></span><br><span class=\"line\"><span class=\"bash\">\t\t\t\t\t&amp;&amp; /root/v2ray.sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> /etc/v2ray</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [ <span class=\"string\">\"v2ray\"</span>, <span class=\"string\">\"-config\"</span>, <span class=\"string\">\"/etc/v2ray/config.json\"</span> ]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"sh\"><a href=\"#sh\" class=\"headerlink\" title=\"sh\"></a>sh</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt update \\</span><br><span class=\"line\">&amp;&amp; apt install wget zip \\</span><br><span class=\"line\">&amp;&amp; wget https://github.com/v2fly/v2ray-core/releases/download/<span class=\"variable\">$&#123;TAG&#125;</span>/<span class=\"variable\">$&#123;V2RAY_FILE&#125;</span> \\</span><br><span class=\"line\">&amp;&amp; unzip v2ray.zip \\</span><br><span class=\"line\">&amp;&amp; chmod +x v2ray v2ctl \\</span><br><span class=\"line\">&amp;&amp; mv v2ray v2ctl /usr/bin \\</span><br><span class=\"line\">&amp;&amp; mv geosite.dat geoip.dat /usr/<span class=\"built_in\">local</span>/share/v2ray \\</span><br><span class=\"line\">&amp;&amp; mv config.json /etc/v2ray/config.json</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'Done'</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> ubuntu:latest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /root</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> v2ray.sh /root</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir -p /etc/v2ray /usr/<span class=\"built_in\">local</span>/share/v2ray /var/<span class=\"built_in\">log</span>/v2ray \\</span></span><br><span class=\"line\"><span class=\"bash\">\t\t\t\t\t&amp;&amp; chmod +x /root/v2ray.sh \\</span></span><br><span class=\"line\"><span class=\"bash\">\t\t\t\t\t&amp;&amp; /root/v2ray.sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"bash\"> /etc/v2ray</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [ <span class=\"string\">\"v2ray\"</span>, <span class=\"string\">\"-config\"</span>, <span class=\"string\">\"/etc/v2ray/config.json\"</span> ]</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"sh\"><a href=\"#sh\" class=\"headerlink\" title=\"sh\"></a>sh</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt update \\</span><br><span class=\"line\">&amp;&amp; apt install wget zip \\</span><br><span class=\"line\">&amp;&amp; wget https://github.com/v2fly/v2ray-core/releases/download/<span class=\"variable\">$&#123;TAG&#125;</span>/<span class=\"variable\">$&#123;V2RAY_FILE&#125;</span> \\</span><br><span class=\"line\">&amp;&amp; unzip v2ray.zip \\</span><br><span class=\"line\">&amp;&amp; chmod +x v2ray v2ctl \\</span><br><span class=\"line\">&amp;&amp; mv v2ray v2ctl /usr/bin \\</span><br><span class=\"line\">&amp;&amp; mv geosite.dat geoip.dat /usr/<span class=\"built_in\">local</span>/share/v2ray \\</span><br><span class=\"line\">&amp;&amp; mv config.json /etc/v2ray/config.json</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'Done'</span></span><br></pre></td></tr></table></figure>\n\n"},{"_content":"# Docker-NextCloud\n\n\n## docker-compose.yml\n```\nversion: '3'\n\nservices:\n  nextcloud:\n    image: nextcloud\n    restart: \"no\"\n    volumes:\n      - ~/docker_nextcloud/data/:/var/www/html\n    ports:\n      - \"25000:80\"\n```","source":"_posts/docker/docker-nextcloud.md","raw":"# Docker-NextCloud\n\n\n## docker-compose.yml\n```\nversion: '3'\n\nservices:\n  nextcloud:\n    image: nextcloud\n    restart: \"no\"\n    volumes:\n      - ~/docker_nextcloud/data/:/var/www/html\n    ports:\n      - \"25000:80\"\n```","slug":"docker/docker-nextcloud","published":1,"date":"2020-07-25T17:48:17.756Z","updated":"2020-07-25T17:48:50.486Z","title":"docker/docker-nextcloud","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y3001q018o5l5j7utg","content":"<h1 id=\"Docker-NextCloud\"><a href=\"#Docker-NextCloud\" class=\"headerlink\" title=\"Docker-NextCloud\"></a>Docker-NextCloud</h1><h2 id=\"docker-compose-yml\"><a href=\"#docker-compose-yml\" class=\"headerlink\" title=\"docker-compose.yml\"></a>docker-compose.yml</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nextcloud:</span><br><span class=\"line\">    image: nextcloud</span><br><span class=\"line\">    restart: &quot;no&quot;</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ~&#x2F;docker_nextcloud&#x2F;data&#x2F;:&#x2F;var&#x2F;www&#x2F;html</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;25000:80&quot;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-NextCloud\"><a href=\"#Docker-NextCloud\" class=\"headerlink\" title=\"Docker-NextCloud\"></a>Docker-NextCloud</h1><h2 id=\"docker-compose-yml\"><a href=\"#docker-compose-yml\" class=\"headerlink\" title=\"docker-compose.yml\"></a>docker-compose.yml</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nextcloud:</span><br><span class=\"line\">    image: nextcloud</span><br><span class=\"line\">    restart: &quot;no&quot;</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ~&#x2F;docker_nextcloud&#x2F;data&#x2F;:&#x2F;var&#x2F;www&#x2F;html</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;25000:80&quot;</span><br></pre></td></tr></table></figure>"},{"catitle":"DockerApp - mariadb","_content":"\n# Docker-compose\n\n```yaml\nversion: '3.1'\n\nservices:\n  db:\n    image: mariadb\n    restart: always\n    ports:\n      - 3306:3306\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n    volumes:\n      - db:/var/lib/mysql\n    \n  adminer:\n    image: adminer\n    restart: always\n    depends_on:\n      - db\n    ports:\n      - 8080:8080\nvolumes:\n  db:\n```\n\n# 配置\n\n`MYSQL_ROOT_PASSWORD`: 这个密码将被设置给root用户\n\n`MYSQL_DATABASE(optional)`: 指定一个数据库在镜像创建之初建立（如果后面指定了用户，则授予这个数据库的权限）\n\n`MYSQL_USER`, `MYSQL_PASSWORD`(optional): 如果需要创建用户，这两个变量都需要\n\n`MYSQL_ALLOW_EMPTY_PASSWORD(optional)`: 允许root用户使用空密码\n\n`MYSQL_RANDOM_ROOT_PASSWORD(optional)`: 给root用户随机生成一个密码\n\n`MYSQL_INITDB_SKIP_TZINFO(optional)`: 时区设置\n\n\n\n\n\n\n\n\n\n","source":"_posts/docker/docker-mariadb.md","raw":"---\ncatitle: DockerApp - mariadb\ncategories:\n- Docker\ntags:\n- mariadb\n---\n\n# Docker-compose\n\n```yaml\nversion: '3.1'\n\nservices:\n  db:\n    image: mariadb\n    restart: always\n    ports:\n      - 3306:3306\n    environment:\n      MYSQL_ROOT_PASSWORD: example\n    volumes:\n      - db:/var/lib/mysql\n    \n  adminer:\n    image: adminer\n    restart: always\n    depends_on:\n      - db\n    ports:\n      - 8080:8080\nvolumes:\n  db:\n```\n\n# 配置\n\n`MYSQL_ROOT_PASSWORD`: 这个密码将被设置给root用户\n\n`MYSQL_DATABASE(optional)`: 指定一个数据库在镜像创建之初建立（如果后面指定了用户，则授予这个数据库的权限）\n\n`MYSQL_USER`, `MYSQL_PASSWORD`(optional): 如果需要创建用户，这两个变量都需要\n\n`MYSQL_ALLOW_EMPTY_PASSWORD(optional)`: 允许root用户使用空密码\n\n`MYSQL_RANDOM_ROOT_PASSWORD(optional)`: 给root用户随机生成一个密码\n\n`MYSQL_INITDB_SKIP_TZINFO(optional)`: 时区设置\n\n\n\n\n\n\n\n\n\n","slug":"docker/docker-mariadb","published":1,"date":"2021-02-26T06:16:27.242Z","updated":"2021-07-24T09:02:16.208Z","title":"docker/docker-mariadb","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y4001r018od8at9e5d","content":"<h1 id=\"Docker-compose\"><a href=\"#Docker-compose\" class=\"headerlink\" title=\"Docker-compose\"></a>Docker-compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.1'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mariadb</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">3306</span><span class=\"string\">:3306</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD:</span> <span class=\"string\">example</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db:/var/lib/mysql</span></span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"attr\">adminer:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">adminer</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">8080</span><span class=\"string\">:8080</span></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><p><code>MYSQL_ROOT_PASSWORD</code>: 这个密码将被设置给root用户</p>\n<p><code>MYSQL_DATABASE(optional)</code>: 指定一个数据库在镜像创建之初建立（如果后面指定了用户，则授予这个数据库的权限）</p>\n<p><code>MYSQL_USER</code>, <code>MYSQL_PASSWORD</code>(optional): 如果需要创建用户，这两个变量都需要</p>\n<p><code>MYSQL_ALLOW_EMPTY_PASSWORD(optional)</code>: 允许root用户使用空密码</p>\n<p><code>MYSQL_RANDOM_ROOT_PASSWORD(optional)</code>: 给root用户随机生成一个密码</p>\n<p><code>MYSQL_INITDB_SKIP_TZINFO(optional)</code>: 时区设置</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-compose\"><a href=\"#Docker-compose\" class=\"headerlink\" title=\"Docker-compose\"></a>Docker-compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.1'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mariadb</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">3306</span><span class=\"string\">:3306</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD:</span> <span class=\"string\">example</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db:/var/lib/mysql</span></span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"attr\">adminer:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">adminer</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">8080</span><span class=\"string\">:8080</span></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><p><code>MYSQL_ROOT_PASSWORD</code>: 这个密码将被设置给root用户</p>\n<p><code>MYSQL_DATABASE(optional)</code>: 指定一个数据库在镜像创建之初建立（如果后面指定了用户，则授予这个数据库的权限）</p>\n<p><code>MYSQL_USER</code>, <code>MYSQL_PASSWORD</code>(optional): 如果需要创建用户，这两个变量都需要</p>\n<p><code>MYSQL_ALLOW_EMPTY_PASSWORD(optional)</code>: 允许root用户使用空密码</p>\n<p><code>MYSQL_RANDOM_ROOT_PASSWORD(optional)</code>: 给root用户随机生成一个密码</p>\n<p><code>MYSQL_INITDB_SKIP_TZINFO(optional)</code>: 时区设置</p>\n"},{"title":"Docker Nginx","_content":"\n# docker-compose\n\n```\nversion: '3.1'\n\nservices:\n  nginx:\n    image: nginx\n    volumes:\n     - ./html:/usr/share/nginx/html\n     - ./conf:/etc/nginx\n     - ./logs:/var/log/nginx\n    ports:\n     - 80:80\n    environment:\n     - NGINX_HOST=edlison.cc\n     - NGINX_PORT=80\n```\n\nnginx默认的html文件夹在`/usr/share/nginx/html`\n\n不过可以通过指定conf中的root来将根目录换到`/etc/www/html`下\n\n# nginx.conf\n\n```\nworker_processes  1;\n\nevents {\n   accept_mutex on;\n   multi_accept on;\n   worker_connections 1024;\n}\n\nhttp {\n\nserver{\n  listen 80;\n  server_name  edlison.tk;\n\n  location / {\n\troot\t/usr/share/nginx/html;\n\tindex\tindex.html\n    proxy_pass  http://127.0.0.1:80; # 转发规则\n    proxy_set_header Host $proxy_host; # 修改转发请求头，让8080端口的应用可以受到真实的请求\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n}\n\n}\n```\n\n\n\n# 问题\n\n由于在域名提供商指定的域名是到IP的80端口\n\n容器需要映射到宿主机的80端口，否则需要在网址后面加`:8080`\n\n**域名提供商**或**服务器商**如果在国内的话，需要网站备案！\n\n","source":"_posts/docker/docker-nginx.md","raw":"---\ntitle: Docker Nginx\ncategories:\n- Docker\ntags:\n- linux\n- nginx\n---\n\n# docker-compose\n\n```\nversion: '3.1'\n\nservices:\n  nginx:\n    image: nginx\n    volumes:\n     - ./html:/usr/share/nginx/html\n     - ./conf:/etc/nginx\n     - ./logs:/var/log/nginx\n    ports:\n     - 80:80\n    environment:\n     - NGINX_HOST=edlison.cc\n     - NGINX_PORT=80\n```\n\nnginx默认的html文件夹在`/usr/share/nginx/html`\n\n不过可以通过指定conf中的root来将根目录换到`/etc/www/html`下\n\n# nginx.conf\n\n```\nworker_processes  1;\n\nevents {\n   accept_mutex on;\n   multi_accept on;\n   worker_connections 1024;\n}\n\nhttp {\n\nserver{\n  listen 80;\n  server_name  edlison.tk;\n\n  location / {\n\troot\t/usr/share/nginx/html;\n\tindex\tindex.html\n    proxy_pass  http://127.0.0.1:80; # 转发规则\n    proxy_set_header Host $proxy_host; # 修改转发请求头，让8080端口的应用可以受到真实的请求\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n}\n\n}\n```\n\n\n\n# 问题\n\n由于在域名提供商指定的域名是到IP的80端口\n\n容器需要映射到宿主机的80端口，否则需要在网址后面加`:8080`\n\n**域名提供商**或**服务器商**如果在国内的话，需要网站备案！\n\n","slug":"docker/docker-nginx","published":1,"date":"2021-07-24T09:00:20.245Z","updated":"2021-10-09T16:15:15.154Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y5001u018o11z81erg","content":"<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3.1&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">     - .&#x2F;html:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</span><br><span class=\"line\">     - .&#x2F;conf:&#x2F;etc&#x2F;nginx</span><br><span class=\"line\">     - .&#x2F;logs:&#x2F;var&#x2F;log&#x2F;nginx</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">     - 80:80</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">     - NGINX_HOST&#x3D;edlison.cc</span><br><span class=\"line\">     - NGINX_PORT&#x3D;80</span><br></pre></td></tr></table></figure>\n\n<p>nginx默认的html文件夹在<code>/usr/share/nginx/html</code></p>\n<p>不过可以通过指定conf中的root来将根目录换到<code>/etc/www/html</code>下</p>\n<h1 id=\"nginx-conf\"><a href=\"#nginx-conf\" class=\"headerlink\" title=\"nginx.conf\"></a>nginx.conf</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">   accept_mutex on;</span><br><span class=\"line\">   multi_accept on;</span><br><span class=\"line\">   worker_connections 1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  listen 80;</span><br><span class=\"line\">  server_name  edlison.tk;</span><br><span class=\"line\"></span><br><span class=\"line\">  location &#x2F; &#123;</span><br><span class=\"line\">\troot\t&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\">\tindex\tindex.html</span><br><span class=\"line\">    proxy_pass  http:&#x2F;&#x2F;127.0.0.1:80; # 转发规则</span><br><span class=\"line\">    proxy_set_header Host $proxy_host; # 修改转发请求头，让8080端口的应用可以受到真实的请求</span><br><span class=\"line\">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>由于在域名提供商指定的域名是到IP的80端口</p>\n<p>容器需要映射到宿主机的80端口，否则需要在网址后面加<code>:8080</code></p>\n<p><strong>域名提供商</strong>或<strong>服务器商</strong>如果在国内的话，需要网站备案！</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#39;3.1&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  nginx:</span><br><span class=\"line\">    image: nginx</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">     - .&#x2F;html:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</span><br><span class=\"line\">     - .&#x2F;conf:&#x2F;etc&#x2F;nginx</span><br><span class=\"line\">     - .&#x2F;logs:&#x2F;var&#x2F;log&#x2F;nginx</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">     - 80:80</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">     - NGINX_HOST&#x3D;edlison.cc</span><br><span class=\"line\">     - NGINX_PORT&#x3D;80</span><br></pre></td></tr></table></figure>\n\n<p>nginx默认的html文件夹在<code>/usr/share/nginx/html</code></p>\n<p>不过可以通过指定conf中的root来将根目录换到<code>/etc/www/html</code>下</p>\n<h1 id=\"nginx-conf\"><a href=\"#nginx-conf\" class=\"headerlink\" title=\"nginx.conf\"></a>nginx.conf</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">   accept_mutex on;</span><br><span class=\"line\">   multi_accept on;</span><br><span class=\"line\">   worker_connections 1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  listen 80;</span><br><span class=\"line\">  server_name  edlison.tk;</span><br><span class=\"line\"></span><br><span class=\"line\">  location &#x2F; &#123;</span><br><span class=\"line\">\troot\t&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\">\tindex\tindex.html</span><br><span class=\"line\">    proxy_pass  http:&#x2F;&#x2F;127.0.0.1:80; # 转发规则</span><br><span class=\"line\">    proxy_set_header Host $proxy_host; # 修改转发请求头，让8080端口的应用可以受到真实的请求</span><br><span class=\"line\">    proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>由于在域名提供商指定的域名是到IP的80端口</p>\n<p>容器需要映射到宿主机的80端口，否则需要在网址后面加<code>:8080</code></p>\n<p><strong>域名提供商</strong>或<strong>服务器商</strong>如果在国内的话，需要网站备案！</p>\n"},{"title":"Batch Normalization","_content":"\n# Batch Normalization Layer\n\nIt is usually used before the activation node. The most important improvement is that the speed of convergence is faster, and the model is more stable, avoiding the exploading and vanishing of grad.\n\nAlgorithmn of BN is calculating the mean and variance of each batch and transfering the value of all batch to mean 0, variance 1.\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?q=batch%20normalization&utm_content=search_suggestion&type=content","source":"_posts/deep_learning/BatchNorm.md","raw":"---\ntitle: Batch Normalization\ncategories:\n- Deep Learning\n---\n\n# Batch Normalization Layer\n\nIt is usually used before the activation node. The most important improvement is that the speed of convergence is faster, and the model is more stable, avoiding the exploading and vanishing of grad.\n\nAlgorithmn of BN is calculating the mean and variance of each batch and transfering the value of all batch to mean 0, variance 1.\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?q=batch%20normalization&utm_content=search_suggestion&type=content","slug":"deep_learning/BatchNorm","published":1,"date":"2021-07-07T12:49:26.374Z","updated":"2021-10-15T19:38:39.034Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y5001w018ohlg3bj25","content":"<h1 id=\"Batch-Normalization-Layer\"><a href=\"#Batch-Normalization-Layer\" class=\"headerlink\" title=\"Batch Normalization Layer\"></a>Batch Normalization Layer</h1><p>It is usually used before the activation node. The most important improvement is that the speed of convergence is faster, and the model is more stable, avoiding the exploading and vanishing of grad.</p>\n<p>Algorithmn of BN is calculating the mean and variance of each batch and transfering the value of all batch to mean 0, variance 1.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPWJhdGNoJTIwbm9ybWFsaXphdGlvbiZhbXA7dXRtX2NvbnRlbnQ9c2VhcmNoX3N1Z2dlc3Rpb24mYW1wO3R5cGU9Y29udGVudA==\">https://www.zhihu.com/search?q=batch%20normalization&amp;utm_content=search_suggestion&amp;type=content<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Batch-Normalization-Layer\"><a href=\"#Batch-Normalization-Layer\" class=\"headerlink\" title=\"Batch Normalization Layer\"></a>Batch Normalization Layer</h1><p>It is usually used before the activation node. The most important improvement is that the speed of convergence is faster, and the model is more stable, avoiding the exploading and vanishing of grad.</p>\n<p>Algorithmn of BN is calculating the mean and variance of each batch and transfering the value of all batch to mean 0, variance 1.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPWJhdGNoJTIwbm9ybWFsaXphdGlvbiZhbXA7dXRtX2NvbnRlbnQ9c2VhcmNoX3N1Z2dlc3Rpb24mYW1wO3R5cGU9Y29udGVudA==\">https://www.zhihu.com/search?q=batch%20normalization&amp;utm_content=search_suggestion&amp;type=content<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"DockerApp - wordpress","_content":"\n# Docker-compose\n\n\n```yaml\nversion: '3.1'\n\nservices:\n  wordpress:\n    image: wordpress\n    restart: always\n    depends_on:\n      - db\n    ports:\n      - 80:80\n    environment:\n      WORDPRESS_DB_HOST: db\n      WORDPRESS_DB_USER: user\n      WORDPRESS_DB_PASSWORD: password\n      WORDPRESS_DB_NAME: wordpress\n    volumes:\n      - wordpress:/var/www/html\n\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: user\n      MYSQL_PASSWORD: password\n      MYSQL_RANDOM_ROOT_PASSWORD: '1'\n    volumes:\n      - db:/var/lib/mysql\n\nvolumes:\n  wordpress:\n  db:\n```\n\n# 配置\n\n## volumes\n\n挂载形式`host:container`\n\ncompose最后声明的volumes**如果不指定目录**会自动创建在`/etc/lib/docker/volumes/example/_data`下\n\n## 注意\n\n`example`=当前文件夹名_compose中声明的volumes的名字\n\n# 启动\n\n```sh\nsudo docker-compose -f wordpress.yml up -d\n```","source":"_posts/docker/docker-wordpress.md","raw":"---\ntitle: DockerApp - wordpress\ncategories:\n- Notebook\ntags:\n- docker\n- wordpress\n---\n\n# Docker-compose\n\n\n```yaml\nversion: '3.1'\n\nservices:\n  wordpress:\n    image: wordpress\n    restart: always\n    depends_on:\n      - db\n    ports:\n      - 80:80\n    environment:\n      WORDPRESS_DB_HOST: db\n      WORDPRESS_DB_USER: user\n      WORDPRESS_DB_PASSWORD: password\n      WORDPRESS_DB_NAME: wordpress\n    volumes:\n      - wordpress:/var/www/html\n\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: user\n      MYSQL_PASSWORD: password\n      MYSQL_RANDOM_ROOT_PASSWORD: '1'\n    volumes:\n      - db:/var/lib/mysql\n\nvolumes:\n  wordpress:\n  db:\n```\n\n# 配置\n\n## volumes\n\n挂载形式`host:container`\n\ncompose最后声明的volumes**如果不指定目录**会自动创建在`/etc/lib/docker/volumes/example/_data`下\n\n## 注意\n\n`example`=当前文件夹名_compose中声明的volumes的名字\n\n# 启动\n\n```sh\nsudo docker-compose -f wordpress.yml up -d\n```","slug":"docker/docker-wordpress","published":1,"date":"2021-02-25T19:10:34.462Z","updated":"2021-02-26T07:27:33.552Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y6001z018o7w4h0p4j","content":"<h1 id=\"Docker-compose\"><a href=\"#Docker-compose\" class=\"headerlink\" title=\"Docker-compose\"></a>Docker-compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.1'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">wordpress:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">80</span><span class=\"string\">:80</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_HOST:</span> <span class=\"string\">db</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_USER:</span> <span class=\"string\">user</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_PASSWORD:</span> <span class=\"string\">password</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_NAME:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">wordpress:/var/www/html</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mysql:5.7</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_DATABASE:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_USER:</span> <span class=\"string\">user</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_PASSWORD:</span> <span class=\"string\">password</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_RANDOM_ROOT_PASSWORD:</span> <span class=\"string\">'1'</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db:/var/lib/mysql</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">wordpress:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"volumes\"><a href=\"#volumes\" class=\"headerlink\" title=\"volumes\"></a>volumes</h2><p>挂载形式<code>host:container</code></p>\n<p>compose最后声明的volumes<strong>如果不指定目录</strong>会自动创建在<code>/etc/lib/docker/volumes/example/_data</code>下</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p><code>example</code>=当前文件夹名_compose中声明的volumes的名字</p>\n<h1 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f wordpress.yml up -d</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker-compose\"><a href=\"#Docker-compose\" class=\"headerlink\" title=\"Docker-compose\"></a>Docker-compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.1'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">wordpress:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">80</span><span class=\"string\">:80</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_HOST:</span> <span class=\"string\">db</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_USER:</span> <span class=\"string\">user</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_PASSWORD:</span> <span class=\"string\">password</span></span><br><span class=\"line\">      <span class=\"attr\">WORDPRESS_DB_NAME:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">wordpress:/var/www/html</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mysql:5.7</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_DATABASE:</span> <span class=\"string\">wordpress</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_USER:</span> <span class=\"string\">user</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_PASSWORD:</span> <span class=\"string\">password</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_RANDOM_ROOT_PASSWORD:</span> <span class=\"string\">'1'</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">db:/var/lib/mysql</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">wordpress:</span></span><br><span class=\"line\">  <span class=\"attr\">db:</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"volumes\"><a href=\"#volumes\" class=\"headerlink\" title=\"volumes\"></a>volumes</h2><p>挂载形式<code>host:container</code></p>\n<p>compose最后声明的volumes<strong>如果不指定目录</strong>会自动创建在<code>/etc/lib/docker/volumes/example/_data</code>下</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p><code>example</code>=当前文件夹名_compose中声明的volumes的名字</p>\n<h1 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker-compose -f wordpress.yml up -d</span><br></pre></td></tr></table></figure>"},{"title":"Docker - start","catagories":["Docker"],"_content":"\n# Docker\n\n\n## 运行docker\n`$ service docker start`\n\n\n\n## 运行容器\n`docker run -i -t -p 11000:8888 continuumio/anaconda3 /bin/bash`\n`-d`detach直接后台运行\n\n```\n-i: 是  以交互模式运行容器，通常与 -t 同时使用；\n-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；\n-p: 指定端口映射，格式为：主机(宿主)端口:容器端口\n```\n\n**退出容器并保存在后台**\n`Control + P + Q`\n\n**进入容器**\n`docker exec -it name /bin/bash`\n此时`exit`不会关闭容器\n\n**查看运行的容器**\n`docker ps -a`\n\n\n\n## 映射或挂载(重要)\n`宿主机:镜像`\n\n**默认挂载路径** \n`/var/lib/docker/volumes`\n\n\n\n## 镜像相关\n\n**生成镜像** \n`docker commit -a \"username\" -m \"msg\" container_name new_image_name`\n\n**上传镜像** \n将打包好的新镜像上传到 Docker Hub：\n\n首先我们需要将这个新镜像打上 tag，方便在公共服务器进行上传：\n\n`docker tag new_anaconda_xgboost:latest nimendavid/machine_learning:v0.1`\n\n其中:\n\n`new_anaconda_xgboost:latest`\n(本地镜像名称:tag)\n\n可以通过 `docker image ls` 查看\n`nimendavid/machine_learning:v0.1`\n\n格式是(dockerhub用户名/仓库名:tag)  ，需要自己有一个dockerhub账号，v0.1就是自定义的版本号码\n\n然后记得登录在服务器上dockerhub，否则推送会报错：\n\n`docker login`","source":"_posts/docker/docker.md","raw":"---\ntitle: Docker - start\ncatagories:\n- Docker\n---\n\n# Docker\n\n\n## 运行docker\n`$ service docker start`\n\n\n\n## 运行容器\n`docker run -i -t -p 11000:8888 continuumio/anaconda3 /bin/bash`\n`-d`detach直接后台运行\n\n```\n-i: 是  以交互模式运行容器，通常与 -t 同时使用；\n-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；\n-p: 指定端口映射，格式为：主机(宿主)端口:容器端口\n```\n\n**退出容器并保存在后台**\n`Control + P + Q`\n\n**进入容器**\n`docker exec -it name /bin/bash`\n此时`exit`不会关闭容器\n\n**查看运行的容器**\n`docker ps -a`\n\n\n\n## 映射或挂载(重要)\n`宿主机:镜像`\n\n**默认挂载路径** \n`/var/lib/docker/volumes`\n\n\n\n## 镜像相关\n\n**生成镜像** \n`docker commit -a \"username\" -m \"msg\" container_name new_image_name`\n\n**上传镜像** \n将打包好的新镜像上传到 Docker Hub：\n\n首先我们需要将这个新镜像打上 tag，方便在公共服务器进行上传：\n\n`docker tag new_anaconda_xgboost:latest nimendavid/machine_learning:v0.1`\n\n其中:\n\n`new_anaconda_xgboost:latest`\n(本地镜像名称:tag)\n\n可以通过 `docker image ls` 查看\n`nimendavid/machine_learning:v0.1`\n\n格式是(dockerhub用户名/仓库名:tag)  ，需要自己有一个dockerhub账号，v0.1就是自定义的版本号码\n\n然后记得登录在服务器上dockerhub，否则推送会报错：\n\n`docker login`","slug":"docker/docker","published":1,"date":"2020-07-14T15:31:04.197Z","updated":"2021-02-26T07:27:08.307Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y70023018oepxre2gw","content":"<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><h2 id=\"运行docker\"><a href=\"#运行docker\" class=\"headerlink\" title=\"运行docker\"></a>运行docker</h2><p><code>$ service docker start</code></p>\n<h2 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h2><p><code>docker run -i -t -p 11000:8888 continuumio/anaconda3 /bin/bash</code><br><code>-d</code>detach直接后台运行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i: 是  以交互模式运行容器，通常与 -t 同时使用；</span><br><span class=\"line\">-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span><br><span class=\"line\">-p: 指定端口映射，格式为：主机(宿主)端口:容器端口</span><br></pre></td></tr></table></figure>\n\n<p><strong>退出容器并保存在后台</strong><br><code>Control + P + Q</code></p>\n<p><strong>进入容器</strong><br><code>docker exec -it name /bin/bash</code><br>此时<code>exit</code>不会关闭容器</p>\n<p><strong>查看运行的容器</strong><br><code>docker ps -a</code></p>\n<h2 id=\"映射或挂载-重要\"><a href=\"#映射或挂载-重要\" class=\"headerlink\" title=\"映射或挂载(重要)\"></a>映射或挂载(重要)</h2><p><code>宿主机:镜像</code></p>\n<p><strong>默认挂载路径</strong><br><code>/var/lib/docker/volumes</code></p>\n<h2 id=\"镜像相关\"><a href=\"#镜像相关\" class=\"headerlink\" title=\"镜像相关\"></a>镜像相关</h2><p><strong>生成镜像</strong><br><code>docker commit -a &quot;username&quot; -m &quot;msg&quot; container_name new_image_name</code></p>\n<p><strong>上传镜像</strong><br>将打包好的新镜像上传到 Docker Hub：</p>\n<p>首先我们需要将这个新镜像打上 tag，方便在公共服务器进行上传：</p>\n<p><code>docker tag new_anaconda_xgboost:latest nimendavid/machine_learning:v0.1</code></p>\n<p>其中:</p>\n<p><code>new_anaconda_xgboost:latest</code><br>(本地镜像名称:tag)</p>\n<p>可以通过 <code>docker image ls</code> 查看<br><code>nimendavid/machine_learning:v0.1</code></p>\n<p>格式是(dockerhub用户名/仓库名:tag)  ，需要自己有一个dockerhub账号，v0.1就是自定义的版本号码</p>\n<p>然后记得登录在服务器上dockerhub，否则推送会报错：</p>\n<p><code>docker login</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><h2 id=\"运行docker\"><a href=\"#运行docker\" class=\"headerlink\" title=\"运行docker\"></a>运行docker</h2><p><code>$ service docker start</code></p>\n<h2 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h2><p><code>docker run -i -t -p 11000:8888 continuumio/anaconda3 /bin/bash</code><br><code>-d</code>detach直接后台运行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-i: 是  以交互模式运行容器，通常与 -t 同时使用；</span><br><span class=\"line\">-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span><br><span class=\"line\">-p: 指定端口映射，格式为：主机(宿主)端口:容器端口</span><br></pre></td></tr></table></figure>\n\n<p><strong>退出容器并保存在后台</strong><br><code>Control + P + Q</code></p>\n<p><strong>进入容器</strong><br><code>docker exec -it name /bin/bash</code><br>此时<code>exit</code>不会关闭容器</p>\n<p><strong>查看运行的容器</strong><br><code>docker ps -a</code></p>\n<h2 id=\"映射或挂载-重要\"><a href=\"#映射或挂载-重要\" class=\"headerlink\" title=\"映射或挂载(重要)\"></a>映射或挂载(重要)</h2><p><code>宿主机:镜像</code></p>\n<p><strong>默认挂载路径</strong><br><code>/var/lib/docker/volumes</code></p>\n<h2 id=\"镜像相关\"><a href=\"#镜像相关\" class=\"headerlink\" title=\"镜像相关\"></a>镜像相关</h2><p><strong>生成镜像</strong><br><code>docker commit -a &quot;username&quot; -m &quot;msg&quot; container_name new_image_name</code></p>\n<p><strong>上传镜像</strong><br>将打包好的新镜像上传到 Docker Hub：</p>\n<p>首先我们需要将这个新镜像打上 tag，方便在公共服务器进行上传：</p>\n<p><code>docker tag new_anaconda_xgboost:latest nimendavid/machine_learning:v0.1</code></p>\n<p>其中:</p>\n<p><code>new_anaconda_xgboost:latest</code><br>(本地镜像名称:tag)</p>\n<p>可以通过 <code>docker image ls</code> 查看<br><code>nimendavid/machine_learning:v0.1</code></p>\n<p>格式是(dockerhub用户名/仓库名:tag)  ，需要自己有一个dockerhub账号，v0.1就是自定义的版本号码</p>\n<p>然后记得登录在服务器上dockerhub，否则推送会报错：</p>\n<p><code>docker login</code></p>\n"},{"title":"Convolutional Neural Network","_content":"\n# Convolutional Layer\n\nThere are many conv_kernels in a Conv layer. In my perspective, one paticular kernel's size is [kernel_size, kernel_size, in_channel]. The output of the calculation computed by the kernel is sum of all channel's results. So you need to define filter's num, which determine the output feature map.\n\n\n\nParameters: filters, kernel_size, stride, padding\n\n# Pooling Layer\n\nUsually a Pooling layer is after a Conv layer. It is a common use to do downsampling by calculate the value in filter of Pooling.\n\nThere are 3 method in common use in Pooling layer, MaxPooling, MinPooling, AvgPooling.\n\n","source":"_posts/deep_learning/Conv.md","raw":"---\ntitle: Convolutional Neural Network\ncategories:\n- Deep Learning\ntags:\n- conv\n---\n\n# Convolutional Layer\n\nThere are many conv_kernels in a Conv layer. In my perspective, one paticular kernel's size is [kernel_size, kernel_size, in_channel]. The output of the calculation computed by the kernel is sum of all channel's results. So you need to define filter's num, which determine the output feature map.\n\n\n\nParameters: filters, kernel_size, stride, padding\n\n# Pooling Layer\n\nUsually a Pooling layer is after a Conv layer. It is a common use to do downsampling by calculate the value in filter of Pooling.\n\nThere are 3 method in common use in Pooling layer, MaxPooling, MinPooling, AvgPooling.\n\n","slug":"deep_learning/Conv","published":1,"date":"2021-07-07T12:16:45.614Z","updated":"2021-10-15T19:38:33.405Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y80026018o0ovkcgze","content":"<h1 id=\"Convolutional-Layer\"><a href=\"#Convolutional-Layer\" class=\"headerlink\" title=\"Convolutional Layer\"></a>Convolutional Layer</h1><p>There are many conv_kernels in a Conv layer. In my perspective, one paticular kernel’s size is [kernel_size, kernel_size, in_channel]. The output of the calculation computed by the kernel is sum of all channel’s results. So you need to define filter’s num, which determine the output feature map.</p>\n<p>Parameters: filters, kernel_size, stride, padding</p>\n<h1 id=\"Pooling-Layer\"><a href=\"#Pooling-Layer\" class=\"headerlink\" title=\"Pooling Layer\"></a>Pooling Layer</h1><p>Usually a Pooling layer is after a Conv layer. It is a common use to do downsampling by calculate the value in filter of Pooling.</p>\n<p>There are 3 method in common use in Pooling layer, MaxPooling, MinPooling, AvgPooling.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Convolutional-Layer\"><a href=\"#Convolutional-Layer\" class=\"headerlink\" title=\"Convolutional Layer\"></a>Convolutional Layer</h1><p>There are many conv_kernels in a Conv layer. In my perspective, one paticular kernel’s size is [kernel_size, kernel_size, in_channel]. The output of the calculation computed by the kernel is sum of all channel’s results. So you need to define filter’s num, which determine the output feature map.</p>\n<p>Parameters: filters, kernel_size, stride, padding</p>\n<h1 id=\"Pooling-Layer\"><a href=\"#Pooling-Layer\" class=\"headerlink\" title=\"Pooling Layer\"></a>Pooling Layer</h1><p>Usually a Pooling layer is after a Conv layer. It is a common use to do downsampling by calculate the value in filter of Pooling.</p>\n<p>There are 3 method in common use in Pooling layer, MaxPooling, MinPooling, AvgPooling.</p>\n"},{"title":"交易订单类型","_content":"\n# 市价单（Market, MKT）\n\n不指定具体价位，按照当时市场上可执行的最好价格成交。\n\n优点：保证立即达成交易，防止踏空或尽快止盈/止损。\n\n缺点：不保证成交价格，当市场快速变化或流动性不足时，成交价格与下单时看到的最后价格可能相差甚远（滑点）。\n\n# 限价单（Limit, LMT）\n\n若为买单，则只能以该价格或更低价买入；若为卖出，则以该价格或更高价格卖出。\n\n优点：明确知道成交的价格范围。\n\n缺点：无法保证成交速度，甚至无法成交，导致错失行情。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/32509704","source":"_posts/finance/exchange.md","raw":"---\ntitle: 交易订单类型\ncategories:\n- Finance\ntags:\n- order\n---\n\n# 市价单（Market, MKT）\n\n不指定具体价位，按照当时市场上可执行的最好价格成交。\n\n优点：保证立即达成交易，防止踏空或尽快止盈/止损。\n\n缺点：不保证成交价格，当市场快速变化或流动性不足时，成交价格与下单时看到的最后价格可能相差甚远（滑点）。\n\n# 限价单（Limit, LMT）\n\n若为买单，则只能以该价格或更低价买入；若为卖出，则以该价格或更高价格卖出。\n\n优点：明确知道成交的价格范围。\n\n缺点：无法保证成交速度，甚至无法成交，导致错失行情。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/32509704","slug":"finance/exchange","published":1,"date":"2021-02-23T07:19:42.172Z","updated":"2021-02-23T07:28:28.318Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97y90028018oappx7719","content":"<h1 id=\"市价单（Market-MKT）\"><a href=\"#市价单（Market-MKT）\" class=\"headerlink\" title=\"市价单（Market, MKT）\"></a>市价单（Market, MKT）</h1><p>不指定具体价位，按照当时市场上可执行的最好价格成交。</p>\n<p>优点：保证立即达成交易，防止踏空或尽快止盈/止损。</p>\n<p>缺点：不保证成交价格，当市场快速变化或流动性不足时，成交价格与下单时看到的最后价格可能相差甚远（滑点）。</p>\n<h1 id=\"限价单（Limit-LMT）\"><a href=\"#限价单（Limit-LMT）\" class=\"headerlink\" title=\"限价单（Limit, LMT）\"></a>限价单（Limit, LMT）</h1><p>若为买单，则只能以该价格或更低价买入；若为卖出，则以该价格或更高价格卖出。</p>\n<p>优点：明确知道成交的价格范围。</p>\n<p>缺点：无法保证成交速度，甚至无法成交，导致错失行情。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMjUwOTcwNA==\">https://zhuanlan.zhihu.com/p/32509704<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"市价单（Market-MKT）\"><a href=\"#市价单（Market-MKT）\" class=\"headerlink\" title=\"市价单（Market, MKT）\"></a>市价单（Market, MKT）</h1><p>不指定具体价位，按照当时市场上可执行的最好价格成交。</p>\n<p>优点：保证立即达成交易，防止踏空或尽快止盈/止损。</p>\n<p>缺点：不保证成交价格，当市场快速变化或流动性不足时，成交价格与下单时看到的最后价格可能相差甚远（滑点）。</p>\n<h1 id=\"限价单（Limit-LMT）\"><a href=\"#限价单（Limit-LMT）\" class=\"headerlink\" title=\"限价单（Limit, LMT）\"></a>限价单（Limit, LMT）</h1><p>若为买单，则只能以该价格或更低价买入；若为卖出，则以该价格或更高价格卖出。</p>\n<p>优点：明确知道成交的价格范围。</p>\n<p>缺点：无法保证成交速度，甚至无法成交，导致错失行情。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMjUwOTcwNA==\">https://zhuanlan.zhihu.com/p/32509704<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Dropout","_content":"\n# Dropout Layer\n\nTo avoid two main defects in training deep network, overfit and time consuming.\n\nIt has the ability to achieve regulation.\n\nThe process of Dropout layer is that hide a part of the node i one layer and start forward and backward. So only a part of nodes that didn't be hidden are updated. Repeat this process.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/38200980","source":"_posts/deep_learning/Dropout.md","raw":"---\ntitle: Dropout\ncategories:\n- Deep Learning\n---\n\n# Dropout Layer\n\nTo avoid two main defects in training deep network, overfit and time consuming.\n\nIt has the ability to achieve regulation.\n\nThe process of Dropout layer is that hide a part of the node i one layer and start forward and backward. So only a part of nodes that didn't be hidden are updated. Repeat this process.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/38200980","slug":"deep_learning/Dropout","published":1,"date":"2021-07-07T12:49:37.901Z","updated":"2021-10-15T19:39:26.296Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97ye002b018od770h4s5","content":"<h1 id=\"Dropout-Layer\"><a href=\"#Dropout-Layer\" class=\"headerlink\" title=\"Dropout Layer\"></a>Dropout Layer</h1><p>To avoid two main defects in training deep network, overfit and time consuming.</p>\n<p>It has the ability to achieve regulation.</p>\n<p>The process of Dropout layer is that hide a part of the node i one layer and start forward and backward. So only a part of nodes that didn’t be hidden are updated. Repeat this process.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zODIwMDk4MA==\">https://zhuanlan.zhihu.com/p/38200980<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Dropout-Layer\"><a href=\"#Dropout-Layer\" class=\"headerlink\" title=\"Dropout Layer\"></a>Dropout Layer</h1><p>To avoid two main defects in training deep network, overfit and time consuming.</p>\n<p>It has the ability to achieve regulation.</p>\n<p>The process of Dropout layer is that hide a part of the node i one layer and start forward and backward. So only a part of nodes that didn’t be hidden are updated. Repeat this process.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zODIwMDk4MA==\">https://zhuanlan.zhihu.com/p/38200980<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Teacher Forcing Mechanism","_content":"\n# Drawback\n\nThe prediction ability about next word in RNN is weak at beginning.\n\n# Method\n\nBy introducing the teacher forcing mechanism, assign the input of the decoder with ground truth under teacher forcing. And feed the prediction of decoder under free running.\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/qq_30219017/article/details/89090690","source":"_posts/deep_learning/teacher-forcing.md","raw":"---\ntitle: Teacher Forcing Mechanism\ncategories:\n- Deep Learning\ntags:\n- rnn\n---\n\n# Drawback\n\nThe prediction ability about next word in RNN is weak at beginning.\n\n# Method\n\nBy introducing the teacher forcing mechanism, assign the input of the decoder with ground truth under teacher forcing. And feed the prediction of decoder under free running.\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/qq_30219017/article/details/89090690","slug":"deep_learning/teacher-forcing","published":1,"date":"2021-08-20T14:45:01.157Z","updated":"2021-10-15T19:38:17.639Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yf002e018oeekb5fvu","content":"<h1 id=\"Drawback\"><a href=\"#Drawback\" class=\"headerlink\" title=\"Drawback\"></a>Drawback</h1><p>The prediction ability about next word in RNN is weak at beginning.</p>\n<h1 id=\"Method\"><a href=\"#Method\" class=\"headerlink\" title=\"Method\"></a>Method</h1><p>By introducing the teacher forcing mechanism, assign the input of the decoder with ground truth under teacher forcing. And feed the prediction of decoder under free running.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMjE5MDE3L2FydGljbGUvZGV0YWlscy84OTA5MDY5MA==\">https://blog.csdn.net/qq_30219017/article/details/89090690<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Drawback\"><a href=\"#Drawback\" class=\"headerlink\" title=\"Drawback\"></a>Drawback</h1><p>The prediction ability about next word in RNN is weak at beginning.</p>\n<h1 id=\"Method\"><a href=\"#Method\" class=\"headerlink\" title=\"Method\"></a>Method</h1><p>By introducing the teacher forcing mechanism, assign the input of the decoder with ground truth under teacher forcing. And feed the prediction of decoder under free running.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMwMjE5MDE3L2FydGljbGUvZGV0YWlscy84OTA5MDY5MA==\">https://blog.csdn.net/qq_30219017/article/details/89090690<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Terms in Deep Learning","_content":"\n# Term\n\n## SOTA\n\nstate of the art\n\nTo illustrate the best model in the paticular task.\n\n## Baseline\n\nThe experiment part that you need to compete with.\n\n## Benchmark\n\nThe target value of the experiment that you need to compete with.\n\n","source":"_posts/deep_learning/term.md","raw":"---\ntitle: Terms in Deep Learning\ncategories:\n- Deep Learning\n---\n\n# Term\n\n## SOTA\n\nstate of the art\n\nTo illustrate the best model in the paticular task.\n\n## Baseline\n\nThe experiment part that you need to compete with.\n\n## Benchmark\n\nThe target value of the experiment that you need to compete with.\n\n","slug":"deep_learning/term","published":1,"date":"2021-07-07T12:34:04.947Z","updated":"2021-10-15T19:38:44.528Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yg002h018o7x2vayp9","content":"<h1 id=\"Term\"><a href=\"#Term\" class=\"headerlink\" title=\"Term\"></a>Term</h1><h2 id=\"SOTA\"><a href=\"#SOTA\" class=\"headerlink\" title=\"SOTA\"></a>SOTA</h2><p>state of the art</p>\n<p>To illustrate the best model in the paticular task.</p>\n<h2 id=\"Baseline\"><a href=\"#Baseline\" class=\"headerlink\" title=\"Baseline\"></a>Baseline</h2><p>The experiment part that you need to compete with.</p>\n<h2 id=\"Benchmark\"><a href=\"#Benchmark\" class=\"headerlink\" title=\"Benchmark\"></a>Benchmark</h2><p>The target value of the experiment that you need to compete with.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Term\"><a href=\"#Term\" class=\"headerlink\" title=\"Term\"></a>Term</h1><h2 id=\"SOTA\"><a href=\"#SOTA\" class=\"headerlink\" title=\"SOTA\"></a>SOTA</h2><p>state of the art</p>\n<p>To illustrate the best model in the paticular task.</p>\n<h2 id=\"Baseline\"><a href=\"#Baseline\" class=\"headerlink\" title=\"Baseline\"></a>Baseline</h2><p>The experiment part that you need to compete with.</p>\n<h2 id=\"Benchmark\"><a href=\"#Benchmark\" class=\"headerlink\" title=\"Benchmark\"></a>Benchmark</h2><p>The target value of the experiment that you need to compete with.</p>\n"},{"title":"K线 - MA, MACD, BOLL","_content":"\n# MA\n\n移动平均线(Moving Average)，指一段时间的收盘价之和除以这段时间的总天数的数据。\n\n移动平均线可以用来观察股价趋势，一般来说，现行价格在平均价之上意味着市场需求较大，行情看好；反之，行情在平均价之下，意味着供过于求，行情看淡。\n\n# BOLL\n\n布林指标，通过计算股价的**标准差**，再求股价的**信赖区间**。\n\nBOLL指标由三条线组成，上轨线，中轨线，下轨线。也是通过MA计算出来的。\n\n三条线同时向上时，短期内持续上涨，市场强势。同时向下，短期内持续下跌，市场弱势。\n\n# EMA\n\n计算移动平均值。\n\n# MACD\n\n意义和双移动平均线基本相同。由快，慢均线的离散聚合表征当前的多空状态和股价可能的发展变化趋势。\n\n由负数转向正数是买的信号；由正数转向负数时卖的信号。\n\nMACD指标中，快线是DIF，慢线是DEA，柱状图为MACD。\n\n- DIF DEA 均为正，DIF向上突破DEA，买入信号。\n- DIP DEA 均为负，DIF向下突破DEA，卖出信号。\n- DIF线与K线发生背离，行情可能出现反转。\n\n\n\n# RSI\n\n相对强弱指数，它是根据一定时期内上涨和下跌幅度之和的比率制作出的一种技术曲线，用以计策市场供需关系和买卖力道。RSI指标是根据供求平衡的原理，通过测量某一期间内股价上涨总幅度占股价变化总幅度平均值的百分比，来评价多空力量的强弱程度。\n\n40~60之间的作用不大，RSI从50以下向上突破代表股价转强；从50以上向下突破50代表股价转弱。\n\n短期RSI向上突破长期RSI时，为买入信号；短期RSI向下突破长期RSI时，为卖出信号。\n\n# KDJ\n\n周期内出现过的最高价，最低价，最后一个计算周期的收盘价及这三者之间的比例关系，来计算最后一个计算周期的未成熟随机值RSV。\n\n- K D值永远介于0 100之间，D大于80时，呈现超买现象。D小于20时，呈现超卖现象。\n- 上涨趋势中，K值小于D值，K线向上突破D线时，为买进信号。反之卖出信号。\n\n\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/300871557","source":"_posts/finance/k-line.md","raw":"---\ntitle: K线 - MA, MACD, BOLL\ncategories:\n- Finance\ntags:\n- k-line\n---\n\n# MA\n\n移动平均线(Moving Average)，指一段时间的收盘价之和除以这段时间的总天数的数据。\n\n移动平均线可以用来观察股价趋势，一般来说，现行价格在平均价之上意味着市场需求较大，行情看好；反之，行情在平均价之下，意味着供过于求，行情看淡。\n\n# BOLL\n\n布林指标，通过计算股价的**标准差**，再求股价的**信赖区间**。\n\nBOLL指标由三条线组成，上轨线，中轨线，下轨线。也是通过MA计算出来的。\n\n三条线同时向上时，短期内持续上涨，市场强势。同时向下，短期内持续下跌，市场弱势。\n\n# EMA\n\n计算移动平均值。\n\n# MACD\n\n意义和双移动平均线基本相同。由快，慢均线的离散聚合表征当前的多空状态和股价可能的发展变化趋势。\n\n由负数转向正数是买的信号；由正数转向负数时卖的信号。\n\nMACD指标中，快线是DIF，慢线是DEA，柱状图为MACD。\n\n- DIF DEA 均为正，DIF向上突破DEA，买入信号。\n- DIP DEA 均为负，DIF向下突破DEA，卖出信号。\n- DIF线与K线发生背离，行情可能出现反转。\n\n\n\n# RSI\n\n相对强弱指数，它是根据一定时期内上涨和下跌幅度之和的比率制作出的一种技术曲线，用以计策市场供需关系和买卖力道。RSI指标是根据供求平衡的原理，通过测量某一期间内股价上涨总幅度占股价变化总幅度平均值的百分比，来评价多空力量的强弱程度。\n\n40~60之间的作用不大，RSI从50以下向上突破代表股价转强；从50以上向下突破50代表股价转弱。\n\n短期RSI向上突破长期RSI时，为买入信号；短期RSI向下突破长期RSI时，为卖出信号。\n\n# KDJ\n\n周期内出现过的最高价，最低价，最后一个计算周期的收盘价及这三者之间的比例关系，来计算最后一个计算周期的未成熟随机值RSV。\n\n- K D值永远介于0 100之间，D大于80时，呈现超买现象。D小于20时，呈现超卖现象。\n- 上涨趋势中，K值小于D值，K线向上突破D线时，为买进信号。反之卖出信号。\n\n\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/300871557","slug":"finance/k-line","published":1,"date":"2021-02-24T03:49:27.548Z","updated":"2021-02-24T04:50:58.102Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yh002j018o2oub1mps","content":"<h1 id=\"MA\"><a href=\"#MA\" class=\"headerlink\" title=\"MA\"></a>MA</h1><p>移动平均线(Moving Average)，指一段时间的收盘价之和除以这段时间的总天数的数据。</p>\n<p>移动平均线可以用来观察股价趋势，一般来说，现行价格在平均价之上意味着市场需求较大，行情看好；反之，行情在平均价之下，意味着供过于求，行情看淡。</p>\n<h1 id=\"BOLL\"><a href=\"#BOLL\" class=\"headerlink\" title=\"BOLL\"></a>BOLL</h1><p>布林指标，通过计算股价的<strong>标准差</strong>，再求股价的<strong>信赖区间</strong>。</p>\n<p>BOLL指标由三条线组成，上轨线，中轨线，下轨线。也是通过MA计算出来的。</p>\n<p>三条线同时向上时，短期内持续上涨，市场强势。同时向下，短期内持续下跌，市场弱势。</p>\n<h1 id=\"EMA\"><a href=\"#EMA\" class=\"headerlink\" title=\"EMA\"></a>EMA</h1><p>计算移动平均值。</p>\n<h1 id=\"MACD\"><a href=\"#MACD\" class=\"headerlink\" title=\"MACD\"></a>MACD</h1><p>意义和双移动平均线基本相同。由快，慢均线的离散聚合表征当前的多空状态和股价可能的发展变化趋势。</p>\n<p>由负数转向正数是买的信号；由正数转向负数时卖的信号。</p>\n<p>MACD指标中，快线是DIF，慢线是DEA，柱状图为MACD。</p>\n<ul>\n<li>DIF DEA 均为正，DIF向上突破DEA，买入信号。</li>\n<li>DIP DEA 均为负，DIF向下突破DEA，卖出信号。</li>\n<li>DIF线与K线发生背离，行情可能出现反转。</li>\n</ul>\n<h1 id=\"RSI\"><a href=\"#RSI\" class=\"headerlink\" title=\"RSI\"></a>RSI</h1><p>相对强弱指数，它是根据一定时期内上涨和下跌幅度之和的比率制作出的一种技术曲线，用以计策市场供需关系和买卖力道。RSI指标是根据供求平衡的原理，通过测量某一期间内股价上涨总幅度占股价变化总幅度平均值的百分比，来评价多空力量的强弱程度。</p>\n<p>40~60之间的作用不大，RSI从50以下向上突破代表股价转强；从50以上向下突破50代表股价转弱。</p>\n<p>短期RSI向上突破长期RSI时，为买入信号；短期RSI向下突破长期RSI时，为卖出信号。</p>\n<h1 id=\"KDJ\"><a href=\"#KDJ\" class=\"headerlink\" title=\"KDJ\"></a>KDJ</h1><p>周期内出现过的最高价，最低价，最后一个计算周期的收盘价及这三者之间的比例关系，来计算最后一个计算周期的未成熟随机值RSV。</p>\n<ul>\n<li>K D值永远介于0 100之间，D大于80时，呈现超买现象。D小于20时，呈现超卖现象。</li>\n<li>上涨趋势中，K值小于D值，K线向上突破D线时，为买进信号。反之卖出信号。</li>\n</ul>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMDA4NzE1NTc=\">https://zhuanlan.zhihu.com/p/300871557<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"MA\"><a href=\"#MA\" class=\"headerlink\" title=\"MA\"></a>MA</h1><p>移动平均线(Moving Average)，指一段时间的收盘价之和除以这段时间的总天数的数据。</p>\n<p>移动平均线可以用来观察股价趋势，一般来说，现行价格在平均价之上意味着市场需求较大，行情看好；反之，行情在平均价之下，意味着供过于求，行情看淡。</p>\n<h1 id=\"BOLL\"><a href=\"#BOLL\" class=\"headerlink\" title=\"BOLL\"></a>BOLL</h1><p>布林指标，通过计算股价的<strong>标准差</strong>，再求股价的<strong>信赖区间</strong>。</p>\n<p>BOLL指标由三条线组成，上轨线，中轨线，下轨线。也是通过MA计算出来的。</p>\n<p>三条线同时向上时，短期内持续上涨，市场强势。同时向下，短期内持续下跌，市场弱势。</p>\n<h1 id=\"EMA\"><a href=\"#EMA\" class=\"headerlink\" title=\"EMA\"></a>EMA</h1><p>计算移动平均值。</p>\n<h1 id=\"MACD\"><a href=\"#MACD\" class=\"headerlink\" title=\"MACD\"></a>MACD</h1><p>意义和双移动平均线基本相同。由快，慢均线的离散聚合表征当前的多空状态和股价可能的发展变化趋势。</p>\n<p>由负数转向正数是买的信号；由正数转向负数时卖的信号。</p>\n<p>MACD指标中，快线是DIF，慢线是DEA，柱状图为MACD。</p>\n<ul>\n<li>DIF DEA 均为正，DIF向上突破DEA，买入信号。</li>\n<li>DIP DEA 均为负，DIF向下突破DEA，卖出信号。</li>\n<li>DIF线与K线发生背离，行情可能出现反转。</li>\n</ul>\n<h1 id=\"RSI\"><a href=\"#RSI\" class=\"headerlink\" title=\"RSI\"></a>RSI</h1><p>相对强弱指数，它是根据一定时期内上涨和下跌幅度之和的比率制作出的一种技术曲线，用以计策市场供需关系和买卖力道。RSI指标是根据供求平衡的原理，通过测量某一期间内股价上涨总幅度占股价变化总幅度平均值的百分比，来评价多空力量的强弱程度。</p>\n<p>40~60之间的作用不大，RSI从50以下向上突破代表股价转强；从50以上向下突破50代表股价转弱。</p>\n<p>短期RSI向上突破长期RSI时，为买入信号；短期RSI向下突破长期RSI时，为卖出信号。</p>\n<h1 id=\"KDJ\"><a href=\"#KDJ\" class=\"headerlink\" title=\"KDJ\"></a>KDJ</h1><p>周期内出现过的最高价，最低价，最后一个计算周期的收盘价及这三者之间的比例关系，来计算最后一个计算周期的未成熟随机值RSV。</p>\n<ul>\n<li>K D值永远介于0 100之间，D大于80时，呈现超买现象。D小于20时，呈现超卖现象。</li>\n<li>上涨趋势中，K值小于D值，K线向上突破D线时，为买进信号。反之卖出信号。</li>\n</ul>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMDA4NzE1NTc=\">https://zhuanlan.zhihu.com/p/300871557<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Hadoop - hdfs","_content":"\n# 架构\n\nHDFS是Master和Slave结构，分为NameNode, Secondary NameNode, DataNode.\n\n- NameNode: 在Hadoop中只有一个，管理HDF的名称空间，数据块映射信息等。\n- Secondary: 辅助NameNode, 分担NameNode的工作，可以辅助恢复NameNode.\n- DataNode: Slave节点，实际存储数据，执行数据块的读写并汇报存储信息给NameNode。\n\n# 操作\n\n## 将数据插入到HDFS\n\n`hadoop fs -mkdir`\n\n`hadoop fs -put`\n\n...\n\n## 从HDFS获取数据到本地文件系统\n\n`hadoop fs -get`\n\n...\n\n## 命令参考\n\nhttps://www.yiibai.com/hadoop/hadoop_command_reference.html\n\n","source":"_posts/hadoop/hdfs.md","raw":"---\ntitle: Hadoop - hdfs\ncategories:\n- Notebook\ntags:\n- hadoop\n- hdfs\n---\n\n# 架构\n\nHDFS是Master和Slave结构，分为NameNode, Secondary NameNode, DataNode.\n\n- NameNode: 在Hadoop中只有一个，管理HDF的名称空间，数据块映射信息等。\n- Secondary: 辅助NameNode, 分担NameNode的工作，可以辅助恢复NameNode.\n- DataNode: Slave节点，实际存储数据，执行数据块的读写并汇报存储信息给NameNode。\n\n# 操作\n\n## 将数据插入到HDFS\n\n`hadoop fs -mkdir`\n\n`hadoop fs -put`\n\n...\n\n## 从HDFS获取数据到本地文件系统\n\n`hadoop fs -get`\n\n...\n\n## 命令参考\n\nhttps://www.yiibai.com/hadoop/hadoop_command_reference.html\n\n","slug":"hadoop/hdfs","published":1,"date":"2021-01-28T01:57:08.695Z","updated":"2021-01-28T02:43:48.338Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yh002l018ogd4sdkvg","content":"<h1 id=\"架构\"><a href=\"#架构\" class=\"headerlink\" title=\"架构\"></a>架构</h1><p>HDFS是Master和Slave结构，分为NameNode, Secondary NameNode, DataNode.</p>\n<ul>\n<li>NameNode: 在Hadoop中只有一个，管理HDF的名称空间，数据块映射信息等。</li>\n<li>Secondary: 辅助NameNode, 分担NameNode的工作，可以辅助恢复NameNode.</li>\n<li>DataNode: Slave节点，实际存储数据，执行数据块的读写并汇报存储信息给NameNode。</li>\n</ul>\n<h1 id=\"操作\"><a href=\"#操作\" class=\"headerlink\" title=\"操作\"></a>操作</h1><h2 id=\"将数据插入到HDFS\"><a href=\"#将数据插入到HDFS\" class=\"headerlink\" title=\"将数据插入到HDFS\"></a>将数据插入到HDFS</h2><p><code>hadoop fs -mkdir</code></p>\n<p><code>hadoop fs -put</code></p>\n<p>…</p>\n<h2 id=\"从HDFS获取数据到本地文件系统\"><a href=\"#从HDFS获取数据到本地文件系统\" class=\"headerlink\" title=\"从HDFS获取数据到本地文件系统\"></a>从HDFS获取数据到本地文件系统</h2><p><code>hadoop fs -get</code></p>\n<p>…</p>\n<h2 id=\"命令参考\"><a href=\"#命令参考\" class=\"headerlink\" title=\"命令参考\"></a>命令参考</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueWlpYmFpLmNvbS9oYWRvb3AvaGFkb29wX2NvbW1hbmRfcmVmZXJlbmNlLmh0bWw=\">https://www.yiibai.com/hadoop/hadoop_command_reference.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"架构\"><a href=\"#架构\" class=\"headerlink\" title=\"架构\"></a>架构</h1><p>HDFS是Master和Slave结构，分为NameNode, Secondary NameNode, DataNode.</p>\n<ul>\n<li>NameNode: 在Hadoop中只有一个，管理HDF的名称空间，数据块映射信息等。</li>\n<li>Secondary: 辅助NameNode, 分担NameNode的工作，可以辅助恢复NameNode.</li>\n<li>DataNode: Slave节点，实际存储数据，执行数据块的读写并汇报存储信息给NameNode。</li>\n</ul>\n<h1 id=\"操作\"><a href=\"#操作\" class=\"headerlink\" title=\"操作\"></a>操作</h1><h2 id=\"将数据插入到HDFS\"><a href=\"#将数据插入到HDFS\" class=\"headerlink\" title=\"将数据插入到HDFS\"></a>将数据插入到HDFS</h2><p><code>hadoop fs -mkdir</code></p>\n<p><code>hadoop fs -put</code></p>\n<p>…</p>\n<h2 id=\"从HDFS获取数据到本地文件系统\"><a href=\"#从HDFS获取数据到本地文件系统\" class=\"headerlink\" title=\"从HDFS获取数据到本地文件系统\"></a>从HDFS获取数据到本地文件系统</h2><p><code>hadoop fs -get</code></p>\n<p>…</p>\n<h2 id=\"命令参考\"><a href=\"#命令参考\" class=\"headerlink\" title=\"命令参考\"></a>命令参考</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueWlpYmFpLmNvbS9oYWRvb3AvaGFkb29wX2NvbW1hbmRfcmVmZXJlbmNlLmh0bWw=\">https://www.yiibai.com/hadoop/hadoop_command_reference.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Hadoop - mapreduce","_content":"\n# 简介\n\nMapReduce就是一个分布式的计算框架，用于并行处理数据。\n\n# 步骤\n\n分为两步Map和Reduce\n\n- Map阶段：处理输入数据，从HDFS读取数据，映射器处理该数据，并创建中间数据。\n- Reduce阶段：Shuffle+Reduce处理映射器中的数据，产生输出，存储在HDFS中。\n\n# 实例\n\n1. 写MapReduce程序\n\n```sh\nProcessUnits.java\n```\n\n2. 编译该Java类\n\n```sh\njavac -classpath xxx -d folder xxx.java\n```\n\n3. 将需要处理的数据存入HDFS\n\n```sh\nhadoop fs -put xxx\n```\n\n4. 运行MapReduce程序\n\n```sh\nhadoop jar xxx input_folder output_folder\n```\n\n5. `hadoop`可以操作MapReduce等其它工作及设置\n\n```sh\nhadoop cmd\n```\n\n","source":"_posts/hadoop/mapreduce.md","raw":"---\ntitle: Hadoop - mapreduce\ncategories:\n- Notebook\ntags:\n- hadoop\n- mapreduce\n---\n\n# 简介\n\nMapReduce就是一个分布式的计算框架，用于并行处理数据。\n\n# 步骤\n\n分为两步Map和Reduce\n\n- Map阶段：处理输入数据，从HDFS读取数据，映射器处理该数据，并创建中间数据。\n- Reduce阶段：Shuffle+Reduce处理映射器中的数据，产生输出，存储在HDFS中。\n\n# 实例\n\n1. 写MapReduce程序\n\n```sh\nProcessUnits.java\n```\n\n2. 编译该Java类\n\n```sh\njavac -classpath xxx -d folder xxx.java\n```\n\n3. 将需要处理的数据存入HDFS\n\n```sh\nhadoop fs -put xxx\n```\n\n4. 运行MapReduce程序\n\n```sh\nhadoop jar xxx input_folder output_folder\n```\n\n5. `hadoop`可以操作MapReduce等其它工作及设置\n\n```sh\nhadoop cmd\n```\n\n","slug":"hadoop/mapreduce","published":1,"date":"2021-01-28T02:44:48.040Z","updated":"2021-01-28T03:09:44.552Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yj002p018oca7d5nk7","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>MapReduce就是一个分布式的计算框架，用于并行处理数据。</p>\n<h1 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h1><p>分为两步Map和Reduce</p>\n<ul>\n<li>Map阶段：处理输入数据，从HDFS读取数据，映射器处理该数据，并创建中间数据。</li>\n<li>Reduce阶段：Shuffle+Reduce处理映射器中的数据，产生输出，存储在HDFS中。</li>\n</ul>\n<h1 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h1><ol>\n<li>写MapReduce程序</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ProcessUnits.java</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>编译该Java类</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javac -classpath xxx -d folder xxx.java</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>将需要处理的数据存入HDFS</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop fs -put xxx</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>运行MapReduce程序</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop jar xxx input_folder output_folder</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li><code>hadoop</code>可以操作MapReduce等其它工作及设置</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop cmd</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>MapReduce就是一个分布式的计算框架，用于并行处理数据。</p>\n<h1 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h1><p>分为两步Map和Reduce</p>\n<ul>\n<li>Map阶段：处理输入数据，从HDFS读取数据，映射器处理该数据，并创建中间数据。</li>\n<li>Reduce阶段：Shuffle+Reduce处理映射器中的数据，产生输出，存储在HDFS中。</li>\n</ul>\n<h1 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h1><ol>\n<li>写MapReduce程序</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ProcessUnits.java</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>编译该Java类</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javac -classpath xxx -d folder xxx.java</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>将需要处理的数据存入HDFS</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop fs -put xxx</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>运行MapReduce程序</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop jar xxx input_folder output_folder</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li><code>hadoop</code>可以操作MapReduce等其它工作及设置</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoop cmd</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Hadoop - start","_content":"\n# QuikStart\n\n## 安装Hadoop\n\n`wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz`\n\n# Hadoop操作模式\n\n可以选择Hadoop集群以以下三个支持模式之一：\n\n- 独立/单机模式：默认情况下，被配置在一个独立的模式中运行Java程序。\n- 模拟分布式模式：这是单台机器的分布式模拟。Hadoop守护每个进程，如hdfs, yarn, MapReduce等，都将作为一个独立的Java程序运行，对开发有利。\n- 完全分布式模式：这种模式时完全分布式的最小两台或多台计算机的集群。\n\n# 在单机模式下安装Hadoop\n\n独立/单机模式适合开发期间运行MapReduce程序，容易进行测试和调试。\n\n**设置`JAVA_HOME`变量**\n\n`export JAVA_HOME=pwd`\n\n**设置Java环境变量**\n\n`export PATH=$PATH:$JAVA_HOME/bin`\n\n将Hadoop添加到环境变量\n\n`export PATH=$PATH:/home/hadoop/bin`\n\n**检验Hadoop安装**\n\n`hadoop version`\n\n**测试基本功能**\n\n编译MapReduce实例，提供了若干功能。\n\n`hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar`\n\n使用MapReduce计算单词个数\n\n`hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar wordcount input output`\n\n# 模拟分布式模式安装Hadoop\n\n在伪分布式模式下安装Hadoop\n\n## 设置Hadoop\n\n```shell\nexport HADOOP_HOME=/usr/local/hadoop \nexport HADOOP_MAPRED_HOME=$HADOOP_HOME \nexport HADOOP_COMMON_HOME=$HADOOP_HOME \nexport HADOOP_HDFS_HOME=$HADOOP_HOME \nexport YARN_HOME=$HADOOP_HOME \nexport HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native \nexport PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/bin \nexport HADOOP_INSTALL=$HADOOP_HOME\n```\n\n提交\n\n`source ~/.bashrc`\n\n## Hadoop配置  TODO 配置文件的意义\n\ncore-site.xml\n\n```xml\n<configuration>\n\n   <property>\n      <name>fs.default.name </name>\n      <value> hdfs://localhost:9000 </value> \n   </property>\n \n</configuration>\n```\n\nhdfs-site.xml\n\n```xml\n<configuration>\n\n   <property>\n      <name>dfs.replication</name>\n      <value>1</value>\n   </property>\n    \n   <property>\n      <name>dfs.name.dir</name>\n      <value>file:///home/hadoop/hadoopinfra/hdfs/namenode </value>\n   </property>\n    \n   <property>\n      <name>dfs.data.dir</name> \n      <value>file:///home/hadoop/hadoopinfra/hdfs/datanode </value> \n   </property>\n       \n</configuration>\n```\n\nyarn-site.xml\n\n```xml\n<configuration>\n \n   <property>\n      <name>yarn.nodemanager.aux-services</name>\n      <value>mapreduce_shuffle</value> \n   </property>\n  \n</configuration>\n```\n\nmapred-site.xml\n\n```xml\n<configuration>\n \n   <property> \n      <name>mapreduce.framework.name</name>\n      <value>yarn</value>\n   </property>\n   \n</configuration>\n```\n\n## 验证安装  TODO 指令含义\n\n1. 名称节点设置\n\n`hdfs name -format`\n\n2. 验证DFS\n\n`start-dfs.sh`\n\n3. 验证Yarn\n\n`start-yarn.sh`\n\n**注意**\n\n1. 报错`ERROR: Attempting to operate on hdfs namenode as root`\n\n在`start-dfs.sh`, `stop-dfs.sh`文件添加\n\n```shell\nHDFS_DATANODE_USER=root\nHADOOP_SECURE_DN_USER=hdfs\nHDFS_NAMENODE_USER=root\nHDFS_SECONDARYNAMENODE_USER=root\n```\n\n在`start-yarn.sh`, `stop-yarn.sh`文件添加\n\n```shell\nYARN_RESOURCEMANAGER_USER=root\nHADOOP_SECURE_DN_USER=yarn\nYARN_NODEMANAGER_USER=root\n```\n\n2. 报错`Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).`\n\n```shell\nssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub root@Ali-Edlison-Server01\n```\n\n## 浏览器访问Hadoop  TODO 端口对应含义\n\n访问集群信息\n\n`http://ip:8042/`\n\n\n\n\n\n\n\n----\n\nReferences\n\nhttps://www.yiibai.com/hadoop/hadoop_enviornment_setup.html\n\nhttps://www.cnblogs.com/woofwoof/p/10024104.html\n\n","source":"_posts/hadoop/start.md","raw":"---\ntitle: Hadoop - start\ncategories:\n- Notebook\ntags:\n- hadoop\n---\n\n# QuikStart\n\n## 安装Hadoop\n\n`wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz`\n\n# Hadoop操作模式\n\n可以选择Hadoop集群以以下三个支持模式之一：\n\n- 独立/单机模式：默认情况下，被配置在一个独立的模式中运行Java程序。\n- 模拟分布式模式：这是单台机器的分布式模拟。Hadoop守护每个进程，如hdfs, yarn, MapReduce等，都将作为一个独立的Java程序运行，对开发有利。\n- 完全分布式模式：这种模式时完全分布式的最小两台或多台计算机的集群。\n\n# 在单机模式下安装Hadoop\n\n独立/单机模式适合开发期间运行MapReduce程序，容易进行测试和调试。\n\n**设置`JAVA_HOME`变量**\n\n`export JAVA_HOME=pwd`\n\n**设置Java环境变量**\n\n`export PATH=$PATH:$JAVA_HOME/bin`\n\n将Hadoop添加到环境变量\n\n`export PATH=$PATH:/home/hadoop/bin`\n\n**检验Hadoop安装**\n\n`hadoop version`\n\n**测试基本功能**\n\n编译MapReduce实例，提供了若干功能。\n\n`hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar`\n\n使用MapReduce计算单词个数\n\n`hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar wordcount input output`\n\n# 模拟分布式模式安装Hadoop\n\n在伪分布式模式下安装Hadoop\n\n## 设置Hadoop\n\n```shell\nexport HADOOP_HOME=/usr/local/hadoop \nexport HADOOP_MAPRED_HOME=$HADOOP_HOME \nexport HADOOP_COMMON_HOME=$HADOOP_HOME \nexport HADOOP_HDFS_HOME=$HADOOP_HOME \nexport YARN_HOME=$HADOOP_HOME \nexport HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native \nexport PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/bin \nexport HADOOP_INSTALL=$HADOOP_HOME\n```\n\n提交\n\n`source ~/.bashrc`\n\n## Hadoop配置  TODO 配置文件的意义\n\ncore-site.xml\n\n```xml\n<configuration>\n\n   <property>\n      <name>fs.default.name </name>\n      <value> hdfs://localhost:9000 </value> \n   </property>\n \n</configuration>\n```\n\nhdfs-site.xml\n\n```xml\n<configuration>\n\n   <property>\n      <name>dfs.replication</name>\n      <value>1</value>\n   </property>\n    \n   <property>\n      <name>dfs.name.dir</name>\n      <value>file:///home/hadoop/hadoopinfra/hdfs/namenode </value>\n   </property>\n    \n   <property>\n      <name>dfs.data.dir</name> \n      <value>file:///home/hadoop/hadoopinfra/hdfs/datanode </value> \n   </property>\n       \n</configuration>\n```\n\nyarn-site.xml\n\n```xml\n<configuration>\n \n   <property>\n      <name>yarn.nodemanager.aux-services</name>\n      <value>mapreduce_shuffle</value> \n   </property>\n  \n</configuration>\n```\n\nmapred-site.xml\n\n```xml\n<configuration>\n \n   <property> \n      <name>mapreduce.framework.name</name>\n      <value>yarn</value>\n   </property>\n   \n</configuration>\n```\n\n## 验证安装  TODO 指令含义\n\n1. 名称节点设置\n\n`hdfs name -format`\n\n2. 验证DFS\n\n`start-dfs.sh`\n\n3. 验证Yarn\n\n`start-yarn.sh`\n\n**注意**\n\n1. 报错`ERROR: Attempting to operate on hdfs namenode as root`\n\n在`start-dfs.sh`, `stop-dfs.sh`文件添加\n\n```shell\nHDFS_DATANODE_USER=root\nHADOOP_SECURE_DN_USER=hdfs\nHDFS_NAMENODE_USER=root\nHDFS_SECONDARYNAMENODE_USER=root\n```\n\n在`start-yarn.sh`, `stop-yarn.sh`文件添加\n\n```shell\nYARN_RESOURCEMANAGER_USER=root\nHADOOP_SECURE_DN_USER=yarn\nYARN_NODEMANAGER_USER=root\n```\n\n2. 报错`Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).`\n\n```shell\nssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub root@Ali-Edlison-Server01\n```\n\n## 浏览器访问Hadoop  TODO 端口对应含义\n\n访问集群信息\n\n`http://ip:8042/`\n\n\n\n\n\n\n\n----\n\nReferences\n\nhttps://www.yiibai.com/hadoop/hadoop_enviornment_setup.html\n\nhttps://www.cnblogs.com/woofwoof/p/10024104.html\n\n","slug":"hadoop/start","published":1,"date":"2021-01-27T03:29:44.888Z","updated":"2021-01-27T10:20:29.762Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yk002s018o2grb69ar","content":"<h1 id=\"QuikStart\"><a href=\"#QuikStart\" class=\"headerlink\" title=\"QuikStart\"></a>QuikStart</h1><h2 id=\"安装Hadoop\"><a href=\"#安装Hadoop\" class=\"headerlink\" title=\"安装Hadoop\"></a>安装Hadoop</h2><p><code>wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz</code></p>\n<h1 id=\"Hadoop操作模式\"><a href=\"#Hadoop操作模式\" class=\"headerlink\" title=\"Hadoop操作模式\"></a>Hadoop操作模式</h1><p>可以选择Hadoop集群以以下三个支持模式之一：</p>\n<ul>\n<li>独立/单机模式：默认情况下，被配置在一个独立的模式中运行Java程序。</li>\n<li>模拟分布式模式：这是单台机器的分布式模拟。Hadoop守护每个进程，如hdfs, yarn, MapReduce等，都将作为一个独立的Java程序运行，对开发有利。</li>\n<li>完全分布式模式：这种模式时完全分布式的最小两台或多台计算机的集群。</li>\n</ul>\n<h1 id=\"在单机模式下安装Hadoop\"><a href=\"#在单机模式下安装Hadoop\" class=\"headerlink\" title=\"在单机模式下安装Hadoop\"></a>在单机模式下安装Hadoop</h1><p>独立/单机模式适合开发期间运行MapReduce程序，容易进行测试和调试。</p>\n<p><strong>设置<code>JAVA_HOME</code>变量</strong></p>\n<p><code>export JAVA_HOME=pwd</code></p>\n<p><strong>设置Java环境变量</strong></p>\n<p><code>export PATH=$PATH:$JAVA_HOME/bin</code></p>\n<p>将Hadoop添加到环境变量</p>\n<p><code>export PATH=$PATH:/home/hadoop/bin</code></p>\n<p><strong>检验Hadoop安装</strong></p>\n<p><code>hadoop version</code></p>\n<p><strong>测试基本功能</strong></p>\n<p>编译MapReduce实例，提供了若干功能。</p>\n<p><code>hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar</code></p>\n<p>使用MapReduce计算单词个数</p>\n<p><code>hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar wordcount input output</code></p>\n<h1 id=\"模拟分布式模式安装Hadoop\"><a href=\"#模拟分布式模式安装Hadoop\" class=\"headerlink\" title=\"模拟分布式模式安装Hadoop\"></a>模拟分布式模式安装Hadoop</h1><p>在伪分布式模式下安装Hadoop</p>\n<h2 id=\"设置Hadoop\"><a href=\"#设置Hadoop\" class=\"headerlink\" title=\"设置Hadoop\"></a>设置Hadoop</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export HADOOP_HOME=/usr/local/hadoop </span><br><span class=\"line\">export HADOOP_MAPRED_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_COMMON_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_HDFS_HOME=$HADOOP_HOME </span><br><span class=\"line\">export YARN_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native </span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/bin </span><br><span class=\"line\">export HADOOP_INSTALL=$HADOOP_HOME</span><br></pre></td></tr></table></figure>\n\n<p>提交</p>\n<p><code>source ~/.bashrc</code></p>\n<h2 id=\"Hadoop配置-TODO-配置文件的意义\"><a href=\"#Hadoop配置-TODO-配置文件的意义\" class=\"headerlink\" title=\"Hadoop配置  TODO 配置文件的意义\"></a>Hadoop配置  TODO 配置文件的意义</h2><p>core-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.default.name <span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span> hdfs://localhost:9000 <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>hdfs-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.name.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/hadoopinfra/hdfs/namenode <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.data.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/hadoopinfra/hdfs/datanode <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">       </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>yarn-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>mapred-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">   </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"验证安装-TODO-指令含义\"><a href=\"#验证安装-TODO-指令含义\" class=\"headerlink\" title=\"验证安装  TODO 指令含义\"></a>验证安装  TODO 指令含义</h2><ol>\n<li>名称节点设置</li>\n</ol>\n<p><code>hdfs name -format</code></p>\n<ol start=\"2\">\n<li>验证DFS</li>\n</ol>\n<p><code>start-dfs.sh</code></p>\n<ol start=\"3\">\n<li>验证Yarn</li>\n</ol>\n<p><code>start-yarn.sh</code></p>\n<p><strong>注意</strong></p>\n<ol>\n<li>报错<code>ERROR: Attempting to operate on hdfs namenode as root</code></li>\n</ol>\n<p>在<code>start-dfs.sh</code>, <code>stop-dfs.sh</code>文件添加</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HDFS_DATANODE_USER=root</span><br><span class=\"line\">HADOOP_SECURE_DN_USER=hdfs</span><br><span class=\"line\">HDFS_NAMENODE_USER=root</span><br><span class=\"line\">HDFS_SECONDARYNAMENODE_USER=root</span><br></pre></td></tr></table></figure>\n\n<p>在<code>start-yarn.sh</code>, <code>stop-yarn.sh</code>文件添加</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\">HADOOP_SECURE_DN_USER=yarn</span><br><span class=\"line\">YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>报错<code>Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).</code></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">ssh-copy-id -i ~/.ssh/id_rsa.pub root@Ali-Edlison-Server01</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"浏览器访问Hadoop-TODO-端口对应含义\"><a href=\"#浏览器访问Hadoop-TODO-端口对应含义\" class=\"headerlink\" title=\"浏览器访问Hadoop  TODO 端口对应含义\"></a>浏览器访问Hadoop  TODO 端口对应含义</h2><p>访问集群信息</p>\n<p><code>http://ip:8042/</code></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueWlpYmFpLmNvbS9oYWRvb3AvaGFkb29wX2Vudmlvcm5tZW50X3NldHVwLmh0bWw=\">https://www.yiibai.com/hadoop/hadoop_enviornment_setup.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd29vZndvb2YvcC8xMDAyNDEwNC5odG1s\">https://www.cnblogs.com/woofwoof/p/10024104.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"QuikStart\"><a href=\"#QuikStart\" class=\"headerlink\" title=\"QuikStart\"></a>QuikStart</h1><h2 id=\"安装Hadoop\"><a href=\"#安装Hadoop\" class=\"headerlink\" title=\"安装Hadoop\"></a>安装Hadoop</h2><p><code>wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz</code></p>\n<h1 id=\"Hadoop操作模式\"><a href=\"#Hadoop操作模式\" class=\"headerlink\" title=\"Hadoop操作模式\"></a>Hadoop操作模式</h1><p>可以选择Hadoop集群以以下三个支持模式之一：</p>\n<ul>\n<li>独立/单机模式：默认情况下，被配置在一个独立的模式中运行Java程序。</li>\n<li>模拟分布式模式：这是单台机器的分布式模拟。Hadoop守护每个进程，如hdfs, yarn, MapReduce等，都将作为一个独立的Java程序运行，对开发有利。</li>\n<li>完全分布式模式：这种模式时完全分布式的最小两台或多台计算机的集群。</li>\n</ul>\n<h1 id=\"在单机模式下安装Hadoop\"><a href=\"#在单机模式下安装Hadoop\" class=\"headerlink\" title=\"在单机模式下安装Hadoop\"></a>在单机模式下安装Hadoop</h1><p>独立/单机模式适合开发期间运行MapReduce程序，容易进行测试和调试。</p>\n<p><strong>设置<code>JAVA_HOME</code>变量</strong></p>\n<p><code>export JAVA_HOME=pwd</code></p>\n<p><strong>设置Java环境变量</strong></p>\n<p><code>export PATH=$PATH:$JAVA_HOME/bin</code></p>\n<p>将Hadoop添加到环境变量</p>\n<p><code>export PATH=$PATH:/home/hadoop/bin</code></p>\n<p><strong>检验Hadoop安装</strong></p>\n<p><code>hadoop version</code></p>\n<p><strong>测试基本功能</strong></p>\n<p>编译MapReduce实例，提供了若干功能。</p>\n<p><code>hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar</code></p>\n<p>使用MapReduce计算单词个数</p>\n<p><code>hadoop jar $HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar wordcount input output</code></p>\n<h1 id=\"模拟分布式模式安装Hadoop\"><a href=\"#模拟分布式模式安装Hadoop\" class=\"headerlink\" title=\"模拟分布式模式安装Hadoop\"></a>模拟分布式模式安装Hadoop</h1><p>在伪分布式模式下安装Hadoop</p>\n<h2 id=\"设置Hadoop\"><a href=\"#设置Hadoop\" class=\"headerlink\" title=\"设置Hadoop\"></a>设置Hadoop</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export HADOOP_HOME=/usr/local/hadoop </span><br><span class=\"line\">export HADOOP_MAPRED_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_COMMON_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_HDFS_HOME=$HADOOP_HOME </span><br><span class=\"line\">export YARN_HOME=$HADOOP_HOME </span><br><span class=\"line\">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native </span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/sbin:$HADOOP_HOME/bin </span><br><span class=\"line\">export HADOOP_INSTALL=$HADOOP_HOME</span><br></pre></td></tr></table></figure>\n\n<p>提交</p>\n<p><code>source ~/.bashrc</code></p>\n<h2 id=\"Hadoop配置-TODO-配置文件的意义\"><a href=\"#Hadoop配置-TODO-配置文件的意义\" class=\"headerlink\" title=\"Hadoop配置  TODO 配置文件的意义\"></a>Hadoop配置  TODO 配置文件的意义</h2><p>core-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.default.name <span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span> hdfs://localhost:9000 <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>hdfs-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.name.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/hadoopinfra/hdfs/namenode <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.data.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/hadoopinfra/hdfs/datanode <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">       </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>yarn-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>mapred-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span> </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">   </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"验证安装-TODO-指令含义\"><a href=\"#验证安装-TODO-指令含义\" class=\"headerlink\" title=\"验证安装  TODO 指令含义\"></a>验证安装  TODO 指令含义</h2><ol>\n<li>名称节点设置</li>\n</ol>\n<p><code>hdfs name -format</code></p>\n<ol start=\"2\">\n<li>验证DFS</li>\n</ol>\n<p><code>start-dfs.sh</code></p>\n<ol start=\"3\">\n<li>验证Yarn</li>\n</ol>\n<p><code>start-yarn.sh</code></p>\n<p><strong>注意</strong></p>\n<ol>\n<li>报错<code>ERROR: Attempting to operate on hdfs namenode as root</code></li>\n</ol>\n<p>在<code>start-dfs.sh</code>, <code>stop-dfs.sh</code>文件添加</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HDFS_DATANODE_USER=root</span><br><span class=\"line\">HADOOP_SECURE_DN_USER=hdfs</span><br><span class=\"line\">HDFS_NAMENODE_USER=root</span><br><span class=\"line\">HDFS_SECONDARYNAMENODE_USER=root</span><br></pre></td></tr></table></figure>\n\n<p>在<code>start-yarn.sh</code>, <code>stop-yarn.sh</code>文件添加</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\">HADOOP_SECURE_DN_USER=yarn</span><br><span class=\"line\">YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>报错<code>Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).</code></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">ssh-copy-id -i ~/.ssh/id_rsa.pub root@Ali-Edlison-Server01</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"浏览器访问Hadoop-TODO-端口对应含义\"><a href=\"#浏览器访问Hadoop-TODO-端口对应含义\" class=\"headerlink\" title=\"浏览器访问Hadoop  TODO 端口对应含义\"></a>浏览器访问Hadoop  TODO 端口对应含义</h2><p>访问集群信息</p>\n<p><code>http://ip:8042/</code></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueWlpYmFpLmNvbS9oYWRvb3AvaGFkb29wX2Vudmlvcm5tZW50X3NldHVwLmh0bWw=\">https://www.yiibai.com/hadoop/hadoop_enviornment_setup.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd29vZndvb2YvcC8xMDAyNDEwNC5odG1s\">https://www.cnblogs.com/woofwoof/p/10024104.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 买卖股票的最佳时机\n\n给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。\n\n设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。\n\n注意: 你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。\n\n**示例 1:**\n\n输入: [3,3,5,0,0,3,1,4]  \n输出: 6  \n解释: 在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。  \n     随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。\n\n**示例 2:**\n\n输入: [1,2,3,4,5]  \n输出: 4  \n解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。     \n     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。   \n     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。\n\n**示例 3:**\n\n输入: [7,6,4,3,1]  \n输出: 0  \n解释: 在这个情况下, 没有交易完成, 所以最大利润为 0。 \n\n动态规划  \n涉及到多个状态 首先画出状态图\n\n![Image](~/../../static/img/1.png)\n我们控制其中三个状态\n- 天数\n- 购买次数\n- 当前股票状态（0为未持有；1为持有）\n\n以无限次购买股票为例\n```java\n    int n = prices.length;\n    int dp_0 = 0;\n    int dp_1 = Integer.MIN_VALUE;\n\n    for (int i = 0; i < n; i++) {\n        dp_0 = Math.max(dp_0, dp_1 + prices[i]);\n        dp_1 = Math.max(dp_1, dp_0 - prices[i]);\n    }\n\n    return dp_0;\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了10.65%的用户\n内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.01%的用户\n本题可以不必使用DP以达到更快的速度\n*/\n```\n该例中由于无限次购买可以省略购买次数  \ndp_0的含义为：当前未持有股票  \n其只能由dp_0保持不变或dp_1出售得来选取最大值  \n\n其中base case（最简单的情况）的赋值：\n- 一开始未持有的状态为0；\n- 一开始持有的状态不可能存在故赋值最小值  \n\n在该题中\n```java\n    int n = prices.length;\n    int dp_2_0 = 0;\n    int dp_2_1 = Integer.MIN_VALUE;\n    int dp_1_0 = 0;\n    int dp_1_1 = Integer.MIN_VALUE;\n\n    for (int i = 0; i < n; i++) {\n        dp_1_1 = Math.max(dp_1_1, - prices[i]);     // !!! - prices[i]\n        dp_1_0 = Math.max(dp_1_0, dp_1_1 + prices[i]);\n        dp_2_1 = Math.max(dp_2_1, dp_1_0 - prices[i]);\n        dp_2_0 = Math.max(dp_2_0, dp_2_1 + prices[i]);\n        \n    }\n    \n    return dp_2_0;\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了82.59%的用户\n内存消耗 :41.9 MB, 在所有 Java 提交中击败了23.33%的用户\n*/\n````\n由于是第二次售出\n\n**注意**\n- **第一次直接持有的状态只能是购入股票故其只能从`(dp_1_1, - prices[i])`中选取最大值**\n- **第二次持有因为状态转移只能从第一次未持有转移来故其从`(dp_2_1, dp_1_0)`中选取最大值**\n\nbase case（最简单的情况）的赋值：  \n- 第一次未持有的状态金额肯定为0；  \n- 第一次持有的状态不存在故赋值`MIN_VALUE`；  \n- 第二次未持有的状态赋值0；  \n- 第二次持有的状态因为不可能直接持有故赋值`MIN_VALUE`  \n\n\n> Reference  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii\n","source":"_posts/leetcode/buystock.md","raw":"# 买卖股票的最佳时机\n\n给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。\n\n设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。\n\n注意: 你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。\n\n**示例 1:**\n\n输入: [3,3,5,0,0,3,1,4]  \n输出: 6  \n解释: 在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。  \n     随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。\n\n**示例 2:**\n\n输入: [1,2,3,4,5]  \n输出: 4  \n解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。     \n     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。   \n     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。\n\n**示例 3:**\n\n输入: [7,6,4,3,1]  \n输出: 0  \n解释: 在这个情况下, 没有交易完成, 所以最大利润为 0。 \n\n动态规划  \n涉及到多个状态 首先画出状态图\n\n![Image](~/../../static/img/1.png)\n我们控制其中三个状态\n- 天数\n- 购买次数\n- 当前股票状态（0为未持有；1为持有）\n\n以无限次购买股票为例\n```java\n    int n = prices.length;\n    int dp_0 = 0;\n    int dp_1 = Integer.MIN_VALUE;\n\n    for (int i = 0; i < n; i++) {\n        dp_0 = Math.max(dp_0, dp_1 + prices[i]);\n        dp_1 = Math.max(dp_1, dp_0 - prices[i]);\n    }\n\n    return dp_0;\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了10.65%的用户\n内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.01%的用户\n本题可以不必使用DP以达到更快的速度\n*/\n```\n该例中由于无限次购买可以省略购买次数  \ndp_0的含义为：当前未持有股票  \n其只能由dp_0保持不变或dp_1出售得来选取最大值  \n\n其中base case（最简单的情况）的赋值：\n- 一开始未持有的状态为0；\n- 一开始持有的状态不可能存在故赋值最小值  \n\n在该题中\n```java\n    int n = prices.length;\n    int dp_2_0 = 0;\n    int dp_2_1 = Integer.MIN_VALUE;\n    int dp_1_0 = 0;\n    int dp_1_1 = Integer.MIN_VALUE;\n\n    for (int i = 0; i < n; i++) {\n        dp_1_1 = Math.max(dp_1_1, - prices[i]);     // !!! - prices[i]\n        dp_1_0 = Math.max(dp_1_0, dp_1_1 + prices[i]);\n        dp_2_1 = Math.max(dp_2_1, dp_1_0 - prices[i]);\n        dp_2_0 = Math.max(dp_2_0, dp_2_1 + prices[i]);\n        \n    }\n    \n    return dp_2_0;\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了82.59%的用户\n内存消耗 :41.9 MB, 在所有 Java 提交中击败了23.33%的用户\n*/\n````\n由于是第二次售出\n\n**注意**\n- **第一次直接持有的状态只能是购入股票故其只能从`(dp_1_1, - prices[i])`中选取最大值**\n- **第二次持有因为状态转移只能从第一次未持有转移来故其从`(dp_2_1, dp_1_0)`中选取最大值**\n\nbase case（最简单的情况）的赋值：  \n- 第一次未持有的状态金额肯定为0；  \n- 第一次持有的状态不存在故赋值`MIN_VALUE`；  \n- 第二次未持有的状态赋值0；  \n- 第二次持有的状态因为不可能直接持有故赋值`MIN_VALUE`  \n\n\n> Reference  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii\n","slug":"leetcode/buystock","published":1,"date":"2020-03-06T13:56:34.203Z","updated":"2020-03-06T14:25:58.109Z","title":"leetcode/buystock","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yl002v018oa0827oq4","content":"<h1 id=\"买卖股票的最佳时机\"><a href=\"#买卖股票的最佳时机\" class=\"headerlink\" title=\"买卖股票的最佳时机\"></a>买卖股票的最佳时机</h1><p>给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。</p>\n<p>设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。</p>\n<p>注意: 你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</p>\n<p><strong>示例 1:</strong></p>\n<p>输入: [3,3,5,0,0,3,1,4]<br>输出: 6<br>解释: 在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。<br>     随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。</p>\n<p><strong>示例 2:</strong></p>\n<p>输入: [1,2,3,4,5]<br>输出: 4<br>解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。<br>     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。<br>     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。</p>\n<p><strong>示例 3:</strong></p>\n<p>输入: [7,6,4,3,1]<br>输出: 0<br>解释: 在这个情况下, 没有交易完成, 所以最大利润为 0。 </p>\n<p>动态规划<br>涉及到多个状态 首先画出状态图</p>\n<p><img src=\"~/../../static/img/1.png\" alt=\"Image\"><br>我们控制其中三个状态</p>\n<ul>\n<li>天数</li>\n<li>购买次数</li>\n<li>当前股票状态（0为未持有；1为持有）</li>\n</ul>\n<p>以无限次购买股票为例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">int</span> n = prices.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1 = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        dp_0 = Math.max(dp_0, dp_1 + prices[i]);</span><br><span class=\"line\">        dp_1 = Math.max(dp_1, dp_0 - prices[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> dp_0;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了10.65%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.01%的用户</span></span><br><span class=\"line\"><span class=\"comment\">本题可以不必使用DP以达到更快的速度</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>该例中由于无限次购买可以省略购买次数<br>dp_0的含义为：当前未持有股票<br>其只能由dp_0保持不变或dp_1出售得来选取最大值  </p>\n<p>其中base case（最简单的情况）的赋值：</p>\n<ul>\n<li>一开始未持有的状态为0；</li>\n<li>一开始持有的状态不可能存在故赋值最小值  </li>\n</ul>\n<p>在该题中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">int</span> n = prices.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_2_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_2_1 = Integer.MIN_VALUE;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1_1 = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        dp_1_1 = Math.max(dp_1_1, - prices[i]);     <span class=\"comment\">// !!! - prices[i]</span></span><br><span class=\"line\">        dp_1_0 = Math.max(dp_1_0, dp_1_1 + prices[i]);</span><br><span class=\"line\">        dp_2_1 = Math.max(dp_2_1, dp_1_0 - prices[i]);</span><br><span class=\"line\">        dp_2_0 = Math.max(dp_2_0, dp_2_1 + prices[i]);</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> dp_2_0;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了82.59%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :41.9 MB, 在所有 Java 提交中击败了23.33%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">`</span><br></pre></td></tr></table></figure>\n<p>由于是第二次售出</p>\n<p><strong>注意</strong></p>\n<ul>\n<li><strong>第一次直接持有的状态只能是购入股票故其只能从<code>(dp_1_1, - prices[i])</code>中选取最大值</strong></li>\n<li><strong>第二次持有因为状态转移只能从第一次未持有转移来故其从<code>(dp_2_1, dp_1_0)</code>中选取最大值</strong></li>\n</ul>\n<p>base case（最简单的情况）的赋值：  </p>\n<ul>\n<li>第一次未持有的状态金额肯定为0；  </li>\n<li>第一次持有的状态不存在故赋值<code>MIN_VALUE</code>；  </li>\n<li>第二次未持有的状态赋值0；  </li>\n<li>第二次持有的状态因为不可能直接持有故赋值<code>MIN_VALUE</code>  </li>\n</ul>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paQ==\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii<i class=\"fa fa-external-link-alt\"></i></span><br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paWk=\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"买卖股票的最佳时机\"><a href=\"#买卖股票的最佳时机\" class=\"headerlink\" title=\"买卖股票的最佳时机\"></a>买卖股票的最佳时机</h1><p>给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。</p>\n<p>设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。</p>\n<p>注意: 你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</p>\n<p><strong>示例 1:</strong></p>\n<p>输入: [3,3,5,0,0,3,1,4]<br>输出: 6<br>解释: 在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。<br>     随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。</p>\n<p><strong>示例 2:</strong></p>\n<p>输入: [1,2,3,4,5]<br>输出: 4<br>解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。<br>     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。<br>     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。</p>\n<p><strong>示例 3:</strong></p>\n<p>输入: [7,6,4,3,1]<br>输出: 0<br>解释: 在这个情况下, 没有交易完成, 所以最大利润为 0。 </p>\n<p>动态规划<br>涉及到多个状态 首先画出状态图</p>\n<p><img src=\"~/../../static/img/1.png\" alt=\"Image\"><br>我们控制其中三个状态</p>\n<ul>\n<li>天数</li>\n<li>购买次数</li>\n<li>当前股票状态（0为未持有；1为持有）</li>\n</ul>\n<p>以无限次购买股票为例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">int</span> n = prices.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1 = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        dp_0 = Math.max(dp_0, dp_1 + prices[i]);</span><br><span class=\"line\">        dp_1 = Math.max(dp_1, dp_0 - prices[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> dp_0;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了10.65%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.01%的用户</span></span><br><span class=\"line\"><span class=\"comment\">本题可以不必使用DP以达到更快的速度</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>该例中由于无限次购买可以省略购买次数<br>dp_0的含义为：当前未持有股票<br>其只能由dp_0保持不变或dp_1出售得来选取最大值  </p>\n<p>其中base case（最简单的情况）的赋值：</p>\n<ul>\n<li>一开始未持有的状态为0；</li>\n<li>一开始持有的状态不可能存在故赋值最小值  </li>\n</ul>\n<p>在该题中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"keyword\">int</span> n = prices.length;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_2_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_2_1 = Integer.MIN_VALUE;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1_0 = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> dp_1_1 = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) &#123;</span><br><span class=\"line\">        dp_1_1 = Math.max(dp_1_1, - prices[i]);     <span class=\"comment\">// !!! - prices[i]</span></span><br><span class=\"line\">        dp_1_0 = Math.max(dp_1_0, dp_1_1 + prices[i]);</span><br><span class=\"line\">        dp_2_1 = Math.max(dp_2_1, dp_1_0 - prices[i]);</span><br><span class=\"line\">        dp_2_0 = Math.max(dp_2_0, dp_2_1 + prices[i]);</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> dp_2_0;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了82.59%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :41.9 MB, 在所有 Java 提交中击败了23.33%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">`</span><br></pre></td></tr></table></figure>\n<p>由于是第二次售出</p>\n<p><strong>注意</strong></p>\n<ul>\n<li><strong>第一次直接持有的状态只能是购入股票故其只能从<code>(dp_1_1, - prices[i])</code>中选取最大值</strong></li>\n<li><strong>第二次持有因为状态转移只能从第一次未持有转移来故其从<code>(dp_2_1, dp_1_0)</code>中选取最大值</strong></li>\n</ul>\n<p>base case（最简单的情况）的赋值：  </p>\n<ul>\n<li>第一次未持有的状态金额肯定为0；  </li>\n<li>第一次持有的状态不存在故赋值<code>MIN_VALUE</code>；  </li>\n<li>第二次未持有的状态赋值0；  </li>\n<li>第二次持有的状态因为不可能直接持有故赋值<code>MIN_VALUE</code>  </li>\n</ul>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paQ==\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii<i class=\"fa fa-external-link-alt\"></i></span><br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paWk=\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 不同的二叉搜索树 II\n给定一个整数 n，生成所有由 1 ... n 为节点所组成的二叉搜索树。\n\n示例:\n\n输入: 3  \n输出:  \n[  \n  [1,null,3,2],  \n  [3,2,null,1],  \n  [3,1,null,null,2],  \n  [2,1,3],  \n  [1,null,2,null,3]  \n]  \n解释:  \n以上的输出对应以下 5 种不同结构的二叉搜索树：  \n\n   1         3     3      2      1\n    \\       /     /      / \\      \\\n     3     2     1      1   3      2\n    /     /       \\                 \\\n   2     1         2                 3\n   \n*Unsolved*\n```java\nclass Solution {\n    public List<TreeNode> generateTrees(int n) {\n\n        if (n == 0) return new ArrayList<>();\n        return helper(1, n);\n\n    }\n\n    private List<TreeNode> helper(int start, int end) {\n        List<TreeNode> res = new ArrayList<>();\n        if (start > end) {\n            res.add(null);\n            return res;\n        }\n        for (int val = start; val <= end; val++) {\n            List<TreeNode> left = helper(start, val - 1);\n            List<TreeNode> right = helper(val + 1, end);\n            for (TreeNode l : left) {\n                for (TreeNode r : right) {\n                    TreeNode root = new TreeNode(val);\n                    root.left = l;\n                    root.right = r;\n                    res.add(root);\n                }\n            }\n        }\n        return res;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/unique-binary-search-trees-ii","source":"_posts/leetcode/binarysearch.md","raw":"# 不同的二叉搜索树 II\n给定一个整数 n，生成所有由 1 ... n 为节点所组成的二叉搜索树。\n\n示例:\n\n输入: 3  \n输出:  \n[  \n  [1,null,3,2],  \n  [3,2,null,1],  \n  [3,1,null,null,2],  \n  [2,1,3],  \n  [1,null,2,null,3]  \n]  \n解释:  \n以上的输出对应以下 5 种不同结构的二叉搜索树：  \n\n   1         3     3      2      1\n    \\       /     /      / \\      \\\n     3     2     1      1   3      2\n    /     /       \\                 \\\n   2     1         2                 3\n   \n*Unsolved*\n```java\nclass Solution {\n    public List<TreeNode> generateTrees(int n) {\n\n        if (n == 0) return new ArrayList<>();\n        return helper(1, n);\n\n    }\n\n    private List<TreeNode> helper(int start, int end) {\n        List<TreeNode> res = new ArrayList<>();\n        if (start > end) {\n            res.add(null);\n            return res;\n        }\n        for (int val = start; val <= end; val++) {\n            List<TreeNode> left = helper(start, val - 1);\n            List<TreeNode> right = helper(val + 1, end);\n            for (TreeNode l : left) {\n                for (TreeNode r : right) {\n                    TreeNode root = new TreeNode(val);\n                    root.left = l;\n                    root.right = r;\n                    res.add(root);\n                }\n            }\n        }\n        return res;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/unique-binary-search-trees-ii","slug":"leetcode/binarysearch","published":1,"date":"2020-03-23T14:46:29.823Z","updated":"2020-03-23T14:49:47.423Z","title":"leetcode/binarysearch","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yl002x018o6ofsfgvb","content":"<h1 id=\"不同的二叉搜索树-II\"><a href=\"#不同的二叉搜索树-II\" class=\"headerlink\" title=\"不同的二叉搜索树 II\"></a>不同的二叉搜索树 II</h1><p>给定一个整数 n，生成所有由 1 … n 为节点所组成的二叉搜索树。</p>\n<p>示例:</p>\n<p>输入: 3<br>输出:<br>[<br>  [1,null,3,2],<br>  [3,2,null,1],<br>  [3,1,null,null,2],<br>  [2,1,3],<br>  [1,null,2,null,3]<br>]<br>解释:<br>以上的输出对应以下 5 种不同结构的二叉搜索树：  </p>\n<p>   1         3     3      2      1<br>    \\       /     /      / \\      <br>     3     2     1      1   3      2<br>    /     /       \\                 <br>   2     1         2                 3</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;TreeNode&gt; <span class=\"title\">generateTrees</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> helper(<span class=\"number\">1</span>, n);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> List&lt;TreeNode&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> end)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;TreeNode&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (start &gt; end) &#123;</span><br><span class=\"line\">            res.add(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> val = start; val &lt;= end; val++) &#123;</span><br><span class=\"line\">            List&lt;TreeNode&gt; left = helper(start, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">            List&lt;TreeNode&gt; right = helper(val + <span class=\"number\">1</span>, end);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (TreeNode l : left) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (TreeNode r : right) &#123;</span><br><span class=\"line\">                    TreeNode root = <span class=\"keyword\">new</span> TreeNode(val);</span><br><span class=\"line\">                    root.left = l;</span><br><span class=\"line\">                    root.right = r;</span><br><span class=\"line\">                    res.add(root);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdW5pcXVlLWJpbmFyeS1zZWFyY2gtdHJlZXMtaWk=\">https://leetcode-cn.com/problems/unique-binary-search-trees-ii<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"不同的二叉搜索树-II\"><a href=\"#不同的二叉搜索树-II\" class=\"headerlink\" title=\"不同的二叉搜索树 II\"></a>不同的二叉搜索树 II</h1><p>给定一个整数 n，生成所有由 1 … n 为节点所组成的二叉搜索树。</p>\n<p>示例:</p>\n<p>输入: 3<br>输出:<br>[<br>  [1,null,3,2],<br>  [3,2,null,1],<br>  [3,1,null,null,2],<br>  [2,1,3],<br>  [1,null,2,null,3]<br>]<br>解释:<br>以上的输出对应以下 5 种不同结构的二叉搜索树：  </p>\n<p>   1         3     3      2      1<br>    \\       /     /      / \\      <br>     3     2     1      1   3      2<br>    /     /       \\                 <br>   2     1         2                 3</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;TreeNode&gt; <span class=\"title\">generateTrees</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> helper(<span class=\"number\">1</span>, n);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> List&lt;TreeNode&gt; <span class=\"title\">helper</span><span class=\"params\">(<span class=\"keyword\">int</span> start, <span class=\"keyword\">int</span> end)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;TreeNode&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (start &gt; end) &#123;</span><br><span class=\"line\">            res.add(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> val = start; val &lt;= end; val++) &#123;</span><br><span class=\"line\">            List&lt;TreeNode&gt; left = helper(start, val - <span class=\"number\">1</span>);</span><br><span class=\"line\">            List&lt;TreeNode&gt; right = helper(val + <span class=\"number\">1</span>, end);</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (TreeNode l : left) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (TreeNode r : right) &#123;</span><br><span class=\"line\">                    TreeNode root = <span class=\"keyword\">new</span> TreeNode(val);</span><br><span class=\"line\">                    root.left = l;</span><br><span class=\"line\">                    root.right = r;</span><br><span class=\"line\">                    res.add(root);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdW5pcXVlLWJpbmFyeS1zZWFyY2gtdHJlZXMtaWk=\">https://leetcode-cn.com/problems/unique-binary-search-trees-ii<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 两数相加\n\n给出两个 非空 的链表用来表示两个非负的整数。其中，它们各自的位数是按照 逆序 的方式存储的，并且它们的每个节点只能存储 一位 数字。\n\n如果，我们将这两个数相加起来，则会返回一个新的链表来表示它们的和。\n\n您可以假设除了数字 0 之外，这两个数都不会以 0 开头。\n\n**示例：**\n\n输入：(2 -> 4 -> 3) + (5 -> 6 -> 4)\n输出：7 -> 0 -> 8\n原因：342 + 465 = 807\n\n```java\nclass Solution {\n    public ListNode addTwoNumbers(ListNode l1, ListNode l2) {\n        \n        ListNode head = new ListNode(0);\n        ListNode p = head;\n        ListNode pre = p;\n        int temp;\n\n\n        while (l1.next != null && l2.next != null) {\n            temp = l1.val + l2.val;\n            if (p.val + temp < 10) {\n                p.val += temp;\n                p.next = new ListNode(0);\n                p = p.next; l1 = l1.next; l2 = l2.next;\n            } else {\n                p.val = (p.val + temp) % 10;\n                p.next = new ListNode(1);\n                p = p.next; l1 = l1.next; l2 = l2.next;\n            }\n        }\n\n        temp = l1.val + l2.val;\n        if (p.val + temp < 10) {\n            p.val += temp;\n            p.next = new ListNode(0);\n            pre = p;\n            p = p.next;\n        } else {\n            p.val = (p.val + temp) % 10;\n            p.next = new ListNode(1);\n            p = p.next;\n        }\n\n        while (l1.next != null) {\n            l1 = l1.next;\n            if (p.val + l1.val < 10) {\n                p.val += l1.val;\n                p.next = new ListNode(0);\n                pre = p;\n                p = p.next;\n            } else {\n                p.val = (p.val + l1.val) % 10;\n                p.next = new ListNode(1);\n                p = p.next;\n            }\n        }\n\n        while (l2.next != null) {\n            l2 = l2.next;\n            if (p.val + l2.val < 10) {\n                p.val += l2.val;\n                p.next = new ListNode(0);\n                pre = p;\n                p = p.next;\n            } else {\n                p.val = (p.val + l2.val) % 10;\n                p.next = new ListNode(1);\n                p = p.next;\n            }\n        }\n\n        if (p.val == 0) {\n            pre.next = null;\n        }\n\n        return head;\n    }\n}\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了39.78%的用户\n内存消耗 :41.1 MB, 在所有 Java 提交中击败了92.22%的用户\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/add-two-numbers\n","source":"_posts/leetcode/addtwolist.md","raw":"# 两数相加\n\n给出两个 非空 的链表用来表示两个非负的整数。其中，它们各自的位数是按照 逆序 的方式存储的，并且它们的每个节点只能存储 一位 数字。\n\n如果，我们将这两个数相加起来，则会返回一个新的链表来表示它们的和。\n\n您可以假设除了数字 0 之外，这两个数都不会以 0 开头。\n\n**示例：**\n\n输入：(2 -> 4 -> 3) + (5 -> 6 -> 4)\n输出：7 -> 0 -> 8\n原因：342 + 465 = 807\n\n```java\nclass Solution {\n    public ListNode addTwoNumbers(ListNode l1, ListNode l2) {\n        \n        ListNode head = new ListNode(0);\n        ListNode p = head;\n        ListNode pre = p;\n        int temp;\n\n\n        while (l1.next != null && l2.next != null) {\n            temp = l1.val + l2.val;\n            if (p.val + temp < 10) {\n                p.val += temp;\n                p.next = new ListNode(0);\n                p = p.next; l1 = l1.next; l2 = l2.next;\n            } else {\n                p.val = (p.val + temp) % 10;\n                p.next = new ListNode(1);\n                p = p.next; l1 = l1.next; l2 = l2.next;\n            }\n        }\n\n        temp = l1.val + l2.val;\n        if (p.val + temp < 10) {\n            p.val += temp;\n            p.next = new ListNode(0);\n            pre = p;\n            p = p.next;\n        } else {\n            p.val = (p.val + temp) % 10;\n            p.next = new ListNode(1);\n            p = p.next;\n        }\n\n        while (l1.next != null) {\n            l1 = l1.next;\n            if (p.val + l1.val < 10) {\n                p.val += l1.val;\n                p.next = new ListNode(0);\n                pre = p;\n                p = p.next;\n            } else {\n                p.val = (p.val + l1.val) % 10;\n                p.next = new ListNode(1);\n                p = p.next;\n            }\n        }\n\n        while (l2.next != null) {\n            l2 = l2.next;\n            if (p.val + l2.val < 10) {\n                p.val += l2.val;\n                p.next = new ListNode(0);\n                pre = p;\n                p = p.next;\n            } else {\n                p.val = (p.val + l2.val) % 10;\n                p.next = new ListNode(1);\n                p = p.next;\n            }\n        }\n\n        if (p.val == 0) {\n            pre.next = null;\n        }\n\n        return head;\n    }\n}\n\n/**\n执行用时 :3 ms, 在所有 Java 提交中击败了39.78%的用户\n内存消耗 :41.1 MB, 在所有 Java 提交中击败了92.22%的用户\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/add-two-numbers\n","slug":"leetcode/addtwolist","published":1,"date":"2020-03-10T14:29:31.892Z","updated":"2020-03-10T14:34:50.332Z","title":"leetcode/addtwolist","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97ym0030018ognfu2lq1","content":"<h1 id=\"两数相加\"><a href=\"#两数相加\" class=\"headerlink\" title=\"两数相加\"></a>两数相加</h1><p>给出两个 非空 的链表用来表示两个非负的整数。其中，它们各自的位数是按照 逆序 的方式存储的，并且它们的每个节点只能存储 一位 数字。</p>\n<p>如果，我们将这两个数相加起来，则会返回一个新的链表来表示它们的和。</p>\n<p>您可以假设除了数字 0 之外，这两个数都不会以 0 开头。</p>\n<p><strong>示例：</strong></p>\n<p>输入：(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>输出：7 -&gt; 0 -&gt; 8<br>原因：342 + 465 = 807</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">addTwoNumbers</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        ListNode head = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">        ListNode p = head;</span><br><span class=\"line\">        ListNode pre = p;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span> &amp;&amp; l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp = l1.val + l2.val;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + temp &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += temp;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                p = p.next; l1 = l1.next; l2 = l2.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + temp) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next; l1 = l1.next; l2 = l2.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        temp = l1.val + l2.val;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val + temp &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">            p.val += temp;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            pre = p;</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            p.val = (p.val + temp) % <span class=\"number\">10</span>;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + l1.val &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += l1.val;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                pre = p;</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + l1.val) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + l2.val &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += l2.val;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                pre = p;</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + l2.val) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            pre.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了39.78%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :41.1 MB, 在所有 Java 提交中击败了92.22%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYWRkLXR3by1udW1iZXJz\">https://leetcode-cn.com/problems/add-two-numbers<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"两数相加\"><a href=\"#两数相加\" class=\"headerlink\" title=\"两数相加\"></a>两数相加</h1><p>给出两个 非空 的链表用来表示两个非负的整数。其中，它们各自的位数是按照 逆序 的方式存储的，并且它们的每个节点只能存储 一位 数字。</p>\n<p>如果，我们将这两个数相加起来，则会返回一个新的链表来表示它们的和。</p>\n<p>您可以假设除了数字 0 之外，这两个数都不会以 0 开头。</p>\n<p><strong>示例：</strong></p>\n<p>输入：(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>输出：7 -&gt; 0 -&gt; 8<br>原因：342 + 465 = 807</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">addTwoNumbers</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        ListNode head = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">        ListNode p = head;</span><br><span class=\"line\">        ListNode pre = p;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span> &amp;&amp; l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp = l1.val + l2.val;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + temp &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += temp;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                p = p.next; l1 = l1.next; l2 = l2.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + temp) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next; l1 = l1.next; l2 = l2.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        temp = l1.val + l2.val;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val + temp &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">            p.val += temp;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            pre = p;</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            p.val = (p.val + temp) % <span class=\"number\">10</span>;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + l1.val &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += l1.val;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                pre = p;</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + l1.val) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (p.val + l2.val &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                p.val += l2.val;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">                pre = p;</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                p.val = (p.val + l2.val) % <span class=\"number\">10</span>;</span><br><span class=\"line\">                p.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">1</span>);</span><br><span class=\"line\">                p = p.next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            pre.next = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :3 ms, 在所有 Java 提交中击败了39.78%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :41.1 MB, 在所有 Java 提交中击败了92.22%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYWRkLXR3by1udW1iZXJz\">https://leetcode-cn.com/problems/add-two-numbers<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Best Time to Buy and Sell Stock II\nSay you have an array for which the ith element is the price of a given stock on day i.\n\nDesign an algorithm to find the maximum profit. You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times).\n\nNote: You may not engage in multiple transactions at the same time (i.e., you must sell the stock before you buy again).\n\nExample 1:\n\nInput: [7,1,5,3,6,4]  \nOutput: 7  \nExplanation: Buy on day 2 (price = 1) and sell on day 3 (price = 5), profit = 5-1 = 4.  \n             Then buy on day 4 (price = 3) and sell on day 5 (price = 6), profit = 6-3 = 3.\nExample 2:  \n\nInput: [1,2,3,4,5]  \nOutput: 4  \nExplanation: Buy on day 1 (price = 1) and sell on day 5 (price = 5), profit = 5-1 = 4.  \n             Note that you cannot buy on day 1, buy on day 2 and sell them later, as you are  \n             engaging multiple transactions at the same time. You must sell before buying again.  \nExample 3:  \n\nInput: [7,6,4,3,1]  \nOutput: 0  \nExplanation: In this case, no transaction is done, i.e. max profit = 0.  \n\n```java\nclass Solution {\n    public int maxProfit(int[] prices) {\n        int[] dp = new int[2];\n\n        dp[1] = Integer.MIN_VALUE;\n\n        for (int price : prices) {\n            dp[0] = Math.max(dp[0], dp[1] + price);\n            dp[1] = Math.max(dp[1], dp[0] - price);\n        }\n        \n        return dp[0];\n    }\n\n/*\n执行用时 :2 ms, 在所有 Java 提交中击败了26.28%的用户\n内存消耗 :42.5 MB, 在所有 Java 提交中击败了5.04%的用户\n*/\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/submissions","source":"_posts/leetcode/buystockii.md","raw":"# Best Time to Buy and Sell Stock II\nSay you have an array for which the ith element is the price of a given stock on day i.\n\nDesign an algorithm to find the maximum profit. You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times).\n\nNote: You may not engage in multiple transactions at the same time (i.e., you must sell the stock before you buy again).\n\nExample 1:\n\nInput: [7,1,5,3,6,4]  \nOutput: 7  \nExplanation: Buy on day 2 (price = 1) and sell on day 3 (price = 5), profit = 5-1 = 4.  \n             Then buy on day 4 (price = 3) and sell on day 5 (price = 6), profit = 6-3 = 3.\nExample 2:  \n\nInput: [1,2,3,4,5]  \nOutput: 4  \nExplanation: Buy on day 1 (price = 1) and sell on day 5 (price = 5), profit = 5-1 = 4.  \n             Note that you cannot buy on day 1, buy on day 2 and sell them later, as you are  \n             engaging multiple transactions at the same time. You must sell before buying again.  \nExample 3:  \n\nInput: [7,6,4,3,1]  \nOutput: 0  \nExplanation: In this case, no transaction is done, i.e. max profit = 0.  \n\n```java\nclass Solution {\n    public int maxProfit(int[] prices) {\n        int[] dp = new int[2];\n\n        dp[1] = Integer.MIN_VALUE;\n\n        for (int price : prices) {\n            dp[0] = Math.max(dp[0], dp[1] + price);\n            dp[1] = Math.max(dp[1], dp[0] - price);\n        }\n        \n        return dp[0];\n    }\n\n/*\n执行用时 :2 ms, 在所有 Java 提交中击败了26.28%的用户\n内存消耗 :42.5 MB, 在所有 Java 提交中击败了5.04%的用户\n*/\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/submissions","slug":"leetcode/buystockii","published":1,"date":"2020-03-25T13:58:29.303Z","updated":"2020-03-25T14:00:44.970Z","title":"leetcode/buystockii","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yn0033018o3vtu0tew","content":"<h1 id=\"Best-Time-to-Buy-and-Sell-Stock-II\"><a href=\"#Best-Time-to-Buy-and-Sell-Stock-II\" class=\"headerlink\" title=\"Best Time to Buy and Sell Stock II\"></a>Best Time to Buy and Sell Stock II</h1><p>Say you have an array for which the ith element is the price of a given stock on day i.</p>\n<p>Design an algorithm to find the maximum profit. You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times).</p>\n<p>Note: You may not engage in multiple transactions at the same time (i.e., you must sell the stock before you buy again).</p>\n<p>Example 1:</p>\n<p>Input: [7,1,5,3,6,4]<br>Output: 7<br>Explanation: Buy on day 2 (price = 1) and sell on day 3 (price = 5), profit = 5-1 = 4.<br>             Then buy on day 4 (price = 3) and sell on day 5 (price = 6), profit = 6-3 = 3.<br>Example 2:  </p>\n<p>Input: [1,2,3,4,5]<br>Output: 4<br>Explanation: Buy on day 1 (price = 1) and sell on day 5 (price = 5), profit = 5-1 = 4.<br>             Note that you cannot buy on day 1, buy on day 2 and sell them later, as you are<br>             engaging multiple transactions at the same time. You must sell before buying again.<br>Example 3:  </p>\n<p>Input: [7,6,4,3,1]<br>Output: 0<br>Explanation: In this case, no transaction is done, i.e. max profit = 0.  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxProfit</span><span class=\"params\">(<span class=\"keyword\">int</span>[] prices)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">        dp[<span class=\"number\">1</span>] = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> price : prices) &#123;</span><br><span class=\"line\">            dp[<span class=\"number\">0</span>] = Math.max(dp[<span class=\"number\">0</span>], dp[<span class=\"number\">1</span>] + price);</span><br><span class=\"line\">            dp[<span class=\"number\">1</span>] = Math.max(dp[<span class=\"number\">1</span>], dp[<span class=\"number\">0</span>] - price);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :2 ms, 在所有 Java 提交中击败了26.28%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :42.5 MB, 在所有 Java 提交中击败了5.04%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paS9zdWJtaXNzaW9ucw==\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/submissions<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Best-Time-to-Buy-and-Sell-Stock-II\"><a href=\"#Best-Time-to-Buy-and-Sell-Stock-II\" class=\"headerlink\" title=\"Best Time to Buy and Sell Stock II\"></a>Best Time to Buy and Sell Stock II</h1><p>Say you have an array for which the ith element is the price of a given stock on day i.</p>\n<p>Design an algorithm to find the maximum profit. You may complete as many transactions as you like (i.e., buy one and sell one share of the stock multiple times).</p>\n<p>Note: You may not engage in multiple transactions at the same time (i.e., you must sell the stock before you buy again).</p>\n<p>Example 1:</p>\n<p>Input: [7,1,5,3,6,4]<br>Output: 7<br>Explanation: Buy on day 2 (price = 1) and sell on day 3 (price = 5), profit = 5-1 = 4.<br>             Then buy on day 4 (price = 3) and sell on day 5 (price = 6), profit = 6-3 = 3.<br>Example 2:  </p>\n<p>Input: [1,2,3,4,5]<br>Output: 4<br>Explanation: Buy on day 1 (price = 1) and sell on day 5 (price = 5), profit = 5-1 = 4.<br>             Note that you cannot buy on day 1, buy on day 2 and sell them later, as you are<br>             engaging multiple transactions at the same time. You must sell before buying again.<br>Example 3:  </p>\n<p>Input: [7,6,4,3,1]<br>Output: 0<br>Explanation: In this case, no transaction is done, i.e. max profit = 0.  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxProfit</span><span class=\"params\">(<span class=\"keyword\">int</span>[] prices)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">        dp[<span class=\"number\">1</span>] = Integer.MIN_VALUE;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> price : prices) &#123;</span><br><span class=\"line\">            dp[<span class=\"number\">0</span>] = Math.max(dp[<span class=\"number\">0</span>], dp[<span class=\"number\">1</span>] + price);</span><br><span class=\"line\">            dp[<span class=\"number\">1</span>] = Math.max(dp[<span class=\"number\">1</span>], dp[<span class=\"number\">0</span>] - price);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> dp[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :2 ms, 在所有 Java 提交中击败了26.28%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :42.5 MB, 在所有 Java 提交中击败了5.04%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmVzdC10aW1lLXRvLWJ1eS1hbmQtc2VsbC1zdG9jay1paS9zdWJtaXNzaW9ucw==\">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/submissions<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 删除排序链表中的重复元素\n\n给定一个排序链表，删除所有重复的元素，使得每个元素只出现一次。\n\n**示例 1:**\n\n输入: 1->1->2\n输出: 1->2\n示例 2:\n\n输入: 1->1->2->3->3\n输出: 1->2->3\n\n```java\nclass Solution {\n    public ListNode deleteDuplicates(ListNode head) {\n       ListNode temp = head;\n\n        if (head == null) {\n            return null;\n        }\n\n        while (temp.next != null) {\n            if (temp.val == temp.next.val) {\n                temp.next = temp.next.next;\n                continue;\n            }\n            temp = temp.next;\n        }\n\n        return head;\n    }\n}\n\n/**\n执行用时 :1 ms, 在所有 Java 提交中击败了94.59%的用户\n内存消耗 :39.3 MB, 在所有 Java 提交中击败了5.00%的用户\n*/\n```\nBase Case: `head==null`  \nBecause this is a sorted linked list, we just need to figure out whether the next node's values equals current node's value.  \n\n> Reference  \n> https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list\n","source":"_posts/leetcode/deletelistduplicates.md","raw":"# 删除排序链表中的重复元素\n\n给定一个排序链表，删除所有重复的元素，使得每个元素只出现一次。\n\n**示例 1:**\n\n输入: 1->1->2\n输出: 1->2\n示例 2:\n\n输入: 1->1->2->3->3\n输出: 1->2->3\n\n```java\nclass Solution {\n    public ListNode deleteDuplicates(ListNode head) {\n       ListNode temp = head;\n\n        if (head == null) {\n            return null;\n        }\n\n        while (temp.next != null) {\n            if (temp.val == temp.next.val) {\n                temp.next = temp.next.next;\n                continue;\n            }\n            temp = temp.next;\n        }\n\n        return head;\n    }\n}\n\n/**\n执行用时 :1 ms, 在所有 Java 提交中击败了94.59%的用户\n内存消耗 :39.3 MB, 在所有 Java 提交中击败了5.00%的用户\n*/\n```\nBase Case: `head==null`  \nBecause this is a sorted linked list, we just need to figure out whether the next node's values equals current node's value.  \n\n> Reference  \n> https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list\n","slug":"leetcode/deletelistduplicates","published":1,"date":"2020-03-08T05:20:52.297Z","updated":"2020-03-08T05:30:03.961Z","title":"leetcode/deletelistduplicates","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yo0037018ohuvs7e6n","content":"<h1 id=\"删除排序链表中的重复元素\"><a href=\"#删除排序链表中的重复元素\" class=\"headerlink\" title=\"删除排序链表中的重复元素\"></a>删除排序链表中的重复元素</h1><p>给定一个排序链表，删除所有重复的元素，使得每个元素只出现一次。</p>\n<p><strong>示例 1:</strong></p>\n<p>输入: 1-&gt;1-&gt;2<br>输出: 1-&gt;2<br>示例 2:</p>\n<p>输入: 1-&gt;1-&gt;2-&gt;3-&gt;3<br>输出: 1-&gt;2-&gt;3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">deleteDuplicates</span><span class=\"params\">(ListNode head)</span> </span>&#123;</span><br><span class=\"line\">       ListNode temp = head;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (head == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (temp.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (temp.val == temp.next.val) &#123;</span><br><span class=\"line\">                temp.next = temp.next.next;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了94.59%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :39.3 MB, 在所有 Java 提交中击败了5.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>Base Case: <code>head==null</code><br>Because this is a sorted linked list, we just need to figure out whether the next node’s values equals current node’s value.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWR1cGxpY2F0ZXMtZnJvbS1zb3J0ZWQtbGlzdA==\">https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"删除排序链表中的重复元素\"><a href=\"#删除排序链表中的重复元素\" class=\"headerlink\" title=\"删除排序链表中的重复元素\"></a>删除排序链表中的重复元素</h1><p>给定一个排序链表，删除所有重复的元素，使得每个元素只出现一次。</p>\n<p><strong>示例 1:</strong></p>\n<p>输入: 1-&gt;1-&gt;2<br>输出: 1-&gt;2<br>示例 2:</p>\n<p>输入: 1-&gt;1-&gt;2-&gt;3-&gt;3<br>输出: 1-&gt;2-&gt;3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">deleteDuplicates</span><span class=\"params\">(ListNode head)</span> </span>&#123;</span><br><span class=\"line\">       ListNode temp = head;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (head == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (temp.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (temp.val == temp.next.val) &#123;</span><br><span class=\"line\">                temp.next = temp.next.next;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了94.59%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :39.3 MB, 在所有 Java 提交中击败了5.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>Base Case: <code>head==null</code><br>Because this is a sorted linked list, we just need to figure out whether the next node’s values equals current node’s value.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWR1cGxpY2F0ZXMtZnJvbS1zb3J0ZWQtbGlzdA==\">https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Day02 - 删除排序数组的重复项\n\n给定一个排序数组，你需要在原地删除重复出现的元素，使得每个元素只出现一次，返回移除后数组的新长度。\n\n不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。\n\n**示例1** \n\n给定数组 nums = [1,1,2],函数应该返回新的长度 2, 并且原数组 nums 的前两个元素被修改为 1, 2。你不需要考虑数组中超出新长度后面的元素。`\n\n```java\nclass Solution {\n    public int removeDuplicates(int[] nums) {\n        int length;\n\n        if (nums.length == 0) {\n            return 0;\n        }\n\n        length = 1;\n\n        for (int i = 0, j = 1; i < nums.length; i++) {\n            while (j < nums.length && nums[j] == nums[i]) {\n                j++;\n            }\n\n            if (j >= nums.length)\n                break;\n\n            if (nums[j] != nums[i]) {\n                nums[i + 1] = nums[j];\n                length++;\n            }\n        }\n\n        return length;\n    }\n}\n\n/**\n执行用时 :1 ms, 在所有 Java 提交中击败了99.89%的用户\n*/\n```\n\n`length` 记录新数组长度，只需要在原数组中遍历一次与第 `i` 项比较若不同则将第 `j` 项赋给第 `i+1` 项。\n \n\n> Reference  \n> https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/\n\n","source":"_posts/leetcode/deleteduplicates.md","raw":"# Day02 - 删除排序数组的重复项\n\n给定一个排序数组，你需要在原地删除重复出现的元素，使得每个元素只出现一次，返回移除后数组的新长度。\n\n不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。\n\n**示例1** \n\n给定数组 nums = [1,1,2],函数应该返回新的长度 2, 并且原数组 nums 的前两个元素被修改为 1, 2。你不需要考虑数组中超出新长度后面的元素。`\n\n```java\nclass Solution {\n    public int removeDuplicates(int[] nums) {\n        int length;\n\n        if (nums.length == 0) {\n            return 0;\n        }\n\n        length = 1;\n\n        for (int i = 0, j = 1; i < nums.length; i++) {\n            while (j < nums.length && nums[j] == nums[i]) {\n                j++;\n            }\n\n            if (j >= nums.length)\n                break;\n\n            if (nums[j] != nums[i]) {\n                nums[i + 1] = nums[j];\n                length++;\n            }\n        }\n\n        return length;\n    }\n}\n\n/**\n执行用时 :1 ms, 在所有 Java 提交中击败了99.89%的用户\n*/\n```\n\n`length` 记录新数组长度，只需要在原数组中遍历一次与第 `i` 项比较若不同则将第 `j` 项赋给第 `i+1` 项。\n \n\n> Reference  \n> https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/\n\n","slug":"leetcode/deleteduplicates","published":1,"date":"2020-03-03T13:36:04.365Z","updated":"2020-03-05T14:10:52.263Z","title":"leetcode/deleteduplicates","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yo0039018o3ucu8gr6","content":"<h1 id=\"Day02-删除排序数组的重复项\"><a href=\"#Day02-删除排序数组的重复项\" class=\"headerlink\" title=\"Day02 - 删除排序数组的重复项\"></a>Day02 - 删除排序数组的重复项</h1><p>给定一个排序数组，你需要在原地删除重复出现的元素，使得每个元素只出现一次，返回移除后数组的新长度。</p>\n<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>\n<p><strong>示例1</strong> </p>\n<p>给定数组 nums = [1,1,2],函数应该返回新的长度 2, 并且原数组 nums 的前两个元素被修改为 1, 2。你不需要考虑数组中超出新长度后面的元素。`</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">removeDuplicates</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        length = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &lt; nums.length &amp;&amp; nums[j] == nums[i]) &#123;</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j &gt;= nums.length)</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[j] != nums[i]) &#123;</span><br><span class=\"line\">                nums[i + <span class=\"number\">1</span>] = nums[j];</span><br><span class=\"line\">                length++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> length;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了99.89%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><code>length</code> 记录新数组长度，只需要在原数组中遍历一次与第 <code>i</code> 项比较若不同则将第 <code>j</code> 项赋给第 <code>i+1</code> 项。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWR1cGxpY2F0ZXMtZnJvbS1zb3J0ZWQtYXJyYXkv\">https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Day02-删除排序数组的重复项\"><a href=\"#Day02-删除排序数组的重复项\" class=\"headerlink\" title=\"Day02 - 删除排序数组的重复项\"></a>Day02 - 删除排序数组的重复项</h1><p>给定一个排序数组，你需要在原地删除重复出现的元素，使得每个元素只出现一次，返回移除后数组的新长度。</p>\n<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>\n<p><strong>示例1</strong> </p>\n<p>给定数组 nums = [1,1,2],函数应该返回新的长度 2, 并且原数组 nums 的前两个元素被修改为 1, 2。你不需要考虑数组中超出新长度后面的元素。`</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">removeDuplicates</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        length = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &lt; nums.length &amp;&amp; nums[j] == nums[i]) &#123;</span><br><span class=\"line\">                j++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (j &gt;= nums.length)</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[j] != nums[i]) &#123;</span><br><span class=\"line\">                nums[i + <span class=\"number\">1</span>] = nums[j];</span><br><span class=\"line\">                length++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> length;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了99.89%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><code>length</code> 记录新数组长度，只需要在原数组中遍历一次与第 <code>i</code> 项比较若不同则将第 <code>j</code> 项赋给第 <code>i+1</code> 项。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWR1cGxpY2F0ZXMtZnJvbS1zb3J0ZWQtYXJyYXkv\">https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Assign Cookies\nAssume you are an awesome parent and want to give your children some cookies. But, you should give each child at most one cookie. Each child i has a greed factor gi, which is the minimum size of a cookie that the child will be content with; and each cookie j has a size sj. If sj >= gi, we can assign the cookie j to the child i, and the child i will be content. Your goal is to maximize the number of your content children and output the maximum number.\n\nNote:  \nYou may assume the greed factor is always positive.  \nYou cannot assign more than one cookie to one child.  \n\nExample 1:  \nInput: [1,2,3], [1,1]\n\nOutput: 1\n\nExplanation: You have 3 children and 2 cookies. The greed factors of 3 children are 1, 2, 3.   \nAnd even though you have 2 cookies, since their size is both 1, you could only make the child whose greed factor is 1 content.  \nYou need to output 1.  \nExample 2:  \nInput: [1,2], [1,2,3]\n\nOutput: 2\n\nExplanation: You have 2 children and 3 cookies. The greed factors of 2 children are 1, 2.   \nYou have 3 cookies and their sizes are big enough to gratify all of the children,   \nYou need to output 2.\n\n```java\nclass Solution {\n    public int findContentChildren(int[] g, int[] s) {\n        Arrays.sort(g);\n        Arrays.sort(s);\n        int res = 0;\n\n        for (int i = 0, j = 0; i < g.length; i++) {\n            while (j < s.length) {\n                if (s[j] >= g[i]) {\n                    res++;\n                    j++;\n                    break;\n                } else {\n                    j++;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n```\nFirst we need to sort the array.  \nThen we define 2 pointers to find satisfied results.\n\n> Reference  \n> https://leetcode-cn.com/problems/assign-cookies","source":"_posts/leetcode/delivercookies.md","raw":"# Assign Cookies\nAssume you are an awesome parent and want to give your children some cookies. But, you should give each child at most one cookie. Each child i has a greed factor gi, which is the minimum size of a cookie that the child will be content with; and each cookie j has a size sj. If sj >= gi, we can assign the cookie j to the child i, and the child i will be content. Your goal is to maximize the number of your content children and output the maximum number.\n\nNote:  \nYou may assume the greed factor is always positive.  \nYou cannot assign more than one cookie to one child.  \n\nExample 1:  \nInput: [1,2,3], [1,1]\n\nOutput: 1\n\nExplanation: You have 3 children and 2 cookies. The greed factors of 3 children are 1, 2, 3.   \nAnd even though you have 2 cookies, since their size is both 1, you could only make the child whose greed factor is 1 content.  \nYou need to output 1.  \nExample 2:  \nInput: [1,2], [1,2,3]\n\nOutput: 2\n\nExplanation: You have 2 children and 3 cookies. The greed factors of 2 children are 1, 2.   \nYou have 3 cookies and their sizes are big enough to gratify all of the children,   \nYou need to output 2.\n\n```java\nclass Solution {\n    public int findContentChildren(int[] g, int[] s) {\n        Arrays.sort(g);\n        Arrays.sort(s);\n        int res = 0;\n\n        for (int i = 0, j = 0; i < g.length; i++) {\n            while (j < s.length) {\n                if (s[j] >= g[i]) {\n                    res++;\n                    j++;\n                    break;\n                } else {\n                    j++;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n```\nFirst we need to sort the array.  \nThen we define 2 pointers to find satisfied results.\n\n> Reference  \n> https://leetcode-cn.com/problems/assign-cookies","slug":"leetcode/delivercookies","published":1,"date":"2020-03-27T11:22:16.200Z","updated":"2020-03-27T11:25:35.134Z","title":"leetcode/delivercookies","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yp003b018oea4x0yu0","content":"<h1 id=\"Assign-Cookies\"><a href=\"#Assign-Cookies\" class=\"headerlink\" title=\"Assign Cookies\"></a>Assign Cookies</h1><p>Assume you are an awesome parent and want to give your children some cookies. But, you should give each child at most one cookie. Each child i has a greed factor gi, which is the minimum size of a cookie that the child will be content with; and each cookie j has a size sj. If sj &gt;= gi, we can assign the cookie j to the child i, and the child i will be content. Your goal is to maximize the number of your content children and output the maximum number.</p>\n<p>Note:<br>You may assume the greed factor is always positive.<br>You cannot assign more than one cookie to one child.  </p>\n<p>Example 1:<br>Input: [1,2,3], [1,1]</p>\n<p>Output: 1</p>\n<p>Explanation: You have 3 children and 2 cookies. The greed factors of 3 children are 1, 2, 3.<br>And even though you have 2 cookies, since their size is both 1, you could only make the child whose greed factor is 1 content.<br>You need to output 1.<br>Example 2:<br>Input: [1,2], [1,2,3]</p>\n<p>Output: 2</p>\n<p>Explanation: You have 2 children and 3 cookies. The greed factors of 2 children are 1, 2.<br>You have 3 cookies and their sizes are big enough to gratify all of the children,<br>You need to output 2.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">findContentChildren</span><span class=\"params\">(<span class=\"keyword\">int</span>[] g, <span class=\"keyword\">int</span>[] s)</span> </span>&#123;</span><br><span class=\"line\">        Arrays.sort(g);</span><br><span class=\"line\">        Arrays.sort(s);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span>; i &lt; g.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &lt; s.length) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s[j] &gt;= g[i]) &#123;</span><br><span class=\"line\">                    res++;</span><br><span class=\"line\">                    j++;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    j++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>First we need to sort the array.<br>Then we define 2 pointers to find satisfied results.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYXNzaWduLWNvb2tpZXM=\">https://leetcode-cn.com/problems/assign-cookies<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Assign-Cookies\"><a href=\"#Assign-Cookies\" class=\"headerlink\" title=\"Assign Cookies\"></a>Assign Cookies</h1><p>Assume you are an awesome parent and want to give your children some cookies. But, you should give each child at most one cookie. Each child i has a greed factor gi, which is the minimum size of a cookie that the child will be content with; and each cookie j has a size sj. If sj &gt;= gi, we can assign the cookie j to the child i, and the child i will be content. Your goal is to maximize the number of your content children and output the maximum number.</p>\n<p>Note:<br>You may assume the greed factor is always positive.<br>You cannot assign more than one cookie to one child.  </p>\n<p>Example 1:<br>Input: [1,2,3], [1,1]</p>\n<p>Output: 1</p>\n<p>Explanation: You have 3 children and 2 cookies. The greed factors of 3 children are 1, 2, 3.<br>And even though you have 2 cookies, since their size is both 1, you could only make the child whose greed factor is 1 content.<br>You need to output 1.<br>Example 2:<br>Input: [1,2], [1,2,3]</p>\n<p>Output: 2</p>\n<p>Explanation: You have 2 children and 3 cookies. The greed factors of 2 children are 1, 2.<br>You have 3 cookies and their sizes are big enough to gratify all of the children,<br>You need to output 2.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">findContentChildren</span><span class=\"params\">(<span class=\"keyword\">int</span>[] g, <span class=\"keyword\">int</span>[] s)</span> </span>&#123;</span><br><span class=\"line\">        Arrays.sort(g);</span><br><span class=\"line\">        Arrays.sort(s);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span>; i &lt; g.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (j &lt; s.length) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s[j] &gt;= g[i]) &#123;</span><br><span class=\"line\">                    res++;</span><br><span class=\"line\">                    j++;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    j++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>First we need to sort the array.<br>Then we define 2 pointers to find satisfied results.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYXNzaWduLWNvb2tpZXM=\">https://leetcode-cn.com/problems/assign-cookies<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Gas Station\nThere are N gas stations along a circular route, where the amount of gas at station i is gas[i].\n\nYou have a car with an unlimited gas tank and it costs cost[i] of gas to travel from station i to its next station (i+1). You begin the journey with an empty tank at one of the gas stations.\n\nReturn the starting gas station's index if you can travel around the circuit once in the clockwise direction, otherwise return -1.\n\nNote:\n\nIf there exists a solution, it is guaranteed to be unique.\nBoth input arrays are non-empty and have the same length.\nEach element in the input arrays is a non-negative integer.\nExample 1:\n\nInput: \ngas  = [1,2,3,4,5]\ncost = [3,4,5,1,2]\n\nOutput: 3\n\nExplanation:\nStart at station 3 (index 3) and fill up with 4 unit of gas. Your tank = 0 + 4 = 4\nTravel to station 4. Your tank = 4 - 1 + 5 = 8\nTravel to station 0. Your tank = 8 - 2 + 1 = 7\nTravel to station 1. Your tank = 7 - 3 + 2 = 6\nTravel to station 2. Your tank = 6 - 4 + 3 = 5\nTravel to station 3. The cost is 5. Your gas is just enough to travel back to station 3.\nTherefore, return 3 as the starting index.\nExample 2:\n\nInput: \ngas  = [2,3,4]\ncost = [3,4,3]\n\nOutput: -1\n\nExplanation:\nYou can't start at station 0 or 1, as there is not enough gas to travel to the next station.\nLet's start at station 2 and fill up with 4 unit of gas. Your tank = 0 + 4 = 4\nTravel to station 0. Your tank = 4 - 3 + 2 = 3\nTravel to station 1. Your tank = 3 - 3 + 3 = 3\nYou cannot travel back to station 2, as it requires 4 unit of gas but you only have 3.\nTherefore, you can't travel around the circuit once no matter where you start.\n\n*Unsolved*\n```java\nclass Solution {\n  public int canCompleteCircuit(int[] gas, int[] cost) {\n    int n = gas.length;\n\n    int total_tank = 0;\n    int curr_tank = 0;\n    int starting_station = 0;\n    for (int i = 0; i < n; ++i) {\n      total_tank += gas[i] - cost[i];\n      curr_tank += gas[i] - cost[i];\n      // If one couldn't get here,\n      if (curr_tank < 0) {\n        // Pick up the next station as the starting one.\n        starting_station = i + 1;\n        // Start with an empty tank.\n        curr_tank = 0;\n      }\n    }\n    return total_tank >= 0 ? starting_station : -1;\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/gas-station","source":"_posts/leetcode/gasstation.md","raw":"# Gas Station\nThere are N gas stations along a circular route, where the amount of gas at station i is gas[i].\n\nYou have a car with an unlimited gas tank and it costs cost[i] of gas to travel from station i to its next station (i+1). You begin the journey with an empty tank at one of the gas stations.\n\nReturn the starting gas station's index if you can travel around the circuit once in the clockwise direction, otherwise return -1.\n\nNote:\n\nIf there exists a solution, it is guaranteed to be unique.\nBoth input arrays are non-empty and have the same length.\nEach element in the input arrays is a non-negative integer.\nExample 1:\n\nInput: \ngas  = [1,2,3,4,5]\ncost = [3,4,5,1,2]\n\nOutput: 3\n\nExplanation:\nStart at station 3 (index 3) and fill up with 4 unit of gas. Your tank = 0 + 4 = 4\nTravel to station 4. Your tank = 4 - 1 + 5 = 8\nTravel to station 0. Your tank = 8 - 2 + 1 = 7\nTravel to station 1. Your tank = 7 - 3 + 2 = 6\nTravel to station 2. Your tank = 6 - 4 + 3 = 5\nTravel to station 3. The cost is 5. Your gas is just enough to travel back to station 3.\nTherefore, return 3 as the starting index.\nExample 2:\n\nInput: \ngas  = [2,3,4]\ncost = [3,4,3]\n\nOutput: -1\n\nExplanation:\nYou can't start at station 0 or 1, as there is not enough gas to travel to the next station.\nLet's start at station 2 and fill up with 4 unit of gas. Your tank = 0 + 4 = 4\nTravel to station 0. Your tank = 4 - 3 + 2 = 3\nTravel to station 1. Your tank = 3 - 3 + 3 = 3\nYou cannot travel back to station 2, as it requires 4 unit of gas but you only have 3.\nTherefore, you can't travel around the circuit once no matter where you start.\n\n*Unsolved*\n```java\nclass Solution {\n  public int canCompleteCircuit(int[] gas, int[] cost) {\n    int n = gas.length;\n\n    int total_tank = 0;\n    int curr_tank = 0;\n    int starting_station = 0;\n    for (int i = 0; i < n; ++i) {\n      total_tank += gas[i] - cost[i];\n      curr_tank += gas[i] - cost[i];\n      // If one couldn't get here,\n      if (curr_tank < 0) {\n        // Pick up the next station as the starting one.\n        starting_station = i + 1;\n        // Start with an empty tank.\n        curr_tank = 0;\n      }\n    }\n    return total_tank >= 0 ? starting_station : -1;\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/gas-station","slug":"leetcode/gasstation","published":1,"date":"2020-03-29T14:04:48.786Z","updated":"2020-03-29T14:05:57.240Z","title":"leetcode/gasstation","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yq003c018ofma40orz","content":"<h1 id=\"Gas-Station\"><a href=\"#Gas-Station\" class=\"headerlink\" title=\"Gas Station\"></a>Gas Station</h1><p>There are N gas stations along a circular route, where the amount of gas at station i is gas[i].</p>\n<p>You have a car with an unlimited gas tank and it costs cost[i] of gas to travel from station i to its next station (i+1). You begin the journey with an empty tank at one of the gas stations.</p>\n<p>Return the starting gas station’s index if you can travel around the circuit once in the clockwise direction, otherwise return -1.</p>\n<p>Note:</p>\n<p>If there exists a solution, it is guaranteed to be unique.<br>Both input arrays are non-empty and have the same length.<br>Each element in the input arrays is a non-negative integer.<br>Example 1:</p>\n<p>Input:<br>gas  = [1,2,3,4,5]<br>cost = [3,4,5,1,2]</p>\n<p>Output: 3</p>\n<p>Explanation:<br>Start at station 3 (index 3) and fill up with 4 unit of gas. Your tank = 0 + 4 = 4<br>Travel to station 4. Your tank = 4 - 1 + 5 = 8<br>Travel to station 0. Your tank = 8 - 2 + 1 = 7<br>Travel to station 1. Your tank = 7 - 3 + 2 = 6<br>Travel to station 2. Your tank = 6 - 4 + 3 = 5<br>Travel to station 3. The cost is 5. Your gas is just enough to travel back to station 3.<br>Therefore, return 3 as the starting index.<br>Example 2:</p>\n<p>Input:<br>gas  = [2,3,4]<br>cost = [3,4,3]</p>\n<p>Output: -1</p>\n<p>Explanation:<br>You can’t start at station 0 or 1, as there is not enough gas to travel to the next station.<br>Let’s start at station 2 and fill up with 4 unit of gas. Your tank = 0 + 4 = 4<br>Travel to station 0. Your tank = 4 - 3 + 2 = 3<br>Travel to station 1. Your tank = 3 - 3 + 3 = 3<br>You cannot travel back to station 2, as it requires 4 unit of gas but you only have 3.<br>Therefore, you can’t travel around the circuit once no matter where you start.</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">canCompleteCircuit</span><span class=\"params\">(<span class=\"keyword\">int</span>[] gas, <span class=\"keyword\">int</span>[] cost)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = gas.length;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> total_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> curr_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> starting_station = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i) &#123;</span><br><span class=\"line\">      total_tank += gas[i] - cost[i];</span><br><span class=\"line\">      curr_tank += gas[i] - cost[i];</span><br><span class=\"line\">      <span class=\"comment\">// If one couldn't get here,</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (curr_tank &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Pick up the next station as the starting one.</span></span><br><span class=\"line\">        starting_station = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// Start with an empty tank.</span></span><br><span class=\"line\">        curr_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> total_tank &gt;= <span class=\"number\">0</span> ? starting_station : -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvZ2FzLXN0YXRpb24=\">https://leetcode-cn.com/problems/gas-station<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Gas-Station\"><a href=\"#Gas-Station\" class=\"headerlink\" title=\"Gas Station\"></a>Gas Station</h1><p>There are N gas stations along a circular route, where the amount of gas at station i is gas[i].</p>\n<p>You have a car with an unlimited gas tank and it costs cost[i] of gas to travel from station i to its next station (i+1). You begin the journey with an empty tank at one of the gas stations.</p>\n<p>Return the starting gas station’s index if you can travel around the circuit once in the clockwise direction, otherwise return -1.</p>\n<p>Note:</p>\n<p>If there exists a solution, it is guaranteed to be unique.<br>Both input arrays are non-empty and have the same length.<br>Each element in the input arrays is a non-negative integer.<br>Example 1:</p>\n<p>Input:<br>gas  = [1,2,3,4,5]<br>cost = [3,4,5,1,2]</p>\n<p>Output: 3</p>\n<p>Explanation:<br>Start at station 3 (index 3) and fill up with 4 unit of gas. Your tank = 0 + 4 = 4<br>Travel to station 4. Your tank = 4 - 1 + 5 = 8<br>Travel to station 0. Your tank = 8 - 2 + 1 = 7<br>Travel to station 1. Your tank = 7 - 3 + 2 = 6<br>Travel to station 2. Your tank = 6 - 4 + 3 = 5<br>Travel to station 3. The cost is 5. Your gas is just enough to travel back to station 3.<br>Therefore, return 3 as the starting index.<br>Example 2:</p>\n<p>Input:<br>gas  = [2,3,4]<br>cost = [3,4,3]</p>\n<p>Output: -1</p>\n<p>Explanation:<br>You can’t start at station 0 or 1, as there is not enough gas to travel to the next station.<br>Let’s start at station 2 and fill up with 4 unit of gas. Your tank = 0 + 4 = 4<br>Travel to station 0. Your tank = 4 - 3 + 2 = 3<br>Travel to station 1. Your tank = 3 - 3 + 3 = 3<br>You cannot travel back to station 2, as it requires 4 unit of gas but you only have 3.<br>Therefore, you can’t travel around the circuit once no matter where you start.</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">canCompleteCircuit</span><span class=\"params\">(<span class=\"keyword\">int</span>[] gas, <span class=\"keyword\">int</span>[] cost)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = gas.length;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> total_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> curr_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> starting_station = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; ++i) &#123;</span><br><span class=\"line\">      total_tank += gas[i] - cost[i];</span><br><span class=\"line\">      curr_tank += gas[i] - cost[i];</span><br><span class=\"line\">      <span class=\"comment\">// If one couldn't get here,</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (curr_tank &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Pick up the next station as the starting one.</span></span><br><span class=\"line\">        starting_station = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// Start with an empty tank.</span></span><br><span class=\"line\">        curr_tank = <span class=\"number\">0</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> total_tank &gt;= <span class=\"number\">0</span> ? starting_station : -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvZ2FzLXN0YXRpb24=\">https://leetcode-cn.com/problems/gas-station<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Jump Game\nGiven an array of non-negative integers, you are initially positioned at the first index of the array.\n\nEach element in the array represents your maximum jump length at that position.\n\nDetermine if you are able to reach the last index.\n\nExample 1:\n\nInput: [2,3,1,1,4]  \nOutput: true  \nExplanation: Jump 1 step from index 0 to 1, then 3 steps to the last index.  \nExample 2:\n\nInput: [3,2,1,0,4]  \nOutput: false  \nExplanation: You will always arrive at index 3 no matter what. Its maximum  \n             jump length is 0, which makes it impossible to reach the last index.  \n             \n*Solution 1*\n```java\nclass Solution {\n    public boolean canJump(int[] nums) {\n        int[] tag = new int[nums.length];\n        tag[nums.length - 1] = 1;\n        for (int i = nums.length - 2; i >= 0; i--) {\n            for (int j = i + 1; j <= i + nums[i] && j < nums.length; j++) {\n                if (tag[j] == 1) {\n                    tag[i] = 1;\n                    break;\n                }\n            }\n        }\n\n        return tag[0] == 1;\n    }\n}\n/*\n执行用时 :580 ms, 在所有 Java 提交中击败了11.08%的用户\n内存消耗 :40.6 MB, 在所有 Java 提交中击败了31.49%的用户\n*/\n```\n\n*Solution 2*\n```java\nclass Solution {\n    public boolean canJump(int[] nums) {\n        int res = nums.length - 1;\n        \n        for (int i = nums.length - 1; i >= 0; i--) {\n            if (i + nums[i] >= res) {\n                res = i;\n            }\n        }\n        \n        return res == 0;\n    }\n}\n/*\n执行用时 :1 ms, 在所有 Java 提交中击败了99.95%的用户\n内存消耗 :40.9 MB, 在所有 Java 提交中击败了24.65%的用户\n*/\n```\nWe can use the position of that we can reach the target to record current result.  \nSo we just need to calculate whether current position plus current value `>=` last which can reach the target result, so we can tag current position.\n\n> Reference  \n> https://leetcode-cn.com/problems/jump-game","source":"_posts/leetcode/jumpgame.md","raw":"# Jump Game\nGiven an array of non-negative integers, you are initially positioned at the first index of the array.\n\nEach element in the array represents your maximum jump length at that position.\n\nDetermine if you are able to reach the last index.\n\nExample 1:\n\nInput: [2,3,1,1,4]  \nOutput: true  \nExplanation: Jump 1 step from index 0 to 1, then 3 steps to the last index.  \nExample 2:\n\nInput: [3,2,1,0,4]  \nOutput: false  \nExplanation: You will always arrive at index 3 no matter what. Its maximum  \n             jump length is 0, which makes it impossible to reach the last index.  \n             \n*Solution 1*\n```java\nclass Solution {\n    public boolean canJump(int[] nums) {\n        int[] tag = new int[nums.length];\n        tag[nums.length - 1] = 1;\n        for (int i = nums.length - 2; i >= 0; i--) {\n            for (int j = i + 1; j <= i + nums[i] && j < nums.length; j++) {\n                if (tag[j] == 1) {\n                    tag[i] = 1;\n                    break;\n                }\n            }\n        }\n\n        return tag[0] == 1;\n    }\n}\n/*\n执行用时 :580 ms, 在所有 Java 提交中击败了11.08%的用户\n内存消耗 :40.6 MB, 在所有 Java 提交中击败了31.49%的用户\n*/\n```\n\n*Solution 2*\n```java\nclass Solution {\n    public boolean canJump(int[] nums) {\n        int res = nums.length - 1;\n        \n        for (int i = nums.length - 1; i >= 0; i--) {\n            if (i + nums[i] >= res) {\n                res = i;\n            }\n        }\n        \n        return res == 0;\n    }\n}\n/*\n执行用时 :1 ms, 在所有 Java 提交中击败了99.95%的用户\n内存消耗 :40.9 MB, 在所有 Java 提交中击败了24.65%的用户\n*/\n```\nWe can use the position of that we can reach the target to record current result.  \nSo we just need to calculate whether current position plus current value `>=` last which can reach the target result, so we can tag current position.\n\n> Reference  \n> https://leetcode-cn.com/problems/jump-game","slug":"leetcode/jumpgame","published":1,"date":"2020-03-28T08:27:35.769Z","updated":"2020-03-28T08:42:30.574Z","title":"leetcode/jumpgame","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yq003e018oc2d03qok","content":"<h1 id=\"Jump-Game\"><a href=\"#Jump-Game\" class=\"headerlink\" title=\"Jump Game\"></a>Jump Game</h1><p>Given an array of non-negative integers, you are initially positioned at the first index of the array.</p>\n<p>Each element in the array represents your maximum jump length at that position.</p>\n<p>Determine if you are able to reach the last index.</p>\n<p>Example 1:</p>\n<p>Input: [2,3,1,1,4]<br>Output: true<br>Explanation: Jump 1 step from index 0 to 1, then 3 steps to the last index.<br>Example 2:</p>\n<p>Input: [3,2,1,0,4]<br>Output: false<br>Explanation: You will always arrive at index 3 no matter what. Its maximum<br>             jump length is 0, which makes it impossible to reach the last index.  </p>\n<p><em>Solution 1</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canJump</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] tag = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[nums.length];</span><br><span class=\"line\">        tag[nums.length - <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nums.length - <span class=\"number\">2</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = i + <span class=\"number\">1</span>; j &lt;= i + nums[i] &amp;&amp; j &lt; nums.length; j++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tag[j] == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    tag[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> tag[<span class=\"number\">0</span>] == <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :580 ms, 在所有 Java 提交中击败了11.08%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :40.6 MB, 在所有 Java 提交中击败了31.49%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><em>Solution 2</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canJump</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nums.length - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i + nums[i] &gt;= res) &#123;</span><br><span class=\"line\">                res = i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> res == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了99.95%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :40.9 MB, 在所有 Java 提交中击败了24.65%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>We can use the position of that we can reach the target to record current result.<br>So we just need to calculate whether current position plus current value <code>&gt;=</code> last which can reach the target result, so we can tag current position.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvanVtcC1nYW1l\">https://leetcode-cn.com/problems/jump-game<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Jump-Game\"><a href=\"#Jump-Game\" class=\"headerlink\" title=\"Jump Game\"></a>Jump Game</h1><p>Given an array of non-negative integers, you are initially positioned at the first index of the array.</p>\n<p>Each element in the array represents your maximum jump length at that position.</p>\n<p>Determine if you are able to reach the last index.</p>\n<p>Example 1:</p>\n<p>Input: [2,3,1,1,4]<br>Output: true<br>Explanation: Jump 1 step from index 0 to 1, then 3 steps to the last index.<br>Example 2:</p>\n<p>Input: [3,2,1,0,4]<br>Output: false<br>Explanation: You will always arrive at index 3 no matter what. Its maximum<br>             jump length is 0, which makes it impossible to reach the last index.  </p>\n<p><em>Solution 1</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canJump</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] tag = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[nums.length];</span><br><span class=\"line\">        tag[nums.length - <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nums.length - <span class=\"number\">2</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = i + <span class=\"number\">1</span>; j &lt;= i + nums[i] &amp;&amp; j &lt; nums.length; j++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tag[j] == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    tag[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> tag[<span class=\"number\">0</span>] == <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :580 ms, 在所有 Java 提交中击败了11.08%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :40.6 MB, 在所有 Java 提交中击败了31.49%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><em>Solution 2</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">canJump</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = nums.length - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i + nums[i] &gt;= res) &#123;</span><br><span class=\"line\">                res = i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> res == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了99.95%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :40.9 MB, 在所有 Java 提交中击败了24.65%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>We can use the position of that we can reach the target to record current result.<br>So we just need to calculate whether current position plus current value <code>&gt;=</code> last which can reach the target result, so we can tag current position.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvanVtcC1nYW1l\">https://leetcode-cn.com/problems/jump-game<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 环形链表\n\n给定一个链表，判断链表中是否有环。\n\n为了表示给定链表中的环，我们使用整数 pos 来表示链表尾连接到链表中的位置（索引从 0 开始）。 如果 pos 是 -1，则在该链表中没有环。\n\n \n\n**示例 1：**\n\n输入：head = [3,2,0,-4], pos = 1\n输出：true\n解释：链表中有一个环，其尾部连接到第二个节点。\n\n```java\npublic class Solution {\n    public boolean hasCycle(ListNode head) {\n        Set<ListNode> container = new HashSet<>();\n\n        while (head != null) {\n            if (container.contains(head)) {\n                return true;\n            }\n            container.add(head);\n            head = head.next;\n        }\n\n        return false;\n    }\n}\n```\n![img](../static/img/container.jpeg)\nPut each `ListNode` pointer into the `Set` container.  \nBecause every pointer is unique, we just to judge if there's a pointer's address we scan has already contained in `Set`.  \n\n> Reference  \n> https://leetcode-cn.com/problems/linked-list-cycle\n","source":"_posts/leetcode/hascycle.md","raw":"# 环形链表\n\n给定一个链表，判断链表中是否有环。\n\n为了表示给定链表中的环，我们使用整数 pos 来表示链表尾连接到链表中的位置（索引从 0 开始）。 如果 pos 是 -1，则在该链表中没有环。\n\n \n\n**示例 1：**\n\n输入：head = [3,2,0,-4], pos = 1\n输出：true\n解释：链表中有一个环，其尾部连接到第二个节点。\n\n```java\npublic class Solution {\n    public boolean hasCycle(ListNode head) {\n        Set<ListNode> container = new HashSet<>();\n\n        while (head != null) {\n            if (container.contains(head)) {\n                return true;\n            }\n            container.add(head);\n            head = head.next;\n        }\n\n        return false;\n    }\n}\n```\n![img](../static/img/container.jpeg)\nPut each `ListNode` pointer into the `Set` container.  \nBecause every pointer is unique, we just to judge if there's a pointer's address we scan has already contained in `Set`.  \n\n> Reference  \n> https://leetcode-cn.com/problems/linked-list-cycle\n","slug":"leetcode/hascycle","published":1,"date":"2020-03-09T09:56:40.686Z","updated":"2020-03-09T10:03:33.108Z","title":"leetcode/hascycle","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yr003g018o4ikq811e","content":"<h1 id=\"环形链表\"><a href=\"#环形链表\" class=\"headerlink\" title=\"环形链表\"></a>环形链表</h1><p>给定一个链表，判断链表中是否有环。</p>\n<p>为了表示给定链表中的环，我们使用整数 pos 来表示链表尾连接到链表中的位置（索引从 0 开始）。 如果 pos 是 -1，则在该链表中没有环。</p>\n<p><strong>示例 1：</strong></p>\n<p>输入：head = [3,2,0,-4], pos = 1<br>输出：true<br>解释：链表中有一个环，其尾部连接到第二个节点。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">hasCycle</span><span class=\"params\">(ListNode head)</span> </span>&#123;</span><br><span class=\"line\">        Set&lt;ListNode&gt; container = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (head != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (container.contains(head)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            container.add(head);</span><br><span class=\"line\">            head = head.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"../static/img/container.jpeg\" alt=\"img\"><br>Put each <code>ListNode</code> pointer into the <code>Set</code> container.<br>Because every pointer is unique, we just to judge if there’s a pointer’s address we scan has already contained in <code>Set</code>.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbGlua2VkLWxpc3QtY3ljbGU=\">https://leetcode-cn.com/problems/linked-list-cycle<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"环形链表\"><a href=\"#环形链表\" class=\"headerlink\" title=\"环形链表\"></a>环形链表</h1><p>给定一个链表，判断链表中是否有环。</p>\n<p>为了表示给定链表中的环，我们使用整数 pos 来表示链表尾连接到链表中的位置（索引从 0 开始）。 如果 pos 是 -1，则在该链表中没有环。</p>\n<p><strong>示例 1：</strong></p>\n<p>输入：head = [3,2,0,-4], pos = 1<br>输出：true<br>解释：链表中有一个环，其尾部连接到第二个节点。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">hasCycle</span><span class=\"params\">(ListNode head)</span> </span>&#123;</span><br><span class=\"line\">        Set&lt;ListNode&gt; container = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (head != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (container.contains(head)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            container.add(head);</span><br><span class=\"line\">            head = head.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"../static/img/container.jpeg\" alt=\"img\"><br>Put each <code>ListNode</code> pointer into the <code>Set</code> container.<br>Because every pointer is unique, we just to judge if there’s a pointer’s address we scan has already contained in <code>Set</code>.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbGlua2VkLWxpc3QtY3ljbGU=\">https://leetcode-cn.com/problems/linked-list-cycle<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Binary Tree Inorder Traversal\nGiven a binary tree, return the inorder traversal of its nodes' values.\n\n**Example:**\n\nInput: [1,null,2,3]  \n   1  \n    \\  \n     2  \n    /  \n   3\n\nOutput: [1,3,2]  \nFollow up: Recursive solution is trivial, could you do it iteratively?\n\n*Old*\n```c\nclass Solution {\npublic:\n    vector<int> inorderTraversal(TreeNode* root) {\n        stack<TreeNode*> stack;\n        vector<int> vector;\n\n        while (root != nullptr || !stack.empty()) {\n            while (root != nullptr) {\n                stack.push(root);\n                root = root->left;\n            }\n            if (!stack.empty()) {\n                root = stack.top();\n                stack.pop();\n                vector.push_back(root->val);\n                root = root->right;\n            }\n        }\n        \n        return vector;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/binary-tree-inorder-traversal","source":"_posts/leetcode/inordertraversal.md","raw":"# Binary Tree Inorder Traversal\nGiven a binary tree, return the inorder traversal of its nodes' values.\n\n**Example:**\n\nInput: [1,null,2,3]  \n   1  \n    \\  \n     2  \n    /  \n   3\n\nOutput: [1,3,2]  \nFollow up: Recursive solution is trivial, could you do it iteratively?\n\n*Old*\n```c\nclass Solution {\npublic:\n    vector<int> inorderTraversal(TreeNode* root) {\n        stack<TreeNode*> stack;\n        vector<int> vector;\n\n        while (root != nullptr || !stack.empty()) {\n            while (root != nullptr) {\n                stack.push(root);\n                root = root->left;\n            }\n            if (!stack.empty()) {\n                root = stack.top();\n                stack.pop();\n                vector.push_back(root->val);\n                root = root->right;\n            }\n        }\n        \n        return vector;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/binary-tree-inorder-traversal","slug":"leetcode/inordertraversal","published":1,"date":"2020-03-22T14:12:29.311Z","updated":"2020-03-22T14:15:04.775Z","title":"leetcode/inordertraversal","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97ys003i018o15pqhfb4","content":"<h1 id=\"Binary-Tree-Inorder-Traversal\"><a href=\"#Binary-Tree-Inorder-Traversal\" class=\"headerlink\" title=\"Binary Tree Inorder Traversal\"></a>Binary Tree Inorder Traversal</h1><p>Given a binary tree, return the inorder traversal of its nodes’ values.</p>\n<p><strong>Example:</strong></p>\n<p>Input: [1,null,2,3]<br>   1<br>    \\<br>     2<br>    /<br>   3</p>\n<p>Output: [1,3,2]<br>Follow up: Recursive solution is trivial, could you do it iteratively?</p>\n<p><em>Old</em></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt; <span class=\"title\">inorderTraversal</span><span class=\"params\">(TreeNode* root)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">stack</span>&lt;TreeNode*&gt; <span class=\"built_in\">stack</span>;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt; <span class=\"built_in\">vector</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (root != <span class=\"literal\">nullptr</span> || !<span class=\"built_in\">stack</span>.empty()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (root != <span class=\"literal\">nullptr</span>) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">stack</span>.push(root);</span><br><span class=\"line\">                root = root-&gt;left;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!<span class=\"built_in\">stack</span>.empty()) &#123;</span><br><span class=\"line\">                root = <span class=\"built_in\">stack</span>.top();</span><br><span class=\"line\">                <span class=\"built_in\">stack</span>.pop();</span><br><span class=\"line\">                <span class=\"built_in\">vector</span>.push_back(root-&gt;val);</span><br><span class=\"line\">                root = root-&gt;right;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">vector</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmluYXJ5LXRyZWUtaW5vcmRlci10cmF2ZXJzYWw=\">https://leetcode-cn.com/problems/binary-tree-inorder-traversal<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Binary-Tree-Inorder-Traversal\"><a href=\"#Binary-Tree-Inorder-Traversal\" class=\"headerlink\" title=\"Binary Tree Inorder Traversal\"></a>Binary Tree Inorder Traversal</h1><p>Given a binary tree, return the inorder traversal of its nodes’ values.</p>\n<p><strong>Example:</strong></p>\n<p>Input: [1,null,2,3]<br>   1<br>    \\<br>     2<br>    /<br>   3</p>\n<p>Output: [1,3,2]<br>Follow up: Recursive solution is trivial, could you do it iteratively?</p>\n<p><em>Old</em></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> &#123;</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt; <span class=\"title\">inorderTraversal</span><span class=\"params\">(TreeNode* root)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">stack</span>&lt;TreeNode*&gt; <span class=\"built_in\">stack</span>;</span><br><span class=\"line\">        <span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt; <span class=\"built_in\">vector</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (root != <span class=\"literal\">nullptr</span> || !<span class=\"built_in\">stack</span>.empty()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (root != <span class=\"literal\">nullptr</span>) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">stack</span>.push(root);</span><br><span class=\"line\">                root = root-&gt;left;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!<span class=\"built_in\">stack</span>.empty()) &#123;</span><br><span class=\"line\">                root = <span class=\"built_in\">stack</span>.top();</span><br><span class=\"line\">                <span class=\"built_in\">stack</span>.pop();</span><br><span class=\"line\">                <span class=\"built_in\">vector</span>.push_back(root-&gt;val);</span><br><span class=\"line\">                root = root-&gt;right;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">vector</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvYmluYXJ5LXRyZWUtaW5vcmRlci10cmF2ZXJzYWw=\">https://leetcode-cn.com/problems/binary-tree-inorder-traversal<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Longest Substring Without Repeating Characters\n\nGiven a string, find the length of the longest substring without repeating characters.\n\n**Example 1:**\n\nInput: \"abcabcbb\"\nOutput: 3 \nExplanation: The answer is \"abc\", with the length of 3. \n\n**Example 2:**\n\nInput: \"bbbbb\"\nOutput: 1\nExplanation: The answer is \"b\", with the length of 1.\n\n**Example 3:**\n\nInput: \"pwwkew\"\nOutput: 3\nExplanation: The answer is \"wke\", with the length of 3. \n             Note that the answer must be a substring, \"pwke\" is a subsequence and not a substring.\n\n**Solution 1**\n```java\n    private static int lengthOfLongestSubstring(String s) {\n        Set<Character> substring = new HashSet<>();\n        int res = 0;\n\n        if (s == null) {\n            return res;\n        }\n\n        for (int i = 0; i < s.length(); i++) {\n            int temp = 0;\n            int j = i;\n            while (j < s.length()) {\n                if (!substring.contains(s.charAt(j))) {\n                    substring.add(s.charAt(j++));\n                    temp++;\n                } else {\n                    substring.clear();\n                    break;\n                }\n            }\n            res = Math.max(temp, res);\n        }\n\n        return res;\n\n        /**\n        执行用时 :127 ms, 在所有 Java 提交中击败了10.50%的用户\n        内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.02%的用户\n        */\n    }\n```\nUsing too much time, so I read the leetcode document.  \nHere is a *SlideWindow* method.\n\n**Solution 2**\n```java\nprivate static int plus(String s) {\n        int res = 0;\n        Set<Character> set = new HashSet<>();\n        int i = 0, j = i; \n        \n        while (j < s.length()) {\n            if (!set.contains(s.charAt(j))) {\n                set.add(s.charAt(j++));\n                res = Math.max(res, set.size());\n            } else {\n                set.remove(s.charAt(i++));\n            }\n        }\n\n        return res;\n\n        /**\n        执行用时 :10 ms, 在所有 Java 提交中击败了64.95%的用户\n        内存消耗 :41.6 MB, 在所有 Java 提交中击败了5.02%的用户\n        */\n```\nWe can adjust the *SlideWindow* by increase `i` - head pointer and `j` - rear pointer.  \nThis can sharply optimize the complexity of time.\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-substring-without-repeating-characters","source":"_posts/leetcode/longestsubstring.md","raw":"# Longest Substring Without Repeating Characters\n\nGiven a string, find the length of the longest substring without repeating characters.\n\n**Example 1:**\n\nInput: \"abcabcbb\"\nOutput: 3 \nExplanation: The answer is \"abc\", with the length of 3. \n\n**Example 2:**\n\nInput: \"bbbbb\"\nOutput: 1\nExplanation: The answer is \"b\", with the length of 1.\n\n**Example 3:**\n\nInput: \"pwwkew\"\nOutput: 3\nExplanation: The answer is \"wke\", with the length of 3. \n             Note that the answer must be a substring, \"pwke\" is a subsequence and not a substring.\n\n**Solution 1**\n```java\n    private static int lengthOfLongestSubstring(String s) {\n        Set<Character> substring = new HashSet<>();\n        int res = 0;\n\n        if (s == null) {\n            return res;\n        }\n\n        for (int i = 0; i < s.length(); i++) {\n            int temp = 0;\n            int j = i;\n            while (j < s.length()) {\n                if (!substring.contains(s.charAt(j))) {\n                    substring.add(s.charAt(j++));\n                    temp++;\n                } else {\n                    substring.clear();\n                    break;\n                }\n            }\n            res = Math.max(temp, res);\n        }\n\n        return res;\n\n        /**\n        执行用时 :127 ms, 在所有 Java 提交中击败了10.50%的用户\n        内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.02%的用户\n        */\n    }\n```\nUsing too much time, so I read the leetcode document.  \nHere is a *SlideWindow* method.\n\n**Solution 2**\n```java\nprivate static int plus(String s) {\n        int res = 0;\n        Set<Character> set = new HashSet<>();\n        int i = 0, j = i; \n        \n        while (j < s.length()) {\n            if (!set.contains(s.charAt(j))) {\n                set.add(s.charAt(j++));\n                res = Math.max(res, set.size());\n            } else {\n                set.remove(s.charAt(i++));\n            }\n        }\n\n        return res;\n\n        /**\n        执行用时 :10 ms, 在所有 Java 提交中击败了64.95%的用户\n        内存消耗 :41.6 MB, 在所有 Java 提交中击败了5.02%的用户\n        */\n```\nWe can adjust the *SlideWindow* by increase `i` - head pointer and `j` - rear pointer.  \nThis can sharply optimize the complexity of time.\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-substring-without-repeating-characters","slug":"leetcode/longestsubstring","published":1,"date":"2020-03-16T14:24:57.749Z","updated":"2020-03-16T14:33:38.645Z","title":"leetcode/longestsubstring","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yt003l018o5ae228s6","content":"<h1 id=\"Longest-Substring-Without-Repeating-Characters\"><a href=\"#Longest-Substring-Without-Repeating-Characters\" class=\"headerlink\" title=\"Longest Substring Without Repeating Characters\"></a>Longest Substring Without Repeating Characters</h1><p>Given a string, find the length of the longest substring without repeating characters.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “abcabcbb”<br>Output: 3<br>Explanation: The answer is “abc”, with the length of 3. </p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “bbbbb”<br>Output: 1<br>Explanation: The answer is “b”, with the length of 1.</p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “pwwkew”<br>Output: 3<br>Explanation: The answer is “wke”, with the length of 3.<br>             Note that the answer must be a substring, “pwke” is a subsequence and not a substring.</p>\n<p><strong>Solution 1</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">lengthOfLongestSubstring</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    Set&lt;Character&gt; substring = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> j = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &lt; s.length()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!substring.contains(s.charAt(j))) &#123;</span><br><span class=\"line\">                substring.add(s.charAt(j++));</span><br><span class=\"line\">                temp++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                substring.clear();</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res = Math.max(temp, res);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    执行用时 :127 ms, 在所有 Java 提交中击败了10.50%的用户</span></span><br><span class=\"line\"><span class=\"comment\">    内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.02%的用户</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Using too much time, so I read the leetcode document.<br>Here is a <em>SlideWindow</em> method.</p>\n<p><strong>Solution 2</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">plus</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        Set&lt;Character&gt; set = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = i; </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &lt; s.length()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!set.contains(s.charAt(j))) &#123;</span><br><span class=\"line\">                set.add(s.charAt(j++));</span><br><span class=\"line\">                res = Math.max(res, set.size());</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                set.remove(s.charAt(i++));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">        执行用时 :10 ms, 在所有 Java 提交中击败了64.95%的用户</span></span><br><span class=\"line\"><span class=\"comment\">        内存消耗 :41.6 MB, 在所有 Java 提交中击败了5.02%的用户</span></span><br><span class=\"line\"><span class=\"comment\">        */</span></span><br></pre></td></tr></table></figure>\n<p>We can adjust the <em>SlideWindow</em> by increase <code>i</code> - head pointer and <code>j</code> - rear pointer.<br>This can sharply optimize the complexity of time.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1zdWJzdHJpbmctd2l0aG91dC1yZXBlYXRpbmctY2hhcmFjdGVycw==\">https://leetcode-cn.com/problems/longest-substring-without-repeating-characters<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Longest-Substring-Without-Repeating-Characters\"><a href=\"#Longest-Substring-Without-Repeating-Characters\" class=\"headerlink\" title=\"Longest Substring Without Repeating Characters\"></a>Longest Substring Without Repeating Characters</h1><p>Given a string, find the length of the longest substring without repeating characters.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “abcabcbb”<br>Output: 3<br>Explanation: The answer is “abc”, with the length of 3. </p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “bbbbb”<br>Output: 1<br>Explanation: The answer is “b”, with the length of 1.</p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “pwwkew”<br>Output: 3<br>Explanation: The answer is “wke”, with the length of 3.<br>             Note that the answer must be a substring, “pwke” is a subsequence and not a substring.</p>\n<p><strong>Solution 1</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">lengthOfLongestSubstring</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">    Set&lt;Character&gt; substring = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> j = i;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &lt; s.length()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!substring.contains(s.charAt(j))) &#123;</span><br><span class=\"line\">                substring.add(s.charAt(j++));</span><br><span class=\"line\">                temp++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                substring.clear();</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res = Math.max(temp, res);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    执行用时 :127 ms, 在所有 Java 提交中击败了10.50%的用户</span></span><br><span class=\"line\"><span class=\"comment\">    内存消耗 :42.3 MB, 在所有 Java 提交中击败了5.02%的用户</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Using too much time, so I read the leetcode document.<br>Here is a <em>SlideWindow</em> method.</p>\n<p><strong>Solution 2</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> <span class=\"title\">plus</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">        Set&lt;Character&gt; set = <span class=\"keyword\">new</span> HashSet&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = i; </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &lt; s.length()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!set.contains(s.charAt(j))) &#123;</span><br><span class=\"line\">                set.add(s.charAt(j++));</span><br><span class=\"line\">                res = Math.max(res, set.size());</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                set.remove(s.charAt(i++));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">        执行用时 :10 ms, 在所有 Java 提交中击败了64.95%的用户</span></span><br><span class=\"line\"><span class=\"comment\">        内存消耗 :41.6 MB, 在所有 Java 提交中击败了5.02%的用户</span></span><br><span class=\"line\"><span class=\"comment\">        */</span></span><br></pre></td></tr></table></figure>\n<p>We can adjust the <em>SlideWindow</em> by increase <code>i</code> - head pointer and <code>j</code> - rear pointer.<br>This can sharply optimize the complexity of time.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1zdWJzdHJpbmctd2l0aG91dC1yZXBlYXRpbmctY2hhcmFjdGVycw==\">https://leetcode-cn.com/problems/longest-substring-without-repeating-characters<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Longest Palindromic Substring\nGiven a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.\n\n**Example 1:**\n\nInput: \"babad\"\nOutput: \"bab\"\nNote: \"aba\" is also a valid answer.\n\n**Example 2:**\n\nInput: \"cbbd\"\nOutput: \"bb\"\n\n![img](../static/img/dp.png)\n\n```java\npublic class Solution {\n\n    public String longestPalindrome(String s) {\n        int len = s.length();\n        if (len < 2) {\n            return s;\n        }\n\n        boolean[][] dp = new boolean[len][len];\n\n        // 初始化\n        for (int i = 0; i < len; i++) {\n            dp[i][i] = true;\n        }\n\n        int maxLen = 1;\n        int start = 0;\n\n        for (int j = 1; j < len; j++) {\n            for (int i = 0; i < j; i++) {\n\n                if (s.charAt(i) == s.charAt(j)) {\n                    if (j - i < 3) {\n                        dp[i][j] = true;\n                    } else {\n                        dp[i][j] = dp[i + 1][j - 1];\n                    }\n                } else {\n                    dp[i][j] = false;\n                }\n\n                // 只要 dp[i][j] == true 成立，就表示子串 s[i, j] 是回文，此时记录回文长度和起始位置\n                if (dp[i][j]) {\n                    int curLen = j - i + 1;\n                    if (curLen > maxLen) {\n                        maxLen = curLen;\n                        start = i;\n                    }\n                }\n            }\n        }\n        return s.substring(start, start + maxLen);\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-palindromic-substring","source":"_posts/leetcode/longestpalindromicsubstring.md","raw":"# Longest Palindromic Substring\nGiven a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.\n\n**Example 1:**\n\nInput: \"babad\"\nOutput: \"bab\"\nNote: \"aba\" is also a valid answer.\n\n**Example 2:**\n\nInput: \"cbbd\"\nOutput: \"bb\"\n\n![img](../static/img/dp.png)\n\n```java\npublic class Solution {\n\n    public String longestPalindrome(String s) {\n        int len = s.length();\n        if (len < 2) {\n            return s;\n        }\n\n        boolean[][] dp = new boolean[len][len];\n\n        // 初始化\n        for (int i = 0; i < len; i++) {\n            dp[i][i] = true;\n        }\n\n        int maxLen = 1;\n        int start = 0;\n\n        for (int j = 1; j < len; j++) {\n            for (int i = 0; i < j; i++) {\n\n                if (s.charAt(i) == s.charAt(j)) {\n                    if (j - i < 3) {\n                        dp[i][j] = true;\n                    } else {\n                        dp[i][j] = dp[i + 1][j - 1];\n                    }\n                } else {\n                    dp[i][j] = false;\n                }\n\n                // 只要 dp[i][j] == true 成立，就表示子串 s[i, j] 是回文，此时记录回文长度和起始位置\n                if (dp[i][j]) {\n                    int curLen = j - i + 1;\n                    if (curLen > maxLen) {\n                        maxLen = curLen;\n                        start = i;\n                    }\n                }\n            }\n        }\n        return s.substring(start, start + maxLen);\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-palindromic-substring","slug":"leetcode/longestpalindromicsubstring","published":1,"date":"2020-03-17T15:30:39.003Z","updated":"2020-03-17T15:35:28.371Z","title":"leetcode/longestpalindromicsubstring","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yt003m018ogwzm1tza","content":"<h1 id=\"Longest-Palindromic-Substring\"><a href=\"#Longest-Palindromic-Substring\" class=\"headerlink\" title=\"Longest Palindromic Substring\"></a>Longest Palindromic Substring</h1><p>Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “babad”<br>Output: “bab”<br>Note: “aba” is also a valid answer.</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “cbbd”<br>Output: “bb”</p>\n<p><img src=\"../static/img/dp.png\" alt=\"img\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">longestPalindrome</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = s.length();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (len &lt; <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span>[][] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[len][len];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</span><br><span class=\"line\">            dp[i][i] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span> maxLen = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> start = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; j &lt; len; j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; j; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s.charAt(i) == s.charAt(j)) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (j - i &lt; <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">                        dp[i][j] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        dp[i][j] = dp[i + <span class=\"number\">1</span>][j - <span class=\"number\">1</span>];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    dp[i][j] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 只要 dp[i][j] == true 成立，就表示子串 s[i, j] 是回文，此时记录回文长度和起始位置</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dp[i][j]) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> curLen = j - i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (curLen &gt; maxLen) &#123;</span><br><span class=\"line\">                        maxLen = curLen;</span><br><span class=\"line\">                        start = i;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> s.substring(start, start + maxLen);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1wYWxpbmRyb21pYy1zdWJzdHJpbmc=\">https://leetcode-cn.com/problems/longest-palindromic-substring<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Longest-Palindromic-Substring\"><a href=\"#Longest-Palindromic-Substring\" class=\"headerlink\" title=\"Longest Palindromic Substring\"></a>Longest Palindromic Substring</h1><p>Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “babad”<br>Output: “bab”<br>Note: “aba” is also a valid answer.</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “cbbd”<br>Output: “bb”</p>\n<p><img src=\"../static/img/dp.png\" alt=\"img\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">longestPalindrome</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = s.length();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (len &lt; <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span>[][] dp = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[len][len];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</span><br><span class=\"line\">            dp[i][i] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span> maxLen = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> start = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; j &lt; len; j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; j; i++) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (s.charAt(i) == s.charAt(j)) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (j - i &lt; <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">                        dp[i][j] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        dp[i][j] = dp[i + <span class=\"number\">1</span>][j - <span class=\"number\">1</span>];</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    dp[i][j] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 只要 dp[i][j] == true 成立，就表示子串 s[i, j] 是回文，此时记录回文长度和起始位置</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (dp[i][j]) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> curLen = j - i + <span class=\"number\">1</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (curLen &gt; maxLen) &#123;</span><br><span class=\"line\">                        maxLen = curLen;</span><br><span class=\"line\">                        start = i;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> s.substring(start, start + maxLen);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1wYWxpbmRyb21pYy1zdWJzdHJpbmc=\">https://leetcode-cn.com/problems/longest-palindromic-substring<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Wildcard Matching\nGiven an input string (s) and a pattern (p), implement wildcard pattern matching with support for '?' and '*'.\n\n'?' Matches any single character.\n'*' Matches any sequence of characters (including the empty sequence).\nThe matching should cover the entire input string (not partial).\n\nNote:\n\ns could be empty and contains only lowercase letters a-z.\np could be empty and contains only lowercase letters a-z, and characters like ? or *.\nExample 1:\n\nInput:\ns = \"aa\"\np = \"a\"\nOutput: false\nExplanation: \"a\" does not match the entire string \"aa\".\nExample 2:\n\nInput:\ns = \"aa\"\np = \"*\"\nOutput: true\nExplanation: '*' matches any sequence.\nExample 3:\n\nInput:\ns = \"cb\"\np = \"?a\"\nOutput: false\nExplanation: '?' matches 'c', but the second letter is 'a', which does not match 'b'.\nExample 4:\n\nInput:\ns = \"adceb\"\np = \"*a*b\"\nOutput: true\nExplanation: The first '*' matches the empty sequence, while the second '*' matches the substring \"dce\".\nExample 5:\n\nInput:\ns = \"acdcb\"\np = \"a*c?b\"\nOutput: false\n\n```java\nclass Solution {\n  public boolean isMatch(String s, String p) {\n    int sLen = s.length(), pLen = p.length();\n    int sIdx = 0, pIdx = 0;\n    int starIdx = -1, sTmpIdx = -1;\n\n    while (sIdx < sLen) {\n\n      if (pIdx < pLen && (p.charAt(pIdx) == '?' || p.charAt(pIdx) == s.charAt(sIdx))){\n        ++sIdx;\n        ++pIdx;\n      }\n\n      else if (pIdx < pLen && p.charAt(pIdx) == '*') {\n\n        starIdx = pIdx;\n        sTmpIdx = sIdx;\n        ++pIdx;\n      }\n\n      else if (starIdx == -1) {\n        return false;\n      }\n\n      else {\n\n        pIdx = starIdx + 1;\n        sIdx = sTmpIdx + 1;\n        sTmpIdx = sIdx;\n      }\n    }\n\n    for(int i = pIdx; i < pLen; i++)\n      if (p.charAt(i) != '*') return false;\n    return true;\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/wildcard-matching/","source":"_posts/leetcode/matching.md","raw":"# Wildcard Matching\nGiven an input string (s) and a pattern (p), implement wildcard pattern matching with support for '?' and '*'.\n\n'?' Matches any single character.\n'*' Matches any sequence of characters (including the empty sequence).\nThe matching should cover the entire input string (not partial).\n\nNote:\n\ns could be empty and contains only lowercase letters a-z.\np could be empty and contains only lowercase letters a-z, and characters like ? or *.\nExample 1:\n\nInput:\ns = \"aa\"\np = \"a\"\nOutput: false\nExplanation: \"a\" does not match the entire string \"aa\".\nExample 2:\n\nInput:\ns = \"aa\"\np = \"*\"\nOutput: true\nExplanation: '*' matches any sequence.\nExample 3:\n\nInput:\ns = \"cb\"\np = \"?a\"\nOutput: false\nExplanation: '?' matches 'c', but the second letter is 'a', which does not match 'b'.\nExample 4:\n\nInput:\ns = \"adceb\"\np = \"*a*b\"\nOutput: true\nExplanation: The first '*' matches the empty sequence, while the second '*' matches the substring \"dce\".\nExample 5:\n\nInput:\ns = \"acdcb\"\np = \"a*c?b\"\nOutput: false\n\n```java\nclass Solution {\n  public boolean isMatch(String s, String p) {\n    int sLen = s.length(), pLen = p.length();\n    int sIdx = 0, pIdx = 0;\n    int starIdx = -1, sTmpIdx = -1;\n\n    while (sIdx < sLen) {\n\n      if (pIdx < pLen && (p.charAt(pIdx) == '?' || p.charAt(pIdx) == s.charAt(sIdx))){\n        ++sIdx;\n        ++pIdx;\n      }\n\n      else if (pIdx < pLen && p.charAt(pIdx) == '*') {\n\n        starIdx = pIdx;\n        sTmpIdx = sIdx;\n        ++pIdx;\n      }\n\n      else if (starIdx == -1) {\n        return false;\n      }\n\n      else {\n\n        pIdx = starIdx + 1;\n        sIdx = sTmpIdx + 1;\n        sTmpIdx = sIdx;\n      }\n    }\n\n    for(int i = pIdx; i < pLen; i++)\n      if (p.charAt(i) != '*') return false;\n    return true;\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/wildcard-matching/","slug":"leetcode/matching","published":1,"date":"2020-03-31T04:14:47.634Z","updated":"2020-03-31T04:16:09.849Z","title":"leetcode/matching","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yu003o018o4i5i3zwj","content":"<h1 id=\"Wildcard-Matching\"><a href=\"#Wildcard-Matching\" class=\"headerlink\" title=\"Wildcard Matching\"></a>Wildcard Matching</h1><p>Given an input string (s) and a pattern (p), implement wildcard pattern matching with support for ‘?’ and ‘*’.</p>\n<p>‘?’ Matches any single character.<br>‘*’ Matches any sequence of characters (including the empty sequence).<br>The matching should cover the entire input string (not partial).</p>\n<p>Note:</p>\n<p>s could be empty and contains only lowercase letters a-z.<br>p could be empty and contains only lowercase letters a-z, and characters like ? or *.<br>Example 1:</p>\n<p>Input:<br>s = “aa”<br>p = “a”<br>Output: false<br>Explanation: “a” does not match the entire string “aa”.<br>Example 2:</p>\n<p>Input:<br>s = “aa”<br>p = “*”<br>Output: true<br>Explanation: ‘*’ matches any sequence.<br>Example 3:</p>\n<p>Input:<br>s = “cb”<br>p = “?a”<br>Output: false<br>Explanation: ‘?’ matches ‘c’, but the second letter is ‘a’, which does not match ‘b’.<br>Example 4:</p>\n<p>Input:<br>s = “adceb”<br>p = “<em>a</em>b”<br>Output: true<br>Explanation: The first ‘<em>‘ matches the empty sequence, while the second ‘</em>‘ matches the substring “dce”.<br>Example 5:</p>\n<p>Input:<br>s = “acdcb”<br>p = “a*c?b”<br>Output: false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMatch</span><span class=\"params\">(String s, String p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sLen = s.length(), pLen = p.length();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sIdx = <span class=\"number\">0</span>, pIdx = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> starIdx = -<span class=\"number\">1</span>, sTmpIdx = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (sIdx &lt; sLen) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (pIdx &lt; pLen &amp;&amp; (p.charAt(pIdx) == <span class=\"string\">'?'</span> || p.charAt(pIdx) == s.charAt(sIdx)))&#123;</span><br><span class=\"line\">        ++sIdx;</span><br><span class=\"line\">        ++pIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (pIdx &lt; pLen &amp;&amp; p.charAt(pIdx) == <span class=\"string\">'*'</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        starIdx = pIdx;</span><br><span class=\"line\">        sTmpIdx = sIdx;</span><br><span class=\"line\">        ++pIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (starIdx == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        pIdx = starIdx + <span class=\"number\">1</span>;</span><br><span class=\"line\">        sIdx = sTmpIdx + <span class=\"number\">1</span>;</span><br><span class=\"line\">        sTmpIdx = sIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = pIdx; i &lt; pLen; i++)</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (p.charAt(i) != <span class=\"string\">'*'</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvd2lsZGNhcmQtbWF0Y2hpbmcv\">https://leetcode-cn.com/problems/wildcard-matching/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Wildcard-Matching\"><a href=\"#Wildcard-Matching\" class=\"headerlink\" title=\"Wildcard Matching\"></a>Wildcard Matching</h1><p>Given an input string (s) and a pattern (p), implement wildcard pattern matching with support for ‘?’ and ‘*’.</p>\n<p>‘?’ Matches any single character.<br>‘*’ Matches any sequence of characters (including the empty sequence).<br>The matching should cover the entire input string (not partial).</p>\n<p>Note:</p>\n<p>s could be empty and contains only lowercase letters a-z.<br>p could be empty and contains only lowercase letters a-z, and characters like ? or *.<br>Example 1:</p>\n<p>Input:<br>s = “aa”<br>p = “a”<br>Output: false<br>Explanation: “a” does not match the entire string “aa”.<br>Example 2:</p>\n<p>Input:<br>s = “aa”<br>p = “*”<br>Output: true<br>Explanation: ‘*’ matches any sequence.<br>Example 3:</p>\n<p>Input:<br>s = “cb”<br>p = “?a”<br>Output: false<br>Explanation: ‘?’ matches ‘c’, but the second letter is ‘a’, which does not match ‘b’.<br>Example 4:</p>\n<p>Input:<br>s = “adceb”<br>p = “<em>a</em>b”<br>Output: true<br>Explanation: The first ‘<em>‘ matches the empty sequence, while the second ‘</em>‘ matches the substring “dce”.<br>Example 5:</p>\n<p>Input:<br>s = “acdcb”<br>p = “a*c?b”<br>Output: false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMatch</span><span class=\"params\">(String s, String p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sLen = s.length(), pLen = p.length();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sIdx = <span class=\"number\">0</span>, pIdx = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> starIdx = -<span class=\"number\">1</span>, sTmpIdx = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (sIdx &lt; sLen) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (pIdx &lt; pLen &amp;&amp; (p.charAt(pIdx) == <span class=\"string\">'?'</span> || p.charAt(pIdx) == s.charAt(sIdx)))&#123;</span><br><span class=\"line\">        ++sIdx;</span><br><span class=\"line\">        ++pIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (pIdx &lt; pLen &amp;&amp; p.charAt(pIdx) == <span class=\"string\">'*'</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        starIdx = pIdx;</span><br><span class=\"line\">        sTmpIdx = sIdx;</span><br><span class=\"line\">        ++pIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (starIdx == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        pIdx = starIdx + <span class=\"number\">1</span>;</span><br><span class=\"line\">        sIdx = sTmpIdx + <span class=\"number\">1</span>;</span><br><span class=\"line\">        sTmpIdx = sIdx;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = pIdx; i &lt; pLen; i++)</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (p.charAt(i) != <span class=\"string\">'*'</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvd2lsZGNhcmQtbWF0Y2hpbmcv\">https://leetcode-cn.com/problems/wildcard-matching/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Merge k Sorted Lists\n\nMerge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.\n\n**Example**:\n\nInput:\n[\n  1->4->5,\n  1->3->4,\n  2->6\n]\nOutput: 1->1->2->3->4->4->5->6\n\n```java\nclass Solution {\n    public ListNode mergeKLists(ListNode[] lists) {\n        List<Integer> nodes = new ArrayList<>();\n        \n        for (int i = 0; i < lists.length; i++) {\n            while (lists[i] != null) {\n                nodes.add(lists[i].val);\n                lists[i] = lists[i].next;\n            }\n        }\n\n        if (nodes.size() == 0)\n            return null;\n        \n        nodes.sort(Comparator.naturalOrder());\n        ListNode res = new ListNode(nodes.remove(0));\n        ListNode p = res;\n        \n        for (int i = 0; i < nodes.size(); i++) {\n            p.next = new ListNode(nodes.get(i));\n            p = p.next;\n        }\n        \n        return res;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/merge-k-sorted-lists\n","source":"_posts/leetcode/mergeklist.md","raw":"# Merge k Sorted Lists\n\nMerge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.\n\n**Example**:\n\nInput:\n[\n  1->4->5,\n  1->3->4,\n  2->6\n]\nOutput: 1->1->2->3->4->4->5->6\n\n```java\nclass Solution {\n    public ListNode mergeKLists(ListNode[] lists) {\n        List<Integer> nodes = new ArrayList<>();\n        \n        for (int i = 0; i < lists.length; i++) {\n            while (lists[i] != null) {\n                nodes.add(lists[i].val);\n                lists[i] = lists[i].next;\n            }\n        }\n\n        if (nodes.size() == 0)\n            return null;\n        \n        nodes.sort(Comparator.naturalOrder());\n        ListNode res = new ListNode(nodes.remove(0));\n        ListNode p = res;\n        \n        for (int i = 0; i < nodes.size(); i++) {\n            p.next = new ListNode(nodes.get(i));\n            p = p.next;\n        }\n        \n        return res;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/merge-k-sorted-lists\n","slug":"leetcode/mergeklist","published":1,"date":"2020-03-12T14:26:40.730Z","updated":"2020-03-12T14:28:39.098Z","title":"leetcode/mergeklist","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yv003p018ogf9a4pdt","content":"<h1 id=\"Merge-k-Sorted-Lists\"><a href=\"#Merge-k-Sorted-Lists\" class=\"headerlink\" title=\"Merge k Sorted Lists\"></a>Merge k Sorted Lists</h1><p>Merge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p>\n<p><strong>Example</strong>:</p>\n<p>Input:<br>[<br>  1-&gt;4-&gt;5,<br>  1-&gt;3-&gt;4,<br>  2-&gt;6<br>]<br>Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">mergeKLists</span><span class=\"params\">(ListNode[] lists)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;Integer&gt; nodes = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; lists.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (lists[i] != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                nodes.add(lists[i].val);</span><br><span class=\"line\">                lists[i] = lists[i].next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nodes.size() == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        nodes.sort(Comparator.naturalOrder());</span><br><span class=\"line\">        ListNode res = <span class=\"keyword\">new</span> ListNode(nodes.remove(<span class=\"number\">0</span>));</span><br><span class=\"line\">        ListNode p = res;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nodes.size(); i++) &#123;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(nodes.get(i));</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWVyZ2Utay1zb3J0ZWQtbGlzdHM=\">https://leetcode-cn.com/problems/merge-k-sorted-lists<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Merge-k-Sorted-Lists\"><a href=\"#Merge-k-Sorted-Lists\" class=\"headerlink\" title=\"Merge k Sorted Lists\"></a>Merge k Sorted Lists</h1><p>Merge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p>\n<p><strong>Example</strong>:</p>\n<p>Input:<br>[<br>  1-&gt;4-&gt;5,<br>  1-&gt;3-&gt;4,<br>  2-&gt;6<br>]<br>Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">mergeKLists</span><span class=\"params\">(ListNode[] lists)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;Integer&gt; nodes = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; lists.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (lists[i] != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                nodes.add(lists[i].val);</span><br><span class=\"line\">                lists[i] = lists[i].next;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nodes.size() == <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        nodes.sort(Comparator.naturalOrder());</span><br><span class=\"line\">        ListNode res = <span class=\"keyword\">new</span> ListNode(nodes.remove(<span class=\"number\">0</span>));</span><br><span class=\"line\">        ListNode p = res;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nodes.size(); i++) &#123;</span><br><span class=\"line\">            p.next = <span class=\"keyword\">new</span> ListNode(nodes.get(i));</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWVyZ2Utay1zb3J0ZWQtbGlzdHM=\">https://leetcode-cn.com/problems/merge-k-sorted-lists<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 二叉树的最大深度\n给定一个二叉树，找出其最大深度。\n\n二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。\n\n说明: 叶子节点是指没有子节点的节点。\n\n**示例：**  \n给定二叉树 [3,9,20,null,null,15,7]，\n\n   3  \n   / \\  \n  9  20  \n    /  \\  \n   15   7  \n返回它的最大深度 3 。\n\n```java\nclass Solution {\n  public int maxDepth(TreeNode root) {\n    Queue<Pair<TreeNode, Integer>> stack = new LinkedList<>();\n    if (root != null) {\n      stack.add(new Pair(root, 1));\n    }\n\n    int depth = 0;\n    while (!stack.isEmpty()) {\n      Pair<TreeNode, Integer> current = stack.poll();\n      root = current.getKey();\n      int current_depth = current.getValue();\n      if (root != null) {\n        depth = Math.max(depth, current_depth);\n        stack.add(new Pair(root.left, current_depth + 1));\n        stack.add(new Pair(root.right, current_depth + 1));\n      }\n    }\n    return depth;\n  }\n}\n\n/*\nby LeetCode\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/maximum-depth-of-binary-tree","source":"_posts/leetcode/maxdepth.md","raw":"# 二叉树的最大深度\n给定一个二叉树，找出其最大深度。\n\n二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。\n\n说明: 叶子节点是指没有子节点的节点。\n\n**示例：**  \n给定二叉树 [3,9,20,null,null,15,7]，\n\n   3  \n   / \\  \n  9  20  \n    /  \\  \n   15   7  \n返回它的最大深度 3 。\n\n```java\nclass Solution {\n  public int maxDepth(TreeNode root) {\n    Queue<Pair<TreeNode, Integer>> stack = new LinkedList<>();\n    if (root != null) {\n      stack.add(new Pair(root, 1));\n    }\n\n    int depth = 0;\n    while (!stack.isEmpty()) {\n      Pair<TreeNode, Integer> current = stack.poll();\n      root = current.getKey();\n      int current_depth = current.getValue();\n      if (root != null) {\n        depth = Math.max(depth, current_depth);\n        stack.add(new Pair(root.left, current_depth + 1));\n        stack.add(new Pair(root.right, current_depth + 1));\n      }\n    }\n    return depth;\n  }\n}\n\n/*\nby LeetCode\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/maximum-depth-of-binary-tree","slug":"leetcode/maxdepth","published":1,"date":"2020-03-21T15:57:21.264Z","updated":"2020-03-21T16:00:55.240Z","title":"leetcode/maxdepth","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yw003r018o922fcjwu","content":"<h1 id=\"二叉树的最大深度\"><a href=\"#二叉树的最大深度\" class=\"headerlink\" title=\"二叉树的最大深度\"></a>二叉树的最大深度</h1><p>给定一个二叉树，找出其最大深度。</p>\n<p>二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。</p>\n<p>说明: 叶子节点是指没有子节点的节点。</p>\n<p><strong>示例：</strong><br>给定二叉树 [3,9,20,null,null,15,7]，</p>\n<p>   3<br>   / \\<br>  9  20<br>    /  \\<br>   15   7<br>返回它的最大深度 3 。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxDepth</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\">    Queue&lt;Pair&lt;TreeNode, Integer&gt;&gt; stack = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      stack.add(<span class=\"keyword\">new</span> Pair(root, <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> depth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">      Pair&lt;TreeNode, Integer&gt; current = stack.poll();</span><br><span class=\"line\">      root = current.getKey();</span><br><span class=\"line\">      <span class=\"keyword\">int</span> current_depth = current.getValue();</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (root != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth = Math.max(depth, current_depth);</span><br><span class=\"line\">        stack.add(<span class=\"keyword\">new</span> Pair(root.left, current_depth + <span class=\"number\">1</span>));</span><br><span class=\"line\">        stack.add(<span class=\"keyword\">new</span> Pair(root.right, current_depth + <span class=\"number\">1</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> depth;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">by LeetCode</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWF4aW11bS1kZXB0aC1vZi1iaW5hcnktdHJlZQ==\">https://leetcode-cn.com/problems/maximum-depth-of-binary-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"二叉树的最大深度\"><a href=\"#二叉树的最大深度\" class=\"headerlink\" title=\"二叉树的最大深度\"></a>二叉树的最大深度</h1><p>给定一个二叉树，找出其最大深度。</p>\n<p>二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。</p>\n<p>说明: 叶子节点是指没有子节点的节点。</p>\n<p><strong>示例：</strong><br>给定二叉树 [3,9,20,null,null,15,7]，</p>\n<p>   3<br>   / \\<br>  9  20<br>    /  \\<br>   15   7<br>返回它的最大深度 3 。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">maxDepth</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\">    Queue&lt;Pair&lt;TreeNode, Integer&gt;&gt; stack = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      stack.add(<span class=\"keyword\">new</span> Pair(root, <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> depth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">      Pair&lt;TreeNode, Integer&gt; current = stack.poll();</span><br><span class=\"line\">      root = current.getKey();</span><br><span class=\"line\">      <span class=\"keyword\">int</span> current_depth = current.getValue();</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (root != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth = Math.max(depth, current_depth);</span><br><span class=\"line\">        stack.add(<span class=\"keyword\">new</span> Pair(root.left, current_depth + <span class=\"number\">1</span>));</span><br><span class=\"line\">        stack.add(<span class=\"keyword\">new</span> Pair(root.right, current_depth + <span class=\"number\">1</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> depth;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">by LeetCode</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWF4aW11bS1kZXB0aC1vZi1iaW5hcnktdHJlZQ==\">https://leetcode-cn.com/problems/maximum-depth-of-binary-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 最接近的三数之和\n\n给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。\n\n**例如**\n\n给定数组 nums = [-1，2，1，-4], 和 target = 1.\n与 target 最接近的三个数的和为 2. (-1 + 2 + 1 = 2).\n\n```java\nclass Solution {\n    public int threeSumClosest(int[] nums, int target) {\n        int temp = nums[0] + nums[1] + nums[2];\n        int res = temp;\n        int min = Math.abs(temp - target);\n        int tempMin;\n        Arrays.sort(nums);\n\n        for (int i = 0; i < nums.length - 2; i++) {\n            int left = i + 1, right = nums.length - 1;\n\n            while (left < right) {\n                temp = nums[i] + nums[left] + nums[right];\n                tempMin = Math.abs(temp - target);\n\n                if (tempMin < min) {\n                    min = tempMin;\n                    res = temp;\n                }\n\n                if (temp < target) {\n                    left++;\n                } else if (temp > target) {\n                    right--;\n                } else {\n                    return target;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n\n/**\n执行用时 :5 ms, 在所有 Java 提交中击败了95.39%的用户\n*/\n```\n\n数组首先排序，循环n次，左右指针在`i ~ nums.length - 1`范围内移动，判定`left`<`right`.  \n`min`用来存储最小差值，当有三数之和与`target`小于该值便将其赋值给`res`.\n\n> Reference  \n> https://leetcode-cn.com/problems/3sum-closest\n","source":"_posts/leetcode/mostclose.md","raw":"# 最接近的三数之和\n\n给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。\n\n**例如**\n\n给定数组 nums = [-1，2，1，-4], 和 target = 1.\n与 target 最接近的三个数的和为 2. (-1 + 2 + 1 = 2).\n\n```java\nclass Solution {\n    public int threeSumClosest(int[] nums, int target) {\n        int temp = nums[0] + nums[1] + nums[2];\n        int res = temp;\n        int min = Math.abs(temp - target);\n        int tempMin;\n        Arrays.sort(nums);\n\n        for (int i = 0; i < nums.length - 2; i++) {\n            int left = i + 1, right = nums.length - 1;\n\n            while (left < right) {\n                temp = nums[i] + nums[left] + nums[right];\n                tempMin = Math.abs(temp - target);\n\n                if (tempMin < min) {\n                    min = tempMin;\n                    res = temp;\n                }\n\n                if (temp < target) {\n                    left++;\n                } else if (temp > target) {\n                    right--;\n                } else {\n                    return target;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n\n/**\n执行用时 :5 ms, 在所有 Java 提交中击败了95.39%的用户\n*/\n```\n\n数组首先排序，循环n次，左右指针在`i ~ nums.length - 1`范围内移动，判定`left`<`right`.  \n`min`用来存储最小差值，当有三数之和与`target`小于该值便将其赋值给`res`.\n\n> Reference  \n> https://leetcode-cn.com/problems/3sum-closest\n","slug":"leetcode/mostclose","published":1,"date":"2020-03-05T14:04:46.441Z","updated":"2020-03-05T14:14:44.440Z","title":"leetcode/mostclose","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yw003t018oecsah603","content":"<h1 id=\"最接近的三数之和\"><a href=\"#最接近的三数之和\" class=\"headerlink\" title=\"最接近的三数之和\"></a>最接近的三数之和</h1><p>给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。</p>\n<p><strong>例如</strong></p>\n<p>给定数组 nums = [-1，2，1，-4], 和 target = 1.<br>与 target 最接近的三个数的和为 2. (-1 + 2 + 1 = 2).</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">threeSumClosest</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp = nums[<span class=\"number\">0</span>] + nums[<span class=\"number\">1</span>] + nums[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = temp;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> min = Math.abs(temp - target);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> tempMin;</span><br><span class=\"line\">        Arrays.sort(nums);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length - <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> left = i + <span class=\"number\">1</span>, right = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right) &#123;</span><br><span class=\"line\">                temp = nums[i] + nums[left] + nums[right];</span><br><span class=\"line\">                tempMin = Math.abs(temp - target);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tempMin &lt; min) &#123;</span><br><span class=\"line\">                    min = tempMin;</span><br><span class=\"line\">                    res = temp;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (temp &lt; target) &#123;</span><br><span class=\"line\">                    left++;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (temp &gt; target) &#123;</span><br><span class=\"line\">                    right--;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> target;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :5 ms, 在所有 Java 提交中击败了95.39%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>数组首先排序，循环n次，左右指针在<code>i ~ nums.length - 1</code>范围内移动，判定<code>left</code>&lt;<code>right</code>.<br><code>min</code>用来存储最小差值，当有三数之和与<code>target</code>小于该值便将其赋值给<code>res</code>.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvM3N1bS1jbG9zZXN0\">https://leetcode-cn.com/problems/3sum-closest<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"最接近的三数之和\"><a href=\"#最接近的三数之和\" class=\"headerlink\" title=\"最接近的三数之和\"></a>最接近的三数之和</h1><p>给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。</p>\n<p><strong>例如</strong></p>\n<p>给定数组 nums = [-1，2，1，-4], 和 target = 1.<br>与 target 最接近的三个数的和为 2. (-1 + 2 + 1 = 2).</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">threeSumClosest</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> temp = nums[<span class=\"number\">0</span>] + nums[<span class=\"number\">1</span>] + nums[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = temp;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> min = Math.abs(temp - target);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> tempMin;</span><br><span class=\"line\">        Arrays.sort(nums);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length - <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> left = i + <span class=\"number\">1</span>, right = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (left &lt; right) &#123;</span><br><span class=\"line\">                temp = nums[i] + nums[left] + nums[right];</span><br><span class=\"line\">                tempMin = Math.abs(temp - target);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (tempMin &lt; min) &#123;</span><br><span class=\"line\">                    min = tempMin;</span><br><span class=\"line\">                    res = temp;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (temp &lt; target) &#123;</span><br><span class=\"line\">                    left++;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (temp &gt; target) &#123;</span><br><span class=\"line\">                    right--;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> target;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :5 ms, 在所有 Java 提交中击败了95.39%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>数组首先排序，循环n次，左右指针在<code>i ~ nums.length - 1</code>范围内移动，判定<code>left</code>&lt;<code>right</code>.<br><code>min</code>用来存储最小差值，当有三数之和与<code>target</code>小于该值便将其赋值给<code>res</code>.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvM3N1bS1jbG9zZXN0\">https://leetcode-cn.com/problems/3sum-closest<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 合并两个有序链表\n\n将两个有序链表合并为一个新的有序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 \n\n**示例**：\n\n输入：1->2->4, 1->3->4\n输出：1->1->2->3->4->4\n\n```java\nListNode mergeTwoLists(ListNode l1, ListNode l2) {\n    if (l1 == null | l2 == null) {\n        if (l1 == null & l2 == null) {\n            return null;\n        }\n        if (l1 != null) {\n            return l1;\n        }\n        if (l2 != null) {\n            return l2;\n        }\n    }\n    ListNode res = new ListNode(0);\n    ListNode temp = res;\n    while (l1 != null & l2 != null) {\n        if (l1.val <= l2.val) {\n            temp.val = l1.val;\n            temp.next = new ListNode(0);\n            temp = temp.next;\n            l1 = l1.next;\n        } else {\n            temp.val = l2.val;\n            temp.next = new ListNode(0);\n            temp = temp.next;\n            l2 = l2.next;\n        }\n    }\n\n    if (l1 != null) {\n        temp.val = l1.val;\n        while (l1.next != null) {\n            temp.next = new ListNode(l1.next.val);\n            temp = temp.next;\n            l1 = l1.next;\n        }\n    } else {\n        temp.val = l2.val;\n        while (l2.next != null) {\n            temp.next = new ListNode(l2.next.val);\n             temp = temp.next;\n            l2 = l2.next;\n        }\n    }\n\n    return res;\n\n/* \n执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户\n内存消耗 :38.5 MB, 在所有 Java 提交中击败了51.34%的用户 \n*/\n}\n```\nThe code is too complicated. I'm going on to simplify it.\n\n\nHere is an updated code after I read the official document.\n```java\npublic ListNode mergeTwoLists(ListNode l1, ListNode l2) {\n    ListNode res = new ListNode(0);// Head Pointer\n    ListNode temp = res;\n    while (l1 != null & l2 != null) {\n        if (l1.val <= l2.val) {\n            temp.next = l1;\n            l1 = l1.next;\n        } else {\n            temp.next = l2;\n            l2 = l2.next;\n        }\n        temp = temp.next;\n    }\n    temp.next = (l1 == null) ? l2 : l1;\n    return res.next;\n\n/* 执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户\n内存消耗 :38.2 MB, 在所有 Java 提交中击败了55.50%的用户 \n*/\n}\n```\n**This is a nice solution to have a head pointer, which means we haven't to modified current `temp.val` and register a new object on the `temp.next`. Also we needn't to care whether `l1` or `l2` is `null`**\n\n> Reference  \n> https://leetcode-cn.com/problems/merge-two-sorted-lists\n","source":"_posts/leetcode/mergelist.md","raw":"# 合并两个有序链表\n\n将两个有序链表合并为一个新的有序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 \n\n**示例**：\n\n输入：1->2->4, 1->3->4\n输出：1->1->2->3->4->4\n\n```java\nListNode mergeTwoLists(ListNode l1, ListNode l2) {\n    if (l1 == null | l2 == null) {\n        if (l1 == null & l2 == null) {\n            return null;\n        }\n        if (l1 != null) {\n            return l1;\n        }\n        if (l2 != null) {\n            return l2;\n        }\n    }\n    ListNode res = new ListNode(0);\n    ListNode temp = res;\n    while (l1 != null & l2 != null) {\n        if (l1.val <= l2.val) {\n            temp.val = l1.val;\n            temp.next = new ListNode(0);\n            temp = temp.next;\n            l1 = l1.next;\n        } else {\n            temp.val = l2.val;\n            temp.next = new ListNode(0);\n            temp = temp.next;\n            l2 = l2.next;\n        }\n    }\n\n    if (l1 != null) {\n        temp.val = l1.val;\n        while (l1.next != null) {\n            temp.next = new ListNode(l1.next.val);\n            temp = temp.next;\n            l1 = l1.next;\n        }\n    } else {\n        temp.val = l2.val;\n        while (l2.next != null) {\n            temp.next = new ListNode(l2.next.val);\n             temp = temp.next;\n            l2 = l2.next;\n        }\n    }\n\n    return res;\n\n/* \n执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户\n内存消耗 :38.5 MB, 在所有 Java 提交中击败了51.34%的用户 \n*/\n}\n```\nThe code is too complicated. I'm going on to simplify it.\n\n\nHere is an updated code after I read the official document.\n```java\npublic ListNode mergeTwoLists(ListNode l1, ListNode l2) {\n    ListNode res = new ListNode(0);// Head Pointer\n    ListNode temp = res;\n    while (l1 != null & l2 != null) {\n        if (l1.val <= l2.val) {\n            temp.next = l1;\n            l1 = l1.next;\n        } else {\n            temp.next = l2;\n            l2 = l2.next;\n        }\n        temp = temp.next;\n    }\n    temp.next = (l1 == null) ? l2 : l1;\n    return res.next;\n\n/* 执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户\n内存消耗 :38.2 MB, 在所有 Java 提交中击败了55.50%的用户 \n*/\n}\n```\n**This is a nice solution to have a head pointer, which means we haven't to modified current `temp.val` and register a new object on the `temp.next`. Also we needn't to care whether `l1` or `l2` is `null`**\n\n> Reference  \n> https://leetcode-cn.com/problems/merge-two-sorted-lists\n","slug":"leetcode/mergelist","published":1,"date":"2020-03-07T14:19:23.094Z","updated":"2020-03-07T14:30:23.868Z","title":"leetcode/mergelist","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yx003w018o4ntmhpdh","content":"<h1 id=\"合并两个有序链表\"><a href=\"#合并两个有序链表\" class=\"headerlink\" title=\"合并两个有序链表\"></a>合并两个有序链表</h1><p>将两个有序链表合并为一个新的有序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 </p>\n<p><strong>示例</strong>：</p>\n<p>输入：1-&gt;2-&gt;4, 1-&gt;3-&gt;4<br>输出：1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ListNode <span class=\"title\">mergeTwoLists</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l1 == <span class=\"keyword\">null</span> | l2 == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1 == <span class=\"keyword\">null</span> &amp; l2 == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l1;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ListNode res = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">    ListNode temp = res;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (l1 != <span class=\"keyword\">null</span> &amp; l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1.val &lt;= l2.val) &#123;</span><br><span class=\"line\">            temp.val = l1.val;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            temp.val = l2.val;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l1 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        temp.val = l1.val;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(l1.next.val);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        temp.val = l2.val;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(l2.next.val);</span><br><span class=\"line\">             temp = temp.next;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.5 MB, 在所有 Java 提交中击败了51.34%的用户 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>The code is too complicated. I’m going on to simplify it.</p>\n<p>Here is an updated code after I read the official document.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">mergeTwoLists</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">    ListNode res = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);<span class=\"comment\">// Head Pointer</span></span><br><span class=\"line\">    ListNode temp = res;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (l1 != <span class=\"keyword\">null</span> &amp; l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1.val &lt;= l2.val) &#123;</span><br><span class=\"line\">            temp.next = l1;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            temp.next = l2;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        temp = temp.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    temp.next = (l1 == <span class=\"keyword\">null</span>) ? l2 : l1;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res.next;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.2 MB, 在所有 Java 提交中击败了55.50%的用户 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>This is a nice solution to have a head pointer, which means we haven’t to modified current <code>temp.val</code> and register a new object on the <code>temp.next</code>. Also we needn’t to care whether <code>l1</code> or <code>l2</code> is <code>null</code></strong></p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWVyZ2UtdHdvLXNvcnRlZC1saXN0cw==\">https://leetcode-cn.com/problems/merge-two-sorted-lists<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"合并两个有序链表\"><a href=\"#合并两个有序链表\" class=\"headerlink\" title=\"合并两个有序链表\"></a>合并两个有序链表</h1><p>将两个有序链表合并为一个新的有序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 </p>\n<p><strong>示例</strong>：</p>\n<p>输入：1-&gt;2-&gt;4, 1-&gt;3-&gt;4<br>输出：1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ListNode <span class=\"title\">mergeTwoLists</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l1 == <span class=\"keyword\">null</span> | l2 == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1 == <span class=\"keyword\">null</span> &amp; l2 == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l1;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ListNode res = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">    ListNode temp = res;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (l1 != <span class=\"keyword\">null</span> &amp; l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1.val &lt;= l2.val) &#123;</span><br><span class=\"line\">            temp.val = l1.val;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            temp.val = l2.val;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l1 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        temp.val = l1.val;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l1.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(l1.next.val);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        temp.val = l2.val;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l2.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            temp.next = <span class=\"keyword\">new</span> ListNode(l2.next.val);</span><br><span class=\"line\">             temp = temp.next;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.5 MB, 在所有 Java 提交中击败了51.34%的用户 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>The code is too complicated. I’m going on to simplify it.</p>\n<p>Here is an updated code after I read the official document.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">mergeTwoLists</span><span class=\"params\">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class=\"line\">    ListNode res = <span class=\"keyword\">new</span> ListNode(<span class=\"number\">0</span>);<span class=\"comment\">// Head Pointer</span></span><br><span class=\"line\">    ListNode temp = res;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (l1 != <span class=\"keyword\">null</span> &amp; l2 != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1.val &lt;= l2.val) &#123;</span><br><span class=\"line\">            temp.next = l1;</span><br><span class=\"line\">            l1 = l1.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            temp.next = l2;</span><br><span class=\"line\">            l2 = l2.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        temp = temp.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    temp.next = (l1 == <span class=\"keyword\">null</span>) ? l2 : l1;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res.next;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 执行用时 :1 ms, 在所有 Java 提交中击败了83.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.2 MB, 在所有 Java 提交中击败了55.50%的用户 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>This is a nice solution to have a head pointer, which means we haven’t to modified current <code>temp.val</code> and register a new object on the <code>temp.next</code>. Also we needn’t to care whether <code>l1</code> or <code>l2</code> is <code>null</code></strong></p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbWVyZ2UtdHdvLXNvcnRlZC1saXN0cw==\">https://leetcode-cn.com/problems/merge-two-sorted-lists<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Recover Binary Search Tree\nTwo elements of a binary search tree (BST) are swapped by mistake.\n\nRecover the tree without changing its structure.\n\nExample 1:\n\nInput: [1,3,null,null,2]\n\n   1\n  /\n 3\n  \\\n   2\n\nOutput: [3,1,null,null,2]\n\n   3\n  /\n 1\n  \\\n   2\nExample 2:\n\nInput: [3,1,4,null,null,2]\n\n  3\n / \\\n1   4\n   /\n  2\n\nOutput: [2,1,4,null,null,3]\n\n  2\n / \\\n1   4\n   /\n  3\nFollow up:\n\nA solution using O(n) space is pretty straight forward.\nCould you devise a constant space solution?\n\n*Unsolved*\n```java\nclass Solution {\n  public void inorder(TreeNode root, List<Integer> nums) {\n    if (root == null) return;\n    inorder(root.left, nums);\n    nums.add(root.val);\n    inorder(root.right, nums);\n  }\n\n  public int[] findTwoSwapped(List<Integer> nums) {\n    int n = nums.size();\n    int x = -1, y = -1;\n    for(int i = 0; i < n - 1; ++i) {\n      if (nums.get(i + 1) < nums.get(i)) {\n        y = nums.get(i + 1);\n        // first swap occurence\n        if (x == -1) x = nums.get(i);\n        // second swap occurence\n        else break;\n      }\n    }\n    return new int[]{x, y};\n  }\n\n  public void recover(TreeNode r, int count, int x, int y) {\n    if (r != null) {\n      if (r.val == x || r.val == y) {\n        r.val = r.val == x ? y : x;\n        if (--count == 0) return;\n      }\n      recover(r.left, count, x, y);\n      recover(r.right, count, x, y);\n    }\n  }\n\n  public void recoverTree(TreeNode root) {\n    List<Integer> nums = new ArrayList();\n    inorder(root, nums);\n    int[] swapped = findTwoSwapped(nums);\n    recover(root, 2, swapped[0], swapped[1]);\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/recover-binary-search-tree","source":"_posts/leetcode/recoverbinarytree.md","raw":"# Recover Binary Search Tree\nTwo elements of a binary search tree (BST) are swapped by mistake.\n\nRecover the tree without changing its structure.\n\nExample 1:\n\nInput: [1,3,null,null,2]\n\n   1\n  /\n 3\n  \\\n   2\n\nOutput: [3,1,null,null,2]\n\n   3\n  /\n 1\n  \\\n   2\nExample 2:\n\nInput: [3,1,4,null,null,2]\n\n  3\n / \\\n1   4\n   /\n  2\n\nOutput: [2,1,4,null,null,3]\n\n  2\n / \\\n1   4\n   /\n  3\nFollow up:\n\nA solution using O(n) space is pretty straight forward.\nCould you devise a constant space solution?\n\n*Unsolved*\n```java\nclass Solution {\n  public void inorder(TreeNode root, List<Integer> nums) {\n    if (root == null) return;\n    inorder(root.left, nums);\n    nums.add(root.val);\n    inorder(root.right, nums);\n  }\n\n  public int[] findTwoSwapped(List<Integer> nums) {\n    int n = nums.size();\n    int x = -1, y = -1;\n    for(int i = 0; i < n - 1; ++i) {\n      if (nums.get(i + 1) < nums.get(i)) {\n        y = nums.get(i + 1);\n        // first swap occurence\n        if (x == -1) x = nums.get(i);\n        // second swap occurence\n        else break;\n      }\n    }\n    return new int[]{x, y};\n  }\n\n  public void recover(TreeNode r, int count, int x, int y) {\n    if (r != null) {\n      if (r.val == x || r.val == y) {\n        r.val = r.val == x ? y : x;\n        if (--count == 0) return;\n      }\n      recover(r.left, count, x, y);\n      recover(r.right, count, x, y);\n    }\n  }\n\n  public void recoverTree(TreeNode root) {\n    List<Integer> nums = new ArrayList();\n    inorder(root, nums);\n    int[] swapped = findTwoSwapped(nums);\n    recover(root, 2, swapped[0], swapped[1]);\n  }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/recover-binary-search-tree","slug":"leetcode/recoverbinarytree","published":1,"date":"2020-03-24T15:09:28.255Z","updated":"2020-03-24T15:11:26.121Z","title":"leetcode/recoverbinarytree","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yy003x018o6cfk118i","content":"<h1 id=\"Recover-Binary-Search-Tree\"><a href=\"#Recover-Binary-Search-Tree\" class=\"headerlink\" title=\"Recover Binary Search Tree\"></a>Recover Binary Search Tree</h1><p>Two elements of a binary search tree (BST) are swapped by mistake.</p>\n<p>Recover the tree without changing its structure.</p>\n<p>Example 1:</p>\n<p>Input: [1,3,null,null,2]</p>\n<p>   1<br>  /<br> 3<br>  <br>   2</p>\n<p>Output: [3,1,null,null,2]</p>\n<p>   3<br>  /<br> 1<br>  <br>   2<br>Example 2:</p>\n<p>Input: [3,1,4,null,null,2]</p>\n<p>  3<br> / <br>1   4<br>   /<br>  2</p>\n<p>Output: [2,1,4,null,null,3]</p>\n<p>  2<br> / <br>1   4<br>   /<br>  3<br>Follow up:</p>\n<p>A solution using O(n) space is pretty straight forward.<br>Could you devise a constant space solution?</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">inorder</span><span class=\"params\">(TreeNode root, List&lt;Integer&gt; nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    inorder(root.left, nums);</span><br><span class=\"line\">    nums.add(root.val);</span><br><span class=\"line\">    inorder(root.right, nums);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] findTwoSwapped(List&lt;Integer&gt; nums) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = nums.size();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> x = -<span class=\"number\">1</span>, y = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n - <span class=\"number\">1</span>; ++i) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (nums.get(i + <span class=\"number\">1</span>) &lt; nums.get(i)) &#123;</span><br><span class=\"line\">        y = nums.get(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// first swap occurence</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == -<span class=\"number\">1</span>) x = nums.get(i);</span><br><span class=\"line\">        <span class=\"comment\">// second swap occurence</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;x, y&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">recover</span><span class=\"params\">(TreeNode r, <span class=\"keyword\">int</span> count, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (r.val == x || r.val == y) &#123;</span><br><span class=\"line\">        r.val = r.val == x ? y : x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (--count == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      recover(r.left, count, x, y);</span><br><span class=\"line\">      recover(r.right, count, x, y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">recoverTree</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;Integer&gt; nums = <span class=\"keyword\">new</span> ArrayList();</span><br><span class=\"line\">    inorder(root, nums);</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] swapped = findTwoSwapped(nums);</span><br><span class=\"line\">    recover(root, <span class=\"number\">2</span>, swapped[<span class=\"number\">0</span>], swapped[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVjb3Zlci1iaW5hcnktc2VhcmNoLXRyZWU=\">https://leetcode-cn.com/problems/recover-binary-search-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Recover-Binary-Search-Tree\"><a href=\"#Recover-Binary-Search-Tree\" class=\"headerlink\" title=\"Recover Binary Search Tree\"></a>Recover Binary Search Tree</h1><p>Two elements of a binary search tree (BST) are swapped by mistake.</p>\n<p>Recover the tree without changing its structure.</p>\n<p>Example 1:</p>\n<p>Input: [1,3,null,null,2]</p>\n<p>   1<br>  /<br> 3<br>  <br>   2</p>\n<p>Output: [3,1,null,null,2]</p>\n<p>   3<br>  /<br> 1<br>  <br>   2<br>Example 2:</p>\n<p>Input: [3,1,4,null,null,2]</p>\n<p>  3<br> / <br>1   4<br>   /<br>  2</p>\n<p>Output: [2,1,4,null,null,3]</p>\n<p>  2<br> / <br>1   4<br>   /<br>  3<br>Follow up:</p>\n<p>A solution using O(n) space is pretty straight forward.<br>Could you devise a constant space solution?</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">inorder</span><span class=\"params\">(TreeNode root, List&lt;Integer&gt; nums)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    inorder(root.left, nums);</span><br><span class=\"line\">    nums.add(root.val);</span><br><span class=\"line\">    inorder(root.right, nums);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] findTwoSwapped(List&lt;Integer&gt; nums) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = nums.size();</span><br><span class=\"line\">    <span class=\"keyword\">int</span> x = -<span class=\"number\">1</span>, y = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n - <span class=\"number\">1</span>; ++i) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (nums.get(i + <span class=\"number\">1</span>) &lt; nums.get(i)) &#123;</span><br><span class=\"line\">        y = nums.get(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// first swap occurence</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (x == -<span class=\"number\">1</span>) x = nums.get(i);</span><br><span class=\"line\">        <span class=\"comment\">// second swap occurence</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;x, y&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">recover</span><span class=\"params\">(TreeNode r, <span class=\"keyword\">int</span> count, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (r != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (r.val == x || r.val == y) &#123;</span><br><span class=\"line\">        r.val = r.val == x ? y : x;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (--count == <span class=\"number\">0</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      recover(r.left, count, x, y);</span><br><span class=\"line\">      recover(r.right, count, x, y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">recoverTree</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\">    List&lt;Integer&gt; nums = <span class=\"keyword\">new</span> ArrayList();</span><br><span class=\"line\">    inorder(root, nums);</span><br><span class=\"line\">    <span class=\"keyword\">int</span>[] swapped = findTwoSwapped(nums);</span><br><span class=\"line\">    recover(root, <span class=\"number\">2</span>, swapped[<span class=\"number\">0</span>], swapped[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVjb3Zlci1iaW5hcnktc2VhcmNoLXRyZWU=\">https://leetcode-cn.com/problems/recover-binary-search-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Day03 - 移除元素\n\n给定一个数组 nums 和一个值 val，你需要原地移除所有数值等于 val 的元素，返回移除后数组的新长度。\n\n不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。\n\n元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。\n\n**示例 1:** \n\n给定 nums = [3,2,2,3], val = 3,函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。你不需要考虑数组中超出新长度后面的元素. \n\n```java\nclass Solution {\n    public int removeElement(int[] nums, int val) {\n        int res = 0;\n\n        for (int i = 0; i < nums.length; i++) {\n            if (nums[i] != val) {\n                nums[res] = nums[i];\n                res++;\n            }\n        }\n\n        return res;\n    }\n}\n\n/**\n执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户\n内存消耗 :38.1 MB, 在所有 Java 提交中击败了5.05%的用户\n*/\n```\n\n`res`记录新数组长度，遍历一遍数组满足条件则在相应位置赋值。\n\n> Reference  \n> https://leetcode-cn.com/problems/remove-element\n\n","source":"_posts/leetcode/removeelements.md","raw":"# Day03 - 移除元素\n\n给定一个数组 nums 和一个值 val，你需要原地移除所有数值等于 val 的元素，返回移除后数组的新长度。\n\n不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。\n\n元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。\n\n**示例 1:** \n\n给定 nums = [3,2,2,3], val = 3,函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。你不需要考虑数组中超出新长度后面的元素. \n\n```java\nclass Solution {\n    public int removeElement(int[] nums, int val) {\n        int res = 0;\n\n        for (int i = 0; i < nums.length; i++) {\n            if (nums[i] != val) {\n                nums[res] = nums[i];\n                res++;\n            }\n        }\n\n        return res;\n    }\n}\n\n/**\n执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户\n内存消耗 :38.1 MB, 在所有 Java 提交中击败了5.05%的用户\n*/\n```\n\n`res`记录新数组长度，遍历一遍数组满足条件则在相应位置赋值。\n\n> Reference  \n> https://leetcode-cn.com/problems/remove-element\n\n","slug":"leetcode/removeelements","published":1,"date":"2020-03-03T13:36:04.378Z","updated":"2020-03-05T14:10:33.548Z","title":"leetcode/removeelements","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yy003y018oechh8lgi","content":"<h1 id=\"Day03-移除元素\"><a href=\"#Day03-移除元素\" class=\"headerlink\" title=\"Day03 - 移除元素\"></a>Day03 - 移除元素</h1><p>给定一个数组 nums 和一个值 val，你需要原地移除所有数值等于 val 的元素，返回移除后数组的新长度。</p>\n<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>\n<p>元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。</p>\n<p><strong>示例 1:</strong> </p>\n<p>给定 nums = [3,2,2,3], val = 3,函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。你不需要考虑数组中超出新长度后面的元素. </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">removeElement</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> val)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[i] != val) &#123;</span><br><span class=\"line\">                nums[res] = nums[i];</span><br><span class=\"line\">                res++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.1 MB, 在所有 Java 提交中击败了5.05%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><code>res</code>记录新数组长度，遍历一遍数组满足条件则在相应位置赋值。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWVsZW1lbnQ=\">https://leetcode-cn.com/problems/remove-element<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Day03-移除元素\"><a href=\"#Day03-移除元素\" class=\"headerlink\" title=\"Day03 - 移除元素\"></a>Day03 - 移除元素</h1><p>给定一个数组 nums 和一个值 val，你需要原地移除所有数值等于 val 的元素，返回移除后数组的新长度。</p>\n<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>\n<p>元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。</p>\n<p><strong>示例 1:</strong> </p>\n<p>给定 nums = [3,2,2,3], val = 3,函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。你不需要考虑数组中超出新长度后面的元素. </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">removeElement</span><span class=\"params\">(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> val)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[i] != val) &#123;</span><br><span class=\"line\">                nums[res] = nums[i];</span><br><span class=\"line\">                res++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :38.1 MB, 在所有 Java 提交中击败了5.05%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p><code>res</code>记录新数组长度，遍历一遍数组满足条件则在相应位置赋值。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLWVsZW1lbnQ=\">https://leetcode-cn.com/problems/remove-element<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Longest Common Prefix\nWrite a function to find the longest common prefix string amongst an array of strings.\n\nIf there is no common prefix, return an empty string \"\".\n\n**Example 1:**\n\nInput: [\"flower\",\"flow\",\"flight\"]\nOutput: \"fl\"\n\n**Example 2:**\n\nInput: [\"dog\",\"racecar\",\"car\"]\nOutput: \"\"\nExplanation: There is no common prefix among the input strings.\n\n**Note:**\n\nAll given inputs are in lowercase letters a-z.\n\n*Unsolved*\n```\nInput:\n[\"aa\",\"a\"]\nOutput:\n\"aa\"\nAnswer:\n\"a\"\n```\n```java\nclass Solution {\n    public static String longestCommonPrefix(String[] strs) {\n        if (strs == null)\n            return \"\";\n\n        String res = strs[0];\n        char[] resChar = res.toCharArray();\n\n        for (int i = 0; i < strs.length; i++) {\n            char[] tempChar = strs[i].toCharArray();\n            for (int j = 0; j < tempChar.length & j < resChar.length; j++) {\n                if (resChar[j] != tempChar[j]) {\n                    res = strs[i].substring(0, j);\n                    resChar = res.toCharArray();\n                    break;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n```\n\n**LeetCode Solution**\n```java\npublic String longestCommonPrefix(String[] strs) {\n   if (strs.length == 0) return \"\";\n   String prefix = strs[0];\n   for (int i = 1; i < strs.length; i++)\n       while (strs[i].indexOf(prefix) != 0) {\n           prefix = prefix.substring(0, prefix.length() - 1);\n           if (prefix.isEmpty()) return \"\";\n       }        \n   return prefix;\n}\n```\nNice idea to use substring to find out what index is it. If `strs` doesn't have a substring the index can not be 0. All we need to do is cut the `prefix`'s length.\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-common-prefix\n","source":"_posts/leetcode/maxpublicex.md","raw":"# Longest Common Prefix\nWrite a function to find the longest common prefix string amongst an array of strings.\n\nIf there is no common prefix, return an empty string \"\".\n\n**Example 1:**\n\nInput: [\"flower\",\"flow\",\"flight\"]\nOutput: \"fl\"\n\n**Example 2:**\n\nInput: [\"dog\",\"racecar\",\"car\"]\nOutput: \"\"\nExplanation: There is no common prefix among the input strings.\n\n**Note:**\n\nAll given inputs are in lowercase letters a-z.\n\n*Unsolved*\n```\nInput:\n[\"aa\",\"a\"]\nOutput:\n\"aa\"\nAnswer:\n\"a\"\n```\n```java\nclass Solution {\n    public static String longestCommonPrefix(String[] strs) {\n        if (strs == null)\n            return \"\";\n\n        String res = strs[0];\n        char[] resChar = res.toCharArray();\n\n        for (int i = 0; i < strs.length; i++) {\n            char[] tempChar = strs[i].toCharArray();\n            for (int j = 0; j < tempChar.length & j < resChar.length; j++) {\n                if (resChar[j] != tempChar[j]) {\n                    res = strs[i].substring(0, j);\n                    resChar = res.toCharArray();\n                    break;\n                }\n            }\n        }\n\n        return res;\n    }\n}\n```\n\n**LeetCode Solution**\n```java\npublic String longestCommonPrefix(String[] strs) {\n   if (strs.length == 0) return \"\";\n   String prefix = strs[0];\n   for (int i = 1; i < strs.length; i++)\n       while (strs[i].indexOf(prefix) != 0) {\n           prefix = prefix.substring(0, prefix.length() - 1);\n           if (prefix.isEmpty()) return \"\";\n       }        \n   return prefix;\n}\n```\nNice idea to use substring to find out what index is it. If `strs` doesn't have a substring the index can not be 0. All we need to do is cut the `prefix`'s length.\n\n> Reference  \n> https://leetcode-cn.com/problems/longest-common-prefix\n","slug":"leetcode/maxpublicex","published":1,"date":"2020-03-14T14:51:58.875Z","updated":"2020-03-14T14:59:09.229Z","title":"leetcode/maxpublicex","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yz0041018o02mf9a1c","content":"<h1 id=\"Longest-Common-Prefix\"><a href=\"#Longest-Common-Prefix\" class=\"headerlink\" title=\"Longest Common Prefix\"></a>Longest Common Prefix</h1><p>Write a function to find the longest common prefix string amongst an array of strings.</p>\n<p>If there is no common prefix, return an empty string “”.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: [“flower”,”flow”,”flight”]<br>Output: “fl”</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: [“dog”,”racecar”,”car”]<br>Output: “”<br>Explanation: There is no common prefix among the input strings.</p>\n<p><strong>Note:</strong></p>\n<p>All given inputs are in lowercase letters a-z.</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">[&quot;aa&quot;,&quot;a&quot;]</span><br><span class=\"line\">Output:</span><br><span class=\"line\">&quot;aa&quot;</span><br><span class=\"line\">Answer:</span><br><span class=\"line\">&quot;a&quot;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">longestCommonPrefix</span><span class=\"params\">(String[] strs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (strs == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        String res = strs[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] resChar = res.toCharArray();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strs.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span>[] tempChar = strs[i].toCharArray();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; tempChar.length &amp; j &lt; resChar.length; j++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (resChar[j] != tempChar[j]) &#123;</span><br><span class=\"line\">                    res = strs[i].substring(<span class=\"number\">0</span>, j);</span><br><span class=\"line\">                    resChar = res.toCharArray();</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>LeetCode Solution</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">longestCommonPrefix</span><span class=\"params\">(String[] strs)</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (strs.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">   String prefix = strs[<span class=\"number\">0</span>];</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; strs.length; i++)</span><br><span class=\"line\">       <span class=\"keyword\">while</span> (strs[i].indexOf(prefix) != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">           prefix = prefix.substring(<span class=\"number\">0</span>, prefix.length() - <span class=\"number\">1</span>);</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (prefix.isEmpty()) <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">       &#125;        </span><br><span class=\"line\">   <span class=\"keyword\">return</span> prefix;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Nice idea to use substring to find out what index is it. If <code>strs</code> doesn’t have a substring the index can not be 0. All we need to do is cut the <code>prefix</code>‘s length.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1jb21tb24tcHJlZml4\">https://leetcode-cn.com/problems/longest-common-prefix<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Longest-Common-Prefix\"><a href=\"#Longest-Common-Prefix\" class=\"headerlink\" title=\"Longest Common Prefix\"></a>Longest Common Prefix</h1><p>Write a function to find the longest common prefix string amongst an array of strings.</p>\n<p>If there is no common prefix, return an empty string “”.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: [“flower”,”flow”,”flight”]<br>Output: “fl”</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: [“dog”,”racecar”,”car”]<br>Output: “”<br>Explanation: There is no common prefix among the input strings.</p>\n<p><strong>Note:</strong></p>\n<p>All given inputs are in lowercase letters a-z.</p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">[&quot;aa&quot;,&quot;a&quot;]</span><br><span class=\"line\">Output:</span><br><span class=\"line\">&quot;aa&quot;</span><br><span class=\"line\">Answer:</span><br><span class=\"line\">&quot;a&quot;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">longestCommonPrefix</span><span class=\"params\">(String[] strs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (strs == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        String res = strs[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] resChar = res.toCharArray();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; strs.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span>[] tempChar = strs[i].toCharArray();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; tempChar.length &amp; j &lt; resChar.length; j++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (resChar[j] != tempChar[j]) &#123;</span><br><span class=\"line\">                    res = strs[i].substring(<span class=\"number\">0</span>, j);</span><br><span class=\"line\">                    resChar = res.toCharArray();</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>LeetCode Solution</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">longestCommonPrefix</span><span class=\"params\">(String[] strs)</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">if</span> (strs.length == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">   String prefix = strs[<span class=\"number\">0</span>];</span><br><span class=\"line\">   <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; strs.length; i++)</span><br><span class=\"line\">       <span class=\"keyword\">while</span> (strs[i].indexOf(prefix) != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">           prefix = prefix.substring(<span class=\"number\">0</span>, prefix.length() - <span class=\"number\">1</span>);</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (prefix.isEmpty()) <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">       &#125;        </span><br><span class=\"line\">   <span class=\"keyword\">return</span> prefix;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Nice idea to use substring to find out what index is it. If <code>strs</code> doesn’t have a substring the index can not be 0. All we need to do is cut the <code>prefix</code>‘s length.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvbG9uZ2VzdC1jb21tb24tcHJlZml4\">https://leetcode-cn.com/problems/longest-common-prefix<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Regular Expression Matching\nGiven an input string (s) and a pattern (p), implement regular expression matching with support for '.' and '*'.\n\n'.' Matches any single character.\n'*' Matches zero or more of the preceding element.\nThe matching should cover the entire input string (not partial).\n\n**Note:**\n\ns could be empty and contains only lowercase letters a-z.  \np could be empty and contains only lowercase letters a-z, and characters like . or *.  \n**Example 1:**\n\nInput:  \ns = \"aa\"  \np = \"a\"  \nOutput: false  \nExplanation: \"a\" does not match the entire string \"aa\".  \n\n**Example 2:**\n\nInput:  \ns = \"aa\"  \np = \"a*\"  \nOutput: true  \nExplanation: '*' means zero or more of the preceding element, 'a'. Therefore, by repeating 'a' once, it becomes \"aa\".    \n\n**Example 3:**\n\nInput:  \ns = \"ab\"  \np = \".*\"  \nOutput: true  \nExplanation: \".*\" means \"zero or more (*) of any character (.)\".  \n\n**Example 4:**\n\nInput:  \ns = \"aab\"  \np = \"c*a*b\"  \nOutput: true  \nExplanation: c can be repeated 0 times, a can be repeated 1 time. Therefore, it matches \"aab\".  \n\n**Example 5:**\n\nInput:  \ns = \"mississippi\"  \np = \"mis*is*p*.\"  \nOutput: false  \n\n*Unsolved*\n```java\nclass Solution {\n    public boolean isMatch(String text, String pattern) {\n        if (pattern.isEmpty()) return text.isEmpty();\n        boolean first_match = (!text.isEmpty() &&\n                               (pattern.charAt(0) == text.charAt(0) || pattern.charAt(0) == '.'));\n\n        if (pattern.length() >= 2 && pattern.charAt(1) == '*'){\n            return (isMatch(text, pattern.substring(2)) ||\n                    (first_match && isMatch(text.substring(1), pattern)));\n        } else {\n            return first_match && isMatch(text.substring(1), pattern.substring(1));\n        }\n    }\n}\n\n/* \nhttps://leetcode-cn.com/problems/regular-expression-matching/solution/zheng-ze-biao-da-shi-pi-pei-by-leetcode/\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/regular-expression-matching","source":"_posts/leetcode/regularexpressionmatching.md","raw":"# Regular Expression Matching\nGiven an input string (s) and a pattern (p), implement regular expression matching with support for '.' and '*'.\n\n'.' Matches any single character.\n'*' Matches zero or more of the preceding element.\nThe matching should cover the entire input string (not partial).\n\n**Note:**\n\ns could be empty and contains only lowercase letters a-z.  \np could be empty and contains only lowercase letters a-z, and characters like . or *.  \n**Example 1:**\n\nInput:  \ns = \"aa\"  \np = \"a\"  \nOutput: false  \nExplanation: \"a\" does not match the entire string \"aa\".  \n\n**Example 2:**\n\nInput:  \ns = \"aa\"  \np = \"a*\"  \nOutput: true  \nExplanation: '*' means zero or more of the preceding element, 'a'. Therefore, by repeating 'a' once, it becomes \"aa\".    \n\n**Example 3:**\n\nInput:  \ns = \"ab\"  \np = \".*\"  \nOutput: true  \nExplanation: \".*\" means \"zero or more (*) of any character (.)\".  \n\n**Example 4:**\n\nInput:  \ns = \"aab\"  \np = \"c*a*b\"  \nOutput: true  \nExplanation: c can be repeated 0 times, a can be repeated 1 time. Therefore, it matches \"aab\".  \n\n**Example 5:**\n\nInput:  \ns = \"mississippi\"  \np = \"mis*is*p*.\"  \nOutput: false  \n\n*Unsolved*\n```java\nclass Solution {\n    public boolean isMatch(String text, String pattern) {\n        if (pattern.isEmpty()) return text.isEmpty();\n        boolean first_match = (!text.isEmpty() &&\n                               (pattern.charAt(0) == text.charAt(0) || pattern.charAt(0) == '.'));\n\n        if (pattern.length() >= 2 && pattern.charAt(1) == '*'){\n            return (isMatch(text, pattern.substring(2)) ||\n                    (first_match && isMatch(text.substring(1), pattern)));\n        } else {\n            return first_match && isMatch(text.substring(1), pattern.substring(1));\n        }\n    }\n}\n\n/* \nhttps://leetcode-cn.com/problems/regular-expression-matching/solution/zheng-ze-biao-da-shi-pi-pei-by-leetcode/\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/regular-expression-matching","slug":"leetcode/regularexpressionmatching","published":1,"date":"2020-03-18T13:40:44.255Z","updated":"2020-03-18T13:43:07.639Z","title":"leetcode/regularexpressionmatching","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97yz0043018o2l004sy9","content":"<h1 id=\"Regular-Expression-Matching\"><a href=\"#Regular-Expression-Matching\" class=\"headerlink\" title=\"Regular Expression Matching\"></a>Regular Expression Matching</h1><p>Given an input string (s) and a pattern (p), implement regular expression matching with support for ‘.’ and ‘*’.</p>\n<p>‘.’ Matches any single character.<br>‘*’ Matches zero or more of the preceding element.<br>The matching should cover the entire input string (not partial).</p>\n<p><strong>Note:</strong></p>\n<p>s could be empty and contains only lowercase letters a-z.<br>p could be empty and contains only lowercase letters a-z, and characters like . or <em>.<br>*</em>Example 1:**</p>\n<p>Input:<br>s = “aa”<br>p = “a”<br>Output: false<br>Explanation: “a” does not match the entire string “aa”.  </p>\n<p><strong>Example 2:</strong></p>\n<p>Input:<br>s = “aa”<br>p = “a*”<br>Output: true<br>Explanation: ‘*’ means zero or more of the preceding element, ‘a’. Therefore, by repeating ‘a’ once, it becomes “aa”.    </p>\n<p><strong>Example 3:</strong></p>\n<p>Input:<br>s = “ab”<br>p = “.*”<br>Output: true<br>Explanation: “.*” means “zero or more (*) of any character (.)”.  </p>\n<p><strong>Example 4:</strong></p>\n<p>Input:<br>s = “aab”<br>p = “c<em>a</em>b”<br>Output: true<br>Explanation: c can be repeated 0 times, a can be repeated 1 time. Therefore, it matches “aab”.  </p>\n<p><strong>Example 5:</strong></p>\n<p>Input:<br>s = “mississippi”<br>p = “mis<em>is*p</em>.”<br>Output: false  </p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMatch</span><span class=\"params\">(String text, String pattern)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pattern.isEmpty()) <span class=\"keyword\">return</span> text.isEmpty();</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> first_match = (!text.isEmpty() &amp;&amp;</span><br><span class=\"line\">                               (pattern.charAt(<span class=\"number\">0</span>) == text.charAt(<span class=\"number\">0</span>) || pattern.charAt(<span class=\"number\">0</span>) == <span class=\"string\">'.'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pattern.length() &gt;= <span class=\"number\">2</span> &amp;&amp; pattern.charAt(<span class=\"number\">1</span>) == <span class=\"string\">'*'</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> (isMatch(text, pattern.substring(<span class=\"number\">2</span>)) ||</span><br><span class=\"line\">                    (first_match &amp;&amp; isMatch(text.substring(<span class=\"number\">1</span>), pattern)));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> first_match &amp;&amp; isMatch(text.substring(<span class=\"number\">1</span>), pattern.substring(<span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">https://leetcode-cn.com/problems/regular-expression-matching/solution/zheng-ze-biao-da-shi-pi-pei-by-leetcode/</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVndWxhci1leHByZXNzaW9uLW1hdGNoaW5n\">https://leetcode-cn.com/problems/regular-expression-matching<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Regular-Expression-Matching\"><a href=\"#Regular-Expression-Matching\" class=\"headerlink\" title=\"Regular Expression Matching\"></a>Regular Expression Matching</h1><p>Given an input string (s) and a pattern (p), implement regular expression matching with support for ‘.’ and ‘*’.</p>\n<p>‘.’ Matches any single character.<br>‘*’ Matches zero or more of the preceding element.<br>The matching should cover the entire input string (not partial).</p>\n<p><strong>Note:</strong></p>\n<p>s could be empty and contains only lowercase letters a-z.<br>p could be empty and contains only lowercase letters a-z, and characters like . or <em>.<br>*</em>Example 1:**</p>\n<p>Input:<br>s = “aa”<br>p = “a”<br>Output: false<br>Explanation: “a” does not match the entire string “aa”.  </p>\n<p><strong>Example 2:</strong></p>\n<p>Input:<br>s = “aa”<br>p = “a*”<br>Output: true<br>Explanation: ‘*’ means zero or more of the preceding element, ‘a’. Therefore, by repeating ‘a’ once, it becomes “aa”.    </p>\n<p><strong>Example 3:</strong></p>\n<p>Input:<br>s = “ab”<br>p = “.*”<br>Output: true<br>Explanation: “.*” means “zero or more (*) of any character (.)”.  </p>\n<p><strong>Example 4:</strong></p>\n<p>Input:<br>s = “aab”<br>p = “c<em>a</em>b”<br>Output: true<br>Explanation: c can be repeated 0 times, a can be repeated 1 time. Therefore, it matches “aab”.  </p>\n<p><strong>Example 5:</strong></p>\n<p>Input:<br>s = “mississippi”<br>p = “mis<em>is*p</em>.”<br>Output: false  </p>\n<p><em>Unsolved</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isMatch</span><span class=\"params\">(String text, String pattern)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pattern.isEmpty()) <span class=\"keyword\">return</span> text.isEmpty();</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> first_match = (!text.isEmpty() &amp;&amp;</span><br><span class=\"line\">                               (pattern.charAt(<span class=\"number\">0</span>) == text.charAt(<span class=\"number\">0</span>) || pattern.charAt(<span class=\"number\">0</span>) == <span class=\"string\">'.'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pattern.length() &gt;= <span class=\"number\">2</span> &amp;&amp; pattern.charAt(<span class=\"number\">1</span>) == <span class=\"string\">'*'</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> (isMatch(text, pattern.substring(<span class=\"number\">2</span>)) ||</span><br><span class=\"line\">                    (first_match &amp;&amp; isMatch(text.substring(<span class=\"number\">1</span>), pattern)));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> first_match &amp;&amp; isMatch(text.substring(<span class=\"number\">1</span>), pattern.substring(<span class=\"number\">1</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* </span></span><br><span class=\"line\"><span class=\"comment\">https://leetcode-cn.com/problems/regular-expression-matching/solution/zheng-ze-biao-da-shi-pi-pei-by-leetcode/</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVndWxhci1leHByZXNzaW9uLW1hdGNoaW5n\">https://leetcode-cn.com/problems/regular-expression-matching<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Remove Nth Node From End of List\n\nGiven a linked list, remove the n-th node from the end of list and return its head.\n\n**Example**:\n\nGiven linked list: 1->2->3->4->5, and n = 2.\n\nAfter removing the second node from the end, the linked list becomes 1->2->3->5.\n\n**Note**:\n\nGiven n will always be valid.\n\n**Solution One**\n```java\nclass Solution {\n    public ListNode removeNthFromEnd(ListNode head, int n) {\n        ListNode p = head;\n        ListNode temp = head;\n        int len = 1;\n\n        if (p == null)\n            return null;\n\n        while (p.next != null) {\n            len++;\n            p = p.next;\n        }\n\n        int loc = len - n;\n        \n        if (loc == 0) {\n            return head.next;\n        }\n\n        for (int i = 1; i < loc; i++) {\n            temp = temp.next;\n        }\n\n        temp.next = temp.next.next;\n\n        return head;\n    }\n}\n```\nPass one time and get the length of LinkedList, so just count `length - n - 1` times we can find the pre pointer. All we need to do is point pre pointer.next equal the next of which pointer we should delete.\n\n**Solution Two**\n```java\nclass Solution {\n    public ListNode removeNthFromEnd(ListNode head, int n) {\n        List<ListNode> stack = new LinkedList<>();\n        ListNode temp = head;\n\n        while (temp != null) {\n            stack.add(temp);\n            temp = temp.next;\n        }\n\n        ListNode[] list = stack.toArray(new ListNode[stack.size()]);\n\n        if ((list.length - n - 1) < 0) return head.next;\n\n        list[list.length - n - 1].next = list[list.length - n].next;\n\n        return head;\n    }\n}\n```\nJust let the List structure give a help, we can transfer a `LinkedList` to an `Array`. So all we need to do is let `list[list.length - n - 1].next` equals `list[list.length - n].next`. \n\nBase case: if delete the head node we just need to return `head.next`.\n\n> Reference  \n> https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list\n","source":"_posts/leetcode/removeend.md","raw":"# Remove Nth Node From End of List\n\nGiven a linked list, remove the n-th node from the end of list and return its head.\n\n**Example**:\n\nGiven linked list: 1->2->3->4->5, and n = 2.\n\nAfter removing the second node from the end, the linked list becomes 1->2->3->5.\n\n**Note**:\n\nGiven n will always be valid.\n\n**Solution One**\n```java\nclass Solution {\n    public ListNode removeNthFromEnd(ListNode head, int n) {\n        ListNode p = head;\n        ListNode temp = head;\n        int len = 1;\n\n        if (p == null)\n            return null;\n\n        while (p.next != null) {\n            len++;\n            p = p.next;\n        }\n\n        int loc = len - n;\n        \n        if (loc == 0) {\n            return head.next;\n        }\n\n        for (int i = 1; i < loc; i++) {\n            temp = temp.next;\n        }\n\n        temp.next = temp.next.next;\n\n        return head;\n    }\n}\n```\nPass one time and get the length of LinkedList, so just count `length - n - 1` times we can find the pre pointer. All we need to do is point pre pointer.next equal the next of which pointer we should delete.\n\n**Solution Two**\n```java\nclass Solution {\n    public ListNode removeNthFromEnd(ListNode head, int n) {\n        List<ListNode> stack = new LinkedList<>();\n        ListNode temp = head;\n\n        while (temp != null) {\n            stack.add(temp);\n            temp = temp.next;\n        }\n\n        ListNode[] list = stack.toArray(new ListNode[stack.size()]);\n\n        if ((list.length - n - 1) < 0) return head.next;\n\n        list[list.length - n - 1].next = list[list.length - n].next;\n\n        return head;\n    }\n}\n```\nJust let the List structure give a help, we can transfer a `LinkedList` to an `Array`. So all we need to do is let `list[list.length - n - 1].next` equals `list[list.length - n].next`. \n\nBase case: if delete the head node we just need to return `head.next`.\n\n> Reference  \n> https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list\n","slug":"leetcode/removeend","published":1,"date":"2020-03-11T13:10:04.043Z","updated":"2020-03-11T13:19:54.572Z","title":"leetcode/removeend","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z00045018obmxleavu","content":"<h1 id=\"Remove-Nth-Node-From-End-of-List\"><a href=\"#Remove-Nth-Node-From-End-of-List\" class=\"headerlink\" title=\"Remove Nth Node From End of List\"></a>Remove Nth Node From End of List</h1><p>Given a linked list, remove the n-th node from the end of list and return its head.</p>\n<p><strong>Example</strong>:</p>\n<p>Given linked list: 1-&gt;2-&gt;3-&gt;4-&gt;5, and n = 2.</p>\n<p>After removing the second node from the end, the linked list becomes 1-&gt;2-&gt;3-&gt;5.</p>\n<p><strong>Note</strong>:</p>\n<p>Given n will always be valid.</p>\n<p><strong>Solution One</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">removeNthFromEnd</span><span class=\"params\">(ListNode head, <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">        ListNode p = head;</span><br><span class=\"line\">        ListNode temp = head;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (p.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            len++;</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span> loc = len - n;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> (loc == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> head.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; loc; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        temp.next = temp.next.next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Pass one time and get the length of LinkedList, so just count <code>length - n - 1</code> times we can find the pre pointer. All we need to do is point pre pointer.next equal the next of which pointer we should delete.</p>\n<p><strong>Solution Two</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">removeNthFromEnd</span><span class=\"params\">(ListNode head, <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;ListNode&gt; stack = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">        ListNode temp = head;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (temp != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            stack.add(temp);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        ListNode[] list = stack.toArray(<span class=\"keyword\">new</span> ListNode[stack.size()]);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((list.length - n - <span class=\"number\">1</span>) &lt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> head.next;</span><br><span class=\"line\"></span><br><span class=\"line\">        list[list.length - n - <span class=\"number\">1</span>].next = list[list.length - n].next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Just let the List structure give a help, we can transfer a <code>LinkedList</code> to an <code>Array</code>. So all we need to do is let <code>list[list.length - n - 1].next</code> equals <code>list[list.length - n].next</code>. </p>\n<p>Base case: if delete the head node we just need to return <code>head.next</code>.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLW50aC1ub2RlLWZyb20tZW5kLW9mLWxpc3Q=\">https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Remove-Nth-Node-From-End-of-List\"><a href=\"#Remove-Nth-Node-From-End-of-List\" class=\"headerlink\" title=\"Remove Nth Node From End of List\"></a>Remove Nth Node From End of List</h1><p>Given a linked list, remove the n-th node from the end of list and return its head.</p>\n<p><strong>Example</strong>:</p>\n<p>Given linked list: 1-&gt;2-&gt;3-&gt;4-&gt;5, and n = 2.</p>\n<p>After removing the second node from the end, the linked list becomes 1-&gt;2-&gt;3-&gt;5.</p>\n<p><strong>Note</strong>:</p>\n<p>Given n will always be valid.</p>\n<p><strong>Solution One</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">removeNthFromEnd</span><span class=\"params\">(ListNode head, <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">        ListNode p = head;</span><br><span class=\"line\">        ListNode temp = head;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (p.next != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            len++;</span><br><span class=\"line\">            p = p.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span> loc = len - n;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> (loc == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> head.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; loc; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        temp.next = temp.next.next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Pass one time and get the length of LinkedList, so just count <code>length - n - 1</code> times we can find the pre pointer. All we need to do is point pre pointer.next equal the next of which pointer we should delete.</p>\n<p><strong>Solution Two</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ListNode <span class=\"title\">removeNthFromEnd</span><span class=\"params\">(ListNode head, <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;ListNode&gt; stack = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\">        ListNode temp = head;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (temp != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            stack.add(temp);</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        ListNode[] list = stack.toArray(<span class=\"keyword\">new</span> ListNode[stack.size()]);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((list.length - n - <span class=\"number\">1</span>) &lt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> head.next;</span><br><span class=\"line\"></span><br><span class=\"line\">        list[list.length - n - <span class=\"number\">1</span>].next = list[list.length - n].next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Just let the List structure give a help, we can transfer a <code>LinkedList</code> to an <code>Array</code>. So all we need to do is let <code>list[list.length - n - 1].next</code> equals <code>list[list.length - n].next</code>. </p>\n<p>Base case: if delete the head node we just need to return <code>head.next</code>.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcmVtb3ZlLW50aC1ub2RlLWZyb20tZW5kLW9mLWxpc3Q=\">https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Same Tree\nGiven two binary trees, write a function to check if they are the same or not.\n\nTwo binary trees are considered the same if they are structurally identical and the nodes have the same value.\n\n**Example 1:**\n\nInput:     1         1\n          / \\       / \\\n         2   3     2   3\n\n        [1,2,3],   [1,2,3]\n\nOutput: true\n\n**Example 2:**\n\nInput:     1         1\n          /           \\\n         2             2\n\n        [1,2],     [1,null,2]\n\nOutput: false\n\n**Example 3:**\n\nInput:     1         1\n          / \\       / \\\n         2   1     1   2\n\n        [1,2,1],   [1,1,2]\n\nOutput: false\n\n```java\nclass Solution {\n    public boolean isSameTree(TreeNode p, TreeNode q) {\n        if (p == null && q == null) {\n            return true;\n        }\n\n        if (p == null || q == null) {\n            return false;\n        }\n\n        if (p.val != q.val) { // !!!\n            return false;\n        }\n\n        return isSameTree(p.left, q.left) && isSameTree(p.right, q.right);\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/same-tree","source":"_posts/leetcode/sametree.md","raw":"# Same Tree\nGiven two binary trees, write a function to check if they are the same or not.\n\nTwo binary trees are considered the same if they are structurally identical and the nodes have the same value.\n\n**Example 1:**\n\nInput:     1         1\n          / \\       / \\\n         2   3     2   3\n\n        [1,2,3],   [1,2,3]\n\nOutput: true\n\n**Example 2:**\n\nInput:     1         1\n          /           \\\n         2             2\n\n        [1,2],     [1,null,2]\n\nOutput: false\n\n**Example 3:**\n\nInput:     1         1\n          / \\       / \\\n         2   1     1   2\n\n        [1,2,1],   [1,1,2]\n\nOutput: false\n\n```java\nclass Solution {\n    public boolean isSameTree(TreeNode p, TreeNode q) {\n        if (p == null && q == null) {\n            return true;\n        }\n\n        if (p == null || q == null) {\n            return false;\n        }\n\n        if (p.val != q.val) { // !!!\n            return false;\n        }\n\n        return isSameTree(p.left, q.left) && isSameTree(p.right, q.right);\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/same-tree","slug":"leetcode/sametree","published":1,"date":"2020-03-19T15:28:56.616Z","updated":"2020-03-19T15:48:52.468Z","title":"leetcode/sametree","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z10047018ohfcld2sj","content":"<h1 id=\"Same-Tree\"><a href=\"#Same-Tree\" class=\"headerlink\" title=\"Same Tree\"></a>Same Tree</h1><p>Given two binary trees, write a function to check if they are the same or not.</p>\n<p>Two binary trees are considered the same if they are structurally identical and the nodes have the same value.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input:     1         1<br>          / \\       / <br>         2   3     2   3</p>\n<pre><code>[1,2,3],   [1,2,3]</code></pre><p>Output: true</p>\n<p><strong>Example 2:</strong></p>\n<p>Input:     1         1<br>          /           <br>         2             2</p>\n<pre><code>[1,2],     [1,null,2]</code></pre><p>Output: false</p>\n<p><strong>Example 3:</strong></p>\n<p>Input:     1         1<br>          / \\       / <br>         2   1     1   2</p>\n<pre><code>[1,2,1],   [1,1,2]</code></pre><p>Output: false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSameTree</span><span class=\"params\">(TreeNode p, TreeNode q)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span> &amp;&amp; q == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span> || q == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val != q.val) &#123; <span class=\"comment\">// !!!</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> isSameTree(p.left, q.left) &amp;&amp; isSameTree(p.right, q.right);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvc2FtZS10cmVl\">https://leetcode-cn.com/problems/same-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Same-Tree\"><a href=\"#Same-Tree\" class=\"headerlink\" title=\"Same Tree\"></a>Same Tree</h1><p>Given two binary trees, write a function to check if they are the same or not.</p>\n<p>Two binary trees are considered the same if they are structurally identical and the nodes have the same value.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input:     1         1<br>          / \\       / <br>         2   3     2   3</p>\n<pre><code>[1,2,3],   [1,2,3]</code></pre><p>Output: true</p>\n<p><strong>Example 2:</strong></p>\n<p>Input:     1         1<br>          /           <br>         2             2</p>\n<pre><code>[1,2],     [1,null,2]</code></pre><p>Output: false</p>\n<p><strong>Example 3:</strong></p>\n<p>Input:     1         1<br>          / \\       / <br>         2   1     1   2</p>\n<pre><code>[1,2,1],   [1,1,2]</code></pre><p>Output: false</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSameTree</span><span class=\"params\">(TreeNode p, TreeNode q)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span> &amp;&amp; q == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p == <span class=\"keyword\">null</span> || q == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p.val != q.val) &#123; <span class=\"comment\">// !!!</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> isSameTree(p.left, q.left) &amp;&amp; isSameTree(p.right, q.right);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvc2FtZS10cmVl\">https://leetcode-cn.com/problems/same-tree<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Roman to Integer\n\nRoman numerals are represented by seven different symbols: I, V, X, L, C, D and M.\n\nSymbol       Value\nI             1\nV             5\nX             10\nL             50\nC             100\nD             500\nM             1000\nFor example, two is written as II in Roman numeral, just two one's added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.\n\nRoman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:\n\nI can be placed before V (5) and X (10) to make 4 and 9. \nX can be placed before L (50) and C (100) to make 40 and 90. \nC can be placed before D (500) and M (1000) to make 400 and 900.\nGiven a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.\n\n**Example 1:**\n\nInput: \"III\"  \nOutput: 3  \n\n**Example 2:**\n\nInput: \"IV\"  \nOutput: 4  \n\n**Example 3:**\n\nInput: \"IX\"  \nOutput: 9  \n\n**Example 4:**\n\nInput: \"LVIII\"\nOutput: 58\nExplanation: L = 50, V= 5, III = 3.\n\n**Example 5:**\n\nInput: \"MCMXCIV\"  \nOutput: 1994  \nExplanation: M = 1000, CM = 900, XC = 90 and IV = 4.  \n\n```java\nclass Solution {\n    public int romanToInt(String s) {\n            char[] array = s.toCharArray();\n            int sum = 0;\n\n            for (int i = 0; i < array.length - 1; i++) {\n                if (trans(array[i]) >= trans(array[i + 1])) {\n                    sum += trans(array[i]);\n                } else {\n                    sum -= trans(array[i]);\n                }\n            }\n\n            if (array.length - 1 >= 0) {\n                sum += trans(array[array.length - 1]);\n            }\n\n            return sum;\n        }\n\n        public int trans(char c) {\n\n            switch (c) {\n                case 'I': \n                    return 1;\n            \n                case 'V':\n                    return 5;\n\n                case 'X':\n                    return 10;\n\n                case 'L':\n                    return 50;\n\n                case 'C':\n                    return 100;\n\n                case 'D':\n                    return 500;\n\n                case 'M':\n                    return 1000;\n                \n                default:\n                    return 0;\n            }\n        }\n}\n```\nWe just need to get right number what each character meaning for. And judge the next character implies whether larger than the current character, then we can get it.\n\n> Reference  \n> https://leetcode-cn.com/problems/roman-to-integer\n","source":"_posts/leetcode/romantointeger.md","raw":"# Roman to Integer\n\nRoman numerals are represented by seven different symbols: I, V, X, L, C, D and M.\n\nSymbol       Value\nI             1\nV             5\nX             10\nL             50\nC             100\nD             500\nM             1000\nFor example, two is written as II in Roman numeral, just two one's added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.\n\nRoman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:\n\nI can be placed before V (5) and X (10) to make 4 and 9. \nX can be placed before L (50) and C (100) to make 40 and 90. \nC can be placed before D (500) and M (1000) to make 400 and 900.\nGiven a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.\n\n**Example 1:**\n\nInput: \"III\"  \nOutput: 3  \n\n**Example 2:**\n\nInput: \"IV\"  \nOutput: 4  \n\n**Example 3:**\n\nInput: \"IX\"  \nOutput: 9  \n\n**Example 4:**\n\nInput: \"LVIII\"\nOutput: 58\nExplanation: L = 50, V= 5, III = 3.\n\n**Example 5:**\n\nInput: \"MCMXCIV\"  \nOutput: 1994  \nExplanation: M = 1000, CM = 900, XC = 90 and IV = 4.  \n\n```java\nclass Solution {\n    public int romanToInt(String s) {\n            char[] array = s.toCharArray();\n            int sum = 0;\n\n            for (int i = 0; i < array.length - 1; i++) {\n                if (trans(array[i]) >= trans(array[i + 1])) {\n                    sum += trans(array[i]);\n                } else {\n                    sum -= trans(array[i]);\n                }\n            }\n\n            if (array.length - 1 >= 0) {\n                sum += trans(array[array.length - 1]);\n            }\n\n            return sum;\n        }\n\n        public int trans(char c) {\n\n            switch (c) {\n                case 'I': \n                    return 1;\n            \n                case 'V':\n                    return 5;\n\n                case 'X':\n                    return 10;\n\n                case 'L':\n                    return 50;\n\n                case 'C':\n                    return 100;\n\n                case 'D':\n                    return 500;\n\n                case 'M':\n                    return 1000;\n                \n                default:\n                    return 0;\n            }\n        }\n}\n```\nWe just need to get right number what each character meaning for. And judge the next character implies whether larger than the current character, then we can get it.\n\n> Reference  \n> https://leetcode-cn.com/problems/roman-to-integer\n","slug":"leetcode/romantointeger","published":1,"date":"2020-03-13T09:29:24.134Z","updated":"2020-03-13T09:35:01.403Z","title":"leetcode/romantointeger","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z10049018obqkp8ltx","content":"<h1 id=\"Roman-to-Integer\"><a href=\"#Roman-to-Integer\" class=\"headerlink\" title=\"Roman to Integer\"></a>Roman to Integer</h1><p>Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.</p>\n<p>Symbol       Value<br>I             1<br>V             5<br>X             10<br>L             50<br>C             100<br>D             500<br>M             1000<br>For example, two is written as II in Roman numeral, just two one’s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.</p>\n<p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:</p>\n<p>I can be placed before V (5) and X (10) to make 4 and 9.<br>X can be placed before L (50) and C (100) to make 40 and 90.<br>C can be placed before D (500) and M (1000) to make 400 and 900.<br>Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “III”<br>Output: 3  </p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “IV”<br>Output: 4  </p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “IX”<br>Output: 9  </p>\n<p><strong>Example 4:</strong></p>\n<p>Input: “LVIII”<br>Output: 58<br>Explanation: L = 50, V= 5, III = 3.</p>\n<p><strong>Example 5:</strong></p>\n<p>Input: “MCMXCIV”<br>Output: 1994<br>Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">romanToInt</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span>[] array = s.toCharArray();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; array.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (trans(array[i]) &gt;= trans(array[i + <span class=\"number\">1</span>])) &#123;</span><br><span class=\"line\">                    sum += trans(array[i]);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    sum -= trans(array[i]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (array.length - <span class=\"number\">1</span> &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                sum += trans(array[array.length - <span class=\"number\">1</span>]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">trans</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (c) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'I'</span>: </span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            </span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'V'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'X'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'L'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">50</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'C'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">100</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'D'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'M'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">1000</span>;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>We just need to get right number what each character meaning for. And judge the next character implies whether larger than the current character, then we can get it.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcm9tYW4tdG8taW50ZWdlcg==\">https://leetcode-cn.com/problems/roman-to-integer<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Roman-to-Integer\"><a href=\"#Roman-to-Integer\" class=\"headerlink\" title=\"Roman to Integer\"></a>Roman to Integer</h1><p>Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.</p>\n<p>Symbol       Value<br>I             1<br>V             5<br>X             10<br>L             50<br>C             100<br>D             500<br>M             1000<br>For example, two is written as II in Roman numeral, just two one’s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.</p>\n<p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:</p>\n<p>I can be placed before V (5) and X (10) to make 4 and 9.<br>X can be placed before L (50) and C (100) to make 40 and 90.<br>C can be placed before D (500) and M (1000) to make 400 and 900.<br>Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “III”<br>Output: 3  </p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “IV”<br>Output: 4  </p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “IX”<br>Output: 9  </p>\n<p><strong>Example 4:</strong></p>\n<p>Input: “LVIII”<br>Output: 58<br>Explanation: L = 50, V= 5, III = 3.</p>\n<p><strong>Example 5:</strong></p>\n<p>Input: “MCMXCIV”<br>Output: 1994<br>Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.  </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">romanToInt</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span>[] array = s.toCharArray();</span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; array.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (trans(array[i]) &gt;= trans(array[i + <span class=\"number\">1</span>])) &#123;</span><br><span class=\"line\">                    sum += trans(array[i]);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    sum -= trans(array[i]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (array.length - <span class=\"number\">1</span> &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                sum += trans(array[array.length - <span class=\"number\">1</span>]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">trans</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (c) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'I'</span>: </span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            </span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'V'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'X'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'L'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">50</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'C'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">100</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'D'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">case</span> <span class=\"string\">'M'</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">1000</span>;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>We just need to get right number what each character meaning for. And judge the next character implies whether larger than the current character, then we can get it.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvcm9tYW4tdG8taW50ZWdlcg==\">https://leetcode-cn.com/problems/roman-to-integer<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Day01 - 两数之和\n\n给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。\n\n你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。\n\n**示例**:\n\n给定 nums = [2, 7, 11, 15], target = 9\n\n因为 nums[0] + nums[1] = 2 + 7 = 9所以返回 [0, 1]\n\n```java\nclass Solution {\n    public int[] twoSum(int[] nums, int target) {\n        int[] two = new int[2];\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = nums.length - 1; j > i; j--) {\n                if (nums[i] + nums[j] == target) {\n                    two[0] = i;\n                    two[1] = j;\n                    return two;\n                }\n            }\n        }\n        return null;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/two-sum\n\n","source":"_posts/leetcode/twosum.md","raw":"# Day01 - 两数之和\n\n给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。\n\n你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。\n\n**示例**:\n\n给定 nums = [2, 7, 11, 15], target = 9\n\n因为 nums[0] + nums[1] = 2 + 7 = 9所以返回 [0, 1]\n\n```java\nclass Solution {\n    public int[] twoSum(int[] nums, int target) {\n        int[] two = new int[2];\n        for (int i = 0; i < nums.length; i++) {\n            for (int j = nums.length - 1; j > i; j--) {\n                if (nums[i] + nums[j] == target) {\n                    two[0] = i;\n                    two[1] = j;\n                    return two;\n                }\n            }\n        }\n        return null;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/two-sum\n\n","slug":"leetcode/twosum","published":1,"date":"2020-03-03T13:36:04.356Z","updated":"2020-03-05T14:09:49.594Z","title":"leetcode/twosum","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z2004a018ofpc3cnmq","content":"<h1 id=\"Day01-两数之和\"><a href=\"#Day01-两数之和\" class=\"headerlink\" title=\"Day01 - 两数之和\"></a>Day01 - 两数之和</h1><p>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。</p>\n<p>你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。</p>\n<p><strong>示例</strong>:</p>\n<p>给定 nums = [2, 7, 11, 15], target = 9</p>\n<p>因为 nums[0] + nums[1] = 2 + 7 = 9所以返回 [0, 1]</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] twoSum(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] two = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = nums.length - <span class=\"number\">1</span>; j &gt; i; j--) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nums[i] + nums[j] == target) &#123;</span><br><span class=\"line\">                    two[<span class=\"number\">0</span>] = i;</span><br><span class=\"line\">                    two[<span class=\"number\">1</span>] = j;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> two;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdHdvLXN1bQ==\">https://leetcode-cn.com/problems/two-sum<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Day01-两数之和\"><a href=\"#Day01-两数之和\" class=\"headerlink\" title=\"Day01 - 两数之和\"></a>Day01 - 两数之和</h1><p>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。</p>\n<p>你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。</p>\n<p><strong>示例</strong>:</p>\n<p>给定 nums = [2, 7, 11, 15], target = 9</p>\n<p>因为 nums[0] + nums[1] = 2 + 7 = 9所以返回 [0, 1]</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] twoSum(<span class=\"keyword\">int</span>[] nums, <span class=\"keyword\">int</span> target) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] two = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = nums.length - <span class=\"number\">1</span>; j &gt; i; j--) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nums[i] + nums[j] == target) &#123;</span><br><span class=\"line\">                    two[<span class=\"number\">0</span>] = i;</span><br><span class=\"line\">                    two[<span class=\"number\">1</span>] = j;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> two;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdHdvLXN1bQ==\">https://leetcode-cn.com/problems/two-sum<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Is Subsequence\nGiven a string s and a string t, check if s is subsequence of t.\n\nYou may assume that there is only lower case English letters in both s and t. t is potentially a very long (length ~= 500,000) string, and s is a short string (<=100).\n\nA subsequence of a string is a new string which is formed from the original string by deleting some (can be none) of the characters without disturbing the relative positions of the remaining characters. (ie, \"ace\" is a subsequence of \"abcde\" while \"aec\" is not).\n\nExample 1:  \ns = \"abc\", t = \"ahbgdc\"\n\nReturn true.\n\nExample 2:  \ns = \"axc\", t = \"ahbgdc\"\n\nReturn false.\n\nFollow up:  \nIf there are lots of incoming S, say S1, S2, ... , Sk where k >= 1B, and you want to check one by one to see if T has its subsequence. In this scenario, how would you change your code?\n\n*Overtime*\n```java\nclass Solution {\n    public boolean isSubsequence(String s, String t) {\n        if (s.length() == 0) return true;\n        \n                for (int i = 0; i < t.length() - s.length(); i++) {\n                    int res = 0;\n                    int cur = i;\n                    while (cur < t.length() && res < s.length()) {\n                        if (t.charAt(cur) == s.charAt(res)) res++;\n        \n                        cur++;\n        \n                        if (res == s.length()) return true;\n                    }\n                }\n        \n                return false;\n    }\n}\n```\n\n```java\nclass Solution {\n    public boolean isSubsequence(String s, String t) {\n        int res = -1;\n        for (int i = 0; i < s.length(); i++) {\n            res = t.indexOf(s.charAt(i), res + 1);\n            if (res == -1) return false;\n        }\n        return true;\n    }\n}\n/*\n执行用时 :1 ms, 在所有 Java 提交中击败了90.09%的用户\n内存消耗 :44.2 MB, 在所有 Java 提交中击败了100.00%的用户\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/is-subsequence","source":"_posts/leetcode/substring.md","raw":"# Is Subsequence\nGiven a string s and a string t, check if s is subsequence of t.\n\nYou may assume that there is only lower case English letters in both s and t. t is potentially a very long (length ~= 500,000) string, and s is a short string (<=100).\n\nA subsequence of a string is a new string which is formed from the original string by deleting some (can be none) of the characters without disturbing the relative positions of the remaining characters. (ie, \"ace\" is a subsequence of \"abcde\" while \"aec\" is not).\n\nExample 1:  \ns = \"abc\", t = \"ahbgdc\"\n\nReturn true.\n\nExample 2:  \ns = \"axc\", t = \"ahbgdc\"\n\nReturn false.\n\nFollow up:  \nIf there are lots of incoming S, say S1, S2, ... , Sk where k >= 1B, and you want to check one by one to see if T has its subsequence. In this scenario, how would you change your code?\n\n*Overtime*\n```java\nclass Solution {\n    public boolean isSubsequence(String s, String t) {\n        if (s.length() == 0) return true;\n        \n                for (int i = 0; i < t.length() - s.length(); i++) {\n                    int res = 0;\n                    int cur = i;\n                    while (cur < t.length() && res < s.length()) {\n                        if (t.charAt(cur) == s.charAt(res)) res++;\n        \n                        cur++;\n        \n                        if (res == s.length()) return true;\n                    }\n                }\n        \n                return false;\n    }\n}\n```\n\n```java\nclass Solution {\n    public boolean isSubsequence(String s, String t) {\n        int res = -1;\n        for (int i = 0; i < s.length(); i++) {\n            res = t.indexOf(s.charAt(i), res + 1);\n            if (res == -1) return false;\n        }\n        return true;\n    }\n}\n/*\n执行用时 :1 ms, 在所有 Java 提交中击败了90.09%的用户\n内存消耗 :44.2 MB, 在所有 Java 提交中击败了100.00%的用户\n*/\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/is-subsequence","slug":"leetcode/substring","published":1,"date":"2020-03-26T05:04:00.758Z","updated":"2020-03-26T05:06:29.417Z","title":"leetcode/substring","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z3004c018o087b8fcl","content":"<h1 id=\"Is-Subsequence\"><a href=\"#Is-Subsequence\" class=\"headerlink\" title=\"Is Subsequence\"></a>Is Subsequence</h1><p>Given a string s and a string t, check if s is subsequence of t.</p>\n<p>You may assume that there is only lower case English letters in both s and t. t is potentially a very long (length ~= 500,000) string, and s is a short string (&lt;=100).</p>\n<p>A subsequence of a string is a new string which is formed from the original string by deleting some (can be none) of the characters without disturbing the relative positions of the remaining characters. (ie, “ace” is a subsequence of “abcde” while “aec” is not).</p>\n<p>Example 1:<br>s = “abc”, t = “ahbgdc”</p>\n<p>Return true.</p>\n<p>Example 2:<br>s = “axc”, t = “ahbgdc”</p>\n<p>Return false.</p>\n<p>Follow up:<br>If there are lots of incoming S, say S1, S2, … , Sk where k &gt;= 1B, and you want to check one by one to see if T has its subsequence. In this scenario, how would you change your code?</p>\n<p><em>Overtime</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSubsequence</span><span class=\"params\">(String s, String t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s.length() == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; t.length() - s.length(); i++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> cur = i;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (cur &lt; t.length() &amp;&amp; res &lt; s.length()) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (t.charAt(cur) == s.charAt(res)) res++;</span><br><span class=\"line\">        </span><br><span class=\"line\">                        cur++;</span><br><span class=\"line\">        </span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (res == s.length()) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSubsequence</span><span class=\"params\">(String s, String t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = -<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">            res = t.indexOf(s.charAt(i), res + <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (res == -<span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了90.09%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :44.2 MB, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvaXMtc3Vic2VxdWVuY2U=\">https://leetcode-cn.com/problems/is-subsequence<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Is-Subsequence\"><a href=\"#Is-Subsequence\" class=\"headerlink\" title=\"Is Subsequence\"></a>Is Subsequence</h1><p>Given a string s and a string t, check if s is subsequence of t.</p>\n<p>You may assume that there is only lower case English letters in both s and t. t is potentially a very long (length ~= 500,000) string, and s is a short string (&lt;=100).</p>\n<p>A subsequence of a string is a new string which is formed from the original string by deleting some (can be none) of the characters without disturbing the relative positions of the remaining characters. (ie, “ace” is a subsequence of “abcde” while “aec” is not).</p>\n<p>Example 1:<br>s = “abc”, t = “ahbgdc”</p>\n<p>Return true.</p>\n<p>Example 2:<br>s = “axc”, t = “ahbgdc”</p>\n<p>Return false.</p>\n<p>Follow up:<br>If there are lots of incoming S, say S1, S2, … , Sk where k &gt;= 1B, and you want to check one by one to see if T has its subsequence. In this scenario, how would you change your code?</p>\n<p><em>Overtime</em></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSubsequence</span><span class=\"params\">(String s, String t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s.length() == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; t.length() - s.length(); i++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> res = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> cur = i;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (cur &lt; t.length() &amp;&amp; res &lt; s.length()) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (t.charAt(cur) == s.charAt(res)) res++;</span><br><span class=\"line\">        </span><br><span class=\"line\">                        cur++;</span><br><span class=\"line\">        </span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (res == s.length()) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSubsequence</span><span class=\"params\">(String s, String t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> res = -<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class=\"line\">            res = t.indexOf(s.charAt(i), res + <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (res == -<span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :1 ms, 在所有 Java 提交中击败了90.09%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :44.2 MB, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvaXMtc3Vic2VxdWVuY2U=\">https://leetcode-cn.com/problems/is-subsequence<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Symmetric Tree\n\nGiven a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).\n\nFor example, this binary tree [1,2,2,3,4,4,3] is symmetric:  \n  \n   1  \n   / \\  \n  2   2  \n / \\ / \\  \n3  4 4  3  \n \n\nBut the following [1,2,2,null,3,null,3] is not:\n\n   1  \n   / \\  \n  2   2  \n   \\   \\  \n   3    3  \n \n\nNote:\nBonus points if you could solve it both recursively and iteratively.\n\n```java\npublic class Symmetric {\n    public static void main(String[] args) {\n\n    }\n\n    public boolean isSymmetric(TreeNode root) {\n\n        if (root == null) return true;\n\n        return checker(root.left, root.right);\n    }\n\n    public boolean checker(TreeNode left, TreeNode right) {\n        if (left == null && right != null || left != null && right == null) return false;\n        if (left == null && right == null) return true;\n\n        if (left.val != right.val) return false;\n\n        return checker(left.left, right.right) && checker(left.right, right.left);\n    }\n}\n\n/*\n执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户\n内存消耗 :37.4 MB, 在所有 Java 提交中击败了41.58%的用户\n*/\n```\nThe base case is that `if (root == null)`.  \nFirst divide the problem into smallest piece that we judge the node's value equals or not.  \nThen we conquer the problem that the node `left.left` equals `right.right` and `left.right` equals `right.left`.  \n\n> Reference  \n> https://leetcode-cn.com/problems/symmetric-tree/submissions","source":"_posts/leetcode/symmetric.md","raw":"# Symmetric Tree\n\nGiven a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).\n\nFor example, this binary tree [1,2,2,3,4,4,3] is symmetric:  \n  \n   1  \n   / \\  \n  2   2  \n / \\ / \\  \n3  4 4  3  \n \n\nBut the following [1,2,2,null,3,null,3] is not:\n\n   1  \n   / \\  \n  2   2  \n   \\   \\  \n   3    3  \n \n\nNote:\nBonus points if you could solve it both recursively and iteratively.\n\n```java\npublic class Symmetric {\n    public static void main(String[] args) {\n\n    }\n\n    public boolean isSymmetric(TreeNode root) {\n\n        if (root == null) return true;\n\n        return checker(root.left, root.right);\n    }\n\n    public boolean checker(TreeNode left, TreeNode right) {\n        if (left == null && right != null || left != null && right == null) return false;\n        if (left == null && right == null) return true;\n\n        if (left.val != right.val) return false;\n\n        return checker(left.left, right.right) && checker(left.right, right.left);\n    }\n}\n\n/*\n执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户\n内存消耗 :37.4 MB, 在所有 Java 提交中击败了41.58%的用户\n*/\n```\nThe base case is that `if (root == null)`.  \nFirst divide the problem into smallest piece that we judge the node's value equals or not.  \nThen we conquer the problem that the node `left.left` equals `right.right` and `left.right` equals `right.left`.  \n\n> Reference  \n> https://leetcode-cn.com/problems/symmetric-tree/submissions","slug":"leetcode/symmetric","published":1,"date":"2020-03-20T14:56:39.518Z","updated":"2020-03-20T15:05:17.023Z","title":"leetcode/symmetric","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z3004e018o2c8xhpm8","content":"<h1 id=\"Symmetric-Tree\"><a href=\"#Symmetric-Tree\" class=\"headerlink\" title=\"Symmetric Tree\"></a>Symmetric Tree</h1><p>Given a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).</p>\n<p>For example, this binary tree [1,2,2,3,4,4,3] is symmetric:  </p>\n<p>   1<br>   / \\<br>  2   2<br> / \\ / \\<br>3  4 4  3  </p>\n<p>But the following [1,2,2,null,3,null,3] is not:</p>\n<p>   1<br>   / \\<br>  2   2<br>   \\   \\<br>   3    3  </p>\n<p>Note:<br>Bonus points if you could solve it both recursively and iteratively.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Symmetric</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSymmetric</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> checker(root.left, root.right);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">checker</span><span class=\"params\">(TreeNode left, TreeNode right)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left == <span class=\"keyword\">null</span> &amp;&amp; right != <span class=\"keyword\">null</span> || left != <span class=\"keyword\">null</span> &amp;&amp; right == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left == <span class=\"keyword\">null</span> &amp;&amp; right == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left.val != right.val) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> checker(left.left, right.right) &amp;&amp; checker(left.right, right.left);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :37.4 MB, 在所有 Java 提交中击败了41.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>The base case is that <code>if (root == null)</code>.<br>First divide the problem into smallest piece that we judge the node’s value equals or not.<br>Then we conquer the problem that the node <code>left.left</code> equals <code>right.right</code> and <code>left.right</code> equals <code>right.left</code>.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvc3ltbWV0cmljLXRyZWUvc3VibWlzc2lvbnM=\">https://leetcode-cn.com/problems/symmetric-tree/submissions<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Symmetric-Tree\"><a href=\"#Symmetric-Tree\" class=\"headerlink\" title=\"Symmetric Tree\"></a>Symmetric Tree</h1><p>Given a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).</p>\n<p>For example, this binary tree [1,2,2,3,4,4,3] is symmetric:  </p>\n<p>   1<br>   / \\<br>  2   2<br> / \\ / \\<br>3  4 4  3  </p>\n<p>But the following [1,2,2,null,3,null,3] is not:</p>\n<p>   1<br>   / \\<br>  2   2<br>   \\   \\<br>   3    3  </p>\n<p>Note:<br>Bonus points if you could solve it both recursively and iteratively.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Symmetric</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isSymmetric</span><span class=\"params\">(TreeNode root)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> checker(root.left, root.right);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">checker</span><span class=\"params\">(TreeNode left, TreeNode right)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left == <span class=\"keyword\">null</span> &amp;&amp; right != <span class=\"keyword\">null</span> || left != <span class=\"keyword\">null</span> &amp;&amp; right == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left == <span class=\"keyword\">null</span> &amp;&amp; right == <span class=\"keyword\">null</span>) <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left.val != right.val) <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> checker(left.left, right.right) &amp;&amp; checker(left.right, right.left);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :0 ms, 在所有 Java 提交中击败了100.00%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :37.4 MB, 在所有 Java 提交中击败了41.58%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>The base case is that <code>if (root == null)</code>.<br>First divide the problem into smallest piece that we judge the node’s value equals or not.<br>Then we conquer the problem that the node <code>left.left</code> equals <code>right.right</code> and <code>left.right</code> equals <code>right.left</code>.  </p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvc3ltbWV0cmljLXRyZWUvc3VibWlzc2lvbnM=\">https://leetcode-cn.com/problems/symmetric-tree/submissions<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# 三数之和(Unsolved)\n\n给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。\n\n注意：答案中不可以包含重复的三元组。\n\n**示例**：\n\n给定数组 nums = [-1, 0, 1, 2, -1, -4]，\n\n满足要求的三元组集合为：  \n[\n  [-1, 0, 1],\n  [-1, -1, 2]\n]\n\n```java\nclass Solution {\n    public List<List<Integer>> threeSum(int[] nums) {\n        if (nums == null || nums.length <= 2) {\n        return Collections.emptyList();\n    }\n    List<List<Integer>> result = new LinkedList<>();\n\n    Arrays.sort(nums);\n    for (int i = 0; i < nums.length - 2; i++) {\n        // 加速1：c为非负数，就不能满足a+b+c=0了\n        if (nums[i] > 0) {\n            return result;\n        }\n        // 加速2：跳过计算过的数据，同时防止结果重复\n        if (i != 0 && nums[i] == nums[i-1]) {\n            continue;\n        }\n        int head = i + 1;\n        int tail = nums.length - 1;\n        while (head < tail) {\n            int sum = -(nums[head] + nums[tail]);\n            if (sum == nums[i]) {\n                result.add(Arrays.asList(nums[i], nums[head], nums[tail]));\n                // 加速3：跳过计算过的数据，同时防止结果重复\n                while (head < tail && nums[head] == nums[head+1]) {\n                    head++;\n                }\n                while (head < tail && nums[tail] == nums[tail-1]) {\n                    tail--;\n                }\n            }\n            if (sum <= nums[i]) {\n                tail--;\n            } else {\n                head++;\n            }\n        }\n    }\n\n    return result;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/3sum/solution/san-shu-zhi-he-javajian-ji-ti-jie-by-wang-zi-hao-z/","source":"_posts/leetcode/threesum.md","raw":"# 三数之和(Unsolved)\n\n给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。\n\n注意：答案中不可以包含重复的三元组。\n\n**示例**：\n\n给定数组 nums = [-1, 0, 1, 2, -1, -4]，\n\n满足要求的三元组集合为：  \n[\n  [-1, 0, 1],\n  [-1, -1, 2]\n]\n\n```java\nclass Solution {\n    public List<List<Integer>> threeSum(int[] nums) {\n        if (nums == null || nums.length <= 2) {\n        return Collections.emptyList();\n    }\n    List<List<Integer>> result = new LinkedList<>();\n\n    Arrays.sort(nums);\n    for (int i = 0; i < nums.length - 2; i++) {\n        // 加速1：c为非负数，就不能满足a+b+c=0了\n        if (nums[i] > 0) {\n            return result;\n        }\n        // 加速2：跳过计算过的数据，同时防止结果重复\n        if (i != 0 && nums[i] == nums[i-1]) {\n            continue;\n        }\n        int head = i + 1;\n        int tail = nums.length - 1;\n        while (head < tail) {\n            int sum = -(nums[head] + nums[tail]);\n            if (sum == nums[i]) {\n                result.add(Arrays.asList(nums[i], nums[head], nums[tail]));\n                // 加速3：跳过计算过的数据，同时防止结果重复\n                while (head < tail && nums[head] == nums[head+1]) {\n                    head++;\n                }\n                while (head < tail && nums[tail] == nums[tail-1]) {\n                    tail--;\n                }\n            }\n            if (sum <= nums[i]) {\n                tail--;\n            } else {\n                head++;\n            }\n        }\n    }\n\n    return result;\n    }\n}\n```\n\n> Reference  \n> https://leetcode-cn.com/problems/3sum/solution/san-shu-zhi-he-javajian-ji-ti-jie-by-wang-zi-hao-z/","slug":"leetcode/threesum","published":1,"date":"2020-03-04T11:53:56.148Z","updated":"2020-03-05T14:10:01.139Z","title":"leetcode/threesum","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z4004h018ohsbp23rz","content":"<h1 id=\"三数之和-Unsolved\"><a href=\"#三数之和-Unsolved\" class=\"headerlink\" title=\"三数之和(Unsolved)\"></a>三数之和(Unsolved)</h1><p>给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。</p>\n<p>注意：答案中不可以包含重复的三元组。</p>\n<p><strong>示例</strong>：</p>\n<p>给定数组 nums = [-1, 0, 1, 2, -1, -4]，</p>\n<p>满足要求的三元组集合为：<br>[<br>  [-1, 0, 1],<br>  [-1, -1, 2]<br>]</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class=\"keyword\">int</span>[] nums) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums == <span class=\"keyword\">null</span> || nums.length &lt;= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; result = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    Arrays.sort(nums);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length - <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 加速1：c为非负数，就不能满足a+b+c=0了</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums[i] &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 加速2：跳过计算过的数据，同时防止结果重复</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i != <span class=\"number\">0</span> &amp;&amp; nums[i] == nums[i-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> head = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> tail = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (head &lt; tail) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = -(nums[head] + nums[tail]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sum == nums[i]) &#123;</span><br><span class=\"line\">                result.add(Arrays.asList(nums[i], nums[head], nums[tail]));</span><br><span class=\"line\">                <span class=\"comment\">// 加速3：跳过计算过的数据，同时防止结果重复</span></span><br><span class=\"line\">                <span class=\"keyword\">while</span> (head &lt; tail &amp;&amp; nums[head] == nums[head+<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    head++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (head &lt; tail &amp;&amp; nums[tail] == nums[tail-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    tail--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sum &lt;= nums[i]) &#123;</span><br><span class=\"line\">                tail--;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                head++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvM3N1bS9zb2x1dGlvbi9zYW4tc2h1LXpoaS1oZS1qYXZhamlhbi1qaS10aS1qaWUtYnktd2FuZy16aS1oYW8tei8=\">https://leetcode-cn.com/problems/3sum/solution/san-shu-zhi-he-javajian-ji-ti-jie-by-wang-zi-hao-z/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"三数之和-Unsolved\"><a href=\"#三数之和-Unsolved\" class=\"headerlink\" title=\"三数之和(Unsolved)\"></a>三数之和(Unsolved)</h1><p>给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。</p>\n<p>注意：答案中不可以包含重复的三元组。</p>\n<p><strong>示例</strong>：</p>\n<p>给定数组 nums = [-1, 0, 1, 2, -1, -4]，</p>\n<p>满足要求的三元组集合为：<br>[<br>  [-1, 0, 1],<br>  [-1, -1, 2]<br>]</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class=\"keyword\">int</span>[] nums) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums == <span class=\"keyword\">null</span> || nums.length &lt;= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    List&lt;List&lt;Integer&gt;&gt; result = <span class=\"keyword\">new</span> LinkedList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    Arrays.sort(nums);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; nums.length - <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 加速1：c为非负数，就不能满足a+b+c=0了</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums[i] &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 加速2：跳过计算过的数据，同时防止结果重复</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i != <span class=\"number\">0</span> &amp;&amp; nums[i] == nums[i-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> head = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> tail = nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (head &lt; tail) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> sum = -(nums[head] + nums[tail]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sum == nums[i]) &#123;</span><br><span class=\"line\">                result.add(Arrays.asList(nums[i], nums[head], nums[tail]));</span><br><span class=\"line\">                <span class=\"comment\">// 加速3：跳过计算过的数据，同时防止结果重复</span></span><br><span class=\"line\">                <span class=\"keyword\">while</span> (head &lt; tail &amp;&amp; nums[head] == nums[head+<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    head++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (head &lt; tail &amp;&amp; nums[tail] == nums[tail-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    tail--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (sum &lt;= nums[i]) &#123;</span><br><span class=\"line\">                tail--;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                head++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvM3N1bS9zb2x1dGlvbi9zYW4tc2h1LXpoaS1oZS1qYXZhamlhbi1qaS10aS1qaWUtYnktd2FuZy16aS1oYW8tei8=\">https://leetcode-cn.com/problems/3sum/solution/san-shu-zhi-he-javajian-ji-ti-jie-by-wang-zi-hao-z/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Valid Parentheses\nGiven a string containing just the characters '(', ')', '{', '}', '[' and ']', determine if the input string is valid.\n\nAn input string is valid if:\n\nOpen brackets must be closed by the same type of brackets.\nOpen brackets must be closed in the correct order.\nNote that an empty string is also considered valid.\n\n**Example 1:**\n\nInput: \"()\"\nOutput: true\n\n**Example 2:**\n\nInput: \"()[]{}\"\nOutput: true\n\n**Example 3:**\n\nInput: \"(]\"\nOutput: false\n\n**Example 4:**\n\nInput: \"([)]\"\nOutput: false\n\n**Example 5:**\n\nInput: \"{[]}\"\nOutput: true\n\n```java\nclass Solution {\n    public boolean isValid(String s) {\n        char[] charArray = s.toCharArray();\n        Stack<Integer> stack = new Stack<>();\n        if (s == null || s.length() == 0) {\n            return true;\n        }\n\n        for (int i = 0; i < charArray.length; i++) {\n            if (trans(charArray[i]) > 0) {\n                stack.push(trans(charArray[i]));\n            } else if (trans(charArray[i]) < 0 ) {\n                if (!stack.isEmpty() && stack.pop() + trans(charArray[i]) == 0) {\n                    continue;\n                } else {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        }\n\n        if (stack.size() == 0) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    private int trans(char c) {\n        switch (c) {\n            case '(': return 1;\n            case ')': return -1;\n            case '[': return 2;\n            case ']': return -2;\n            case '{': return 3;\n            case '}': return -3;\n            default: return 0;\n        }\n    }\n\n/**\n执行用时 :2 ms, 在所有 Java 提交中击败了91.77%的用户\n内存消耗 :37.2 MB, 在所有 Java 提交中击败了5.05%的用户\n*/\n}\n```\nSource code is easy to see.\n\n> Reference  \n> https://leetcode-cn.com/problems/valid-parentheses","source":"_posts/leetcode/validparentheses.md","raw":"# Valid Parentheses\nGiven a string containing just the characters '(', ')', '{', '}', '[' and ']', determine if the input string is valid.\n\nAn input string is valid if:\n\nOpen brackets must be closed by the same type of brackets.\nOpen brackets must be closed in the correct order.\nNote that an empty string is also considered valid.\n\n**Example 1:**\n\nInput: \"()\"\nOutput: true\n\n**Example 2:**\n\nInput: \"()[]{}\"\nOutput: true\n\n**Example 3:**\n\nInput: \"(]\"\nOutput: false\n\n**Example 4:**\n\nInput: \"([)]\"\nOutput: false\n\n**Example 5:**\n\nInput: \"{[]}\"\nOutput: true\n\n```java\nclass Solution {\n    public boolean isValid(String s) {\n        char[] charArray = s.toCharArray();\n        Stack<Integer> stack = new Stack<>();\n        if (s == null || s.length() == 0) {\n            return true;\n        }\n\n        for (int i = 0; i < charArray.length; i++) {\n            if (trans(charArray[i]) > 0) {\n                stack.push(trans(charArray[i]));\n            } else if (trans(charArray[i]) < 0 ) {\n                if (!stack.isEmpty() && stack.pop() + trans(charArray[i]) == 0) {\n                    continue;\n                } else {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        }\n\n        if (stack.size() == 0) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    private int trans(char c) {\n        switch (c) {\n            case '(': return 1;\n            case ')': return -1;\n            case '[': return 2;\n            case ']': return -2;\n            case '{': return 3;\n            case '}': return -3;\n            default: return 0;\n        }\n    }\n\n/**\n执行用时 :2 ms, 在所有 Java 提交中击败了91.77%的用户\n内存消耗 :37.2 MB, 在所有 Java 提交中击败了5.05%的用户\n*/\n}\n```\nSource code is easy to see.\n\n> Reference  \n> https://leetcode-cn.com/problems/valid-parentheses","slug":"leetcode/validparentheses","published":1,"date":"2020-03-15T14:42:26.874Z","updated":"2020-03-15T14:46:46.915Z","title":"leetcode/validparentheses","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z5004i018ohgtf04o5","content":"<h1 id=\"Valid-Parentheses\"><a href=\"#Valid-Parentheses\" class=\"headerlink\" title=\"Valid Parentheses\"></a>Valid Parentheses</h1><p>Given a string containing just the characters ‘(‘, ‘)’, ‘{‘, ‘}’, ‘[‘ and ‘]’, determine if the input string is valid.</p>\n<p>An input string is valid if:</p>\n<p>Open brackets must be closed by the same type of brackets.<br>Open brackets must be closed in the correct order.<br>Note that an empty string is also considered valid.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “()”<br>Output: true</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “()[]{}”<br>Output: true</p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “(]”<br>Output: false</p>\n<p><strong>Example 4:</strong></p>\n<p>Input: “([)]”<br>Output: false</p>\n<p><strong>Example 5:</strong></p>\n<p>Input: “{[]}”<br>Output: true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isValid</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] charArray = s.toCharArray();</span><br><span class=\"line\">        Stack&lt;Integer&gt; stack = <span class=\"keyword\">new</span> Stack&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == <span class=\"keyword\">null</span> || s.length() == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; charArray.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (trans(charArray[i]) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                stack.push(trans(charArray[i]));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (trans(charArray[i]) &lt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!stack.isEmpty() &amp;&amp; stack.pop() + trans(charArray[i]) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (stack.size() == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">trans</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (c) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'('</span>: <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">')'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'['</span>: <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">']'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'&#123;'</span>: <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'&#125;'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">3</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>: <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :2 ms, 在所有 Java 提交中击败了91.77%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :37.2 MB, 在所有 Java 提交中击败了5.05%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Source code is easy to see.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdmFsaWQtcGFyZW50aGVzZXM=\">https://leetcode-cn.com/problems/valid-parentheses<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Valid-Parentheses\"><a href=\"#Valid-Parentheses\" class=\"headerlink\" title=\"Valid Parentheses\"></a>Valid Parentheses</h1><p>Given a string containing just the characters ‘(‘, ‘)’, ‘{‘, ‘}’, ‘[‘ and ‘]’, determine if the input string is valid.</p>\n<p>An input string is valid if:</p>\n<p>Open brackets must be closed by the same type of brackets.<br>Open brackets must be closed in the correct order.<br>Note that an empty string is also considered valid.</p>\n<p><strong>Example 1:</strong></p>\n<p>Input: “()”<br>Output: true</p>\n<p><strong>Example 2:</strong></p>\n<p>Input: “()[]{}”<br>Output: true</p>\n<p><strong>Example 3:</strong></p>\n<p>Input: “(]”<br>Output: false</p>\n<p><strong>Example 4:</strong></p>\n<p>Input: “([)]”<br>Output: false</p>\n<p><strong>Example 5:</strong></p>\n<p>Input: “{[]}”<br>Output: true</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isValid</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] charArray = s.toCharArray();</span><br><span class=\"line\">        Stack&lt;Integer&gt; stack = <span class=\"keyword\">new</span> Stack&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == <span class=\"keyword\">null</span> || s.length() == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; charArray.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (trans(charArray[i]) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                stack.push(trans(charArray[i]));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (trans(charArray[i]) &lt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!stack.isEmpty() &amp;&amp; stack.pop() + trans(charArray[i]) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (stack.size() == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">trans</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (c) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'('</span>: <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">')'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'['</span>: <span class=\"keyword\">return</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">']'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'&#123;'</span>: <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"string\">'&#125;'</span>: <span class=\"keyword\">return</span> -<span class=\"number\">3</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>: <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">执行用时 :2 ms, 在所有 Java 提交中击败了91.77%的用户</span></span><br><span class=\"line\"><span class=\"comment\">内存消耗 :37.2 MB, 在所有 Java 提交中击败了5.05%的用户</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Source code is easy to see.</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS1jbi5jb20vcHJvYmxlbXMvdmFsaWQtcGFyZW50aGVzZXM=\">https://leetcode-cn.com/problems/valid-parentheses<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"itle":"Linux中的权限","_content":"\n# 详解\n\nhttps://linux.cn/article-11056-1.html","source":"_posts/linux/linux-chmod.md","raw":"---\nitle: Linux中的权限\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# 详解\n\nhttps://linux.cn/article-11056-1.html","slug":"linux/linux-chmod","published":1,"date":"2021-01-27T06:17:00.380Z","updated":"2021-01-27T06:18:30.916Z","title":"linux/linux-chmod","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z5004k018o2txu9pfr","content":"<h1 id=\"详解\"><a href=\"#详解\" class=\"headerlink\" title=\"详解\"></a>详解</h1><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTExMDU2LTEuaHRtbA==\">https://linux.cn/article-11056-1.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"详解\"><a href=\"#详解\" class=\"headerlink\" title=\"详解\"></a>详解</h1><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTExMDU2LTEuaHRtbA==\">https://linux.cn/article-11056-1.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"itle":"Linux默认目录的作用","_content":"\n**常用目录**\n\n## /\n\n根目录\n\n## /bin\n\n/bin, /sbin, /usr/bin, /usr/sbin这些都是存放可执行文件的，sbin下只有root才可以执行。\n\n## /boot\n\n启动系统时候用的\n\n## /dev\n\n设备文件\n\n## /etc\n\n系统的配置文件等\n\n## /home\n\n家目录\n\n## /lib\n\n系统库\n\n## /mnt\n\n挂载目录，挂在别的文件系统\n\n## /media\n\n挂载目录\n\n## /root\n\nroot用户的家目录\n\n## /tmp\n\n存放临时文件\n\n## /sys\n\n里面的东西直接写入内存的东西，内核，驱动...\n\n## /proc\n\n里面的东西直接写入内存\n\n## /usr\n\n存放应用程序和文件\n\n## /var\n\n系统文档，比如/var/log\n\n## /opt\n\n安装附加软件包，/opt/custom_package/bin下是软件目录\n\n## /srv\n\n用于存储本机提供的服务或数据，比如/srv/www, /srv/ftp等\n\n\n\n----\n\nReferences\n\nhttps://zhuanlan.zhihu.com/p/343554675\n\nhttp://www.linuxidc.com/Linux/2015-04/116032.htm\n\nhttps://blog.csdn.net/u012107143/article/details/54972544","source":"_posts/linux/linux-dir.md","raw":"---\nitle: Linux默认目录的作用\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n**常用目录**\n\n## /\n\n根目录\n\n## /bin\n\n/bin, /sbin, /usr/bin, /usr/sbin这些都是存放可执行文件的，sbin下只有root才可以执行。\n\n## /boot\n\n启动系统时候用的\n\n## /dev\n\n设备文件\n\n## /etc\n\n系统的配置文件等\n\n## /home\n\n家目录\n\n## /lib\n\n系统库\n\n## /mnt\n\n挂载目录，挂在别的文件系统\n\n## /media\n\n挂载目录\n\n## /root\n\nroot用户的家目录\n\n## /tmp\n\n存放临时文件\n\n## /sys\n\n里面的东西直接写入内存的东西，内核，驱动...\n\n## /proc\n\n里面的东西直接写入内存\n\n## /usr\n\n存放应用程序和文件\n\n## /var\n\n系统文档，比如/var/log\n\n## /opt\n\n安装附加软件包，/opt/custom_package/bin下是软件目录\n\n## /srv\n\n用于存储本机提供的服务或数据，比如/srv/www, /srv/ftp等\n\n\n\n----\n\nReferences\n\nhttps://zhuanlan.zhihu.com/p/343554675\n\nhttp://www.linuxidc.com/Linux/2015-04/116032.htm\n\nhttps://blog.csdn.net/u012107143/article/details/54972544","slug":"linux/linux-dir","published":1,"date":"2021-01-29T02:13:30.760Z","updated":"2021-01-29T02:47:35.889Z","title":"linux/linux-dir","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z6004m018oh4ynajqv","content":"<p><strong>常用目录</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"/\"></a>/</h2><p>根目录</p>\n<h2 id=\"bin\"><a href=\"#bin\" class=\"headerlink\" title=\"/bin\"></a>/bin</h2><p>/bin, /sbin, /usr/bin, /usr/sbin这些都是存放可执行文件的，sbin下只有root才可以执行。</p>\n<h2 id=\"boot\"><a href=\"#boot\" class=\"headerlink\" title=\"/boot\"></a>/boot</h2><p>启动系统时候用的</p>\n<h2 id=\"dev\"><a href=\"#dev\" class=\"headerlink\" title=\"/dev\"></a>/dev</h2><p>设备文件</p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"/etc\"></a>/etc</h2><p>系统的配置文件等</p>\n<h2 id=\"home\"><a href=\"#home\" class=\"headerlink\" title=\"/home\"></a>/home</h2><p>家目录</p>\n<h2 id=\"lib\"><a href=\"#lib\" class=\"headerlink\" title=\"/lib\"></a>/lib</h2><p>系统库</p>\n<h2 id=\"mnt\"><a href=\"#mnt\" class=\"headerlink\" title=\"/mnt\"></a>/mnt</h2><p>挂载目录，挂在别的文件系统</p>\n<h2 id=\"media\"><a href=\"#media\" class=\"headerlink\" title=\"/media\"></a>/media</h2><p>挂载目录</p>\n<h2 id=\"root\"><a href=\"#root\" class=\"headerlink\" title=\"/root\"></a>/root</h2><p>root用户的家目录</p>\n<h2 id=\"tmp\"><a href=\"#tmp\" class=\"headerlink\" title=\"/tmp\"></a>/tmp</h2><p>存放临时文件</p>\n<h2 id=\"sys\"><a href=\"#sys\" class=\"headerlink\" title=\"/sys\"></a>/sys</h2><p>里面的东西直接写入内存的东西，内核，驱动…</p>\n<h2 id=\"proc\"><a href=\"#proc\" class=\"headerlink\" title=\"/proc\"></a>/proc</h2><p>里面的东西直接写入内存</p>\n<h2 id=\"usr\"><a href=\"#usr\" class=\"headerlink\" title=\"/usr\"></a>/usr</h2><p>存放应用程序和文件</p>\n<h2 id=\"var\"><a href=\"#var\" class=\"headerlink\" title=\"/var\"></a>/var</h2><p>系统文档，比如/var/log</p>\n<h2 id=\"opt\"><a href=\"#opt\" class=\"headerlink\" title=\"/opt\"></a>/opt</h2><p>安装附加软件包，/opt/custom_package/bin下是软件目录</p>\n<h2 id=\"srv\"><a href=\"#srv\" class=\"headerlink\" title=\"/srv\"></a>/srv</h2><p>用于存储本机提供的服务或数据，比如/srv/www, /srv/ftp等</p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNDM1NTQ2NzU=\">https://zhuanlan.zhihu.com/p/343554675<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5saW51eGlkYy5jb20vTGludXgvMjAxNS0wNC8xMTYwMzIuaHRt\">http://www.linuxidc.com/Linux/2015-04/116032.htm<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTIxMDcxNDMvYXJ0aWNsZS9kZXRhaWxzLzU0OTcyNTQ0\">https://blog.csdn.net/u012107143/article/details/54972544<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>常用目录</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"/\"></a>/</h2><p>根目录</p>\n<h2 id=\"bin\"><a href=\"#bin\" class=\"headerlink\" title=\"/bin\"></a>/bin</h2><p>/bin, /sbin, /usr/bin, /usr/sbin这些都是存放可执行文件的，sbin下只有root才可以执行。</p>\n<h2 id=\"boot\"><a href=\"#boot\" class=\"headerlink\" title=\"/boot\"></a>/boot</h2><p>启动系统时候用的</p>\n<h2 id=\"dev\"><a href=\"#dev\" class=\"headerlink\" title=\"/dev\"></a>/dev</h2><p>设备文件</p>\n<h2 id=\"etc\"><a href=\"#etc\" class=\"headerlink\" title=\"/etc\"></a>/etc</h2><p>系统的配置文件等</p>\n<h2 id=\"home\"><a href=\"#home\" class=\"headerlink\" title=\"/home\"></a>/home</h2><p>家目录</p>\n<h2 id=\"lib\"><a href=\"#lib\" class=\"headerlink\" title=\"/lib\"></a>/lib</h2><p>系统库</p>\n<h2 id=\"mnt\"><a href=\"#mnt\" class=\"headerlink\" title=\"/mnt\"></a>/mnt</h2><p>挂载目录，挂在别的文件系统</p>\n<h2 id=\"media\"><a href=\"#media\" class=\"headerlink\" title=\"/media\"></a>/media</h2><p>挂载目录</p>\n<h2 id=\"root\"><a href=\"#root\" class=\"headerlink\" title=\"/root\"></a>/root</h2><p>root用户的家目录</p>\n<h2 id=\"tmp\"><a href=\"#tmp\" class=\"headerlink\" title=\"/tmp\"></a>/tmp</h2><p>存放临时文件</p>\n<h2 id=\"sys\"><a href=\"#sys\" class=\"headerlink\" title=\"/sys\"></a>/sys</h2><p>里面的东西直接写入内存的东西，内核，驱动…</p>\n<h2 id=\"proc\"><a href=\"#proc\" class=\"headerlink\" title=\"/proc\"></a>/proc</h2><p>里面的东西直接写入内存</p>\n<h2 id=\"usr\"><a href=\"#usr\" class=\"headerlink\" title=\"/usr\"></a>/usr</h2><p>存放应用程序和文件</p>\n<h2 id=\"var\"><a href=\"#var\" class=\"headerlink\" title=\"/var\"></a>/var</h2><p>系统文档，比如/var/log</p>\n<h2 id=\"opt\"><a href=\"#opt\" class=\"headerlink\" title=\"/opt\"></a>/opt</h2><p>安装附加软件包，/opt/custom_package/bin下是软件目录</p>\n<h2 id=\"srv\"><a href=\"#srv\" class=\"headerlink\" title=\"/srv\"></a>/srv</h2><p>用于存储本机提供的服务或数据，比如/srv/www, /srv/ftp等</p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNDM1NTQ2NzU=\">https://zhuanlan.zhihu.com/p/343554675<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5saW51eGlkYy5jb20vTGludXgvMjAxNS0wNC8xMTYwMzIuaHRt\">http://www.linuxidc.com/Linux/2015-04/116032.htm<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTIxMDcxNDMvYXJ0aWNsZS9kZXRhaWxzLzU0OTcyNTQ0\">https://blog.csdn.net/u012107143/article/details/54972544<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Linux ssh 保持连接","catagories":["Notebook"],"_content":"\n# Client\n\nFrom client, you can set this config to hold all the connection with servers.\n\n```\nvim ~/.ssh/config\nServerAliveInterval 60\n```\n\n# Server\n\nFrom server, you can hold all the connection with clients.\n\n```\nvim /etc/ssh/sshd_config\nClientAliveInterval 60\n```\n\n","source":"_posts/linux/linux-brokenpipe.md","raw":"---\ntitle: Linux ssh 保持连接\ncatagories: \n- Notebook\ntags: \n- linux\n- ssh\n---\n\n# Client\n\nFrom client, you can set this config to hold all the connection with servers.\n\n```\nvim ~/.ssh/config\nServerAliveInterval 60\n```\n\n# Server\n\nFrom server, you can hold all the connection with clients.\n\n```\nvim /etc/ssh/sshd_config\nClientAliveInterval 60\n```\n\n","slug":"linux/linux-brokenpipe","published":1,"date":"2021-02-26T05:38:40.469Z","updated":"2021-07-24T11:31:06.111Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z7004o018o0j54a5es","content":"<h1 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h1><p>From client, you can set this config to hold all the connection with servers.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~&#x2F;.ssh&#x2F;config</span><br><span class=\"line\">ServerAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h1><p>From server, you can hold all the connection with clients.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class=\"line\">ClientAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h1><p>From client, you can set this config to hold all the connection with servers.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~&#x2F;.ssh&#x2F;config</span><br><span class=\"line\">ServerAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h1><p>From server, you can hold all the connection with clients.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class=\"line\">ClientAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n"},{"title":"RedHat 防火墙","catagories":["Linux"],"_content":"\n# 查看状态\n\n```\nsystemctl status firewalld\n```\n\n- 开启防火墙\n- 开机启动\n\n```shell\nsystemctl start firewalld\nsystemctl enable firewalld\n```\n\n# 端口设置\n\n查看端口状态\n\n```shell\nfirewall-cmd --zone=public --list-ports\n```\n\n## 开放端口\n\n开启22端口\n\n```sh\nfirewall-cmd --zone=public --add-port=22/tcp --permanent\n```\n\n批量开放\n\n```sh\nfirewall-cmd --zone=public --add-port=100-500/tcp --permanent\n```\n\n载入防火墙设置\n\n```sh\nfirewall-cmd --reload\n```\n\n## 关闭端口\n\n关闭22端口\n\n```sh\nfirewall-cmd --zone=public --remove-port=22/tcp --permanent\n```\n\n载入防火墙设置\n\n```sh\nfirewall-cmd --reload\n```\n\n","source":"_posts/linux/linux-firewall.md","raw":"---\ntitle: RedHat 防火墙\ncatagories:\n- Linux\ntags:\n- firewall\n---\n\n# 查看状态\n\n```\nsystemctl status firewalld\n```\n\n- 开启防火墙\n- 开机启动\n\n```shell\nsystemctl start firewalld\nsystemctl enable firewalld\n```\n\n# 端口设置\n\n查看端口状态\n\n```shell\nfirewall-cmd --zone=public --list-ports\n```\n\n## 开放端口\n\n开启22端口\n\n```sh\nfirewall-cmd --zone=public --add-port=22/tcp --permanent\n```\n\n批量开放\n\n```sh\nfirewall-cmd --zone=public --add-port=100-500/tcp --permanent\n```\n\n载入防火墙设置\n\n```sh\nfirewall-cmd --reload\n```\n\n## 关闭端口\n\n关闭22端口\n\n```sh\nfirewall-cmd --zone=public --remove-port=22/tcp --permanent\n```\n\n载入防火墙设置\n\n```sh\nfirewall-cmd --reload\n```\n\n","slug":"linux/linux-firewall","published":1,"date":"2021-04-07T00:58:58.236Z","updated":"2021-04-07T01:13:44.543Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z8004r018ofzza6trb","content":"<h1 id=\"查看状态\"><a href=\"#查看状态\" class=\"headerlink\" title=\"查看状态\"></a>查看状态</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>开启防火墙</li>\n<li>开机启动</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start firewalld</span><br><span class=\"line\">systemctl enable firewalld</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"端口设置\"><a href=\"#端口设置\" class=\"headerlink\" title=\"端口设置\"></a>端口设置</h1><p>查看端口状态</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"开放端口\"><a href=\"#开放端口\" class=\"headerlink\" title=\"开放端口\"></a>开放端口</h2><p>开启22端口</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=22/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>批量开放</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=100-500/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>载入防火墙设置</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"关闭端口\"><a href=\"#关闭端口\" class=\"headerlink\" title=\"关闭端口\"></a>关闭端口</h2><p>关闭22端口</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --remove-port=22/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>载入防火墙设置</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"查看状态\"><a href=\"#查看状态\" class=\"headerlink\" title=\"查看状态\"></a>查看状态</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>开启防火墙</li>\n<li>开机启动</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start firewalld</span><br><span class=\"line\">systemctl enable firewalld</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"端口设置\"><a href=\"#端口设置\" class=\"headerlink\" title=\"端口设置\"></a>端口设置</h1><p>查看端口状态</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"开放端口\"><a href=\"#开放端口\" class=\"headerlink\" title=\"开放端口\"></a>开放端口</h2><p>开启22端口</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=22/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>批量开放</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=100-500/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>载入防火墙设置</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"关闭端口\"><a href=\"#关闭端口\" class=\"headerlink\" title=\"关闭端口\"></a>关闭端口</h2><p>关闭22端口</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --remove-port=22/tcp --permanent</span><br></pre></td></tr></table></figure>\n\n<p>载入防火墙设置</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n"},{"title":"查看服务器各种属性","catagories":["Notebook"],"_content":"\n# CPU属性\n\n```shell\nuser@server:~$ lscpu\n\nArchitecture:        x86_64\nCPU op-mode(s):      32-bit, 64-bit\nByte Order:          Little Endian\nCPU(s):              72\nOn-line CPU(s) list: 0-71\nThread(s) per core:  2\nCore(s) per socket:  18\nSocket(s):           2\nNUMA node(s):        2\nVendor ID:           GenuineIntel\nCPU family:          6\nModel:               85\nModel name:          Intel(R) Xeon(R) Gold 5220 CPU @ 2.20GHz\nStepping:            7\nCPU MHz:             999.916\nCPU max MHz:         3900.0000\nCPU min MHz:         1000.0000\nBogoMIPS:            4400.00\nVirtualization:      VT-x\nL1d cache:           32K\nL1i cache:           32K\nL2 cache:            1024K\nL3 cache:            25344K\nNUMA node0 CPU(s):   0-17,36-53\nNUMA node1 CPU(s):   18-35,54-71\n```\n\n\n\n# 查看内存\n\n-g是指以GB为单位，-m是以MB为单位。\n\n`free -g`\n\n详细信息\n\n`cat /proc/meminfo`\n\n# 查看硬盘\n\n**硬盘和分区分布**\n\n`lsblk`\n\n**硬盘和分区详细**\n\n`fdisk -l`\n\n**硬盘空间剩余**\n\n`df -h`\n\n**硬盘空间使用情况**\n\n当前目录的大小`du -sh`\n\n指定文件的大小`du filename`\n\n目录所占空间情况`du -h foldername`\n\n`-h`提高可读性\n\n# 查看显卡\n\n`nvidia-smi`\n\n# 根据PID查看进程详细信息\n\n\n\n`ls -l /proc/${pid}`\n\n\n\n`ps -ef | grep ${pid}`","source":"_posts/linux/linux-info.md","raw":"---\ntitle: 查看服务器各种属性\ncatagories: \n- Notebook\ntags: \n- linux\n---\n\n# CPU属性\n\n```shell\nuser@server:~$ lscpu\n\nArchitecture:        x86_64\nCPU op-mode(s):      32-bit, 64-bit\nByte Order:          Little Endian\nCPU(s):              72\nOn-line CPU(s) list: 0-71\nThread(s) per core:  2\nCore(s) per socket:  18\nSocket(s):           2\nNUMA node(s):        2\nVendor ID:           GenuineIntel\nCPU family:          6\nModel:               85\nModel name:          Intel(R) Xeon(R) Gold 5220 CPU @ 2.20GHz\nStepping:            7\nCPU MHz:             999.916\nCPU max MHz:         3900.0000\nCPU min MHz:         1000.0000\nBogoMIPS:            4400.00\nVirtualization:      VT-x\nL1d cache:           32K\nL1i cache:           32K\nL2 cache:            1024K\nL3 cache:            25344K\nNUMA node0 CPU(s):   0-17,36-53\nNUMA node1 CPU(s):   18-35,54-71\n```\n\n\n\n# 查看内存\n\n-g是指以GB为单位，-m是以MB为单位。\n\n`free -g`\n\n详细信息\n\n`cat /proc/meminfo`\n\n# 查看硬盘\n\n**硬盘和分区分布**\n\n`lsblk`\n\n**硬盘和分区详细**\n\n`fdisk -l`\n\n**硬盘空间剩余**\n\n`df -h`\n\n**硬盘空间使用情况**\n\n当前目录的大小`du -sh`\n\n指定文件的大小`du filename`\n\n目录所占空间情况`du -h foldername`\n\n`-h`提高可读性\n\n# 查看显卡\n\n`nvidia-smi`\n\n# 根据PID查看进程详细信息\n\n\n\n`ls -l /proc/${pid}`\n\n\n\n`ps -ef | grep ${pid}`","slug":"linux/linux-info","published":1,"date":"2021-01-21T00:58:11.628Z","updated":"2021-01-27T02:23:29.880Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97z8004u018o69st9r67","content":"<h1 id=\"CPU属性\"><a href=\"#CPU属性\" class=\"headerlink\" title=\"CPU属性\"></a>CPU属性</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">user@server:~$ lscpu</span><br><span class=\"line\"></span><br><span class=\"line\">Architecture:        x86_64</span><br><span class=\"line\">CPU op-mode(s):      32-bit, 64-bit</span><br><span class=\"line\">Byte Order:          Little Endian</span><br><span class=\"line\">CPU(s):              72</span><br><span class=\"line\">On-line CPU(s) list: 0-71</span><br><span class=\"line\">Thread(s) per core:  2</span><br><span class=\"line\">Core(s) per socket:  18</span><br><span class=\"line\">Socket(s):           2</span><br><span class=\"line\">NUMA node(s):        2</span><br><span class=\"line\">Vendor ID:           GenuineIntel</span><br><span class=\"line\">CPU family:          6</span><br><span class=\"line\">Model:               85</span><br><span class=\"line\">Model name:          Intel(R) Xeon(R) Gold 5220 CPU @ 2.20GHz</span><br><span class=\"line\">Stepping:            7</span><br><span class=\"line\">CPU MHz:             999.916</span><br><span class=\"line\">CPU max MHz:         3900.0000</span><br><span class=\"line\">CPU min MHz:         1000.0000</span><br><span class=\"line\">BogoMIPS:            4400.00</span><br><span class=\"line\">Virtualization:      VT-x</span><br><span class=\"line\">L1d cache:           32K</span><br><span class=\"line\">L1i cache:           32K</span><br><span class=\"line\">L2 cache:            1024K</span><br><span class=\"line\">L3 cache:            25344K</span><br><span class=\"line\">NUMA node0 CPU(s):   0-17,36-53</span><br><span class=\"line\">NUMA node1 CPU(s):   18-35,54-71</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"查看内存\"><a href=\"#查看内存\" class=\"headerlink\" title=\"查看内存\"></a>查看内存</h1><p>-g是指以GB为单位，-m是以MB为单位。</p>\n<p><code>free -g</code></p>\n<p>详细信息</p>\n<p><code>cat /proc/meminfo</code></p>\n<h1 id=\"查看硬盘\"><a href=\"#查看硬盘\" class=\"headerlink\" title=\"查看硬盘\"></a>查看硬盘</h1><p><strong>硬盘和分区分布</strong></p>\n<p><code>lsblk</code></p>\n<p><strong>硬盘和分区详细</strong></p>\n<p><code>fdisk -l</code></p>\n<p><strong>硬盘空间剩余</strong></p>\n<p><code>df -h</code></p>\n<p><strong>硬盘空间使用情况</strong></p>\n<p>当前目录的大小<code>du -sh</code></p>\n<p>指定文件的大小<code>du filename</code></p>\n<p>目录所占空间情况<code>du -h foldername</code></p>\n<p><code>-h</code>提高可读性</p>\n<h1 id=\"查看显卡\"><a href=\"#查看显卡\" class=\"headerlink\" title=\"查看显卡\"></a>查看显卡</h1><p><code>nvidia-smi</code></p>\n<h1 id=\"根据PID查看进程详细信息\"><a href=\"#根据PID查看进程详细信息\" class=\"headerlink\" title=\"根据PID查看进程详细信息\"></a>根据PID查看进程详细信息</h1><p><code>ls -l /proc/${pid}</code></p>\n<p><code>ps -ef | grep ${pid}</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"CPU属性\"><a href=\"#CPU属性\" class=\"headerlink\" title=\"CPU属性\"></a>CPU属性</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">user@server:~$ lscpu</span><br><span class=\"line\"></span><br><span class=\"line\">Architecture:        x86_64</span><br><span class=\"line\">CPU op-mode(s):      32-bit, 64-bit</span><br><span class=\"line\">Byte Order:          Little Endian</span><br><span class=\"line\">CPU(s):              72</span><br><span class=\"line\">On-line CPU(s) list: 0-71</span><br><span class=\"line\">Thread(s) per core:  2</span><br><span class=\"line\">Core(s) per socket:  18</span><br><span class=\"line\">Socket(s):           2</span><br><span class=\"line\">NUMA node(s):        2</span><br><span class=\"line\">Vendor ID:           GenuineIntel</span><br><span class=\"line\">CPU family:          6</span><br><span class=\"line\">Model:               85</span><br><span class=\"line\">Model name:          Intel(R) Xeon(R) Gold 5220 CPU @ 2.20GHz</span><br><span class=\"line\">Stepping:            7</span><br><span class=\"line\">CPU MHz:             999.916</span><br><span class=\"line\">CPU max MHz:         3900.0000</span><br><span class=\"line\">CPU min MHz:         1000.0000</span><br><span class=\"line\">BogoMIPS:            4400.00</span><br><span class=\"line\">Virtualization:      VT-x</span><br><span class=\"line\">L1d cache:           32K</span><br><span class=\"line\">L1i cache:           32K</span><br><span class=\"line\">L2 cache:            1024K</span><br><span class=\"line\">L3 cache:            25344K</span><br><span class=\"line\">NUMA node0 CPU(s):   0-17,36-53</span><br><span class=\"line\">NUMA node1 CPU(s):   18-35,54-71</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"查看内存\"><a href=\"#查看内存\" class=\"headerlink\" title=\"查看内存\"></a>查看内存</h1><p>-g是指以GB为单位，-m是以MB为单位。</p>\n<p><code>free -g</code></p>\n<p>详细信息</p>\n<p><code>cat /proc/meminfo</code></p>\n<h1 id=\"查看硬盘\"><a href=\"#查看硬盘\" class=\"headerlink\" title=\"查看硬盘\"></a>查看硬盘</h1><p><strong>硬盘和分区分布</strong></p>\n<p><code>lsblk</code></p>\n<p><strong>硬盘和分区详细</strong></p>\n<p><code>fdisk -l</code></p>\n<p><strong>硬盘空间剩余</strong></p>\n<p><code>df -h</code></p>\n<p><strong>硬盘空间使用情况</strong></p>\n<p>当前目录的大小<code>du -sh</code></p>\n<p>指定文件的大小<code>du filename</code></p>\n<p>目录所占空间情况<code>du -h foldername</code></p>\n<p><code>-h</code>提高可读性</p>\n<h1 id=\"查看显卡\"><a href=\"#查看显卡\" class=\"headerlink\" title=\"查看显卡\"></a>查看显卡</h1><p><code>nvidia-smi</code></p>\n<h1 id=\"根据PID查看进程详细信息\"><a href=\"#根据PID查看进程详细信息\" class=\"headerlink\" title=\"根据PID查看进程详细信息\"></a>根据PID查看进程详细信息</h1><p><code>ls -l /proc/${pid}</code></p>\n<p><code>ps -ef | grep ${pid}</code></p>\n"},{"title":"Linux硬连接和软连接","_content":"\n# 介绍\n\nLinux下的快捷方式称作硬连接(hard link)或软连接(symbolic link).\n\n# 例子\n\n创建一个文件`file.txt`\n\n`echo 'hello world.' > file.txt`\n\n创建硬连接\n\n`ln file.txt hardlink`\n\n创建软连接\n\n`ln -s file.txt softlink`\n\n查看文件属性\n\n`ls -li`\n\n```sh\n262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 file.txt\n262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 hardlink\n262991 lrwxrwxrwx 1 ubuntu ubuntu  8 Jan 28 15:19 softlink -> file.txt\n```\n\n\n\n可以看到`softlink`指向源文件\n\n而`hardlink`与源文件共享一个`inode`\n\n# 总结\n\n删除源文件，硬连接不受影响，仍可读取源文件的内容；软连接无法访问源文件的内容。\n\n硬连接类似于一个文件的备份。\n\n硬连接限制多，无法给文件夹创建硬连接。\n\n# 应用\n\n控制同一个软件的不同版本。\n\n\n\n----\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1683660","source":"_posts/linux/linux-link.md","raw":"---\ntitle: Linux硬连接和软连接\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# 介绍\n\nLinux下的快捷方式称作硬连接(hard link)或软连接(symbolic link).\n\n# 例子\n\n创建一个文件`file.txt`\n\n`echo 'hello world.' > file.txt`\n\n创建硬连接\n\n`ln file.txt hardlink`\n\n创建软连接\n\n`ln -s file.txt softlink`\n\n查看文件属性\n\n`ls -li`\n\n```sh\n262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 file.txt\n262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 hardlink\n262991 lrwxrwxrwx 1 ubuntu ubuntu  8 Jan 28 15:19 softlink -> file.txt\n```\n\n\n\n可以看到`softlink`指向源文件\n\n而`hardlink`与源文件共享一个`inode`\n\n# 总结\n\n删除源文件，硬连接不受影响，仍可读取源文件的内容；软连接无法访问源文件的内容。\n\n硬连接类似于一个文件的备份。\n\n硬连接限制多，无法给文件夹创建硬连接。\n\n# 应用\n\n控制同一个软件的不同版本。\n\n\n\n----\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1683660","slug":"linux/linux-link","published":1,"date":"2021-01-28T07:10:21.117Z","updated":"2021-01-28T07:30:48.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97za004y018oczdf97uu","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Linux下的快捷方式称作硬连接(hard link)或软连接(symbolic link).</p>\n<h1 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h1><p>创建一个文件<code>file.txt</code></p>\n<p><code>echo &#39;hello world.&#39; &gt; file.txt</code></p>\n<p>创建硬连接</p>\n<p><code>ln file.txt hardlink</code></p>\n<p>创建软连接</p>\n<p><code>ln -s file.txt softlink</code></p>\n<p>查看文件属性</p>\n<p><code>ls -li</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 file.txt</span><br><span class=\"line\">262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 hardlink</span><br><span class=\"line\">262991 lrwxrwxrwx 1 ubuntu ubuntu  8 Jan 28 15:19 softlink -&gt; file.txt</span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以看到<code>softlink</code>指向源文件</p>\n<p>而<code>hardlink</code>与源文件共享一个<code>inode</code></p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>删除源文件，硬连接不受影响，仍可读取源文件的内容；软连接无法访问源文件的内容。</p>\n<p>硬连接类似于一个文件的备份。</p>\n<p>硬连接限制多，无法给文件夹创建硬连接。</p>\n<h1 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h1><p>控制同一个软件的不同版本。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjgzNjYw\">https://cloud.tencent.com/developer/article/1683660<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Linux下的快捷方式称作硬连接(hard link)或软连接(symbolic link).</p>\n<h1 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h1><p>创建一个文件<code>file.txt</code></p>\n<p><code>echo &#39;hello world.&#39; &gt; file.txt</code></p>\n<p>创建硬连接</p>\n<p><code>ln file.txt hardlink</code></p>\n<p>创建软连接</p>\n<p><code>ln -s file.txt softlink</code></p>\n<p>查看文件属性</p>\n<p><code>ls -li</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 file.txt</span><br><span class=\"line\">262781 -rw-rw-r-- 2 ubuntu ubuntu 13 Jan 28 15:18 hardlink</span><br><span class=\"line\">262991 lrwxrwxrwx 1 ubuntu ubuntu  8 Jan 28 15:19 softlink -&gt; file.txt</span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以看到<code>softlink</code>指向源文件</p>\n<p>而<code>hardlink</code>与源文件共享一个<code>inode</code></p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>删除源文件，硬连接不受影响，仍可读取源文件的内容；软连接无法访问源文件的内容。</p>\n<p>硬连接类似于一个文件的备份。</p>\n<p>硬连接限制多，无法给文件夹创建硬连接。</p>\n<h1 id=\"应用\"><a href=\"#应用\" class=\"headerlink\" title=\"应用\"></a>应用</h1><p>控制同一个软件的不同版本。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjgzNjYw\">https://cloud.tencent.com/developer/article/1683660<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Linux hosts","catagories":["Linux"],"_content":"\n# 用途\n\nhosts文件在目录`/etc`，文件负责**IP地址与域名快速解析**。\n\n优先级：dns缓存 > hosts > dns服务\n\n# 配置\n\n## 格式\n\n网络IP地址  主机名或域名  主机名别名\n\n## 例子\n\n```\n127.0.0.1 localhost.localdomain localhost\n```\n\n# Hostname\n\n不能直接更改hostname\n\nhttps://blog.csdn.net/zhengchaooo/article/details/83177335\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.linuxidc.com/Linux/2016-10/135886.htm","source":"_posts/linux/linux-host.md","raw":"---\ntitle: Linux hosts\ncatagories:\n- Linux\ntags:\n- ubuntu\n- host\n---\n\n# 用途\n\nhosts文件在目录`/etc`，文件负责**IP地址与域名快速解析**。\n\n优先级：dns缓存 > hosts > dns服务\n\n# 配置\n\n## 格式\n\n网络IP地址  主机名或域名  主机名别名\n\n## 例子\n\n```\n127.0.0.1 localhost.localdomain localhost\n```\n\n# Hostname\n\n不能直接更改hostname\n\nhttps://blog.csdn.net/zhengchaooo/article/details/83177335\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.linuxidc.com/Linux/2016-10/135886.htm","slug":"linux/linux-host","published":1,"date":"2021-03-09T12:35:08.730Z","updated":"2021-03-09T12:59:35.851Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zb0050018o9y0lar28","content":"<h1 id=\"用途\"><a href=\"#用途\" class=\"headerlink\" title=\"用途\"></a>用途</h1><p>hosts文件在目录<code>/etc</code>，文件负责<strong>IP地址与域名快速解析</strong>。</p>\n<p>优先级：dns缓存 &gt; hosts &gt; dns服务</p>\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"格式\"><a href=\"#格式\" class=\"headerlink\" title=\"格式\"></a>格式</h2><p>网络IP地址  主机名或域名  主机名别名</p>\n<h2 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1 localhost.localdomain localhost</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Hostname\"><a href=\"#Hostname\" class=\"headerlink\" title=\"Hostname\"></a>Hostname</h1><p>不能直接更改hostname</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poZW5nY2hhb29vL2FydGljbGUvZGV0YWlscy84MzE3NzMzNQ==\">https://blog.csdn.net/zhengchaooo/article/details/83177335<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGludXhpZGMuY29tL0xpbnV4LzIwMTYtMTAvMTM1ODg2Lmh0bQ==\">https://www.linuxidc.com/Linux/2016-10/135886.htm<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"用途\"><a href=\"#用途\" class=\"headerlink\" title=\"用途\"></a>用途</h1><p>hosts文件在目录<code>/etc</code>，文件负责<strong>IP地址与域名快速解析</strong>。</p>\n<p>优先级：dns缓存 &gt; hosts &gt; dns服务</p>\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><h2 id=\"格式\"><a href=\"#格式\" class=\"headerlink\" title=\"格式\"></a>格式</h2><p>网络IP地址  主机名或域名  主机名别名</p>\n<h2 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1 localhost.localdomain localhost</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Hostname\"><a href=\"#Hostname\" class=\"headerlink\" title=\"Hostname\"></a>Hostname</h1><p>不能直接更改hostname</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poZW5nY2hhb29vL2FydGljbGUvZGV0YWlscy84MzE3NzMzNQ==\">https://blog.csdn.net/zhengchaooo/article/details/83177335<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGludXhpZGMuY29tL0xpbnV4LzIwMTYtMTAvMTM1ODg2Lmh0bQ==\">https://www.linuxidc.com/Linux/2016-10/135886.htm<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Linux上的Mariadb","catagories":["Linux"],"_content":"\n# Mariadb的使用\n\nLinux上已经摒弃了Mysql，以下是一些Mariadb的基本用法。\n\n## 创建用户\n\n`CREATE USER 'username'@'host' IDENTIFIED BY 'password';`\n\n## 用户权限\n\n`GRANT ALL privileges ON databasename.tablename TO 'username'@'host'`\n\n## 查看权限\n\n`show grants for 'root'@'%';`\n\n例:\n`MariaDB [(none)]> grant all on *.* to 'root'@'%';`\n`MariaDB [mysql]> flush privileges;`\n`MariaDB [(none)]> grant all privileges on *.* to 'root'@'%' identified by 'password';`\n\n## 查看用户\n\n`select user from mysql.user;`\n\n## 查看当前用户\n\n`select current_user;`\n\n## 删除用户\n\n`delete from mysql.user where user='root';`\n\n## 撤销权限\n\n`REVOKE privileges ON databasename.tablename FROM 'username'@'host';`\n\n# 坑\n\n如果创建外网可以登陆的用户\n\n`create user 'xxx'@'%' identified by 'xxx'`\n\n想用这个用户在本地`localhost`登陆的话会被拒绝访问\n\n再新建一个可以`localhost`登陆的用户即可","source":"_posts/linux/linux-mariadb.md","raw":"---\ntitle: Linux上的Mariadb\ncatagories:\n- Linux\ntags:\n- mariadb\n---\n\n# Mariadb的使用\n\nLinux上已经摒弃了Mysql，以下是一些Mariadb的基本用法。\n\n## 创建用户\n\n`CREATE USER 'username'@'host' IDENTIFIED BY 'password';`\n\n## 用户权限\n\n`GRANT ALL privileges ON databasename.tablename TO 'username'@'host'`\n\n## 查看权限\n\n`show grants for 'root'@'%';`\n\n例:\n`MariaDB [(none)]> grant all on *.* to 'root'@'%';`\n`MariaDB [mysql]> flush privileges;`\n`MariaDB [(none)]> grant all privileges on *.* to 'root'@'%' identified by 'password';`\n\n## 查看用户\n\n`select user from mysql.user;`\n\n## 查看当前用户\n\n`select current_user;`\n\n## 删除用户\n\n`delete from mysql.user where user='root';`\n\n## 撤销权限\n\n`REVOKE privileges ON databasename.tablename FROM 'username'@'host';`\n\n# 坑\n\n如果创建外网可以登陆的用户\n\n`create user 'xxx'@'%' identified by 'xxx'`\n\n想用这个用户在本地`localhost`登陆的话会被拒绝访问\n\n再新建一个可以`localhost`登陆的用户即可","slug":"linux/linux-mariadb","published":1,"date":"2020-04-17T14:03:46.762Z","updated":"2021-03-09T19:02:06.972Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zc0053018o21bog3op","content":"<h1 id=\"Mariadb的使用\"><a href=\"#Mariadb的使用\" class=\"headerlink\" title=\"Mariadb的使用\"></a>Mariadb的使用</h1><p>Linux上已经摒弃了Mysql，以下是一些Mariadb的基本用法。</p>\n<h2 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h2><p><code>CREATE USER &#39;username&#39;@&#39;host&#39; IDENTIFIED BY &#39;password&#39;;</code></p>\n<h2 id=\"用户权限\"><a href=\"#用户权限\" class=\"headerlink\" title=\"用户权限\"></a>用户权限</h2><p><code>GRANT ALL privileges ON databasename.tablename TO &#39;username&#39;@&#39;host&#39;</code></p>\n<h2 id=\"查看权限\"><a href=\"#查看权限\" class=\"headerlink\" title=\"查看权限\"></a>查看权限</h2><p><code>show grants for &#39;root&#39;@&#39;%&#39;;</code></p>\n<p>例:<br><code>MariaDB [(none)]&gt; grant all on *.* to &#39;root&#39;@&#39;%&#39;;</code><br><code>MariaDB [mysql]&gt; flush privileges;</code><br><code>MariaDB [(none)]&gt; grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; identified by &#39;password&#39;;</code></p>\n<h2 id=\"查看用户\"><a href=\"#查看用户\" class=\"headerlink\" title=\"查看用户\"></a>查看用户</h2><p><code>select user from mysql.user;</code></p>\n<h2 id=\"查看当前用户\"><a href=\"#查看当前用户\" class=\"headerlink\" title=\"查看当前用户\"></a>查看当前用户</h2><p><code>select current_user;</code></p>\n<h2 id=\"删除用户\"><a href=\"#删除用户\" class=\"headerlink\" title=\"删除用户\"></a>删除用户</h2><p><code>delete from mysql.user where user=&#39;root&#39;;</code></p>\n<h2 id=\"撤销权限\"><a href=\"#撤销权限\" class=\"headerlink\" title=\"撤销权限\"></a>撤销权限</h2><p><code>REVOKE privileges ON databasename.tablename FROM &#39;username&#39;@&#39;host&#39;;</code></p>\n<h1 id=\"坑\"><a href=\"#坑\" class=\"headerlink\" title=\"坑\"></a>坑</h1><p>如果创建外网可以登陆的用户</p>\n<p><code>create user &#39;xxx&#39;@&#39;%&#39; identified by &#39;xxx&#39;</code></p>\n<p>想用这个用户在本地<code>localhost</code>登陆的话会被拒绝访问</p>\n<p>再新建一个可以<code>localhost</code>登陆的用户即可</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Mariadb的使用\"><a href=\"#Mariadb的使用\" class=\"headerlink\" title=\"Mariadb的使用\"></a>Mariadb的使用</h1><p>Linux上已经摒弃了Mysql，以下是一些Mariadb的基本用法。</p>\n<h2 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h2><p><code>CREATE USER &#39;username&#39;@&#39;host&#39; IDENTIFIED BY &#39;password&#39;;</code></p>\n<h2 id=\"用户权限\"><a href=\"#用户权限\" class=\"headerlink\" title=\"用户权限\"></a>用户权限</h2><p><code>GRANT ALL privileges ON databasename.tablename TO &#39;username&#39;@&#39;host&#39;</code></p>\n<h2 id=\"查看权限\"><a href=\"#查看权限\" class=\"headerlink\" title=\"查看权限\"></a>查看权限</h2><p><code>show grants for &#39;root&#39;@&#39;%&#39;;</code></p>\n<p>例:<br><code>MariaDB [(none)]&gt; grant all on *.* to &#39;root&#39;@&#39;%&#39;;</code><br><code>MariaDB [mysql]&gt; flush privileges;</code><br><code>MariaDB [(none)]&gt; grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; identified by &#39;password&#39;;</code></p>\n<h2 id=\"查看用户\"><a href=\"#查看用户\" class=\"headerlink\" title=\"查看用户\"></a>查看用户</h2><p><code>select user from mysql.user;</code></p>\n<h2 id=\"查看当前用户\"><a href=\"#查看当前用户\" class=\"headerlink\" title=\"查看当前用户\"></a>查看当前用户</h2><p><code>select current_user;</code></p>\n<h2 id=\"删除用户\"><a href=\"#删除用户\" class=\"headerlink\" title=\"删除用户\"></a>删除用户</h2><p><code>delete from mysql.user where user=&#39;root&#39;;</code></p>\n<h2 id=\"撤销权限\"><a href=\"#撤销权限\" class=\"headerlink\" title=\"撤销权限\"></a>撤销权限</h2><p><code>REVOKE privileges ON databasename.tablename FROM &#39;username&#39;@&#39;host&#39;;</code></p>\n<h1 id=\"坑\"><a href=\"#坑\" class=\"headerlink\" title=\"坑\"></a>坑</h1><p>如果创建外网可以登陆的用户</p>\n<p><code>create user &#39;xxx&#39;@&#39;%&#39; identified by &#39;xxx&#39;</code></p>\n<p>想用这个用户在本地<code>localhost</code>登陆的话会被拒绝访问</p>\n<p>再新建一个可以<code>localhost</code>登陆的用户即可</p>\n"},{"title":"Linux中的nohup","_content":"\n# nohup输出到指定文件\n\n输出到默认文件`nohup.out`\n\n```sh\nnohup python train.py&\n```\n\n输出到指定文件\n\n```sh\nnohup python train.py&> train.out&\n```\n\n# 实时监控输出内容\n\n```sh\ntail -f nohup.out\n```\n\n\n\n# 查看程序进程\n\n`ps`显示当前进程状态，及其启动时的命令行参数\n\n```sh\nps -ef | grep cmd\n```\n\n","source":"_posts/linux/linux-nohup.md","raw":"---\ntitle: Linux中的nohup\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# nohup输出到指定文件\n\n输出到默认文件`nohup.out`\n\n```sh\nnohup python train.py&\n```\n\n输出到指定文件\n\n```sh\nnohup python train.py&> train.out&\n```\n\n# 实时监控输出内容\n\n```sh\ntail -f nohup.out\n```\n\n\n\n# 查看程序进程\n\n`ps`显示当前进程状态，及其启动时的命令行参数\n\n```sh\nps -ef | grep cmd\n```\n\n","slug":"linux/linux-nohup","published":1,"date":"2021-01-26T01:53:14.751Z","updated":"2021-01-26T01:59:40.771Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zd0055018o5nlo23cj","content":"<h1 id=\"nohup输出到指定文件\"><a href=\"#nohup输出到指定文件\" class=\"headerlink\" title=\"nohup输出到指定文件\"></a>nohup输出到指定文件</h1><p>输出到默认文件<code>nohup.out</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python train.py&amp;</span><br></pre></td></tr></table></figure>\n\n<p>输出到指定文件</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python train.py&amp;&gt; train.out&amp;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"实时监控输出内容\"><a href=\"#实时监控输出内容\" class=\"headerlink\" title=\"实时监控输出内容\"></a>实时监控输出内容</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f nohup.out</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"查看程序进程\"><a href=\"#查看程序进程\" class=\"headerlink\" title=\"查看程序进程\"></a>查看程序进程</h1><p><code>ps</code>显示当前进程状态，及其启动时的命令行参数</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep cmd</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"nohup输出到指定文件\"><a href=\"#nohup输出到指定文件\" class=\"headerlink\" title=\"nohup输出到指定文件\"></a>nohup输出到指定文件</h1><p>输出到默认文件<code>nohup.out</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python train.py&amp;</span><br></pre></td></tr></table></figure>\n\n<p>输出到指定文件</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python train.py&amp;&gt; train.out&amp;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"实时监控输出内容\"><a href=\"#实时监控输出内容\" class=\"headerlink\" title=\"实时监控输出内容\"></a>实时监控输出内容</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f nohup.out</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"查看程序进程\"><a href=\"#查看程序进程\" class=\"headerlink\" title=\"查看程序进程\"></a>查看程序进程</h1><p><code>ps</code>显示当前进程状态，及其启动时的命令行参数</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep cmd</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Linux Path 环境变量设置","_content":"\n# 新认识\n\n**显示环境变量**\n\n`echo $PATH`\n\n可以用`echo`查看任何设置好的变量\n\n`echo $JAVA_HOME`\n\n**添加环境变量**\n\n`export PATH=$PATH:pwd`\n\n`$PATH:`其实就是在PATH后面继续添加新路径，用`:`连接。\n\n**查找环境变量中的文件**\n\n通过`which`查找符合的在环境变量中的文件。\n\n例：\n\n已知有环境变量中有java，需要查找java所在目录以设置`JAVA_HOME`变量。\n\n`which java`查找到java执行地址，通过`ls -l pwd`找到该地址指向的地址，依次一直查找下去，找到java所在的真正地址。\n\n`export JAVA_HOME=pwd`\n\n","source":"_posts/linux/linux-path-1.md","raw":"---\ntitle: Linux Path 环境变量设置\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# 新认识\n\n**显示环境变量**\n\n`echo $PATH`\n\n可以用`echo`查看任何设置好的变量\n\n`echo $JAVA_HOME`\n\n**添加环境变量**\n\n`export PATH=$PATH:pwd`\n\n`$PATH:`其实就是在PATH后面继续添加新路径，用`:`连接。\n\n**查找环境变量中的文件**\n\n通过`which`查找符合的在环境变量中的文件。\n\n例：\n\n已知有环境变量中有java，需要查找java所在目录以设置`JAVA_HOME`变量。\n\n`which java`查找到java执行地址，通过`ls -l pwd`找到该地址指向的地址，依次一直查找下去，找到java所在的真正地址。\n\n`export JAVA_HOME=pwd`\n\n","slug":"linux/linux-path-1","published":1,"date":"2021-01-27T07:59:24.502Z","updated":"2021-01-27T08:35:08.088Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zd0059018o1ehe1a2x","content":"<h1 id=\"新认识\"><a href=\"#新认识\" class=\"headerlink\" title=\"新认识\"></a>新认识</h1><p><strong>显示环境变量</strong></p>\n<p><code>echo $PATH</code></p>\n<p>可以用<code>echo</code>查看任何设置好的变量</p>\n<p><code>echo $JAVA_HOME</code></p>\n<p><strong>添加环境变量</strong></p>\n<p><code>export PATH=$PATH:pwd</code></p>\n<p><code>$PATH:</code>其实就是在PATH后面继续添加新路径，用<code>:</code>连接。</p>\n<p><strong>查找环境变量中的文件</strong></p>\n<p>通过<code>which</code>查找符合的在环境变量中的文件。</p>\n<p>例：</p>\n<p>已知有环境变量中有java，需要查找java所在目录以设置<code>JAVA_HOME</code>变量。</p>\n<p><code>which java</code>查找到java执行地址，通过<code>ls -l pwd</code>找到该地址指向的地址，依次一直查找下去，找到java所在的真正地址。</p>\n<p><code>export JAVA_HOME=pwd</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"新认识\"><a href=\"#新认识\" class=\"headerlink\" title=\"新认识\"></a>新认识</h1><p><strong>显示环境变量</strong></p>\n<p><code>echo $PATH</code></p>\n<p>可以用<code>echo</code>查看任何设置好的变量</p>\n<p><code>echo $JAVA_HOME</code></p>\n<p><strong>添加环境变量</strong></p>\n<p><code>export PATH=$PATH:pwd</code></p>\n<p><code>$PATH:</code>其实就是在PATH后面继续添加新路径，用<code>:</code>连接。</p>\n<p><strong>查找环境变量中的文件</strong></p>\n<p>通过<code>which</code>查找符合的在环境变量中的文件。</p>\n<p>例：</p>\n<p>已知有环境变量中有java，需要查找java所在目录以设置<code>JAVA_HOME</code>变量。</p>\n<p><code>which java</code>查找到java执行地址，通过<code>ls -l pwd</code>找到该地址指向的地址，依次一直查找下去，找到java所在的真正地址。</p>\n<p><code>export JAVA_HOME=pwd</code></p>\n"},{"_content":"# [Linux]安装Java在多个版本中切换\n\n## 查看yum中的Java版本\n`$ yum search java-1.8`\n\n## 安装JDK\n`yum install java-1.8.0-openjdk-devel`\n\n安装JDK包含JRE\n\nJava Development EnvironmentKit 为 JDK\nJava Runtime Environment 为 JRE\n\n## 切换Java版本\n`$ sudo update-alternatives --display java` 查看安装了几个java\n`$ sudo update-alternatives --config java` 设置java的版本\n`$ alternatives --config javac` 设置javac的版本\n\n如已手动安装的可以用下面的命令去添加到列表\n`$ alternatives --install /usr/bin/java java /usr/java/jdk1.8/bin/java 180000`\n`$ alternatives --install /usr/bin/java javac /usr/java/jdk1.8/bin/javac 180000`\n","source":"_posts/linux/linux-java.md","raw":"# [Linux]安装Java在多个版本中切换\n\n## 查看yum中的Java版本\n`$ yum search java-1.8`\n\n## 安装JDK\n`yum install java-1.8.0-openjdk-devel`\n\n安装JDK包含JRE\n\nJava Development EnvironmentKit 为 JDK\nJava Runtime Environment 为 JRE\n\n## 切换Java版本\n`$ sudo update-alternatives --display java` 查看安装了几个java\n`$ sudo update-alternatives --config java` 设置java的版本\n`$ alternatives --config javac` 设置javac的版本\n\n如已手动安装的可以用下面的命令去添加到列表\n`$ alternatives --install /usr/bin/java java /usr/java/jdk1.8/bin/java 180000`\n`$ alternatives --install /usr/bin/java javac /usr/java/jdk1.8/bin/javac 180000`\n","slug":"linux/linux-java","published":1,"date":"2020-04-17T11:23:29.516Z","updated":"2020-04-17T11:41:07.903Z","title":"linux/linux-java","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97ze005b018o7vjha8rz","content":"<h1 id=\"Linux-安装Java在多个版本中切换\"><a href=\"#Linux-安装Java在多个版本中切换\" class=\"headerlink\" title=\"[Linux]安装Java在多个版本中切换\"></a>[Linux]安装Java在多个版本中切换</h1><h2 id=\"查看yum中的Java版本\"><a href=\"#查看yum中的Java版本\" class=\"headerlink\" title=\"查看yum中的Java版本\"></a>查看yum中的Java版本</h2><p><code>$ yum search java-1.8</code></p>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p><code>yum install java-1.8.0-openjdk-devel</code></p>\n<p>安装JDK包含JRE</p>\n<p>Java Development EnvironmentKit 为 JDK<br>Java Runtime Environment 为 JRE</p>\n<h2 id=\"切换Java版本\"><a href=\"#切换Java版本\" class=\"headerlink\" title=\"切换Java版本\"></a>切换Java版本</h2><p><code>$ sudo update-alternatives --display java</code> 查看安装了几个java<br><code>$ sudo update-alternatives --config java</code> 设置java的版本<br><code>$ alternatives --config javac</code> 设置javac的版本</p>\n<p>如已手动安装的可以用下面的命令去添加到列表<br><code>$ alternatives --install /usr/bin/java java /usr/java/jdk1.8/bin/java 180000</code><br><code>$ alternatives --install /usr/bin/java javac /usr/java/jdk1.8/bin/javac 180000</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Linux-安装Java在多个版本中切换\"><a href=\"#Linux-安装Java在多个版本中切换\" class=\"headerlink\" title=\"[Linux]安装Java在多个版本中切换\"></a>[Linux]安装Java在多个版本中切换</h1><h2 id=\"查看yum中的Java版本\"><a href=\"#查看yum中的Java版本\" class=\"headerlink\" title=\"查看yum中的Java版本\"></a>查看yum中的Java版本</h2><p><code>$ yum search java-1.8</code></p>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p><code>yum install java-1.8.0-openjdk-devel</code></p>\n<p>安装JDK包含JRE</p>\n<p>Java Development EnvironmentKit 为 JDK<br>Java Runtime Environment 为 JRE</p>\n<h2 id=\"切换Java版本\"><a href=\"#切换Java版本\" class=\"headerlink\" title=\"切换Java版本\"></a>切换Java版本</h2><p><code>$ sudo update-alternatives --display java</code> 查看安装了几个java<br><code>$ sudo update-alternatives --config java</code> 设置java的版本<br><code>$ alternatives --config javac</code> 设置javac的版本</p>\n<p>如已手动安装的可以用下面的命令去添加到列表<br><code>$ alternatives --install /usr/bin/java java /usr/java/jdk1.8/bin/java 180000</code><br><code>$ alternatives --install /usr/bin/java javac /usr/java/jdk1.8/bin/javac 180000</code></p>\n"},{"title":"Linux 端口","catagories":["Linux"],"_content":"\n","source":"_posts/linux/linux-port.md","raw":"---\ntitle:  Linux 端口\ncatagories:\n- Linux\ntags:\n- port\n---\n\n","slug":"linux/linux-port","published":1,"date":"2021-04-07T01:31:23.634Z","updated":"2021-04-07T01:31:52.495Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zf005d018od3jf3csc","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"修改环境变量","_content":"\n# Linux下修改环境变量\n\n## 查看PATH\necho $PATH\n以添加mongodb server为列\n\n## 修改方法一\nexport PATH=/usr/local/mongodb/bin:$PATH  \n//配置完后可以通过echo $PATH查看配置结果。  \n生效方法：立即生效  \n有效期限：临时改变，只能在当前的终端窗口中有效，当前窗口关闭后就会恢复原有的path配置  \n用户局限：仅对当前用户\n\n## 修改方法二\n通过修改.bashrc文件:  \nvim ~/.bashrc  \n//在最后一行添上：  \nexport PATH=/usr/local/mongodb/bin:$PATH  \n生效方法：（有以下两种）  \n1、关闭当前终端窗口，重新打开一个新终端窗口就能生效  \n2、输入“source ~/.bashrc”命令，立即生效  \n有效期限：永久有效  \n用户局限：仅对当前用户\n\n## 修改方法三\n通过修改profile文件:  \nvim /etc/profile  \n/export PATH //找到设置PATH的行，添加  \nexport PATH=/usr/local/mongodb/bin:$PATH  \n生效方法：系统重启  \n有效期限：永久有效  \n用户局限：对所有用户\n\n## 修改方法四\n通过修改environment文件:  \nvim /etc/environment  \n在PATH=”/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games”中加入“:/usr/local/mongodb/bin”  \n生效方法：系统重启  \n有效期限：永久有效  \n用户局限：对所有用户\n\n\n## MacOS\nMAC OS X环境配置的加载顺序\n\n- 系统级别  \n/etc/profile  \n/etc/paths \n\n- 用户级别  \n~/.bash_profile   \n~/.bash_login   \n~/.profile   \n~/.bashrc  （在打开shell时加载）\n\n/etc/paths 全局建议修改这个文件  \n/etc/profile 不建议修改这个文件，全局共有配置，用户登录时候都会加载该文件  \n/etc/bashrc 一般在这个文件中添加系统级别的环境变量，全局共有配置，bash shell执行时候都会加载\n\n## Tips\n想要立即生效执行`source`","source":"_posts/linux/linux-path.md","raw":"---\ntitle: 修改环境变量\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# Linux下修改环境变量\n\n## 查看PATH\necho $PATH\n以添加mongodb server为列\n\n## 修改方法一\nexport PATH=/usr/local/mongodb/bin:$PATH  \n//配置完后可以通过echo $PATH查看配置结果。  \n生效方法：立即生效  \n有效期限：临时改变，只能在当前的终端窗口中有效，当前窗口关闭后就会恢复原有的path配置  \n用户局限：仅对当前用户\n\n## 修改方法二\n通过修改.bashrc文件:  \nvim ~/.bashrc  \n//在最后一行添上：  \nexport PATH=/usr/local/mongodb/bin:$PATH  \n生效方法：（有以下两种）  \n1、关闭当前终端窗口，重新打开一个新终端窗口就能生效  \n2、输入“source ~/.bashrc”命令，立即生效  \n有效期限：永久有效  \n用户局限：仅对当前用户\n\n## 修改方法三\n通过修改profile文件:  \nvim /etc/profile  \n/export PATH //找到设置PATH的行，添加  \nexport PATH=/usr/local/mongodb/bin:$PATH  \n生效方法：系统重启  \n有效期限：永久有效  \n用户局限：对所有用户\n\n## 修改方法四\n通过修改environment文件:  \nvim /etc/environment  \n在PATH=”/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games”中加入“:/usr/local/mongodb/bin”  \n生效方法：系统重启  \n有效期限：永久有效  \n用户局限：对所有用户\n\n\n## MacOS\nMAC OS X环境配置的加载顺序\n\n- 系统级别  \n/etc/profile  \n/etc/paths \n\n- 用户级别  \n~/.bash_profile   \n~/.bash_login   \n~/.profile   \n~/.bashrc  （在打开shell时加载）\n\n/etc/paths 全局建议修改这个文件  \n/etc/profile 不建议修改这个文件，全局共有配置，用户登录时候都会加载该文件  \n/etc/bashrc 一般在这个文件中添加系统级别的环境变量，全局共有配置，bash shell执行时候都会加载\n\n## Tips\n想要立即生效执行`source`","slug":"linux/linux-path","published":1,"date":"2020-11-06T18:09:33.829Z","updated":"2020-11-11T18:18:32.709Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zg005h018o8oqxcbl1","content":"<h1 id=\"Linux下修改环境变量\"><a href=\"#Linux下修改环境变量\" class=\"headerlink\" title=\"Linux下修改环境变量\"></a>Linux下修改环境变量</h1><h2 id=\"查看PATH\"><a href=\"#查看PATH\" class=\"headerlink\" title=\"查看PATH\"></a>查看PATH</h2><p>echo $PATH<br>以添加mongodb server为列</p>\n<h2 id=\"修改方法一\"><a href=\"#修改方法一\" class=\"headerlink\" title=\"修改方法一\"></a>修改方法一</h2><p>export PATH=/usr/local/mongodb/bin:$PATH<br>//配置完后可以通过echo $PATH查看配置结果。<br>生效方法：立即生效<br>有效期限：临时改变，只能在当前的终端窗口中有效，当前窗口关闭后就会恢复原有的path配置<br>用户局限：仅对当前用户</p>\n<h2 id=\"修改方法二\"><a href=\"#修改方法二\" class=\"headerlink\" title=\"修改方法二\"></a>修改方法二</h2><p>通过修改.bashrc文件:<br>vim ~/.bashrc<br>//在最后一行添上：<br>export PATH=/usr/local/mongodb/bin:$PATH<br>生效方法：（有以下两种）<br>1、关闭当前终端窗口，重新打开一个新终端窗口就能生效<br>2、输入“source ~/.bashrc”命令，立即生效<br>有效期限：永久有效<br>用户局限：仅对当前用户</p>\n<h2 id=\"修改方法三\"><a href=\"#修改方法三\" class=\"headerlink\" title=\"修改方法三\"></a>修改方法三</h2><p>通过修改profile文件:<br>vim /etc/profile<br>/export PATH //找到设置PATH的行，添加<br>export PATH=/usr/local/mongodb/bin:$PATH<br>生效方法：系统重启<br>有效期限：永久有效<br>用户局限：对所有用户</p>\n<h2 id=\"修改方法四\"><a href=\"#修改方法四\" class=\"headerlink\" title=\"修改方法四\"></a>修改方法四</h2><p>通过修改environment文件:<br>vim /etc/environment<br>在PATH=”/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games”中加入“:/usr/local/mongodb/bin”<br>生效方法：系统重启<br>有效期限：永久有效<br>用户局限：对所有用户</p>\n<h2 id=\"MacOS\"><a href=\"#MacOS\" class=\"headerlink\" title=\"MacOS\"></a>MacOS</h2><p>MAC OS X环境配置的加载顺序</p>\n<ul>\n<li><p>系统级别<br>/etc/profile<br>/etc/paths </p>\n</li>\n<li><p>用户级别<br>~/.bash_profile<br>~/.bash_login<br>~/.profile<br>~/.bashrc  （在打开shell时加载）</p>\n</li>\n</ul>\n<p>/etc/paths 全局建议修改这个文件<br>/etc/profile 不建议修改这个文件，全局共有配置，用户登录时候都会加载该文件<br>/etc/bashrc 一般在这个文件中添加系统级别的环境变量，全局共有配置，bash shell执行时候都会加载</p>\n<h2 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h2><p>想要立即生效执行<code>source</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Linux下修改环境变量\"><a href=\"#Linux下修改环境变量\" class=\"headerlink\" title=\"Linux下修改环境变量\"></a>Linux下修改环境变量</h1><h2 id=\"查看PATH\"><a href=\"#查看PATH\" class=\"headerlink\" title=\"查看PATH\"></a>查看PATH</h2><p>echo $PATH<br>以添加mongodb server为列</p>\n<h2 id=\"修改方法一\"><a href=\"#修改方法一\" class=\"headerlink\" title=\"修改方法一\"></a>修改方法一</h2><p>export PATH=/usr/local/mongodb/bin:$PATH<br>//配置完后可以通过echo $PATH查看配置结果。<br>生效方法：立即生效<br>有效期限：临时改变，只能在当前的终端窗口中有效，当前窗口关闭后就会恢复原有的path配置<br>用户局限：仅对当前用户</p>\n<h2 id=\"修改方法二\"><a href=\"#修改方法二\" class=\"headerlink\" title=\"修改方法二\"></a>修改方法二</h2><p>通过修改.bashrc文件:<br>vim ~/.bashrc<br>//在最后一行添上：<br>export PATH=/usr/local/mongodb/bin:$PATH<br>生效方法：（有以下两种）<br>1、关闭当前终端窗口，重新打开一个新终端窗口就能生效<br>2、输入“source ~/.bashrc”命令，立即生效<br>有效期限：永久有效<br>用户局限：仅对当前用户</p>\n<h2 id=\"修改方法三\"><a href=\"#修改方法三\" class=\"headerlink\" title=\"修改方法三\"></a>修改方法三</h2><p>通过修改profile文件:<br>vim /etc/profile<br>/export PATH //找到设置PATH的行，添加<br>export PATH=/usr/local/mongodb/bin:$PATH<br>生效方法：系统重启<br>有效期限：永久有效<br>用户局限：对所有用户</p>\n<h2 id=\"修改方法四\"><a href=\"#修改方法四\" class=\"headerlink\" title=\"修改方法四\"></a>修改方法四</h2><p>通过修改environment文件:<br>vim /etc/environment<br>在PATH=”/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games”中加入“:/usr/local/mongodb/bin”<br>生效方法：系统重启<br>有效期限：永久有效<br>用户局限：对所有用户</p>\n<h2 id=\"MacOS\"><a href=\"#MacOS\" class=\"headerlink\" title=\"MacOS\"></a>MacOS</h2><p>MAC OS X环境配置的加载顺序</p>\n<ul>\n<li><p>系统级别<br>/etc/profile<br>/etc/paths </p>\n</li>\n<li><p>用户级别<br>~/.bash_profile<br>~/.bash_login<br>~/.profile<br>~/.bashrc  （在打开shell时加载）</p>\n</li>\n</ul>\n<p>/etc/paths 全局建议修改这个文件<br>/etc/profile 不建议修改这个文件，全局共有配置，用户登录时候都会加载该文件<br>/etc/bashrc 一般在这个文件中添加系统级别的环境变量，全局共有配置，bash shell执行时候都会加载</p>\n<h2 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h2><p>想要立即生效执行<code>source</code></p>\n"},{"itle":"Linux中的systemd","_content":"\n# 介绍\n\nsystemctl是Systemd的一个工具，负责控制systemd系统和服务管理器。\n\nsystemd是一个系统管理守护进程、工具和库的集合。\n\n# 指令\n\n开机自动启动（在引导时激活服务并启动或禁用服务）\n\n`systemctl enable xxx`\n\n启动服务\n\n`systemctl start xxx`\n\n查看状态\n\n`systemctl status xxx`\n\n\n\n# 其它\n\n其他详细功能查看\n\nhttps://linux.cn/article-5926-1.html","source":"_posts/linux/linux-systemd.md","raw":"---\nitle: Linux中的systemd\ncategories:\n- Notebook\ntags:\n- linux\n---\n\n# 介绍\n\nsystemctl是Systemd的一个工具，负责控制systemd系统和服务管理器。\n\nsystemd是一个系统管理守护进程、工具和库的集合。\n\n# 指令\n\n开机自动启动（在引导时激活服务并启动或禁用服务）\n\n`systemctl enable xxx`\n\n启动服务\n\n`systemctl start xxx`\n\n查看状态\n\n`systemctl status xxx`\n\n\n\n# 其它\n\n其他详细功能查看\n\nhttps://linux.cn/article-5926-1.html","slug":"linux/linux-systemd","published":1,"date":"2021-01-27T06:10:43.575Z","updated":"2021-01-27T06:15:25.794Z","title":"linux/linux-systemd","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zh005k018o1qoieoiz","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>systemctl是Systemd的一个工具，负责控制systemd系统和服务管理器。</p>\n<p>systemd是一个系统管理守护进程、工具和库的集合。</p>\n<h1 id=\"指令\"><a href=\"#指令\" class=\"headerlink\" title=\"指令\"></a>指令</h1><p>开机自动启动（在引导时激活服务并启动或禁用服务）</p>\n<p><code>systemctl enable xxx</code></p>\n<p>启动服务</p>\n<p><code>systemctl start xxx</code></p>\n<p>查看状态</p>\n<p><code>systemctl status xxx</code></p>\n<h1 id=\"其它\"><a href=\"#其它\" class=\"headerlink\" title=\"其它\"></a>其它</h1><p>其他详细功能查看</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTU5MjYtMS5odG1s\">https://linux.cn/article-5926-1.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>systemctl是Systemd的一个工具，负责控制systemd系统和服务管理器。</p>\n<p>systemd是一个系统管理守护进程、工具和库的集合。</p>\n<h1 id=\"指令\"><a href=\"#指令\" class=\"headerlink\" title=\"指令\"></a>指令</h1><p>开机自动启动（在引导时激活服务并启动或禁用服务）</p>\n<p><code>systemctl enable xxx</code></p>\n<p>启动服务</p>\n<p><code>systemctl start xxx</code></p>\n<p>查看状态</p>\n<p><code>systemctl status xxx</code></p>\n<h1 id=\"其它\"><a href=\"#其它\" class=\"headerlink\" title=\"其它\"></a>其它</h1><p>其他详细功能查看</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTU5MjYtMS5odG1s\">https://linux.cn/article-5926-1.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Linux下的ssh密钥","catagories":["Notebook"],"_content":"\n# 创建SSH Key\n\n## 生成\n\n创建一对公钥与私钥\n\n```sh\nssh-keygen -C \"description\"\n```\n\n`-C`可以对Key进行描述，描述内容将在公钥(.pub)的最后显示.\n\n- 输入Key的名称\n- 输入Key的密码（如果不需要，可以不输入）\n\n## 复制公钥\n\n```sh\nssh-copy-id user@hostname\n```\n\n`-i`指定公钥文件\n\n## 登陆\n\n```sh\nssh -i privateKey user@hostname\n```\n\n`-i`指定私钥文件\n\n# Client\n\n## 管理多个私钥\n\n### 方法一\n\n修改`~/.ssh/config`\n\n```\nHost host_alias\nHostName host\nPort 22\nUser ubuntu\nIdentityFile id_rsa_common\n```\n\n有多个私钥只需要追加在后面即可。\n\n\n\n通过配置后可以直接\n\n```sh\nssh host_alias\n```\n\n进行登录\n\n### 方法二\n\n```sh\n#ssh-agent\n# 不输可能出错？\n# 添加私钥\nssh-add id_rsa_common\n\n# 查看私钥列表\nssh-add -l\n# 清空私钥\nssh-add -D\n```\n\n# Server\n\n## 管理多个公钥\n\n只要将公钥中的内容直接复制到`authorized_keys`文件中即可。\n\n## SSH配置\n\n开启鉴权\n\n```sh\nRSAAuthentication yes\nPubkeyAuthentication yes\n\n#PermitRootLogin no\n#PasswordAuthentication yes\n\n```\n\n## Github\n\n将公钥直接复制到用户下的SSH中\n\n```sh\nssh -T git@github.com\n```\n\n使用这种测试时必须`ssh-add`，否则它只会查找目录下默认的私钥名，如果自定义了名字则找不到。并且如果使用的是第一种添加私钥的方法也不行，因为此时请求的是git账号。\n\n----\n\nReference\n\nhttps://www.cnblogs.com/yanglang/p/9563496.html\n\nhttps://blog.csdn.net/zyaiwmy/article/details/54313283\n\nhttps://www.jianshu.com/p/fe215c52c534","source":"_posts/linux/linux-ssh.md","raw":"---\ntitle: Linux下的ssh密钥\ncatagories: \n- Notebook\ntags: \n- linux\n- ssh\n---\n\n# 创建SSH Key\n\n## 生成\n\n创建一对公钥与私钥\n\n```sh\nssh-keygen -C \"description\"\n```\n\n`-C`可以对Key进行描述，描述内容将在公钥(.pub)的最后显示.\n\n- 输入Key的名称\n- 输入Key的密码（如果不需要，可以不输入）\n\n## 复制公钥\n\n```sh\nssh-copy-id user@hostname\n```\n\n`-i`指定公钥文件\n\n## 登陆\n\n```sh\nssh -i privateKey user@hostname\n```\n\n`-i`指定私钥文件\n\n# Client\n\n## 管理多个私钥\n\n### 方法一\n\n修改`~/.ssh/config`\n\n```\nHost host_alias\nHostName host\nPort 22\nUser ubuntu\nIdentityFile id_rsa_common\n```\n\n有多个私钥只需要追加在后面即可。\n\n\n\n通过配置后可以直接\n\n```sh\nssh host_alias\n```\n\n进行登录\n\n### 方法二\n\n```sh\n#ssh-agent\n# 不输可能出错？\n# 添加私钥\nssh-add id_rsa_common\n\n# 查看私钥列表\nssh-add -l\n# 清空私钥\nssh-add -D\n```\n\n# Server\n\n## 管理多个公钥\n\n只要将公钥中的内容直接复制到`authorized_keys`文件中即可。\n\n## SSH配置\n\n开启鉴权\n\n```sh\nRSAAuthentication yes\nPubkeyAuthentication yes\n\n#PermitRootLogin no\n#PasswordAuthentication yes\n\n```\n\n## Github\n\n将公钥直接复制到用户下的SSH中\n\n```sh\nssh -T git@github.com\n```\n\n使用这种测试时必须`ssh-add`，否则它只会查找目录下默认的私钥名，如果自定义了名字则找不到。并且如果使用的是第一种添加私钥的方法也不行，因为此时请求的是git账号。\n\n----\n\nReference\n\nhttps://www.cnblogs.com/yanglang/p/9563496.html\n\nhttps://blog.csdn.net/zyaiwmy/article/details/54313283\n\nhttps://www.jianshu.com/p/fe215c52c534","slug":"linux/linux-ssh","published":1,"date":"2021-01-29T05:58:35.267Z","updated":"2021-01-29T07:14:11.612Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zi005n018ogqh6hdcq","content":"<h1 id=\"创建SSH-Key\"><a href=\"#创建SSH-Key\" class=\"headerlink\" title=\"创建SSH Key\"></a>创建SSH Key</h1><h2 id=\"生成\"><a href=\"#生成\" class=\"headerlink\" title=\"生成\"></a>生成</h2><p>创建一对公钥与私钥</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -C <span class=\"string\">\"description\"</span></span><br></pre></td></tr></table></figure>\n\n<p><code>-C</code>可以对Key进行描述，描述内容将在公钥(.pub)的最后显示.</p>\n<ul>\n<li>输入Key的名称</li>\n<li>输入Key的密码（如果不需要，可以不输入）</li>\n</ul>\n<h2 id=\"复制公钥\"><a href=\"#复制公钥\" class=\"headerlink\" title=\"复制公钥\"></a>复制公钥</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-copy-id user@hostname</span><br></pre></td></tr></table></figure>\n\n<p><code>-i</code>指定公钥文件</p>\n<h2 id=\"登陆\"><a href=\"#登陆\" class=\"headerlink\" title=\"登陆\"></a>登陆</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i privateKey user@hostname</span><br></pre></td></tr></table></figure>\n\n<p><code>-i</code>指定私钥文件</p>\n<h1 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h1><h2 id=\"管理多个私钥\"><a href=\"#管理多个私钥\" class=\"headerlink\" title=\"管理多个私钥\"></a>管理多个私钥</h2><h3 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h3><p>修改<code>~/.ssh/config</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host host_alias</span><br><span class=\"line\">HostName host</span><br><span class=\"line\">Port 22</span><br><span class=\"line\">User ubuntu</span><br><span class=\"line\">IdentityFile id_rsa_common</span><br></pre></td></tr></table></figure>\n\n<p>有多个私钥只需要追加在后面即可。</p>\n<p>通过配置后可以直接</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh host_alias</span><br></pre></td></tr></table></figure>\n\n<p>进行登录</p>\n<h3 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ssh-agent</span></span><br><span class=\"line\"><span class=\"comment\"># 不输可能出错？</span></span><br><span class=\"line\"><span class=\"comment\"># 添加私钥</span></span><br><span class=\"line\">ssh-add id_rsa_common</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看私钥列表</span></span><br><span class=\"line\">ssh-add -l</span><br><span class=\"line\"><span class=\"comment\"># 清空私钥</span></span><br><span class=\"line\">ssh-add -D</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h1><h2 id=\"管理多个公钥\"><a href=\"#管理多个公钥\" class=\"headerlink\" title=\"管理多个公钥\"></a>管理多个公钥</h2><p>只要将公钥中的内容直接复制到<code>authorized_keys</code>文件中即可。</p>\n<h2 id=\"SSH配置\"><a href=\"#SSH配置\" class=\"headerlink\" title=\"SSH配置\"></a>SSH配置</h2><p>开启鉴权</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RSAAuthentication yes</span><br><span class=\"line\">PubkeyAuthentication yes</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#PermitRootLogin no</span></span><br><span class=\"line\"><span class=\"comment\">#PasswordAuthentication yes</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Github\"><a href=\"#Github\" class=\"headerlink\" title=\"Github\"></a>Github</h2><p>将公钥直接复制到用户下的SSH中</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T git@github.com</span><br></pre></td></tr></table></figure>\n\n<p>使用这种测试时必须<code>ssh-add</code>，否则它只会查找目录下默认的私钥名，如果自定义了名字则找不到。并且如果使用的是第一种添加私钥的方法也不行，因为此时请求的是git账号。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2xhbmcvcC85NTYzNDk2Lmh0bWw=\">https://www.cnblogs.com/yanglang/p/9563496.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5YWl3bXkvYXJ0aWNsZS9kZXRhaWxzLzU0MzEzMjgz\">https://blog.csdn.net/zyaiwmy/article/details/54313283<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9mZTIxNWM1MmM1MzQ=\">https://www.jianshu.com/p/fe215c52c534<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"创建SSH-Key\"><a href=\"#创建SSH-Key\" class=\"headerlink\" title=\"创建SSH Key\"></a>创建SSH Key</h1><h2 id=\"生成\"><a href=\"#生成\" class=\"headerlink\" title=\"生成\"></a>生成</h2><p>创建一对公钥与私钥</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -C <span class=\"string\">\"description\"</span></span><br></pre></td></tr></table></figure>\n\n<p><code>-C</code>可以对Key进行描述，描述内容将在公钥(.pub)的最后显示.</p>\n<ul>\n<li>输入Key的名称</li>\n<li>输入Key的密码（如果不需要，可以不输入）</li>\n</ul>\n<h2 id=\"复制公钥\"><a href=\"#复制公钥\" class=\"headerlink\" title=\"复制公钥\"></a>复制公钥</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-copy-id user@hostname</span><br></pre></td></tr></table></figure>\n\n<p><code>-i</code>指定公钥文件</p>\n<h2 id=\"登陆\"><a href=\"#登陆\" class=\"headerlink\" title=\"登陆\"></a>登陆</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i privateKey user@hostname</span><br></pre></td></tr></table></figure>\n\n<p><code>-i</code>指定私钥文件</p>\n<h1 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h1><h2 id=\"管理多个私钥\"><a href=\"#管理多个私钥\" class=\"headerlink\" title=\"管理多个私钥\"></a>管理多个私钥</h2><h3 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h3><p>修改<code>~/.ssh/config</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host host_alias</span><br><span class=\"line\">HostName host</span><br><span class=\"line\">Port 22</span><br><span class=\"line\">User ubuntu</span><br><span class=\"line\">IdentityFile id_rsa_common</span><br></pre></td></tr></table></figure>\n\n<p>有多个私钥只需要追加在后面即可。</p>\n<p>通过配置后可以直接</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh host_alias</span><br></pre></td></tr></table></figure>\n\n<p>进行登录</p>\n<h3 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#ssh-agent</span></span><br><span class=\"line\"><span class=\"comment\"># 不输可能出错？</span></span><br><span class=\"line\"><span class=\"comment\"># 添加私钥</span></span><br><span class=\"line\">ssh-add id_rsa_common</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看私钥列表</span></span><br><span class=\"line\">ssh-add -l</span><br><span class=\"line\"><span class=\"comment\"># 清空私钥</span></span><br><span class=\"line\">ssh-add -D</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h1><h2 id=\"管理多个公钥\"><a href=\"#管理多个公钥\" class=\"headerlink\" title=\"管理多个公钥\"></a>管理多个公钥</h2><p>只要将公钥中的内容直接复制到<code>authorized_keys</code>文件中即可。</p>\n<h2 id=\"SSH配置\"><a href=\"#SSH配置\" class=\"headerlink\" title=\"SSH配置\"></a>SSH配置</h2><p>开启鉴权</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RSAAuthentication yes</span><br><span class=\"line\">PubkeyAuthentication yes</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#PermitRootLogin no</span></span><br><span class=\"line\"><span class=\"comment\">#PasswordAuthentication yes</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Github\"><a href=\"#Github\" class=\"headerlink\" title=\"Github\"></a>Github</h2><p>将公钥直接复制到用户下的SSH中</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T git@github.com</span><br></pre></td></tr></table></figure>\n\n<p>使用这种测试时必须<code>ssh-add</code>，否则它只会查找目录下默认的私钥名，如果自定义了名字则找不到。并且如果使用的是第一种添加私钥的方法也不行，因为此时请求的是git账号。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2xhbmcvcC85NTYzNDk2Lmh0bWw=\">https://www.cnblogs.com/yanglang/p/9563496.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5YWl3bXkvYXJ0aWNsZS9kZXRhaWxzLzU0MzEzMjgz\">https://blog.csdn.net/zyaiwmy/article/details/54313283<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9mZTIxNWM1MmM1MzQ=\">https://www.jianshu.com/p/fe215c52c534<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Linux安装Redis","catagories":["Notebook"],"_content":"\n# Linux版安装流程\n\n1. 获取最新的版本\n\nhttps://redis.io/download\n\n2. 下载，解压，编译\n\n```sh\n$ wget https://download.redis.io/releases/redis-6.0.10.tar.gz\n$ tar xzf redis-6.0.10.tar.gz\n$ cd redis-6.0.10\n$ make\n```\n\n3. 测试\n\n```sh\n$ src/redis-cli\nredis> set foo bar\nOK\nredis> get foo\n\"bar\"\n```\n\n\n\n# 注意\n\n1. Redis 6需要gcc的版本为5.3以上\n\n- 查看gcc版本\n\n```sh\ngcc -v\n```\n\n- 升级\n\n```sh\n#升级到 5.3及以上版本\nyum -y install centos-release-scl\nyum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils\n\nscl enable devtoolset-9 bash\n```\n\nscl命令启用只是临时的，推出xshell或者重启就会恢复到原来的gcc版本。\n如果要长期生效的话，执行如下：\n\n```sh\necho \"source /opt/rh/devtoolset-9/enable\" >>/etc/profile\n```\n\n2. 遇到fatal error\n\n```sh\nmake MALLOC=libc\n```\n\n----\n\nReference\n\nhttps://blog.csdn.net/hello_cmy/article/details/106062327\n\nhttps://blog.csdn.net/libra_ts/article/details/71195128","source":"_posts/linux/linux-redis.md","raw":"---\ntitle: Linux安装Redis\ncatagories: \n- Notebook\ntags: \n- linux\n- redis\n---\n\n# Linux版安装流程\n\n1. 获取最新的版本\n\nhttps://redis.io/download\n\n2. 下载，解压，编译\n\n```sh\n$ wget https://download.redis.io/releases/redis-6.0.10.tar.gz\n$ tar xzf redis-6.0.10.tar.gz\n$ cd redis-6.0.10\n$ make\n```\n\n3. 测试\n\n```sh\n$ src/redis-cli\nredis> set foo bar\nOK\nredis> get foo\n\"bar\"\n```\n\n\n\n# 注意\n\n1. Redis 6需要gcc的版本为5.3以上\n\n- 查看gcc版本\n\n```sh\ngcc -v\n```\n\n- 升级\n\n```sh\n#升级到 5.3及以上版本\nyum -y install centos-release-scl\nyum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils\n\nscl enable devtoolset-9 bash\n```\n\nscl命令启用只是临时的，推出xshell或者重启就会恢复到原来的gcc版本。\n如果要长期生效的话，执行如下：\n\n```sh\necho \"source /opt/rh/devtoolset-9/enable\" >>/etc/profile\n```\n\n2. 遇到fatal error\n\n```sh\nmake MALLOC=libc\n```\n\n----\n\nReference\n\nhttps://blog.csdn.net/hello_cmy/article/details/106062327\n\nhttps://blog.csdn.net/libra_ts/article/details/71195128","slug":"linux/linux-redis","published":1,"date":"2021-01-21T09:29:40.886Z","updated":"2021-01-21T09:41:34.800Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zi005p018o0yuz4bqf","content":"<h1 id=\"Linux版安装流程\"><a href=\"#Linux版安装流程\" class=\"headerlink\" title=\"Linux版安装流程\"></a>Linux版安装流程</h1><ol>\n<li>获取最新的版本</li>\n</ol>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWRpcy5pby9kb3dubG9hZA==\">https://redis.io/download<i class=\"fa fa-external-link-alt\"></i></span></p>\n<ol start=\"2\">\n<li>下载，解压，编译</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ wget https://download.redis.io/releases/redis-6.0.10.tar.gz</span><br><span class=\"line\">$ tar xzf redis-6.0.10.tar.gz</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> redis-6.0.10</span><br><span class=\"line\">$ make</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>测试</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ src/redis-cli</span><br><span class=\"line\">redis&gt; <span class=\"built_in\">set</span> foo bar</span><br><span class=\"line\">OK</span><br><span class=\"line\">redis&gt; get foo</span><br><span class=\"line\"><span class=\"string\">\"bar\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><ol>\n<li>Redis 6需要gcc的版本为5.3以上</li>\n</ol>\n<ul>\n<li>查看gcc版本</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -v</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>升级</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#升级到 5.3及以上版本</span></span><br><span class=\"line\">yum -y install centos-release-scl</span><br><span class=\"line\">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class=\"line\"></span><br><span class=\"line\">scl <span class=\"built_in\">enable</span> devtoolset-9 bash</span><br></pre></td></tr></table></figure>\n\n<p>scl命令启用只是临时的，推出xshell或者重启就会恢复到原来的gcc版本。<br>如果要长期生效的话，执行如下：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"source /opt/rh/devtoolset-9/enable\"</span> &gt;&gt;/etc/profile</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>遇到fatal error</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make MALLOC=libc</span><br></pre></td></tr></table></figure>\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hlbGxvX2NteS9hcnRpY2xlL2RldGFpbHMvMTA2MDYyMzI3\">https://blog.csdn.net/hello_cmy/article/details/106062327<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYnJhX3RzL2FydGljbGUvZGV0YWlscy83MTE5NTEyOA==\">https://blog.csdn.net/libra_ts/article/details/71195128<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Linux版安装流程\"><a href=\"#Linux版安装流程\" class=\"headerlink\" title=\"Linux版安装流程\"></a>Linux版安装流程</h1><ol>\n<li>获取最新的版本</li>\n</ol>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yZWRpcy5pby9kb3dubG9hZA==\">https://redis.io/download<i class=\"fa fa-external-link-alt\"></i></span></p>\n<ol start=\"2\">\n<li>下载，解压，编译</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ wget https://download.redis.io/releases/redis-6.0.10.tar.gz</span><br><span class=\"line\">$ tar xzf redis-6.0.10.tar.gz</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> redis-6.0.10</span><br><span class=\"line\">$ make</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>测试</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ src/redis-cli</span><br><span class=\"line\">redis&gt; <span class=\"built_in\">set</span> foo bar</span><br><span class=\"line\">OK</span><br><span class=\"line\">redis&gt; get foo</span><br><span class=\"line\"><span class=\"string\">\"bar\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><ol>\n<li>Redis 6需要gcc的版本为5.3以上</li>\n</ol>\n<ul>\n<li>查看gcc版本</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -v</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>升级</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#升级到 5.3及以上版本</span></span><br><span class=\"line\">yum -y install centos-release-scl</span><br><span class=\"line\">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class=\"line\"></span><br><span class=\"line\">scl <span class=\"built_in\">enable</span> devtoolset-9 bash</span><br></pre></td></tr></table></figure>\n\n<p>scl命令启用只是临时的，推出xshell或者重启就会恢复到原来的gcc版本。<br>如果要长期生效的话，执行如下：</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"source /opt/rh/devtoolset-9/enable\"</span> &gt;&gt;/etc/profile</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>遇到fatal error</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make MALLOC=libc</span><br></pre></td></tr></table></figure>\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hlbGxvX2NteS9hcnRpY2xlL2RldGFpbHMvMTA2MDYyMzI3\">https://blog.csdn.net/hello_cmy/article/details/106062327<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYnJhX3RzL2FydGljbGUvZGV0YWlscy83MTE5NTEyOA==\">https://blog.csdn.net/libra_ts/article/details/71195128<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"itle":"Linux安装ftp","_content":"\n# 安装步骤\n\n1. yum安装vsftpd\n\n`yum install vsftpd`\n\n2. 设置开机启动\n\n`systemctl enable vsftpd`\n\n3. 启动FTP\n\n`systemctl start vsftpd`\n\n# 配置文件\n\n所在目录\n\n`cd /etc/vsftpd/vsftpd.conf`\n\n常用设置\n\n```\n# 端口号\nlisten_port=21\n# 监听IPv4 sockets\nlisten=YES\n# 这个设置后/etc/passwd内的账号才可以登陆\nlocal_enable=YES\n# 这个设置后list中的用户只能访问自己的/home下的目录\nchroot_local_user=YES\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd/chroot_list\n# 允许匿名登陆\nanonymous_enable=YES\n# 匿名登陆者的根目录\nanon_root=/var/ftp\n# 本地用户登陆后的根目录\nlocal_root=/home\n# 被动模式 开启后相当于服务端开启范围内端口等待客户端来连接\npasv_enable=YES\npasv_min_port=4000\npasv_max_port=4500\n```\n\n**有问题？**\n\n- `local_root=/var/ftp`设置后用户进去还是到对应的`/home`文件夹。\n- `chroot_local_user=YES`设置后用户可以跳出对应的`/home`下的用户文件夹，有安全风险。\n\n**注意**\n\n- 监听sockets后，允许匿名，要开启被动模式用户才可以网站匿名进入。\n\n- `pasv`相关的内容设置后好想要`systemctl restart`。\n\n# 详解\n\n安装\n\nhttps://cloud.tencent.com/document/product/213/10912#user\n\n配置文件解析\n\nhttps://www.cnblogs.com/zhangzhiqin/p/10170201.html","source":"_posts/linux/linux-ftp.md","raw":"---\nitle: Linux安装ftp\ncategories:\n- Notebook\ntags:\n- linux\n- ftp\n---\n\n# 安装步骤\n\n1. yum安装vsftpd\n\n`yum install vsftpd`\n\n2. 设置开机启动\n\n`systemctl enable vsftpd`\n\n3. 启动FTP\n\n`systemctl start vsftpd`\n\n# 配置文件\n\n所在目录\n\n`cd /etc/vsftpd/vsftpd.conf`\n\n常用设置\n\n```\n# 端口号\nlisten_port=21\n# 监听IPv4 sockets\nlisten=YES\n# 这个设置后/etc/passwd内的账号才可以登陆\nlocal_enable=YES\n# 这个设置后list中的用户只能访问自己的/home下的目录\nchroot_local_user=YES\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd/chroot_list\n# 允许匿名登陆\nanonymous_enable=YES\n# 匿名登陆者的根目录\nanon_root=/var/ftp\n# 本地用户登陆后的根目录\nlocal_root=/home\n# 被动模式 开启后相当于服务端开启范围内端口等待客户端来连接\npasv_enable=YES\npasv_min_port=4000\npasv_max_port=4500\n```\n\n**有问题？**\n\n- `local_root=/var/ftp`设置后用户进去还是到对应的`/home`文件夹。\n- `chroot_local_user=YES`设置后用户可以跳出对应的`/home`下的用户文件夹，有安全风险。\n\n**注意**\n\n- 监听sockets后，允许匿名，要开启被动模式用户才可以网站匿名进入。\n\n- `pasv`相关的内容设置后好想要`systemctl restart`。\n\n# 详解\n\n安装\n\nhttps://cloud.tencent.com/document/product/213/10912#user\n\n配置文件解析\n\nhttps://www.cnblogs.com/zhangzhiqin/p/10170201.html","slug":"linux/linux-ftp","published":1,"date":"2021-01-27T05:43:49.735Z","updated":"2021-01-27T07:37:17.952Z","title":"linux/linux-ftp","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zj005t018o4y9m97h1","content":"<h1 id=\"安装步骤\"><a href=\"#安装步骤\" class=\"headerlink\" title=\"安装步骤\"></a>安装步骤</h1><ol>\n<li>yum安装vsftpd</li>\n</ol>\n<p><code>yum install vsftpd</code></p>\n<ol start=\"2\">\n<li>设置开机启动</li>\n</ol>\n<p><code>systemctl enable vsftpd</code></p>\n<ol start=\"3\">\n<li>启动FTP</li>\n</ol>\n<p><code>systemctl start vsftpd</code></p>\n<h1 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h1><p>所在目录</p>\n<p><code>cd /etc/vsftpd/vsftpd.conf</code></p>\n<p>常用设置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 端口号</span><br><span class=\"line\">listen_port&#x3D;21</span><br><span class=\"line\"># 监听IPv4 sockets</span><br><span class=\"line\">listen&#x3D;YES</span><br><span class=\"line\"># 这个设置后&#x2F;etc&#x2F;passwd内的账号才可以登陆</span><br><span class=\"line\">local_enable&#x3D;YES</span><br><span class=\"line\"># 这个设置后list中的用户只能访问自己的&#x2F;home下的目录</span><br><span class=\"line\">chroot_local_user&#x3D;YES</span><br><span class=\"line\">chroot_list_enable&#x3D;YES</span><br><span class=\"line\">chroot_list_file&#x3D;&#x2F;etc&#x2F;vsftpd&#x2F;chroot_list</span><br><span class=\"line\"># 允许匿名登陆</span><br><span class=\"line\">anonymous_enable&#x3D;YES</span><br><span class=\"line\"># 匿名登陆者的根目录</span><br><span class=\"line\">anon_root&#x3D;&#x2F;var&#x2F;ftp</span><br><span class=\"line\"># 本地用户登陆后的根目录</span><br><span class=\"line\">local_root&#x3D;&#x2F;home</span><br><span class=\"line\"># 被动模式 开启后相当于服务端开启范围内端口等待客户端来连接</span><br><span class=\"line\">pasv_enable&#x3D;YES</span><br><span class=\"line\">pasv_min_port&#x3D;4000</span><br><span class=\"line\">pasv_max_port&#x3D;4500</span><br></pre></td></tr></table></figure>\n\n<p><strong>有问题？</strong></p>\n<ul>\n<li><code>local_root=/var/ftp</code>设置后用户进去还是到对应的<code>/home</code>文件夹。</li>\n<li><code>chroot_local_user=YES</code>设置后用户可以跳出对应的<code>/home</code>下的用户文件夹，有安全风险。</li>\n</ul>\n<p><strong>注意</strong></p>\n<ul>\n<li><p>监听sockets后，允许匿名，要开启被动模式用户才可以网站匿名进入。</p>\n</li>\n<li><p><code>pasv</code>相关的内容设置后好想要<code>systemctl restart</code>。</p>\n</li>\n</ul>\n<h1 id=\"详解\"><a href=\"#详解\" class=\"headerlink\" title=\"详解\"></a>详解</h1><p>安装</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzIxMy8xMDkxMiN1c2Vy\">https://cloud.tencent.com/document/product/213/10912#user<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>配置文件解析</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vemhhbmd6aGlxaW4vcC8xMDE3MDIwMS5odG1s\">https://www.cnblogs.com/zhangzhiqin/p/10170201.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"安装步骤\"><a href=\"#安装步骤\" class=\"headerlink\" title=\"安装步骤\"></a>安装步骤</h1><ol>\n<li>yum安装vsftpd</li>\n</ol>\n<p><code>yum install vsftpd</code></p>\n<ol start=\"2\">\n<li>设置开机启动</li>\n</ol>\n<p><code>systemctl enable vsftpd</code></p>\n<ol start=\"3\">\n<li>启动FTP</li>\n</ol>\n<p><code>systemctl start vsftpd</code></p>\n<h1 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h1><p>所在目录</p>\n<p><code>cd /etc/vsftpd/vsftpd.conf</code></p>\n<p>常用设置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 端口号</span><br><span class=\"line\">listen_port&#x3D;21</span><br><span class=\"line\"># 监听IPv4 sockets</span><br><span class=\"line\">listen&#x3D;YES</span><br><span class=\"line\"># 这个设置后&#x2F;etc&#x2F;passwd内的账号才可以登陆</span><br><span class=\"line\">local_enable&#x3D;YES</span><br><span class=\"line\"># 这个设置后list中的用户只能访问自己的&#x2F;home下的目录</span><br><span class=\"line\">chroot_local_user&#x3D;YES</span><br><span class=\"line\">chroot_list_enable&#x3D;YES</span><br><span class=\"line\">chroot_list_file&#x3D;&#x2F;etc&#x2F;vsftpd&#x2F;chroot_list</span><br><span class=\"line\"># 允许匿名登陆</span><br><span class=\"line\">anonymous_enable&#x3D;YES</span><br><span class=\"line\"># 匿名登陆者的根目录</span><br><span class=\"line\">anon_root&#x3D;&#x2F;var&#x2F;ftp</span><br><span class=\"line\"># 本地用户登陆后的根目录</span><br><span class=\"line\">local_root&#x3D;&#x2F;home</span><br><span class=\"line\"># 被动模式 开启后相当于服务端开启范围内端口等待客户端来连接</span><br><span class=\"line\">pasv_enable&#x3D;YES</span><br><span class=\"line\">pasv_min_port&#x3D;4000</span><br><span class=\"line\">pasv_max_port&#x3D;4500</span><br></pre></td></tr></table></figure>\n\n<p><strong>有问题？</strong></p>\n<ul>\n<li><code>local_root=/var/ftp</code>设置后用户进去还是到对应的<code>/home</code>文件夹。</li>\n<li><code>chroot_local_user=YES</code>设置后用户可以跳出对应的<code>/home</code>下的用户文件夹，有安全风险。</li>\n</ul>\n<p><strong>注意</strong></p>\n<ul>\n<li><p>监听sockets后，允许匿名，要开启被动模式用户才可以网站匿名进入。</p>\n</li>\n<li><p><code>pasv</code>相关的内容设置后好想要<code>systemctl restart</code>。</p>\n</li>\n</ul>\n<h1 id=\"详解\"><a href=\"#详解\" class=\"headerlink\" title=\"详解\"></a>详解</h1><p>安装</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzIxMy8xMDkxMiN1c2Vy\">https://cloud.tencent.com/document/product/213/10912#user<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>配置文件解析</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vemhhbmd6aGlxaW4vcC8xMDE3MDIwMS5odG1s\">https://www.cnblogs.com/zhangzhiqin/p/10170201.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# [Linux]创建用户\n\n## linux下创建用户(一）\n\nLinux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。\n\n实现用户账号的管理，要完成的工作主要有如下几个方面：\n· 用户账号的添加、删除与修改。\n· 用户口令的管理。\n· 用户组的管理。\n\n一、Linux系统用户账号的管理\n\n用户账号的管理工作主要涉及到用户账号的添加、修改和删除。  \n添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。  \n刚添加的账号是被锁定的，无法使用。\n\n1、添加新的用户账号使用useradd命令，其语法如下：\n\n代码:  \nuseradd 选项 用户名  \n其中各选项含义如下：  \n\n代码:  \n-c comment 指定一段注释性描述。  \n-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。  \n-g 用户组 指定用户所属的用户组。  \n-G 用户组，用户组 指定用户所属的附加组。  \n-s Shell文件 指定用户的登录Shell。  \n-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。  \n\n用户名 指定新账号的登录名。\n\n例1：  \n代码:  \n`# useradd –d /usr/sam -m sam`  \n此命令创建了一个用户sam，  \n其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）。  \n\n例2：  \n代码:  \n`# useradd -s /bin/sh -g group –G adm,root gem`  \n此命令新建了一个用户gem，该用户的登录Shell是/bin/sh，它属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组。\n\n这里可能新建组：#groupadd group及groupadd adm　  \n增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow, /etc/group等。  \nLinux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。  \n\n2、删除帐号\n\n如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下：\n\n代码:  \nuserdel 选项 用户名\n\n常用的选项是-r，它的作用是把用户的主目录一起删除。  \n例如：\n\n代码:  \n`# userdel sam`  \n\n此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。\n\n3、修改帐号\n\n修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。  \n修改已有用户的信息使用usermod命令，其格式如下：\n\n代码:  \nusermod 选项 用户名  \n\n常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用如下选项：\n\n代码:  \n-l 新用户名  \n\n这个选项指定一个新的账号，即将原来的用户名改为新的用户名。  \n例如：  \n代码:  \n`# usermod -s /bin/ksh -d /home/z –g developer sam`  \n此命令将用户sam的登录Shell修改为ksh，主目录改为/home/z，用户组改为developer。\n\n4、用户口令的管理\n\n用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。  \n指定和修改用户口令的Shell命令是passwd。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：  \n代码:  \n\npasswd 选项 用户名  \n可使用的选项：  \n\n代码:  \n-l 锁定口令，即禁用账号。  \n-u 口令解锁。  \n-d 使账号无口令。  \n-f 强迫用户下次登录时修改口令。  \n如果默认用户名，则修改当前用户的口令。  \n\n例如，假设当前用户是sam，则下面的命令修改该用户自己的口令：\n\n代码:  \n`$ passwd`  \nOld password:******  \nNew password:*******  \nRe-enter new password:*******  \n\n如果是超级用户，可以用下列形式指定任何用户的口令：\n\n代码:  \n`# passwd sam`  \nNew password:*******  \nRe-enter new password:*******  \n\n普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。\n\n为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。\n\n为用户指定空口令时，执行下列形式的命令：\n\n代码:  \n`# passwd -d sam`\n\n\n此命令将用户sam的口令删除，这样用户sam下一次登录时，系统就不再询问口令。  \n\npasswd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：\n\n代码:  \n`# passwd -l sam`\n\n\n## linux下创建用户(二）\n\n二、Linux系统用户组的管理\n\n每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。  \n用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。\n\n1、增加一个新的用户组使用groupadd命令。其格式如下：\n\n代码:  \ngroupadd 选项 用户组  \n\n可以使用的选项有：  \n代码:  \n-g GID 指定新用户组的组标识号（GID）。   \n-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。\n\n例1：\n\n代码:  \n`# groupadd group1`  \n\n此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。\n\n例2：\n\n代码:  \n`# groupadd -g 101 group2`\n\n此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。\n\n2、如果要删除一个已有的用户组，使用groupdel命令，其格式如下：\n\n代码:  \ngroupdel 用户组\n\n例如：\n\n代码:  \n`# groupdel group1`\n\n此命令从系统中删除组group1。\n\n3、修改用户组的属性使用groupmod命令。其语法如下：\n\n代码:  \ngroupmod 选项 用户组\n\n常用的选项有：  \n代码:  \n-g GID 为用户组指定新的组标识号。  \n-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。  \n-n新用户组 将用户组的名字改为新名字\n\n例1：\n\n代码:\n`# groupmod -g 102 group2`\n\n此命令将组group2的组标识号修改为102。\n\n例2：\n\n代码:  \n`# groupmod –g 10000 -n group3 group2`  \n\n此命令将组group2的标识号改为10000，组名修改为group3。\n\n4、如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如：\n\n代码:  \n`$ newgrp root`\n\n这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。\n                                \n让Linux系统中的普通用户也有超级用户的权限\n\n> Reference  \n> https://www.cnblogs.com/ylan2009/articles/2321177.h","source":"_posts/linux/linux-user.md","raw":"# [Linux]创建用户\n\n## linux下创建用户(一）\n\nLinux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。\n\n实现用户账号的管理，要完成的工作主要有如下几个方面：\n· 用户账号的添加、删除与修改。\n· 用户口令的管理。\n· 用户组的管理。\n\n一、Linux系统用户账号的管理\n\n用户账号的管理工作主要涉及到用户账号的添加、修改和删除。  \n添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。  \n刚添加的账号是被锁定的，无法使用。\n\n1、添加新的用户账号使用useradd命令，其语法如下：\n\n代码:  \nuseradd 选项 用户名  \n其中各选项含义如下：  \n\n代码:  \n-c comment 指定一段注释性描述。  \n-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。  \n-g 用户组 指定用户所属的用户组。  \n-G 用户组，用户组 指定用户所属的附加组。  \n-s Shell文件 指定用户的登录Shell。  \n-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。  \n\n用户名 指定新账号的登录名。\n\n例1：  \n代码:  \n`# useradd –d /usr/sam -m sam`  \n此命令创建了一个用户sam，  \n其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）。  \n\n例2：  \n代码:  \n`# useradd -s /bin/sh -g group –G adm,root gem`  \n此命令新建了一个用户gem，该用户的登录Shell是/bin/sh，它属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组。\n\n这里可能新建组：#groupadd group及groupadd adm　  \n增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow, /etc/group等。  \nLinux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。  \n\n2、删除帐号\n\n如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下：\n\n代码:  \nuserdel 选项 用户名\n\n常用的选项是-r，它的作用是把用户的主目录一起删除。  \n例如：\n\n代码:  \n`# userdel sam`  \n\n此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。\n\n3、修改帐号\n\n修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。  \n修改已有用户的信息使用usermod命令，其格式如下：\n\n代码:  \nusermod 选项 用户名  \n\n常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用如下选项：\n\n代码:  \n-l 新用户名  \n\n这个选项指定一个新的账号，即将原来的用户名改为新的用户名。  \n例如：  \n代码:  \n`# usermod -s /bin/ksh -d /home/z –g developer sam`  \n此命令将用户sam的登录Shell修改为ksh，主目录改为/home/z，用户组改为developer。\n\n4、用户口令的管理\n\n用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。  \n指定和修改用户口令的Shell命令是passwd。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：  \n代码:  \n\npasswd 选项 用户名  \n可使用的选项：  \n\n代码:  \n-l 锁定口令，即禁用账号。  \n-u 口令解锁。  \n-d 使账号无口令。  \n-f 强迫用户下次登录时修改口令。  \n如果默认用户名，则修改当前用户的口令。  \n\n例如，假设当前用户是sam，则下面的命令修改该用户自己的口令：\n\n代码:  \n`$ passwd`  \nOld password:******  \nNew password:*******  \nRe-enter new password:*******  \n\n如果是超级用户，可以用下列形式指定任何用户的口令：\n\n代码:  \n`# passwd sam`  \nNew password:*******  \nRe-enter new password:*******  \n\n普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。\n\n为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。\n\n为用户指定空口令时，执行下列形式的命令：\n\n代码:  \n`# passwd -d sam`\n\n\n此命令将用户sam的口令删除，这样用户sam下一次登录时，系统就不再询问口令。  \n\npasswd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：\n\n代码:  \n`# passwd -l sam`\n\n\n## linux下创建用户(二）\n\n二、Linux系统用户组的管理\n\n每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。  \n用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。\n\n1、增加一个新的用户组使用groupadd命令。其格式如下：\n\n代码:  \ngroupadd 选项 用户组  \n\n可以使用的选项有：  \n代码:  \n-g GID 指定新用户组的组标识号（GID）。   \n-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。\n\n例1：\n\n代码:  \n`# groupadd group1`  \n\n此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。\n\n例2：\n\n代码:  \n`# groupadd -g 101 group2`\n\n此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。\n\n2、如果要删除一个已有的用户组，使用groupdel命令，其格式如下：\n\n代码:  \ngroupdel 用户组\n\n例如：\n\n代码:  \n`# groupdel group1`\n\n此命令从系统中删除组group1。\n\n3、修改用户组的属性使用groupmod命令。其语法如下：\n\n代码:  \ngroupmod 选项 用户组\n\n常用的选项有：  \n代码:  \n-g GID 为用户组指定新的组标识号。  \n-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。  \n-n新用户组 将用户组的名字改为新名字\n\n例1：\n\n代码:\n`# groupmod -g 102 group2`\n\n此命令将组group2的组标识号修改为102。\n\n例2：\n\n代码:  \n`# groupmod –g 10000 -n group3 group2`  \n\n此命令将组group2的标识号改为10000，组名修改为group3。\n\n4、如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如：\n\n代码:  \n`$ newgrp root`\n\n这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。\n                                \n让Linux系统中的普通用户也有超级用户的权限\n\n> Reference  \n> https://www.cnblogs.com/ylan2009/articles/2321177.h","slug":"linux/linux-user","published":1,"date":"2020-03-18T12:53:15.929Z","updated":"2020-03-18T12:57:50.275Z","title":"linux/linux-user","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zk005w018o9tdi3g94","content":"<h1 id=\"Linux-创建用户\"><a href=\"#Linux-创建用户\" class=\"headerlink\" title=\"[Linux]创建用户\"></a>[Linux]创建用户</h1><h2 id=\"linux下创建用户-一）\"><a href=\"#linux下创建用户-一）\" class=\"headerlink\" title=\"linux下创建用户(一）\"></a>linux下创建用户(一）</h2><p>Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。</p>\n<p>实现用户账号的管理，要完成的工作主要有如下几个方面：<br>· 用户账号的添加、删除与修改。<br>· 用户口令的管理。<br>· 用户组的管理。</p>\n<p>一、Linux系统用户账号的管理</p>\n<p>用户账号的管理工作主要涉及到用户账号的添加、修改和删除。<br>添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。<br>刚添加的账号是被锁定的，无法使用。</p>\n<p>1、添加新的用户账号使用useradd命令，其语法如下：</p>\n<p>代码:<br>useradd 选项 用户名<br>其中各选项含义如下：  </p>\n<p>代码:<br>-c comment 指定一段注释性描述。<br>-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。<br>-g 用户组 指定用户所属的用户组。<br>-G 用户组，用户组 指定用户所属的附加组。<br>-s Shell文件 指定用户的登录Shell。<br>-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。  </p>\n<p>用户名 指定新账号的登录名。</p>\n<p>例1：<br>代码:<br><code># useradd –d /usr/sam -m sam</code><br>此命令创建了一个用户sam，<br>其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）。  </p>\n<p>例2：<br>代码:<br><code># useradd -s /bin/sh -g group –G adm,root gem</code><br>此命令新建了一个用户gem，该用户的登录Shell是/bin/sh，它属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组。</p>\n<p>这里可能新建组：#groupadd group及groupadd adm　<br>增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow, /etc/group等。<br>Linux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。  </p>\n<p>2、删除帐号</p>\n<p>如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下：</p>\n<p>代码:<br>userdel 选项 用户名</p>\n<p>常用的选项是-r，它的作用是把用户的主目录一起删除。<br>例如：</p>\n<p>代码:<br><code># userdel sam</code>  </p>\n<p>此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。</p>\n<p>3、修改帐号</p>\n<p>修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。<br>修改已有用户的信息使用usermod命令，其格式如下：</p>\n<p>代码:<br>usermod 选项 用户名  </p>\n<p>常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用如下选项：</p>\n<p>代码:<br>-l 新用户名  </p>\n<p>这个选项指定一个新的账号，即将原来的用户名改为新的用户名。<br>例如：<br>代码:<br><code># usermod -s /bin/ksh -d /home/z –g developer sam</code><br>此命令将用户sam的登录Shell修改为ksh，主目录改为/home/z，用户组改为developer。</p>\n<p>4、用户口令的管理</p>\n<p>用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。<br>指定和修改用户口令的Shell命令是passwd。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：<br>代码:  </p>\n<p>passwd 选项 用户名<br>可使用的选项：  </p>\n<p>代码:<br>-l 锁定口令，即禁用账号。<br>-u 口令解锁。<br>-d 使账号无口令。<br>-f 强迫用户下次登录时修改口令。<br>如果默认用户名，则修改当前用户的口令。  </p>\n<p>例如，假设当前用户是sam，则下面的命令修改该用户自己的口令：</p>\n<p>代码:<br><code>$ passwd</code><br>Old password:<strong>**</strong><br>New password:<strong>***</strong><br>Re-enter new password:<strong>***</strong>  </p>\n<p>如果是超级用户，可以用下列形式指定任何用户的口令：</p>\n<p>代码:<br><code># passwd sam</code><br>New password:<strong>***</strong><br>Re-enter new password:<strong>***</strong>  </p>\n<p>普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。</p>\n<p>为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。</p>\n<p>为用户指定空口令时，执行下列形式的命令：</p>\n<p>代码:<br><code># passwd -d sam</code></p>\n<p>此命令将用户sam的口令删除，这样用户sam下一次登录时，系统就不再询问口令。  </p>\n<p>passwd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：</p>\n<p>代码:<br><code># passwd -l sam</code></p>\n<h2 id=\"linux下创建用户-二）\"><a href=\"#linux下创建用户-二）\" class=\"headerlink\" title=\"linux下创建用户(二）\"></a>linux下创建用户(二）</h2><p>二、Linux系统用户组的管理</p>\n<p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。<br>用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。</p>\n<p>1、增加一个新的用户组使用groupadd命令。其格式如下：</p>\n<p>代码:<br>groupadd 选项 用户组  </p>\n<p>可以使用的选项有：<br>代码:<br>-g GID 指定新用户组的组标识号（GID）。<br>-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。</p>\n<p>例1：</p>\n<p>代码:<br><code># groupadd group1</code>  </p>\n<p>此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。</p>\n<p>例2：</p>\n<p>代码:<br><code># groupadd -g 101 group2</code></p>\n<p>此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。</p>\n<p>2、如果要删除一个已有的用户组，使用groupdel命令，其格式如下：</p>\n<p>代码:<br>groupdel 用户组</p>\n<p>例如：</p>\n<p>代码:<br><code># groupdel group1</code></p>\n<p>此命令从系统中删除组group1。</p>\n<p>3、修改用户组的属性使用groupmod命令。其语法如下：</p>\n<p>代码:<br>groupmod 选项 用户组</p>\n<p>常用的选项有：<br>代码:<br>-g GID 为用户组指定新的组标识号。<br>-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。<br>-n新用户组 将用户组的名字改为新名字</p>\n<p>例1：</p>\n<p>代码:<br><code># groupmod -g 102 group2</code></p>\n<p>此命令将组group2的组标识号修改为102。</p>\n<p>例2：</p>\n<p>代码:<br><code># groupmod –g 10000 -n group3 group2</code>  </p>\n<p>此命令将组group2的标识号改为10000，组名修改为group3。</p>\n<p>4、如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如：</p>\n<p>代码:<br><code>$ newgrp root</code></p>\n<p>这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。</p>\n<p>让Linux系统中的普通用户也有超级用户的权限</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWxhbjIwMDkvYXJ0aWNsZXMvMjMyMTE3Ny5o\">https://www.cnblogs.com/ylan2009/articles/2321177.h<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Linux-创建用户\"><a href=\"#Linux-创建用户\" class=\"headerlink\" title=\"[Linux]创建用户\"></a>[Linux]创建用户</h1><h2 id=\"linux下创建用户-一）\"><a href=\"#linux下创建用户-一）\" class=\"headerlink\" title=\"linux下创建用户(一）\"></a>linux下创建用户(一）</h2><p>Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。</p>\n<p>实现用户账号的管理，要完成的工作主要有如下几个方面：<br>· 用户账号的添加、删除与修改。<br>· 用户口令的管理。<br>· 用户组的管理。</p>\n<p>一、Linux系统用户账号的管理</p>\n<p>用户账号的管理工作主要涉及到用户账号的添加、修改和删除。<br>添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。<br>刚添加的账号是被锁定的，无法使用。</p>\n<p>1、添加新的用户账号使用useradd命令，其语法如下：</p>\n<p>代码:<br>useradd 选项 用户名<br>其中各选项含义如下：  </p>\n<p>代码:<br>-c comment 指定一段注释性描述。<br>-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。<br>-g 用户组 指定用户所属的用户组。<br>-G 用户组，用户组 指定用户所属的附加组。<br>-s Shell文件 指定用户的登录Shell。<br>-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。  </p>\n<p>用户名 指定新账号的登录名。</p>\n<p>例1：<br>代码:<br><code># useradd –d /usr/sam -m sam</code><br>此命令创建了一个用户sam，<br>其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）。  </p>\n<p>例2：<br>代码:<br><code># useradd -s /bin/sh -g group –G adm,root gem</code><br>此命令新建了一个用户gem，该用户的登录Shell是/bin/sh，它属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组。</p>\n<p>这里可能新建组：#groupadd group及groupadd adm　<br>增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow, /etc/group等。<br>Linux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。  </p>\n<p>2、删除帐号</p>\n<p>如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下：</p>\n<p>代码:<br>userdel 选项 用户名</p>\n<p>常用的选项是-r，它的作用是把用户的主目录一起删除。<br>例如：</p>\n<p>代码:<br><code># userdel sam</code>  </p>\n<p>此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。</p>\n<p>3、修改帐号</p>\n<p>修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。<br>修改已有用户的信息使用usermod命令，其格式如下：</p>\n<p>代码:<br>usermod 选项 用户名  </p>\n<p>常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用如下选项：</p>\n<p>代码:<br>-l 新用户名  </p>\n<p>这个选项指定一个新的账号，即将原来的用户名改为新的用户名。<br>例如：<br>代码:<br><code># usermod -s /bin/ksh -d /home/z –g developer sam</code><br>此命令将用户sam的登录Shell修改为ksh，主目录改为/home/z，用户组改为developer。</p>\n<p>4、用户口令的管理</p>\n<p>用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。<br>指定和修改用户口令的Shell命令是passwd。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：<br>代码:  </p>\n<p>passwd 选项 用户名<br>可使用的选项：  </p>\n<p>代码:<br>-l 锁定口令，即禁用账号。<br>-u 口令解锁。<br>-d 使账号无口令。<br>-f 强迫用户下次登录时修改口令。<br>如果默认用户名，则修改当前用户的口令。  </p>\n<p>例如，假设当前用户是sam，则下面的命令修改该用户自己的口令：</p>\n<p>代码:<br><code>$ passwd</code><br>Old password:<strong>**</strong><br>New password:<strong>***</strong><br>Re-enter new password:<strong>***</strong>  </p>\n<p>如果是超级用户，可以用下列形式指定任何用户的口令：</p>\n<p>代码:<br><code># passwd sam</code><br>New password:<strong>***</strong><br>Re-enter new password:<strong>***</strong>  </p>\n<p>普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。</p>\n<p>为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。</p>\n<p>为用户指定空口令时，执行下列形式的命令：</p>\n<p>代码:<br><code># passwd -d sam</code></p>\n<p>此命令将用户sam的口令删除，这样用户sam下一次登录时，系统就不再询问口令。  </p>\n<p>passwd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：</p>\n<p>代码:<br><code># passwd -l sam</code></p>\n<h2 id=\"linux下创建用户-二）\"><a href=\"#linux下创建用户-二）\" class=\"headerlink\" title=\"linux下创建用户(二）\"></a>linux下创建用户(二）</h2><p>二、Linux系统用户组的管理</p>\n<p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。<br>用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。</p>\n<p>1、增加一个新的用户组使用groupadd命令。其格式如下：</p>\n<p>代码:<br>groupadd 选项 用户组  </p>\n<p>可以使用的选项有：<br>代码:<br>-g GID 指定新用户组的组标识号（GID）。<br>-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。</p>\n<p>例1：</p>\n<p>代码:<br><code># groupadd group1</code>  </p>\n<p>此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。</p>\n<p>例2：</p>\n<p>代码:<br><code># groupadd -g 101 group2</code></p>\n<p>此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。</p>\n<p>2、如果要删除一个已有的用户组，使用groupdel命令，其格式如下：</p>\n<p>代码:<br>groupdel 用户组</p>\n<p>例如：</p>\n<p>代码:<br><code># groupdel group1</code></p>\n<p>此命令从系统中删除组group1。</p>\n<p>3、修改用户组的属性使用groupmod命令。其语法如下：</p>\n<p>代码:<br>groupmod 选项 用户组</p>\n<p>常用的选项有：<br>代码:<br>-g GID 为用户组指定新的组标识号。<br>-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。<br>-n新用户组 将用户组的名字改为新名字</p>\n<p>例1：</p>\n<p>代码:<br><code># groupmod -g 102 group2</code></p>\n<p>此命令将组group2的组标识号修改为102。</p>\n<p>例2：</p>\n<p>代码:<br><code># groupmod –g 10000 -n group3 group2</code>  </p>\n<p>此命令将组group2的标识号改为10000，组名修改为group3。</p>\n<p>4、如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如：</p>\n<p>代码:<br><code>$ newgrp root</code></p>\n<p>这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。</p>\n<p>让Linux系统中的普通用户也有超级用户的权限</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWxhbjIwMDkvYXJ0aWNsZXMvMjMyMTE3Ny5o\">https://www.cnblogs.com/ylan2009/articles/2321177.h<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"title":"Pass","catagories":["Magic"],"_content":"\n# Pass\n\n对中间选中的牌进行移动。\n\n右手控制的牌堆不同。\n\n# 古典移牌\n\n将下方的牌拉到上面。\n\n以此衍生出很多不同的Pass，本质就是利用动作掩饰Pass的过程。\n\n## 注意\n\n- 右手的提牌发力，才能看起来非常快\n\n- 右手的遮挡\n\n# 海曼移牌\n\n控制上方的牌堆，把下面的牌堆压上来。\n\n# Half Pass\n\n下方的牌堆在上方的牌堆遮挡下，完成翻转。\n\n# Egle Change\n\n- 双翻\n- 最上面的牌抽到最下面（大拇指中指控制整幅牌，无名指抽起第一张牌）\n- 右手遮挡\n\n# 思考\n\n做动作的时候，漏出来的手的部分动作越小越好。\n\n在遮挡下的动作达到一定熟练度后，一定是以最小的动作幅度完成所有操作。","source":"_posts/magic/pass.md","raw":"---\ntitle: Pass\ncatagories:\n- Magic\ntags:\n- cards\n- pass\n---\n\n# Pass\n\n对中间选中的牌进行移动。\n\n右手控制的牌堆不同。\n\n# 古典移牌\n\n将下方的牌拉到上面。\n\n以此衍生出很多不同的Pass，本质就是利用动作掩饰Pass的过程。\n\n## 注意\n\n- 右手的提牌发力，才能看起来非常快\n\n- 右手的遮挡\n\n# 海曼移牌\n\n控制上方的牌堆，把下面的牌堆压上来。\n\n# Half Pass\n\n下方的牌堆在上方的牌堆遮挡下，完成翻转。\n\n# Egle Change\n\n- 双翻\n- 最上面的牌抽到最下面（大拇指中指控制整幅牌，无名指抽起第一张牌）\n- 右手遮挡\n\n# 思考\n\n做动作的时候，漏出来的手的部分动作越小越好。\n\n在遮挡下的动作达到一定熟练度后，一定是以最小的动作幅度完成所有操作。","slug":"magic/pass","published":1,"date":"2021-04-01T11:01:48.138Z","updated":"2021-04-02T02:48:28.434Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zl005y018o8vto41z3","content":"<h1 id=\"Pass\"><a href=\"#Pass\" class=\"headerlink\" title=\"Pass\"></a>Pass</h1><p>对中间选中的牌进行移动。</p>\n<p>右手控制的牌堆不同。</p>\n<h1 id=\"古典移牌\"><a href=\"#古典移牌\" class=\"headerlink\" title=\"古典移牌\"></a>古典移牌</h1><p>将下方的牌拉到上面。</p>\n<p>以此衍生出很多不同的Pass，本质就是利用动作掩饰Pass的过程。</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><ul>\n<li><p>右手的提牌发力，才能看起来非常快</p>\n</li>\n<li><p>右手的遮挡</p>\n</li>\n</ul>\n<h1 id=\"海曼移牌\"><a href=\"#海曼移牌\" class=\"headerlink\" title=\"海曼移牌\"></a>海曼移牌</h1><p>控制上方的牌堆，把下面的牌堆压上来。</p>\n<h1 id=\"Half-Pass\"><a href=\"#Half-Pass\" class=\"headerlink\" title=\"Half Pass\"></a>Half Pass</h1><p>下方的牌堆在上方的牌堆遮挡下，完成翻转。</p>\n<h1 id=\"Egle-Change\"><a href=\"#Egle-Change\" class=\"headerlink\" title=\"Egle Change\"></a>Egle Change</h1><ul>\n<li>双翻</li>\n<li>最上面的牌抽到最下面（大拇指中指控制整幅牌，无名指抽起第一张牌）</li>\n<li>右手遮挡</li>\n</ul>\n<h1 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h1><p>做动作的时候，漏出来的手的部分动作越小越好。</p>\n<p>在遮挡下的动作达到一定熟练度后，一定是以最小的动作幅度完成所有操作。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Pass\"><a href=\"#Pass\" class=\"headerlink\" title=\"Pass\"></a>Pass</h1><p>对中间选中的牌进行移动。</p>\n<p>右手控制的牌堆不同。</p>\n<h1 id=\"古典移牌\"><a href=\"#古典移牌\" class=\"headerlink\" title=\"古典移牌\"></a>古典移牌</h1><p>将下方的牌拉到上面。</p>\n<p>以此衍生出很多不同的Pass，本质就是利用动作掩饰Pass的过程。</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><ul>\n<li><p>右手的提牌发力，才能看起来非常快</p>\n</li>\n<li><p>右手的遮挡</p>\n</li>\n</ul>\n<h1 id=\"海曼移牌\"><a href=\"#海曼移牌\" class=\"headerlink\" title=\"海曼移牌\"></a>海曼移牌</h1><p>控制上方的牌堆，把下面的牌堆压上来。</p>\n<h1 id=\"Half-Pass\"><a href=\"#Half-Pass\" class=\"headerlink\" title=\"Half Pass\"></a>Half Pass</h1><p>下方的牌堆在上方的牌堆遮挡下，完成翻转。</p>\n<h1 id=\"Egle-Change\"><a href=\"#Egle-Change\" class=\"headerlink\" title=\"Egle Change\"></a>Egle Change</h1><ul>\n<li>双翻</li>\n<li>最上面的牌抽到最下面（大拇指中指控制整幅牌，无名指抽起第一张牌）</li>\n<li>右手遮挡</li>\n</ul>\n<h1 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h1><p>做动作的时候，漏出来的手的部分动作越小越好。</p>\n<p>在遮挡下的动作达到一定熟练度后，一定是以最小的动作幅度完成所有操作。</p>\n"},{"title":"Matlab add environment path","_content":"\n# Home\n\nSet path through home menu 'Set path'.\n\n# addpath\n\n```matlab\naddpath 'xxx'\n```\n\n# path()\n\n```matlab\npath(path, 'xxx')\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.douban.com/note/703113456/","source":"_posts/matlab/path.md","raw":"---\ntitle: Matlab add environment path\ncategories:\n- Matlab\n---\n\n# Home\n\nSet path through home menu 'Set path'.\n\n# addpath\n\n```matlab\naddpath 'xxx'\n```\n\n# path()\n\n```matlab\npath(path, 'xxx')\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.douban.com/note/703113456/","slug":"matlab/path","published":1,"date":"2021-08-26T16:18:59.612Z","updated":"2021-08-26T16:22:31.194Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zm0060018o61dkgm6j","content":"<h1 id=\"Home\"><a href=\"#Home\" class=\"headerlink\" title=\"Home\"></a>Home</h1><p>Set path through home menu ‘Set path’.</p>\n<h1 id=\"addpath\"><a href=\"#addpath\" class=\"headerlink\" title=\"addpath\"></a>addpath</h1><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">addpath <span class=\"string\">'xxx'</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"path\"><a href=\"#path\" class=\"headerlink\" title=\"path()\"></a>path()</h1><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">path(path, <span class=\"string\">'xxx'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZG91YmFuLmNvbS9ub3RlLzcwMzExMzQ1Ni8=\">https://www.douban.com/note/703113456/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Home\"><a href=\"#Home\" class=\"headerlink\" title=\"Home\"></a>Home</h1><p>Set path through home menu ‘Set path’.</p>\n<h1 id=\"addpath\"><a href=\"#addpath\" class=\"headerlink\" title=\"addpath\"></a>addpath</h1><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">addpath <span class=\"string\">'xxx'</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"path\"><a href=\"#path\" class=\"headerlink\" title=\"path()\"></a>path()</h1><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">path(path, <span class=\"string\">'xxx'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZG91YmFuLmNvbS9ub3RlLzcwMzExMzQ1Ni8=\">https://www.douban.com/note/703113456/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 手动实现KNN\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n```\n\n\n```python\nraw_data_x = [[3.393533211, 2.331273381],\n              [3.110073483, 1.781539638],\n              [1.343808831, 3.368360954],\n              [3.582294042, 4.679179110],\n              [2.280362439, 2.866990263],\n              [7.423436942, 4.696522875],\n              [5.745051997, 3.533989803],\n              [9.172168622, 2.511101045],\n              [7.792783481, 3.424088941],\n              [7.939820817, 0.791637231]\n             ]\nraw_data_y = [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]\n```\n\n\n```python\nx_train = np.array(raw_data_x)\ny_train = np.array(raw_data_y)\n```\n\n\n```python\nx_train\n```\n\n\n\n\n    array([[3.39353321, 2.33127338],\n           [3.11007348, 1.78153964],\n           [1.34380883, 3.36836095],\n           [3.58229404, 4.67917911],\n           [2.28036244, 2.86699026],\n           [7.42343694, 4.69652288],\n           [5.745052  , 3.5339898 ],\n           [9.17216862, 2.51110105],\n           [7.79278348, 3.42408894],\n           [7.93982082, 0.79163723]])\n\n\n\n\n```python\ny_train==1\n```\n\n\n\n\n    array([False, False, False, False, False,  True,  True,  True,  True,\n            True])\n\n\n\n\n```python\nplt.scatter(x_train[y_train==1, 0], x_train[y_train==1, 1], color='r', label='1')\nplt.scatter(x_train[y_train==0, 0], x_train[y_train==0, 1], color='g', label='0')\nplt.legend()\n```\n\n\n\n\n    <matplotlib.legend.Legend at 0x122311ad0>\n\n\n\n\n![png](data/output_6_1.png)\n\n\n\n```python\nx = np.array([8.093607318, 3.365731514])\n\nplt.scatter(x_train[y_train==1, 0], x_train[y_train==1, 1], color='r', label='1')\nplt.scatter(x_train[y_train==0, 0], x_train[y_train==0, 1], color='g', label='0')\nplt.scatter(x[0], x[1], color='b')\nplt.legend()\nplt.show()\n```\n\n\n![png](data/output_7_0.png)\n\n\n\n```python\nimport math\ndistance = []\n```\n\n\n```python\nfor each in x_train:\n    d = math.sqrt(np.sum((each - x) ** 2))\n    distance.append(d)\n```\n\n\n```python\ndistance\n```\n\n\n\n\n    [4.812566907609877,\n     5.229270827235305,\n     6.749798999160064,\n     4.6986266144110695,\n     5.83460014556857,\n     1.4900114024329525,\n     2.354574897431513,\n     1.3761132675144652,\n     0.3064319992975,\n     2.5786840957478887]\n\n\n\n\n```python\ndistances = [math.sqrt(np.sum((each - x) ** 2)) for each in x_train]\ndistances\n```\n\n\n\n\n    [4.812566907609877,\n     5.229270827235305,\n     6.749798999160064,\n     4.6986266144110695,\n     5.83460014556857,\n     1.4900114024329525,\n     2.354574897431513,\n     1.3761132675144652,\n     0.3064319992975,\n     2.5786840957478887]\n\n\n\n\n```python\nnearest = np.argsort(distances)\nnearest\n```\n\n\n\n\n    array([8, 7, 5, 6, 9, 3, 0, 1, 4, 2])\n\n\n\n\n```python\nk = 6\ntopK_y = [y_train[i] for i in nearest[:k]]\ntopK_y\n```\n\n\n\n\n    [1, 1, 1, 1, 1, 0]\n\n\n\n\n```python\nimport collections\nvotes = collections.Counter(topK_y)\nvotes\n```\n\n\n\n\n    Counter({1: 5, 0: 1})\n\n\n\n\n```python\nvotes.most_common(1)\n```\n\n\n\n\n    [(1, 5)]\n\n\n\n\n```python\npredict_y = votes.most_common(1)[0][0]\npredict_y\n```\n\n\n\n\n    1\n\n\n\n# scikit-learn实现KNN\n\n\n```python\nimport numpy as np\nfrom sklearn.neighbors import KNeighborsClassifier\n```\n\n\n```python\nraw_data_x = [[3.393533211, 2.331273381],\n              [3.110073483, 1.781539638],\n              [1.343808831, 3.368360954],\n              [3.582294042, 4.679179110],\n              [2.280362439, 2.866990263],\n              [7.423436942, 4.696522875],\n              [5.745051997, 3.533989803],\n              [9.172168622, 2.511101045],\n              [7.792783481, 3.424088941],\n              [7.939820817, 0.791637231]\n             ]\nraw_data_y = [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]\n\nx_train = np.array(raw_data_x)\ny_train = np.array(raw_data_y)\n\ntarget = np.array([8.093607318, 3.365731514])\n```\n\n\n```python\nKNN_classifier = KNeighborsClassifier(n_neighbors=6)\n```\n\n\n```python\nKNN_classifier.fit(x_train, y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=6, p=2,\n                         weights='uniform')\n\n\n\n\n```python\ntarget = x.reshape(1, -1)\nprint(target)\n```\n\n    [[8.09360732 3.36573151]]\n\n\n\n```python\nKNN_classifier.predict(target)\n```\n\n\n\n\n    array([1])\n\n\n\n\n```python\nres = KNN_classifier.predict(target)\nres[0]\n```\n\n\n\n\n    1\n\n\n","source":"_posts/mlsec/KNN-手动实现.md","raw":"# 手动实现KNN\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n```\n\n\n```python\nraw_data_x = [[3.393533211, 2.331273381],\n              [3.110073483, 1.781539638],\n              [1.343808831, 3.368360954],\n              [3.582294042, 4.679179110],\n              [2.280362439, 2.866990263],\n              [7.423436942, 4.696522875],\n              [5.745051997, 3.533989803],\n              [9.172168622, 2.511101045],\n              [7.792783481, 3.424088941],\n              [7.939820817, 0.791637231]\n             ]\nraw_data_y = [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]\n```\n\n\n```python\nx_train = np.array(raw_data_x)\ny_train = np.array(raw_data_y)\n```\n\n\n```python\nx_train\n```\n\n\n\n\n    array([[3.39353321, 2.33127338],\n           [3.11007348, 1.78153964],\n           [1.34380883, 3.36836095],\n           [3.58229404, 4.67917911],\n           [2.28036244, 2.86699026],\n           [7.42343694, 4.69652288],\n           [5.745052  , 3.5339898 ],\n           [9.17216862, 2.51110105],\n           [7.79278348, 3.42408894],\n           [7.93982082, 0.79163723]])\n\n\n\n\n```python\ny_train==1\n```\n\n\n\n\n    array([False, False, False, False, False,  True,  True,  True,  True,\n            True])\n\n\n\n\n```python\nplt.scatter(x_train[y_train==1, 0], x_train[y_train==1, 1], color='r', label='1')\nplt.scatter(x_train[y_train==0, 0], x_train[y_train==0, 1], color='g', label='0')\nplt.legend()\n```\n\n\n\n\n    <matplotlib.legend.Legend at 0x122311ad0>\n\n\n\n\n![png](data/output_6_1.png)\n\n\n\n```python\nx = np.array([8.093607318, 3.365731514])\n\nplt.scatter(x_train[y_train==1, 0], x_train[y_train==1, 1], color='r', label='1')\nplt.scatter(x_train[y_train==0, 0], x_train[y_train==0, 1], color='g', label='0')\nplt.scatter(x[0], x[1], color='b')\nplt.legend()\nplt.show()\n```\n\n\n![png](data/output_7_0.png)\n\n\n\n```python\nimport math\ndistance = []\n```\n\n\n```python\nfor each in x_train:\n    d = math.sqrt(np.sum((each - x) ** 2))\n    distance.append(d)\n```\n\n\n```python\ndistance\n```\n\n\n\n\n    [4.812566907609877,\n     5.229270827235305,\n     6.749798999160064,\n     4.6986266144110695,\n     5.83460014556857,\n     1.4900114024329525,\n     2.354574897431513,\n     1.3761132675144652,\n     0.3064319992975,\n     2.5786840957478887]\n\n\n\n\n```python\ndistances = [math.sqrt(np.sum((each - x) ** 2)) for each in x_train]\ndistances\n```\n\n\n\n\n    [4.812566907609877,\n     5.229270827235305,\n     6.749798999160064,\n     4.6986266144110695,\n     5.83460014556857,\n     1.4900114024329525,\n     2.354574897431513,\n     1.3761132675144652,\n     0.3064319992975,\n     2.5786840957478887]\n\n\n\n\n```python\nnearest = np.argsort(distances)\nnearest\n```\n\n\n\n\n    array([8, 7, 5, 6, 9, 3, 0, 1, 4, 2])\n\n\n\n\n```python\nk = 6\ntopK_y = [y_train[i] for i in nearest[:k]]\ntopK_y\n```\n\n\n\n\n    [1, 1, 1, 1, 1, 0]\n\n\n\n\n```python\nimport collections\nvotes = collections.Counter(topK_y)\nvotes\n```\n\n\n\n\n    Counter({1: 5, 0: 1})\n\n\n\n\n```python\nvotes.most_common(1)\n```\n\n\n\n\n    [(1, 5)]\n\n\n\n\n```python\npredict_y = votes.most_common(1)[0][0]\npredict_y\n```\n\n\n\n\n    1\n\n\n\n# scikit-learn实现KNN\n\n\n```python\nimport numpy as np\nfrom sklearn.neighbors import KNeighborsClassifier\n```\n\n\n```python\nraw_data_x = [[3.393533211, 2.331273381],\n              [3.110073483, 1.781539638],\n              [1.343808831, 3.368360954],\n              [3.582294042, 4.679179110],\n              [2.280362439, 2.866990263],\n              [7.423436942, 4.696522875],\n              [5.745051997, 3.533989803],\n              [9.172168622, 2.511101045],\n              [7.792783481, 3.424088941],\n              [7.939820817, 0.791637231]\n             ]\nraw_data_y = [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]\n\nx_train = np.array(raw_data_x)\ny_train = np.array(raw_data_y)\n\ntarget = np.array([8.093607318, 3.365731514])\n```\n\n\n```python\nKNN_classifier = KNeighborsClassifier(n_neighbors=6)\n```\n\n\n```python\nKNN_classifier.fit(x_train, y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=6, p=2,\n                         weights='uniform')\n\n\n\n\n```python\ntarget = x.reshape(1, -1)\nprint(target)\n```\n\n    [[8.09360732 3.36573151]]\n\n\n\n```python\nKNN_classifier.predict(target)\n```\n\n\n\n\n    array([1])\n\n\n\n\n```python\nres = KNN_classifier.predict(target)\nres[0]\n```\n\n\n\n\n    1\n\n\n","slug":"mlsec/KNN-手动实现","published":1,"date":"2020-05-17T08:34:34.000Z","updated":"2020-05-17T08:36:05.677Z","title":"mlsec/KNN-手动实现","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zo0064018oa27rbelv","content":"<h1 id=\"手动实现KNN\"><a href=\"#手动实现KNN\" class=\"headerlink\" title=\"手动实现KNN\"></a>手动实现KNN</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">raw_data_x = [[<span class=\"number\">3.393533211</span>, <span class=\"number\">2.331273381</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.110073483</span>, <span class=\"number\">1.781539638</span>],</span><br><span class=\"line\">              [<span class=\"number\">1.343808831</span>, <span class=\"number\">3.368360954</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.582294042</span>, <span class=\"number\">4.679179110</span>],</span><br><span class=\"line\">              [<span class=\"number\">2.280362439</span>, <span class=\"number\">2.866990263</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.423436942</span>, <span class=\"number\">4.696522875</span>],</span><br><span class=\"line\">              [<span class=\"number\">5.745051997</span>, <span class=\"number\">3.533989803</span>],</span><br><span class=\"line\">              [<span class=\"number\">9.172168622</span>, <span class=\"number\">2.511101045</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.792783481</span>, <span class=\"number\">3.424088941</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.939820817</span>, <span class=\"number\">0.791637231</span>]</span><br><span class=\"line\">             ]</span><br><span class=\"line\">raw_data_y = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x_train = np.array(raw_data_x)</span><br><span class=\"line\">y_train = np.array(raw_data_y)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x_train</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[3.39353321, 2.33127338],\n       [3.11007348, 1.78153964],\n       [1.34380883, 3.36836095],\n       [3.58229404, 4.67917911],\n       [2.28036244, 2.86699026],\n       [7.42343694, 4.69652288],\n       [5.745052  , 3.5339898 ],\n       [9.17216862, 2.51110105],\n       [7.79278348, 3.42408894],\n       [7.93982082, 0.79163723]])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_train==<span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([False, False, False, False, False,  True,  True,  True,  True,\n        True])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'r'</span>, label=<span class=\"string\">'1'</span>)</span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'g'</span>, label=<span class=\"string\">'0'</span>)</span><br><span class=\"line\">plt.legend()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.legend.Legend at 0x122311ad0&gt;</code></pre><p><img src=\"data/output_6_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = np.array([<span class=\"number\">8.093607318</span>, <span class=\"number\">3.365731514</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'r'</span>, label=<span class=\"string\">'1'</span>)</span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'g'</span>, label=<span class=\"string\">'0'</span>)</span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], color=<span class=\"string\">'b'</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n<p><img src=\"data/output_7_0.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\">distance = []</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> each <span class=\"keyword\">in</span> x_train:</span><br><span class=\"line\">    d = math.sqrt(np.sum((each - x) ** <span class=\"number\">2</span>))</span><br><span class=\"line\">    distance.append(d)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">distance</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[4.812566907609877,\n 5.229270827235305,\n 6.749798999160064,\n 4.6986266144110695,\n 5.83460014556857,\n 1.4900114024329525,\n 2.354574897431513,\n 1.3761132675144652,\n 0.3064319992975,\n 2.5786840957478887]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">distances = [math.sqrt(np.sum((each - x) ** <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> each <span class=\"keyword\">in</span> x_train]</span><br><span class=\"line\">distances</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[4.812566907609877,\n 5.229270827235305,\n 6.749798999160064,\n 4.6986266144110695,\n 5.83460014556857,\n 1.4900114024329525,\n 2.354574897431513,\n 1.3761132675144652,\n 0.3064319992975,\n 2.5786840957478887]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nearest = np.argsort(distances)</span><br><span class=\"line\">nearest</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([8, 7, 5, 6, 9, 3, 0, 1, 4, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">k = <span class=\"number\">6</span></span><br><span class=\"line\">topK_y = [y_train[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> nearest[:k]]</span><br><span class=\"line\">topK_y</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[1, 1, 1, 1, 1, 0]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> collections</span><br><span class=\"line\">votes = collections.Counter(topK_y)</span><br><span class=\"line\">votes</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Counter({1: 5, 0: 1})</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">votes.most_common(<span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[(1, 5)]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">predict_y = votes.most_common(<span class=\"number\">1</span>)[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\">predict_y</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>1</code></pre><h1 id=\"scikit-learn实现KNN\"><a href=\"#scikit-learn实现KNN\" class=\"headerlink\" title=\"scikit-learn实现KNN\"></a>scikit-learn实现KNN</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">raw_data_x = [[<span class=\"number\">3.393533211</span>, <span class=\"number\">2.331273381</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.110073483</span>, <span class=\"number\">1.781539638</span>],</span><br><span class=\"line\">              [<span class=\"number\">1.343808831</span>, <span class=\"number\">3.368360954</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.582294042</span>, <span class=\"number\">4.679179110</span>],</span><br><span class=\"line\">              [<span class=\"number\">2.280362439</span>, <span class=\"number\">2.866990263</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.423436942</span>, <span class=\"number\">4.696522875</span>],</span><br><span class=\"line\">              [<span class=\"number\">5.745051997</span>, <span class=\"number\">3.533989803</span>],</span><br><span class=\"line\">              [<span class=\"number\">9.172168622</span>, <span class=\"number\">2.511101045</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.792783481</span>, <span class=\"number\">3.424088941</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.939820817</span>, <span class=\"number\">0.791637231</span>]</span><br><span class=\"line\">             ]</span><br><span class=\"line\">raw_data_y = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">x_train = np.array(raw_data_x)</span><br><span class=\"line\">y_train = np.array(raw_data_y)</span><br><span class=\"line\"></span><br><span class=\"line\">target = np.array([<span class=\"number\">8.093607318</span>, <span class=\"number\">3.365731514</span>])</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier = KNeighborsClassifier(n_neighbors=<span class=\"number\">6</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier.fit(x_train, y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=6, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">target = x.reshape(<span class=\"number\">1</span>, <span class=\"number\">-1</span>)</span><br><span class=\"line\">print(target)</span><br></pre></td></tr></table></figure>\n\n<pre><code>[[8.09360732 3.36573151]]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier.predict(target)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([1])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNN_classifier.predict(target)</span><br><span class=\"line\">res[<span class=\"number\">0</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>1</code></pre>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"手动实现KNN\"><a href=\"#手动实现KNN\" class=\"headerlink\" title=\"手动实现KNN\"></a>手动实现KNN</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">raw_data_x = [[<span class=\"number\">3.393533211</span>, <span class=\"number\">2.331273381</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.110073483</span>, <span class=\"number\">1.781539638</span>],</span><br><span class=\"line\">              [<span class=\"number\">1.343808831</span>, <span class=\"number\">3.368360954</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.582294042</span>, <span class=\"number\">4.679179110</span>],</span><br><span class=\"line\">              [<span class=\"number\">2.280362439</span>, <span class=\"number\">2.866990263</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.423436942</span>, <span class=\"number\">4.696522875</span>],</span><br><span class=\"line\">              [<span class=\"number\">5.745051997</span>, <span class=\"number\">3.533989803</span>],</span><br><span class=\"line\">              [<span class=\"number\">9.172168622</span>, <span class=\"number\">2.511101045</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.792783481</span>, <span class=\"number\">3.424088941</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.939820817</span>, <span class=\"number\">0.791637231</span>]</span><br><span class=\"line\">             ]</span><br><span class=\"line\">raw_data_y = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x_train = np.array(raw_data_x)</span><br><span class=\"line\">y_train = np.array(raw_data_y)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x_train</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[3.39353321, 2.33127338],\n       [3.11007348, 1.78153964],\n       [1.34380883, 3.36836095],\n       [3.58229404, 4.67917911],\n       [2.28036244, 2.86699026],\n       [7.42343694, 4.69652288],\n       [5.745052  , 3.5339898 ],\n       [9.17216862, 2.51110105],\n       [7.79278348, 3.42408894],\n       [7.93982082, 0.79163723]])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_train==<span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([False, False, False, False, False,  True,  True,  True,  True,\n        True])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'r'</span>, label=<span class=\"string\">'1'</span>)</span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'g'</span>, label=<span class=\"string\">'0'</span>)</span><br><span class=\"line\">plt.legend()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.legend.Legend at 0x122311ad0&gt;</code></pre><p><img src=\"data/output_6_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = np.array([<span class=\"number\">8.093607318</span>, <span class=\"number\">3.365731514</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">1</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'r'</span>, label=<span class=\"string\">'1'</span>)</span><br><span class=\"line\">plt.scatter(x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">0</span>], x_train[y_train==<span class=\"number\">0</span>, <span class=\"number\">1</span>], color=<span class=\"string\">'g'</span>, label=<span class=\"string\">'0'</span>)</span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], color=<span class=\"string\">'b'</span>)</span><br><span class=\"line\">plt.legend()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n<p><img src=\"data/output_7_0.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\">distance = []</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> each <span class=\"keyword\">in</span> x_train:</span><br><span class=\"line\">    d = math.sqrt(np.sum((each - x) ** <span class=\"number\">2</span>))</span><br><span class=\"line\">    distance.append(d)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">distance</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[4.812566907609877,\n 5.229270827235305,\n 6.749798999160064,\n 4.6986266144110695,\n 5.83460014556857,\n 1.4900114024329525,\n 2.354574897431513,\n 1.3761132675144652,\n 0.3064319992975,\n 2.5786840957478887]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">distances = [math.sqrt(np.sum((each - x) ** <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> each <span class=\"keyword\">in</span> x_train]</span><br><span class=\"line\">distances</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[4.812566907609877,\n 5.229270827235305,\n 6.749798999160064,\n 4.6986266144110695,\n 5.83460014556857,\n 1.4900114024329525,\n 2.354574897431513,\n 1.3761132675144652,\n 0.3064319992975,\n 2.5786840957478887]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nearest = np.argsort(distances)</span><br><span class=\"line\">nearest</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([8, 7, 5, 6, 9, 3, 0, 1, 4, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">k = <span class=\"number\">6</span></span><br><span class=\"line\">topK_y = [y_train[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> nearest[:k]]</span><br><span class=\"line\">topK_y</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[1, 1, 1, 1, 1, 0]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> collections</span><br><span class=\"line\">votes = collections.Counter(topK_y)</span><br><span class=\"line\">votes</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Counter({1: 5, 0: 1})</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">votes.most_common(<span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>[(1, 5)]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">predict_y = votes.most_common(<span class=\"number\">1</span>)[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\">predict_y</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>1</code></pre><h1 id=\"scikit-learn实现KNN\"><a href=\"#scikit-learn实现KNN\" class=\"headerlink\" title=\"scikit-learn实现KNN\"></a>scikit-learn实现KNN</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">raw_data_x = [[<span class=\"number\">3.393533211</span>, <span class=\"number\">2.331273381</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.110073483</span>, <span class=\"number\">1.781539638</span>],</span><br><span class=\"line\">              [<span class=\"number\">1.343808831</span>, <span class=\"number\">3.368360954</span>],</span><br><span class=\"line\">              [<span class=\"number\">3.582294042</span>, <span class=\"number\">4.679179110</span>],</span><br><span class=\"line\">              [<span class=\"number\">2.280362439</span>, <span class=\"number\">2.866990263</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.423436942</span>, <span class=\"number\">4.696522875</span>],</span><br><span class=\"line\">              [<span class=\"number\">5.745051997</span>, <span class=\"number\">3.533989803</span>],</span><br><span class=\"line\">              [<span class=\"number\">9.172168622</span>, <span class=\"number\">2.511101045</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.792783481</span>, <span class=\"number\">3.424088941</span>],</span><br><span class=\"line\">              [<span class=\"number\">7.939820817</span>, <span class=\"number\">0.791637231</span>]</span><br><span class=\"line\">             ]</span><br><span class=\"line\">raw_data_y = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">x_train = np.array(raw_data_x)</span><br><span class=\"line\">y_train = np.array(raw_data_y)</span><br><span class=\"line\"></span><br><span class=\"line\">target = np.array([<span class=\"number\">8.093607318</span>, <span class=\"number\">3.365731514</span>])</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier = KNeighborsClassifier(n_neighbors=<span class=\"number\">6</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier.fit(x_train, y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=6, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">target = x.reshape(<span class=\"number\">1</span>, <span class=\"number\">-1</span>)</span><br><span class=\"line\">print(target)</span><br></pre></td></tr></table></figure>\n\n<pre><code>[[8.09360732 3.36573151]]</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNN_classifier.predict(target)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([1])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNN_classifier.predict(target)</span><br><span class=\"line\">res[<span class=\"number\">0</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>1</code></pre>"},{"_content":"# KNN-手写体数字数据集\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import datasets\nfrom sklearn.neighbors import KNeighborsClassifier\n```\n\n\n```python\ndigits = datasets.load_digits()\nX = digits.data\nX.shape\n```\n\n\n\n\n    (1797, 64)\n\n\n\n\n```python\ny = digits.target\ny.shape\n```\n\n\n\n\n    (1797,)\n\n\n\n\n```python\none = X[100]\none = one.reshape(8, 8)\none\n```\n\n\n\n\n    array([[ 0.,  0.,  0.,  2., 13.,  0.,  0.,  0.],\n           [ 0.,  0.,  0.,  8., 15.,  0.,  0.,  0.],\n           [ 0.,  0.,  5., 16.,  5.,  2.,  0.,  0.],\n           [ 0.,  0., 15., 12.,  1., 16.,  4.,  0.],\n           [ 0.,  4., 16.,  2.,  9., 16.,  8.,  0.],\n           [ 0.,  0., 10., 14., 16., 16.,  4.,  0.],\n           [ 0.,  0.,  0.,  0., 13.,  8.,  0.,  0.],\n           [ 0.,  0.,  0.,  0., 13.,  6.,  0.,  0.]])\n\n\n\n\n```python\nplt.imshow(one)\n```\n\n\n\n\n    <matplotlib.image.AxesImage at 0x1a203a9ad0>\n\n\n\n\n![png](data/output_5_1.png)\n\n\n# 分离训练测试集\n\n\n```python\nfrom sklearn.model_selection import train_test_split\ntrain_test_split?\n```\n\n\n    \u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m\n    Split arrays or matrices into random train and test subsets\n    \n    Quick utility that wraps input validation and\n    ``next(ShuffleSplit().split(X, y))`` and application to input data\n    into a single call for splitting (and optionally subsampling) data in a\n    oneliner.\n    \n    Read more in the :ref:`User Guide <cross_validation>`.\n    \n    Parameters\n    ----------\n    *arrays : sequence of indexables with same length / shape[0]\n        Allowed inputs are lists, numpy arrays, scipy-sparse\n        matrices or pandas dataframes.\n    \n    test_size : float, int or None, optional (default=None)\n        If float, should be between 0.0 and 1.0 and represent the proportion\n        of the dataset to include in the test split. If int, represents the\n        absolute number of test samples. If None, the value is set to the\n        complement of the train size. If ``train_size`` is also None, it will\n        be set to 0.25.\n    \n    train_size : float, int, or None, (default=None)\n        If float, should be between 0.0 and 1.0 and represent the\n        proportion of the dataset to include in the train split. If\n        int, represents the absolute number of train samples. If None,\n        the value is automatically set to the complement of the test size.\n    \n    random_state : int, RandomState instance or None, optional (default=None)\n        If int, random_state is the seed used by the random number generator;\n        If RandomState instance, random_state is the random number generator;\n        If None, the random number generator is the RandomState instance used\n        by `np.random`.\n    \n    shuffle : boolean, optional (default=True)\n        Whether or not to shuffle the data before splitting. If shuffle=False\n        then stratify must be None.\n    \n    stratify : array-like or None (default=None)\n        If not None, data is split in a stratified fashion, using this as\n        the class labels.\n    \n    Returns\n    -------\n    splitting : list, length=2 * len(arrays)\n        List containing train-test split of inputs.\n    \n        .. versionadded:: 0.16\n            If the input is sparse, the output will be a\n            ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n            input type.\n    \n    Examples\n    --------\n    >>> import numpy as np\n    >>> from sklearn.model_selection import train_test_split\n    >>> X, y = np.arange(10).reshape((5, 2)), range(5)\n    >>> X\n    array([[0, 1],\n           [2, 3],\n           [4, 5],\n           [6, 7],\n           [8, 9]])\n    >>> list(y)\n    [0, 1, 2, 3, 4]\n    \n    >>> X_train, X_test, y_train, y_test = train_test_split(\n    ...     X, y, test_size=0.33, random_state=42)\n    ...\n    >>> X_train\n    array([[4, 5],\n           [0, 1],\n           [6, 7]])\n    >>> y_train\n    [2, 0, 3]\n    >>> X_test\n    array([[2, 3],\n           [8, 9]])\n    >>> y_test\n    [1, 4]\n    \n    >>> train_test_split(y, shuffle=False)\n    [[0, 1, 2], [3, 4]]\n    \u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n    \u001b[0;31mType:\u001b[0m      function\n\n\n\n\n```python\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)\n```\n\n    (1437, 64)\n    (1437,)\n    (360, 64)\n    (360,)\n\n\n# 测试\n\n\n```python\nKNNClf = KNeighborsClassifier(n_neighbors=3)\n```\n\n\n```python\nKNNClf.fit(X_train, y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                         weights='uniform')\n\n\n\n\n```python\nres = KNNClf.predict(X_test)\nres\n```\n\n\n\n\n    array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n           4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n           9, 0, 4, 9, 4, 9, 7, 2, 7, 3, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n           0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n           4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 3, 8, 8, 8, 0, 0, 9, 1,\n           9, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n           9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n           7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n           6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n           9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n           6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n           0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n           8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n           1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 9, 4, 1, 7, 0, 2, 9, 1, 8,\n           2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n           7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n           7, 5, 3, 5, 6, 1, 8, 1])\n\n\n\n\n```python\ny_test\n```\n\n\n\n\n    array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n           4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n           9, 0, 4, 9, 4, 9, 7, 2, 7, 8, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n           0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n           4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 9, 8, 8, 8, 0, 0, 9, 1,\n           4, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n           9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n           7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n           6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n           9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n           6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n           0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n           8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n           1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 7, 4, 1, 3, 0, 2, 9, 1, 8,\n           2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n           7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n           7, 5, 3, 5, 6, 1, 8, 8])\n\n\n\n\n```python\nnum = sum(res == y_test)\nnum\n```\n\n\n\n\n    354\n\n\n\n\n```python\nprint('accuracy ', num / len(y_test))\n```\n\n    accuracy  0.9833333333333333\n\n\n#### 使用sklearn中封装的计算精确度的方法\n\n\n```python\nfrom sklearn.metrics import accuracy_score as accuracy\n```\n\n\n```python\naccuracy(res, y_test)\n```\n\n\n\n\n    0.9833333333333333\n\n\n\n\n```python\n\n```\n","source":"_posts/mlsec/KNN-手写体数字数据集.md","raw":"# KNN-手写体数字数据集\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import datasets\nfrom sklearn.neighbors import KNeighborsClassifier\n```\n\n\n```python\ndigits = datasets.load_digits()\nX = digits.data\nX.shape\n```\n\n\n\n\n    (1797, 64)\n\n\n\n\n```python\ny = digits.target\ny.shape\n```\n\n\n\n\n    (1797,)\n\n\n\n\n```python\none = X[100]\none = one.reshape(8, 8)\none\n```\n\n\n\n\n    array([[ 0.,  0.,  0.,  2., 13.,  0.,  0.,  0.],\n           [ 0.,  0.,  0.,  8., 15.,  0.,  0.,  0.],\n           [ 0.,  0.,  5., 16.,  5.,  2.,  0.,  0.],\n           [ 0.,  0., 15., 12.,  1., 16.,  4.,  0.],\n           [ 0.,  4., 16.,  2.,  9., 16.,  8.,  0.],\n           [ 0.,  0., 10., 14., 16., 16.,  4.,  0.],\n           [ 0.,  0.,  0.,  0., 13.,  8.,  0.,  0.],\n           [ 0.,  0.,  0.,  0., 13.,  6.,  0.,  0.]])\n\n\n\n\n```python\nplt.imshow(one)\n```\n\n\n\n\n    <matplotlib.image.AxesImage at 0x1a203a9ad0>\n\n\n\n\n![png](data/output_5_1.png)\n\n\n# 分离训练测试集\n\n\n```python\nfrom sklearn.model_selection import train_test_split\ntrain_test_split?\n```\n\n\n    \u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m\n    Split arrays or matrices into random train and test subsets\n    \n    Quick utility that wraps input validation and\n    ``next(ShuffleSplit().split(X, y))`` and application to input data\n    into a single call for splitting (and optionally subsampling) data in a\n    oneliner.\n    \n    Read more in the :ref:`User Guide <cross_validation>`.\n    \n    Parameters\n    ----------\n    *arrays : sequence of indexables with same length / shape[0]\n        Allowed inputs are lists, numpy arrays, scipy-sparse\n        matrices or pandas dataframes.\n    \n    test_size : float, int or None, optional (default=None)\n        If float, should be between 0.0 and 1.0 and represent the proportion\n        of the dataset to include in the test split. If int, represents the\n        absolute number of test samples. If None, the value is set to the\n        complement of the train size. If ``train_size`` is also None, it will\n        be set to 0.25.\n    \n    train_size : float, int, or None, (default=None)\n        If float, should be between 0.0 and 1.0 and represent the\n        proportion of the dataset to include in the train split. If\n        int, represents the absolute number of train samples. If None,\n        the value is automatically set to the complement of the test size.\n    \n    random_state : int, RandomState instance or None, optional (default=None)\n        If int, random_state is the seed used by the random number generator;\n        If RandomState instance, random_state is the random number generator;\n        If None, the random number generator is the RandomState instance used\n        by `np.random`.\n    \n    shuffle : boolean, optional (default=True)\n        Whether or not to shuffle the data before splitting. If shuffle=False\n        then stratify must be None.\n    \n    stratify : array-like or None (default=None)\n        If not None, data is split in a stratified fashion, using this as\n        the class labels.\n    \n    Returns\n    -------\n    splitting : list, length=2 * len(arrays)\n        List containing train-test split of inputs.\n    \n        .. versionadded:: 0.16\n            If the input is sparse, the output will be a\n            ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n            input type.\n    \n    Examples\n    --------\n    >>> import numpy as np\n    >>> from sklearn.model_selection import train_test_split\n    >>> X, y = np.arange(10).reshape((5, 2)), range(5)\n    >>> X\n    array([[0, 1],\n           [2, 3],\n           [4, 5],\n           [6, 7],\n           [8, 9]])\n    >>> list(y)\n    [0, 1, 2, 3, 4]\n    \n    >>> X_train, X_test, y_train, y_test = train_test_split(\n    ...     X, y, test_size=0.33, random_state=42)\n    ...\n    >>> X_train\n    array([[4, 5],\n           [0, 1],\n           [6, 7]])\n    >>> y_train\n    [2, 0, 3]\n    >>> X_test\n    array([[2, 3],\n           [8, 9]])\n    >>> y_test\n    [1, 4]\n    \n    >>> train_test_split(y, shuffle=False)\n    [[0, 1, 2], [3, 4]]\n    \u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n    \u001b[0;31mType:\u001b[0m      function\n\n\n\n\n```python\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)\n```\n\n    (1437, 64)\n    (1437,)\n    (360, 64)\n    (360,)\n\n\n# 测试\n\n\n```python\nKNNClf = KNeighborsClassifier(n_neighbors=3)\n```\n\n\n```python\nKNNClf.fit(X_train, y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                         weights='uniform')\n\n\n\n\n```python\nres = KNNClf.predict(X_test)\nres\n```\n\n\n\n\n    array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n           4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n           9, 0, 4, 9, 4, 9, 7, 2, 7, 3, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n           0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n           4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 3, 8, 8, 8, 0, 0, 9, 1,\n           9, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n           9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n           7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n           6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n           9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n           6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n           0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n           8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n           1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 9, 4, 1, 7, 0, 2, 9, 1, 8,\n           2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n           7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n           7, 5, 3, 5, 6, 1, 8, 1])\n\n\n\n\n```python\ny_test\n```\n\n\n\n\n    array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n           4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n           9, 0, 4, 9, 4, 9, 7, 2, 7, 8, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n           0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n           4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 9, 8, 8, 8, 0, 0, 9, 1,\n           4, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n           9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n           7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n           6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n           9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n           6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n           0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n           8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n           1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 7, 4, 1, 3, 0, 2, 9, 1, 8,\n           2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n           7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n           7, 5, 3, 5, 6, 1, 8, 8])\n\n\n\n\n```python\nnum = sum(res == y_test)\nnum\n```\n\n\n\n\n    354\n\n\n\n\n```python\nprint('accuracy ', num / len(y_test))\n```\n\n    accuracy  0.9833333333333333\n\n\n#### 使用sklearn中封装的计算精确度的方法\n\n\n```python\nfrom sklearn.metrics import accuracy_score as accuracy\n```\n\n\n```python\naccuracy(res, y_test)\n```\n\n\n\n\n    0.9833333333333333\n\n\n\n\n```python\n\n```\n","slug":"mlsec/KNN-手写体数字数据集","published":1,"date":"2020-05-17T08:37:20.000Z","updated":"2020-05-17T08:38:09.444Z","title":"mlsec/KNN-手写体数字数据集","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zo0067018o2n3mhivp","content":"<h1 id=\"KNN-手写体数字数据集\"><a href=\"#KNN-手写体数字数据集\" class=\"headerlink\" title=\"KNN-手写体数字数据集\"></a>KNN-手写体数字数据集</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">digits = datasets.load_digits()</span><br><span class=\"line\">X = digits.data</span><br><span class=\"line\">X.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(1797, 64)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y = digits.target</span><br><span class=\"line\">y.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(1797,)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">one = X[<span class=\"number\">100</span>]</span><br><span class=\"line\">one = one.reshape(<span class=\"number\">8</span>, <span class=\"number\">8</span>)</span><br><span class=\"line\">one</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[ 0.,  0.,  0.,  2., 13.,  0.,  0.,  0.],\n       [ 0.,  0.,  0.,  8., 15.,  0.,  0.,  0.],\n       [ 0.,  0.,  5., 16.,  5.,  2.,  0.,  0.],\n       [ 0.,  0., 15., 12.,  1., 16.,  4.,  0.],\n       [ 0.,  4., 16.,  2.,  9., 16.,  8.,  0.],\n       [ 0.,  0., 10., 14., 16., 16.,  4.,  0.],\n       [ 0.,  0.,  0.,  0., 13.,  8.,  0.,  0.],\n       [ 0.,  0.,  0.,  0., 13.,  6.,  0.,  0.]])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.imshow(one)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.image.AxesImage at 0x1a203a9ad0&gt;</code></pre><p><img src=\"data/output_5_1.png\" alt=\"png\"></p>\n<h1 id=\"分离训练测试集\"><a href=\"#分离训练测试集\" class=\"headerlink\" title=\"分离训练测试集\"></a>分离训练测试集</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\">train_test_split?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nSplit arrays or matrices into random train and test subsets\n\nQuick utility that wraps input validation and\n``next(ShuffleSplit().split(X, y))`` and application to input data\ninto a single call for splitting (and optionally subsampling) data in a\noneliner.\n\nRead more in the :ref:`User Guide &lt;cross_validation&gt;`.\n\nParameters\n----------\n*arrays : sequence of indexables with same length / shape[0]\n    Allowed inputs are lists, numpy arrays, scipy-sparse\n    matrices or pandas dataframes.\n\ntest_size : float, int or None, optional (default=None)\n    If float, should be between 0.0 and 1.0 and represent the proportion\n    of the dataset to include in the test split. If int, represents the\n    absolute number of test samples. If None, the value is set to the\n    complement of the train size. If ``train_size`` is also None, it will\n    be set to 0.25.\n\ntrain_size : float, int, or None, (default=None)\n    If float, should be between 0.0 and 1.0 and represent the\n    proportion of the dataset to include in the train split. If\n    int, represents the absolute number of train samples. If None,\n    the value is automatically set to the complement of the test size.\n\nrandom_state : int, RandomState instance or None, optional (default=None)\n    If int, random_state is the seed used by the random number generator;\n    If RandomState instance, random_state is the random number generator;\n    If None, the random number generator is the RandomState instance used\n    by `np.random`.\n\nshuffle : boolean, optional (default=True)\n    Whether or not to shuffle the data before splitting. If shuffle=False\n    then stratify must be None.\n\nstratify : array-like or None (default=None)\n    If not None, data is split in a stratified fashion, using this as\n    the class labels.\n\nReturns\n-------\nsplitting : list, length=2 * len(arrays)\n    List containing train-test split of inputs.\n\n    .. versionadded:: 0.16\n        If the input is sparse, the output will be a\n        ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n        input type.\n\nExamples\n--------\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from sklearn.model_selection import train_test_split\n&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)\n&gt;&gt;&gt; X\narray([[0, 1],\n       [2, 3],\n       [4, 5],\n       [6, 7],\n       [8, 9]])\n&gt;&gt;&gt; list(y)\n[0, 1, 2, 3, 4]\n\n&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(\n...     X, y, test_size=0.33, random_state=42)\n...\n&gt;&gt;&gt; X_train\narray([[4, 5],\n       [0, 1],\n       [6, 7]])\n&gt;&gt;&gt; y_train\n[2, 0, 3]\n&gt;&gt;&gt; X_test\narray([[2, 3],\n       [8, 9]])\n&gt;&gt;&gt; y_test\n[1, 4]\n\n&gt;&gt;&gt; train_test_split(y, shuffle=False)\n[[0, 1, 2], [3, 4]]\n\u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n\u001b[0;31mType:\u001b[0m      function</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>)</span><br><span class=\"line\">print(X_train.shape)</span><br><span class=\"line\">print(y_train.shape)</span><br><span class=\"line\">print(X_test.shape)</span><br><span class=\"line\">print(y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(1437, 64)\n(1437,)\n(360, 64)\n(360,)</code></pre><h1 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf = KNeighborsClassifier(n_neighbors=<span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNNClf.predict(X_test)</span><br><span class=\"line\">res</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n       9, 0, 4, 9, 4, 9, 7, 2, 7, 3, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 3, 8, 8, 8, 0, 0, 9, 1,\n       9, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 9, 4, 1, 7, 0, 2, 9, 1, 8,\n       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n       7, 5, 3, 5, 6, 1, 8, 1])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_test</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n       9, 0, 4, 9, 4, 9, 7, 2, 7, 8, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 9, 8, 8, 8, 0, 0, 9, 1,\n       4, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 7, 4, 1, 3, 0, 2, 9, 1, 8,\n       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n       7, 5, 3, 5, 6, 1, 8, 8])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num = sum(res == y_test)</span><br><span class=\"line\">num</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>354</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(<span class=\"string\">'accuracy '</span>, num / len(y_test))</span><br></pre></td></tr></table></figure>\n\n<pre><code>accuracy  0.9833333333333333</code></pre><h4 id=\"使用sklearn中封装的计算精确度的方法\"><a href=\"#使用sklearn中封装的计算精确度的方法\" class=\"headerlink\" title=\"使用sklearn中封装的计算精确度的方法\"></a>使用sklearn中封装的计算精确度的方法</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score <span class=\"keyword\">as</span> accuracy</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">accuracy(res, y_test)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0.9833333333333333</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"KNN-手写体数字数据集\"><a href=\"#KNN-手写体数字数据集\" class=\"headerlink\" title=\"KNN-手写体数字数据集\"></a>KNN-手写体数字数据集</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">digits = datasets.load_digits()</span><br><span class=\"line\">X = digits.data</span><br><span class=\"line\">X.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(1797, 64)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y = digits.target</span><br><span class=\"line\">y.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(1797,)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">one = X[<span class=\"number\">100</span>]</span><br><span class=\"line\">one = one.reshape(<span class=\"number\">8</span>, <span class=\"number\">8</span>)</span><br><span class=\"line\">one</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[ 0.,  0.,  0.,  2., 13.,  0.,  0.,  0.],\n       [ 0.,  0.,  0.,  8., 15.,  0.,  0.,  0.],\n       [ 0.,  0.,  5., 16.,  5.,  2.,  0.,  0.],\n       [ 0.,  0., 15., 12.,  1., 16.,  4.,  0.],\n       [ 0.,  4., 16.,  2.,  9., 16.,  8.,  0.],\n       [ 0.,  0., 10., 14., 16., 16.,  4.,  0.],\n       [ 0.,  0.,  0.,  0., 13.,  8.,  0.,  0.],\n       [ 0.,  0.,  0.,  0., 13.,  6.,  0.,  0.]])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.imshow(one)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.image.AxesImage at 0x1a203a9ad0&gt;</code></pre><p><img src=\"data/output_5_1.png\" alt=\"png\"></p>\n<h1 id=\"分离训练测试集\"><a href=\"#分离训练测试集\" class=\"headerlink\" title=\"分离训练测试集\"></a>分离训练测试集</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\">train_test_split?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nSplit arrays or matrices into random train and test subsets\n\nQuick utility that wraps input validation and\n``next(ShuffleSplit().split(X, y))`` and application to input data\ninto a single call for splitting (and optionally subsampling) data in a\noneliner.\n\nRead more in the :ref:`User Guide &lt;cross_validation&gt;`.\n\nParameters\n----------\n*arrays : sequence of indexables with same length / shape[0]\n    Allowed inputs are lists, numpy arrays, scipy-sparse\n    matrices or pandas dataframes.\n\ntest_size : float, int or None, optional (default=None)\n    If float, should be between 0.0 and 1.0 and represent the proportion\n    of the dataset to include in the test split. If int, represents the\n    absolute number of test samples. If None, the value is set to the\n    complement of the train size. If ``train_size`` is also None, it will\n    be set to 0.25.\n\ntrain_size : float, int, or None, (default=None)\n    If float, should be between 0.0 and 1.0 and represent the\n    proportion of the dataset to include in the train split. If\n    int, represents the absolute number of train samples. If None,\n    the value is automatically set to the complement of the test size.\n\nrandom_state : int, RandomState instance or None, optional (default=None)\n    If int, random_state is the seed used by the random number generator;\n    If RandomState instance, random_state is the random number generator;\n    If None, the random number generator is the RandomState instance used\n    by `np.random`.\n\nshuffle : boolean, optional (default=True)\n    Whether or not to shuffle the data before splitting. If shuffle=False\n    then stratify must be None.\n\nstratify : array-like or None (default=None)\n    If not None, data is split in a stratified fashion, using this as\n    the class labels.\n\nReturns\n-------\nsplitting : list, length=2 * len(arrays)\n    List containing train-test split of inputs.\n\n    .. versionadded:: 0.16\n        If the input is sparse, the output will be a\n        ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n        input type.\n\nExamples\n--------\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from sklearn.model_selection import train_test_split\n&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)\n&gt;&gt;&gt; X\narray([[0, 1],\n       [2, 3],\n       [4, 5],\n       [6, 7],\n       [8, 9]])\n&gt;&gt;&gt; list(y)\n[0, 1, 2, 3, 4]\n\n&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(\n...     X, y, test_size=0.33, random_state=42)\n...\n&gt;&gt;&gt; X_train\narray([[4, 5],\n       [0, 1],\n       [6, 7]])\n&gt;&gt;&gt; y_train\n[2, 0, 3]\n&gt;&gt;&gt; X_test\narray([[2, 3],\n       [8, 9]])\n&gt;&gt;&gt; y_test\n[1, 4]\n\n&gt;&gt;&gt; train_test_split(y, shuffle=False)\n[[0, 1, 2], [3, 4]]\n\u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n\u001b[0;31mType:\u001b[0m      function</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.2</span>)</span><br><span class=\"line\">print(X_train.shape)</span><br><span class=\"line\">print(y_train.shape)</span><br><span class=\"line\">print(X_test.shape)</span><br><span class=\"line\">print(y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(1437, 64)\n(1437,)\n(360, 64)\n(360,)</code></pre><h1 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf = KNeighborsClassifier(n_neighbors=<span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNNClf.predict(X_test)</span><br><span class=\"line\">res</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n       9, 0, 4, 9, 4, 9, 7, 2, 7, 3, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 3, 8, 8, 8, 0, 0, 9, 1,\n       9, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 9, 4, 1, 7, 0, 2, 9, 1, 8,\n       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n       7, 5, 3, 5, 6, 1, 8, 1])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y_test</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([3, 4, 8, 5, 5, 7, 0, 3, 1, 4, 7, 5, 5, 8, 0, 7, 4, 7, 1, 7, 9, 4,\n       4, 7, 6, 1, 2, 9, 1, 3, 3, 3, 7, 0, 7, 0, 2, 8, 9, 1, 1, 5, 4, 8,\n       9, 0, 4, 9, 4, 9, 7, 2, 7, 8, 3, 4, 1, 9, 9, 9, 0, 4, 0, 6, 1, 0,\n       0, 3, 6, 2, 3, 2, 8, 5, 9, 3, 1, 1, 6, 9, 8, 1, 2, 3, 2, 6, 8, 8,\n       4, 6, 8, 6, 3, 9, 2, 8, 3, 6, 5, 7, 1, 7, 9, 8, 8, 8, 0, 0, 9, 1,\n       4, 8, 5, 1, 1, 0, 1, 6, 5, 1, 7, 6, 5, 7, 7, 2, 2, 7, 3, 1, 9, 5,\n       9, 5, 5, 3, 8, 4, 9, 5, 4, 6, 0, 5, 4, 8, 6, 1, 2, 8, 0, 9, 0, 9,\n       7, 9, 7, 0, 2, 8, 2, 4, 0, 6, 2, 6, 7, 5, 6, 3, 8, 8, 0, 3, 2, 0,\n       6, 1, 0, 6, 0, 5, 9, 3, 3, 0, 4, 0, 4, 2, 4, 9, 0, 6, 7, 4, 6, 5,\n       9, 7, 2, 2, 3, 3, 0, 3, 9, 4, 9, 8, 5, 6, 9, 0, 1, 3, 5, 0, 5, 1,\n       6, 4, 6, 6, 6, 7, 9, 1, 0, 7, 6, 6, 7, 8, 0, 3, 8, 5, 6, 8, 1, 3,\n       0, 3, 6, 0, 3, 5, 6, 7, 0, 6, 9, 7, 0, 0, 2, 1, 6, 6, 9, 1, 6, 9,\n       8, 7, 0, 2, 5, 1, 8, 6, 4, 3, 8, 2, 9, 2, 8, 4, 6, 4, 8, 9, 3, 1,\n       1, 5, 0, 7, 8, 2, 3, 8, 4, 7, 7, 7, 7, 7, 4, 1, 3, 0, 2, 9, 1, 8,\n       2, 4, 1, 0, 7, 5, 6, 0, 7, 1, 1, 5, 7, 1, 1, 6, 5, 6, 2, 2, 3, 9,\n       7, 5, 3, 1, 5, 9, 9, 2, 5, 1, 6, 8, 2, 2, 4, 2, 1, 0, 6, 1, 2, 9,\n       7, 5, 3, 5, 6, 1, 8, 8])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num = sum(res == y_test)</span><br><span class=\"line\">num</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>354</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(<span class=\"string\">'accuracy '</span>, num / len(y_test))</span><br></pre></td></tr></table></figure>\n\n<pre><code>accuracy  0.9833333333333333</code></pre><h4 id=\"使用sklearn中封装的计算精确度的方法\"><a href=\"#使用sklearn中封装的计算精确度的方法\" class=\"headerlink\" title=\"使用sklearn中封装的计算精确度的方法\"></a>使用sklearn中封装的计算精确度的方法</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score <span class=\"keyword\">as</span> accuracy</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">accuracy(res, y_test)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0.9833333333333333</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n"},{"title":"False Cut","catagories":["Magic"],"_content":"\n# 三段假切\n\n- swing cut 左手拿到第一堆牌\n- swing cut 左手夹第三堆牌 & 右手拿回左手的第一堆牌\n- 左手转动右手的第二堆牌 放到左手第三堆牌上\n- 右手的第一堆牌 放到左手的第二堆牌上\n\n# Helix False Cut\n\n- swing cut 左手拿到第一堆牌 同时无名指垫在下面中指与小拇指夹住\n- 左手抬起第一堆牌 右手swing cut 将第二堆牌放到左手上\n- 左手落下抬起的第一堆牌 右手swing cut 两堆牌出来 同时拿起左手落下的第一堆牌\n- 左手大拇指与右手配合 将新swing cut 出来的第二堆牌放到牌顶\n- 左手食指与右手配合 将新swing cut 出来的第一堆牌放到牌顶\n- 放下右手的牌堆\n\n# Tips\n\n- Swing Cut 的时候 右手食指和中指捏在右上角\n- 手指可以多伸出来一截 好拿回左手的牌堆\n\n# 本质\n\n- 最上面的牌堆先被切到左手 再被拿回右手 然后最后放回\n\n","source":"_posts/magic/cut.md","raw":"---\ntitle: False Cut\ncatagories:\n- Magic\ntags:\n- cards\n- cut\n---\n\n# 三段假切\n\n- swing cut 左手拿到第一堆牌\n- swing cut 左手夹第三堆牌 & 右手拿回左手的第一堆牌\n- 左手转动右手的第二堆牌 放到左手第三堆牌上\n- 右手的第一堆牌 放到左手的第二堆牌上\n\n# Helix False Cut\n\n- swing cut 左手拿到第一堆牌 同时无名指垫在下面中指与小拇指夹住\n- 左手抬起第一堆牌 右手swing cut 将第二堆牌放到左手上\n- 左手落下抬起的第一堆牌 右手swing cut 两堆牌出来 同时拿起左手落下的第一堆牌\n- 左手大拇指与右手配合 将新swing cut 出来的第二堆牌放到牌顶\n- 左手食指与右手配合 将新swing cut 出来的第一堆牌放到牌顶\n- 放下右手的牌堆\n\n# Tips\n\n- Swing Cut 的时候 右手食指和中指捏在右上角\n- 手指可以多伸出来一截 好拿回左手的牌堆\n\n# 本质\n\n- 最上面的牌堆先被切到左手 再被拿回右手 然后最后放回\n\n","slug":"magic/cut","published":1,"date":"2021-04-02T02:45:40.090Z","updated":"2021-04-04T11:05:15.498Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zp0069018o4pjia2f7","content":"<h1 id=\"三段假切\"><a href=\"#三段假切\" class=\"headerlink\" title=\"三段假切\"></a>三段假切</h1><ul>\n<li>swing cut 左手拿到第一堆牌</li>\n<li>swing cut 左手夹第三堆牌 &amp; 右手拿回左手的第一堆牌</li>\n<li>左手转动右手的第二堆牌 放到左手第三堆牌上</li>\n<li>右手的第一堆牌 放到左手的第二堆牌上</li>\n</ul>\n<h1 id=\"Helix-False-Cut\"><a href=\"#Helix-False-Cut\" class=\"headerlink\" title=\"Helix False Cut\"></a>Helix False Cut</h1><ul>\n<li>swing cut 左手拿到第一堆牌 同时无名指垫在下面中指与小拇指夹住</li>\n<li>左手抬起第一堆牌 右手swing cut 将第二堆牌放到左手上</li>\n<li>左手落下抬起的第一堆牌 右手swing cut 两堆牌出来 同时拿起左手落下的第一堆牌</li>\n<li>左手大拇指与右手配合 将新swing cut 出来的第二堆牌放到牌顶</li>\n<li>左手食指与右手配合 将新swing cut 出来的第一堆牌放到牌顶</li>\n<li>放下右手的牌堆</li>\n</ul>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><ul>\n<li>Swing Cut 的时候 右手食指和中指捏在右上角</li>\n<li>手指可以多伸出来一截 好拿回左手的牌堆</li>\n</ul>\n<h1 id=\"本质\"><a href=\"#本质\" class=\"headerlink\" title=\"本质\"></a>本质</h1><ul>\n<li>最上面的牌堆先被切到左手 再被拿回右手 然后最后放回</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"三段假切\"><a href=\"#三段假切\" class=\"headerlink\" title=\"三段假切\"></a>三段假切</h1><ul>\n<li>swing cut 左手拿到第一堆牌</li>\n<li>swing cut 左手夹第三堆牌 &amp; 右手拿回左手的第一堆牌</li>\n<li>左手转动右手的第二堆牌 放到左手第三堆牌上</li>\n<li>右手的第一堆牌 放到左手的第二堆牌上</li>\n</ul>\n<h1 id=\"Helix-False-Cut\"><a href=\"#Helix-False-Cut\" class=\"headerlink\" title=\"Helix False Cut\"></a>Helix False Cut</h1><ul>\n<li>swing cut 左手拿到第一堆牌 同时无名指垫在下面中指与小拇指夹住</li>\n<li>左手抬起第一堆牌 右手swing cut 将第二堆牌放到左手上</li>\n<li>左手落下抬起的第一堆牌 右手swing cut 两堆牌出来 同时拿起左手落下的第一堆牌</li>\n<li>左手大拇指与右手配合 将新swing cut 出来的第二堆牌放到牌顶</li>\n<li>左手食指与右手配合 将新swing cut 出来的第一堆牌放到牌顶</li>\n<li>放下右手的牌堆</li>\n</ul>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><ul>\n<li>Swing Cut 的时候 右手食指和中指捏在右上角</li>\n<li>手指可以多伸出来一截 好拿回左手的牌堆</li>\n</ul>\n<h1 id=\"本质\"><a href=\"#本质\" class=\"headerlink\" title=\"本质\"></a>本质</h1><ul>\n<li>最上面的牌堆先被切到左手 再被拿回右手 然后最后放回</li>\n</ul>\n"},{"_content":"## Python 数据可视化分析\n\n---\n\n#### 介绍\n\n在机器学习领域中，可视化是十分重要的。在开始一项新任务时，通过可视化手段探索数据能更好地帮助人们把握数据的要点。在分析模型表现和模型报告的结果时，可视化能使分析显得更加生动鲜明。有时候，为了理解复杂的模型，我们还可以将高维空间映射为视觉上更直观的二维或三维图形。\n\n总而言之，可视化是一个相对快捷的从数据中挖掘信息的手段。本文将使用 Pandas、Matplotlib、seaborn 等流行的库，带你上手可视化。\n\n#### 知识点\n\n- 单变量可视化的常用方法\n- 多变量可视化的常用方法\n- t-SNE\n\n\n### 数据集\n\n首先使用 `import` 载入相关依赖。\n\n\n```python\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nsns.set()\n```\n\n在第一篇文章中，我们使用的是某电信运营商的客户离网数据集，本次实验仍旧使用这个数据集。\n\n\n```python\ndf = pd.read_csv('./data/telecom_churn.csv')\n```\n\n\n```python\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>False</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n最后一个数据列 Churn 离网率 是我们的目标特征，它是布尔变量，其中 True 表示公司最终丢失了此客户，False 表示客户被保留。稍后，将构建基于其他特征预测 Churn 特征的模型。 \n\n### 单变量可视化\n\n单变量（univariate）分析一次只关注一个变量。当我们独立地分析一个特征时，通常最关心的是该特征值的分布情况。下面考虑不同统计类型的变量，以及相应的可视化工具。\n\n#### 数量特征\n\n数量特征（quantitative feature）的值为有序数值。这些值可能是离散的，例如整数，也可能是连续的，例如实数。\n\n#### 直方图和密度图\n\n直方图依照相等的间隔将值分组为柱，它的形状可能包含了数据分布的一些信息，如高斯分布、指数分布等。当分布总体呈现规律性，但有个别异常值时，你可以通过直方图辨认出来。当你使用的机器学习方法预设了某一特定分布类型（通常是高斯分布）时，知道特征值的分布是非常重要的。\n\n最简单的查看数值变量分布的方法是使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `hist()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.hist.html) 方法绘制直方图。\n\n\n```python\nfeatures = ['Total day minutes', 'Total intl calls']\ndf[features].hist(figsize = (10, 4))\n```\n\n\n\n\n    array([[<matplotlib.axes._subplots.AxesSubplot object at 0x12e3076d0>,\n            <matplotlib.axes._subplots.AxesSubplot object at 0x12f4cbe90>]],\n          dtype=object)\n\n\n\n\n![png](data/output_21_1.png)\n\n\n上图表明，变量 Total day minutes 每日通话时长 呈高斯分布，而 Total intl calls 总国际呼叫数 显著右倾（它右侧的尾巴更长）。\n\n密度图（density plots），也叫核密度图（ [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> kernel density estimate</i>](https://en.wikipedia.org/wiki/Kernel_density_estimation)，KDE）是理解数值变量分布的另一个方法。它可以看成是直方图平滑（ [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> smoothed</i>](https://en.wikipedia.org/wiki/Kernel_smoother) ）的版本。相比直方图，它的主要优势是不依赖于柱的尺寸，更加清晰。\n\n让我们为上面两个变量创建密度图。\n\n\n```python\ndf[features].plot(kind='density', subplots=True, layout=(1,2),\n                 sharex=False, figsize=(10, 4), legend=False, title=features)\n```\n\n\n\n\n    array([[<matplotlib.axes._subplots.AxesSubplot object at 0x133bcc050>,\n            <matplotlib.axes._subplots.AxesSubplot object at 0x1343f1ad0>]],\n          dtype=object)\n\n\n\n\n![png](data/output_25_1.png)\n\n\n\n```python\nsns.distplot(df['Total day calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e4f8810>\n\n\n\n\n![png](data/output_26_1.png)\n\n\n当然，还可以使用 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `distplot()`</i>](https://seaborn.pydata.org/generated/seaborn.distplot.html) 方法观测数值变量的分布。例如，Total day minutes 每日通话时长 的分布。默认情况下，该方法将同时显示直方图和密度图。\n\n\n```python\nsns.distplot(df['Total intl calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e5134d0>\n\n\n\n\n![png](data/output_28_1.png)\n\n\n上图中直方图的柱形高度已进行归一化处理，表示的是密度而不是样本数。\n\n#### 箱型图\n\n箱形图的主要组成部分是箱子（box），须（whisker）和一些单独的数据点（离群值），分别简单介绍如下：\n\n- 箱子显示了分布的四分位距，它的长度由 $25th \\, （\\text{Q1，下四分位数}）$ 和 $75th \\, （\\text{Q3，上四分位数}）$ 决定，箱中的水平线表示中位数  （$50\\%$）。\n- 须是从箱子处延伸出来的线，它们表示数据点的总体散布，具体而言，是位于区间 $（\\text{Q1} - 1.5 \\cdot \\text{IQR}, \\text{Q3} + 1.5 \\cdot \\text{IQR}）$的数据点，其中 $\\text{IQR} = \\text{Q3} - \\text{Q1}$，也就是四分位距。\n- 离群值是须之外的数据点，它们作为单独的数据点，沿着中轴绘制。\n\n使用 seaborn 的 `boxplot()` 方法绘制箱形图。\n\n\n```python\nsns.boxplot(df['Total intl calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e6e1750>\n\n\n\n\n![png](data/output_34_1.png)\n\n\n上图表明，在该数据集中，大量的国际呼叫是相当少见的。\n\n#### 提琴形图\n\n我们最后考虑的分布图形是提琴形图（violin plot）。提琴形图和箱形图的区别是，提琴形图聚焦于平滑后的整体分布，而箱形图显示了单独样本的特定统计数据。\n\n使用 `violinplot()` 方法绘制提琴形图。下图左侧是箱形图，右侧是提琴形图。\n\n\n```python\nimport matplotlib.pyplot as plt\n\n_, ax = plt.subplots(1, 2, sharey=True, figsize=(10, 4))\n\nsns.boxplot(df['Total intl calls'], ax=ax[0])\nsns.violinplot(df['Total intl calls'], ax=ax[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1380219d0>\n\n\n\n\n![png](data/output_39_1.png)\n\n\n#### 数据描述\n\n\n除图形工具外，还可以使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `describe()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html) 方法来获取分布的精确数值统计。\n\n\n```python\ndf[features].describe()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Total day minutes</th>\n      <th>Total intl calls</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>179.775098</td>\n      <td>4.479448</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>54.467389</td>\n      <td>2.461214</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>143.700000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>179.400000</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>216.400000</td>\n      <td>6.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>350.800000</td>\n      <td>20.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`describe()` 的输出基本上是自解释性的，25%，50% 和 75% 是相应的百分数 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> percentiles</i>](https://en.wikipedia.org/wiki/Percentile)。\n\n#### 类别特征和二元特征\n\n类别特征（categorical features take）反映了样本的某个定性属性，它具有固定数目的值，每个值将一个观测数据分配到相应的组，这些组称为类别（category）。如果类别变量的值具有顺序，称为有序（ordinal）类别变量。\n\n二元（binary）特征是类别特征的特例，其可能值有 2 个。\n\n#### 频率表\n\n让我们查看一下目标变量 Churn 离网率 的分布情况。首先，使用 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `value_counts()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html) 方法得到一张频率表。\n\n\n```python\ndf['Churn'].value_counts()\n```\n\n\n\n\n    False    2850\n    True      483\n    Name: Churn, dtype: int64\n\n\n\n上表显示，该数据集的 Churn 有 2850 个属于 False（Churn==0），有 483 个属于 True（Churn==1），数据集中忠实客户（Churn==0）和不忠实客户（Churn==1）的比例并不相等。我们将在以后的文章中看到，这种数据不平衡的情况会导致建立的分类模型存在一定的问题。在这种情况下，构建分类模型可能需要加重对「少数数据（在这里是 Churn==1）分类错误」这一情况的惩罚。\n\n#### 条形图\n\n\n频率表的图形化表示是条形图。创建条形图最简单的方法是使用 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `countplot()`</i>](https://seaborn.pydata.org/generated/seaborn.countplot.html) 函数。让我们来画出两个分类变量的分布。\n\n\n```python\nfig, ax = plt.subplots(1, 2, figsize=[10, 4])\n\nsns.countplot(df['Churn'], ax=ax[0])\nsns.countplot(df['Customer service calls'], ax=ax[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1382242d0>\n\n\n\n\n![png](data/output_53_1.png)\n\n\n条形图和直方图的区别如下：\n\n- 直方图适合查看数值变量的分布，而条形图用于查看类别特征。\n- 直方图的 X 轴是数值；条形图的 X 轴可能是任何类型，如数字、字符串、布尔值。\n- 直方图的 X 轴是一个笛卡尔坐标轴；条形图的顺序则没有事先定义。\n\n上左图清晰地表明了目标变量的失衡性。上右图则表明大部分客户最多打了 2-3 个客服电话就解决了他们的问题。不过，既然想要预测少数数据的分类（Churn==1），我们可能对少数不满意的客户的表现更感兴趣。所以让我们尝试一下更有趣的可视化方法：多变量可视化，看能否对预测有所帮助。\n\n### 多变量可视化\n\n多变量（multivariate）图形可以在单张图像中查看两个以上变量的联系，和单变量图形一样，可视化的类型取决于将要分析的变量的类型。\n\n先来看看数量变量之间的相互作用。\n\n#### 相关矩阵\n\n相关矩阵可揭示数据集中的数值变量的相关性。这一信息很重要，因为有一些机器学习算法（比如，线性回归和逻辑回归）不能很好地处理高度相关的输入变量。\n\n首先，我们使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `corr()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html) 方法计算出每对特征间的相关性。接着，我们将所得的相关矩阵（correlation matrix）传给 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `heatmap()`</i>](https://seaborn.pydata.org/generated/seaborn.heatmap.html)方法，该方法根据提供的数值，渲染出一个基于色彩编码的矩阵。\n\n\n```python\nnumerical = list(set(df.columns) - set(['State', 'International plan', 'Voice mail plan', 'Area code', 'Churn', 'Customer service calls']))\n\ncorr = df[numerical].corr()\nsns.heatmap(corr)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1388bad50>\n\n\n\n\n![png](data/output_63_1.png)\n\n\n上图中，Total day charge 日话费总额 是直接基于 Total day minutes 电话的分钟数 计算得到，它被称为因变量。除了 Total day charege 外，还有 3 个因变量：Total eve charge，Total night charge，Total intl charge。这 4 个因变量并不贡献任何额外信息，我们直接去除。\n\n\n```python\nnumerical = list(set(numerical) - set(['Total day charge', 'Total eve charge', 'Total night charge', 'Total intl charge']))\n\ncorr = df[numerical].corr()\nsns.heatmap(corr)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1396822d0>\n\n\n\n\n![png](data/output_65_1.png)\n\n\n#### 散点图\n\n散点图（scatter plot）将两个数值变量的值显示为二维空间中的笛卡尔坐标（Cartesian coordinate）。通过 matplotlib 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `scatter()`</i>](https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.scatter.html) 方法可以绘制散点图。\n\n\n```python\nplt.scatter(df['Total day minutes'], df['Total night minutes'])\n```\n\n\n\n\n    <matplotlib.collections.PathCollection at 0x139a17c10>\n\n\n\n\n![png](data/output_67_1.png)\n\n\n\n我们得到了两个正态分布变量的散点图，看起来这两个变量并不相关，因为上图的形状和轴是对齐的。\n\nseaborn 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `jointplot()`</i>](https://seaborn.pydata.org/generated/seaborn.jointplot.html) 方法在绘制散点图的同时会绘制两张直方图，某些情形下它们可能会更有用。\n\n\n```python\nsns.jointplot(df['Total day minutes'], df['Total night minutes'])\n```\n\n\n\n\n    <seaborn.axisgrid.JointGrid at 0x139888cd0>\n\n\n\n\n![png](data/output_70_1.png)\n\n\n`jointplot()` 方法还可以绘制平滑过的散点直方图。\n\n\n```python\nsns.jointplot(df['Total day minutes'], df['Total night minutes'], kind='kde', color='g')\n```\n\n\n\n\n    <seaborn.axisgrid.JointGrid at 0x139dc1890>\n\n\n\n\n![png](data/output_72_1.png)\n\n\n上图基本上就是之前讨论过的核密度图的双变量版本。\n\n#### 散点图矩阵\n\n在某些情形下，我们可能想要绘制如下所示的散点图矩阵（scatterplot matrix）。它的对角线包含变量的分布，并且每对变量的散点图填充了矩阵的其余部分。\n\n\n```python\n# %config InlineBackend.figure_format = 'png'\nsns.pairplot(df[numerical])\n```\n\n\n\n\n    <seaborn.axisgrid.PairGrid at 0x139cb5810>\n\n\n\n\n![png](data/output_76_1.png)\n\n\n#### 数量和类别\n\n为了让图形更有趣一点，可以尝试从数值和类别特征的相互作用中得到预测 Churn 的新信息，更具体地，让我们看看输入变量和目标变量 Churn 的关系。使用 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `lmplot()`</i>](https://seaborn.pydata.org/generated/seaborn.lmplot.html) 方法的 hue 参数来指定感兴趣的类别特征。\n\n\n```python\nsns.lmplot('Total day minutes', 'Total night minutes', data=df, hue='Churn', fit_reg=False)\n```\n\n\n\n\n    <seaborn.axisgrid.FacetGrid at 0x13e7df950>\n\n\n\n\n![png](data/output_79_2.png)\n\n\n看起来不忠实客户偏向右上角，也就是倾向于在白天和夜间打更多电话的客户。当然，这不是非常明显，我们也不会基于这一图形下任何确定性的结论。\n\n现在，创建箱形图，以可视化忠实客户（Churn=0）和离网客户（Churn=1）这两个互斥分组中数值变量分布的统计数据。\n\n\n```python\nnumerical.append('Customer service calls')\nprint(numerical)\nfig, axes = plt.subplots(3, 4, figsize=[10, 7])\nfor index, feat in enumerate(numerical):\n    ax = axes[int(index / 4), index % 4]\n    sns.boxplot(df['Churn'], df[feat], ax=ax)\n    ax.set_xlabel('')\n    ax.set_ylabel(feat)\nfig.tight_layout()\n```\n\n    ['Total day minutes', 'Total night minutes', 'Number vmail messages', 'Total eve calls', 'Account length', 'Total intl calls', 'Total eve minutes', 'Total night calls', 'Total day calls', 'Total intl minutes', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls']\n\n\n\n    ---------------------------------------------------------------------------\n\n    IndexError                                Traceback (most recent call last)\n\n    <ipython-input-47-539701aff8ff> in <module>\n          3 fig, axes = plt.subplots(3, 4, figsize=[10, 7])\n          4 for index, feat in enumerate(numerical):\n    ----> 5     ax = axes[int(index / 4), index % 4]\n          6     sns.boxplot(df['Churn'], df[feat], ax=ax)\n          7     ax.set_xlabel('')\n\n\n    IndexError: index 3 is out of bounds for axis 0 with size 3\n\n\n\n![png](data/output_82_2.png)\n\n\n上面的图表表明，两组之间分歧最大的分布是这三个变量：Total day minutes 日通话分钟数、Customer service calls 客服呼叫数、Number vmail messages 语音邮件数。在后续的课程中，我们将学习如何使用随机森林（Random Forest）或梯度提升（Gradient Boosting）来判定特征对分类的重要性，届时可以清晰地看到，前两个特征对于离网预测模型而言确实非常重要。\n\n创建箱型图和提琴形图，查看忠实客户和不忠实客户的日通话分钟数。\n\n\n```python\n_, axes = plt.subplots(2, 2, sharex=True, sharey=True, figsize=[10, 8])\nsns.boxplot(x='Churn', y='Total day minutes', data=df, ax=axes[0][0])\nsns.violinplot(x='Churn', y=\"Total day minutes\", data=df, ax=axes[0][1])\nsns.boxplot(x='Churn', y='Total night minutes', data=df, ax=axes[1][0])\nsns.violinplot(x='Churn', y=\"Total night minutes\", data=df, ax=axes[1][1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x140f70290>\n\n\n\n\n![png](data/output_85_1.png)\n\n\n上图表明，不忠实客户倾向于打更多的电话。\n\n我们还可以发现一个有趣的信息：平均而言，离网客户是通讯服务更活跃的用户。或许是他们对话费不满意，所以预防离网的一个可能措施是降低通话费。当然，公司需要进行额外的经济分析，以查明这样做是否真的有利。\n\n当想要一次性分析两个类别维度下的数量变量时，可以用 seaborn 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `catplot()`</i>](https://seaborn.pydata.org/generated/seaborn.factorplot.html) 函数。例如，在同一图形中可视化 Total day minutes 日通话分钟数 和两个类别变量（Churn 和 Customer service calls）的相互作用。\n\n\n```python\nsns.catplot(x='Churn', y='Total day minutes', col='Customer service calls',\n          data=df[df['Customer service calls'] < 8], kind='box', col_wrap=4, height=3, aspect=.8)\n```\n\n\n\n\n    <seaborn.axisgrid.FacetGrid at 0x140728250>\n\n\n\n\n![png](data/output_89_1.png)\n\n\n上图表明，从第 4 次客服呼叫开始，Total day minutes 日通话分钟数 可能不再是客户离网（Churn==1）的主要因素。也许，除了我们之前猜测的话费原因，还有其他问题导致客户对服务不满意，这可能会导致日通话分钟数更少。\n\n#### 类别与类别\n\n正如之前提到的，变量 Customer service calls 客服呼叫数 的重复值很多，因此，既可以看成数值变量，也可以看成有序类别变量。之前已通过计数图（count plot）查看过它的分布了，现在我们感兴趣的是这一有序特征和目标变量 Churn 离网率 之间的关系。\n\n使用 `countplot()` 方法查看客服呼叫数的分布，这次传入 `hue=Churn` 参数，以便在图形中加入类别维度。\n\n\n```python\nsns.countplot(x='Customer service calls', hue='Churn', data=df[df[\"Customer service calls\"] < 10])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x140cb7990>\n\n\n\n\n![png](data/output_94_1.png)\n\n\n上图表明，呼叫客服达到 4 次以上后，离网率显著增加了。\n\n使用 `countplot()` 方法查看 Churn 离网率 和二元特征 International plan 国际套餐、Voice mail plan 语音邮件套餐 的关系。\n\n\n```python\n_, axes = plt.subplots(1, 2, sharey=True, figsize=(10, 4))\n\nsns.countplot(x='International plan', hue='Churn', data=df, ax=axes[0])\nsns.countplot(x='Voice mail plan', hue='Churn', data=df, ax=axes[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x142344290>\n\n\n\n\n![png](data/output_97_1.png)\n\n\n上图表明，开通国际套餐后，离网率会高很多，即 International plan 是否开通国际套餐 是一个重要的特征。我们在 Vocie mail plan 语音邮件套餐 特征上没有观察到类似的效果。\n\n#### 交叉表\n\n除了使用图形进行类别分析之外，还可以使用统计学的传统工具：交叉表（cross tabulation），即使用表格形式表示多个类别变量的频率分布。通过它可以查看某一列或某一行以了解某个变量在另一变量的作用下的分布情况。\n\n通过交叉表查看 Churn 离网率 和类别变量 State 州 的关系。\n\n\n```python\npd.crosstab(df['State'], df['Churn']).T\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>AK</th>\n      <th>AL</th>\n      <th>AR</th>\n      <th>AZ</th>\n      <th>CA</th>\n      <th>CO</th>\n      <th>CT</th>\n      <th>DC</th>\n      <th>DE</th>\n      <th>FL</th>\n      <th>...</th>\n      <th>SD</th>\n      <th>TN</th>\n      <th>TX</th>\n      <th>UT</th>\n      <th>VA</th>\n      <th>VT</th>\n      <th>WA</th>\n      <th>WI</th>\n      <th>WV</th>\n      <th>WY</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>49</td>\n      <td>72</td>\n      <td>44</td>\n      <td>60</td>\n      <td>25</td>\n      <td>57</td>\n      <td>62</td>\n      <td>49</td>\n      <td>52</td>\n      <td>55</td>\n      <td>...</td>\n      <td>52</td>\n      <td>48</td>\n      <td>54</td>\n      <td>62</td>\n      <td>72</td>\n      <td>65</td>\n      <td>52</td>\n      <td>71</td>\n      <td>96</td>\n      <td>68</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>3</td>\n      <td>8</td>\n      <td>11</td>\n      <td>4</td>\n      <td>9</td>\n      <td>9</td>\n      <td>12</td>\n      <td>5</td>\n      <td>9</td>\n      <td>8</td>\n      <td>...</td>\n      <td>8</td>\n      <td>5</td>\n      <td>18</td>\n      <td>10</td>\n      <td>5</td>\n      <td>8</td>\n      <td>14</td>\n      <td>7</td>\n      <td>10</td>\n      <td>9</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 51 columns</p>\n</div>\n\n\n\n上表显示，State 州 有 51 个不同的值，并且每个州只有 3 到 17 个客户抛弃了运营商。通过 `groupby()` 方法计算每个州的离网率，由高到低排列。\n\n\n```python\ndf.groupby(['State'])['Churn'].agg([np.mean]).sort_values(by='mean', ascending=False).T\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>NJ</th>\n      <th>CA</th>\n      <th>TX</th>\n      <th>MD</th>\n      <th>SC</th>\n      <th>MI</th>\n      <th>MS</th>\n      <th>NV</th>\n      <th>WA</th>\n      <th>ME</th>\n      <th>...</th>\n      <th>RI</th>\n      <th>WI</th>\n      <th>IL</th>\n      <th>NE</th>\n      <th>LA</th>\n      <th>IA</th>\n      <th>VA</th>\n      <th>AZ</th>\n      <th>AK</th>\n      <th>HI</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>mean</th>\n      <td>0.264706</td>\n      <td>0.264706</td>\n      <td>0.25</td>\n      <td>0.242857</td>\n      <td>0.233333</td>\n      <td>0.219178</td>\n      <td>0.215385</td>\n      <td>0.212121</td>\n      <td>0.212121</td>\n      <td>0.209677</td>\n      <td>...</td>\n      <td>0.092308</td>\n      <td>0.089744</td>\n      <td>0.086207</td>\n      <td>0.081967</td>\n      <td>0.078431</td>\n      <td>0.068182</td>\n      <td>0.064935</td>\n      <td>0.0625</td>\n      <td>0.057692</td>\n      <td>0.056604</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 51 columns</p>\n</div>\n\n\n\n上表显示，新泽西和加利福尼亚的离网率超过了 25%，夏威夷和阿拉斯加的离网率则不到 6%。然而，这些结论是基于极少的样本得出的，可能仅适用于这一特定数据集，不太具有泛用性。\n\n### 全局数据集可视化\n\n上面我们一直在研究数据集的不同方面（facet），通过猜测有趣的特征并一次选择少量特征进行可视化。如果我们想一次性显示所有特征并仍然能够解释生成的可视化，该怎么办？\n\n#### 降维\n\n大多数现实世界的数据集有很多特征，每一个特征都可以被看成数据空间的一个维度。因此，我们经常需要处理高维数据集，然而可视化整个高维数据集相当难。为了从整体上查看一个数据集，需要在不损失很多数据信息的前提下，降低用于可视化的维度。这一任务被称为降维（dimensionality reduction）。降维是一个无监督学习（unsupervised learning）问题，因为它需要在不借助任何监督输入（如标签）的前提下，从数据自身得到新的低维特征。\n\n主成分分析（Principal Component Analysis, PCA）是一个著名的降维方法，我们会在之后的课程中讨论它。但主成分分析的局限性在于，它是线性（linear）算法，这意味着对数据有某些特定的限制。\n\n与线性方法相对的，有许多非线性方法，统称流形学习（Manifold Learning）。著名的流形学习方法之一是 t-SNE。\n\n### 实验总结\n\n本章节首先介绍了 Pandas、Matplotlib 和 seaborn 库的一些常用可视化方法，并对客户离网数据集进行了可视化分析和 t-SNE 降维。可视化是一个相对快捷的从数据中挖掘信息的手段，因此，学习这一技术并将其纳入你的日常机器学习工具箱，是很有必要的。\n","source":"_posts/mlsec/Python-数据探索之可视化分析.md","raw":"## Python 数据可视化分析\n\n---\n\n#### 介绍\n\n在机器学习领域中，可视化是十分重要的。在开始一项新任务时，通过可视化手段探索数据能更好地帮助人们把握数据的要点。在分析模型表现和模型报告的结果时，可视化能使分析显得更加生动鲜明。有时候，为了理解复杂的模型，我们还可以将高维空间映射为视觉上更直观的二维或三维图形。\n\n总而言之，可视化是一个相对快捷的从数据中挖掘信息的手段。本文将使用 Pandas、Matplotlib、seaborn 等流行的库，带你上手可视化。\n\n#### 知识点\n\n- 单变量可视化的常用方法\n- 多变量可视化的常用方法\n- t-SNE\n\n\n### 数据集\n\n首先使用 `import` 载入相关依赖。\n\n\n```python\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nsns.set()\n```\n\n在第一篇文章中，我们使用的是某电信运营商的客户离网数据集，本次实验仍旧使用这个数据集。\n\n\n```python\ndf = pd.read_csv('./data/telecom_churn.csv')\n```\n\n\n```python\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>False</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n最后一个数据列 Churn 离网率 是我们的目标特征，它是布尔变量，其中 True 表示公司最终丢失了此客户，False 表示客户被保留。稍后，将构建基于其他特征预测 Churn 特征的模型。 \n\n### 单变量可视化\n\n单变量（univariate）分析一次只关注一个变量。当我们独立地分析一个特征时，通常最关心的是该特征值的分布情况。下面考虑不同统计类型的变量，以及相应的可视化工具。\n\n#### 数量特征\n\n数量特征（quantitative feature）的值为有序数值。这些值可能是离散的，例如整数，也可能是连续的，例如实数。\n\n#### 直方图和密度图\n\n直方图依照相等的间隔将值分组为柱，它的形状可能包含了数据分布的一些信息，如高斯分布、指数分布等。当分布总体呈现规律性，但有个别异常值时，你可以通过直方图辨认出来。当你使用的机器学习方法预设了某一特定分布类型（通常是高斯分布）时，知道特征值的分布是非常重要的。\n\n最简单的查看数值变量分布的方法是使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `hist()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.hist.html) 方法绘制直方图。\n\n\n```python\nfeatures = ['Total day minutes', 'Total intl calls']\ndf[features].hist(figsize = (10, 4))\n```\n\n\n\n\n    array([[<matplotlib.axes._subplots.AxesSubplot object at 0x12e3076d0>,\n            <matplotlib.axes._subplots.AxesSubplot object at 0x12f4cbe90>]],\n          dtype=object)\n\n\n\n\n![png](data/output_21_1.png)\n\n\n上图表明，变量 Total day minutes 每日通话时长 呈高斯分布，而 Total intl calls 总国际呼叫数 显著右倾（它右侧的尾巴更长）。\n\n密度图（density plots），也叫核密度图（ [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> kernel density estimate</i>](https://en.wikipedia.org/wiki/Kernel_density_estimation)，KDE）是理解数值变量分布的另一个方法。它可以看成是直方图平滑（ [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> smoothed</i>](https://en.wikipedia.org/wiki/Kernel_smoother) ）的版本。相比直方图，它的主要优势是不依赖于柱的尺寸，更加清晰。\n\n让我们为上面两个变量创建密度图。\n\n\n```python\ndf[features].plot(kind='density', subplots=True, layout=(1,2),\n                 sharex=False, figsize=(10, 4), legend=False, title=features)\n```\n\n\n\n\n    array([[<matplotlib.axes._subplots.AxesSubplot object at 0x133bcc050>,\n            <matplotlib.axes._subplots.AxesSubplot object at 0x1343f1ad0>]],\n          dtype=object)\n\n\n\n\n![png](data/output_25_1.png)\n\n\n\n```python\nsns.distplot(df['Total day calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e4f8810>\n\n\n\n\n![png](data/output_26_1.png)\n\n\n当然，还可以使用 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `distplot()`</i>](https://seaborn.pydata.org/generated/seaborn.distplot.html) 方法观测数值变量的分布。例如，Total day minutes 每日通话时长 的分布。默认情况下，该方法将同时显示直方图和密度图。\n\n\n```python\nsns.distplot(df['Total intl calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e5134d0>\n\n\n\n\n![png](data/output_28_1.png)\n\n\n上图中直方图的柱形高度已进行归一化处理，表示的是密度而不是样本数。\n\n#### 箱型图\n\n箱形图的主要组成部分是箱子（box），须（whisker）和一些单独的数据点（离群值），分别简单介绍如下：\n\n- 箱子显示了分布的四分位距，它的长度由 $25th \\, （\\text{Q1，下四分位数}）$ 和 $75th \\, （\\text{Q3，上四分位数}）$ 决定，箱中的水平线表示中位数  （$50\\%$）。\n- 须是从箱子处延伸出来的线，它们表示数据点的总体散布，具体而言，是位于区间 $（\\text{Q1} - 1.5 \\cdot \\text{IQR}, \\text{Q3} + 1.5 \\cdot \\text{IQR}）$的数据点，其中 $\\text{IQR} = \\text{Q3} - \\text{Q1}$，也就是四分位距。\n- 离群值是须之外的数据点，它们作为单独的数据点，沿着中轴绘制。\n\n使用 seaborn 的 `boxplot()` 方法绘制箱形图。\n\n\n```python\nsns.boxplot(df['Total intl calls'])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x12e6e1750>\n\n\n\n\n![png](data/output_34_1.png)\n\n\n上图表明，在该数据集中，大量的国际呼叫是相当少见的。\n\n#### 提琴形图\n\n我们最后考虑的分布图形是提琴形图（violin plot）。提琴形图和箱形图的区别是，提琴形图聚焦于平滑后的整体分布，而箱形图显示了单独样本的特定统计数据。\n\n使用 `violinplot()` 方法绘制提琴形图。下图左侧是箱形图，右侧是提琴形图。\n\n\n```python\nimport matplotlib.pyplot as plt\n\n_, ax = plt.subplots(1, 2, sharey=True, figsize=(10, 4))\n\nsns.boxplot(df['Total intl calls'], ax=ax[0])\nsns.violinplot(df['Total intl calls'], ax=ax[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1380219d0>\n\n\n\n\n![png](data/output_39_1.png)\n\n\n#### 数据描述\n\n\n除图形工具外，还可以使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `describe()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html) 方法来获取分布的精确数值统计。\n\n\n```python\ndf[features].describe()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Total day minutes</th>\n      <th>Total intl calls</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>179.775098</td>\n      <td>4.479448</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>54.467389</td>\n      <td>2.461214</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>143.700000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>179.400000</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>216.400000</td>\n      <td>6.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>350.800000</td>\n      <td>20.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`describe()` 的输出基本上是自解释性的，25%，50% 和 75% 是相应的百分数 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> percentiles</i>](https://en.wikipedia.org/wiki/Percentile)。\n\n#### 类别特征和二元特征\n\n类别特征（categorical features take）反映了样本的某个定性属性，它具有固定数目的值，每个值将一个观测数据分配到相应的组，这些组称为类别（category）。如果类别变量的值具有顺序，称为有序（ordinal）类别变量。\n\n二元（binary）特征是类别特征的特例，其可能值有 2 个。\n\n#### 频率表\n\n让我们查看一下目标变量 Churn 离网率 的分布情况。首先，使用 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `value_counts()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html) 方法得到一张频率表。\n\n\n```python\ndf['Churn'].value_counts()\n```\n\n\n\n\n    False    2850\n    True      483\n    Name: Churn, dtype: int64\n\n\n\n上表显示，该数据集的 Churn 有 2850 个属于 False（Churn==0），有 483 个属于 True（Churn==1），数据集中忠实客户（Churn==0）和不忠实客户（Churn==1）的比例并不相等。我们将在以后的文章中看到，这种数据不平衡的情况会导致建立的分类模型存在一定的问题。在这种情况下，构建分类模型可能需要加重对「少数数据（在这里是 Churn==1）分类错误」这一情况的惩罚。\n\n#### 条形图\n\n\n频率表的图形化表示是条形图。创建条形图最简单的方法是使用 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `countplot()`</i>](https://seaborn.pydata.org/generated/seaborn.countplot.html) 函数。让我们来画出两个分类变量的分布。\n\n\n```python\nfig, ax = plt.subplots(1, 2, figsize=[10, 4])\n\nsns.countplot(df['Churn'], ax=ax[0])\nsns.countplot(df['Customer service calls'], ax=ax[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1382242d0>\n\n\n\n\n![png](data/output_53_1.png)\n\n\n条形图和直方图的区别如下：\n\n- 直方图适合查看数值变量的分布，而条形图用于查看类别特征。\n- 直方图的 X 轴是数值；条形图的 X 轴可能是任何类型，如数字、字符串、布尔值。\n- 直方图的 X 轴是一个笛卡尔坐标轴；条形图的顺序则没有事先定义。\n\n上左图清晰地表明了目标变量的失衡性。上右图则表明大部分客户最多打了 2-3 个客服电话就解决了他们的问题。不过，既然想要预测少数数据的分类（Churn==1），我们可能对少数不满意的客户的表现更感兴趣。所以让我们尝试一下更有趣的可视化方法：多变量可视化，看能否对预测有所帮助。\n\n### 多变量可视化\n\n多变量（multivariate）图形可以在单张图像中查看两个以上变量的联系，和单变量图形一样，可视化的类型取决于将要分析的变量的类型。\n\n先来看看数量变量之间的相互作用。\n\n#### 相关矩阵\n\n相关矩阵可揭示数据集中的数值变量的相关性。这一信息很重要，因为有一些机器学习算法（比如，线性回归和逻辑回归）不能很好地处理高度相关的输入变量。\n\n首先，我们使用 DataFrame 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `corr()`</i>](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html) 方法计算出每对特征间的相关性。接着，我们将所得的相关矩阵（correlation matrix）传给 seaborn 的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `heatmap()`</i>](https://seaborn.pydata.org/generated/seaborn.heatmap.html)方法，该方法根据提供的数值，渲染出一个基于色彩编码的矩阵。\n\n\n```python\nnumerical = list(set(df.columns) - set(['State', 'International plan', 'Voice mail plan', 'Area code', 'Churn', 'Customer service calls']))\n\ncorr = df[numerical].corr()\nsns.heatmap(corr)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1388bad50>\n\n\n\n\n![png](data/output_63_1.png)\n\n\n上图中，Total day charge 日话费总额 是直接基于 Total day minutes 电话的分钟数 计算得到，它被称为因变量。除了 Total day charege 外，还有 3 个因变量：Total eve charge，Total night charge，Total intl charge。这 4 个因变量并不贡献任何额外信息，我们直接去除。\n\n\n```python\nnumerical = list(set(numerical) - set(['Total day charge', 'Total eve charge', 'Total night charge', 'Total intl charge']))\n\ncorr = df[numerical].corr()\nsns.heatmap(corr)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x1396822d0>\n\n\n\n\n![png](data/output_65_1.png)\n\n\n#### 散点图\n\n散点图（scatter plot）将两个数值变量的值显示为二维空间中的笛卡尔坐标（Cartesian coordinate）。通过 matplotlib 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `scatter()`</i>](https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.scatter.html) 方法可以绘制散点图。\n\n\n```python\nplt.scatter(df['Total day minutes'], df['Total night minutes'])\n```\n\n\n\n\n    <matplotlib.collections.PathCollection at 0x139a17c10>\n\n\n\n\n![png](data/output_67_1.png)\n\n\n\n我们得到了两个正态分布变量的散点图，看起来这两个变量并不相关，因为上图的形状和轴是对齐的。\n\nseaborn 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `jointplot()`</i>](https://seaborn.pydata.org/generated/seaborn.jointplot.html) 方法在绘制散点图的同时会绘制两张直方图，某些情形下它们可能会更有用。\n\n\n```python\nsns.jointplot(df['Total day minutes'], df['Total night minutes'])\n```\n\n\n\n\n    <seaborn.axisgrid.JointGrid at 0x139888cd0>\n\n\n\n\n![png](data/output_70_1.png)\n\n\n`jointplot()` 方法还可以绘制平滑过的散点直方图。\n\n\n```python\nsns.jointplot(df['Total day minutes'], df['Total night minutes'], kind='kde', color='g')\n```\n\n\n\n\n    <seaborn.axisgrid.JointGrid at 0x139dc1890>\n\n\n\n\n![png](data/output_72_1.png)\n\n\n上图基本上就是之前讨论过的核密度图的双变量版本。\n\n#### 散点图矩阵\n\n在某些情形下，我们可能想要绘制如下所示的散点图矩阵（scatterplot matrix）。它的对角线包含变量的分布，并且每对变量的散点图填充了矩阵的其余部分。\n\n\n```python\n# %config InlineBackend.figure_format = 'png'\nsns.pairplot(df[numerical])\n```\n\n\n\n\n    <seaborn.axisgrid.PairGrid at 0x139cb5810>\n\n\n\n\n![png](data/output_76_1.png)\n\n\n#### 数量和类别\n\n为了让图形更有趣一点，可以尝试从数值和类别特征的相互作用中得到预测 Churn 的新信息，更具体地，让我们看看输入变量和目标变量 Churn 的关系。使用 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `lmplot()`</i>](https://seaborn.pydata.org/generated/seaborn.lmplot.html) 方法的 hue 参数来指定感兴趣的类别特征。\n\n\n```python\nsns.lmplot('Total day minutes', 'Total night minutes', data=df, hue='Churn', fit_reg=False)\n```\n\n\n\n\n    <seaborn.axisgrid.FacetGrid at 0x13e7df950>\n\n\n\n\n![png](data/output_79_2.png)\n\n\n看起来不忠实客户偏向右上角，也就是倾向于在白天和夜间打更多电话的客户。当然，这不是非常明显，我们也不会基于这一图形下任何确定性的结论。\n\n现在，创建箱形图，以可视化忠实客户（Churn=0）和离网客户（Churn=1）这两个互斥分组中数值变量分布的统计数据。\n\n\n```python\nnumerical.append('Customer service calls')\nprint(numerical)\nfig, axes = plt.subplots(3, 4, figsize=[10, 7])\nfor index, feat in enumerate(numerical):\n    ax = axes[int(index / 4), index % 4]\n    sns.boxplot(df['Churn'], df[feat], ax=ax)\n    ax.set_xlabel('')\n    ax.set_ylabel(feat)\nfig.tight_layout()\n```\n\n    ['Total day minutes', 'Total night minutes', 'Number vmail messages', 'Total eve calls', 'Account length', 'Total intl calls', 'Total eve minutes', 'Total night calls', 'Total day calls', 'Total intl minutes', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls', 'Customer service calls']\n\n\n\n    ---------------------------------------------------------------------------\n\n    IndexError                                Traceback (most recent call last)\n\n    <ipython-input-47-539701aff8ff> in <module>\n          3 fig, axes = plt.subplots(3, 4, figsize=[10, 7])\n          4 for index, feat in enumerate(numerical):\n    ----> 5     ax = axes[int(index / 4), index % 4]\n          6     sns.boxplot(df['Churn'], df[feat], ax=ax)\n          7     ax.set_xlabel('')\n\n\n    IndexError: index 3 is out of bounds for axis 0 with size 3\n\n\n\n![png](data/output_82_2.png)\n\n\n上面的图表表明，两组之间分歧最大的分布是这三个变量：Total day minutes 日通话分钟数、Customer service calls 客服呼叫数、Number vmail messages 语音邮件数。在后续的课程中，我们将学习如何使用随机森林（Random Forest）或梯度提升（Gradient Boosting）来判定特征对分类的重要性，届时可以清晰地看到，前两个特征对于离网预测模型而言确实非常重要。\n\n创建箱型图和提琴形图，查看忠实客户和不忠实客户的日通话分钟数。\n\n\n```python\n_, axes = plt.subplots(2, 2, sharex=True, sharey=True, figsize=[10, 8])\nsns.boxplot(x='Churn', y='Total day minutes', data=df, ax=axes[0][0])\nsns.violinplot(x='Churn', y=\"Total day minutes\", data=df, ax=axes[0][1])\nsns.boxplot(x='Churn', y='Total night minutes', data=df, ax=axes[1][0])\nsns.violinplot(x='Churn', y=\"Total night minutes\", data=df, ax=axes[1][1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x140f70290>\n\n\n\n\n![png](data/output_85_1.png)\n\n\n上图表明，不忠实客户倾向于打更多的电话。\n\n我们还可以发现一个有趣的信息：平均而言，离网客户是通讯服务更活跃的用户。或许是他们对话费不满意，所以预防离网的一个可能措施是降低通话费。当然，公司需要进行额外的经济分析，以查明这样做是否真的有利。\n\n当想要一次性分析两个类别维度下的数量变量时，可以用 seaborn 库的 [<i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> `catplot()`</i>](https://seaborn.pydata.org/generated/seaborn.factorplot.html) 函数。例如，在同一图形中可视化 Total day minutes 日通话分钟数 和两个类别变量（Churn 和 Customer service calls）的相互作用。\n\n\n```python\nsns.catplot(x='Churn', y='Total day minutes', col='Customer service calls',\n          data=df[df['Customer service calls'] < 8], kind='box', col_wrap=4, height=3, aspect=.8)\n```\n\n\n\n\n    <seaborn.axisgrid.FacetGrid at 0x140728250>\n\n\n\n\n![png](data/output_89_1.png)\n\n\n上图表明，从第 4 次客服呼叫开始，Total day minutes 日通话分钟数 可能不再是客户离网（Churn==1）的主要因素。也许，除了我们之前猜测的话费原因，还有其他问题导致客户对服务不满意，这可能会导致日通话分钟数更少。\n\n#### 类别与类别\n\n正如之前提到的，变量 Customer service calls 客服呼叫数 的重复值很多，因此，既可以看成数值变量，也可以看成有序类别变量。之前已通过计数图（count plot）查看过它的分布了，现在我们感兴趣的是这一有序特征和目标变量 Churn 离网率 之间的关系。\n\n使用 `countplot()` 方法查看客服呼叫数的分布，这次传入 `hue=Churn` 参数，以便在图形中加入类别维度。\n\n\n```python\nsns.countplot(x='Customer service calls', hue='Churn', data=df[df[\"Customer service calls\"] < 10])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x140cb7990>\n\n\n\n\n![png](data/output_94_1.png)\n\n\n上图表明，呼叫客服达到 4 次以上后，离网率显著增加了。\n\n使用 `countplot()` 方法查看 Churn 离网率 和二元特征 International plan 国际套餐、Voice mail plan 语音邮件套餐 的关系。\n\n\n```python\n_, axes = plt.subplots(1, 2, sharey=True, figsize=(10, 4))\n\nsns.countplot(x='International plan', hue='Churn', data=df, ax=axes[0])\nsns.countplot(x='Voice mail plan', hue='Churn', data=df, ax=axes[1])\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x142344290>\n\n\n\n\n![png](data/output_97_1.png)\n\n\n上图表明，开通国际套餐后，离网率会高很多，即 International plan 是否开通国际套餐 是一个重要的特征。我们在 Vocie mail plan 语音邮件套餐 特征上没有观察到类似的效果。\n\n#### 交叉表\n\n除了使用图形进行类别分析之外，还可以使用统计学的传统工具：交叉表（cross tabulation），即使用表格形式表示多个类别变量的频率分布。通过它可以查看某一列或某一行以了解某个变量在另一变量的作用下的分布情况。\n\n通过交叉表查看 Churn 离网率 和类别变量 State 州 的关系。\n\n\n```python\npd.crosstab(df['State'], df['Churn']).T\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>AK</th>\n      <th>AL</th>\n      <th>AR</th>\n      <th>AZ</th>\n      <th>CA</th>\n      <th>CO</th>\n      <th>CT</th>\n      <th>DC</th>\n      <th>DE</th>\n      <th>FL</th>\n      <th>...</th>\n      <th>SD</th>\n      <th>TN</th>\n      <th>TX</th>\n      <th>UT</th>\n      <th>VA</th>\n      <th>VT</th>\n      <th>WA</th>\n      <th>WI</th>\n      <th>WV</th>\n      <th>WY</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>49</td>\n      <td>72</td>\n      <td>44</td>\n      <td>60</td>\n      <td>25</td>\n      <td>57</td>\n      <td>62</td>\n      <td>49</td>\n      <td>52</td>\n      <td>55</td>\n      <td>...</td>\n      <td>52</td>\n      <td>48</td>\n      <td>54</td>\n      <td>62</td>\n      <td>72</td>\n      <td>65</td>\n      <td>52</td>\n      <td>71</td>\n      <td>96</td>\n      <td>68</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>3</td>\n      <td>8</td>\n      <td>11</td>\n      <td>4</td>\n      <td>9</td>\n      <td>9</td>\n      <td>12</td>\n      <td>5</td>\n      <td>9</td>\n      <td>8</td>\n      <td>...</td>\n      <td>8</td>\n      <td>5</td>\n      <td>18</td>\n      <td>10</td>\n      <td>5</td>\n      <td>8</td>\n      <td>14</td>\n      <td>7</td>\n      <td>10</td>\n      <td>9</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 51 columns</p>\n</div>\n\n\n\n上表显示，State 州 有 51 个不同的值，并且每个州只有 3 到 17 个客户抛弃了运营商。通过 `groupby()` 方法计算每个州的离网率，由高到低排列。\n\n\n```python\ndf.groupby(['State'])['Churn'].agg([np.mean]).sort_values(by='mean', ascending=False).T\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>NJ</th>\n      <th>CA</th>\n      <th>TX</th>\n      <th>MD</th>\n      <th>SC</th>\n      <th>MI</th>\n      <th>MS</th>\n      <th>NV</th>\n      <th>WA</th>\n      <th>ME</th>\n      <th>...</th>\n      <th>RI</th>\n      <th>WI</th>\n      <th>IL</th>\n      <th>NE</th>\n      <th>LA</th>\n      <th>IA</th>\n      <th>VA</th>\n      <th>AZ</th>\n      <th>AK</th>\n      <th>HI</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>mean</th>\n      <td>0.264706</td>\n      <td>0.264706</td>\n      <td>0.25</td>\n      <td>0.242857</td>\n      <td>0.233333</td>\n      <td>0.219178</td>\n      <td>0.215385</td>\n      <td>0.212121</td>\n      <td>0.212121</td>\n      <td>0.209677</td>\n      <td>...</td>\n      <td>0.092308</td>\n      <td>0.089744</td>\n      <td>0.086207</td>\n      <td>0.081967</td>\n      <td>0.078431</td>\n      <td>0.068182</td>\n      <td>0.064935</td>\n      <td>0.0625</td>\n      <td>0.057692</td>\n      <td>0.056604</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 51 columns</p>\n</div>\n\n\n\n上表显示，新泽西和加利福尼亚的离网率超过了 25%，夏威夷和阿拉斯加的离网率则不到 6%。然而，这些结论是基于极少的样本得出的，可能仅适用于这一特定数据集，不太具有泛用性。\n\n### 全局数据集可视化\n\n上面我们一直在研究数据集的不同方面（facet），通过猜测有趣的特征并一次选择少量特征进行可视化。如果我们想一次性显示所有特征并仍然能够解释生成的可视化，该怎么办？\n\n#### 降维\n\n大多数现实世界的数据集有很多特征，每一个特征都可以被看成数据空间的一个维度。因此，我们经常需要处理高维数据集，然而可视化整个高维数据集相当难。为了从整体上查看一个数据集，需要在不损失很多数据信息的前提下，降低用于可视化的维度。这一任务被称为降维（dimensionality reduction）。降维是一个无监督学习（unsupervised learning）问题，因为它需要在不借助任何监督输入（如标签）的前提下，从数据自身得到新的低维特征。\n\n主成分分析（Principal Component Analysis, PCA）是一个著名的降维方法，我们会在之后的课程中讨论它。但主成分分析的局限性在于，它是线性（linear）算法，这意味着对数据有某些特定的限制。\n\n与线性方法相对的，有许多非线性方法，统称流形学习（Manifold Learning）。著名的流形学习方法之一是 t-SNE。\n\n### 实验总结\n\n本章节首先介绍了 Pandas、Matplotlib 和 seaborn 库的一些常用可视化方法，并对客户离网数据集进行了可视化分析和 t-SNE 降维。可视化是一个相对快捷的从数据中挖掘信息的手段，因此，学习这一技术并将其纳入你的日常机器学习工具箱，是很有必要的。\n","slug":"mlsec/Python-数据探索之可视化分析","published":1,"date":"2020-05-17T08:28:04.000Z","updated":"2020-05-17T08:33:14.793Z","title":"mlsec/Python-数据探索之可视化分析","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zq006b018o7uo00z4x","content":"<h2 id=\"Python-数据可视化分析\"><a href=\"#Python-数据可视化分析\" class=\"headerlink\" title=\"Python 数据可视化分析\"></a>Python 数据可视化分析</h2><hr>\n<h4 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h4><p>在机器学习领域中，可视化是十分重要的。在开始一项新任务时，通过可视化手段探索数据能更好地帮助人们把握数据的要点。在分析模型表现和模型报告的结果时，可视化能使分析显得更加生动鲜明。有时候，为了理解复杂的模型，我们还可以将高维空间映射为视觉上更直观的二维或三维图形。</p>\n<p>总而言之，可视化是一个相对快捷的从数据中挖掘信息的手段。本文将使用 Pandas、Matplotlib、seaborn 等流行的库，带你上手可视化。</p>\n<h4 id=\"知识点\"><a href=\"#知识点\" class=\"headerlink\" title=\"知识点\"></a>知识点</h4><ul>\n<li>单变量可视化的常用方法</li>\n<li>多变量可视化的常用方法</li>\n<li>t-SNE</li>\n</ul>\n<h3 id=\"数据集\"><a href=\"#数据集\" class=\"headerlink\" title=\"数据集\"></a>数据集</h3><p>首先使用 <code>import</code> 载入相关依赖。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\">sns.set()</span><br></pre></td></tr></table></figure>\n\n<p>在第一篇文章中，我们使用的是某电信运营商的客户离网数据集，本次实验仍旧使用这个数据集。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = pd.read_csv(<span class=\"string\">'./data/telecom_churn.csv'</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>False</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>最后一个数据列 Churn 离网率 是我们的目标特征，它是布尔变量，其中 True 表示公司最终丢失了此客户，False 表示客户被保留。稍后，将构建基于其他特征预测 Churn 特征的模型。 </p>\n<h3 id=\"单变量可视化\"><a href=\"#单变量可视化\" class=\"headerlink\" title=\"单变量可视化\"></a>单变量可视化</h3><p>单变量（univariate）分析一次只关注一个变量。当我们独立地分析一个特征时，通常最关心的是该特征值的分布情况。下面考虑不同统计类型的变量，以及相应的可视化工具。</p>\n<h4 id=\"数量特征\"><a href=\"#数量特征\" class=\"headerlink\" title=\"数量特征\"></a>数量特征</h4><p>数量特征（quantitative feature）的值为有序数值。这些值可能是离散的，例如整数，也可能是连续的，例如实数。</p>\n<h4 id=\"直方图和密度图\"><a href=\"#直方图和密度图\" class=\"headerlink\" title=\"直方图和密度图\"></a>直方图和密度图</h4><p>直方图依照相等的间隔将值分组为柱，它的形状可能包含了数据分布的一些信息，如高斯分布、指数分布等。当分布总体呈现规律性，但有个别异常值时，你可以通过直方图辨认出来。当你使用的机器学习方法预设了某一特定分布类型（通常是高斯分布）时，知道特征值的分布是非常重要的。</p>\n<p>最简单的查看数值变量分布的方法是使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.hist.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>hist()</code></i></a> 方法绘制直方图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">features = [<span class=\"string\">'Total day minutes'</span>, <span class=\"string\">'Total intl calls'</span>]</span><br><span class=\"line\">df[features].hist(figsize = (<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x12e3076d0&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x12f4cbe90&gt;]],\n      dtype=object)</code></pre><p><img src=\"data/output_21_1.png\" alt=\"png\"></p>\n<p>上图表明，变量 Total day minutes 每日通话时长 呈高斯分布，而 Total intl calls 总国际呼叫数 显著右倾（它右侧的尾巴更长）。</p>\n<p>密度图（density plots），也叫核密度图（ <a href=\"https://en.wikipedia.org/wiki/Kernel_density_estimation\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> kernel density estimate</i></a>，KDE）是理解数值变量分布的另一个方法。它可以看成是直方图平滑（ <a href=\"https://en.wikipedia.org/wiki/Kernel_smoother\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> smoothed</i></a> ）的版本。相比直方图，它的主要优势是不依赖于柱的尺寸，更加清晰。</p>\n<p>让我们为上面两个变量创建密度图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[features].plot(kind=<span class=\"string\">'density'</span>, subplots=<span class=\"literal\">True</span>, layout=(<span class=\"number\">1</span>,<span class=\"number\">2</span>),</span><br><span class=\"line\">                 sharex=<span class=\"literal\">False</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>), legend=<span class=\"literal\">False</span>, title=features)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x133bcc050&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x1343f1ad0&gt;]],\n      dtype=object)</code></pre><p><img src=\"data/output_25_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.distplot(df[<span class=\"string\">'Total day calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e4f8810&gt;</code></pre><p><img src=\"data/output_26_1.png\" alt=\"png\"></p>\n<p>当然，还可以使用 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.distplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>distplot()</code></i></a> 方法观测数值变量的分布。例如，Total day minutes 每日通话时长 的分布。默认情况下，该方法将同时显示直方图和密度图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.distplot(df[<span class=\"string\">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e5134d0&gt;</code></pre><p><img src=\"data/output_28_1.png\" alt=\"png\"></p>\n<p>上图中直方图的柱形高度已进行归一化处理，表示的是密度而不是样本数。</p>\n<h4 id=\"箱型图\"><a href=\"#箱型图\" class=\"headerlink\" title=\"箱型图\"></a>箱型图</h4><p>箱形图的主要组成部分是箱子（box），须（whisker）和一些单独的数据点（离群值），分别简单介绍如下：</p>\n<ul>\n<li>箱子显示了分布的四分位距，它的长度由 $25th , （\\text{Q1，下四分位数}）$ 和 $75th , （\\text{Q3，上四分位数}）$ 决定，箱中的水平线表示中位数  （$50%$）。</li>\n<li>须是从箱子处延伸出来的线，它们表示数据点的总体散布，具体而言，是位于区间 $（\\text{Q1} - 1.5 \\cdot \\text{IQR}, \\text{Q3} + 1.5 \\cdot \\text{IQR}）$的数据点，其中 $\\text{IQR} = \\text{Q3} - \\text{Q1}$，也就是四分位距。</li>\n<li>离群值是须之外的数据点，它们作为单独的数据点，沿着中轴绘制。</li>\n</ul>\n<p>使用 seaborn 的 <code>boxplot()</code> 方法绘制箱形图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.boxplot(df[<span class=\"string\">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e6e1750&gt;</code></pre><p><img src=\"data/output_34_1.png\" alt=\"png\"></p>\n<p>上图表明，在该数据集中，大量的国际呼叫是相当少见的。</p>\n<h4 id=\"提琴形图\"><a href=\"#提琴形图\" class=\"headerlink\" title=\"提琴形图\"></a>提琴形图</h4><p>我们最后考虑的分布图形是提琴形图（violin plot）。提琴形图和箱形图的区别是，提琴形图聚焦于平滑后的整体分布，而箱形图显示了单独样本的特定统计数据。</p>\n<p>使用 <code>violinplot()</code> 方法绘制提琴形图。下图左侧是箱形图，右侧是提琴形图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">_, ax = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, sharey=<span class=\"literal\">True</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">sns.boxplot(df[<span class=\"string\">'Total intl calls'</span>], ax=ax[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(df[<span class=\"string\">'Total intl calls'</span>], ax=ax[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1380219d0&gt;</code></pre><p><img src=\"data/output_39_1.png\" alt=\"png\"></p>\n<h4 id=\"数据描述\"><a href=\"#数据描述\" class=\"headerlink\" title=\"数据描述\"></a>数据描述</h4><p>除图形工具外，还可以使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>describe()</code></i></a> 方法来获取分布的精确数值统计。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[features].describe()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Total day minutes</th>\n      <th>Total intl calls</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>179.775098</td>\n      <td>4.479448</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>54.467389</td>\n      <td>2.461214</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>143.700000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>179.400000</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>216.400000</td>\n      <td>6.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>350.800000</td>\n      <td>20.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>describe()</code> 的输出基本上是自解释性的，25%，50% 和 75% 是相应的百分数 <a href=\"https://en.wikipedia.org/wiki/Percentile\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> percentiles</i></a>。</p>\n<h4 id=\"类别特征和二元特征\"><a href=\"#类别特征和二元特征\" class=\"headerlink\" title=\"类别特征和二元特征\"></a>类别特征和二元特征</h4><p>类别特征（categorical features take）反映了样本的某个定性属性，它具有固定数目的值，每个值将一个观测数据分配到相应的组，这些组称为类别（category）。如果类别变量的值具有顺序，称为有序（ordinal）类别变量。</p>\n<p>二元（binary）特征是类别特征的特例，其可能值有 2 个。</p>\n<h4 id=\"频率表\"><a href=\"#频率表\" class=\"headerlink\" title=\"频率表\"></a>频率表</h4><p>让我们查看一下目标变量 Churn 离网率 的分布情况。首先，使用 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>value_counts()</code></i></a> 方法得到一张频率表。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>False    2850\nTrue      483\nName: Churn, dtype: int64</code></pre><p>上表显示，该数据集的 Churn 有 2850 个属于 False（Churn==0），有 483 个属于 True（Churn==1），数据集中忠实客户（Churn==0）和不忠实客户（Churn==1）的比例并不相等。我们将在以后的文章中看到，这种数据不平衡的情况会导致建立的分类模型存在一定的问题。在这种情况下，构建分类模型可能需要加重对「少数数据（在这里是 Churn==1）分类错误」这一情况的惩罚。</p>\n<h4 id=\"条形图\"><a href=\"#条形图\" class=\"headerlink\" title=\"条形图\"></a>条形图</h4><p>频率表的图形化表示是条形图。创建条形图最简单的方法是使用 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.countplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>countplot()</code></i></a> 函数。让我们来画出两个分类变量的分布。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fig, ax = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">4</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">sns.countplot(df[<span class=\"string\">'Churn'</span>], ax=ax[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.countplot(df[<span class=\"string\">'Customer service calls'</span>], ax=ax[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1382242d0&gt;</code></pre><p><img src=\"data/output_53_1.png\" alt=\"png\"></p>\n<p>条形图和直方图的区别如下：</p>\n<ul>\n<li>直方图适合查看数值变量的分布，而条形图用于查看类别特征。</li>\n<li>直方图的 X 轴是数值；条形图的 X 轴可能是任何类型，如数字、字符串、布尔值。</li>\n<li>直方图的 X 轴是一个笛卡尔坐标轴；条形图的顺序则没有事先定义。</li>\n</ul>\n<p>上左图清晰地表明了目标变量的失衡性。上右图则表明大部分客户最多打了 2-3 个客服电话就解决了他们的问题。不过，既然想要预测少数数据的分类（Churn==1），我们可能对少数不满意的客户的表现更感兴趣。所以让我们尝试一下更有趣的可视化方法：多变量可视化，看能否对预测有所帮助。</p>\n<h3 id=\"多变量可视化\"><a href=\"#多变量可视化\" class=\"headerlink\" title=\"多变量可视化\"></a>多变量可视化</h3><p>多变量（multivariate）图形可以在单张图像中查看两个以上变量的联系，和单变量图形一样，可视化的类型取决于将要分析的变量的类型。</p>\n<p>先来看看数量变量之间的相互作用。</p>\n<h4 id=\"相关矩阵\"><a href=\"#相关矩阵\" class=\"headerlink\" title=\"相关矩阵\"></a>相关矩阵</h4><p>相关矩阵可揭示数据集中的数值变量的相关性。这一信息很重要，因为有一些机器学习算法（比如，线性回归和逻辑回归）不能很好地处理高度相关的输入变量。</p>\n<p>首先，我们使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>corr()</code></i></a> 方法计算出每对特征间的相关性。接着，我们将所得的相关矩阵（correlation matrix）传给 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.heatmap.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>heatmap()</code></i></a>方法，该方法根据提供的数值，渲染出一个基于色彩编码的矩阵。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical = list(set(df.columns) - set([<span class=\"string\">'State'</span>, <span class=\"string\">'International plan'</span>, <span class=\"string\">'Voice mail plan'</span>, <span class=\"string\">'Area code'</span>, <span class=\"string\">'Churn'</span>, <span class=\"string\">'Customer service calls'</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">corr = df[numerical].corr()</span><br><span class=\"line\">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1388bad50&gt;</code></pre><p><img src=\"data/output_63_1.png\" alt=\"png\"></p>\n<p>上图中，Total day charge 日话费总额 是直接基于 Total day minutes 电话的分钟数 计算得到，它被称为因变量。除了 Total day charege 外，还有 3 个因变量：Total eve charge，Total night charge，Total intl charge。这 4 个因变量并不贡献任何额外信息，我们直接去除。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical = list(set(numerical) - set([<span class=\"string\">'Total day charge'</span>, <span class=\"string\">'Total eve charge'</span>, <span class=\"string\">'Total night charge'</span>, <span class=\"string\">'Total intl charge'</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">corr = df[numerical].corr()</span><br><span class=\"line\">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1396822d0&gt;</code></pre><p><img src=\"data/output_65_1.png\" alt=\"png\"></p>\n<h4 id=\"散点图\"><a href=\"#散点图\" class=\"headerlink\" title=\"散点图\"></a>散点图</h4><p>散点图（scatter plot）将两个数值变量的值显示为二维空间中的笛卡尔坐标（Cartesian coordinate）。通过 matplotlib 库的 <a href=\"https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.scatter.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>scatter()</code></i></a> 方法可以绘制散点图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.scatter(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.collections.PathCollection at 0x139a17c10&gt;</code></pre><p><img src=\"data/output_67_1.png\" alt=\"png\"></p>\n<p>我们得到了两个正态分布变量的散点图，看起来这两个变量并不相关，因为上图的形状和轴是对齐的。</p>\n<p>seaborn 库的 <a href=\"https://seaborn.pydata.org/generated/seaborn.jointplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>jointplot()</code></i></a> 方法在绘制散点图的同时会绘制两张直方图，某些情形下它们可能会更有用。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.jointplot(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139888cd0&gt;</code></pre><p><img src=\"data/output_70_1.png\" alt=\"png\"></p>\n<p><code>jointplot()</code> 方法还可以绘制平滑过的散点直方图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.jointplot(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>], kind=<span class=\"string\">'kde'</span>, color=<span class=\"string\">'g'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139dc1890&gt;</code></pre><p><img src=\"data/output_72_1.png\" alt=\"png\"></p>\n<p>上图基本上就是之前讨论过的核密度图的双变量版本。</p>\n<h4 id=\"散点图矩阵\"><a href=\"#散点图矩阵\" class=\"headerlink\" title=\"散点图矩阵\"></a>散点图矩阵</h4><p>在某些情形下，我们可能想要绘制如下所示的散点图矩阵（scatterplot matrix）。它的对角线包含变量的分布，并且每对变量的散点图填充了矩阵的其余部分。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># %config InlineBackend.figure_format = 'png'</span></span><br><span class=\"line\">sns.pairplot(df[numerical])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x139cb5810&gt;</code></pre><p><img src=\"data/output_76_1.png\" alt=\"png\"></p>\n<h4 id=\"数量和类别\"><a href=\"#数量和类别\" class=\"headerlink\" title=\"数量和类别\"></a>数量和类别</h4><p>为了让图形更有趣一点，可以尝试从数值和类别特征的相互作用中得到预测 Churn 的新信息，更具体地，让我们看看输入变量和目标变量 Churn 的关系。使用 <a href=\"https://seaborn.pydata.org/generated/seaborn.lmplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>lmplot()</code></i></a> 方法的 hue 参数来指定感兴趣的类别特征。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.lmplot(<span class=\"string\">'Total day minutes'</span>, <span class=\"string\">'Total night minutes'</span>, data=df, hue=<span class=\"string\">'Churn'</span>, fit_reg=<span class=\"literal\">False</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x13e7df950&gt;</code></pre><p><img src=\"data/output_79_2.png\" alt=\"png\"></p>\n<p>看起来不忠实客户偏向右上角，也就是倾向于在白天和夜间打更多电话的客户。当然，这不是非常明显，我们也不会基于这一图形下任何确定性的结论。</p>\n<p>现在，创建箱形图，以可视化忠实客户（Churn=0）和离网客户（Churn=1）这两个互斥分组中数值变量分布的统计数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical.append(<span class=\"string\">'Customer service calls'</span>)</span><br><span class=\"line\">print(numerical)</span><br><span class=\"line\">fig, axes = plt.subplots(<span class=\"number\">3</span>, <span class=\"number\">4</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">7</span>])</span><br><span class=\"line\"><span class=\"keyword\">for</span> index, feat <span class=\"keyword\">in</span> enumerate(numerical):</span><br><span class=\"line\">    ax = axes[int(index / <span class=\"number\">4</span>), index % <span class=\"number\">4</span>]</span><br><span class=\"line\">    sns.boxplot(df[<span class=\"string\">'Churn'</span>], df[feat], ax=ax)</span><br><span class=\"line\">    ax.set_xlabel(<span class=\"string\">''</span>)</span><br><span class=\"line\">    ax.set_ylabel(feat)</span><br><span class=\"line\">fig.tight_layout()</span><br></pre></td></tr></table></figure>\n\n<pre><code>[&apos;Total day minutes&apos;, &apos;Total night minutes&apos;, &apos;Number vmail messages&apos;, &apos;Total eve calls&apos;, &apos;Account length&apos;, &apos;Total intl calls&apos;, &apos;Total eve minutes&apos;, &apos;Total night calls&apos;, &apos;Total day calls&apos;, &apos;Total intl minutes&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;]\n\n\n\n---------------------------------------------------------------------------\n\nIndexError                                Traceback (most recent call last)\n\n&lt;ipython-input-47-539701aff8ff&gt; in &lt;module&gt;\n      3 fig, axes = plt.subplots(3, 4, figsize=[10, 7])\n      4 for index, feat in enumerate(numerical):\n----&gt; 5     ax = axes[int(index / 4), index % 4]\n      6     sns.boxplot(df[&apos;Churn&apos;], df[feat], ax=ax)\n      7     ax.set_xlabel(&apos;&apos;)\n\n\nIndexError: index 3 is out of bounds for axis 0 with size 3</code></pre><p><img src=\"data/output_82_2.png\" alt=\"png\"></p>\n<p>上面的图表表明，两组之间分歧最大的分布是这三个变量：Total day minutes 日通话分钟数、Customer service calls 客服呼叫数、Number vmail messages 语音邮件数。在后续的课程中，我们将学习如何使用随机森林（Random Forest）或梯度提升（Gradient Boosting）来判定特征对分类的重要性，届时可以清晰地看到，前两个特征对于离网预测模型而言确实非常重要。</p>\n<p>创建箱型图和提琴形图，查看忠实客户和不忠实客户的日通话分钟数。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_, axes = plt.subplots(<span class=\"number\">2</span>, <span class=\"number\">2</span>, sharex=<span class=\"literal\">True</span>, sharey=<span class=\"literal\">True</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">8</span>])</span><br><span class=\"line\">sns.boxplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total day minutes'</span>, data=df, ax=axes[<span class=\"number\">0</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">\"Total day minutes\"</span>, data=df, ax=axes[<span class=\"number\">0</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">sns.boxplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total night minutes'</span>, data=df, ax=axes[<span class=\"number\">1</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">\"Total night minutes\"</span>, data=df, ax=axes[<span class=\"number\">1</span>][<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140f70290&gt;</code></pre><p><img src=\"data/output_85_1.png\" alt=\"png\"></p>\n<p>上图表明，不忠实客户倾向于打更多的电话。</p>\n<p>我们还可以发现一个有趣的信息：平均而言，离网客户是通讯服务更活跃的用户。或许是他们对话费不满意，所以预防离网的一个可能措施是降低通话费。当然，公司需要进行额外的经济分析，以查明这样做是否真的有利。</p>\n<p>当想要一次性分析两个类别维度下的数量变量时，可以用 seaborn 库的 <a href=\"https://seaborn.pydata.org/generated/seaborn.factorplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>catplot()</code></i></a> 函数。例如，在同一图形中可视化 Total day minutes 日通话分钟数 和两个类别变量（Churn 和 Customer service calls）的相互作用。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.catplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total day minutes'</span>, col=<span class=\"string\">'Customer service calls'</span>,</span><br><span class=\"line\">          data=df[df[<span class=\"string\">'Customer service calls'</span>] &lt; <span class=\"number\">8</span>], kind=<span class=\"string\">'box'</span>, col_wrap=<span class=\"number\">4</span>, height=<span class=\"number\">3</span>, aspect=<span class=\"number\">.8</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x140728250&gt;</code></pre><p><img src=\"data/output_89_1.png\" alt=\"png\"></p>\n<p>上图表明，从第 4 次客服呼叫开始，Total day minutes 日通话分钟数 可能不再是客户离网（Churn==1）的主要因素。也许，除了我们之前猜测的话费原因，还有其他问题导致客户对服务不满意，这可能会导致日通话分钟数更少。</p>\n<h4 id=\"类别与类别\"><a href=\"#类别与类别\" class=\"headerlink\" title=\"类别与类别\"></a>类别与类别</h4><p>正如之前提到的，变量 Customer service calls 客服呼叫数 的重复值很多，因此，既可以看成数值变量，也可以看成有序类别变量。之前已通过计数图（count plot）查看过它的分布了，现在我们感兴趣的是这一有序特征和目标变量 Churn 离网率 之间的关系。</p>\n<p>使用 <code>countplot()</code> 方法查看客服呼叫数的分布，这次传入 <code>hue=Churn</code> 参数，以便在图形中加入类别维度。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Customer service calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df[df[<span class=\"string\">\"Customer service calls\"</span>] &lt; <span class=\"number\">10</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140cb7990&gt;</code></pre><p><img src=\"data/output_94_1.png\" alt=\"png\"></p>\n<p>上图表明，呼叫客服达到 4 次以上后，离网率显著增加了。</p>\n<p>使用 <code>countplot()</code> 方法查看 Churn 离网率 和二元特征 International plan 国际套餐、Voice mail plan 语音邮件套餐 的关系。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_, axes = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, sharey=<span class=\"literal\">True</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">sns.countplot(x=<span class=\"string\">'International plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df, ax=axes[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.countplot(x=<span class=\"string\">'Voice mail plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df, ax=axes[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x142344290&gt;</code></pre><p><img src=\"data/output_97_1.png\" alt=\"png\"></p>\n<p>上图表明，开通国际套餐后，离网率会高很多，即 International plan 是否开通国际套餐 是一个重要的特征。我们在 Vocie mail plan 语音邮件套餐 特征上没有观察到类似的效果。</p>\n<h4 id=\"交叉表\"><a href=\"#交叉表\" class=\"headerlink\" title=\"交叉表\"></a>交叉表</h4><p>除了使用图形进行类别分析之外，还可以使用统计学的传统工具：交叉表（cross tabulation），即使用表格形式表示多个类别变量的频率分布。通过它可以查看某一列或某一行以了解某个变量在另一变量的作用下的分布情况。</p>\n<p>通过交叉表查看 Churn 离网率 和类别变量 State 州 的关系。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'State'</span>], df[<span class=\"string\">'Churn'</span>]).T</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>AK</th>\n      <th>AL</th>\n      <th>AR</th>\n      <th>AZ</th>\n      <th>CA</th>\n      <th>CO</th>\n      <th>CT</th>\n      <th>DC</th>\n      <th>DE</th>\n      <th>FL</th>\n      <th>...</th>\n      <th>SD</th>\n      <th>TN</th>\n      <th>TX</th>\n      <th>UT</th>\n      <th>VA</th>\n      <th>VT</th>\n      <th>WA</th>\n      <th>WI</th>\n      <th>WV</th>\n      <th>WY</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>49</td>\n      <td>72</td>\n      <td>44</td>\n      <td>60</td>\n      <td>25</td>\n      <td>57</td>\n      <td>62</td>\n      <td>49</td>\n      <td>52</td>\n      <td>55</td>\n      <td>...</td>\n      <td>52</td>\n      <td>48</td>\n      <td>54</td>\n      <td>62</td>\n      <td>72</td>\n      <td>65</td>\n      <td>52</td>\n      <td>71</td>\n      <td>96</td>\n      <td>68</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>3</td>\n      <td>8</td>\n      <td>11</td>\n      <td>4</td>\n      <td>9</td>\n      <td>9</td>\n      <td>12</td>\n      <td>5</td>\n      <td>9</td>\n      <td>8</td>\n      <td>...</td>\n      <td>8</td>\n      <td>5</td>\n      <td>18</td>\n      <td>10</td>\n      <td>5</td>\n      <td>8</td>\n      <td>14</td>\n      <td>7</td>\n      <td>10</td>\n      <td>9</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 51 columns</p>\n</div>\n\n\n\n<p>上表显示，State 州 有 51 个不同的值，并且每个州只有 3 到 17 个客户抛弃了运营商。通过 <code>groupby()</code> 方法计算每个州的离网率，由高到低排列。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.groupby([<span class=\"string\">'State'</span>])[<span class=\"string\">'Churn'</span>].agg([np.mean]).sort_values(by=<span class=\"string\">'mean'</span>, ascending=<span class=\"literal\">False</span>).T</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>NJ</th>\n      <th>CA</th>\n      <th>TX</th>\n      <th>MD</th>\n      <th>SC</th>\n      <th>MI</th>\n      <th>MS</th>\n      <th>NV</th>\n      <th>WA</th>\n      <th>ME</th>\n      <th>...</th>\n      <th>RI</th>\n      <th>WI</th>\n      <th>IL</th>\n      <th>NE</th>\n      <th>LA</th>\n      <th>IA</th>\n      <th>VA</th>\n      <th>AZ</th>\n      <th>AK</th>\n      <th>HI</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>mean</th>\n      <td>0.264706</td>\n      <td>0.264706</td>\n      <td>0.25</td>\n      <td>0.242857</td>\n      <td>0.233333</td>\n      <td>0.219178</td>\n      <td>0.215385</td>\n      <td>0.212121</td>\n      <td>0.212121</td>\n      <td>0.209677</td>\n      <td>...</td>\n      <td>0.092308</td>\n      <td>0.089744</td>\n      <td>0.086207</td>\n      <td>0.081967</td>\n      <td>0.078431</td>\n      <td>0.068182</td>\n      <td>0.064935</td>\n      <td>0.0625</td>\n      <td>0.057692</td>\n      <td>0.056604</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 51 columns</p>\n</div>\n\n\n\n<p>上表显示，新泽西和加利福尼亚的离网率超过了 25%，夏威夷和阿拉斯加的离网率则不到 6%。然而，这些结论是基于极少的样本得出的，可能仅适用于这一特定数据集，不太具有泛用性。</p>\n<h3 id=\"全局数据集可视化\"><a href=\"#全局数据集可视化\" class=\"headerlink\" title=\"全局数据集可视化\"></a>全局数据集可视化</h3><p>上面我们一直在研究数据集的不同方面（facet），通过猜测有趣的特征并一次选择少量特征进行可视化。如果我们想一次性显示所有特征并仍然能够解释生成的可视化，该怎么办？</p>\n<h4 id=\"降维\"><a href=\"#降维\" class=\"headerlink\" title=\"降维\"></a>降维</h4><p>大多数现实世界的数据集有很多特征，每一个特征都可以被看成数据空间的一个维度。因此，我们经常需要处理高维数据集，然而可视化整个高维数据集相当难。为了从整体上查看一个数据集，需要在不损失很多数据信息的前提下，降低用于可视化的维度。这一任务被称为降维（dimensionality reduction）。降维是一个无监督学习（unsupervised learning）问题，因为它需要在不借助任何监督输入（如标签）的前提下，从数据自身得到新的低维特征。</p>\n<p>主成分分析（Principal Component Analysis, PCA）是一个著名的降维方法，我们会在之后的课程中讨论它。但主成分分析的局限性在于，它是线性（linear）算法，这意味着对数据有某些特定的限制。</p>\n<p>与线性方法相对的，有许多非线性方法，统称流形学习（Manifold Learning）。著名的流形学习方法之一是 t-SNE。</p>\n<h3 id=\"实验总结\"><a href=\"#实验总结\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h3><p>本章节首先介绍了 Pandas、Matplotlib 和 seaborn 库的一些常用可视化方法，并对客户离网数据集进行了可视化分析和 t-SNE 降维。可视化是一个相对快捷的从数据中挖掘信息的手段，因此，学习这一技术并将其纳入你的日常机器学习工具箱，是很有必要的。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Python-数据可视化分析\"><a href=\"#Python-数据可视化分析\" class=\"headerlink\" title=\"Python 数据可视化分析\"></a>Python 数据可视化分析</h2><hr>\n<h4 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h4><p>在机器学习领域中，可视化是十分重要的。在开始一项新任务时，通过可视化手段探索数据能更好地帮助人们把握数据的要点。在分析模型表现和模型报告的结果时，可视化能使分析显得更加生动鲜明。有时候，为了理解复杂的模型，我们还可以将高维空间映射为视觉上更直观的二维或三维图形。</p>\n<p>总而言之，可视化是一个相对快捷的从数据中挖掘信息的手段。本文将使用 Pandas、Matplotlib、seaborn 等流行的库，带你上手可视化。</p>\n<h4 id=\"知识点\"><a href=\"#知识点\" class=\"headerlink\" title=\"知识点\"></a>知识点</h4><ul>\n<li>单变量可视化的常用方法</li>\n<li>多变量可视化的常用方法</li>\n<li>t-SNE</li>\n</ul>\n<h3 id=\"数据集\"><a href=\"#数据集\" class=\"headerlink\" title=\"数据集\"></a>数据集</h3><p>首先使用 <code>import</code> 载入相关依赖。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\">sns.set()</span><br></pre></td></tr></table></figure>\n\n<p>在第一篇文章中，我们使用的是某电信运营商的客户离网数据集，本次实验仍旧使用这个数据集。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = pd.read_csv(<span class=\"string\">'./data/telecom_churn.csv'</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>False</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>False</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>最后一个数据列 Churn 离网率 是我们的目标特征，它是布尔变量，其中 True 表示公司最终丢失了此客户，False 表示客户被保留。稍后，将构建基于其他特征预测 Churn 特征的模型。 </p>\n<h3 id=\"单变量可视化\"><a href=\"#单变量可视化\" class=\"headerlink\" title=\"单变量可视化\"></a>单变量可视化</h3><p>单变量（univariate）分析一次只关注一个变量。当我们独立地分析一个特征时，通常最关心的是该特征值的分布情况。下面考虑不同统计类型的变量，以及相应的可视化工具。</p>\n<h4 id=\"数量特征\"><a href=\"#数量特征\" class=\"headerlink\" title=\"数量特征\"></a>数量特征</h4><p>数量特征（quantitative feature）的值为有序数值。这些值可能是离散的，例如整数，也可能是连续的，例如实数。</p>\n<h4 id=\"直方图和密度图\"><a href=\"#直方图和密度图\" class=\"headerlink\" title=\"直方图和密度图\"></a>直方图和密度图</h4><p>直方图依照相等的间隔将值分组为柱，它的形状可能包含了数据分布的一些信息，如高斯分布、指数分布等。当分布总体呈现规律性，但有个别异常值时，你可以通过直方图辨认出来。当你使用的机器学习方法预设了某一特定分布类型（通常是高斯分布）时，知道特征值的分布是非常重要的。</p>\n<p>最简单的查看数值变量分布的方法是使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.hist.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>hist()</code></i></a> 方法绘制直方图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">features = [<span class=\"string\">'Total day minutes'</span>, <span class=\"string\">'Total intl calls'</span>]</span><br><span class=\"line\">df[features].hist(figsize = (<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x12e3076d0&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x12f4cbe90&gt;]],\n      dtype=object)</code></pre><p><img src=\"data/output_21_1.png\" alt=\"png\"></p>\n<p>上图表明，变量 Total day minutes 每日通话时长 呈高斯分布，而 Total intl calls 总国际呼叫数 显著右倾（它右侧的尾巴更长）。</p>\n<p>密度图（density plots），也叫核密度图（ <a href=\"https://en.wikipedia.org/wiki/Kernel_density_estimation\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> kernel density estimate</i></a>，KDE）是理解数值变量分布的另一个方法。它可以看成是直方图平滑（ <a href=\"https://en.wikipedia.org/wiki/Kernel_smoother\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> smoothed</i></a> ）的版本。相比直方图，它的主要优势是不依赖于柱的尺寸，更加清晰。</p>\n<p>让我们为上面两个变量创建密度图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[features].plot(kind=<span class=\"string\">'density'</span>, subplots=<span class=\"literal\">True</span>, layout=(<span class=\"number\">1</span>,<span class=\"number\">2</span>),</span><br><span class=\"line\">                 sharex=<span class=\"literal\">False</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>), legend=<span class=\"literal\">False</span>, title=features)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x133bcc050&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x1343f1ad0&gt;]],\n      dtype=object)</code></pre><p><img src=\"data/output_25_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.distplot(df[<span class=\"string\">'Total day calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e4f8810&gt;</code></pre><p><img src=\"data/output_26_1.png\" alt=\"png\"></p>\n<p>当然，还可以使用 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.distplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>distplot()</code></i></a> 方法观测数值变量的分布。例如，Total day minutes 每日通话时长 的分布。默认情况下，该方法将同时显示直方图和密度图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.distplot(df[<span class=\"string\">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e5134d0&gt;</code></pre><p><img src=\"data/output_28_1.png\" alt=\"png\"></p>\n<p>上图中直方图的柱形高度已进行归一化处理，表示的是密度而不是样本数。</p>\n<h4 id=\"箱型图\"><a href=\"#箱型图\" class=\"headerlink\" title=\"箱型图\"></a>箱型图</h4><p>箱形图的主要组成部分是箱子（box），须（whisker）和一些单独的数据点（离群值），分别简单介绍如下：</p>\n<ul>\n<li>箱子显示了分布的四分位距，它的长度由 $25th , （\\text{Q1，下四分位数}）$ 和 $75th , （\\text{Q3，上四分位数}）$ 决定，箱中的水平线表示中位数  （$50%$）。</li>\n<li>须是从箱子处延伸出来的线，它们表示数据点的总体散布，具体而言，是位于区间 $（\\text{Q1} - 1.5 \\cdot \\text{IQR}, \\text{Q3} + 1.5 \\cdot \\text{IQR}）$的数据点，其中 $\\text{IQR} = \\text{Q3} - \\text{Q1}$，也就是四分位距。</li>\n<li>离群值是须之外的数据点，它们作为单独的数据点，沿着中轴绘制。</li>\n</ul>\n<p>使用 seaborn 的 <code>boxplot()</code> 方法绘制箱形图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.boxplot(df[<span class=\"string\">'Total intl calls'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x12e6e1750&gt;</code></pre><p><img src=\"data/output_34_1.png\" alt=\"png\"></p>\n<p>上图表明，在该数据集中，大量的国际呼叫是相当少见的。</p>\n<h4 id=\"提琴形图\"><a href=\"#提琴形图\" class=\"headerlink\" title=\"提琴形图\"></a>提琴形图</h4><p>我们最后考虑的分布图形是提琴形图（violin plot）。提琴形图和箱形图的区别是，提琴形图聚焦于平滑后的整体分布，而箱形图显示了单独样本的特定统计数据。</p>\n<p>使用 <code>violinplot()</code> 方法绘制提琴形图。下图左侧是箱形图，右侧是提琴形图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">_, ax = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, sharey=<span class=\"literal\">True</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">sns.boxplot(df[<span class=\"string\">'Total intl calls'</span>], ax=ax[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(df[<span class=\"string\">'Total intl calls'</span>], ax=ax[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1380219d0&gt;</code></pre><p><img src=\"data/output_39_1.png\" alt=\"png\"></p>\n<h4 id=\"数据描述\"><a href=\"#数据描述\" class=\"headerlink\" title=\"数据描述\"></a>数据描述</h4><p>除图形工具外，还可以使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>describe()</code></i></a> 方法来获取分布的精确数值统计。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[features].describe()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Total day minutes</th>\n      <th>Total intl calls</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>179.775098</td>\n      <td>4.479448</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>54.467389</td>\n      <td>2.461214</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>143.700000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>179.400000</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>216.400000</td>\n      <td>6.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>350.800000</td>\n      <td>20.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>describe()</code> 的输出基本上是自解释性的，25%，50% 和 75% 是相应的百分数 <a href=\"https://en.wikipedia.org/wiki/Percentile\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> percentiles</i></a>。</p>\n<h4 id=\"类别特征和二元特征\"><a href=\"#类别特征和二元特征\" class=\"headerlink\" title=\"类别特征和二元特征\"></a>类别特征和二元特征</h4><p>类别特征（categorical features take）反映了样本的某个定性属性，它具有固定数目的值，每个值将一个观测数据分配到相应的组，这些组称为类别（category）。如果类别变量的值具有顺序，称为有序（ordinal）类别变量。</p>\n<p>二元（binary）特征是类别特征的特例，其可能值有 2 个。</p>\n<h4 id=\"频率表\"><a href=\"#频率表\" class=\"headerlink\" title=\"频率表\"></a>频率表</h4><p>让我们查看一下目标变量 Churn 离网率 的分布情况。首先，使用 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>value_counts()</code></i></a> 方法得到一张频率表。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>False    2850\nTrue      483\nName: Churn, dtype: int64</code></pre><p>上表显示，该数据集的 Churn 有 2850 个属于 False（Churn==0），有 483 个属于 True（Churn==1），数据集中忠实客户（Churn==0）和不忠实客户（Churn==1）的比例并不相等。我们将在以后的文章中看到，这种数据不平衡的情况会导致建立的分类模型存在一定的问题。在这种情况下，构建分类模型可能需要加重对「少数数据（在这里是 Churn==1）分类错误」这一情况的惩罚。</p>\n<h4 id=\"条形图\"><a href=\"#条形图\" class=\"headerlink\" title=\"条形图\"></a>条形图</h4><p>频率表的图形化表示是条形图。创建条形图最简单的方法是使用 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.countplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>countplot()</code></i></a> 函数。让我们来画出两个分类变量的分布。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fig, ax = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">4</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">sns.countplot(df[<span class=\"string\">'Churn'</span>], ax=ax[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.countplot(df[<span class=\"string\">'Customer service calls'</span>], ax=ax[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1382242d0&gt;</code></pre><p><img src=\"data/output_53_1.png\" alt=\"png\"></p>\n<p>条形图和直方图的区别如下：</p>\n<ul>\n<li>直方图适合查看数值变量的分布，而条形图用于查看类别特征。</li>\n<li>直方图的 X 轴是数值；条形图的 X 轴可能是任何类型，如数字、字符串、布尔值。</li>\n<li>直方图的 X 轴是一个笛卡尔坐标轴；条形图的顺序则没有事先定义。</li>\n</ul>\n<p>上左图清晰地表明了目标变量的失衡性。上右图则表明大部分客户最多打了 2-3 个客服电话就解决了他们的问题。不过，既然想要预测少数数据的分类（Churn==1），我们可能对少数不满意的客户的表现更感兴趣。所以让我们尝试一下更有趣的可视化方法：多变量可视化，看能否对预测有所帮助。</p>\n<h3 id=\"多变量可视化\"><a href=\"#多变量可视化\" class=\"headerlink\" title=\"多变量可视化\"></a>多变量可视化</h3><p>多变量（multivariate）图形可以在单张图像中查看两个以上变量的联系，和单变量图形一样，可视化的类型取决于将要分析的变量的类型。</p>\n<p>先来看看数量变量之间的相互作用。</p>\n<h4 id=\"相关矩阵\"><a href=\"#相关矩阵\" class=\"headerlink\" title=\"相关矩阵\"></a>相关矩阵</h4><p>相关矩阵可揭示数据集中的数值变量的相关性。这一信息很重要，因为有一些机器学习算法（比如，线性回归和逻辑回归）不能很好地处理高度相关的输入变量。</p>\n<p>首先，我们使用 DataFrame 的 <a href=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>corr()</code></i></a> 方法计算出每对特征间的相关性。接着，我们将所得的相关矩阵（correlation matrix）传给 seaborn 的 <a href=\"https://seaborn.pydata.org/generated/seaborn.heatmap.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>heatmap()</code></i></a>方法，该方法根据提供的数值，渲染出一个基于色彩编码的矩阵。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical = list(set(df.columns) - set([<span class=\"string\">'State'</span>, <span class=\"string\">'International plan'</span>, <span class=\"string\">'Voice mail plan'</span>, <span class=\"string\">'Area code'</span>, <span class=\"string\">'Churn'</span>, <span class=\"string\">'Customer service calls'</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">corr = df[numerical].corr()</span><br><span class=\"line\">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1388bad50&gt;</code></pre><p><img src=\"data/output_63_1.png\" alt=\"png\"></p>\n<p>上图中，Total day charge 日话费总额 是直接基于 Total day minutes 电话的分钟数 计算得到，它被称为因变量。除了 Total day charege 外，还有 3 个因变量：Total eve charge，Total night charge，Total intl charge。这 4 个因变量并不贡献任何额外信息，我们直接去除。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical = list(set(numerical) - set([<span class=\"string\">'Total day charge'</span>, <span class=\"string\">'Total eve charge'</span>, <span class=\"string\">'Total night charge'</span>, <span class=\"string\">'Total intl charge'</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">corr = df[numerical].corr()</span><br><span class=\"line\">sns.heatmap(corr)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1396822d0&gt;</code></pre><p><img src=\"data/output_65_1.png\" alt=\"png\"></p>\n<h4 id=\"散点图\"><a href=\"#散点图\" class=\"headerlink\" title=\"散点图\"></a>散点图</h4><p>散点图（scatter plot）将两个数值变量的值显示为二维空间中的笛卡尔坐标（Cartesian coordinate）。通过 matplotlib 库的 <a href=\"https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.scatter.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>scatter()</code></i></a> 方法可以绘制散点图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plt.scatter(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.collections.PathCollection at 0x139a17c10&gt;</code></pre><p><img src=\"data/output_67_1.png\" alt=\"png\"></p>\n<p>我们得到了两个正态分布变量的散点图，看起来这两个变量并不相关，因为上图的形状和轴是对齐的。</p>\n<p>seaborn 库的 <a href=\"https://seaborn.pydata.org/generated/seaborn.jointplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>jointplot()</code></i></a> 方法在绘制散点图的同时会绘制两张直方图，某些情形下它们可能会更有用。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.jointplot(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139888cd0&gt;</code></pre><p><img src=\"data/output_70_1.png\" alt=\"png\"></p>\n<p><code>jointplot()</code> 方法还可以绘制平滑过的散点直方图。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.jointplot(df[<span class=\"string\">'Total day minutes'</span>], df[<span class=\"string\">'Total night minutes'</span>], kind=<span class=\"string\">'kde'</span>, color=<span class=\"string\">'g'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.JointGrid at 0x139dc1890&gt;</code></pre><p><img src=\"data/output_72_1.png\" alt=\"png\"></p>\n<p>上图基本上就是之前讨论过的核密度图的双变量版本。</p>\n<h4 id=\"散点图矩阵\"><a href=\"#散点图矩阵\" class=\"headerlink\" title=\"散点图矩阵\"></a>散点图矩阵</h4><p>在某些情形下，我们可能想要绘制如下所示的散点图矩阵（scatterplot matrix）。它的对角线包含变量的分布，并且每对变量的散点图填充了矩阵的其余部分。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># %config InlineBackend.figure_format = 'png'</span></span><br><span class=\"line\">sns.pairplot(df[numerical])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x139cb5810&gt;</code></pre><p><img src=\"data/output_76_1.png\" alt=\"png\"></p>\n<h4 id=\"数量和类别\"><a href=\"#数量和类别\" class=\"headerlink\" title=\"数量和类别\"></a>数量和类别</h4><p>为了让图形更有趣一点，可以尝试从数值和类别特征的相互作用中得到预测 Churn 的新信息，更具体地，让我们看看输入变量和目标变量 Churn 的关系。使用 <a href=\"https://seaborn.pydata.org/generated/seaborn.lmplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>lmplot()</code></i></a> 方法的 hue 参数来指定感兴趣的类别特征。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.lmplot(<span class=\"string\">'Total day minutes'</span>, <span class=\"string\">'Total night minutes'</span>, data=df, hue=<span class=\"string\">'Churn'</span>, fit_reg=<span class=\"literal\">False</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x13e7df950&gt;</code></pre><p><img src=\"data/output_79_2.png\" alt=\"png\"></p>\n<p>看起来不忠实客户偏向右上角，也就是倾向于在白天和夜间打更多电话的客户。当然，这不是非常明显，我们也不会基于这一图形下任何确定性的结论。</p>\n<p>现在，创建箱形图，以可视化忠实客户（Churn=0）和离网客户（Churn=1）这两个互斥分组中数值变量分布的统计数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numerical.append(<span class=\"string\">'Customer service calls'</span>)</span><br><span class=\"line\">print(numerical)</span><br><span class=\"line\">fig, axes = plt.subplots(<span class=\"number\">3</span>, <span class=\"number\">4</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">7</span>])</span><br><span class=\"line\"><span class=\"keyword\">for</span> index, feat <span class=\"keyword\">in</span> enumerate(numerical):</span><br><span class=\"line\">    ax = axes[int(index / <span class=\"number\">4</span>), index % <span class=\"number\">4</span>]</span><br><span class=\"line\">    sns.boxplot(df[<span class=\"string\">'Churn'</span>], df[feat], ax=ax)</span><br><span class=\"line\">    ax.set_xlabel(<span class=\"string\">''</span>)</span><br><span class=\"line\">    ax.set_ylabel(feat)</span><br><span class=\"line\">fig.tight_layout()</span><br></pre></td></tr></table></figure>\n\n<pre><code>[&apos;Total day minutes&apos;, &apos;Total night minutes&apos;, &apos;Number vmail messages&apos;, &apos;Total eve calls&apos;, &apos;Account length&apos;, &apos;Total intl calls&apos;, &apos;Total eve minutes&apos;, &apos;Total night calls&apos;, &apos;Total day calls&apos;, &apos;Total intl minutes&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;, &apos;Customer service calls&apos;]\n\n\n\n---------------------------------------------------------------------------\n\nIndexError                                Traceback (most recent call last)\n\n&lt;ipython-input-47-539701aff8ff&gt; in &lt;module&gt;\n      3 fig, axes = plt.subplots(3, 4, figsize=[10, 7])\n      4 for index, feat in enumerate(numerical):\n----&gt; 5     ax = axes[int(index / 4), index % 4]\n      6     sns.boxplot(df[&apos;Churn&apos;], df[feat], ax=ax)\n      7     ax.set_xlabel(&apos;&apos;)\n\n\nIndexError: index 3 is out of bounds for axis 0 with size 3</code></pre><p><img src=\"data/output_82_2.png\" alt=\"png\"></p>\n<p>上面的图表表明，两组之间分歧最大的分布是这三个变量：Total day minutes 日通话分钟数、Customer service calls 客服呼叫数、Number vmail messages 语音邮件数。在后续的课程中，我们将学习如何使用随机森林（Random Forest）或梯度提升（Gradient Boosting）来判定特征对分类的重要性，届时可以清晰地看到，前两个特征对于离网预测模型而言确实非常重要。</p>\n<p>创建箱型图和提琴形图，查看忠实客户和不忠实客户的日通话分钟数。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_, axes = plt.subplots(<span class=\"number\">2</span>, <span class=\"number\">2</span>, sharex=<span class=\"literal\">True</span>, sharey=<span class=\"literal\">True</span>, figsize=[<span class=\"number\">10</span>, <span class=\"number\">8</span>])</span><br><span class=\"line\">sns.boxplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total day minutes'</span>, data=df, ax=axes[<span class=\"number\">0</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">\"Total day minutes\"</span>, data=df, ax=axes[<span class=\"number\">0</span>][<span class=\"number\">1</span>])</span><br><span class=\"line\">sns.boxplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total night minutes'</span>, data=df, ax=axes[<span class=\"number\">1</span>][<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.violinplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">\"Total night minutes\"</span>, data=df, ax=axes[<span class=\"number\">1</span>][<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140f70290&gt;</code></pre><p><img src=\"data/output_85_1.png\" alt=\"png\"></p>\n<p>上图表明，不忠实客户倾向于打更多的电话。</p>\n<p>我们还可以发现一个有趣的信息：平均而言，离网客户是通讯服务更活跃的用户。或许是他们对话费不满意，所以预防离网的一个可能措施是降低通话费。当然，公司需要进行额外的经济分析，以查明这样做是否真的有利。</p>\n<p>当想要一次性分析两个类别维度下的数量变量时，可以用 seaborn 库的 <a href=\"https://seaborn.pydata.org/generated/seaborn.factorplot.html\" target=\"_blank\" rel=\"noopener\"><i class=\"fa fa-external-link-square\" aria-hidden=\"true\"> <code>catplot()</code></i></a> 函数。例如，在同一图形中可视化 Total day minutes 日通话分钟数 和两个类别变量（Churn 和 Customer service calls）的相互作用。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.catplot(x=<span class=\"string\">'Churn'</span>, y=<span class=\"string\">'Total day minutes'</span>, col=<span class=\"string\">'Customer service calls'</span>,</span><br><span class=\"line\">          data=df[df[<span class=\"string\">'Customer service calls'</span>] &lt; <span class=\"number\">8</span>], kind=<span class=\"string\">'box'</span>, col_wrap=<span class=\"number\">4</span>, height=<span class=\"number\">3</span>, aspect=<span class=\"number\">.8</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x140728250&gt;</code></pre><p><img src=\"data/output_89_1.png\" alt=\"png\"></p>\n<p>上图表明，从第 4 次客服呼叫开始，Total day minutes 日通话分钟数 可能不再是客户离网（Churn==1）的主要因素。也许，除了我们之前猜测的话费原因，还有其他问题导致客户对服务不满意，这可能会导致日通话分钟数更少。</p>\n<h4 id=\"类别与类别\"><a href=\"#类别与类别\" class=\"headerlink\" title=\"类别与类别\"></a>类别与类别</h4><p>正如之前提到的，变量 Customer service calls 客服呼叫数 的重复值很多，因此，既可以看成数值变量，也可以看成有序类别变量。之前已通过计数图（count plot）查看过它的分布了，现在我们感兴趣的是这一有序特征和目标变量 Churn 离网率 之间的关系。</p>\n<p>使用 <code>countplot()</code> 方法查看客服呼叫数的分布，这次传入 <code>hue=Churn</code> 参数，以便在图形中加入类别维度。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Customer service calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df[df[<span class=\"string\">\"Customer service calls\"</span>] &lt; <span class=\"number\">10</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x140cb7990&gt;</code></pre><p><img src=\"data/output_94_1.png\" alt=\"png\"></p>\n<p>上图表明，呼叫客服达到 4 次以上后，离网率显著增加了。</p>\n<p>使用 <code>countplot()</code> 方法查看 Churn 离网率 和二元特征 International plan 国际套餐、Voice mail plan 语音邮件套餐 的关系。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_, axes = plt.subplots(<span class=\"number\">1</span>, <span class=\"number\">2</span>, sharey=<span class=\"literal\">True</span>, figsize=(<span class=\"number\">10</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">sns.countplot(x=<span class=\"string\">'International plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df, ax=axes[<span class=\"number\">0</span>])</span><br><span class=\"line\">sns.countplot(x=<span class=\"string\">'Voice mail plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df, ax=axes[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x142344290&gt;</code></pre><p><img src=\"data/output_97_1.png\" alt=\"png\"></p>\n<p>上图表明，开通国际套餐后，离网率会高很多，即 International plan 是否开通国际套餐 是一个重要的特征。我们在 Vocie mail plan 语音邮件套餐 特征上没有观察到类似的效果。</p>\n<h4 id=\"交叉表\"><a href=\"#交叉表\" class=\"headerlink\" title=\"交叉表\"></a>交叉表</h4><p>除了使用图形进行类别分析之外，还可以使用统计学的传统工具：交叉表（cross tabulation），即使用表格形式表示多个类别变量的频率分布。通过它可以查看某一列或某一行以了解某个变量在另一变量的作用下的分布情况。</p>\n<p>通过交叉表查看 Churn 离网率 和类别变量 State 州 的关系。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'State'</span>], df[<span class=\"string\">'Churn'</span>]).T</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>AK</th>\n      <th>AL</th>\n      <th>AR</th>\n      <th>AZ</th>\n      <th>CA</th>\n      <th>CO</th>\n      <th>CT</th>\n      <th>DC</th>\n      <th>DE</th>\n      <th>FL</th>\n      <th>...</th>\n      <th>SD</th>\n      <th>TN</th>\n      <th>TX</th>\n      <th>UT</th>\n      <th>VA</th>\n      <th>VT</th>\n      <th>WA</th>\n      <th>WI</th>\n      <th>WV</th>\n      <th>WY</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>49</td>\n      <td>72</td>\n      <td>44</td>\n      <td>60</td>\n      <td>25</td>\n      <td>57</td>\n      <td>62</td>\n      <td>49</td>\n      <td>52</td>\n      <td>55</td>\n      <td>...</td>\n      <td>52</td>\n      <td>48</td>\n      <td>54</td>\n      <td>62</td>\n      <td>72</td>\n      <td>65</td>\n      <td>52</td>\n      <td>71</td>\n      <td>96</td>\n      <td>68</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>3</td>\n      <td>8</td>\n      <td>11</td>\n      <td>4</td>\n      <td>9</td>\n      <td>9</td>\n      <td>12</td>\n      <td>5</td>\n      <td>9</td>\n      <td>8</td>\n      <td>...</td>\n      <td>8</td>\n      <td>5</td>\n      <td>18</td>\n      <td>10</td>\n      <td>5</td>\n      <td>8</td>\n      <td>14</td>\n      <td>7</td>\n      <td>10</td>\n      <td>9</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 51 columns</p>\n</div>\n\n\n\n<p>上表显示，State 州 有 51 个不同的值，并且每个州只有 3 到 17 个客户抛弃了运营商。通过 <code>groupby()</code> 方法计算每个州的离网率，由高到低排列。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.groupby([<span class=\"string\">'State'</span>])[<span class=\"string\">'Churn'</span>].agg([np.mean]).sort_values(by=<span class=\"string\">'mean'</span>, ascending=<span class=\"literal\">False</span>).T</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>State</th>\n      <th>NJ</th>\n      <th>CA</th>\n      <th>TX</th>\n      <th>MD</th>\n      <th>SC</th>\n      <th>MI</th>\n      <th>MS</th>\n      <th>NV</th>\n      <th>WA</th>\n      <th>ME</th>\n      <th>...</th>\n      <th>RI</th>\n      <th>WI</th>\n      <th>IL</th>\n      <th>NE</th>\n      <th>LA</th>\n      <th>IA</th>\n      <th>VA</th>\n      <th>AZ</th>\n      <th>AK</th>\n      <th>HI</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>mean</th>\n      <td>0.264706</td>\n      <td>0.264706</td>\n      <td>0.25</td>\n      <td>0.242857</td>\n      <td>0.233333</td>\n      <td>0.219178</td>\n      <td>0.215385</td>\n      <td>0.212121</td>\n      <td>0.212121</td>\n      <td>0.209677</td>\n      <td>...</td>\n      <td>0.092308</td>\n      <td>0.089744</td>\n      <td>0.086207</td>\n      <td>0.081967</td>\n      <td>0.078431</td>\n      <td>0.068182</td>\n      <td>0.064935</td>\n      <td>0.0625</td>\n      <td>0.057692</td>\n      <td>0.056604</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 51 columns</p>\n</div>\n\n\n\n<p>上表显示，新泽西和加利福尼亚的离网率超过了 25%，夏威夷和阿拉斯加的离网率则不到 6%。然而，这些结论是基于极少的样本得出的，可能仅适用于这一特定数据集，不太具有泛用性。</p>\n<h3 id=\"全局数据集可视化\"><a href=\"#全局数据集可视化\" class=\"headerlink\" title=\"全局数据集可视化\"></a>全局数据集可视化</h3><p>上面我们一直在研究数据集的不同方面（facet），通过猜测有趣的特征并一次选择少量特征进行可视化。如果我们想一次性显示所有特征并仍然能够解释生成的可视化，该怎么办？</p>\n<h4 id=\"降维\"><a href=\"#降维\" class=\"headerlink\" title=\"降维\"></a>降维</h4><p>大多数现实世界的数据集有很多特征，每一个特征都可以被看成数据空间的一个维度。因此，我们经常需要处理高维数据集，然而可视化整个高维数据集相当难。为了从整体上查看一个数据集，需要在不损失很多数据信息的前提下，降低用于可视化的维度。这一任务被称为降维（dimensionality reduction）。降维是一个无监督学习（unsupervised learning）问题，因为它需要在不借助任何监督输入（如标签）的前提下，从数据自身得到新的低维特征。</p>\n<p>主成分分析（Principal Component Analysis, PCA）是一个著名的降维方法，我们会在之后的课程中讨论它。但主成分分析的局限性在于，它是线性（linear）算法，这意味着对数据有某些特定的限制。</p>\n<p>与线性方法相对的，有许多非线性方法，统称流形学习（Manifold Learning）。著名的流形学习方法之一是 t-SNE。</p>\n<h3 id=\"实验总结\"><a href=\"#实验总结\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h3><p>本章节首先介绍了 Pandas、Matplotlib 和 seaborn 库的一些常用可视化方法，并对客户离网数据集进行了可视化分析和 t-SNE 降维。可视化是一个相对快捷的从数据中挖掘信息的手段，因此，学习这一技术并将其纳入你的日常机器学习工具箱，是很有必要的。</p>\n"},{"_content":"# KNN-鸢尾花数据集\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import datasets\n```\n\n#### 使用sklearn本地数据集中的鸢尾花数据集\n\n\n```python\niris = datasets.load_iris()\niris.keys()\n```\n\n\n\n\n    dict_keys(['data', 'target', 'target_names', 'DESCR', 'feature_names', 'filename'])\n\n\n\n\n```python\nX = iris.data\n```\n\n\n```python\nY = iris.target\n```\n\n\n```python\nX.shape\n```\n\n\n\n\n    (150, 4)\n\n\n\n\n```python\nY.shape\n```\n\n\n\n\n    (150,)\n\n\n\n# 手动分离测试数据\n\n\n```python\nshuffled_indexes = np.random.permutation(len(X))\nshuffled_indexes\n```\n\n\n\n\n    array([ 47,  10, 144,  57, 135,  58,  36, 136,  73, 109,  64,  15, 104,\n           143, 108,  83,  23, 126, 125, 131, 137,  22,  16,  29, 118,  31,\n            33,  52,  32, 132,  45,  38,  78, 139,  30,  37,  61,  97, 122,\n            56, 107,  66, 114,  87,  43,  76,  84,  79, 142,  70,  77,  42,\n             7, 138, 141, 120, 129,  44,  24,  53, 116,  13,  91, 119,  93,\n             6,  60,  50,  67,  20,  54,  71,  89,  68,  21, 133, 148,  81,\n            25,  48, 130, 127,  28,  90,  82, 146, 100, 105,  80,  94,  14,\n            55, 111, 106, 101, 103,  35,  99,   3,  26,  69, 124,  95,  96,\n           140,  46,  19,  34,  75,  59,   1, 117, 121,  49, 110,   0, 115,\n            72,   9,  18, 149,  40, 145,  92, 123,  51,   4,  11,  39,  85,\n            62, 147, 102,  74,   2,  86,   8,  17,   5,  27, 112, 128,  12,\n            65,  41, 134,  63,  88, 113,  98])\n\n\n\n\n```python\ntest_ratio = 0.2\ntest_size = int(len(X) * test_ratio)\n```\n\n\n```python\ntest_indexes = shuffled_indexes[:test_size]\ntrain_indexes = shuffled_indexes[test_size:]\n```\n\n\n```python\nX_train = X[train_indexes]\nY_train = Y[train_indexes]\n\nX_test = X[test_indexes]\nY_test = Y[test_indexes]\n```\n\n\n```python\nprint(X_train.shape);print(Y_train.shape);print(X_test.shape);print(Y_test.shape)\n```\n\n    (120, 4)\n    (120,)\n    (30, 4)\n    (30,)\n\n\n# 使用sklearn分离\n\n\n```python\nfrom sklearn.model_selection import train_test_split\ntrain_test_split?\n```\n\n\n    \u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m\n    Split arrays or matrices into random train and test subsets\n    \n    Quick utility that wraps input validation and\n    ``next(ShuffleSplit().split(X, y))`` and application to input data\n    into a single call for splitting (and optionally subsampling) data in a\n    oneliner.\n    \n    Read more in the :ref:`User Guide <cross_validation>`.\n    \n    Parameters\n    ----------\n    *arrays : sequence of indexables with same length / shape[0]\n        Allowed inputs are lists, numpy arrays, scipy-sparse\n        matrices or pandas dataframes.\n    \n    test_size : float, int or None, optional (default=None)\n        If float, should be between 0.0 and 1.0 and represent the proportion\n        of the dataset to include in the test split. If int, represents the\n        absolute number of test samples. If None, the value is set to the\n        complement of the train size. If ``train_size`` is also None, it will\n        be set to 0.25.\n    \n    train_size : float, int, or None, (default=None)\n        If float, should be between 0.0 and 1.0 and represent the\n        proportion of the dataset to include in the train split. If\n        int, represents the absolute number of train samples. If None,\n        the value is automatically set to the complement of the test size.\n    \n    random_state : int, RandomState instance or None, optional (default=None)\n        If int, random_state is the seed used by the random number generator;\n        If RandomState instance, random_state is the random number generator;\n        If None, the random number generator is the RandomState instance used\n        by `np.random`.\n    \n    shuffle : boolean, optional (default=True)\n        Whether or not to shuffle the data before splitting. If shuffle=False\n        then stratify must be None.\n    \n    stratify : array-like or None (default=None)\n        If not None, data is split in a stratified fashion, using this as\n        the class labels.\n    \n    Returns\n    -------\n    splitting : list, length=2 * len(arrays)\n        List containing train-test split of inputs.\n    \n        .. versionadded:: 0.16\n            If the input is sparse, the output will be a\n            ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n            input type.\n    \n    Examples\n    --------\n    >>> import numpy as np\n    >>> from sklearn.model_selection import train_test_split\n    >>> X, y = np.arange(10).reshape((5, 2)), range(5)\n    >>> X\n    array([[0, 1],\n           [2, 3],\n           [4, 5],\n           [6, 7],\n           [8, 9]])\n    >>> list(y)\n    [0, 1, 2, 3, 4]\n    \n    >>> X_train, X_test, y_train, y_test = train_test_split(\n    ...     X, y, test_size=0.33, random_state=42)\n    ...\n    >>> X_train\n    array([[4, 5],\n           [0, 1],\n           [6, 7]])\n    >>> y_train\n    [2, 0, 3]\n    >>> X_test\n    array([[2, 3],\n           [8, 9]])\n    >>> y_test\n    [1, 4]\n    \n    >>> train_test_split(y, shuffle=False)\n    [[0, 1, 2], [3, 4]]\n    \u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n    \u001b[0;31mType:\u001b[0m      function\n\n\n\n\n```python\nX_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=1)\n```\n\n\n```python\nprint(X_train.shape)\nprint(Y_train.shape)\nprint(X_test.shape)\nprint(Y_test.shape)\n```\n\n    (120, 4)\n    (120,)\n    (30, 4)\n    (30,)\n\n\n# 使用sklearn中的KNN分离器测试\n\n\n```python\nfrom sklearn.neighbors import KNeighborsClassifier\nKNeighborsClassifier?\n```\n\n\n    \u001b[0;31mInit signature:\u001b[0m\n    \u001b[0mKNeighborsClassifier\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mn_neighbors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mweights\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'uniform'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0malgorithm\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'auto'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mleaf_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m30\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mp\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mmetric\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'minkowski'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mmetric_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m     \n    Classifier implementing the k-nearest neighbors vote.\n    \n    Read more in the :ref:`User Guide <classification>`.\n    \n    Parameters\n    ----------\n    n_neighbors : int, optional (default = 5)\n        Number of neighbors to use by default for :meth:`kneighbors` queries.\n    \n    weights : str or callable, optional (default = 'uniform')\n        weight function used in prediction.  Possible values:\n    \n        - 'uniform' : uniform weights.  All points in each neighborhood\n          are weighted equally.\n        - 'distance' : weight points by the inverse of their distance.\n          in this case, closer neighbors of a query point will have a\n          greater influence than neighbors which are further away.\n        - [callable] : a user-defined function which accepts an\n          array of distances, and returns an array of the same shape\n          containing the weights.\n    \n    algorithm : {'auto', 'ball_tree', 'kd_tree', 'brute'}, optional\n        Algorithm used to compute the nearest neighbors:\n    \n        - 'ball_tree' will use :class:`BallTree`\n        - 'kd_tree' will use :class:`KDTree`\n        - 'brute' will use a brute-force search.\n        - 'auto' will attempt to decide the most appropriate algorithm\n          based on the values passed to :meth:`fit` method.\n    \n        Note: fitting on sparse input will override the setting of\n        this parameter, using brute force.\n    \n    leaf_size : int, optional (default = 30)\n        Leaf size passed to BallTree or KDTree.  This can affect the\n        speed of the construction and query, as well as the memory\n        required to store the tree.  The optimal value depends on the\n        nature of the problem.\n    \n    p : integer, optional (default = 2)\n        Power parameter for the Minkowski metric. When p = 1, this is\n        equivalent to using manhattan_distance (l1), and euclidean_distance\n        (l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.\n    \n    metric : string or callable, default 'minkowski'\n        the distance metric to use for the tree.  The default metric is\n        minkowski, and with p=2 is equivalent to the standard Euclidean\n        metric. See the documentation of the DistanceMetric class for a\n        list of available metrics.\n        If metric is \"precomputed\", X is assumed to be a distance matrix and\n        must be square during fit. X may be a :term:`Glossary <sparse graph>`,\n        in which case only \"nonzero\" elements may be considered neighbors.\n    \n    metric_params : dict, optional (default = None)\n        Additional keyword arguments for the metric function.\n    \n    n_jobs : int or None, optional (default=None)\n        The number of parallel jobs to run for neighbors search.\n        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n        ``-1`` means using all processors. See :term:`Glossary <n_jobs>`\n        for more details.\n        Doesn't affect :meth:`fit` method.\n    \n    Attributes\n    ----------\n    classes_ : array of shape (n_classes,)\n        Class labels known to the classifier\n    \n    effective_metric_ : string or callble\n        The distance metric used. It will be same as the `metric` parameter\n        or a synonym of it, e.g. 'euclidean' if the `metric` parameter set to\n        'minkowski' and `p` parameter set to 2.\n    \n    effective_metric_params_ : dict\n        Additional keyword arguments for the metric function. For most metrics\n        will be same with `metric_params` parameter, but may also contain the\n        `p` parameter value if the `effective_metric_` attribute is set to\n        'minkowski'.\n    \n    outputs_2d_ : bool\n        False when `y`'s shape is (n_samples, ) or (n_samples, 1) during fit\n        otherwise True.\n    \n    Examples\n    --------\n    >>> X = [[0], [1], [2], [3]]\n    >>> y = [0, 0, 1, 1]\n    >>> from sklearn.neighbors import KNeighborsClassifier\n    >>> neigh = KNeighborsClassifier(n_neighbors=3)\n    >>> neigh.fit(X, y)\n    KNeighborsClassifier(...)\n    >>> print(neigh.predict([[1.1]]))\n    [0]\n    >>> print(neigh.predict_proba([[0.9]]))\n    [[0.66666667 0.33333333]]\n    \n    See also\n    --------\n    RadiusNeighborsClassifier\n    KNeighborsRegressor\n    RadiusNeighborsRegressor\n    NearestNeighbors\n    \n    Notes\n    -----\n    See :ref:`Nearest Neighbors <neighbors>` in the online documentation\n    for a discussion of the choice of ``algorithm`` and ``leaf_size``.\n    \n    .. warning::\n    \n       Regarding the Nearest Neighbors algorithms, if it is found that two\n       neighbors, neighbor `k+1` and `k`, have identical distances\n       but different labels, the results will depend on the ordering of the\n       training data.\n    \n    https://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm\n    \u001b[0;31mFile:\u001b[0m           /Applications/anaconda3/lib/python3.7/site-packages/sklearn/neighbors/_classification.py\n    \u001b[0;31mType:\u001b[0m           ABCMeta\n    \u001b[0;31mSubclasses:\u001b[0m     \n\n\n\n\n```python\nKNNClf = KNeighborsClassifier(n_neighbors=3)\nKNNClf.fit(X_train, Y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                         weights='uniform')\n\n\n\n\n```python\nres = KNNClf.predict(X_test)\nres\n```\n\n\n\n\n    array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n           1, 0, 2, 1, 0, 0, 1, 2])\n\n\n\n\n```python\nY_test\n```\n\n\n\n\n    array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n           1, 0, 2, 1, 0, 0, 1, 2])\n\n\n\n\n```python\nacc = sum(res == Y_test)\n```\n\n\n```python\nprint('accuracy ', acc / len(Y_test))\n```\n\n    accuracy  1.0\n\n\n\n```python\n\n```\n","source":"_posts/mlsec/KNN-鸢尾花数据集.md","raw":"# KNN-鸢尾花数据集\n\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn import datasets\n```\n\n#### 使用sklearn本地数据集中的鸢尾花数据集\n\n\n```python\niris = datasets.load_iris()\niris.keys()\n```\n\n\n\n\n    dict_keys(['data', 'target', 'target_names', 'DESCR', 'feature_names', 'filename'])\n\n\n\n\n```python\nX = iris.data\n```\n\n\n```python\nY = iris.target\n```\n\n\n```python\nX.shape\n```\n\n\n\n\n    (150, 4)\n\n\n\n\n```python\nY.shape\n```\n\n\n\n\n    (150,)\n\n\n\n# 手动分离测试数据\n\n\n```python\nshuffled_indexes = np.random.permutation(len(X))\nshuffled_indexes\n```\n\n\n\n\n    array([ 47,  10, 144,  57, 135,  58,  36, 136,  73, 109,  64,  15, 104,\n           143, 108,  83,  23, 126, 125, 131, 137,  22,  16,  29, 118,  31,\n            33,  52,  32, 132,  45,  38,  78, 139,  30,  37,  61,  97, 122,\n            56, 107,  66, 114,  87,  43,  76,  84,  79, 142,  70,  77,  42,\n             7, 138, 141, 120, 129,  44,  24,  53, 116,  13,  91, 119,  93,\n             6,  60,  50,  67,  20,  54,  71,  89,  68,  21, 133, 148,  81,\n            25,  48, 130, 127,  28,  90,  82, 146, 100, 105,  80,  94,  14,\n            55, 111, 106, 101, 103,  35,  99,   3,  26,  69, 124,  95,  96,\n           140,  46,  19,  34,  75,  59,   1, 117, 121,  49, 110,   0, 115,\n            72,   9,  18, 149,  40, 145,  92, 123,  51,   4,  11,  39,  85,\n            62, 147, 102,  74,   2,  86,   8,  17,   5,  27, 112, 128,  12,\n            65,  41, 134,  63,  88, 113,  98])\n\n\n\n\n```python\ntest_ratio = 0.2\ntest_size = int(len(X) * test_ratio)\n```\n\n\n```python\ntest_indexes = shuffled_indexes[:test_size]\ntrain_indexes = shuffled_indexes[test_size:]\n```\n\n\n```python\nX_train = X[train_indexes]\nY_train = Y[train_indexes]\n\nX_test = X[test_indexes]\nY_test = Y[test_indexes]\n```\n\n\n```python\nprint(X_train.shape);print(Y_train.shape);print(X_test.shape);print(Y_test.shape)\n```\n\n    (120, 4)\n    (120,)\n    (30, 4)\n    (30,)\n\n\n# 使用sklearn分离\n\n\n```python\nfrom sklearn.model_selection import train_test_split\ntrain_test_split?\n```\n\n\n    \u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m\n    Split arrays or matrices into random train and test subsets\n    \n    Quick utility that wraps input validation and\n    ``next(ShuffleSplit().split(X, y))`` and application to input data\n    into a single call for splitting (and optionally subsampling) data in a\n    oneliner.\n    \n    Read more in the :ref:`User Guide <cross_validation>`.\n    \n    Parameters\n    ----------\n    *arrays : sequence of indexables with same length / shape[0]\n        Allowed inputs are lists, numpy arrays, scipy-sparse\n        matrices or pandas dataframes.\n    \n    test_size : float, int or None, optional (default=None)\n        If float, should be between 0.0 and 1.0 and represent the proportion\n        of the dataset to include in the test split. If int, represents the\n        absolute number of test samples. If None, the value is set to the\n        complement of the train size. If ``train_size`` is also None, it will\n        be set to 0.25.\n    \n    train_size : float, int, or None, (default=None)\n        If float, should be between 0.0 and 1.0 and represent the\n        proportion of the dataset to include in the train split. If\n        int, represents the absolute number of train samples. If None,\n        the value is automatically set to the complement of the test size.\n    \n    random_state : int, RandomState instance or None, optional (default=None)\n        If int, random_state is the seed used by the random number generator;\n        If RandomState instance, random_state is the random number generator;\n        If None, the random number generator is the RandomState instance used\n        by `np.random`.\n    \n    shuffle : boolean, optional (default=True)\n        Whether or not to shuffle the data before splitting. If shuffle=False\n        then stratify must be None.\n    \n    stratify : array-like or None (default=None)\n        If not None, data is split in a stratified fashion, using this as\n        the class labels.\n    \n    Returns\n    -------\n    splitting : list, length=2 * len(arrays)\n        List containing train-test split of inputs.\n    \n        .. versionadded:: 0.16\n            If the input is sparse, the output will be a\n            ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n            input type.\n    \n    Examples\n    --------\n    >>> import numpy as np\n    >>> from sklearn.model_selection import train_test_split\n    >>> X, y = np.arange(10).reshape((5, 2)), range(5)\n    >>> X\n    array([[0, 1],\n           [2, 3],\n           [4, 5],\n           [6, 7],\n           [8, 9]])\n    >>> list(y)\n    [0, 1, 2, 3, 4]\n    \n    >>> X_train, X_test, y_train, y_test = train_test_split(\n    ...     X, y, test_size=0.33, random_state=42)\n    ...\n    >>> X_train\n    array([[4, 5],\n           [0, 1],\n           [6, 7]])\n    >>> y_train\n    [2, 0, 3]\n    >>> X_test\n    array([[2, 3],\n           [8, 9]])\n    >>> y_test\n    [1, 4]\n    \n    >>> train_test_split(y, shuffle=False)\n    [[0, 1, 2], [3, 4]]\n    \u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n    \u001b[0;31mType:\u001b[0m      function\n\n\n\n\n```python\nX_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=1)\n```\n\n\n```python\nprint(X_train.shape)\nprint(Y_train.shape)\nprint(X_test.shape)\nprint(Y_test.shape)\n```\n\n    (120, 4)\n    (120,)\n    (30, 4)\n    (30,)\n\n\n# 使用sklearn中的KNN分离器测试\n\n\n```python\nfrom sklearn.neighbors import KNeighborsClassifier\nKNeighborsClassifier?\n```\n\n\n    \u001b[0;31mInit signature:\u001b[0m\n    \u001b[0mKNeighborsClassifier\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mn_neighbors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mweights\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'uniform'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0malgorithm\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'auto'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mleaf_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m30\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mp\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mmetric\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'minkowski'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mmetric_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m    \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n    \u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n    \u001b[0;31mDocstring:\u001b[0m     \n    Classifier implementing the k-nearest neighbors vote.\n    \n    Read more in the :ref:`User Guide <classification>`.\n    \n    Parameters\n    ----------\n    n_neighbors : int, optional (default = 5)\n        Number of neighbors to use by default for :meth:`kneighbors` queries.\n    \n    weights : str or callable, optional (default = 'uniform')\n        weight function used in prediction.  Possible values:\n    \n        - 'uniform' : uniform weights.  All points in each neighborhood\n          are weighted equally.\n        - 'distance' : weight points by the inverse of their distance.\n          in this case, closer neighbors of a query point will have a\n          greater influence than neighbors which are further away.\n        - [callable] : a user-defined function which accepts an\n          array of distances, and returns an array of the same shape\n          containing the weights.\n    \n    algorithm : {'auto', 'ball_tree', 'kd_tree', 'brute'}, optional\n        Algorithm used to compute the nearest neighbors:\n    \n        - 'ball_tree' will use :class:`BallTree`\n        - 'kd_tree' will use :class:`KDTree`\n        - 'brute' will use a brute-force search.\n        - 'auto' will attempt to decide the most appropriate algorithm\n          based on the values passed to :meth:`fit` method.\n    \n        Note: fitting on sparse input will override the setting of\n        this parameter, using brute force.\n    \n    leaf_size : int, optional (default = 30)\n        Leaf size passed to BallTree or KDTree.  This can affect the\n        speed of the construction and query, as well as the memory\n        required to store the tree.  The optimal value depends on the\n        nature of the problem.\n    \n    p : integer, optional (default = 2)\n        Power parameter for the Minkowski metric. When p = 1, this is\n        equivalent to using manhattan_distance (l1), and euclidean_distance\n        (l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.\n    \n    metric : string or callable, default 'minkowski'\n        the distance metric to use for the tree.  The default metric is\n        minkowski, and with p=2 is equivalent to the standard Euclidean\n        metric. See the documentation of the DistanceMetric class for a\n        list of available metrics.\n        If metric is \"precomputed\", X is assumed to be a distance matrix and\n        must be square during fit. X may be a :term:`Glossary <sparse graph>`,\n        in which case only \"nonzero\" elements may be considered neighbors.\n    \n    metric_params : dict, optional (default = None)\n        Additional keyword arguments for the metric function.\n    \n    n_jobs : int or None, optional (default=None)\n        The number of parallel jobs to run for neighbors search.\n        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n        ``-1`` means using all processors. See :term:`Glossary <n_jobs>`\n        for more details.\n        Doesn't affect :meth:`fit` method.\n    \n    Attributes\n    ----------\n    classes_ : array of shape (n_classes,)\n        Class labels known to the classifier\n    \n    effective_metric_ : string or callble\n        The distance metric used. It will be same as the `metric` parameter\n        or a synonym of it, e.g. 'euclidean' if the `metric` parameter set to\n        'minkowski' and `p` parameter set to 2.\n    \n    effective_metric_params_ : dict\n        Additional keyword arguments for the metric function. For most metrics\n        will be same with `metric_params` parameter, but may also contain the\n        `p` parameter value if the `effective_metric_` attribute is set to\n        'minkowski'.\n    \n    outputs_2d_ : bool\n        False when `y`'s shape is (n_samples, ) or (n_samples, 1) during fit\n        otherwise True.\n    \n    Examples\n    --------\n    >>> X = [[0], [1], [2], [3]]\n    >>> y = [0, 0, 1, 1]\n    >>> from sklearn.neighbors import KNeighborsClassifier\n    >>> neigh = KNeighborsClassifier(n_neighbors=3)\n    >>> neigh.fit(X, y)\n    KNeighborsClassifier(...)\n    >>> print(neigh.predict([[1.1]]))\n    [0]\n    >>> print(neigh.predict_proba([[0.9]]))\n    [[0.66666667 0.33333333]]\n    \n    See also\n    --------\n    RadiusNeighborsClassifier\n    KNeighborsRegressor\n    RadiusNeighborsRegressor\n    NearestNeighbors\n    \n    Notes\n    -----\n    See :ref:`Nearest Neighbors <neighbors>` in the online documentation\n    for a discussion of the choice of ``algorithm`` and ``leaf_size``.\n    \n    .. warning::\n    \n       Regarding the Nearest Neighbors algorithms, if it is found that two\n       neighbors, neighbor `k+1` and `k`, have identical distances\n       but different labels, the results will depend on the ordering of the\n       training data.\n    \n    https://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm\n    \u001b[0;31mFile:\u001b[0m           /Applications/anaconda3/lib/python3.7/site-packages/sklearn/neighbors/_classification.py\n    \u001b[0;31mType:\u001b[0m           ABCMeta\n    \u001b[0;31mSubclasses:\u001b[0m     \n\n\n\n\n```python\nKNNClf = KNeighborsClassifier(n_neighbors=3)\nKNNClf.fit(X_train, Y_train)\n```\n\n\n\n\n    KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n                         metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                         weights='uniform')\n\n\n\n\n```python\nres = KNNClf.predict(X_test)\nres\n```\n\n\n\n\n    array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n           1, 0, 2, 1, 0, 0, 1, 2])\n\n\n\n\n```python\nY_test\n```\n\n\n\n\n    array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n           1, 0, 2, 1, 0, 0, 1, 2])\n\n\n\n\n```python\nacc = sum(res == Y_test)\n```\n\n\n```python\nprint('accuracy ', acc / len(Y_test))\n```\n\n    accuracy  1.0\n\n\n\n```python\n\n```\n","slug":"mlsec/KNN-鸢尾花数据集","published":1,"date":"2020-05-17T08:36:25.969Z","updated":"2020-05-17T08:37:09.945Z","title":"mlsec/KNN-鸢尾花数据集","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zq006d018o2h385mox","content":"<h1 id=\"KNN-鸢尾花数据集\"><a href=\"#KNN-鸢尾花数据集\" class=\"headerlink\" title=\"KNN-鸢尾花数据集\"></a>KNN-鸢尾花数据集</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用sklearn本地数据集中的鸢尾花数据集\"><a href=\"#使用sklearn本地数据集中的鸢尾花数据集\" class=\"headerlink\" title=\"使用sklearn本地数据集中的鸢尾花数据集\"></a>使用sklearn本地数据集中的鸢尾花数据集</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iris = datasets.load_iris()</span><br><span class=\"line\">iris.keys()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>dict_keys([&apos;data&apos;, &apos;target&apos;, &apos;target_names&apos;, &apos;DESCR&apos;, &apos;feature_names&apos;, &apos;filename&apos;])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X = iris.data</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y = iris.target</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(150, 4)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(150,)</code></pre><h1 id=\"手动分离测试数据\"><a href=\"#手动分离测试数据\" class=\"headerlink\" title=\"手动分离测试数据\"></a>手动分离测试数据</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shuffled_indexes = np.random.permutation(len(X))</span><br><span class=\"line\">shuffled_indexes</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([ 47,  10, 144,  57, 135,  58,  36, 136,  73, 109,  64,  15, 104,\n       143, 108,  83,  23, 126, 125, 131, 137,  22,  16,  29, 118,  31,\n        33,  52,  32, 132,  45,  38,  78, 139,  30,  37,  61,  97, 122,\n        56, 107,  66, 114,  87,  43,  76,  84,  79, 142,  70,  77,  42,\n         7, 138, 141, 120, 129,  44,  24,  53, 116,  13,  91, 119,  93,\n         6,  60,  50,  67,  20,  54,  71,  89,  68,  21, 133, 148,  81,\n        25,  48, 130, 127,  28,  90,  82, 146, 100, 105,  80,  94,  14,\n        55, 111, 106, 101, 103,  35,  99,   3,  26,  69, 124,  95,  96,\n       140,  46,  19,  34,  75,  59,   1, 117, 121,  49, 110,   0, 115,\n        72,   9,  18, 149,  40, 145,  92, 123,  51,   4,  11,  39,  85,\n        62, 147, 102,  74,   2,  86,   8,  17,   5,  27, 112, 128,  12,\n        65,  41, 134,  63,  88, 113,  98])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test_ratio = <span class=\"number\">0.2</span></span><br><span class=\"line\">test_size = int(len(X) * test_ratio)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test_indexes = shuffled_indexes[:test_size]</span><br><span class=\"line\">train_indexes = shuffled_indexes[test_size:]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train = X[train_indexes]</span><br><span class=\"line\">Y_train = Y[train_indexes]</span><br><span class=\"line\"></span><br><span class=\"line\">X_test = X[test_indexes]</span><br><span class=\"line\">Y_test = Y[test_indexes]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(X_train.shape);print(Y_train.shape);print(X_test.shape);print(Y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(120, 4)\n(120,)\n(30, 4)\n(30,)</code></pre><h1 id=\"使用sklearn分离\"><a href=\"#使用sklearn分离\" class=\"headerlink\" title=\"使用sklearn分离\"></a>使用sklearn分离</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\">train_test_split?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nSplit arrays or matrices into random train and test subsets\n\nQuick utility that wraps input validation and\n``next(ShuffleSplit().split(X, y))`` and application to input data\ninto a single call for splitting (and optionally subsampling) data in a\noneliner.\n\nRead more in the :ref:`User Guide &lt;cross_validation&gt;`.\n\nParameters\n----------\n*arrays : sequence of indexables with same length / shape[0]\n    Allowed inputs are lists, numpy arrays, scipy-sparse\n    matrices or pandas dataframes.\n\ntest_size : float, int or None, optional (default=None)\n    If float, should be between 0.0 and 1.0 and represent the proportion\n    of the dataset to include in the test split. If int, represents the\n    absolute number of test samples. If None, the value is set to the\n    complement of the train size. If ``train_size`` is also None, it will\n    be set to 0.25.\n\ntrain_size : float, int, or None, (default=None)\n    If float, should be between 0.0 and 1.0 and represent the\n    proportion of the dataset to include in the train split. If\n    int, represents the absolute number of train samples. If None,\n    the value is automatically set to the complement of the test size.\n\nrandom_state : int, RandomState instance or None, optional (default=None)\n    If int, random_state is the seed used by the random number generator;\n    If RandomState instance, random_state is the random number generator;\n    If None, the random number generator is the RandomState instance used\n    by `np.random`.\n\nshuffle : boolean, optional (default=True)\n    Whether or not to shuffle the data before splitting. If shuffle=False\n    then stratify must be None.\n\nstratify : array-like or None (default=None)\n    If not None, data is split in a stratified fashion, using this as\n    the class labels.\n\nReturns\n-------\nsplitting : list, length=2 * len(arrays)\n    List containing train-test split of inputs.\n\n    .. versionadded:: 0.16\n        If the input is sparse, the output will be a\n        ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n        input type.\n\nExamples\n--------\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from sklearn.model_selection import train_test_split\n&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)\n&gt;&gt;&gt; X\narray([[0, 1],\n       [2, 3],\n       [4, 5],\n       [6, 7],\n       [8, 9]])\n&gt;&gt;&gt; list(y)\n[0, 1, 2, 3, 4]\n\n&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(\n...     X, y, test_size=0.33, random_state=42)\n...\n&gt;&gt;&gt; X_train\narray([[4, 5],\n       [0, 1],\n       [6, 7]])\n&gt;&gt;&gt; y_train\n[2, 0, 3]\n&gt;&gt;&gt; X_test\narray([[2, 3],\n       [8, 9]])\n&gt;&gt;&gt; y_test\n[1, 4]\n\n&gt;&gt;&gt; train_test_split(y, shuffle=False)\n[[0, 1, 2], [3, 4]]\n\u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n\u001b[0;31mType:\u001b[0m      function</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(X_train.shape)</span><br><span class=\"line\">print(Y_train.shape)</span><br><span class=\"line\">print(X_test.shape)</span><br><span class=\"line\">print(Y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(120, 4)\n(120,)\n(30, 4)\n(30,)</code></pre><h1 id=\"使用sklearn中的KNN分离器测试\"><a href=\"#使用sklearn中的KNN分离器测试\" class=\"headerlink\" title=\"使用sklearn中的KNN分离器测试\"></a>使用sklearn中的KNN分离器测试</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br><span class=\"line\">KNeighborsClassifier?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mInit signature:\u001b[0m\n\u001b[0mKNeighborsClassifier\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mn_neighbors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mweights\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;uniform&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0malgorithm\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;auto&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mleaf_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m30\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mp\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mmetric\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;minkowski&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mmetric_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m     \nClassifier implementing the k-nearest neighbors vote.\n\nRead more in the :ref:`User Guide &lt;classification&gt;`.\n\nParameters\n----------\nn_neighbors : int, optional (default = 5)\n    Number of neighbors to use by default for :meth:`kneighbors` queries.\n\nweights : str or callable, optional (default = &apos;uniform&apos;)\n    weight function used in prediction.  Possible values:\n\n    - &apos;uniform&apos; : uniform weights.  All points in each neighborhood\n      are weighted equally.\n    - &apos;distance&apos; : weight points by the inverse of their distance.\n      in this case, closer neighbors of a query point will have a\n      greater influence than neighbors which are further away.\n    - [callable] : a user-defined function which accepts an\n      array of distances, and returns an array of the same shape\n      containing the weights.\n\nalgorithm : {&apos;auto&apos;, &apos;ball_tree&apos;, &apos;kd_tree&apos;, &apos;brute&apos;}, optional\n    Algorithm used to compute the nearest neighbors:\n\n    - &apos;ball_tree&apos; will use :class:`BallTree`\n    - &apos;kd_tree&apos; will use :class:`KDTree`\n    - &apos;brute&apos; will use a brute-force search.\n    - &apos;auto&apos; will attempt to decide the most appropriate algorithm\n      based on the values passed to :meth:`fit` method.\n\n    Note: fitting on sparse input will override the setting of\n    this parameter, using brute force.\n\nleaf_size : int, optional (default = 30)\n    Leaf size passed to BallTree or KDTree.  This can affect the\n    speed of the construction and query, as well as the memory\n    required to store the tree.  The optimal value depends on the\n    nature of the problem.\n\np : integer, optional (default = 2)\n    Power parameter for the Minkowski metric. When p = 1, this is\n    equivalent to using manhattan_distance (l1), and euclidean_distance\n    (l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.\n\nmetric : string or callable, default &apos;minkowski&apos;\n    the distance metric to use for the tree.  The default metric is\n    minkowski, and with p=2 is equivalent to the standard Euclidean\n    metric. See the documentation of the DistanceMetric class for a\n    list of available metrics.\n    If metric is &quot;precomputed&quot;, X is assumed to be a distance matrix and\n    must be square during fit. X may be a :term:`Glossary &lt;sparse graph&gt;`,\n    in which case only &quot;nonzero&quot; elements may be considered neighbors.\n\nmetric_params : dict, optional (default = None)\n    Additional keyword arguments for the metric function.\n\nn_jobs : int or None, optional (default=None)\n    The number of parallel jobs to run for neighbors search.\n    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`\n    for more details.\n    Doesn&apos;t affect :meth:`fit` method.\n\nAttributes\n----------\nclasses_ : array of shape (n_classes,)\n    Class labels known to the classifier\n\neffective_metric_ : string or callble\n    The distance metric used. It will be same as the `metric` parameter\n    or a synonym of it, e.g. &apos;euclidean&apos; if the `metric` parameter set to\n    &apos;minkowski&apos; and `p` parameter set to 2.\n\neffective_metric_params_ : dict\n    Additional keyword arguments for the metric function. For most metrics\n    will be same with `metric_params` parameter, but may also contain the\n    `p` parameter value if the `effective_metric_` attribute is set to\n    &apos;minkowski&apos;.\n\noutputs_2d_ : bool\n    False when `y`&apos;s shape is (n_samples, ) or (n_samples, 1) during fit\n    otherwise True.\n\nExamples\n--------\n&gt;&gt;&gt; X = [[0], [1], [2], [3]]\n&gt;&gt;&gt; y = [0, 0, 1, 1]\n&gt;&gt;&gt; from sklearn.neighbors import KNeighborsClassifier\n&gt;&gt;&gt; neigh = KNeighborsClassifier(n_neighbors=3)\n&gt;&gt;&gt; neigh.fit(X, y)\nKNeighborsClassifier(...)\n&gt;&gt;&gt; print(neigh.predict([[1.1]]))\n[0]\n&gt;&gt;&gt; print(neigh.predict_proba([[0.9]]))\n[[0.66666667 0.33333333]]\n\nSee also\n--------\nRadiusNeighborsClassifier\nKNeighborsRegressor\nRadiusNeighborsRegressor\nNearestNeighbors\n\nNotes\n-----\nSee :ref:`Nearest Neighbors &lt;neighbors&gt;` in the online documentation\nfor a discussion of the choice of ``algorithm`` and ``leaf_size``.\n\n.. warning::\n\n   Regarding the Nearest Neighbors algorithms, if it is found that two\n   neighbors, neighbor `k+1` and `k`, have identical distances\n   but different labels, the results will depend on the ordering of the\n   training data.\n\nhttps://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm\n\u001b[0;31mFile:\u001b[0m           /Applications/anaconda3/lib/python3.7/site-packages/sklearn/neighbors/_classification.py\n\u001b[0;31mType:\u001b[0m           ABCMeta\n\u001b[0;31mSubclasses:\u001b[0m     </code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf = KNeighborsClassifier(n_neighbors=<span class=\"number\">3</span>)</span><br><span class=\"line\">KNNClf.fit(X_train, Y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNNClf.predict(X_test)</span><br><span class=\"line\">res</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y_test</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">acc = sum(res == Y_test)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(<span class=\"string\">'accuracy '</span>, acc / len(Y_test))</span><br></pre></td></tr></table></figure>\n\n<pre><code>accuracy  1.0</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"KNN-鸢尾花数据集\"><a href=\"#KNN-鸢尾花数据集\" class=\"headerlink\" title=\"KNN-鸢尾花数据集\"></a>KNN-鸢尾花数据集</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"使用sklearn本地数据集中的鸢尾花数据集\"><a href=\"#使用sklearn本地数据集中的鸢尾花数据集\" class=\"headerlink\" title=\"使用sklearn本地数据集中的鸢尾花数据集\"></a>使用sklearn本地数据集中的鸢尾花数据集</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">iris = datasets.load_iris()</span><br><span class=\"line\">iris.keys()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>dict_keys([&apos;data&apos;, &apos;target&apos;, &apos;target_names&apos;, &apos;DESCR&apos;, &apos;feature_names&apos;, &apos;filename&apos;])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X = iris.data</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y = iris.target</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(150, 4)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(150,)</code></pre><h1 id=\"手动分离测试数据\"><a href=\"#手动分离测试数据\" class=\"headerlink\" title=\"手动分离测试数据\"></a>手动分离测试数据</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shuffled_indexes = np.random.permutation(len(X))</span><br><span class=\"line\">shuffled_indexes</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([ 47,  10, 144,  57, 135,  58,  36, 136,  73, 109,  64,  15, 104,\n       143, 108,  83,  23, 126, 125, 131, 137,  22,  16,  29, 118,  31,\n        33,  52,  32, 132,  45,  38,  78, 139,  30,  37,  61,  97, 122,\n        56, 107,  66, 114,  87,  43,  76,  84,  79, 142,  70,  77,  42,\n         7, 138, 141, 120, 129,  44,  24,  53, 116,  13,  91, 119,  93,\n         6,  60,  50,  67,  20,  54,  71,  89,  68,  21, 133, 148,  81,\n        25,  48, 130, 127,  28,  90,  82, 146, 100, 105,  80,  94,  14,\n        55, 111, 106, 101, 103,  35,  99,   3,  26,  69, 124,  95,  96,\n       140,  46,  19,  34,  75,  59,   1, 117, 121,  49, 110,   0, 115,\n        72,   9,  18, 149,  40, 145,  92, 123,  51,   4,  11,  39,  85,\n        62, 147, 102,  74,   2,  86,   8,  17,   5,  27, 112, 128,  12,\n        65,  41, 134,  63,  88, 113,  98])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test_ratio = <span class=\"number\">0.2</span></span><br><span class=\"line\">test_size = int(len(X) * test_ratio)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test_indexes = shuffled_indexes[:test_size]</span><br><span class=\"line\">train_indexes = shuffled_indexes[test_size:]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train = X[train_indexes]</span><br><span class=\"line\">Y_train = Y[train_indexes]</span><br><span class=\"line\"></span><br><span class=\"line\">X_test = X[test_indexes]</span><br><span class=\"line\">Y_test = Y[test_indexes]</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(X_train.shape);print(Y_train.shape);print(X_test.shape);print(Y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(120, 4)\n(120,)\n(30, 4)\n(30,)</code></pre><h1 id=\"使用sklearn分离\"><a href=\"#使用sklearn分离\" class=\"headerlink\" title=\"使用sklearn分离\"></a>使用sklearn分离</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\">train_test_split?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mSignature:\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marrays\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nSplit arrays or matrices into random train and test subsets\n\nQuick utility that wraps input validation and\n``next(ShuffleSplit().split(X, y))`` and application to input data\ninto a single call for splitting (and optionally subsampling) data in a\noneliner.\n\nRead more in the :ref:`User Guide &lt;cross_validation&gt;`.\n\nParameters\n----------\n*arrays : sequence of indexables with same length / shape[0]\n    Allowed inputs are lists, numpy arrays, scipy-sparse\n    matrices or pandas dataframes.\n\ntest_size : float, int or None, optional (default=None)\n    If float, should be between 0.0 and 1.0 and represent the proportion\n    of the dataset to include in the test split. If int, represents the\n    absolute number of test samples. If None, the value is set to the\n    complement of the train size. If ``train_size`` is also None, it will\n    be set to 0.25.\n\ntrain_size : float, int, or None, (default=None)\n    If float, should be between 0.0 and 1.0 and represent the\n    proportion of the dataset to include in the train split. If\n    int, represents the absolute number of train samples. If None,\n    the value is automatically set to the complement of the test size.\n\nrandom_state : int, RandomState instance or None, optional (default=None)\n    If int, random_state is the seed used by the random number generator;\n    If RandomState instance, random_state is the random number generator;\n    If None, the random number generator is the RandomState instance used\n    by `np.random`.\n\nshuffle : boolean, optional (default=True)\n    Whether or not to shuffle the data before splitting. If shuffle=False\n    then stratify must be None.\n\nstratify : array-like or None (default=None)\n    If not None, data is split in a stratified fashion, using this as\n    the class labels.\n\nReturns\n-------\nsplitting : list, length=2 * len(arrays)\n    List containing train-test split of inputs.\n\n    .. versionadded:: 0.16\n        If the input is sparse, the output will be a\n        ``scipy.sparse.csr_matrix``. Else, output type is the same as the\n        input type.\n\nExamples\n--------\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from sklearn.model_selection import train_test_split\n&gt;&gt;&gt; X, y = np.arange(10).reshape((5, 2)), range(5)\n&gt;&gt;&gt; X\narray([[0, 1],\n       [2, 3],\n       [4, 5],\n       [6, 7],\n       [8, 9]])\n&gt;&gt;&gt; list(y)\n[0, 1, 2, 3, 4]\n\n&gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(\n...     X, y, test_size=0.33, random_state=42)\n...\n&gt;&gt;&gt; X_train\narray([[4, 5],\n       [0, 1],\n       [6, 7]])\n&gt;&gt;&gt; y_train\n[2, 0, 3]\n&gt;&gt;&gt; X_test\narray([[2, 3],\n       [8, 9]])\n&gt;&gt;&gt; y_test\n[1, 4]\n\n&gt;&gt;&gt; train_test_split(y, shuffle=False)\n[[0, 1, 2], [3, 4]]\n\u001b[0;31mFile:\u001b[0m      /Applications/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py\n\u001b[0;31mType:\u001b[0m      function</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=<span class=\"number\">0.2</span>, random_state=<span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(X_train.shape)</span><br><span class=\"line\">print(Y_train.shape)</span><br><span class=\"line\">print(X_test.shape)</span><br><span class=\"line\">print(Y_test.shape)</span><br></pre></td></tr></table></figure>\n\n<pre><code>(120, 4)\n(120,)\n(30, 4)\n(30,)</code></pre><h1 id=\"使用sklearn中的KNN分离器测试\"><a href=\"#使用sklearn中的KNN分离器测试\" class=\"headerlink\" title=\"使用sklearn中的KNN分离器测试\"></a>使用sklearn中的KNN分离器测试</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br><span class=\"line\">KNeighborsClassifier?</span><br></pre></td></tr></table></figure>\n\n\n<pre><code>\u001b[0;31mInit signature:\u001b[0m\n\u001b[0mKNeighborsClassifier\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mn_neighbors\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mweights\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;uniform&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0malgorithm\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;auto&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mleaf_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m30\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mp\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mmetric\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m&apos;minkowski&apos;\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mmetric_params\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m     \nClassifier implementing the k-nearest neighbors vote.\n\nRead more in the :ref:`User Guide &lt;classification&gt;`.\n\nParameters\n----------\nn_neighbors : int, optional (default = 5)\n    Number of neighbors to use by default for :meth:`kneighbors` queries.\n\nweights : str or callable, optional (default = &apos;uniform&apos;)\n    weight function used in prediction.  Possible values:\n\n    - &apos;uniform&apos; : uniform weights.  All points in each neighborhood\n      are weighted equally.\n    - &apos;distance&apos; : weight points by the inverse of their distance.\n      in this case, closer neighbors of a query point will have a\n      greater influence than neighbors which are further away.\n    - [callable] : a user-defined function which accepts an\n      array of distances, and returns an array of the same shape\n      containing the weights.\n\nalgorithm : {&apos;auto&apos;, &apos;ball_tree&apos;, &apos;kd_tree&apos;, &apos;brute&apos;}, optional\n    Algorithm used to compute the nearest neighbors:\n\n    - &apos;ball_tree&apos; will use :class:`BallTree`\n    - &apos;kd_tree&apos; will use :class:`KDTree`\n    - &apos;brute&apos; will use a brute-force search.\n    - &apos;auto&apos; will attempt to decide the most appropriate algorithm\n      based on the values passed to :meth:`fit` method.\n\n    Note: fitting on sparse input will override the setting of\n    this parameter, using brute force.\n\nleaf_size : int, optional (default = 30)\n    Leaf size passed to BallTree or KDTree.  This can affect the\n    speed of the construction and query, as well as the memory\n    required to store the tree.  The optimal value depends on the\n    nature of the problem.\n\np : integer, optional (default = 2)\n    Power parameter for the Minkowski metric. When p = 1, this is\n    equivalent to using manhattan_distance (l1), and euclidean_distance\n    (l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.\n\nmetric : string or callable, default &apos;minkowski&apos;\n    the distance metric to use for the tree.  The default metric is\n    minkowski, and with p=2 is equivalent to the standard Euclidean\n    metric. See the documentation of the DistanceMetric class for a\n    list of available metrics.\n    If metric is &quot;precomputed&quot;, X is assumed to be a distance matrix and\n    must be square during fit. X may be a :term:`Glossary &lt;sparse graph&gt;`,\n    in which case only &quot;nonzero&quot; elements may be considered neighbors.\n\nmetric_params : dict, optional (default = None)\n    Additional keyword arguments for the metric function.\n\nn_jobs : int or None, optional (default=None)\n    The number of parallel jobs to run for neighbors search.\n    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`\n    for more details.\n    Doesn&apos;t affect :meth:`fit` method.\n\nAttributes\n----------\nclasses_ : array of shape (n_classes,)\n    Class labels known to the classifier\n\neffective_metric_ : string or callble\n    The distance metric used. It will be same as the `metric` parameter\n    or a synonym of it, e.g. &apos;euclidean&apos; if the `metric` parameter set to\n    &apos;minkowski&apos; and `p` parameter set to 2.\n\neffective_metric_params_ : dict\n    Additional keyword arguments for the metric function. For most metrics\n    will be same with `metric_params` parameter, but may also contain the\n    `p` parameter value if the `effective_metric_` attribute is set to\n    &apos;minkowski&apos;.\n\noutputs_2d_ : bool\n    False when `y`&apos;s shape is (n_samples, ) or (n_samples, 1) during fit\n    otherwise True.\n\nExamples\n--------\n&gt;&gt;&gt; X = [[0], [1], [2], [3]]\n&gt;&gt;&gt; y = [0, 0, 1, 1]\n&gt;&gt;&gt; from sklearn.neighbors import KNeighborsClassifier\n&gt;&gt;&gt; neigh = KNeighborsClassifier(n_neighbors=3)\n&gt;&gt;&gt; neigh.fit(X, y)\nKNeighborsClassifier(...)\n&gt;&gt;&gt; print(neigh.predict([[1.1]]))\n[0]\n&gt;&gt;&gt; print(neigh.predict_proba([[0.9]]))\n[[0.66666667 0.33333333]]\n\nSee also\n--------\nRadiusNeighborsClassifier\nKNeighborsRegressor\nRadiusNeighborsRegressor\nNearestNeighbors\n\nNotes\n-----\nSee :ref:`Nearest Neighbors &lt;neighbors&gt;` in the online documentation\nfor a discussion of the choice of ``algorithm`` and ``leaf_size``.\n\n.. warning::\n\n   Regarding the Nearest Neighbors algorithms, if it is found that two\n   neighbors, neighbor `k+1` and `k`, have identical distances\n   but different labels, the results will depend on the ordering of the\n   training data.\n\nhttps://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm\n\u001b[0;31mFile:\u001b[0m           /Applications/anaconda3/lib/python3.7/site-packages/sklearn/neighbors/_classification.py\n\u001b[0;31mType:\u001b[0m           ABCMeta\n\u001b[0;31mSubclasses:\u001b[0m     </code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">KNNClf = KNeighborsClassifier(n_neighbors=<span class=\"number\">3</span>)</span><br><span class=\"line\">KNNClf.fit(X_train, Y_train)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,\n                     metric_params=None, n_jobs=None, n_neighbors=3, p=2,\n                     weights=&apos;uniform&apos;)</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = KNNClf.predict(X_test)</span><br><span class=\"line\">res</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Y_test</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>array([0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1, 1,\n       1, 0, 2, 1, 0, 0, 1, 2])</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">acc = sum(res == Y_test)</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(<span class=\"string\">'accuracy '</span>, acc / len(Y_test))</span><br></pre></td></tr></table></figure>\n\n<pre><code>accuracy  1.0</code></pre><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n"},{"title":"Fluent-Python-PartIII-Functions as Objects","catagories":["Fluent-Python"],"_content":"\n# 5-First-Class Functions\n\nPython中所有的函数都是first-class对象（一级对象？）\n\n- 在运行时创建\n- 赋值给数据结构中的变量或元素\n- 作为参数传递给函数\n- 作为函数的结果返回\n\n## 可调用对象的7中风格\n\n1. 用户定义方程\n\n使用`def`语句或`lambda`表达式创建。\n\n2. 内建函数\n\n`len`\n\n3. 内建方法\n\nDice.get\n\n4. 方法\n\n定义在类内部的函数\n\n5. 类\n\n可以调用`__new__`方法去生成实例的类，然后通过`__init__`方法来初始化它。\n\n6. 类实例\n\n如果一个类定义了一个`__call__`方法，那这个实例就会当作函数被调用。\n\n7. 生成器函数\n\n函数或方法使用`yield`关键字，当调用的时候，生成器函数返回一个生成器对象。\n\n## User-Defined Callable Types用户定义的可调用类型\n\nPython函数不仅是真正的对象，而且任意的Python对象也可以表现的像函数一样。只要实现`__call__`实例方法。\n\n\n\n# 6-Design Patterns with First-Class Functions\n\n项目实例\n\n","source":"_posts/notebook/Fluent-Python-1.18-1.md","raw":"---\ntitle: Fluent-Python-PartIII-Functions as Objects\ncatagories: \n- Fluent-Python\ntags: \n- python\n- design-pattern\n---\n\n# 5-First-Class Functions\n\nPython中所有的函数都是first-class对象（一级对象？）\n\n- 在运行时创建\n- 赋值给数据结构中的变量或元素\n- 作为参数传递给函数\n- 作为函数的结果返回\n\n## 可调用对象的7中风格\n\n1. 用户定义方程\n\n使用`def`语句或`lambda`表达式创建。\n\n2. 内建函数\n\n`len`\n\n3. 内建方法\n\nDice.get\n\n4. 方法\n\n定义在类内部的函数\n\n5. 类\n\n可以调用`__new__`方法去生成实例的类，然后通过`__init__`方法来初始化它。\n\n6. 类实例\n\n如果一个类定义了一个`__call__`方法，那这个实例就会当作函数被调用。\n\n7. 生成器函数\n\n函数或方法使用`yield`关键字，当调用的时候，生成器函数返回一个生成器对象。\n\n## User-Defined Callable Types用户定义的可调用类型\n\nPython函数不仅是真正的对象，而且任意的Python对象也可以表现的像函数一样。只要实现`__call__`实例方法。\n\n\n\n# 6-Design Patterns with First-Class Functions\n\n项目实例\n\n","slug":"notebook/Fluent-Python-1.18-1","published":1,"date":"2021-01-18T07:00:10.101Z","updated":"2021-01-18T08:49:14.710Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zr006g018odcgp1jer","content":"<h1 id=\"5-First-Class-Functions\"><a href=\"#5-First-Class-Functions\" class=\"headerlink\" title=\"5-First-Class Functions\"></a>5-First-Class Functions</h1><p>Python中所有的函数都是first-class对象（一级对象？）</p>\n<ul>\n<li>在运行时创建</li>\n<li>赋值给数据结构中的变量或元素</li>\n<li>作为参数传递给函数</li>\n<li>作为函数的结果返回</li>\n</ul>\n<h2 id=\"可调用对象的7中风格\"><a href=\"#可调用对象的7中风格\" class=\"headerlink\" title=\"可调用对象的7中风格\"></a>可调用对象的7中风格</h2><ol>\n<li>用户定义方程</li>\n</ol>\n<p>使用<code>def</code>语句或<code>lambda</code>表达式创建。</p>\n<ol start=\"2\">\n<li>内建函数</li>\n</ol>\n<p><code>len</code></p>\n<ol start=\"3\">\n<li>内建方法</li>\n</ol>\n<p>Dice.get</p>\n<ol start=\"4\">\n<li>方法</li>\n</ol>\n<p>定义在类内部的函数</p>\n<ol start=\"5\">\n<li>类</li>\n</ol>\n<p>可以调用<code>__new__</code>方法去生成实例的类，然后通过<code>__init__</code>方法来初始化它。</p>\n<ol start=\"6\">\n<li>类实例</li>\n</ol>\n<p>如果一个类定义了一个<code>__call__</code>方法，那这个实例就会当作函数被调用。</p>\n<ol start=\"7\">\n<li>生成器函数</li>\n</ol>\n<p>函数或方法使用<code>yield</code>关键字，当调用的时候，生成器函数返回一个生成器对象。</p>\n<h2 id=\"User-Defined-Callable-Types用户定义的可调用类型\"><a href=\"#User-Defined-Callable-Types用户定义的可调用类型\" class=\"headerlink\" title=\"User-Defined Callable Types用户定义的可调用类型\"></a>User-Defined Callable Types用户定义的可调用类型</h2><p>Python函数不仅是真正的对象，而且任意的Python对象也可以表现的像函数一样。只要实现<code>__call__</code>实例方法。</p>\n<h1 id=\"6-Design-Patterns-with-First-Class-Functions\"><a href=\"#6-Design-Patterns-with-First-Class-Functions\" class=\"headerlink\" title=\"6-Design Patterns with First-Class Functions\"></a>6-Design Patterns with First-Class Functions</h1><p>项目实例</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"5-First-Class-Functions\"><a href=\"#5-First-Class-Functions\" class=\"headerlink\" title=\"5-First-Class Functions\"></a>5-First-Class Functions</h1><p>Python中所有的函数都是first-class对象（一级对象？）</p>\n<ul>\n<li>在运行时创建</li>\n<li>赋值给数据结构中的变量或元素</li>\n<li>作为参数传递给函数</li>\n<li>作为函数的结果返回</li>\n</ul>\n<h2 id=\"可调用对象的7中风格\"><a href=\"#可调用对象的7中风格\" class=\"headerlink\" title=\"可调用对象的7中风格\"></a>可调用对象的7中风格</h2><ol>\n<li>用户定义方程</li>\n</ol>\n<p>使用<code>def</code>语句或<code>lambda</code>表达式创建。</p>\n<ol start=\"2\">\n<li>内建函数</li>\n</ol>\n<p><code>len</code></p>\n<ol start=\"3\">\n<li>内建方法</li>\n</ol>\n<p>Dice.get</p>\n<ol start=\"4\">\n<li>方法</li>\n</ol>\n<p>定义在类内部的函数</p>\n<ol start=\"5\">\n<li>类</li>\n</ol>\n<p>可以调用<code>__new__</code>方法去生成实例的类，然后通过<code>__init__</code>方法来初始化它。</p>\n<ol start=\"6\">\n<li>类实例</li>\n</ol>\n<p>如果一个类定义了一个<code>__call__</code>方法，那这个实例就会当作函数被调用。</p>\n<ol start=\"7\">\n<li>生成器函数</li>\n</ol>\n<p>函数或方法使用<code>yield</code>关键字，当调用的时候，生成器函数返回一个生成器对象。</p>\n<h2 id=\"User-Defined-Callable-Types用户定义的可调用类型\"><a href=\"#User-Defined-Callable-Types用户定义的可调用类型\" class=\"headerlink\" title=\"User-Defined Callable Types用户定义的可调用类型\"></a>User-Defined Callable Types用户定义的可调用类型</h2><p>Python函数不仅是真正的对象，而且任意的Python对象也可以表现的像函数一样。只要实现<code>__call__</code>实例方法。</p>\n<h1 id=\"6-Design-Patterns-with-First-Class-Functions\"><a href=\"#6-Design-Patterns-with-First-Class-Functions\" class=\"headerlink\" title=\"6-Design Patterns with First-Class Functions\"></a>6-Design Patterns with First-Class Functions</h1><p>项目实例</p>\n"},{"title":"Fluent-Python-PartI-Prologue","catagories":["Fluent-Python"],"_content":"\n# 开始Fluent-Python\n\n前言：\n\nHere's the plan: when someone uses a feature you don't understand, simply shoot them.\n\n# 1-The Python Data Model\n\n魔术方法也叫做Dunder方法，一般under-under-getitem-under-under也可以叫做dunder-getitem.\n\nExample 1-1\n\n我们可以通过重写`__len__`方法与`__getitem__`方法实现对象的获取书长度，与获取数据。\n\n特殊方法的调用时隐式的，例如`for i in x:`就隐式的调用了iter(x).\n\n代码中不应该有很多对特殊方法的直接调用，除非你在进行元编程。\n\n\n\nExample 1-2\n\n`__repr__`与`__str__`方法类似，但是在打印一个实例的信息时会调用`__repr`方法。如果没有重写该方法console会显示类似`<Vector object at 0x10e100070>`的信息。\n\n`__str__`由str()函数调用，强烈建议重写`__repr__`如果没有`__str__`则会调用`__repr__`.\n\n`bool()`调用`__bool__`的结果，如果没有实现`__bool__`那么会调用`__len__`如果长度为0则返回`False`.\n\n\n\n\n\n","source":"_posts/notebook/Fluent-Python-1.18.md","raw":"---\ntitle: Fluent-Python-PartI-Prologue\ncatagories: \n- Fluent-Python\ntags: \n- python\n---\n\n# 开始Fluent-Python\n\n前言：\n\nHere's the plan: when someone uses a feature you don't understand, simply shoot them.\n\n# 1-The Python Data Model\n\n魔术方法也叫做Dunder方法，一般under-under-getitem-under-under也可以叫做dunder-getitem.\n\nExample 1-1\n\n我们可以通过重写`__len__`方法与`__getitem__`方法实现对象的获取书长度，与获取数据。\n\n特殊方法的调用时隐式的，例如`for i in x:`就隐式的调用了iter(x).\n\n代码中不应该有很多对特殊方法的直接调用，除非你在进行元编程。\n\n\n\nExample 1-2\n\n`__repr__`与`__str__`方法类似，但是在打印一个实例的信息时会调用`__repr`方法。如果没有重写该方法console会显示类似`<Vector object at 0x10e100070>`的信息。\n\n`__str__`由str()函数调用，强烈建议重写`__repr__`如果没有`__str__`则会调用`__repr__`.\n\n`bool()`调用`__bool__`的结果，如果没有实现`__bool__`那么会调用`__len__`如果长度为0则返回`False`.\n\n\n\n\n\n","slug":"notebook/Fluent-Python-1.18","published":1,"date":"2021-01-18T01:15:46.998Z","updated":"2021-01-18T07:02:39.327Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zr006i018o2x8gdeh5","content":"<h1 id=\"开始Fluent-Python\"><a href=\"#开始Fluent-Python\" class=\"headerlink\" title=\"开始Fluent-Python\"></a>开始Fluent-Python</h1><p>前言：</p>\n<p>Here’s the plan: when someone uses a feature you don’t understand, simply shoot them.</p>\n<h1 id=\"1-The-Python-Data-Model\"><a href=\"#1-The-Python-Data-Model\" class=\"headerlink\" title=\"1-The Python Data Model\"></a>1-The Python Data Model</h1><p>魔术方法也叫做Dunder方法，一般under-under-getitem-under-under也可以叫做dunder-getitem.</p>\n<p>Example 1-1</p>\n<p>我们可以通过重写<code>__len__</code>方法与<code>__getitem__</code>方法实现对象的获取书长度，与获取数据。</p>\n<p>特殊方法的调用时隐式的，例如<code>for i in x:</code>就隐式的调用了iter(x).</p>\n<p>代码中不应该有很多对特殊方法的直接调用，除非你在进行元编程。</p>\n<p>Example 1-2</p>\n<p><code>__repr__</code>与<code>__str__</code>方法类似，但是在打印一个实例的信息时会调用<code>__repr</code>方法。如果没有重写该方法console会显示类似<code>&lt;Vector object at 0x10e100070&gt;</code>的信息。</p>\n<p><code>__str__</code>由str()函数调用，强烈建议重写<code>__repr__</code>如果没有<code>__str__</code>则会调用<code>__repr__</code>.</p>\n<p><code>bool()</code>调用<code>__bool__</code>的结果，如果没有实现<code>__bool__</code>那么会调用<code>__len__</code>如果长度为0则返回<code>False</code>.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始Fluent-Python\"><a href=\"#开始Fluent-Python\" class=\"headerlink\" title=\"开始Fluent-Python\"></a>开始Fluent-Python</h1><p>前言：</p>\n<p>Here’s the plan: when someone uses a feature you don’t understand, simply shoot them.</p>\n<h1 id=\"1-The-Python-Data-Model\"><a href=\"#1-The-Python-Data-Model\" class=\"headerlink\" title=\"1-The Python Data Model\"></a>1-The Python Data Model</h1><p>魔术方法也叫做Dunder方法，一般under-under-getitem-under-under也可以叫做dunder-getitem.</p>\n<p>Example 1-1</p>\n<p>我们可以通过重写<code>__len__</code>方法与<code>__getitem__</code>方法实现对象的获取书长度，与获取数据。</p>\n<p>特殊方法的调用时隐式的，例如<code>for i in x:</code>就隐式的调用了iter(x).</p>\n<p>代码中不应该有很多对特殊方法的直接调用，除非你在进行元编程。</p>\n<p>Example 1-2</p>\n<p><code>__repr__</code>与<code>__str__</code>方法类似，但是在打印一个实例的信息时会调用<code>__repr</code>方法。如果没有重写该方法console会显示类似<code>&lt;Vector object at 0x10e100070&gt;</code>的信息。</p>\n<p><code>__str__</code>由str()函数调用，强烈建议重写<code>__repr__</code>如果没有<code>__str__</code>则会调用<code>__repr__</code>.</p>\n<p><code>bool()</code>调用<code>__bool__</code>的结果，如果没有实现<code>__bool__</code>那么会调用<code>__len__</code>如果长度为0则返回<code>False</code>.</p>\n"},{"_content":"## 使用 Pandas 进行数据探索\n\n本次实验通过分析电信运营商的客户离网率数据集来熟悉 Pandas 数据探索的常用方法，并构建一个预测客户离网率的简单模型。\n\n### Pandas 的主要方法\n\nPandas 是基于 NumPy 的一种工具，提供了大量数据探索的方法。Pandas 可以使用类似 SQL 的方式对 .csv、.tsv、.xlsx 等格式的数据进行处理分析。\n\nPandas 主要使用的数据结构是 Series 和 DataFrame 类。下面简要介绍下这两类：\n\n- Series 是一种类似于一维数组的对象，它由一组数据（各种 NumPy 数据类型）及一组与之相关的数据标签（即索引）组成。\n- DataFrame 是一个二维数据结构，即一张表格，其中每列数据的类型相同。你可以把它看成由 Series 实例构成的字典。\n\n下面开始此次实验，我们将通过分析电信运营商的客户离网率数据集来展示 Pandas 的主要方法。\n\n首先载入必要的库，即 NumPy 和 Pandas。\n\n<i class=\"fa fa-arrow-circle-down\" aria-hidden=\"true\"> 教学代码：</i>\n\n\n```python\nimport numpy as np\nimport pandas as pd\n```\n\n通过 `read_csv()` 方法读取数据，然后使用 `head()` 方法查看前 5 行数据。\n\n\n```python\ndataFrame = pd.read_csv('./data/telecom_churn.csv')\n```\n\n上图中的每行对应一位客户，每列对应客户的一个特征。\n\n让我们查看一下该数据库的维度、特征名称和特征类型。\n\n\n```python\ndataFrame.shape\n```\n\n\n\n\n    (3333, 20)\n\n\n\n上述结果表明，我们的列表包含 3333 行和 20 列。下面我们尝试打印列名。\n\n\n```python\ndataFrame.columns\n```\n\n\n\n\n    Index(['State', 'Account length', 'Area code', 'International plan',\n           'Voice mail plan', 'Number vmail messages', 'Total day minutes',\n           'Total day calls', 'Total day charge', 'Total eve minutes',\n           'Total eve calls', 'Total eve charge', 'Total night minutes',\n           'Total night calls', 'Total night charge', 'Total intl minutes',\n           'Total intl calls', 'Total intl charge', 'Customer service calls',\n           'Churn'],\n          dtype='object')\n\n\n\n我们还可以使用 `info()` 方法输出 DataFrame 的一些总体信息。\n\n\n```python\ndataFrame.info()\n```\n\n    <class 'pandas.core.frame.DataFrame'>\n    RangeIndex: 3333 entries, 0 to 3332\n    Data columns (total 20 columns):\n    State                     3333 non-null object\n    Account length            3333 non-null int64\n    Area code                 3333 non-null int64\n    International plan        3333 non-null object\n    Voice mail plan           3333 non-null object\n    Number vmail messages     3333 non-null int64\n    Total day minutes         3333 non-null float64\n    Total day calls           3333 non-null int64\n    Total day charge          3333 non-null float64\n    Total eve minutes         3333 non-null float64\n    Total eve calls           3333 non-null int64\n    Total eve charge          3333 non-null float64\n    Total night minutes       3333 non-null float64\n    Total night calls         3333 non-null int64\n    Total night charge        3333 non-null float64\n    Total intl minutes        3333 non-null float64\n    Total intl calls          3333 non-null int64\n    Total intl charge         3333 non-null float64\n    Customer service calls    3333 non-null int64\n    Churn                     3333 non-null bool\n    dtypes: bool(1), float64(8), int64(8), object(3)\n    memory usage: 498.1+ KB\n\n\n`bool`、`int64`、`float64` 和 `object` 是该数据库特征的数据类型。这一方法同时也会显示是否有缺失值，上述结果表明在该数据集中不存在缺失值，因为每列都包含 3333 个观测，和我们之前使用 `shape` 方法得到的数字是一致的。\n\n`astype()` 方法可以更改列的类型，下列公式将 Churn 离网率 特征修改为 `int64` 类型。\n\n\n```python\ndf = dataFrame\ndf.head(5)\ndf['Churn'] = df['Churn'].astype('int64')\ndf.head(5)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`describe()` 方法可以显示数值特征（`int64` 和 `float64`）的基本统计学特性，如未缺失值的数值、均值、标准差、范围、四分位数等。\n\n\n```python\ndf.describe()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>101.064806</td>\n      <td>437.182418</td>\n      <td>8.099010</td>\n      <td>179.775098</td>\n      <td>100.435644</td>\n      <td>30.562307</td>\n      <td>200.980348</td>\n      <td>100.114311</td>\n      <td>17.083540</td>\n      <td>200.872037</td>\n      <td>100.107711</td>\n      <td>9.039325</td>\n      <td>10.237294</td>\n      <td>4.479448</td>\n      <td>2.764581</td>\n      <td>1.562856</td>\n      <td>0.144914</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>39.822106</td>\n      <td>42.371290</td>\n      <td>13.688365</td>\n      <td>54.467389</td>\n      <td>20.069084</td>\n      <td>9.259435</td>\n      <td>50.713844</td>\n      <td>19.922625</td>\n      <td>4.310668</td>\n      <td>50.573847</td>\n      <td>19.568609</td>\n      <td>2.275873</td>\n      <td>2.791840</td>\n      <td>2.461214</td>\n      <td>0.753773</td>\n      <td>1.315491</td>\n      <td>0.352067</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>23.200000</td>\n      <td>33.000000</td>\n      <td>1.040000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>74.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>143.700000</td>\n      <td>87.000000</td>\n      <td>24.430000</td>\n      <td>166.600000</td>\n      <td>87.000000</td>\n      <td>14.160000</td>\n      <td>167.000000</td>\n      <td>87.000000</td>\n      <td>7.520000</td>\n      <td>8.500000</td>\n      <td>3.000000</td>\n      <td>2.300000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>101.000000</td>\n      <td>415.000000</td>\n      <td>0.000000</td>\n      <td>179.400000</td>\n      <td>101.000000</td>\n      <td>30.500000</td>\n      <td>201.400000</td>\n      <td>100.000000</td>\n      <td>17.120000</td>\n      <td>201.200000</td>\n      <td>100.000000</td>\n      <td>9.050000</td>\n      <td>10.300000</td>\n      <td>4.000000</td>\n      <td>2.780000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>127.000000</td>\n      <td>510.000000</td>\n      <td>20.000000</td>\n      <td>216.400000</td>\n      <td>114.000000</td>\n      <td>36.790000</td>\n      <td>235.300000</td>\n      <td>114.000000</td>\n      <td>20.000000</td>\n      <td>235.300000</td>\n      <td>113.000000</td>\n      <td>10.590000</td>\n      <td>12.100000</td>\n      <td>6.000000</td>\n      <td>3.270000</td>\n      <td>2.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>243.000000</td>\n      <td>510.000000</td>\n      <td>51.000000</td>\n      <td>350.800000</td>\n      <td>165.000000</td>\n      <td>59.640000</td>\n      <td>363.700000</td>\n      <td>170.000000</td>\n      <td>30.910000</td>\n      <td>395.000000</td>\n      <td>175.000000</td>\n      <td>17.770000</td>\n      <td>20.000000</td>\n      <td>20.000000</td>\n      <td>5.400000</td>\n      <td>9.000000</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n通过 include 参数显式指定包含的数据类型，可以查看非数值特征的统计数据。\n\n\n```python\ndf.describe(include=['object', 'bool'])\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333</td>\n      <td>3333</td>\n      <td>3333</td>\n    </tr>\n    <tr>\n      <th>unique</th>\n      <td>51</td>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>top</th>\n      <td>WV</td>\n      <td>No</td>\n      <td>No</td>\n    </tr>\n    <tr>\n      <th>freq</th>\n      <td>106</td>\n      <td>3010</td>\n      <td>2411</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`value_counts()` 方法可以查看类别（类型为 object ）和布尔值（类型为 bool ）特征。让我们看下 Churn 离网率 的分布。\n\n\n```python\ndf['Churn'].value_counts()\n```\n\n\n\n\n    0    2850\n    1     483\n    Name: Churn, dtype: int64\n\n\n\n上述结果表明，在 3333 位客户中， 2850 位是忠实客户，他们的 `Churn` 值为 0。调用 `value_counts()` 函数时，加上 `normalize=True` 参数可以显示比例。\n\n\n```python\ndf['Churn'].value_counts(normalize=True)\n```\n\n\n\n\n    0    0.855086\n    1    0.144914\n    Name: Churn, dtype: float64\n\n\n\n### 排序\n\nDataFrame 可以根据某个变量的值（也就是列）排序。比如，根据每日消费额排序（设置 ascending=False 倒序排列）。\n\n\n```python\ndf.sort_values(by='Total day charge', ascending=False).head(5)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>365</th>\n      <td>CO</td>\n      <td>154</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>350.8</td>\n      <td>75</td>\n      <td>59.64</td>\n      <td>216.5</td>\n      <td>94</td>\n      <td>18.40</td>\n      <td>253.9</td>\n      <td>100</td>\n      <td>11.43</td>\n      <td>10.1</td>\n      <td>9</td>\n      <td>2.73</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>985</th>\n      <td>NY</td>\n      <td>64</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>346.8</td>\n      <td>55</td>\n      <td>58.96</td>\n      <td>249.5</td>\n      <td>79</td>\n      <td>21.21</td>\n      <td>275.4</td>\n      <td>102</td>\n      <td>12.39</td>\n      <td>13.3</td>\n      <td>9</td>\n      <td>3.59</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2594</th>\n      <td>OH</td>\n      <td>115</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>345.3</td>\n      <td>81</td>\n      <td>58.70</td>\n      <td>203.4</td>\n      <td>106</td>\n      <td>17.29</td>\n      <td>217.5</td>\n      <td>107</td>\n      <td>9.79</td>\n      <td>11.8</td>\n      <td>8</td>\n      <td>3.19</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>156</th>\n      <td>OH</td>\n      <td>83</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>337.4</td>\n      <td>120</td>\n      <td>57.36</td>\n      <td>227.4</td>\n      <td>116</td>\n      <td>19.33</td>\n      <td>153.9</td>\n      <td>114</td>\n      <td>6.93</td>\n      <td>15.8</td>\n      <td>7</td>\n      <td>4.27</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>MO</td>\n      <td>112</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>335.5</td>\n      <td>77</td>\n      <td>57.04</td>\n      <td>212.5</td>\n      <td>109</td>\n      <td>18.06</td>\n      <td>265.0</td>\n      <td>132</td>\n      <td>11.93</td>\n      <td>12.7</td>\n      <td>8</td>\n      <td>3.43</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n此外，还可以根据多个列的数值排序。下面函数实现的功能为：先按 Churn 离网率 升序排列，再按 Total day charge 每日总话费 降序排列，优先级 Churn > Tatal day charge。\n\n\n```python\ndf.sort_values(by=['Churn', 'Total day charge'], ascending=[True, False]).head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>688</th>\n      <td>MN</td>\n      <td>13</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>21</td>\n      <td>315.6</td>\n      <td>105</td>\n      <td>53.65</td>\n      <td>208.9</td>\n      <td>71</td>\n      <td>17.76</td>\n      <td>260.1</td>\n      <td>123</td>\n      <td>11.70</td>\n      <td>12.1</td>\n      <td>3</td>\n      <td>3.27</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2259</th>\n      <td>NC</td>\n      <td>210</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>31</td>\n      <td>313.8</td>\n      <td>87</td>\n      <td>53.35</td>\n      <td>147.7</td>\n      <td>103</td>\n      <td>12.55</td>\n      <td>192.7</td>\n      <td>97</td>\n      <td>8.67</td>\n      <td>10.1</td>\n      <td>7</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>534</th>\n      <td>LA</td>\n      <td>67</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>310.4</td>\n      <td>97</td>\n      <td>52.77</td>\n      <td>66.5</td>\n      <td>123</td>\n      <td>5.65</td>\n      <td>246.5</td>\n      <td>99</td>\n      <td>11.09</td>\n      <td>9.2</td>\n      <td>10</td>\n      <td>2.48</td>\n      <td>4</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>575</th>\n      <td>SD</td>\n      <td>114</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>36</td>\n      <td>309.9</td>\n      <td>90</td>\n      <td>52.68</td>\n      <td>200.3</td>\n      <td>89</td>\n      <td>17.03</td>\n      <td>183.5</td>\n      <td>105</td>\n      <td>8.26</td>\n      <td>14.2</td>\n      <td>2</td>\n      <td>3.83</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2858</th>\n      <td>AL</td>\n      <td>141</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>28</td>\n      <td>308.0</td>\n      <td>123</td>\n      <td>52.36</td>\n      <td>247.8</td>\n      <td>128</td>\n      <td>21.06</td>\n      <td>152.9</td>\n      <td>103</td>\n      <td>6.88</td>\n      <td>7.4</td>\n      <td>3</td>\n      <td>2.00</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 索引和获取数据\n\nDataFrame 可以以不同的方式进行索引。\n\n使用 `DataFrame['Name']` 可以得到一个单独的列。比如，离网率有多高？\n\n\n```python\ndf['Churn'].mean()\n```\n\n\n\n\n    0.14491449144914492\n\n\n\n\n对一家公司而言，14.5% 的离网率是一个很糟糕的数据，这么高的离网率可能导致公司破产。\n\n布尔值索引同样很方便，语法是 `df[P(df['Name'])]`，P 是在检查 Name 列每个元素时所使用的逻辑条件。这一索引的输出是 DataFrame 的 Name 列中满足 P 条件的行。\n\n让我们使用布尔值索引来回答这样以下问题：离网用户的数值变量的均值是多少？\n\n\n```python\ndf[df['Churn'] == 1].mean()\n```\n\n\n\n\n    Account length            102.664596\n    Area code                 437.817805\n    Number vmail messages       5.115942\n    Total day minutes         206.914079\n    Total day calls           101.335404\n    Total day charge           35.175921\n    Total eve minutes         212.410145\n    Total eve calls           100.561077\n    Total eve charge           18.054969\n    Total night minutes       205.231677\n    Total night calls         100.399586\n    Total night charge          9.235528\n    Total intl minutes         10.700000\n    Total intl calls            4.163561\n    Total intl charge           2.889545\n    Customer service calls      2.229814\n    Churn                       1.000000\n    dtype: float64\n\n\n\n离网用户在白天打电话的总时长的均值是多少？\n\n\n```python\ndf[df['Churn'] == 1]['Total day minutes'].mean()\n```\n\n\n\n\n    206.91407867494823\n\n\n\n未使用国际套餐（`International plan == NO`）的忠实用户（`Churn == 0`）所打的最长的国际长途是多久？\n\n\n```python\ndf[(df['Churn'] == 1) & (df['International plan'] == 'No')]['Total intl minutes'].max()\ndf[(df['Churn'] == 0) & (df['International plan'] == 'No')]['Total intl minutes'].max()\n```\n\n\n\n\n    18.9\n\n\n\nDataFrame 可以通过列名、行名、行号进行索引。`loc` 方法为通过名称索引，`iloc` 方法为通过数字索引。\n\n通过 `loc` 方法输出 0 至 5 行、State 州 至 Area code 区号 的数据。\n\n\n```python\ndf.loc[0:5, ['State','Area code']]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>510</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n通过 `ilo` 方法输出前 5 行的前 3 列数据（和典型的 Python 切片一样，不含最大值）。\n\n\n```python\ndf.iloc[0:5, 0:3]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`df[:1]` 和 `df[-1:]` 可以得到 DataFrame 的首行和末行。\n\n\n```python\ndf[-2:]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3331</th>\n      <td>CT</td>\n      <td>184</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>213.8</td>\n      <td>105</td>\n      <td>36.35</td>\n      <td>159.6</td>\n      <td>84</td>\n      <td>13.57</td>\n      <td>139.2</td>\n      <td>137</td>\n      <td>6.26</td>\n      <td>5.0</td>\n      <td>10</td>\n      <td>1.35</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3332</th>\n      <td>TN</td>\n      <td>74</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>234.4</td>\n      <td>113</td>\n      <td>39.85</td>\n      <td>265.9</td>\n      <td>82</td>\n      <td>22.60</td>\n      <td>241.4</td>\n      <td>77</td>\n      <td>10.86</td>\n      <td>13.7</td>\n      <td>4</td>\n      <td>3.70</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 应用函数到单元格、列、行\n\n下面通过 `apply()` 方法应用函数 `max` 至每一列，即输出每列的最大值。\n\n\n```python\ndf.apply(np.max)\n```\n\n\n\n\n    State                        WY\n    Account length              243\n    Area code                   510\n    International plan          Yes\n    Voice mail plan             Yes\n    Number vmail messages        51\n    Total day minutes         350.8\n    Total day calls             165\n    Total day charge          59.64\n    Total eve minutes         363.7\n    Total eve calls             170\n    Total eve charge          30.91\n    Total night minutes         395\n    Total night calls           175\n    Total night charge        17.77\n    Total intl minutes           20\n    Total intl calls             20\n    Total intl charge           5.4\n    Customer service calls        9\n    Churn                         1\n    dtype: object\n\n\n\n`apply()` 方法也可以应用函数至每一行，指定 axis=1 即可。在这种情况下，使用 `lambda` 函数十分方便。比如，下面函数选中了所有以 W 开头的州。\n\n\n```python\ndf[df['State'].apply(lambda state: state[0] == 'W')].head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9</th>\n      <td>WV</td>\n      <td>141</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>37</td>\n      <td>258.6</td>\n      <td>84</td>\n      <td>43.96</td>\n      <td>222.0</td>\n      <td>111</td>\n      <td>18.87</td>\n      <td>326.4</td>\n      <td>97</td>\n      <td>14.69</td>\n      <td>11.2</td>\n      <td>5</td>\n      <td>3.02</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>WY</td>\n      <td>57</td>\n      <td>408</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>39</td>\n      <td>213.0</td>\n      <td>115</td>\n      <td>36.21</td>\n      <td>191.1</td>\n      <td>112</td>\n      <td>16.24</td>\n      <td>182.7</td>\n      <td>115</td>\n      <td>8.22</td>\n      <td>9.5</td>\n      <td>3</td>\n      <td>2.57</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>WI</td>\n      <td>64</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>154.0</td>\n      <td>67</td>\n      <td>26.18</td>\n      <td>225.8</td>\n      <td>118</td>\n      <td>19.19</td>\n      <td>265.3</td>\n      <td>86</td>\n      <td>11.94</td>\n      <td>3.5</td>\n      <td>3</td>\n      <td>0.95</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>WY</td>\n      <td>97</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>24</td>\n      <td>133.2</td>\n      <td>135</td>\n      <td>22.64</td>\n      <td>217.2</td>\n      <td>58</td>\n      <td>18.46</td>\n      <td>70.6</td>\n      <td>79</td>\n      <td>3.18</td>\n      <td>11.0</td>\n      <td>3</td>\n      <td>2.97</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>WY</td>\n      <td>87</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>151.0</td>\n      <td>83</td>\n      <td>25.67</td>\n      <td>219.7</td>\n      <td>116</td>\n      <td>18.67</td>\n      <td>203.9</td>\n      <td>127</td>\n      <td>9.18</td>\n      <td>9.7</td>\n      <td>3</td>\n      <td>2.62</td>\n      <td>5</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`map()` 方法可以通过一个 {old_value:new_value} 形式的字典替换某一列中的值。\n\n\n```python\nd = {'No': False, 'Yes': True}\ndf['International plan'] = df['International plan'].map(d)\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n当然，使用 `repalce()` 方法一样可以达到替换的目的。\n\n\n```python\ndf = df.replace({'Voice mail plan': d})\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 增减 DataFrame 的行列\n\n在 DataFrame 中新增列有很多方法，比如，使用 `insert()`方法添加列，为所有用户计算总的 Total calls 电话量。\n\n\n```python\ntotal_calls = df['Total day calls'] + df['Total eve calls'] + \\\ndf['Total night calls'] + df['Total intl calls']\n\ndf.insert(loc=len(df.columns), column='Total calls 2', value=total_calls)\n\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n上面的代码创建了一个中间 Series 实例，即 tatal_calls，其实可以在不创造这个实例的情况下直接添加列。\n\n\n```python\ndf['Total charge'] = df['Total day charge'] + df['Total eve charge'] + \\\ndf['Total night charge'] + df['Total intl charge']\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n      <td>59.24</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n      <td>62.29</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 23 columns</p>\n</div>\n\n\n\n使用 `drop()` 方法删除列和行。\n\n\n```python\ndf1 = df.drop([1, 2])\ndf1.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>118</td>\n      <td>510</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>223.4</td>\n      <td>98</td>\n      <td>37.98</td>\n      <td>220.6</td>\n      <td>...</td>\n      <td>203.9</td>\n      <td>118</td>\n      <td>9.18</td>\n      <td>6.3</td>\n      <td>6</td>\n      <td>1.70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>323</td>\n      <td>67.61</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MA</td>\n      <td>121</td>\n      <td>510</td>\n      <td>False</td>\n      <td>True</td>\n      <td>24</td>\n      <td>218.2</td>\n      <td>88</td>\n      <td>37.09</td>\n      <td>348.5</td>\n      <td>...</td>\n      <td>212.6</td>\n      <td>118</td>\n      <td>9.57</td>\n      <td>7.5</td>\n      <td>7</td>\n      <td>2.03</td>\n      <td>3</td>\n      <td>0</td>\n      <td>321</td>\n      <td>78.31</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n对上述代码的部分解释：\n\n- 将相应的索引 `['Total charge', 'Total calls']` 和 `axis` 参数（1 表示删除列，0 表示删除行，默认值为 0）传给 `drop`。\n- `inplace` 参数表示是否修改原始 DataFrame （False 表示不修改现有 DataFrame，返回一个新 DataFrame，True 表示修改当前 DataFrame）。\n\n## 预测离网率\n\n首先，通过 `crosstab()` 方法构建一个交叉表来查看 International plan 国际套餐 变量和 Churn 离网率 的相关性，同时使用 `countplot()` 方法构建计数直方图来可视化结果。\n\n\n```python\n# 加载模块，配置绘图\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n\n\n```python\nsns.countplot(x='International plan', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11f0c8450>\n\n\n\n\n![png](data/output_75_1.png)\n\n\n上图表明，开通了国际套餐的用户的离网率要高很多，这是一个很有趣的观测结果。也许，国际电话高昂的话费让客户很不满意。\n\n同理，查看 Customer service calls 客服呼叫 变量与 Chunrn 离网率 的相关性，并可视化结果。\n\n\n```python\npd.crosstab(df['Churn'], df['Customer service calls'], margins=True)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Customer service calls</th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n      <th>8</th>\n      <th>9</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>605</td>\n      <td>1059</td>\n      <td>672</td>\n      <td>385</td>\n      <td>90</td>\n      <td>26</td>\n      <td>8</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2850</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92</td>\n      <td>122</td>\n      <td>87</td>\n      <td>44</td>\n      <td>76</td>\n      <td>40</td>\n      <td>14</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>483</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>697</td>\n      <td>1181</td>\n      <td>759</td>\n      <td>429</td>\n      <td>166</td>\n      <td>66</td>\n      <td>22</td>\n      <td>9</td>\n      <td>2</td>\n      <td>2</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n```python\nsns.countplot(x='Customer service calls', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11cb70d50>\n\n\n\n\n![png](data/output_79_1.png)\n\n\n上图表明，在客服呼叫 4 次之后，客户的离网率显著提升。\n\n为了更好的突出 Customer service call 客服呼叫 和 Churn 离网率 的关系，可以给 DataFrame 添加一个二元属性 Many_service_calls，即客户呼叫超过 3 次（Customer service calls > 3）。看下它与离网率的相关性，并可视化结果。\n\n\n```python\ndf['Many_service_calls'] = (df['Customer service calls'] > 3).astype('int')\n\npd.crosstab(df['Many_service_calls'], df['Churn'], margins=True)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Many_service_calls</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2721</td>\n      <td>345</td>\n      <td>3066</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>129</td>\n      <td>138</td>\n      <td>267</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>2850</td>\n      <td>483</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n```python\nsns.countplot(x='Many_service_calls', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11ce1c850>\n\n\n\n\n![png](data/output_83_1.png)\n\n\n现在我们可以创建另一张交叉表，将 Churn 离网率 与 International plan 国际套餐 及新创建的 Many_service_calls 多次客服呼叫 关联起来。\n\n\n\n\n```python\npd.crosstab(df['Many_service_calls'] & df['International plan'], df['Churn'])\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n    <tr>\n      <th>row_0</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>2841</td>\n      <td>464</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>9</td>\n      <td>19</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n上表表明，在客服呼叫次数超过 3 次并且已办理 International Plan 国际套餐 的情况下，预测一名客户不忠诚的准确率（Accuracy）可以达到 85.8％，计算公式如下：\n\n$$准确率（Accuracy）=\\frac{TP+TN}{TP+TN+FP+FN}=\\frac{2841+19}{2841+9+19+464}\\times100\\%$$\n\n其中，TP 表示将 True 预测为 True 的数量，TN 表示将 Flase 预测为 Flase 的数量，FP 表示将 Flase 预测为 True 的数量，FN 表示将 True 预测为 Flase 的数量。\n\n复习一下本次实验的内容：\n\n- 样本中忠实客户的份额为 85.5%。这意味着最简单的预测「忠实客户」的模型有 85.5% 的概率猜对。也就是说，后续模型的准确率（Accuracy）不应该比这个数字少，并且很有希望显著高于这个数字。\n- 基于一个简单的「（客服呼叫次数 > 3） & （国际套餐 = True） => Churn = 1, else Churn = 0」规则的预测模型，可以得到 85.8% 的准确率。以后我们将讨论决策树，看看如何仅仅基于输入数据自动找出类似的规则，而不需要我们手工设定。我们没有应用机器学习方法就得到了两个准确率（85.5% 和 85.8%），它们可作为后续其他模型的基线。如果经过大量的努力，我们仅将准确率提高了 0.5%，那么我们努力的方向可能出现了偏差，因为仅仅使用一个包含两个限制规则的简单模型就已提升了 0.3% 的准确率。\n- 在训练复杂模型之前，建议预处理一下数据，绘制一些图表，做一些简单的假设。此外，在实际任务上应用机器学习时，通常从简单的方案开始，接着尝试更复杂的方案。\n\n### 实验总结\n\n本次实验使用 Pandas 对数据进行了一定程度的分析和探索，交叉表、透视表等方法的运用将使你在数据探索过程中事半功倍。\n","source":"_posts/mlsec/使用-Pandas-进行数据探索.md","raw":"## 使用 Pandas 进行数据探索\n\n本次实验通过分析电信运营商的客户离网率数据集来熟悉 Pandas 数据探索的常用方法，并构建一个预测客户离网率的简单模型。\n\n### Pandas 的主要方法\n\nPandas 是基于 NumPy 的一种工具，提供了大量数据探索的方法。Pandas 可以使用类似 SQL 的方式对 .csv、.tsv、.xlsx 等格式的数据进行处理分析。\n\nPandas 主要使用的数据结构是 Series 和 DataFrame 类。下面简要介绍下这两类：\n\n- Series 是一种类似于一维数组的对象，它由一组数据（各种 NumPy 数据类型）及一组与之相关的数据标签（即索引）组成。\n- DataFrame 是一个二维数据结构，即一张表格，其中每列数据的类型相同。你可以把它看成由 Series 实例构成的字典。\n\n下面开始此次实验，我们将通过分析电信运营商的客户离网率数据集来展示 Pandas 的主要方法。\n\n首先载入必要的库，即 NumPy 和 Pandas。\n\n<i class=\"fa fa-arrow-circle-down\" aria-hidden=\"true\"> 教学代码：</i>\n\n\n```python\nimport numpy as np\nimport pandas as pd\n```\n\n通过 `read_csv()` 方法读取数据，然后使用 `head()` 方法查看前 5 行数据。\n\n\n```python\ndataFrame = pd.read_csv('./data/telecom_churn.csv')\n```\n\n上图中的每行对应一位客户，每列对应客户的一个特征。\n\n让我们查看一下该数据库的维度、特征名称和特征类型。\n\n\n```python\ndataFrame.shape\n```\n\n\n\n\n    (3333, 20)\n\n\n\n上述结果表明，我们的列表包含 3333 行和 20 列。下面我们尝试打印列名。\n\n\n```python\ndataFrame.columns\n```\n\n\n\n\n    Index(['State', 'Account length', 'Area code', 'International plan',\n           'Voice mail plan', 'Number vmail messages', 'Total day minutes',\n           'Total day calls', 'Total day charge', 'Total eve minutes',\n           'Total eve calls', 'Total eve charge', 'Total night minutes',\n           'Total night calls', 'Total night charge', 'Total intl minutes',\n           'Total intl calls', 'Total intl charge', 'Customer service calls',\n           'Churn'],\n          dtype='object')\n\n\n\n我们还可以使用 `info()` 方法输出 DataFrame 的一些总体信息。\n\n\n```python\ndataFrame.info()\n```\n\n    <class 'pandas.core.frame.DataFrame'>\n    RangeIndex: 3333 entries, 0 to 3332\n    Data columns (total 20 columns):\n    State                     3333 non-null object\n    Account length            3333 non-null int64\n    Area code                 3333 non-null int64\n    International plan        3333 non-null object\n    Voice mail plan           3333 non-null object\n    Number vmail messages     3333 non-null int64\n    Total day minutes         3333 non-null float64\n    Total day calls           3333 non-null int64\n    Total day charge          3333 non-null float64\n    Total eve minutes         3333 non-null float64\n    Total eve calls           3333 non-null int64\n    Total eve charge          3333 non-null float64\n    Total night minutes       3333 non-null float64\n    Total night calls         3333 non-null int64\n    Total night charge        3333 non-null float64\n    Total intl minutes        3333 non-null float64\n    Total intl calls          3333 non-null int64\n    Total intl charge         3333 non-null float64\n    Customer service calls    3333 non-null int64\n    Churn                     3333 non-null bool\n    dtypes: bool(1), float64(8), int64(8), object(3)\n    memory usage: 498.1+ KB\n\n\n`bool`、`int64`、`float64` 和 `object` 是该数据库特征的数据类型。这一方法同时也会显示是否有缺失值，上述结果表明在该数据集中不存在缺失值，因为每列都包含 3333 个观测，和我们之前使用 `shape` 方法得到的数字是一致的。\n\n`astype()` 方法可以更改列的类型，下列公式将 Churn 离网率 特征修改为 `int64` 类型。\n\n\n```python\ndf = dataFrame\ndf.head(5)\ndf['Churn'] = df['Churn'].astype('int64')\ndf.head(5)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`describe()` 方法可以显示数值特征（`int64` 和 `float64`）的基本统计学特性，如未缺失值的数值、均值、标准差、范围、四分位数等。\n\n\n```python\ndf.describe()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>101.064806</td>\n      <td>437.182418</td>\n      <td>8.099010</td>\n      <td>179.775098</td>\n      <td>100.435644</td>\n      <td>30.562307</td>\n      <td>200.980348</td>\n      <td>100.114311</td>\n      <td>17.083540</td>\n      <td>200.872037</td>\n      <td>100.107711</td>\n      <td>9.039325</td>\n      <td>10.237294</td>\n      <td>4.479448</td>\n      <td>2.764581</td>\n      <td>1.562856</td>\n      <td>0.144914</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>39.822106</td>\n      <td>42.371290</td>\n      <td>13.688365</td>\n      <td>54.467389</td>\n      <td>20.069084</td>\n      <td>9.259435</td>\n      <td>50.713844</td>\n      <td>19.922625</td>\n      <td>4.310668</td>\n      <td>50.573847</td>\n      <td>19.568609</td>\n      <td>2.275873</td>\n      <td>2.791840</td>\n      <td>2.461214</td>\n      <td>0.753773</td>\n      <td>1.315491</td>\n      <td>0.352067</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>23.200000</td>\n      <td>33.000000</td>\n      <td>1.040000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>74.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>143.700000</td>\n      <td>87.000000</td>\n      <td>24.430000</td>\n      <td>166.600000</td>\n      <td>87.000000</td>\n      <td>14.160000</td>\n      <td>167.000000</td>\n      <td>87.000000</td>\n      <td>7.520000</td>\n      <td>8.500000</td>\n      <td>3.000000</td>\n      <td>2.300000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>101.000000</td>\n      <td>415.000000</td>\n      <td>0.000000</td>\n      <td>179.400000</td>\n      <td>101.000000</td>\n      <td>30.500000</td>\n      <td>201.400000</td>\n      <td>100.000000</td>\n      <td>17.120000</td>\n      <td>201.200000</td>\n      <td>100.000000</td>\n      <td>9.050000</td>\n      <td>10.300000</td>\n      <td>4.000000</td>\n      <td>2.780000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>127.000000</td>\n      <td>510.000000</td>\n      <td>20.000000</td>\n      <td>216.400000</td>\n      <td>114.000000</td>\n      <td>36.790000</td>\n      <td>235.300000</td>\n      <td>114.000000</td>\n      <td>20.000000</td>\n      <td>235.300000</td>\n      <td>113.000000</td>\n      <td>10.590000</td>\n      <td>12.100000</td>\n      <td>6.000000</td>\n      <td>3.270000</td>\n      <td>2.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>243.000000</td>\n      <td>510.000000</td>\n      <td>51.000000</td>\n      <td>350.800000</td>\n      <td>165.000000</td>\n      <td>59.640000</td>\n      <td>363.700000</td>\n      <td>170.000000</td>\n      <td>30.910000</td>\n      <td>395.000000</td>\n      <td>175.000000</td>\n      <td>17.770000</td>\n      <td>20.000000</td>\n      <td>20.000000</td>\n      <td>5.400000</td>\n      <td>9.000000</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n通过 include 参数显式指定包含的数据类型，可以查看非数值特征的统计数据。\n\n\n```python\ndf.describe(include=['object', 'bool'])\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333</td>\n      <td>3333</td>\n      <td>3333</td>\n    </tr>\n    <tr>\n      <th>unique</th>\n      <td>51</td>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>top</th>\n      <td>WV</td>\n      <td>No</td>\n      <td>No</td>\n    </tr>\n    <tr>\n      <th>freq</th>\n      <td>106</td>\n      <td>3010</td>\n      <td>2411</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`value_counts()` 方法可以查看类别（类型为 object ）和布尔值（类型为 bool ）特征。让我们看下 Churn 离网率 的分布。\n\n\n```python\ndf['Churn'].value_counts()\n```\n\n\n\n\n    0    2850\n    1     483\n    Name: Churn, dtype: int64\n\n\n\n上述结果表明，在 3333 位客户中， 2850 位是忠实客户，他们的 `Churn` 值为 0。调用 `value_counts()` 函数时，加上 `normalize=True` 参数可以显示比例。\n\n\n```python\ndf['Churn'].value_counts(normalize=True)\n```\n\n\n\n\n    0    0.855086\n    1    0.144914\n    Name: Churn, dtype: float64\n\n\n\n### 排序\n\nDataFrame 可以根据某个变量的值（也就是列）排序。比如，根据每日消费额排序（设置 ascending=False 倒序排列）。\n\n\n```python\ndf.sort_values(by='Total day charge', ascending=False).head(5)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>365</th>\n      <td>CO</td>\n      <td>154</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>350.8</td>\n      <td>75</td>\n      <td>59.64</td>\n      <td>216.5</td>\n      <td>94</td>\n      <td>18.40</td>\n      <td>253.9</td>\n      <td>100</td>\n      <td>11.43</td>\n      <td>10.1</td>\n      <td>9</td>\n      <td>2.73</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>985</th>\n      <td>NY</td>\n      <td>64</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>346.8</td>\n      <td>55</td>\n      <td>58.96</td>\n      <td>249.5</td>\n      <td>79</td>\n      <td>21.21</td>\n      <td>275.4</td>\n      <td>102</td>\n      <td>12.39</td>\n      <td>13.3</td>\n      <td>9</td>\n      <td>3.59</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2594</th>\n      <td>OH</td>\n      <td>115</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>345.3</td>\n      <td>81</td>\n      <td>58.70</td>\n      <td>203.4</td>\n      <td>106</td>\n      <td>17.29</td>\n      <td>217.5</td>\n      <td>107</td>\n      <td>9.79</td>\n      <td>11.8</td>\n      <td>8</td>\n      <td>3.19</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>156</th>\n      <td>OH</td>\n      <td>83</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>337.4</td>\n      <td>120</td>\n      <td>57.36</td>\n      <td>227.4</td>\n      <td>116</td>\n      <td>19.33</td>\n      <td>153.9</td>\n      <td>114</td>\n      <td>6.93</td>\n      <td>15.8</td>\n      <td>7</td>\n      <td>4.27</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>MO</td>\n      <td>112</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>335.5</td>\n      <td>77</td>\n      <td>57.04</td>\n      <td>212.5</td>\n      <td>109</td>\n      <td>18.06</td>\n      <td>265.0</td>\n      <td>132</td>\n      <td>11.93</td>\n      <td>12.7</td>\n      <td>8</td>\n      <td>3.43</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n此外，还可以根据多个列的数值排序。下面函数实现的功能为：先按 Churn 离网率 升序排列，再按 Total day charge 每日总话费 降序排列，优先级 Churn > Tatal day charge。\n\n\n```python\ndf.sort_values(by=['Churn', 'Total day charge'], ascending=[True, False]).head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>688</th>\n      <td>MN</td>\n      <td>13</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>21</td>\n      <td>315.6</td>\n      <td>105</td>\n      <td>53.65</td>\n      <td>208.9</td>\n      <td>71</td>\n      <td>17.76</td>\n      <td>260.1</td>\n      <td>123</td>\n      <td>11.70</td>\n      <td>12.1</td>\n      <td>3</td>\n      <td>3.27</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2259</th>\n      <td>NC</td>\n      <td>210</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>31</td>\n      <td>313.8</td>\n      <td>87</td>\n      <td>53.35</td>\n      <td>147.7</td>\n      <td>103</td>\n      <td>12.55</td>\n      <td>192.7</td>\n      <td>97</td>\n      <td>8.67</td>\n      <td>10.1</td>\n      <td>7</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>534</th>\n      <td>LA</td>\n      <td>67</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>310.4</td>\n      <td>97</td>\n      <td>52.77</td>\n      <td>66.5</td>\n      <td>123</td>\n      <td>5.65</td>\n      <td>246.5</td>\n      <td>99</td>\n      <td>11.09</td>\n      <td>9.2</td>\n      <td>10</td>\n      <td>2.48</td>\n      <td>4</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>575</th>\n      <td>SD</td>\n      <td>114</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>36</td>\n      <td>309.9</td>\n      <td>90</td>\n      <td>52.68</td>\n      <td>200.3</td>\n      <td>89</td>\n      <td>17.03</td>\n      <td>183.5</td>\n      <td>105</td>\n      <td>8.26</td>\n      <td>14.2</td>\n      <td>2</td>\n      <td>3.83</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2858</th>\n      <td>AL</td>\n      <td>141</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>28</td>\n      <td>308.0</td>\n      <td>123</td>\n      <td>52.36</td>\n      <td>247.8</td>\n      <td>128</td>\n      <td>21.06</td>\n      <td>152.9</td>\n      <td>103</td>\n      <td>6.88</td>\n      <td>7.4</td>\n      <td>3</td>\n      <td>2.00</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 索引和获取数据\n\nDataFrame 可以以不同的方式进行索引。\n\n使用 `DataFrame['Name']` 可以得到一个单独的列。比如，离网率有多高？\n\n\n```python\ndf['Churn'].mean()\n```\n\n\n\n\n    0.14491449144914492\n\n\n\n\n对一家公司而言，14.5% 的离网率是一个很糟糕的数据，这么高的离网率可能导致公司破产。\n\n布尔值索引同样很方便，语法是 `df[P(df['Name'])]`，P 是在检查 Name 列每个元素时所使用的逻辑条件。这一索引的输出是 DataFrame 的 Name 列中满足 P 条件的行。\n\n让我们使用布尔值索引来回答这样以下问题：离网用户的数值变量的均值是多少？\n\n\n```python\ndf[df['Churn'] == 1].mean()\n```\n\n\n\n\n    Account length            102.664596\n    Area code                 437.817805\n    Number vmail messages       5.115942\n    Total day minutes         206.914079\n    Total day calls           101.335404\n    Total day charge           35.175921\n    Total eve minutes         212.410145\n    Total eve calls           100.561077\n    Total eve charge           18.054969\n    Total night minutes       205.231677\n    Total night calls         100.399586\n    Total night charge          9.235528\n    Total intl minutes         10.700000\n    Total intl calls            4.163561\n    Total intl charge           2.889545\n    Customer service calls      2.229814\n    Churn                       1.000000\n    dtype: float64\n\n\n\n离网用户在白天打电话的总时长的均值是多少？\n\n\n```python\ndf[df['Churn'] == 1]['Total day minutes'].mean()\n```\n\n\n\n\n    206.91407867494823\n\n\n\n未使用国际套餐（`International plan == NO`）的忠实用户（`Churn == 0`）所打的最长的国际长途是多久？\n\n\n```python\ndf[(df['Churn'] == 1) & (df['International plan'] == 'No')]['Total intl minutes'].max()\ndf[(df['Churn'] == 0) & (df['International plan'] == 'No')]['Total intl minutes'].max()\n```\n\n\n\n\n    18.9\n\n\n\nDataFrame 可以通过列名、行名、行号进行索引。`loc` 方法为通过名称索引，`iloc` 方法为通过数字索引。\n\n通过 `loc` 方法输出 0 至 5 行、State 州 至 Area code 区号 的数据。\n\n\n```python\ndf.loc[0:5, ['State','Area code']]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>510</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n通过 `ilo` 方法输出前 5 行的前 3 列数据（和典型的 Python 切片一样，不含最大值）。\n\n\n```python\ndf.iloc[0:5, 0:3]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`df[:1]` 和 `df[-1:]` 可以得到 DataFrame 的首行和末行。\n\n\n```python\ndf[-2:]\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3331</th>\n      <td>CT</td>\n      <td>184</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>213.8</td>\n      <td>105</td>\n      <td>36.35</td>\n      <td>159.6</td>\n      <td>84</td>\n      <td>13.57</td>\n      <td>139.2</td>\n      <td>137</td>\n      <td>6.26</td>\n      <td>5.0</td>\n      <td>10</td>\n      <td>1.35</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3332</th>\n      <td>TN</td>\n      <td>74</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>234.4</td>\n      <td>113</td>\n      <td>39.85</td>\n      <td>265.9</td>\n      <td>82</td>\n      <td>22.60</td>\n      <td>241.4</td>\n      <td>77</td>\n      <td>10.86</td>\n      <td>13.7</td>\n      <td>4</td>\n      <td>3.70</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 应用函数到单元格、列、行\n\n下面通过 `apply()` 方法应用函数 `max` 至每一列，即输出每列的最大值。\n\n\n```python\ndf.apply(np.max)\n```\n\n\n\n\n    State                        WY\n    Account length              243\n    Area code                   510\n    International plan          Yes\n    Voice mail plan             Yes\n    Number vmail messages        51\n    Total day minutes         350.8\n    Total day calls             165\n    Total day charge          59.64\n    Total eve minutes         363.7\n    Total eve calls             170\n    Total eve charge          30.91\n    Total night minutes         395\n    Total night calls           175\n    Total night charge        17.77\n    Total intl minutes           20\n    Total intl calls             20\n    Total intl charge           5.4\n    Customer service calls        9\n    Churn                         1\n    dtype: object\n\n\n\n`apply()` 方法也可以应用函数至每一行，指定 axis=1 即可。在这种情况下，使用 `lambda` 函数十分方便。比如，下面函数选中了所有以 W 开头的州。\n\n\n```python\ndf[df['State'].apply(lambda state: state[0] == 'W')].head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9</th>\n      <td>WV</td>\n      <td>141</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>37</td>\n      <td>258.6</td>\n      <td>84</td>\n      <td>43.96</td>\n      <td>222.0</td>\n      <td>111</td>\n      <td>18.87</td>\n      <td>326.4</td>\n      <td>97</td>\n      <td>14.69</td>\n      <td>11.2</td>\n      <td>5</td>\n      <td>3.02</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>WY</td>\n      <td>57</td>\n      <td>408</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>39</td>\n      <td>213.0</td>\n      <td>115</td>\n      <td>36.21</td>\n      <td>191.1</td>\n      <td>112</td>\n      <td>16.24</td>\n      <td>182.7</td>\n      <td>115</td>\n      <td>8.22</td>\n      <td>9.5</td>\n      <td>3</td>\n      <td>2.57</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>WI</td>\n      <td>64</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>154.0</td>\n      <td>67</td>\n      <td>26.18</td>\n      <td>225.8</td>\n      <td>118</td>\n      <td>19.19</td>\n      <td>265.3</td>\n      <td>86</td>\n      <td>11.94</td>\n      <td>3.5</td>\n      <td>3</td>\n      <td>0.95</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>WY</td>\n      <td>97</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>24</td>\n      <td>133.2</td>\n      <td>135</td>\n      <td>22.64</td>\n      <td>217.2</td>\n      <td>58</td>\n      <td>18.46</td>\n      <td>70.6</td>\n      <td>79</td>\n      <td>3.18</td>\n      <td>11.0</td>\n      <td>3</td>\n      <td>2.97</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>WY</td>\n      <td>87</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>151.0</td>\n      <td>83</td>\n      <td>25.67</td>\n      <td>219.7</td>\n      <td>116</td>\n      <td>18.67</td>\n      <td>203.9</td>\n      <td>127</td>\n      <td>9.18</td>\n      <td>9.7</td>\n      <td>3</td>\n      <td>2.62</td>\n      <td>5</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n`map()` 方法可以通过一个 {old_value:new_value} 形式的字典替换某一列中的值。\n\n\n```python\nd = {'No': False, 'Yes': True}\ndf['International plan'] = df['International plan'].map(d)\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n当然，使用 `repalce()` 方法一样可以达到替换的目的。\n\n\n```python\ndf = df.replace({'Voice mail plan': d})\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n### 增减 DataFrame 的行列\n\n在 DataFrame 中新增列有很多方法，比如，使用 `insert()`方法添加列，为所有用户计算总的 Total calls 电话量。\n\n\n```python\ntotal_calls = df['Total day calls'] + df['Total eve calls'] + \\\ndf['Total night calls'] + df['Total intl calls']\n\ndf.insert(loc=len(df.columns), column='Total calls 2', value=total_calls)\n\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n上面的代码创建了一个中间 Series 实例，即 tatal_calls，其实可以在不创造这个实例的情况下直接添加列。\n\n\n```python\ndf['Total charge'] = df['Total day charge'] + df['Total eve charge'] + \\\ndf['Total night charge'] + df['Total intl charge']\ndf.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n      <td>59.24</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n      <td>62.29</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 23 columns</p>\n</div>\n\n\n\n使用 `drop()` 方法删除列和行。\n\n\n```python\ndf1 = df.drop([1, 2])\ndf1.head()\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>118</td>\n      <td>510</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>223.4</td>\n      <td>98</td>\n      <td>37.98</td>\n      <td>220.6</td>\n      <td>...</td>\n      <td>203.9</td>\n      <td>118</td>\n      <td>9.18</td>\n      <td>6.3</td>\n      <td>6</td>\n      <td>1.70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>323</td>\n      <td>67.61</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MA</td>\n      <td>121</td>\n      <td>510</td>\n      <td>False</td>\n      <td>True</td>\n      <td>24</td>\n      <td>218.2</td>\n      <td>88</td>\n      <td>37.09</td>\n      <td>348.5</td>\n      <td>...</td>\n      <td>212.6</td>\n      <td>118</td>\n      <td>9.57</td>\n      <td>7.5</td>\n      <td>7</td>\n      <td>2.03</td>\n      <td>3</td>\n      <td>0</td>\n      <td>321</td>\n      <td>78.31</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n对上述代码的部分解释：\n\n- 将相应的索引 `['Total charge', 'Total calls']` 和 `axis` 参数（1 表示删除列，0 表示删除行，默认值为 0）传给 `drop`。\n- `inplace` 参数表示是否修改原始 DataFrame （False 表示不修改现有 DataFrame，返回一个新 DataFrame，True 表示修改当前 DataFrame）。\n\n## 预测离网率\n\n首先，通过 `crosstab()` 方法构建一个交叉表来查看 International plan 国际套餐 变量和 Churn 离网率 的相关性，同时使用 `countplot()` 方法构建计数直方图来可视化结果。\n\n\n```python\n# 加载模块，配置绘图\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n\n\n```python\nsns.countplot(x='International plan', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11f0c8450>\n\n\n\n\n![png](data/output_75_1.png)\n\n\n上图表明，开通了国际套餐的用户的离网率要高很多，这是一个很有趣的观测结果。也许，国际电话高昂的话费让客户很不满意。\n\n同理，查看 Customer service calls 客服呼叫 变量与 Chunrn 离网率 的相关性，并可视化结果。\n\n\n```python\npd.crosstab(df['Churn'], df['Customer service calls'], margins=True)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Customer service calls</th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n      <th>8</th>\n      <th>9</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>605</td>\n      <td>1059</td>\n      <td>672</td>\n      <td>385</td>\n      <td>90</td>\n      <td>26</td>\n      <td>8</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2850</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92</td>\n      <td>122</td>\n      <td>87</td>\n      <td>44</td>\n      <td>76</td>\n      <td>40</td>\n      <td>14</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>483</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>697</td>\n      <td>1181</td>\n      <td>759</td>\n      <td>429</td>\n      <td>166</td>\n      <td>66</td>\n      <td>22</td>\n      <td>9</td>\n      <td>2</td>\n      <td>2</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n```python\nsns.countplot(x='Customer service calls', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11cb70d50>\n\n\n\n\n![png](data/output_79_1.png)\n\n\n上图表明，在客服呼叫 4 次之后，客户的离网率显著提升。\n\n为了更好的突出 Customer service call 客服呼叫 和 Churn 离网率 的关系，可以给 DataFrame 添加一个二元属性 Many_service_calls，即客户呼叫超过 3 次（Customer service calls > 3）。看下它与离网率的相关性，并可视化结果。\n\n\n```python\ndf['Many_service_calls'] = (df['Customer service calls'] > 3).astype('int')\n\npd.crosstab(df['Many_service_calls'], df['Churn'], margins=True)\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Many_service_calls</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2721</td>\n      <td>345</td>\n      <td>3066</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>129</td>\n      <td>138</td>\n      <td>267</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>2850</td>\n      <td>483</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n```python\nsns.countplot(x='Many_service_calls', hue='Churn', data=df)\n```\n\n\n\n\n    <matplotlib.axes._subplots.AxesSubplot at 0x11ce1c850>\n\n\n\n\n![png](data/output_83_1.png)\n\n\n现在我们可以创建另一张交叉表，将 Churn 离网率 与 International plan 国际套餐 及新创建的 Many_service_calls 多次客服呼叫 关联起来。\n\n\n\n\n```python\npd.crosstab(df['Many_service_calls'] & df['International plan'], df['Churn'])\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n    <tr>\n      <th>row_0</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>2841</td>\n      <td>464</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>9</td>\n      <td>19</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n上表表明，在客服呼叫次数超过 3 次并且已办理 International Plan 国际套餐 的情况下，预测一名客户不忠诚的准确率（Accuracy）可以达到 85.8％，计算公式如下：\n\n$$准确率（Accuracy）=\\frac{TP+TN}{TP+TN+FP+FN}=\\frac{2841+19}{2841+9+19+464}\\times100\\%$$\n\n其中，TP 表示将 True 预测为 True 的数量，TN 表示将 Flase 预测为 Flase 的数量，FP 表示将 Flase 预测为 True 的数量，FN 表示将 True 预测为 Flase 的数量。\n\n复习一下本次实验的内容：\n\n- 样本中忠实客户的份额为 85.5%。这意味着最简单的预测「忠实客户」的模型有 85.5% 的概率猜对。也就是说，后续模型的准确率（Accuracy）不应该比这个数字少，并且很有希望显著高于这个数字。\n- 基于一个简单的「（客服呼叫次数 > 3） & （国际套餐 = True） => Churn = 1, else Churn = 0」规则的预测模型，可以得到 85.8% 的准确率。以后我们将讨论决策树，看看如何仅仅基于输入数据自动找出类似的规则，而不需要我们手工设定。我们没有应用机器学习方法就得到了两个准确率（85.5% 和 85.8%），它们可作为后续其他模型的基线。如果经过大量的努力，我们仅将准确率提高了 0.5%，那么我们努力的方向可能出现了偏差，因为仅仅使用一个包含两个限制规则的简单模型就已提升了 0.3% 的准确率。\n- 在训练复杂模型之前，建议预处理一下数据，绘制一些图表，做一些简单的假设。此外，在实际任务上应用机器学习时，通常从简单的方案开始，接着尝试更复杂的方案。\n\n### 实验总结\n\n本次实验使用 Pandas 对数据进行了一定程度的分析和探索，交叉表、透视表等方法的运用将使你在数据探索过程中事半功倍。\n","slug":"mlsec/使用-Pandas-进行数据探索","published":1,"date":"2020-05-17T08:27:48.000Z","updated":"2020-05-17T08:33:47.773Z","title":"mlsec/使用-Pandas-进行数据探索","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zs006k018oekj1038c","content":"<h2 id=\"使用-Pandas-进行数据探索\"><a href=\"#使用-Pandas-进行数据探索\" class=\"headerlink\" title=\"使用 Pandas 进行数据探索\"></a>使用 Pandas 进行数据探索</h2><p>本次实验通过分析电信运营商的客户离网率数据集来熟悉 Pandas 数据探索的常用方法，并构建一个预测客户离网率的简单模型。</p>\n<h3 id=\"Pandas-的主要方法\"><a href=\"#Pandas-的主要方法\" class=\"headerlink\" title=\"Pandas 的主要方法\"></a>Pandas 的主要方法</h3><p>Pandas 是基于 NumPy 的一种工具，提供了大量数据探索的方法。Pandas 可以使用类似 SQL 的方式对 .csv、.tsv、.xlsx 等格式的数据进行处理分析。</p>\n<p>Pandas 主要使用的数据结构是 Series 和 DataFrame 类。下面简要介绍下这两类：</p>\n<ul>\n<li>Series 是一种类似于一维数组的对象，它由一组数据（各种 NumPy 数据类型）及一组与之相关的数据标签（即索引）组成。</li>\n<li>DataFrame 是一个二维数据结构，即一张表格，其中每列数据的类型相同。你可以把它看成由 Series 实例构成的字典。</li>\n</ul>\n<p>下面开始此次实验，我们将通过分析电信运营商的客户离网率数据集来展示 Pandas 的主要方法。</p>\n<p>首先载入必要的库，即 NumPy 和 Pandas。</p>\n<p><i class=\"fa fa-arrow-circle-down\" aria-hidden=\"true\"> 教学代码：</i></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br></pre></td></tr></table></figure>\n\n<p>通过 <code>read_csv()</code> 方法读取数据，然后使用 <code>head()</code> 方法查看前 5 行数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame = pd.read_csv(<span class=\"string\">'./data/telecom_churn.csv'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>上图中的每行对应一位客户，每列对应客户的一个特征。</p>\n<p>让我们查看一下该数据库的维度、特征名称和特征类型。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(3333, 20)</code></pre><p>上述结果表明，我们的列表包含 3333 行和 20 列。下面我们尝试打印列名。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.columns</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Index([&apos;State&apos;, &apos;Account length&apos;, &apos;Area code&apos;, &apos;International plan&apos;,\n       &apos;Voice mail plan&apos;, &apos;Number vmail messages&apos;, &apos;Total day minutes&apos;,\n       &apos;Total day calls&apos;, &apos;Total day charge&apos;, &apos;Total eve minutes&apos;,\n       &apos;Total eve calls&apos;, &apos;Total eve charge&apos;, &apos;Total night minutes&apos;,\n       &apos;Total night calls&apos;, &apos;Total night charge&apos;, &apos;Total intl minutes&apos;,\n       &apos;Total intl calls&apos;, &apos;Total intl charge&apos;, &apos;Customer service calls&apos;,\n       &apos;Churn&apos;],\n      dtype=&apos;object&apos;)</code></pre><p>我们还可以使用 <code>info()</code> 方法输出 DataFrame 的一些总体信息。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.info()</span><br></pre></td></tr></table></figure>\n\n<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;\nRangeIndex: 3333 entries, 0 to 3332\nData columns (total 20 columns):\nState                     3333 non-null object\nAccount length            3333 non-null int64\nArea code                 3333 non-null int64\nInternational plan        3333 non-null object\nVoice mail plan           3333 non-null object\nNumber vmail messages     3333 non-null int64\nTotal day minutes         3333 non-null float64\nTotal day calls           3333 non-null int64\nTotal day charge          3333 non-null float64\nTotal eve minutes         3333 non-null float64\nTotal eve calls           3333 non-null int64\nTotal eve charge          3333 non-null float64\nTotal night minutes       3333 non-null float64\nTotal night calls         3333 non-null int64\nTotal night charge        3333 non-null float64\nTotal intl minutes        3333 non-null float64\nTotal intl calls          3333 non-null int64\nTotal intl charge         3333 non-null float64\nCustomer service calls    3333 non-null int64\nChurn                     3333 non-null bool\ndtypes: bool(1), float64(8), int64(8), object(3)\nmemory usage: 498.1+ KB</code></pre><p><code>bool</code>、<code>int64</code>、<code>float64</code> 和 <code>object</code> 是该数据库特征的数据类型。这一方法同时也会显示是否有缺失值，上述结果表明在该数据集中不存在缺失值，因为每列都包含 3333 个观测，和我们之前使用 <code>shape</code> 方法得到的数字是一致的。</p>\n<p><code>astype()</code> 方法可以更改列的类型，下列公式将 Churn 离网率 特征修改为 <code>int64</code> 类型。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = dataFrame</span><br><span class=\"line\">df.head(<span class=\"number\">5</span>)</span><br><span class=\"line\">df[<span class=\"string\">'Churn'</span>] = df[<span class=\"string\">'Churn'</span>].astype(<span class=\"string\">'int64'</span>)</span><br><span class=\"line\">df.head(<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>describe()</code> 方法可以显示数值特征（<code>int64</code> 和 <code>float64</code>）的基本统计学特性，如未缺失值的数值、均值、标准差、范围、四分位数等。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.describe()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>101.064806</td>\n      <td>437.182418</td>\n      <td>8.099010</td>\n      <td>179.775098</td>\n      <td>100.435644</td>\n      <td>30.562307</td>\n      <td>200.980348</td>\n      <td>100.114311</td>\n      <td>17.083540</td>\n      <td>200.872037</td>\n      <td>100.107711</td>\n      <td>9.039325</td>\n      <td>10.237294</td>\n      <td>4.479448</td>\n      <td>2.764581</td>\n      <td>1.562856</td>\n      <td>0.144914</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>39.822106</td>\n      <td>42.371290</td>\n      <td>13.688365</td>\n      <td>54.467389</td>\n      <td>20.069084</td>\n      <td>9.259435</td>\n      <td>50.713844</td>\n      <td>19.922625</td>\n      <td>4.310668</td>\n      <td>50.573847</td>\n      <td>19.568609</td>\n      <td>2.275873</td>\n      <td>2.791840</td>\n      <td>2.461214</td>\n      <td>0.753773</td>\n      <td>1.315491</td>\n      <td>0.352067</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>23.200000</td>\n      <td>33.000000</td>\n      <td>1.040000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>74.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>143.700000</td>\n      <td>87.000000</td>\n      <td>24.430000</td>\n      <td>166.600000</td>\n      <td>87.000000</td>\n      <td>14.160000</td>\n      <td>167.000000</td>\n      <td>87.000000</td>\n      <td>7.520000</td>\n      <td>8.500000</td>\n      <td>3.000000</td>\n      <td>2.300000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>101.000000</td>\n      <td>415.000000</td>\n      <td>0.000000</td>\n      <td>179.400000</td>\n      <td>101.000000</td>\n      <td>30.500000</td>\n      <td>201.400000</td>\n      <td>100.000000</td>\n      <td>17.120000</td>\n      <td>201.200000</td>\n      <td>100.000000</td>\n      <td>9.050000</td>\n      <td>10.300000</td>\n      <td>4.000000</td>\n      <td>2.780000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>127.000000</td>\n      <td>510.000000</td>\n      <td>20.000000</td>\n      <td>216.400000</td>\n      <td>114.000000</td>\n      <td>36.790000</td>\n      <td>235.300000</td>\n      <td>114.000000</td>\n      <td>20.000000</td>\n      <td>235.300000</td>\n      <td>113.000000</td>\n      <td>10.590000</td>\n      <td>12.100000</td>\n      <td>6.000000</td>\n      <td>3.270000</td>\n      <td>2.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>243.000000</td>\n      <td>510.000000</td>\n      <td>51.000000</td>\n      <td>350.800000</td>\n      <td>165.000000</td>\n      <td>59.640000</td>\n      <td>363.700000</td>\n      <td>170.000000</td>\n      <td>30.910000</td>\n      <td>395.000000</td>\n      <td>175.000000</td>\n      <td>17.770000</td>\n      <td>20.000000</td>\n      <td>20.000000</td>\n      <td>5.400000</td>\n      <td>9.000000</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>通过 include 参数显式指定包含的数据类型，可以查看非数值特征的统计数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.describe(include=[<span class=\"string\">'object'</span>, <span class=\"string\">'bool'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333</td>\n      <td>3333</td>\n      <td>3333</td>\n    </tr>\n    <tr>\n      <th>unique</th>\n      <td>51</td>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>top</th>\n      <td>WV</td>\n      <td>No</td>\n      <td>No</td>\n    </tr>\n    <tr>\n      <th>freq</th>\n      <td>106</td>\n      <td>3010</td>\n      <td>2411</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>value_counts()</code> 方法可以查看类别（类型为 object ）和布尔值（类型为 bool ）特征。让我们看下 Churn 离网率 的分布。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0    2850\n1     483\nName: Churn, dtype: int64</code></pre><p>上述结果表明，在 3333 位客户中， 2850 位是忠实客户，他们的 <code>Churn</code> 值为 0。调用 <code>value_counts()</code> 函数时，加上 <code>normalize=True</code> 参数可以显示比例。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts(normalize=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0    0.855086\n1    0.144914\nName: Churn, dtype: float64</code></pre><h3 id=\"排序\"><a href=\"#排序\" class=\"headerlink\" title=\"排序\"></a>排序</h3><p>DataFrame 可以根据某个变量的值（也就是列）排序。比如，根据每日消费额排序（设置 ascending=False 倒序排列）。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.sort_values(by=<span class=\"string\">'Total day charge'</span>, ascending=<span class=\"literal\">False</span>).head(<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>365</th>\n      <td>CO</td>\n      <td>154</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>350.8</td>\n      <td>75</td>\n      <td>59.64</td>\n      <td>216.5</td>\n      <td>94</td>\n      <td>18.40</td>\n      <td>253.9</td>\n      <td>100</td>\n      <td>11.43</td>\n      <td>10.1</td>\n      <td>9</td>\n      <td>2.73</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>985</th>\n      <td>NY</td>\n      <td>64</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>346.8</td>\n      <td>55</td>\n      <td>58.96</td>\n      <td>249.5</td>\n      <td>79</td>\n      <td>21.21</td>\n      <td>275.4</td>\n      <td>102</td>\n      <td>12.39</td>\n      <td>13.3</td>\n      <td>9</td>\n      <td>3.59</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2594</th>\n      <td>OH</td>\n      <td>115</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>345.3</td>\n      <td>81</td>\n      <td>58.70</td>\n      <td>203.4</td>\n      <td>106</td>\n      <td>17.29</td>\n      <td>217.5</td>\n      <td>107</td>\n      <td>9.79</td>\n      <td>11.8</td>\n      <td>8</td>\n      <td>3.19</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>156</th>\n      <td>OH</td>\n      <td>83</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>337.4</td>\n      <td>120</td>\n      <td>57.36</td>\n      <td>227.4</td>\n      <td>116</td>\n      <td>19.33</td>\n      <td>153.9</td>\n      <td>114</td>\n      <td>6.93</td>\n      <td>15.8</td>\n      <td>7</td>\n      <td>4.27</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>MO</td>\n      <td>112</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>335.5</td>\n      <td>77</td>\n      <td>57.04</td>\n      <td>212.5</td>\n      <td>109</td>\n      <td>18.06</td>\n      <td>265.0</td>\n      <td>132</td>\n      <td>11.93</td>\n      <td>12.7</td>\n      <td>8</td>\n      <td>3.43</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>此外，还可以根据多个列的数值排序。下面函数实现的功能为：先按 Churn 离网率 升序排列，再按 Total day charge 每日总话费 降序排列，优先级 Churn &gt; Tatal day charge。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.sort_values(by=[<span class=\"string\">'Churn'</span>, <span class=\"string\">'Total day charge'</span>], ascending=[<span class=\"literal\">True</span>, <span class=\"literal\">False</span>]).head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>688</th>\n      <td>MN</td>\n      <td>13</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>21</td>\n      <td>315.6</td>\n      <td>105</td>\n      <td>53.65</td>\n      <td>208.9</td>\n      <td>71</td>\n      <td>17.76</td>\n      <td>260.1</td>\n      <td>123</td>\n      <td>11.70</td>\n      <td>12.1</td>\n      <td>3</td>\n      <td>3.27</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2259</th>\n      <td>NC</td>\n      <td>210</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>31</td>\n      <td>313.8</td>\n      <td>87</td>\n      <td>53.35</td>\n      <td>147.7</td>\n      <td>103</td>\n      <td>12.55</td>\n      <td>192.7</td>\n      <td>97</td>\n      <td>8.67</td>\n      <td>10.1</td>\n      <td>7</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>534</th>\n      <td>LA</td>\n      <td>67</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>310.4</td>\n      <td>97</td>\n      <td>52.77</td>\n      <td>66.5</td>\n      <td>123</td>\n      <td>5.65</td>\n      <td>246.5</td>\n      <td>99</td>\n      <td>11.09</td>\n      <td>9.2</td>\n      <td>10</td>\n      <td>2.48</td>\n      <td>4</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>575</th>\n      <td>SD</td>\n      <td>114</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>36</td>\n      <td>309.9</td>\n      <td>90</td>\n      <td>52.68</td>\n      <td>200.3</td>\n      <td>89</td>\n      <td>17.03</td>\n      <td>183.5</td>\n      <td>105</td>\n      <td>8.26</td>\n      <td>14.2</td>\n      <td>2</td>\n      <td>3.83</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2858</th>\n      <td>AL</td>\n      <td>141</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>28</td>\n      <td>308.0</td>\n      <td>123</td>\n      <td>52.36</td>\n      <td>247.8</td>\n      <td>128</td>\n      <td>21.06</td>\n      <td>152.9</td>\n      <td>103</td>\n      <td>6.88</td>\n      <td>7.4</td>\n      <td>3</td>\n      <td>2.00</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"索引和获取数据\"><a href=\"#索引和获取数据\" class=\"headerlink\" title=\"索引和获取数据\"></a>索引和获取数据</h3><p>DataFrame 可以以不同的方式进行索引。</p>\n<p>使用 <code>DataFrame[&#39;Name&#39;]</code> 可以得到一个单独的列。比如，离网率有多高？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0.14491449144914492</code></pre><p>对一家公司而言，14.5% 的离网率是一个很糟糕的数据，这么高的离网率可能导致公司破产。</p>\n<p>布尔值索引同样很方便，语法是 <code>df[P(df[&#39;Name&#39;])]</code>，P 是在检查 Name 列每个元素时所使用的逻辑条件。这一索引的输出是 DataFrame 的 Name 列中满足 P 条件的行。</p>\n<p>让我们使用布尔值索引来回答这样以下问题：离网用户的数值变量的均值是多少？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Account length            102.664596\nArea code                 437.817805\nNumber vmail messages       5.115942\nTotal day minutes         206.914079\nTotal day calls           101.335404\nTotal day charge           35.175921\nTotal eve minutes         212.410145\nTotal eve calls           100.561077\nTotal eve charge           18.054969\nTotal night minutes       205.231677\nTotal night calls         100.399586\nTotal night charge          9.235528\nTotal intl minutes         10.700000\nTotal intl calls            4.163561\nTotal intl charge           2.889545\nCustomer service calls      2.229814\nChurn                       1.000000\ndtype: float64</code></pre><p>离网用户在白天打电话的总时长的均值是多少？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>][<span class=\"string\">'Total day minutes'</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>206.91407867494823</code></pre><p>未使用国际套餐（<code>International plan == NO</code>）的忠实用户（<code>Churn == 0</code>）所打的最长的国际长途是多久？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[(df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>) &amp; (df[<span class=\"string\">'International plan'</span>] == <span class=\"string\">'No'</span>)][<span class=\"string\">'Total intl minutes'</span>].max()</span><br><span class=\"line\">df[(df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">0</span>) &amp; (df[<span class=\"string\">'International plan'</span>] == <span class=\"string\">'No'</span>)][<span class=\"string\">'Total intl minutes'</span>].max()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>18.9</code></pre><p>DataFrame 可以通过列名、行名、行号进行索引。<code>loc</code> 方法为通过名称索引，<code>iloc</code> 方法为通过数字索引。</p>\n<p>通过 <code>loc</code> 方法输出 0 至 5 行、State 州 至 Area code 区号 的数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.loc[<span class=\"number\">0</span>:<span class=\"number\">5</span>, [<span class=\"string\">'State'</span>,<span class=\"string\">'Area code'</span>]]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>510</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>通过 <code>ilo</code> 方法输出前 5 行的前 3 列数据（和典型的 Python 切片一样，不含最大值）。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.iloc[<span class=\"number\">0</span>:<span class=\"number\">5</span>, <span class=\"number\">0</span>:<span class=\"number\">3</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>df[:1]</code> 和 <code>df[-1:]</code> 可以得到 DataFrame 的首行和末行。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"number\">-2</span>:]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3331</th>\n      <td>CT</td>\n      <td>184</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>213.8</td>\n      <td>105</td>\n      <td>36.35</td>\n      <td>159.6</td>\n      <td>84</td>\n      <td>13.57</td>\n      <td>139.2</td>\n      <td>137</td>\n      <td>6.26</td>\n      <td>5.0</td>\n      <td>10</td>\n      <td>1.35</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3332</th>\n      <td>TN</td>\n      <td>74</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>234.4</td>\n      <td>113</td>\n      <td>39.85</td>\n      <td>265.9</td>\n      <td>82</td>\n      <td>22.60</td>\n      <td>241.4</td>\n      <td>77</td>\n      <td>10.86</td>\n      <td>13.7</td>\n      <td>4</td>\n      <td>3.70</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"应用函数到单元格、列、行\"><a href=\"#应用函数到单元格、列、行\" class=\"headerlink\" title=\"应用函数到单元格、列、行\"></a>应用函数到单元格、列、行</h3><p>下面通过 <code>apply()</code> 方法应用函数 <code>max</code> 至每一列，即输出每列的最大值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.apply(np.max)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>State                        WY\nAccount length              243\nArea code                   510\nInternational plan          Yes\nVoice mail plan             Yes\nNumber vmail messages        51\nTotal day minutes         350.8\nTotal day calls             165\nTotal day charge          59.64\nTotal eve minutes         363.7\nTotal eve calls             170\nTotal eve charge          30.91\nTotal night minutes         395\nTotal night calls           175\nTotal night charge        17.77\nTotal intl minutes           20\nTotal intl calls             20\nTotal intl charge           5.4\nCustomer service calls        9\nChurn                         1\ndtype: object</code></pre><p><code>apply()</code> 方法也可以应用函数至每一行，指定 axis=1 即可。在这种情况下，使用 <code>lambda</code> 函数十分方便。比如，下面函数选中了所有以 W 开头的州。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'State'</span>].apply(<span class=\"keyword\">lambda</span> state: state[<span class=\"number\">0</span>] == <span class=\"string\">'W'</span>)].head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9</th>\n      <td>WV</td>\n      <td>141</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>37</td>\n      <td>258.6</td>\n      <td>84</td>\n      <td>43.96</td>\n      <td>222.0</td>\n      <td>111</td>\n      <td>18.87</td>\n      <td>326.4</td>\n      <td>97</td>\n      <td>14.69</td>\n      <td>11.2</td>\n      <td>5</td>\n      <td>3.02</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>WY</td>\n      <td>57</td>\n      <td>408</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>39</td>\n      <td>213.0</td>\n      <td>115</td>\n      <td>36.21</td>\n      <td>191.1</td>\n      <td>112</td>\n      <td>16.24</td>\n      <td>182.7</td>\n      <td>115</td>\n      <td>8.22</td>\n      <td>9.5</td>\n      <td>3</td>\n      <td>2.57</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>WI</td>\n      <td>64</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>154.0</td>\n      <td>67</td>\n      <td>26.18</td>\n      <td>225.8</td>\n      <td>118</td>\n      <td>19.19</td>\n      <td>265.3</td>\n      <td>86</td>\n      <td>11.94</td>\n      <td>3.5</td>\n      <td>3</td>\n      <td>0.95</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>WY</td>\n      <td>97</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>24</td>\n      <td>133.2</td>\n      <td>135</td>\n      <td>22.64</td>\n      <td>217.2</td>\n      <td>58</td>\n      <td>18.46</td>\n      <td>70.6</td>\n      <td>79</td>\n      <td>3.18</td>\n      <td>11.0</td>\n      <td>3</td>\n      <td>2.97</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>WY</td>\n      <td>87</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>151.0</td>\n      <td>83</td>\n      <td>25.67</td>\n      <td>219.7</td>\n      <td>116</td>\n      <td>18.67</td>\n      <td>203.9</td>\n      <td>127</td>\n      <td>9.18</td>\n      <td>9.7</td>\n      <td>3</td>\n      <td>2.62</td>\n      <td>5</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>map()</code> 方法可以通过一个 {old_value:new_value} 形式的字典替换某一列中的值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = &#123;<span class=\"string\">'No'</span>: <span class=\"literal\">False</span>, <span class=\"string\">'Yes'</span>: <span class=\"literal\">True</span>&#125;</span><br><span class=\"line\">df[<span class=\"string\">'International plan'</span>] = df[<span class=\"string\">'International plan'</span>].map(d)</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>当然，使用 <code>repalce()</code> 方法一样可以达到替换的目的。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = df.replace(&#123;<span class=\"string\">'Voice mail plan'</span>: d&#125;)</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"增减-DataFrame-的行列\"><a href=\"#增减-DataFrame-的行列\" class=\"headerlink\" title=\"增减 DataFrame 的行列\"></a>增减 DataFrame 的行列</h3><p>在 DataFrame 中新增列有很多方法，比如，使用 <code>insert()</code>方法添加列，为所有用户计算总的 Total calls 电话量。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">total_calls = df[<span class=\"string\">'Total day calls'</span>] + df[<span class=\"string\">'Total eve calls'</span>] + \\</span><br><span class=\"line\">df[<span class=\"string\">'Total night calls'</span>] + df[<span class=\"string\">'Total intl calls'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">df.insert(loc=len(df.columns), column=<span class=\"string\">'Total calls 2'</span>, value=total_calls)</span><br><span class=\"line\"></span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n<p>上面的代码创建了一个中间 Series 实例，即 tatal_calls，其实可以在不创造这个实例的情况下直接添加列。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Total charge'</span>] = df[<span class=\"string\">'Total day charge'</span>] + df[<span class=\"string\">'Total eve charge'</span>] + \\</span><br><span class=\"line\">df[<span class=\"string\">'Total night charge'</span>] + df[<span class=\"string\">'Total intl charge'</span>]</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n      <td>59.24</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n      <td>62.29</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 23 columns</p>\n</div>\n\n\n\n<p>使用 <code>drop()</code> 方法删除列和行。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df1 = df.drop([<span class=\"number\">1</span>, <span class=\"number\">2</span>])</span><br><span class=\"line\">df1.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>118</td>\n      <td>510</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>223.4</td>\n      <td>98</td>\n      <td>37.98</td>\n      <td>220.6</td>\n      <td>...</td>\n      <td>203.9</td>\n      <td>118</td>\n      <td>9.18</td>\n      <td>6.3</td>\n      <td>6</td>\n      <td>1.70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>323</td>\n      <td>67.61</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MA</td>\n      <td>121</td>\n      <td>510</td>\n      <td>False</td>\n      <td>True</td>\n      <td>24</td>\n      <td>218.2</td>\n      <td>88</td>\n      <td>37.09</td>\n      <td>348.5</td>\n      <td>...</td>\n      <td>212.6</td>\n      <td>118</td>\n      <td>9.57</td>\n      <td>7.5</td>\n      <td>7</td>\n      <td>2.03</td>\n      <td>3</td>\n      <td>0</td>\n      <td>321</td>\n      <td>78.31</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n<p>对上述代码的部分解释：</p>\n<ul>\n<li>将相应的索引 <code>[&#39;Total charge&#39;, &#39;Total calls&#39;]</code> 和 <code>axis</code> 参数（1 表示删除列，0 表示删除行，默认值为 0）传给 <code>drop</code>。</li>\n<li><code>inplace</code> 参数表示是否修改原始 DataFrame （False 表示不修改现有 DataFrame，返回一个新 DataFrame，True 表示修改当前 DataFrame）。</li>\n</ul>\n<h2 id=\"预测离网率\"><a href=\"#预测离网率\" class=\"headerlink\" title=\"预测离网率\"></a>预测离网率</h2><p>首先，通过 <code>crosstab()</code> 方法构建一个交叉表来查看 International plan 国际套餐 变量和 Churn 离网率 的相关性，同时使用 <code>countplot()</code> 方法构建计数直方图来可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 加载模块，配置绘图</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'International plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11f0c8450&gt;</code></pre><p><img src=\"data/output_75_1.png\" alt=\"png\"></p>\n<p>上图表明，开通了国际套餐的用户的离网率要高很多，这是一个很有趣的观测结果。也许，国际电话高昂的话费让客户很不满意。</p>\n<p>同理，查看 Customer service calls 客服呼叫 变量与 Chunrn 离网率 的相关性，并可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Churn'</span>], df[<span class=\"string\">'Customer service calls'</span>], margins=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Customer service calls</th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n      <th>8</th>\n      <th>9</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>605</td>\n      <td>1059</td>\n      <td>672</td>\n      <td>385</td>\n      <td>90</td>\n      <td>26</td>\n      <td>8</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2850</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92</td>\n      <td>122</td>\n      <td>87</td>\n      <td>44</td>\n      <td>76</td>\n      <td>40</td>\n      <td>14</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>483</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>697</td>\n      <td>1181</td>\n      <td>759</td>\n      <td>429</td>\n      <td>166</td>\n      <td>66</td>\n      <td>22</td>\n      <td>9</td>\n      <td>2</td>\n      <td>2</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Customer service calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11cb70d50&gt;</code></pre><p><img src=\"data/output_79_1.png\" alt=\"png\"></p>\n<p>上图表明，在客服呼叫 4 次之后，客户的离网率显著提升。</p>\n<p>为了更好的突出 Customer service call 客服呼叫 和 Churn 离网率 的关系，可以给 DataFrame 添加一个二元属性 Many_service_calls，即客户呼叫超过 3 次（Customer service calls &gt; 3）。看下它与离网率的相关性，并可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Many_service_calls'</span>] = (df[<span class=\"string\">'Customer service calls'</span>] &gt; <span class=\"number\">3</span>).astype(<span class=\"string\">'int'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Many_service_calls'</span>], df[<span class=\"string\">'Churn'</span>], margins=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Many_service_calls</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2721</td>\n      <td>345</td>\n      <td>3066</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>129</td>\n      <td>138</td>\n      <td>267</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>2850</td>\n      <td>483</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Many_service_calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ce1c850&gt;</code></pre><p><img src=\"data/output_83_1.png\" alt=\"png\"></p>\n<p>现在我们可以创建另一张交叉表，将 Churn 离网率 与 International plan 国际套餐 及新创建的 Many_service_calls 多次客服呼叫 关联起来。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Many_service_calls'</span>] &amp; df[<span class=\"string\">'International plan'</span>], df[<span class=\"string\">'Churn'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n    <tr>\n      <th>row_0</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>2841</td>\n      <td>464</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>9</td>\n      <td>19</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>上表表明，在客服呼叫次数超过 3 次并且已办理 International Plan 国际套餐 的情况下，预测一名客户不忠诚的准确率（Accuracy）可以达到 85.8％，计算公式如下：</p>\n<p>$$准确率（Accuracy）=\\frac{TP+TN}{TP+TN+FP+FN}=\\frac{2841+19}{2841+9+19+464}\\times100%$$</p>\n<p>其中，TP 表示将 True 预测为 True 的数量，TN 表示将 Flase 预测为 Flase 的数量，FP 表示将 Flase 预测为 True 的数量，FN 表示将 True 预测为 Flase 的数量。</p>\n<p>复习一下本次实验的内容：</p>\n<ul>\n<li>样本中忠实客户的份额为 85.5%。这意味着最简单的预测「忠实客户」的模型有 85.5% 的概率猜对。也就是说，后续模型的准确率（Accuracy）不应该比这个数字少，并且很有希望显著高于这个数字。</li>\n<li>基于一个简单的「（客服呼叫次数 &gt; 3） &amp; （国际套餐 = True） =&gt; Churn = 1, else Churn = 0」规则的预测模型，可以得到 85.8% 的准确率。以后我们将讨论决策树，看看如何仅仅基于输入数据自动找出类似的规则，而不需要我们手工设定。我们没有应用机器学习方法就得到了两个准确率（85.5% 和 85.8%），它们可作为后续其他模型的基线。如果经过大量的努力，我们仅将准确率提高了 0.5%，那么我们努力的方向可能出现了偏差，因为仅仅使用一个包含两个限制规则的简单模型就已提升了 0.3% 的准确率。</li>\n<li>在训练复杂模型之前，建议预处理一下数据，绘制一些图表，做一些简单的假设。此外，在实际任务上应用机器学习时，通常从简单的方案开始，接着尝试更复杂的方案。</li>\n</ul>\n<h3 id=\"实验总结\"><a href=\"#实验总结\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h3><p>本次实验使用 Pandas 对数据进行了一定程度的分析和探索，交叉表、透视表等方法的运用将使你在数据探索过程中事半功倍。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"使用-Pandas-进行数据探索\"><a href=\"#使用-Pandas-进行数据探索\" class=\"headerlink\" title=\"使用 Pandas 进行数据探索\"></a>使用 Pandas 进行数据探索</h2><p>本次实验通过分析电信运营商的客户离网率数据集来熟悉 Pandas 数据探索的常用方法，并构建一个预测客户离网率的简单模型。</p>\n<h3 id=\"Pandas-的主要方法\"><a href=\"#Pandas-的主要方法\" class=\"headerlink\" title=\"Pandas 的主要方法\"></a>Pandas 的主要方法</h3><p>Pandas 是基于 NumPy 的一种工具，提供了大量数据探索的方法。Pandas 可以使用类似 SQL 的方式对 .csv、.tsv、.xlsx 等格式的数据进行处理分析。</p>\n<p>Pandas 主要使用的数据结构是 Series 和 DataFrame 类。下面简要介绍下这两类：</p>\n<ul>\n<li>Series 是一种类似于一维数组的对象，它由一组数据（各种 NumPy 数据类型）及一组与之相关的数据标签（即索引）组成。</li>\n<li>DataFrame 是一个二维数据结构，即一张表格，其中每列数据的类型相同。你可以把它看成由 Series 实例构成的字典。</li>\n</ul>\n<p>下面开始此次实验，我们将通过分析电信运营商的客户离网率数据集来展示 Pandas 的主要方法。</p>\n<p>首先载入必要的库，即 NumPy 和 Pandas。</p>\n<p><i class=\"fa fa-arrow-circle-down\" aria-hidden=\"true\"> 教学代码：</i></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br></pre></td></tr></table></figure>\n\n<p>通过 <code>read_csv()</code> 方法读取数据，然后使用 <code>head()</code> 方法查看前 5 行数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame = pd.read_csv(<span class=\"string\">'./data/telecom_churn.csv'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>上图中的每行对应一位客户，每列对应客户的一个特征。</p>\n<p>让我们查看一下该数据库的维度、特征名称和特征类型。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.shape</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>(3333, 20)</code></pre><p>上述结果表明，我们的列表包含 3333 行和 20 列。下面我们尝试打印列名。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.columns</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Index([&apos;State&apos;, &apos;Account length&apos;, &apos;Area code&apos;, &apos;International plan&apos;,\n       &apos;Voice mail plan&apos;, &apos;Number vmail messages&apos;, &apos;Total day minutes&apos;,\n       &apos;Total day calls&apos;, &apos;Total day charge&apos;, &apos;Total eve minutes&apos;,\n       &apos;Total eve calls&apos;, &apos;Total eve charge&apos;, &apos;Total night minutes&apos;,\n       &apos;Total night calls&apos;, &apos;Total night charge&apos;, &apos;Total intl minutes&apos;,\n       &apos;Total intl calls&apos;, &apos;Total intl charge&apos;, &apos;Customer service calls&apos;,\n       &apos;Churn&apos;],\n      dtype=&apos;object&apos;)</code></pre><p>我们还可以使用 <code>info()</code> 方法输出 DataFrame 的一些总体信息。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataFrame.info()</span><br></pre></td></tr></table></figure>\n\n<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;\nRangeIndex: 3333 entries, 0 to 3332\nData columns (total 20 columns):\nState                     3333 non-null object\nAccount length            3333 non-null int64\nArea code                 3333 non-null int64\nInternational plan        3333 non-null object\nVoice mail plan           3333 non-null object\nNumber vmail messages     3333 non-null int64\nTotal day minutes         3333 non-null float64\nTotal day calls           3333 non-null int64\nTotal day charge          3333 non-null float64\nTotal eve minutes         3333 non-null float64\nTotal eve calls           3333 non-null int64\nTotal eve charge          3333 non-null float64\nTotal night minutes       3333 non-null float64\nTotal night calls         3333 non-null int64\nTotal night charge        3333 non-null float64\nTotal intl minutes        3333 non-null float64\nTotal intl calls          3333 non-null int64\nTotal intl charge         3333 non-null float64\nCustomer service calls    3333 non-null int64\nChurn                     3333 non-null bool\ndtypes: bool(1), float64(8), int64(8), object(3)\nmemory usage: 498.1+ KB</code></pre><p><code>bool</code>、<code>int64</code>、<code>float64</code> 和 <code>object</code> 是该数据库特征的数据类型。这一方法同时也会显示是否有缺失值，上述结果表明在该数据集中不存在缺失值，因为每列都包含 3333 个观测，和我们之前使用 <code>shape</code> 方法得到的数字是一致的。</p>\n<p><code>astype()</code> 方法可以更改列的类型，下列公式将 Churn 离网率 特征修改为 <code>int64</code> 类型。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = dataFrame</span><br><span class=\"line\">df.head(<span class=\"number\">5</span>)</span><br><span class=\"line\">df[<span class=\"string\">'Churn'</span>] = df[<span class=\"string\">'Churn'</span>].astype(<span class=\"string\">'int64'</span>)</span><br><span class=\"line\">df.head(<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>describe()</code> 方法可以显示数值特征（<code>int64</code> 和 <code>float64</code>）的基本统计学特性，如未缺失值的数值、均值、标准差、范围、四分位数等。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.describe()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n      <td>3333.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>101.064806</td>\n      <td>437.182418</td>\n      <td>8.099010</td>\n      <td>179.775098</td>\n      <td>100.435644</td>\n      <td>30.562307</td>\n      <td>200.980348</td>\n      <td>100.114311</td>\n      <td>17.083540</td>\n      <td>200.872037</td>\n      <td>100.107711</td>\n      <td>9.039325</td>\n      <td>10.237294</td>\n      <td>4.479448</td>\n      <td>2.764581</td>\n      <td>1.562856</td>\n      <td>0.144914</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>39.822106</td>\n      <td>42.371290</td>\n      <td>13.688365</td>\n      <td>54.467389</td>\n      <td>20.069084</td>\n      <td>9.259435</td>\n      <td>50.713844</td>\n      <td>19.922625</td>\n      <td>4.310668</td>\n      <td>50.573847</td>\n      <td>19.568609</td>\n      <td>2.275873</td>\n      <td>2.791840</td>\n      <td>2.461214</td>\n      <td>0.753773</td>\n      <td>1.315491</td>\n      <td>0.352067</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>23.200000</td>\n      <td>33.000000</td>\n      <td>1.040000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>74.000000</td>\n      <td>408.000000</td>\n      <td>0.000000</td>\n      <td>143.700000</td>\n      <td>87.000000</td>\n      <td>24.430000</td>\n      <td>166.600000</td>\n      <td>87.000000</td>\n      <td>14.160000</td>\n      <td>167.000000</td>\n      <td>87.000000</td>\n      <td>7.520000</td>\n      <td>8.500000</td>\n      <td>3.000000</td>\n      <td>2.300000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>101.000000</td>\n      <td>415.000000</td>\n      <td>0.000000</td>\n      <td>179.400000</td>\n      <td>101.000000</td>\n      <td>30.500000</td>\n      <td>201.400000</td>\n      <td>100.000000</td>\n      <td>17.120000</td>\n      <td>201.200000</td>\n      <td>100.000000</td>\n      <td>9.050000</td>\n      <td>10.300000</td>\n      <td>4.000000</td>\n      <td>2.780000</td>\n      <td>1.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>127.000000</td>\n      <td>510.000000</td>\n      <td>20.000000</td>\n      <td>216.400000</td>\n      <td>114.000000</td>\n      <td>36.790000</td>\n      <td>235.300000</td>\n      <td>114.000000</td>\n      <td>20.000000</td>\n      <td>235.300000</td>\n      <td>113.000000</td>\n      <td>10.590000</td>\n      <td>12.100000</td>\n      <td>6.000000</td>\n      <td>3.270000</td>\n      <td>2.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>243.000000</td>\n      <td>510.000000</td>\n      <td>51.000000</td>\n      <td>350.800000</td>\n      <td>165.000000</td>\n      <td>59.640000</td>\n      <td>363.700000</td>\n      <td>170.000000</td>\n      <td>30.910000</td>\n      <td>395.000000</td>\n      <td>175.000000</td>\n      <td>17.770000</td>\n      <td>20.000000</td>\n      <td>20.000000</td>\n      <td>5.400000</td>\n      <td>9.000000</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>通过 include 参数显式指定包含的数据类型，可以查看非数值特征的统计数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.describe(include=[<span class=\"string\">'object'</span>, <span class=\"string\">'bool'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>3333</td>\n      <td>3333</td>\n      <td>3333</td>\n    </tr>\n    <tr>\n      <th>unique</th>\n      <td>51</td>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>top</th>\n      <td>WV</td>\n      <td>No</td>\n      <td>No</td>\n    </tr>\n    <tr>\n      <th>freq</th>\n      <td>106</td>\n      <td>3010</td>\n      <td>2411</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>value_counts()</code> 方法可以查看类别（类型为 object ）和布尔值（类型为 bool ）特征。让我们看下 Churn 离网率 的分布。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0    2850\n1     483\nName: Churn, dtype: int64</code></pre><p>上述结果表明，在 3333 位客户中， 2850 位是忠实客户，他们的 <code>Churn</code> 值为 0。调用 <code>value_counts()</code> 函数时，加上 <code>normalize=True</code> 参数可以显示比例。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].value_counts(normalize=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0    0.855086\n1    0.144914\nName: Churn, dtype: float64</code></pre><h3 id=\"排序\"><a href=\"#排序\" class=\"headerlink\" title=\"排序\"></a>排序</h3><p>DataFrame 可以根据某个变量的值（也就是列）排序。比如，根据每日消费额排序（设置 ascending=False 倒序排列）。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.sort_values(by=<span class=\"string\">'Total day charge'</span>, ascending=<span class=\"literal\">False</span>).head(<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>365</th>\n      <td>CO</td>\n      <td>154</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>350.8</td>\n      <td>75</td>\n      <td>59.64</td>\n      <td>216.5</td>\n      <td>94</td>\n      <td>18.40</td>\n      <td>253.9</td>\n      <td>100</td>\n      <td>11.43</td>\n      <td>10.1</td>\n      <td>9</td>\n      <td>2.73</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>985</th>\n      <td>NY</td>\n      <td>64</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>346.8</td>\n      <td>55</td>\n      <td>58.96</td>\n      <td>249.5</td>\n      <td>79</td>\n      <td>21.21</td>\n      <td>275.4</td>\n      <td>102</td>\n      <td>12.39</td>\n      <td>13.3</td>\n      <td>9</td>\n      <td>3.59</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2594</th>\n      <td>OH</td>\n      <td>115</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>345.3</td>\n      <td>81</td>\n      <td>58.70</td>\n      <td>203.4</td>\n      <td>106</td>\n      <td>17.29</td>\n      <td>217.5</td>\n      <td>107</td>\n      <td>9.79</td>\n      <td>11.8</td>\n      <td>8</td>\n      <td>3.19</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>156</th>\n      <td>OH</td>\n      <td>83</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>337.4</td>\n      <td>120</td>\n      <td>57.36</td>\n      <td>227.4</td>\n      <td>116</td>\n      <td>19.33</td>\n      <td>153.9</td>\n      <td>114</td>\n      <td>6.93</td>\n      <td>15.8</td>\n      <td>7</td>\n      <td>4.27</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>MO</td>\n      <td>112</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>335.5</td>\n      <td>77</td>\n      <td>57.04</td>\n      <td>212.5</td>\n      <td>109</td>\n      <td>18.06</td>\n      <td>265.0</td>\n      <td>132</td>\n      <td>11.93</td>\n      <td>12.7</td>\n      <td>8</td>\n      <td>3.43</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>此外，还可以根据多个列的数值排序。下面函数实现的功能为：先按 Churn 离网率 升序排列，再按 Total day charge 每日总话费 降序排列，优先级 Churn &gt; Tatal day charge。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.sort_values(by=[<span class=\"string\">'Churn'</span>, <span class=\"string\">'Total day charge'</span>], ascending=[<span class=\"literal\">True</span>, <span class=\"literal\">False</span>]).head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>688</th>\n      <td>MN</td>\n      <td>13</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>21</td>\n      <td>315.6</td>\n      <td>105</td>\n      <td>53.65</td>\n      <td>208.9</td>\n      <td>71</td>\n      <td>17.76</td>\n      <td>260.1</td>\n      <td>123</td>\n      <td>11.70</td>\n      <td>12.1</td>\n      <td>3</td>\n      <td>3.27</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2259</th>\n      <td>NC</td>\n      <td>210</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>31</td>\n      <td>313.8</td>\n      <td>87</td>\n      <td>53.35</td>\n      <td>147.7</td>\n      <td>103</td>\n      <td>12.55</td>\n      <td>192.7</td>\n      <td>97</td>\n      <td>8.67</td>\n      <td>10.1</td>\n      <td>7</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>534</th>\n      <td>LA</td>\n      <td>67</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>310.4</td>\n      <td>97</td>\n      <td>52.77</td>\n      <td>66.5</td>\n      <td>123</td>\n      <td>5.65</td>\n      <td>246.5</td>\n      <td>99</td>\n      <td>11.09</td>\n      <td>9.2</td>\n      <td>10</td>\n      <td>2.48</td>\n      <td>4</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>575</th>\n      <td>SD</td>\n      <td>114</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>36</td>\n      <td>309.9</td>\n      <td>90</td>\n      <td>52.68</td>\n      <td>200.3</td>\n      <td>89</td>\n      <td>17.03</td>\n      <td>183.5</td>\n      <td>105</td>\n      <td>8.26</td>\n      <td>14.2</td>\n      <td>2</td>\n      <td>3.83</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2858</th>\n      <td>AL</td>\n      <td>141</td>\n      <td>510</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>28</td>\n      <td>308.0</td>\n      <td>123</td>\n      <td>52.36</td>\n      <td>247.8</td>\n      <td>128</td>\n      <td>21.06</td>\n      <td>152.9</td>\n      <td>103</td>\n      <td>6.88</td>\n      <td>7.4</td>\n      <td>3</td>\n      <td>2.00</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"索引和获取数据\"><a href=\"#索引和获取数据\" class=\"headerlink\" title=\"索引和获取数据\"></a>索引和获取数据</h3><p>DataFrame 可以以不同的方式进行索引。</p>\n<p>使用 <code>DataFrame[&#39;Name&#39;]</code> 可以得到一个单独的列。比如，离网率有多高？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Churn'</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>0.14491449144914492</code></pre><p>对一家公司而言，14.5% 的离网率是一个很糟糕的数据，这么高的离网率可能导致公司破产。</p>\n<p>布尔值索引同样很方便，语法是 <code>df[P(df[&#39;Name&#39;])]</code>，P 是在检查 Name 列每个元素时所使用的逻辑条件。这一索引的输出是 DataFrame 的 Name 列中满足 P 条件的行。</p>\n<p>让我们使用布尔值索引来回答这样以下问题：离网用户的数值变量的均值是多少？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>Account length            102.664596\nArea code                 437.817805\nNumber vmail messages       5.115942\nTotal day minutes         206.914079\nTotal day calls           101.335404\nTotal day charge           35.175921\nTotal eve minutes         212.410145\nTotal eve calls           100.561077\nTotal eve charge           18.054969\nTotal night minutes       205.231677\nTotal night calls         100.399586\nTotal night charge          9.235528\nTotal intl minutes         10.700000\nTotal intl calls            4.163561\nTotal intl charge           2.889545\nCustomer service calls      2.229814\nChurn                       1.000000\ndtype: float64</code></pre><p>离网用户在白天打电话的总时长的均值是多少？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>][<span class=\"string\">'Total day minutes'</span>].mean()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>206.91407867494823</code></pre><p>未使用国际套餐（<code>International plan == NO</code>）的忠实用户（<code>Churn == 0</code>）所打的最长的国际长途是多久？</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[(df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">1</span>) &amp; (df[<span class=\"string\">'International plan'</span>] == <span class=\"string\">'No'</span>)][<span class=\"string\">'Total intl minutes'</span>].max()</span><br><span class=\"line\">df[(df[<span class=\"string\">'Churn'</span>] == <span class=\"number\">0</span>) &amp; (df[<span class=\"string\">'International plan'</span>] == <span class=\"string\">'No'</span>)][<span class=\"string\">'Total intl minutes'</span>].max()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>18.9</code></pre><p>DataFrame 可以通过列名、行名、行号进行索引。<code>loc</code> 方法为通过名称索引，<code>iloc</code> 方法为通过数字索引。</p>\n<p>通过 <code>loc</code> 方法输出 0 至 5 行、State 州 至 Area code 区号 的数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.loc[<span class=\"number\">0</span>:<span class=\"number\">5</span>, [<span class=\"string\">'State'</span>,<span class=\"string\">'Area code'</span>]]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>510</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>通过 <code>ilo</code> 方法输出前 5 行的前 3 列数据（和典型的 Python 切片一样，不含最大值）。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.iloc[<span class=\"number\">0</span>:<span class=\"number\">5</span>, <span class=\"number\">0</span>:<span class=\"number\">3</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>df[:1]</code> 和 <code>df[-1:]</code> 可以得到 DataFrame 的首行和末行。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"number\">-2</span>:]</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3331</th>\n      <td>CT</td>\n      <td>184</td>\n      <td>510</td>\n      <td>Yes</td>\n      <td>No</td>\n      <td>0</td>\n      <td>213.8</td>\n      <td>105</td>\n      <td>36.35</td>\n      <td>159.6</td>\n      <td>84</td>\n      <td>13.57</td>\n      <td>139.2</td>\n      <td>137</td>\n      <td>6.26</td>\n      <td>5.0</td>\n      <td>10</td>\n      <td>1.35</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3332</th>\n      <td>TN</td>\n      <td>74</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>234.4</td>\n      <td>113</td>\n      <td>39.85</td>\n      <td>265.9</td>\n      <td>82</td>\n      <td>22.60</td>\n      <td>241.4</td>\n      <td>77</td>\n      <td>10.86</td>\n      <td>13.7</td>\n      <td>4</td>\n      <td>3.70</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"应用函数到单元格、列、行\"><a href=\"#应用函数到单元格、列、行\" class=\"headerlink\" title=\"应用函数到单元格、列、行\"></a>应用函数到单元格、列、行</h3><p>下面通过 <code>apply()</code> 方法应用函数 <code>max</code> 至每一列，即输出每列的最大值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.apply(np.max)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>State                        WY\nAccount length              243\nArea code                   510\nInternational plan          Yes\nVoice mail plan             Yes\nNumber vmail messages        51\nTotal day minutes         350.8\nTotal day calls             165\nTotal day charge          59.64\nTotal eve minutes         363.7\nTotal eve calls             170\nTotal eve charge          30.91\nTotal night minutes         395\nTotal night calls           175\nTotal night charge        17.77\nTotal intl minutes           20\nTotal intl calls             20\nTotal intl charge           5.4\nCustomer service calls        9\nChurn                         1\ndtype: object</code></pre><p><code>apply()</code> 方法也可以应用函数至每一行，指定 axis=1 即可。在这种情况下，使用 <code>lambda</code> 函数十分方便。比如，下面函数选中了所有以 W 开头的州。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[df[<span class=\"string\">'State'</span>].apply(<span class=\"keyword\">lambda</span> state: state[<span class=\"number\">0</span>] == <span class=\"string\">'W'</span>)].head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9</th>\n      <td>WV</td>\n      <td>141</td>\n      <td>415</td>\n      <td>Yes</td>\n      <td>Yes</td>\n      <td>37</td>\n      <td>258.6</td>\n      <td>84</td>\n      <td>43.96</td>\n      <td>222.0</td>\n      <td>111</td>\n      <td>18.87</td>\n      <td>326.4</td>\n      <td>97</td>\n      <td>14.69</td>\n      <td>11.2</td>\n      <td>5</td>\n      <td>3.02</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>WY</td>\n      <td>57</td>\n      <td>408</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>39</td>\n      <td>213.0</td>\n      <td>115</td>\n      <td>36.21</td>\n      <td>191.1</td>\n      <td>112</td>\n      <td>16.24</td>\n      <td>182.7</td>\n      <td>115</td>\n      <td>8.22</td>\n      <td>9.5</td>\n      <td>3</td>\n      <td>2.57</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>WI</td>\n      <td>64</td>\n      <td>510</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>154.0</td>\n      <td>67</td>\n      <td>26.18</td>\n      <td>225.8</td>\n      <td>118</td>\n      <td>19.19</td>\n      <td>265.3</td>\n      <td>86</td>\n      <td>11.94</td>\n      <td>3.5</td>\n      <td>3</td>\n      <td>0.95</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>WY</td>\n      <td>97</td>\n      <td>415</td>\n      <td>No</td>\n      <td>Yes</td>\n      <td>24</td>\n      <td>133.2</td>\n      <td>135</td>\n      <td>22.64</td>\n      <td>217.2</td>\n      <td>58</td>\n      <td>18.46</td>\n      <td>70.6</td>\n      <td>79</td>\n      <td>3.18</td>\n      <td>11.0</td>\n      <td>3</td>\n      <td>2.97</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>WY</td>\n      <td>87</td>\n      <td>415</td>\n      <td>No</td>\n      <td>No</td>\n      <td>0</td>\n      <td>151.0</td>\n      <td>83</td>\n      <td>25.67</td>\n      <td>219.7</td>\n      <td>116</td>\n      <td>18.67</td>\n      <td>203.9</td>\n      <td>127</td>\n      <td>9.18</td>\n      <td>9.7</td>\n      <td>3</td>\n      <td>2.62</td>\n      <td>5</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p><code>map()</code> 方法可以通过一个 {old_value:new_value} 形式的字典替换某一列中的值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = &#123;<span class=\"string\">'No'</span>: <span class=\"literal\">False</span>, <span class=\"string\">'Yes'</span>: <span class=\"literal\">True</span>&#125;</span><br><span class=\"line\">df[<span class=\"string\">'International plan'</span>] = df[<span class=\"string\">'International plan'</span>].map(d)</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>Yes</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>No</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>No</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>当然，使用 <code>repalce()</code> 方法一样可以达到替换的目的。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df = df.replace(&#123;<span class=\"string\">'Voice mail plan'</span>: d&#125;)</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>Total eve calls</th>\n      <th>Total eve charge</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>99</td>\n      <td>16.78</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>103</td>\n      <td>16.62</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>110</td>\n      <td>10.30</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>88</td>\n      <td>5.26</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>122</td>\n      <td>12.61</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<h3 id=\"增减-DataFrame-的行列\"><a href=\"#增减-DataFrame-的行列\" class=\"headerlink\" title=\"增减 DataFrame 的行列\"></a>增减 DataFrame 的行列</h3><p>在 DataFrame 中新增列有很多方法，比如，使用 <code>insert()</code>方法添加列，为所有用户计算总的 Total calls 电话量。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">total_calls = df[<span class=\"string\">'Total day calls'</span>] + df[<span class=\"string\">'Total eve calls'</span>] + \\</span><br><span class=\"line\">df[<span class=\"string\">'Total night calls'</span>] + df[<span class=\"string\">'Total intl calls'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">df.insert(loc=len(df.columns), column=<span class=\"string\">'Total calls 2'</span>, value=total_calls)</span><br><span class=\"line\"></span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>254.4</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>162.6</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n<p>上面的代码创建了一个中间 Series 实例，即 tatal_calls，其实可以在不创造这个实例的情况下直接添加列。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Total charge'</span>] = df[<span class=\"string\">'Total day charge'</span>] + df[<span class=\"string\">'Total eve charge'</span>] + \\</span><br><span class=\"line\">df[<span class=\"string\">'Total night charge'</span>] + df[<span class=\"string\">'Total intl charge'</span>]</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total calls 2</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>OH</td>\n      <td>107</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>26</td>\n      <td>161.6</td>\n      <td>123</td>\n      <td>27.47</td>\n      <td>195.5</td>\n      <td>...</td>\n      <td>103</td>\n      <td>11.45</td>\n      <td>13.7</td>\n      <td>3</td>\n      <td>3.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>332</td>\n      <td>332</td>\n      <td>59.24</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NJ</td>\n      <td>137</td>\n      <td>415</td>\n      <td>False</td>\n      <td>False</td>\n      <td>0</td>\n      <td>243.4</td>\n      <td>114</td>\n      <td>41.38</td>\n      <td>121.2</td>\n      <td>...</td>\n      <td>104</td>\n      <td>7.32</td>\n      <td>12.2</td>\n      <td>5</td>\n      <td>3.29</td>\n      <td>0</td>\n      <td>0</td>\n      <td>333</td>\n      <td>333</td>\n      <td>62.29</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 23 columns</p>\n</div>\n\n\n\n<p>使用 <code>drop()</code> 方法删除列和行。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df1 = df.drop([<span class=\"number\">1</span>, <span class=\"number\">2</span>])</span><br><span class=\"line\">df1.head()</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>State</th>\n      <th>Account length</th>\n      <th>Area code</th>\n      <th>International plan</th>\n      <th>Voice mail plan</th>\n      <th>Number vmail messages</th>\n      <th>Total day minutes</th>\n      <th>Total day calls</th>\n      <th>Total day charge</th>\n      <th>Total eve minutes</th>\n      <th>...</th>\n      <th>Total night minutes</th>\n      <th>Total night calls</th>\n      <th>Total night charge</th>\n      <th>Total intl minutes</th>\n      <th>Total intl calls</th>\n      <th>Total intl charge</th>\n      <th>Customer service calls</th>\n      <th>Churn</th>\n      <th>Total calls</th>\n      <th>Total charge</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>KS</td>\n      <td>128</td>\n      <td>415</td>\n      <td>False</td>\n      <td>True</td>\n      <td>25</td>\n      <td>265.1</td>\n      <td>110</td>\n      <td>45.07</td>\n      <td>197.4</td>\n      <td>...</td>\n      <td>244.7</td>\n      <td>91</td>\n      <td>11.01</td>\n      <td>10.0</td>\n      <td>3</td>\n      <td>2.70</td>\n      <td>1</td>\n      <td>0</td>\n      <td>303</td>\n      <td>75.56</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>OH</td>\n      <td>84</td>\n      <td>408</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>299.4</td>\n      <td>71</td>\n      <td>50.90</td>\n      <td>61.9</td>\n      <td>...</td>\n      <td>196.9</td>\n      <td>89</td>\n      <td>8.86</td>\n      <td>6.6</td>\n      <td>7</td>\n      <td>1.78</td>\n      <td>2</td>\n      <td>0</td>\n      <td>255</td>\n      <td>66.80</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OK</td>\n      <td>75</td>\n      <td>415</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>166.7</td>\n      <td>113</td>\n      <td>28.34</td>\n      <td>148.3</td>\n      <td>...</td>\n      <td>186.9</td>\n      <td>121</td>\n      <td>8.41</td>\n      <td>10.1</td>\n      <td>3</td>\n      <td>2.73</td>\n      <td>3</td>\n      <td>0</td>\n      <td>359</td>\n      <td>52.09</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>AL</td>\n      <td>118</td>\n      <td>510</td>\n      <td>True</td>\n      <td>False</td>\n      <td>0</td>\n      <td>223.4</td>\n      <td>98</td>\n      <td>37.98</td>\n      <td>220.6</td>\n      <td>...</td>\n      <td>203.9</td>\n      <td>118</td>\n      <td>9.18</td>\n      <td>6.3</td>\n      <td>6</td>\n      <td>1.70</td>\n      <td>0</td>\n      <td>0</td>\n      <td>323</td>\n      <td>67.61</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>MA</td>\n      <td>121</td>\n      <td>510</td>\n      <td>False</td>\n      <td>True</td>\n      <td>24</td>\n      <td>218.2</td>\n      <td>88</td>\n      <td>37.09</td>\n      <td>348.5</td>\n      <td>...</td>\n      <td>212.6</td>\n      <td>118</td>\n      <td>9.57</td>\n      <td>7.5</td>\n      <td>7</td>\n      <td>2.03</td>\n      <td>3</td>\n      <td>0</td>\n      <td>321</td>\n      <td>78.31</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 22 columns</p>\n</div>\n\n\n\n<p>对上述代码的部分解释：</p>\n<ul>\n<li>将相应的索引 <code>[&#39;Total charge&#39;, &#39;Total calls&#39;]</code> 和 <code>axis</code> 参数（1 表示删除列，0 表示删除行，默认值为 0）传给 <code>drop</code>。</li>\n<li><code>inplace</code> 参数表示是否修改原始 DataFrame （False 表示不修改现有 DataFrame，返回一个新 DataFrame，True 表示修改当前 DataFrame）。</li>\n</ul>\n<h2 id=\"预测离网率\"><a href=\"#预测离网率\" class=\"headerlink\" title=\"预测离网率\"></a>预测离网率</h2><p>首先，通过 <code>crosstab()</code> 方法构建一个交叉表来查看 International plan 国际套餐 变量和 Churn 离网率 的相关性，同时使用 <code>countplot()</code> 方法构建计数直方图来可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 加载模块，配置绘图</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'International plan'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11f0c8450&gt;</code></pre><p><img src=\"data/output_75_1.png\" alt=\"png\"></p>\n<p>上图表明，开通了国际套餐的用户的离网率要高很多，这是一个很有趣的观测结果。也许，国际电话高昂的话费让客户很不满意。</p>\n<p>同理，查看 Customer service calls 客服呼叫 变量与 Chunrn 离网率 的相关性，并可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Churn'</span>], df[<span class=\"string\">'Customer service calls'</span>], margins=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Customer service calls</th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n      <th>8</th>\n      <th>9</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Churn</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>605</td>\n      <td>1059</td>\n      <td>672</td>\n      <td>385</td>\n      <td>90</td>\n      <td>26</td>\n      <td>8</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n      <td>2850</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92</td>\n      <td>122</td>\n      <td>87</td>\n      <td>44</td>\n      <td>76</td>\n      <td>40</td>\n      <td>14</td>\n      <td>5</td>\n      <td>1</td>\n      <td>2</td>\n      <td>483</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>697</td>\n      <td>1181</td>\n      <td>759</td>\n      <td>429</td>\n      <td>166</td>\n      <td>66</td>\n      <td>22</td>\n      <td>9</td>\n      <td>2</td>\n      <td>2</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Customer service calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11cb70d50&gt;</code></pre><p><img src=\"data/output_79_1.png\" alt=\"png\"></p>\n<p>上图表明，在客服呼叫 4 次之后，客户的离网率显著提升。</p>\n<p>为了更好的突出 Customer service call 客服呼叫 和 Churn 离网率 的关系，可以给 DataFrame 添加一个二元属性 Many_service_calls，即客户呼叫超过 3 次（Customer service calls &gt; 3）。看下它与离网率的相关性，并可视化结果。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df[<span class=\"string\">'Many_service_calls'</span>] = (df[<span class=\"string\">'Customer service calls'</span>] &gt; <span class=\"number\">3</span>).astype(<span class=\"string\">'int'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Many_service_calls'</span>], df[<span class=\"string\">'Churn'</span>], margins=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th>Many_service_calls</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2721</td>\n      <td>345</td>\n      <td>3066</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>129</td>\n      <td>138</td>\n      <td>267</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <td>2850</td>\n      <td>483</td>\n      <td>3333</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sns.countplot(x=<span class=\"string\">'Many_service_calls'</span>, hue=<span class=\"string\">'Churn'</span>, data=df)</span><br></pre></td></tr></table></figure>\n\n\n\n\n<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x11ce1c850&gt;</code></pre><p><img src=\"data/output_83_1.png\" alt=\"png\"></p>\n<p>现在我们可以创建另一张交叉表，将 Churn 离网率 与 International plan 国际套餐 及新创建的 Many_service_calls 多次客服呼叫 关联起来。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pd.crosstab(df[<span class=\"string\">'Many_service_calls'</span>] &amp; df[<span class=\"string\">'International plan'</span>], df[<span class=\"string\">'Churn'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}</code></pre><p></style></p>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Churn</th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n    <tr>\n      <th>row_0</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>False</th>\n      <td>2841</td>\n      <td>464</td>\n    </tr>\n    <tr>\n      <th>True</th>\n      <td>9</td>\n      <td>19</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n<p>上表表明，在客服呼叫次数超过 3 次并且已办理 International Plan 国际套餐 的情况下，预测一名客户不忠诚的准确率（Accuracy）可以达到 85.8％，计算公式如下：</p>\n<p>$$准确率（Accuracy）=\\frac{TP+TN}{TP+TN+FP+FN}=\\frac{2841+19}{2841+9+19+464}\\times100%$$</p>\n<p>其中，TP 表示将 True 预测为 True 的数量，TN 表示将 Flase 预测为 Flase 的数量，FP 表示将 Flase 预测为 True 的数量，FN 表示将 True 预测为 Flase 的数量。</p>\n<p>复习一下本次实验的内容：</p>\n<ul>\n<li>样本中忠实客户的份额为 85.5%。这意味着最简单的预测「忠实客户」的模型有 85.5% 的概率猜对。也就是说，后续模型的准确率（Accuracy）不应该比这个数字少，并且很有希望显著高于这个数字。</li>\n<li>基于一个简单的「（客服呼叫次数 &gt; 3） &amp; （国际套餐 = True） =&gt; Churn = 1, else Churn = 0」规则的预测模型，可以得到 85.8% 的准确率。以后我们将讨论决策树，看看如何仅仅基于输入数据自动找出类似的规则，而不需要我们手工设定。我们没有应用机器学习方法就得到了两个准确率（85.5% 和 85.8%），它们可作为后续其他模型的基线。如果经过大量的努力，我们仅将准确率提高了 0.5%，那么我们努力的方向可能出现了偏差，因为仅仅使用一个包含两个限制规则的简单模型就已提升了 0.3% 的准确率。</li>\n<li>在训练复杂模型之前，建议预处理一下数据，绘制一些图表，做一些简单的假设。此外，在实际任务上应用机器学习时，通常从简单的方案开始，接着尝试更复杂的方案。</li>\n</ul>\n<h3 id=\"实验总结\"><a href=\"#实验总结\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h3><p>本次实验使用 Pandas 对数据进行了一定程度的分析和探索，交叉表、透视表等方法的运用将使你在数据探索过程中事半功倍。</p>\n"},{"title":"Java中的定时任务","_content":"\n# Schedule\n\n只适合处理简单的计划任务，不能处理分布式计划任务。优势：是spring框架提供的计划任务，开发简单，执行效率比较高。且在计划任务数量太多的时候，可能出现阻塞，崩溃，延迟启动等问题。\n\n\n\n例子\n\n```java\n@Configuration      //1.主要用于标记配置类，兼备Component的效果。\n@EnableScheduling   // 2.开启定时任务\npublic class DynamicScheduleTask implements SchedulingConfigurer {\n    /**\n     * 执行定时任务.\n     */\n    @Override\n    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {\n\n        taskRegistrar.addTriggerTask(\n                //1.添加任务内容(Runnable)\n                () -> System.out.println(\"执行动态定时任务: \" + LocalDateTime.now().toLocalTime()),\n                //2.设置执行周期(Trigger)\n                triggerContext -> {\n                    //2.1 从数据库获取执行周期\n                    String cron = cronMapper.getCron();\n                    //2.2 合法性校验.\n                    if (StringUtils.isEmpty(cron)) {\n                        // Omitted Code ..\n                    }\n                    //2.3 返回执行周期(Date)\n                    return new CronTrigger(cron).nextExecutionTime(triggerContext);\n                }\n        );\n    }\n}\n```\n\n\n\n## Cron表达式\n\nCron = \"seconds minutes hours day month week\"\n\n或\n\ncron = \"seconds minutes hours day month week year\"\n\n| 位置 | 时间       | 允许值    | 允许的特殊字符  |\n| ---- | ---------- | --------- | --------------- |\n| 1    | 秒         | 0-59      | , - * /         |\n| 2    | 分钟       | 0-59      | , - * /         |\n| 3    | 小时       | 0-23      | , - * /         |\n| 4    | 日         | 1-31      | , - * / L W C   |\n| 5    | 月         | 1-12      | , - * /         |\n| 6    | 星期       | 1-7       | , - * ? / L C # |\n| 7    | 年（可选） | 1970-2099 | , - * /         |\n\n> 星号(*)：可用在所有字段中，表示对应时间域的每一个时刻，例如，*在分钟字段时，表示“每分钟”；\n>\n> 问号（?）：该字符只在日期和星期字段中使用，它通常指定为“无意义的值”，相当于占位符；\n>\n> 减号(-)：表达一个范围，如在小时字段中使用“10-12”，则表示从10到12点，即10,11,12；\n>\n> 逗号(,)：表达一个列表值，如在星期字段中使用“MON,WED,FRI”，则表示星期一，星期三和星期五；\n>\n> 斜杠(/)：x/y表达一个等步长序列，x为起始值，y为增量步长值。如在秒数字段中使用0/15，则表示为0,15,30和45秒，而5/15在分钟字段中表示5,20,35,50，你也可以使用*/y，它等同于0/y；\n>\n> L：该字符只在日期和星期字段中使用，代表“Last”的意思，但它在两个字段中意思不同。L在日期字段中，表示这个月份的最后一天，如一月的31号，非闰年二月的28号；如果L用在星期中，则表示星期六，等同于7。但是，如果L出现在星期字段里，而且在前面有一个数值X，则表示“这个月的最后X天”，例如，6L表示该月的最后星期五；\n>\n> W：该字符只能出现在日期字段里，是对前导日期的修饰，表示离该日期最近的工作日。例如15W表示离该月15号最近的工作日，如果该月15号是星期六，则匹配14号星期五；如果15日是星期日，则匹配16号星期一；如果15号是星期二，那结果就是15号星期二。但必须注意关联的匹配日期不能够跨月，如你指定1W，如果1号是星期六，结果匹配的是3号星期一，而非上个月最后的那天。W字符串只能指定单一日期，而不能指定日期范围；\n>\n> LW组合：在日期字段可以组合使用LW，它的意思是当月的最后一个工作日；\n>\n> 井号(#)：该字符只能在星期字段中使用，表示当月某个工作日。如6#3表示当月的第三个星期五(6表示星期五，#3表示当前的第三个)，而4#5表示当月的第五个星期三，假设当月没有第五个星期三，忽略不触发；\n>\n> C：该字符只在日期和星期字段中使用，代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。\n\n**Cron表达式对特殊字符的大小写不敏感，对代表星期的缩写英文大小写也不敏感。**\n\n# Qurtz\n\nQuartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，它可以与J2EE与J2SE应用程序相结合也可以单独使用。Quartz可以用来创建简单或为运行十个，百个，甚至是好几万个Jobs这样复杂的程序。\n\n　　Quartz是一个完全由java编写的开源作业调度框架。不要让作业调度这个术语吓着你。尽管Quartz框架整合了许多额外功能， 但就其简易形式看，你会发现它易用得简直让人受不了！\n在开发Quartz相关应用时，只要定义了Job（任务），Trigger（触发器）和Scheduler（调度器），即可实现一个定时调度能力。其中Scheduler是Quartz中的核心，Scheduler负责管理Quartz应用运行时环境，Scheduler不是靠自己完成所有的工作，是根据Trigger的触发标准，调用Job中的任务执行逻辑，来完成完整的定时任务调度。\n\n- Job - 定时任务内容是什么。\n- Trigger - 在什么时间上执行job。\n- Scheduler - 维护定时任务环境，并让触发器生效。\n- 在SpringBoot中应用Quartz，需要依赖下述资源：\n\n1. 创建定时任务\n\n```java\npublic class MyTask extends QuartzJobBean {\n    @Override\n    protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException {\n        //TODO 这里写定时任务的执行逻辑\n        System.out.println(\"简单的定时任务执行时间：\"+new Date().toLocaleString());\n    }\n}\n```\n\n2. 创建配置类将定时任务添加到调度中\n\n```java\n@Configuration\npublic class QuartzConfig {\n\t//指定具体的定时任务类\n    @Bean\n    public JobDetail uploadTaskDetail() {\n        return JobBuilder.newJob(MyTask.class).withIdentity(\"MyTask\").storeDurably().build();\n    }\n\n    @Bean\n    public Trigger uploadTaskTrigger() {\n        //TODO 这里设定执行方式\n        CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(\"*/5 * * * * ?\");\n        // 返回任务触发器\n        return TriggerBuilder.newTrigger().forJob(uploadTaskDetail())\n                .withIdentity(\"MyTask\")\n                .withSchedule(scheduleBuilder)\n                .build();\n    }\n}\n```\n\n\n\n**还可以对定时任务进行动态暂停，修改，启动，单次执行等操作。**\n\n见文章：\n\nhttps://cloud.tencent.com/developer/article/1640190\n\n\n\n\n\n\n\n\n\n----\n\nReferences\n\n\n\nhttps://www.cnblogs.com/jing99/p/11546559.html\n\nhttps://cloud.tencent.com/developer/article/1640190","source":"_posts/notebook/Schedule.md","raw":"---\ntitle: Java中的定时任务\ncategories:\n- Notebook\ntags:\n- java\n- springboot\n---\n\n# Schedule\n\n只适合处理简单的计划任务，不能处理分布式计划任务。优势：是spring框架提供的计划任务，开发简单，执行效率比较高。且在计划任务数量太多的时候，可能出现阻塞，崩溃，延迟启动等问题。\n\n\n\n例子\n\n```java\n@Configuration      //1.主要用于标记配置类，兼备Component的效果。\n@EnableScheduling   // 2.开启定时任务\npublic class DynamicScheduleTask implements SchedulingConfigurer {\n    /**\n     * 执行定时任务.\n     */\n    @Override\n    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {\n\n        taskRegistrar.addTriggerTask(\n                //1.添加任务内容(Runnable)\n                () -> System.out.println(\"执行动态定时任务: \" + LocalDateTime.now().toLocalTime()),\n                //2.设置执行周期(Trigger)\n                triggerContext -> {\n                    //2.1 从数据库获取执行周期\n                    String cron = cronMapper.getCron();\n                    //2.2 合法性校验.\n                    if (StringUtils.isEmpty(cron)) {\n                        // Omitted Code ..\n                    }\n                    //2.3 返回执行周期(Date)\n                    return new CronTrigger(cron).nextExecutionTime(triggerContext);\n                }\n        );\n    }\n}\n```\n\n\n\n## Cron表达式\n\nCron = \"seconds minutes hours day month week\"\n\n或\n\ncron = \"seconds minutes hours day month week year\"\n\n| 位置 | 时间       | 允许值    | 允许的特殊字符  |\n| ---- | ---------- | --------- | --------------- |\n| 1    | 秒         | 0-59      | , - * /         |\n| 2    | 分钟       | 0-59      | , - * /         |\n| 3    | 小时       | 0-23      | , - * /         |\n| 4    | 日         | 1-31      | , - * / L W C   |\n| 5    | 月         | 1-12      | , - * /         |\n| 6    | 星期       | 1-7       | , - * ? / L C # |\n| 7    | 年（可选） | 1970-2099 | , - * /         |\n\n> 星号(*)：可用在所有字段中，表示对应时间域的每一个时刻，例如，*在分钟字段时，表示“每分钟”；\n>\n> 问号（?）：该字符只在日期和星期字段中使用，它通常指定为“无意义的值”，相当于占位符；\n>\n> 减号(-)：表达一个范围，如在小时字段中使用“10-12”，则表示从10到12点，即10,11,12；\n>\n> 逗号(,)：表达一个列表值，如在星期字段中使用“MON,WED,FRI”，则表示星期一，星期三和星期五；\n>\n> 斜杠(/)：x/y表达一个等步长序列，x为起始值，y为增量步长值。如在秒数字段中使用0/15，则表示为0,15,30和45秒，而5/15在分钟字段中表示5,20,35,50，你也可以使用*/y，它等同于0/y；\n>\n> L：该字符只在日期和星期字段中使用，代表“Last”的意思，但它在两个字段中意思不同。L在日期字段中，表示这个月份的最后一天，如一月的31号，非闰年二月的28号；如果L用在星期中，则表示星期六，等同于7。但是，如果L出现在星期字段里，而且在前面有一个数值X，则表示“这个月的最后X天”，例如，6L表示该月的最后星期五；\n>\n> W：该字符只能出现在日期字段里，是对前导日期的修饰，表示离该日期最近的工作日。例如15W表示离该月15号最近的工作日，如果该月15号是星期六，则匹配14号星期五；如果15日是星期日，则匹配16号星期一；如果15号是星期二，那结果就是15号星期二。但必须注意关联的匹配日期不能够跨月，如你指定1W，如果1号是星期六，结果匹配的是3号星期一，而非上个月最后的那天。W字符串只能指定单一日期，而不能指定日期范围；\n>\n> LW组合：在日期字段可以组合使用LW，它的意思是当月的最后一个工作日；\n>\n> 井号(#)：该字符只能在星期字段中使用，表示当月某个工作日。如6#3表示当月的第三个星期五(6表示星期五，#3表示当前的第三个)，而4#5表示当月的第五个星期三，假设当月没有第五个星期三，忽略不触发；\n>\n> C：该字符只在日期和星期字段中使用，代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。\n\n**Cron表达式对特殊字符的大小写不敏感，对代表星期的缩写英文大小写也不敏感。**\n\n# Qurtz\n\nQuartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，它可以与J2EE与J2SE应用程序相结合也可以单独使用。Quartz可以用来创建简单或为运行十个，百个，甚至是好几万个Jobs这样复杂的程序。\n\n　　Quartz是一个完全由java编写的开源作业调度框架。不要让作业调度这个术语吓着你。尽管Quartz框架整合了许多额外功能， 但就其简易形式看，你会发现它易用得简直让人受不了！\n在开发Quartz相关应用时，只要定义了Job（任务），Trigger（触发器）和Scheduler（调度器），即可实现一个定时调度能力。其中Scheduler是Quartz中的核心，Scheduler负责管理Quartz应用运行时环境，Scheduler不是靠自己完成所有的工作，是根据Trigger的触发标准，调用Job中的任务执行逻辑，来完成完整的定时任务调度。\n\n- Job - 定时任务内容是什么。\n- Trigger - 在什么时间上执行job。\n- Scheduler - 维护定时任务环境，并让触发器生效。\n- 在SpringBoot中应用Quartz，需要依赖下述资源：\n\n1. 创建定时任务\n\n```java\npublic class MyTask extends QuartzJobBean {\n    @Override\n    protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException {\n        //TODO 这里写定时任务的执行逻辑\n        System.out.println(\"简单的定时任务执行时间：\"+new Date().toLocaleString());\n    }\n}\n```\n\n2. 创建配置类将定时任务添加到调度中\n\n```java\n@Configuration\npublic class QuartzConfig {\n\t//指定具体的定时任务类\n    @Bean\n    public JobDetail uploadTaskDetail() {\n        return JobBuilder.newJob(MyTask.class).withIdentity(\"MyTask\").storeDurably().build();\n    }\n\n    @Bean\n    public Trigger uploadTaskTrigger() {\n        //TODO 这里设定执行方式\n        CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(\"*/5 * * * * ?\");\n        // 返回任务触发器\n        return TriggerBuilder.newTrigger().forJob(uploadTaskDetail())\n                .withIdentity(\"MyTask\")\n                .withSchedule(scheduleBuilder)\n                .build();\n    }\n}\n```\n\n\n\n**还可以对定时任务进行动态暂停，修改，启动，单次执行等操作。**\n\n见文章：\n\nhttps://cloud.tencent.com/developer/article/1640190\n\n\n\n\n\n\n\n\n\n----\n\nReferences\n\n\n\nhttps://www.cnblogs.com/jing99/p/11546559.html\n\nhttps://cloud.tencent.com/developer/article/1640190","slug":"notebook/Schedule","published":1,"date":"2021-01-22T02:39:41.477Z","updated":"2021-01-22T05:46:21.005Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zs006l018ocpyngp2n","content":"<h1 id=\"Schedule\"><a href=\"#Schedule\" class=\"headerlink\" title=\"Schedule\"></a>Schedule</h1><p>只适合处理简单的计划任务，不能处理分布式计划任务。优势：是spring框架提供的计划任务，开发简单，执行效率比较高。且在计划任务数量太多的时候，可能出现阻塞，崩溃，延迟启动等问题。</p>\n<p>例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span>      <span class=\"comment\">//1.主要用于标记配置类，兼备Component的效果。</span></span><br><span class=\"line\"><span class=\"meta\">@EnableScheduling</span>   <span class=\"comment\">// 2.开启定时任务</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicScheduleTask</span> <span class=\"keyword\">implements</span> <span class=\"title\">SchedulingConfigurer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 执行定时任务.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">configureTasks</span><span class=\"params\">(ScheduledTaskRegistrar taskRegistrar)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        taskRegistrar.addTriggerTask(</span><br><span class=\"line\">                <span class=\"comment\">//1.添加任务内容(Runnable)</span></span><br><span class=\"line\">                () -&gt; System.out.println(<span class=\"string\">\"执行动态定时任务: \"</span> + LocalDateTime.now().toLocalTime()),</span><br><span class=\"line\">                <span class=\"comment\">//2.设置执行周期(Trigger)</span></span><br><span class=\"line\">                triggerContext -&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//2.1 从数据库获取执行周期</span></span><br><span class=\"line\">                    String cron = cronMapper.getCron();</span><br><span class=\"line\">                    <span class=\"comment\">//2.2 合法性校验.</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (StringUtils.isEmpty(cron)) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Omitted Code ..</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"comment\">//2.3 返回执行周期(Date)</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> CronTrigger(cron).nextExecutionTime(triggerContext);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Cron表达式\"><a href=\"#Cron表达式\" class=\"headerlink\" title=\"Cron表达式\"></a>Cron表达式</h2><p>Cron = “seconds minutes hours day month week”</p>\n<p>或</p>\n<p>cron = “seconds minutes hours day month week year”</p>\n<table>\n<thead>\n<tr>\n<th>位置</th>\n<th>时间</th>\n<th>允许值</th>\n<th>允许的特殊字符</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>秒</td>\n<td>0-59</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>2</td>\n<td>分钟</td>\n<td>0-59</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>3</td>\n<td>小时</td>\n<td>0-23</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>4</td>\n<td>日</td>\n<td>1-31</td>\n<td>, - * / L W C</td>\n</tr>\n<tr>\n<td>5</td>\n<td>月</td>\n<td>1-12</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>6</td>\n<td>星期</td>\n<td>1-7</td>\n<td>, - * ? / L C #</td>\n</tr>\n<tr>\n<td>7</td>\n<td>年（可选）</td>\n<td>1970-2099</td>\n<td>, - * /</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>星号(<em>)：可用在所有字段中，表示对应时间域的每一个时刻，例如，</em>在分钟字段时，表示“每分钟”；</p>\n<p>问号（?）：该字符只在日期和星期字段中使用，它通常指定为“无意义的值”，相当于占位符；</p>\n<p>减号(-)：表达一个范围，如在小时字段中使用“10-12”，则表示从10到12点，即10,11,12；</p>\n<p>逗号(,)：表达一个列表值，如在星期字段中使用“MON,WED,FRI”，则表示星期一，星期三和星期五；</p>\n<p>斜杠(/)：x/y表达一个等步长序列，x为起始值，y为增量步长值。如在秒数字段中使用0/15，则表示为0,15,30和45秒，而5/15在分钟字段中表示5,20,35,50，你也可以使用*/y，它等同于0/y；</p>\n<p>L：该字符只在日期和星期字段中使用，代表“Last”的意思，但它在两个字段中意思不同。L在日期字段中，表示这个月份的最后一天，如一月的31号，非闰年二月的28号；如果L用在星期中，则表示星期六，等同于7。但是，如果L出现在星期字段里，而且在前面有一个数值X，则表示“这个月的最后X天”，例如，6L表示该月的最后星期五；</p>\n<p>W：该字符只能出现在日期字段里，是对前导日期的修饰，表示离该日期最近的工作日。例如15W表示离该月15号最近的工作日，如果该月15号是星期六，则匹配14号星期五；如果15日是星期日，则匹配16号星期一；如果15号是星期二，那结果就是15号星期二。但必须注意关联的匹配日期不能够跨月，如你指定1W，如果1号是星期六，结果匹配的是3号星期一，而非上个月最后的那天。W字符串只能指定单一日期，而不能指定日期范围；</p>\n<p>LW组合：在日期字段可以组合使用LW，它的意思是当月的最后一个工作日；</p>\n<p>井号(#)：该字符只能在星期字段中使用，表示当月某个工作日。如6#3表示当月的第三个星期五(6表示星期五，#3表示当前的第三个)，而4#5表示当月的第五个星期三，假设当月没有第五个星期三，忽略不触发；</p>\n<p>C：该字符只在日期和星期字段中使用，代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。</p>\n</blockquote>\n<p><strong>Cron表达式对特殊字符的大小写不敏感，对代表星期的缩写英文大小写也不敏感。</strong></p>\n<h1 id=\"Qurtz\"><a href=\"#Qurtz\" class=\"headerlink\" title=\"Qurtz\"></a>Qurtz</h1><p>Quartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，它可以与J2EE与J2SE应用程序相结合也可以单独使用。Quartz可以用来创建简单或为运行十个，百个，甚至是好几万个Jobs这样复杂的程序。</p>\n<p>　　Quartz是一个完全由java编写的开源作业调度框架。不要让作业调度这个术语吓着你。尽管Quartz框架整合了许多额外功能， 但就其简易形式看，你会发现它易用得简直让人受不了！<br>在开发Quartz相关应用时，只要定义了Job（任务），Trigger（触发器）和Scheduler（调度器），即可实现一个定时调度能力。其中Scheduler是Quartz中的核心，Scheduler负责管理Quartz应用运行时环境，Scheduler不是靠自己完成所有的工作，是根据Trigger的触发标准，调用Job中的任务执行逻辑，来完成完整的定时任务调度。</p>\n<ul>\n<li>Job - 定时任务内容是什么。</li>\n<li>Trigger - 在什么时间上执行job。</li>\n<li>Scheduler - 维护定时任务环境，并让触发器生效。</li>\n<li>在SpringBoot中应用Quartz，需要依赖下述资源：</li>\n</ul>\n<ol>\n<li>创建定时任务</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyTask</span> <span class=\"keyword\">extends</span> <span class=\"title\">QuartzJobBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">executeInternal</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//TODO 这里写定时任务的执行逻辑</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"简单的定时任务执行时间：\"</span>+<span class=\"keyword\">new</span> Date().toLocaleString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>创建配置类将定时任务添加到调度中</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QuartzConfig</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//指定具体的定时任务类</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JobDetail <span class=\"title\">uploadTaskDetail</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        return JobBuilder.newJob(MyTask.class).withIdentity(\"MyTask\").storeDurably().build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Trigger <span class=\"title\">uploadTaskTrigger</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//TODO 这里设定执行方式</span></span><br><span class=\"line\">        CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(<span class=\"string\">\"*/5 * * * * ?\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 返回任务触发器</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> TriggerBuilder.newTrigger().forJob(uploadTaskDetail())</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">\"MyTask\"</span>)</span><br><span class=\"line\">                .withSchedule(scheduleBuilder)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>还可以对定时任务进行动态暂停，修改，启动，单次执行等操作。</strong></p>\n<p>见文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjQwMTkw\">https://cloud.tencent.com/developer/article/1640190<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vamluZzk5L3AvMTE1NDY1NTkuaHRtbA==\">https://www.cnblogs.com/jing99/p/11546559.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjQwMTkw\">https://cloud.tencent.com/developer/article/1640190<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Schedule\"><a href=\"#Schedule\" class=\"headerlink\" title=\"Schedule\"></a>Schedule</h1><p>只适合处理简单的计划任务，不能处理分布式计划任务。优势：是spring框架提供的计划任务，开发简单，执行效率比较高。且在计划任务数量太多的时候，可能出现阻塞，崩溃，延迟启动等问题。</p>\n<p>例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span>      <span class=\"comment\">//1.主要用于标记配置类，兼备Component的效果。</span></span><br><span class=\"line\"><span class=\"meta\">@EnableScheduling</span>   <span class=\"comment\">// 2.开启定时任务</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DynamicScheduleTask</span> <span class=\"keyword\">implements</span> <span class=\"title\">SchedulingConfigurer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 执行定时任务.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">configureTasks</span><span class=\"params\">(ScheduledTaskRegistrar taskRegistrar)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        taskRegistrar.addTriggerTask(</span><br><span class=\"line\">                <span class=\"comment\">//1.添加任务内容(Runnable)</span></span><br><span class=\"line\">                () -&gt; System.out.println(<span class=\"string\">\"执行动态定时任务: \"</span> + LocalDateTime.now().toLocalTime()),</span><br><span class=\"line\">                <span class=\"comment\">//2.设置执行周期(Trigger)</span></span><br><span class=\"line\">                triggerContext -&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//2.1 从数据库获取执行周期</span></span><br><span class=\"line\">                    String cron = cronMapper.getCron();</span><br><span class=\"line\">                    <span class=\"comment\">//2.2 合法性校验.</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (StringUtils.isEmpty(cron)) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Omitted Code ..</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"comment\">//2.3 返回执行周期(Date)</span></span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> CronTrigger(cron).nextExecutionTime(triggerContext);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Cron表达式\"><a href=\"#Cron表达式\" class=\"headerlink\" title=\"Cron表达式\"></a>Cron表达式</h2><p>Cron = “seconds minutes hours day month week”</p>\n<p>或</p>\n<p>cron = “seconds minutes hours day month week year”</p>\n<table>\n<thead>\n<tr>\n<th>位置</th>\n<th>时间</th>\n<th>允许值</th>\n<th>允许的特殊字符</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>秒</td>\n<td>0-59</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>2</td>\n<td>分钟</td>\n<td>0-59</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>3</td>\n<td>小时</td>\n<td>0-23</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>4</td>\n<td>日</td>\n<td>1-31</td>\n<td>, - * / L W C</td>\n</tr>\n<tr>\n<td>5</td>\n<td>月</td>\n<td>1-12</td>\n<td>, - * /</td>\n</tr>\n<tr>\n<td>6</td>\n<td>星期</td>\n<td>1-7</td>\n<td>, - * ? / L C #</td>\n</tr>\n<tr>\n<td>7</td>\n<td>年（可选）</td>\n<td>1970-2099</td>\n<td>, - * /</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>星号(<em>)：可用在所有字段中，表示对应时间域的每一个时刻，例如，</em>在分钟字段时，表示“每分钟”；</p>\n<p>问号（?）：该字符只在日期和星期字段中使用，它通常指定为“无意义的值”，相当于占位符；</p>\n<p>减号(-)：表达一个范围，如在小时字段中使用“10-12”，则表示从10到12点，即10,11,12；</p>\n<p>逗号(,)：表达一个列表值，如在星期字段中使用“MON,WED,FRI”，则表示星期一，星期三和星期五；</p>\n<p>斜杠(/)：x/y表达一个等步长序列，x为起始值，y为增量步长值。如在秒数字段中使用0/15，则表示为0,15,30和45秒，而5/15在分钟字段中表示5,20,35,50，你也可以使用*/y，它等同于0/y；</p>\n<p>L：该字符只在日期和星期字段中使用，代表“Last”的意思，但它在两个字段中意思不同。L在日期字段中，表示这个月份的最后一天，如一月的31号，非闰年二月的28号；如果L用在星期中，则表示星期六，等同于7。但是，如果L出现在星期字段里，而且在前面有一个数值X，则表示“这个月的最后X天”，例如，6L表示该月的最后星期五；</p>\n<p>W：该字符只能出现在日期字段里，是对前导日期的修饰，表示离该日期最近的工作日。例如15W表示离该月15号最近的工作日，如果该月15号是星期六，则匹配14号星期五；如果15日是星期日，则匹配16号星期一；如果15号是星期二，那结果就是15号星期二。但必须注意关联的匹配日期不能够跨月，如你指定1W，如果1号是星期六，结果匹配的是3号星期一，而非上个月最后的那天。W字符串只能指定单一日期，而不能指定日期范围；</p>\n<p>LW组合：在日期字段可以组合使用LW，它的意思是当月的最后一个工作日；</p>\n<p>井号(#)：该字符只能在星期字段中使用，表示当月某个工作日。如6#3表示当月的第三个星期五(6表示星期五，#3表示当前的第三个)，而4#5表示当月的第五个星期三，假设当月没有第五个星期三，忽略不触发；</p>\n<p>C：该字符只在日期和星期字段中使用，代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。</p>\n</blockquote>\n<p><strong>Cron表达式对特殊字符的大小写不敏感，对代表星期的缩写英文大小写也不敏感。</strong></p>\n<h1 id=\"Qurtz\"><a href=\"#Qurtz\" class=\"headerlink\" title=\"Qurtz\"></a>Qurtz</h1><p>Quartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，它可以与J2EE与J2SE应用程序相结合也可以单独使用。Quartz可以用来创建简单或为运行十个，百个，甚至是好几万个Jobs这样复杂的程序。</p>\n<p>　　Quartz是一个完全由java编写的开源作业调度框架。不要让作业调度这个术语吓着你。尽管Quartz框架整合了许多额外功能， 但就其简易形式看，你会发现它易用得简直让人受不了！<br>在开发Quartz相关应用时，只要定义了Job（任务），Trigger（触发器）和Scheduler（调度器），即可实现一个定时调度能力。其中Scheduler是Quartz中的核心，Scheduler负责管理Quartz应用运行时环境，Scheduler不是靠自己完成所有的工作，是根据Trigger的触发标准，调用Job中的任务执行逻辑，来完成完整的定时任务调度。</p>\n<ul>\n<li>Job - 定时任务内容是什么。</li>\n<li>Trigger - 在什么时间上执行job。</li>\n<li>Scheduler - 维护定时任务环境，并让触发器生效。</li>\n<li>在SpringBoot中应用Quartz，需要依赖下述资源：</li>\n</ul>\n<ol>\n<li>创建定时任务</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyTask</span> <span class=\"keyword\">extends</span> <span class=\"title\">QuartzJobBean</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">executeInternal</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//TODO 这里写定时任务的执行逻辑</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"简单的定时任务执行时间：\"</span>+<span class=\"keyword\">new</span> Date().toLocaleString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>创建配置类将定时任务添加到调度中</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">QuartzConfig</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//指定具体的定时任务类</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JobDetail <span class=\"title\">uploadTaskDetail</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        return JobBuilder.newJob(MyTask.class).withIdentity(\"MyTask\").storeDurably().build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Trigger <span class=\"title\">uploadTaskTrigger</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//TODO 这里设定执行方式</span></span><br><span class=\"line\">        CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(<span class=\"string\">\"*/5 * * * * ?\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 返回任务触发器</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> TriggerBuilder.newTrigger().forJob(uploadTaskDetail())</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">\"MyTask\"</span>)</span><br><span class=\"line\">                .withSchedule(scheduleBuilder)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>还可以对定时任务进行动态暂停，修改，启动，单次执行等操作。</strong></p>\n<p>见文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjQwMTkw\">https://cloud.tencent.com/developer/article/1640190<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vamluZzk5L3AvMTE1NDY1NTkuaHRtbA==\">https://www.cnblogs.com/jing99/p/11546559.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjQwMTkw\">https://cloud.tencent.com/developer/article/1640190<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Install anaconda on linux","_content":"\n# Linux\n\n```sh\nwget https://repo.anaconda.com/archive/Anaconda3-2021.05-Linux-x86_64.sh\n```\n\n\n\n# MacOS安装Anaconda\n\n## conda配置文件\n\n位置  \n`~/.condarc`\n\n配置zsh环境变量  \n`export PATH=/Applications/anaconda3/bin:$PATH`\n\n\n## conda镜像源\n\n添加镜像指令(亦可以直接在配置文件中添加)  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/`  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge`  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/`  \n\n设置搜索时显示通道地址  \n`conda config --set show_channel_urls yes`\n\n\n\n## shell虚拟环境\n\n**取消命令行前出现的(base)**\n\n- 每次在命令行通过`conda deactivate`退出base环境回到系统自动的环境\n\n- `conda config --set auto_activate_base false`\n\n\n\n## 安装TensorFlow环境\n\n新建一个tf环境  \n`conda create -n tensorflow python=3.7`\n\n进入tf环境\n`conda activate tensorflow`\n\npip安装tf  \n`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple tensorflow`\n\n指定版本安装  \n`conda install tensorflow=1.4`  \n`pip install tensorflow==1.4`\n\n\n## 卸载\n\n安装clean包  \n`conda install anaconda-clean`\n\n文件进行删除  \n`anaconda-clean`\n\n删除Anaconda主文件包(默认路径)\n`/opt/anaconda3`\n\n","source":"_posts/notebook/anaconda.md","raw":"---\ntitle: Install anaconda on linux\ncategories:\n- Notebook\ntags:\n- linux\n- anaconda\n---\n\n# Linux\n\n```sh\nwget https://repo.anaconda.com/archive/Anaconda3-2021.05-Linux-x86_64.sh\n```\n\n\n\n# MacOS安装Anaconda\n\n## conda配置文件\n\n位置  \n`~/.condarc`\n\n配置zsh环境变量  \n`export PATH=/Applications/anaconda3/bin:$PATH`\n\n\n## conda镜像源\n\n添加镜像指令(亦可以直接在配置文件中添加)  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/`  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge`  \n`conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/`  \n\n设置搜索时显示通道地址  \n`conda config --set show_channel_urls yes`\n\n\n\n## shell虚拟环境\n\n**取消命令行前出现的(base)**\n\n- 每次在命令行通过`conda deactivate`退出base环境回到系统自动的环境\n\n- `conda config --set auto_activate_base false`\n\n\n\n## 安装TensorFlow环境\n\n新建一个tf环境  \n`conda create -n tensorflow python=3.7`\n\n进入tf环境\n`conda activate tensorflow`\n\npip安装tf  \n`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple tensorflow`\n\n指定版本安装  \n`conda install tensorflow=1.4`  \n`pip install tensorflow==1.4`\n\n\n## 卸载\n\n安装clean包  \n`conda install anaconda-clean`\n\n文件进行删除  \n`anaconda-clean`\n\n删除Anaconda主文件包(默认路径)\n`/opt/anaconda3`\n\n","slug":"notebook/anaconda","published":1,"date":"2020-05-14T11:15:25.527Z","updated":"2021-08-05T12:09:52.619Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zu006n018o8mfoa4s4","content":"<h1 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://repo.anaconda.com/archive/Anaconda3-2021.05-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"MacOS安装Anaconda\"><a href=\"#MacOS安装Anaconda\" class=\"headerlink\" title=\"MacOS安装Anaconda\"></a>MacOS安装Anaconda</h1><h2 id=\"conda配置文件\"><a href=\"#conda配置文件\" class=\"headerlink\" title=\"conda配置文件\"></a>conda配置文件</h2><p>位置<br><code>~/.condarc</code></p>\n<p>配置zsh环境变量<br><code>export PATH=/Applications/anaconda3/bin:$PATH</code></p>\n<h2 id=\"conda镜像源\"><a href=\"#conda镜像源\" class=\"headerlink\" title=\"conda镜像源\"></a>conda镜像源</h2><p>添加镜像指令(亦可以直接在配置文件中添加)<br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</code><br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</code><br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</code>  </p>\n<p>设置搜索时显示通道地址<br><code>conda config --set show_channel_urls yes</code></p>\n<h2 id=\"shell虚拟环境\"><a href=\"#shell虚拟环境\" class=\"headerlink\" title=\"shell虚拟环境\"></a>shell虚拟环境</h2><p><strong>取消命令行前出现的(base)</strong></p>\n<ul>\n<li><p>每次在命令行通过<code>conda deactivate</code>退出base环境回到系统自动的环境</p>\n</li>\n<li><p><code>conda config --set auto_activate_base false</code></p>\n</li>\n</ul>\n<h2 id=\"安装TensorFlow环境\"><a href=\"#安装TensorFlow环境\" class=\"headerlink\" title=\"安装TensorFlow环境\"></a>安装TensorFlow环境</h2><p>新建一个tf环境<br><code>conda create -n tensorflow python=3.7</code></p>\n<p>进入tf环境<br><code>conda activate tensorflow</code></p>\n<p>pip安装tf<br><code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple tensorflow</code></p>\n<p>指定版本安装<br><code>conda install tensorflow=1.4</code><br><code>pip install tensorflow==1.4</code></p>\n<h2 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h2><p>安装clean包<br><code>conda install anaconda-clean</code></p>\n<p>文件进行删除<br><code>anaconda-clean</code></p>\n<p>删除Anaconda主文件包(默认路径)<br><code>/opt/anaconda3</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://repo.anaconda.com/archive/Anaconda3-2021.05-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"MacOS安装Anaconda\"><a href=\"#MacOS安装Anaconda\" class=\"headerlink\" title=\"MacOS安装Anaconda\"></a>MacOS安装Anaconda</h1><h2 id=\"conda配置文件\"><a href=\"#conda配置文件\" class=\"headerlink\" title=\"conda配置文件\"></a>conda配置文件</h2><p>位置<br><code>~/.condarc</code></p>\n<p>配置zsh环境变量<br><code>export PATH=/Applications/anaconda3/bin:$PATH</code></p>\n<h2 id=\"conda镜像源\"><a href=\"#conda镜像源\" class=\"headerlink\" title=\"conda镜像源\"></a>conda镜像源</h2><p>添加镜像指令(亦可以直接在配置文件中添加)<br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</code><br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</code><br><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</code>  </p>\n<p>设置搜索时显示通道地址<br><code>conda config --set show_channel_urls yes</code></p>\n<h2 id=\"shell虚拟环境\"><a href=\"#shell虚拟环境\" class=\"headerlink\" title=\"shell虚拟环境\"></a>shell虚拟环境</h2><p><strong>取消命令行前出现的(base)</strong></p>\n<ul>\n<li><p>每次在命令行通过<code>conda deactivate</code>退出base环境回到系统自动的环境</p>\n</li>\n<li><p><code>conda config --set auto_activate_base false</code></p>\n</li>\n</ul>\n<h2 id=\"安装TensorFlow环境\"><a href=\"#安装TensorFlow环境\" class=\"headerlink\" title=\"安装TensorFlow环境\"></a>安装TensorFlow环境</h2><p>新建一个tf环境<br><code>conda create -n tensorflow python=3.7</code></p>\n<p>进入tf环境<br><code>conda activate tensorflow</code></p>\n<p>pip安装tf<br><code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple tensorflow</code></p>\n<p>指定版本安装<br><code>conda install tensorflow=1.4</code><br><code>pip install tensorflow==1.4</code></p>\n<h2 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h2><p>安装clean包<br><code>conda install anaconda-clean</code></p>\n<p>文件进行删除<br><code>anaconda-clean</code></p>\n<p>删除Anaconda主文件包(默认路径)<br><code>/opt/anaconda3</code></p>\n"},{"title":"Conda create/delete/rename environments","_content":"\n# Create\n\n```shell\nconda create -n tensorflow20 python=3.6\n```\n\n# Delete\n\n```shell\nconda remove -n tensorflow20 --all\n```\n\n# Rename\n\nclone and delete\n\n```shell\nconda create -n tf20 --clone tensorflow20\nconda remove -n tensorflow20 --all\n```\n\n\n\n\n\n\n\n---\n\nReference\n\nhttps://www.jianshu.com/p/7265011ba3f2","source":"_posts/notebook/anaconda-rename.md","raw":"---\ntitle: Conda create/delete/rename environments\ncategories:\n- Notebook\ntags:\n- python\n- conda\n---\n\n# Create\n\n```shell\nconda create -n tensorflow20 python=3.6\n```\n\n# Delete\n\n```shell\nconda remove -n tensorflow20 --all\n```\n\n# Rename\n\nclone and delete\n\n```shell\nconda create -n tf20 --clone tensorflow20\nconda remove -n tensorflow20 --all\n```\n\n\n\n\n\n\n\n---\n\nReference\n\nhttps://www.jianshu.com/p/7265011ba3f2","slug":"notebook/anaconda-rename","published":1,"date":"2021-07-30T15:09:02.196Z","updated":"2021-08-05T12:38:58.519Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zu006p018odgiu57tz","content":"<h1 id=\"Create\"><a href=\"#Create\" class=\"headerlink\" title=\"Create\"></a>Create</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n tensorflow20 python=3.6</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Delete\"><a href=\"#Delete\" class=\"headerlink\" title=\"Delete\"></a>Delete</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda remove -n tensorflow20 --all</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Rename\"><a href=\"#Rename\" class=\"headerlink\" title=\"Rename\"></a>Rename</h1><p>clone and delete</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n tf20 --clone tensorflow20</span><br><span class=\"line\">conda remove -n tensorflow20 --all</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83MjY1MDExYmEzZjI=\">https://www.jianshu.com/p/7265011ba3f2<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Create\"><a href=\"#Create\" class=\"headerlink\" title=\"Create\"></a>Create</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n tensorflow20 python=3.6</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Delete\"><a href=\"#Delete\" class=\"headerlink\" title=\"Delete\"></a>Delete</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda remove -n tensorflow20 --all</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Rename\"><a href=\"#Rename\" class=\"headerlink\" title=\"Rename\"></a>Rename</h1><p>clone and delete</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n tf20 --clone tensorflow20</span><br><span class=\"line\">conda remove -n tensorflow20 --all</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83MjY1MDExYmEzZjI=\">https://www.jianshu.com/p/7265011ba3f2<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 面向切面编程\n## Summary\n\n在软件业，AOP为Aspect Oriented Programming的缩写，意为：面向切面编程，通过预编译方式和运行期间动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。\n\n## Description\n\nAspect Oriented Programming（AOP）是较为热门的一个话题。AOP，国内大致译作“面向切面编程”。\n\n“面向切面编程”,这样的名字并不是非常容易理解，且容易产生一些误导。有些人认为“OOP/OOD11即将落伍，AOP是新一代软件开发方式”。显然，发言者并没有理解AOP的含义。Aspect，的确是“方面”的意思。不过，汉语传统语义中的“方面”，大多数情况下指的是一件事情的不同维度、或者说不同角度上的特性，比如我们常说：“这件事情要从几个方面来看待”，往往意思是：需要从不同的角度来看待同一个事物。这里的“方面”，指的是事物的外在特性在不同观察角度下的体现。而在AOP中，Aspect的含义，可能更多的理解为“切面”比较合适。\n\n可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种技术。AOP实际是GoF设计模式的延续，设计模式孜孜不倦追求的是调用者和被调用者之间的解耦,提高代码的灵活性和可扩展性，AOP可以说也是这种目标的一种实现。\n\n在Spring中提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。\n\n主要功能\n\n日志记录，性能统计，安全控制，事务处理，异常处理等等。\n\n主要意图\n\n将日志记录，性能统计，安全控制，事务处理，异常处理等代码从业务逻辑代码中划分出来，通过对这些行为的分离，我们希望可以将它们独立到非指导业务逻辑的方法中，进而改变这些行为的时候不影响业务逻辑的代码。\n\n","source":"_posts/notebook/aop.md","raw":"# 面向切面编程\n## Summary\n\n在软件业，AOP为Aspect Oriented Programming的缩写，意为：面向切面编程，通过预编译方式和运行期间动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。\n\n## Description\n\nAspect Oriented Programming（AOP）是较为热门的一个话题。AOP，国内大致译作“面向切面编程”。\n\n“面向切面编程”,这样的名字并不是非常容易理解，且容易产生一些误导。有些人认为“OOP/OOD11即将落伍，AOP是新一代软件开发方式”。显然，发言者并没有理解AOP的含义。Aspect，的确是“方面”的意思。不过，汉语传统语义中的“方面”，大多数情况下指的是一件事情的不同维度、或者说不同角度上的特性，比如我们常说：“这件事情要从几个方面来看待”，往往意思是：需要从不同的角度来看待同一个事物。这里的“方面”，指的是事物的外在特性在不同观察角度下的体现。而在AOP中，Aspect的含义，可能更多的理解为“切面”比较合适。\n\n可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种技术。AOP实际是GoF设计模式的延续，设计模式孜孜不倦追求的是调用者和被调用者之间的解耦,提高代码的灵活性和可扩展性，AOP可以说也是这种目标的一种实现。\n\n在Spring中提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。\n\n主要功能\n\n日志记录，性能统计，安全控制，事务处理，异常处理等等。\n\n主要意图\n\n将日志记录，性能统计，安全控制，事务处理，异常处理等代码从业务逻辑代码中划分出来，通过对这些行为的分离，我们希望可以将它们独立到非指导业务逻辑的方法中，进而改变这些行为的时候不影响业务逻辑的代码。\n\n","slug":"notebook/aop","published":1,"date":"2020-03-03T15:13:33.650Z","updated":"2020-03-03T15:17:01.575Z","title":"notebook/aop","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zv006s018o5s9x5in6","content":"<h1 id=\"面向切面编程\"><a href=\"#面向切面编程\" class=\"headerlink\" title=\"面向切面编程\"></a>面向切面编程</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>在软件业，AOP为Aspect Oriented Programming的缩写，意为：面向切面编程，通过预编译方式和运行期间动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p>\n<h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>Aspect Oriented Programming（AOP）是较为热门的一个话题。AOP，国内大致译作“面向切面编程”。</p>\n<p>“面向切面编程”,这样的名字并不是非常容易理解，且容易产生一些误导。有些人认为“OOP/OOD11即将落伍，AOP是新一代软件开发方式”。显然，发言者并没有理解AOP的含义。Aspect，的确是“方面”的意思。不过，汉语传统语义中的“方面”，大多数情况下指的是一件事情的不同维度、或者说不同角度上的特性，比如我们常说：“这件事情要从几个方面来看待”，往往意思是：需要从不同的角度来看待同一个事物。这里的“方面”，指的是事物的外在特性在不同观察角度下的体现。而在AOP中，Aspect的含义，可能更多的理解为“切面”比较合适。</p>\n<p>可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种技术。AOP实际是GoF设计模式的延续，设计模式孜孜不倦追求的是调用者和被调用者之间的解耦,提高代码的灵活性和可扩展性，AOP可以说也是这种目标的一种实现。</p>\n<p>在Spring中提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。</p>\n<p>主要功能</p>\n<p>日志记录，性能统计，安全控制，事务处理，异常处理等等。</p>\n<p>主要意图</p>\n<p>将日志记录，性能统计，安全控制，事务处理，异常处理等代码从业务逻辑代码中划分出来，通过对这些行为的分离，我们希望可以将它们独立到非指导业务逻辑的方法中，进而改变这些行为的时候不影响业务逻辑的代码。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"面向切面编程\"><a href=\"#面向切面编程\" class=\"headerlink\" title=\"面向切面编程\"></a>面向切面编程</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>在软件业，AOP为Aspect Oriented Programming的缩写，意为：面向切面编程，通过预编译方式和运行期间动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p>\n<h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>Aspect Oriented Programming（AOP）是较为热门的一个话题。AOP，国内大致译作“面向切面编程”。</p>\n<p>“面向切面编程”,这样的名字并不是非常容易理解，且容易产生一些误导。有些人认为“OOP/OOD11即将落伍，AOP是新一代软件开发方式”。显然，发言者并没有理解AOP的含义。Aspect，的确是“方面”的意思。不过，汉语传统语义中的“方面”，大多数情况下指的是一件事情的不同维度、或者说不同角度上的特性，比如我们常说：“这件事情要从几个方面来看待”，往往意思是：需要从不同的角度来看待同一个事物。这里的“方面”，指的是事物的外在特性在不同观察角度下的体现。而在AOP中，Aspect的含义，可能更多的理解为“切面”比较合适。</p>\n<p>可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种技术。AOP实际是GoF设计模式的延续，设计模式孜孜不倦追求的是调用者和被调用者之间的解耦,提高代码的灵活性和可扩展性，AOP可以说也是这种目标的一种实现。</p>\n<p>在Spring中提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。</p>\n<p>主要功能</p>\n<p>日志记录，性能统计，安全控制，事务处理，异常处理等等。</p>\n<p>主要意图</p>\n<p>将日志记录，性能统计，安全控制，事务处理，异常处理等代码从业务逻辑代码中划分出来，通过对这些行为的分离，我们希望可以将它们独立到非指导业务逻辑的方法中，进而改变这些行为的时候不影响业务逻辑的代码。</p>\n"},{"title":"Base64编码","_content":"\n# 作用\n\n可以将二进制的文件转换为文本格式进行传输。\n\n在http协议传输中，传输`bytes`类型的数据会有很多，因此我们可以在传输前对其进行`base64`编码，转化为`str`格式，便于传输。","source":"_posts/notebook/base64.md","raw":"---\ntitle: Base64编码\ncategories:\n- Notebook\ntags:\n- base64\n---\n\n# 作用\n\n可以将二进制的文件转换为文本格式进行传输。\n\n在http协议传输中，传输`bytes`类型的数据会有很多，因此我们可以在传输前对其进行`base64`编码，转化为`str`格式，便于传输。","slug":"notebook/base64","published":1,"date":"2021-07-05T08:02:40.360Z","updated":"2021-07-05T08:05:37.054Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zw006v018o1tm77xde","content":"<h1 id=\"作用\"><a href=\"#作用\" class=\"headerlink\" title=\"作用\"></a>作用</h1><p>可以将二进制的文件转换为文本格式进行传输。</p>\n<p>在http协议传输中，传输<code>bytes</code>类型的数据会有很多，因此我们可以在传输前对其进行<code>base64</code>编码，转化为<code>str</code>格式，便于传输。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"作用\"><a href=\"#作用\" class=\"headerlink\" title=\"作用\"></a>作用</h1><p>可以将二进制的文件转换为文本格式进行传输。</p>\n<p>在http协议传输中，传输<code>bytes</code>类型的数据会有很多，因此我们可以在传输前对其进行<code>base64</code>编码，转化为<code>str</code>格式，便于传输。</p>\n"},{"title":"Cheat Engine 入门","_content":"\n# 介绍\n\nCheat Engine通过修改内存的方式对应用程序进行修改。\n\n能够实现简单的逆向工程。\n\n## 查找内存地址并修改值\n\n1. 初始查找\n\n可以使用精确查找(exact)，比大小(bigger smaller)，间值(between)，未知(unknown)这几种方法。\n\n2. 进一步筛选\n\n可以使用精确，大于，小于，增减的具体值等等。\n\n通过不断筛选，可以得到我们需要的内存地址。\n\n3. 修改值\n\n对内存地址位置的值进行修改就可以了\n\n**注意**\n\n- 绿色的是基址，黑色的是动态地址。\n- win程序中的变量一般都是4个字节。\n\n## 代码替换\n\n首先找到内存地址。\n\n`find out what writes to this address`找到改写这个地址的代码。直接点击`replace`就会将该条汇编代码用`nop`覆盖掉。\n\n## 指针\n\n### 多级指针\n\n先查找是什么访问了这个地址(代码)，再查找是什么访问了这个地址(寄存器)。\n\n一步一步找到最开始的**基址**。手动添加一个地址，在基址的基础上按照指针的顺序，依次可以找到需要改变的地址。\n\n## 反汇编\n\n找到改写地址值的代码，显示反汇编程序。\n\n- 从模版导入CT表框架代码\n- 代码注入\n- 更改源码\n- 保存当前脚本\n\n## 共享代码\n\n一个对象的所有实例的表结构都是一样的。因此获取实例的内存位置，可以看到该实例的其他属性。比如敌人，队友等。通过这个判断，加入到注入代码中，就可以实现对队友和敌人分开操作。\n\n\n\n---\n\nReference\n\nhttps://cnblogs.com/LyShark\n\n\n\n\n\n\n\n","source":"_posts/notebook/ce-start.md","raw":"---\ntitle: Cheat Engine 入门\ncategories:\n- Notebook\ntags:\n- reverse\n- cheatengine\n---\n\n# 介绍\n\nCheat Engine通过修改内存的方式对应用程序进行修改。\n\n能够实现简单的逆向工程。\n\n## 查找内存地址并修改值\n\n1. 初始查找\n\n可以使用精确查找(exact)，比大小(bigger smaller)，间值(between)，未知(unknown)这几种方法。\n\n2. 进一步筛选\n\n可以使用精确，大于，小于，增减的具体值等等。\n\n通过不断筛选，可以得到我们需要的内存地址。\n\n3. 修改值\n\n对内存地址位置的值进行修改就可以了\n\n**注意**\n\n- 绿色的是基址，黑色的是动态地址。\n- win程序中的变量一般都是4个字节。\n\n## 代码替换\n\n首先找到内存地址。\n\n`find out what writes to this address`找到改写这个地址的代码。直接点击`replace`就会将该条汇编代码用`nop`覆盖掉。\n\n## 指针\n\n### 多级指针\n\n先查找是什么访问了这个地址(代码)，再查找是什么访问了这个地址(寄存器)。\n\n一步一步找到最开始的**基址**。手动添加一个地址，在基址的基础上按照指针的顺序，依次可以找到需要改变的地址。\n\n## 反汇编\n\n找到改写地址值的代码，显示反汇编程序。\n\n- 从模版导入CT表框架代码\n- 代码注入\n- 更改源码\n- 保存当前脚本\n\n## 共享代码\n\n一个对象的所有实例的表结构都是一样的。因此获取实例的内存位置，可以看到该实例的其他属性。比如敌人，队友等。通过这个判断，加入到注入代码中，就可以实现对队友和敌人分开操作。\n\n\n\n---\n\nReference\n\nhttps://cnblogs.com/LyShark\n\n\n\n\n\n\n\n","slug":"notebook/ce-start","published":1,"date":"2021-02-17T05:44:06.124Z","updated":"2021-02-17T07:23:13.892Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zx006y018o75sc0g5s","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Cheat Engine通过修改内存的方式对应用程序进行修改。</p>\n<p>能够实现简单的逆向工程。</p>\n<h2 id=\"查找内存地址并修改值\"><a href=\"#查找内存地址并修改值\" class=\"headerlink\" title=\"查找内存地址并修改值\"></a>查找内存地址并修改值</h2><ol>\n<li>初始查找</li>\n</ol>\n<p>可以使用精确查找(exact)，比大小(bigger smaller)，间值(between)，未知(unknown)这几种方法。</p>\n<ol start=\"2\">\n<li>进一步筛选</li>\n</ol>\n<p>可以使用精确，大于，小于，增减的具体值等等。</p>\n<p>通过不断筛选，可以得到我们需要的内存地址。</p>\n<ol start=\"3\">\n<li>修改值</li>\n</ol>\n<p>对内存地址位置的值进行修改就可以了</p>\n<p><strong>注意</strong></p>\n<ul>\n<li>绿色的是基址，黑色的是动态地址。</li>\n<li>win程序中的变量一般都是4个字节。</li>\n</ul>\n<h2 id=\"代码替换\"><a href=\"#代码替换\" class=\"headerlink\" title=\"代码替换\"></a>代码替换</h2><p>首先找到内存地址。</p>\n<p><code>find out what writes to this address</code>找到改写这个地址的代码。直接点击<code>replace</code>就会将该条汇编代码用<code>nop</code>覆盖掉。</p>\n<h2 id=\"指针\"><a href=\"#指针\" class=\"headerlink\" title=\"指针\"></a>指针</h2><h3 id=\"多级指针\"><a href=\"#多级指针\" class=\"headerlink\" title=\"多级指针\"></a>多级指针</h3><p>先查找是什么访问了这个地址(代码)，再查找是什么访问了这个地址(寄存器)。</p>\n<p>一步一步找到最开始的<strong>基址</strong>。手动添加一个地址，在基址的基础上按照指针的顺序，依次可以找到需要改变的地址。</p>\n<h2 id=\"反汇编\"><a href=\"#反汇编\" class=\"headerlink\" title=\"反汇编\"></a>反汇编</h2><p>找到改写地址值的代码，显示反汇编程序。</p>\n<ul>\n<li>从模版导入CT表框架代码</li>\n<li>代码注入</li>\n<li>更改源码</li>\n<li>保存当前脚本</li>\n</ul>\n<h2 id=\"共享代码\"><a href=\"#共享代码\" class=\"headerlink\" title=\"共享代码\"></a>共享代码</h2><p>一个对象的所有实例的表结构都是一样的。因此获取实例的内存位置，可以看到该实例的其他属性。比如敌人，队友等。通过这个判断，加入到注入代码中，就可以实现对队友和敌人分开操作。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbmJsb2dzLmNvbS9MeVNoYXJr\">https://cnblogs.com/LyShark<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>Cheat Engine通过修改内存的方式对应用程序进行修改。</p>\n<p>能够实现简单的逆向工程。</p>\n<h2 id=\"查找内存地址并修改值\"><a href=\"#查找内存地址并修改值\" class=\"headerlink\" title=\"查找内存地址并修改值\"></a>查找内存地址并修改值</h2><ol>\n<li>初始查找</li>\n</ol>\n<p>可以使用精确查找(exact)，比大小(bigger smaller)，间值(between)，未知(unknown)这几种方法。</p>\n<ol start=\"2\">\n<li>进一步筛选</li>\n</ol>\n<p>可以使用精确，大于，小于，增减的具体值等等。</p>\n<p>通过不断筛选，可以得到我们需要的内存地址。</p>\n<ol start=\"3\">\n<li>修改值</li>\n</ol>\n<p>对内存地址位置的值进行修改就可以了</p>\n<p><strong>注意</strong></p>\n<ul>\n<li>绿色的是基址，黑色的是动态地址。</li>\n<li>win程序中的变量一般都是4个字节。</li>\n</ul>\n<h2 id=\"代码替换\"><a href=\"#代码替换\" class=\"headerlink\" title=\"代码替换\"></a>代码替换</h2><p>首先找到内存地址。</p>\n<p><code>find out what writes to this address</code>找到改写这个地址的代码。直接点击<code>replace</code>就会将该条汇编代码用<code>nop</code>覆盖掉。</p>\n<h2 id=\"指针\"><a href=\"#指针\" class=\"headerlink\" title=\"指针\"></a>指针</h2><h3 id=\"多级指针\"><a href=\"#多级指针\" class=\"headerlink\" title=\"多级指针\"></a>多级指针</h3><p>先查找是什么访问了这个地址(代码)，再查找是什么访问了这个地址(寄存器)。</p>\n<p>一步一步找到最开始的<strong>基址</strong>。手动添加一个地址，在基址的基础上按照指针的顺序，依次可以找到需要改变的地址。</p>\n<h2 id=\"反汇编\"><a href=\"#反汇编\" class=\"headerlink\" title=\"反汇编\"></a>反汇编</h2><p>找到改写地址值的代码，显示反汇编程序。</p>\n<ul>\n<li>从模版导入CT表框架代码</li>\n<li>代码注入</li>\n<li>更改源码</li>\n<li>保存当前脚本</li>\n</ul>\n<h2 id=\"共享代码\"><a href=\"#共享代码\" class=\"headerlink\" title=\"共享代码\"></a>共享代码</h2><p>一个对象的所有实例的表结构都是一样的。因此获取实例的内存位置，可以看到该实例的其他属性。比如敌人，队友等。通过这个判断，加入到注入代码中，就可以实现对队友和敌人分开操作。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbmJsb2dzLmNvbS9MeVNoYXJr\">https://cnblogs.com/LyShark<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"craftbrew入门","catagories":["Notebook"],"_content":"\n# 工艺\n\n啤酒的酿造工艺不过两种\n\n- Ale(艾尔)：酵母在**麦芽汁上面**以**较高温度发酵**。\n- Lagers(拉各斯)：酵母在**麦芽汁下面**以**较低温度发酵**。\n\n精酿一般是指Ale工艺生产的啤酒。\n\n由于工艺的区别，自然Ale啤酒可以先闻到啤酒花，酵母等其他香气，然后是麦芽香气。lager则相反。\n\n# Ale\n\n## Pale Ale\n\n酒味淡，味苦，清新。\n\n## Indian Pale Ale\n\n当时英国为了长途运输，加入大量啤酒花，风味很足。\n\n## Trappist\n\n修道院，口感醇厚。\n\n## Stout\n\n采用烘烤过的啤酒花，泡沫细，有巧克力和咖啡的风味。\n\n# 精酿日记\n\n福佳白：味道很清爽，回味有一些蔬菜的气息。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/20768317\n\n","source":"_posts/notebook/craftbrew.md","raw":"---\ntitle: craftbrew入门\ncatagories:\n- Notebook\ntags:\n- craftbrew\n---\n\n# 工艺\n\n啤酒的酿造工艺不过两种\n\n- Ale(艾尔)：酵母在**麦芽汁上面**以**较高温度发酵**。\n- Lagers(拉各斯)：酵母在**麦芽汁下面**以**较低温度发酵**。\n\n精酿一般是指Ale工艺生产的啤酒。\n\n由于工艺的区别，自然Ale啤酒可以先闻到啤酒花，酵母等其他香气，然后是麦芽香气。lager则相反。\n\n# Ale\n\n## Pale Ale\n\n酒味淡，味苦，清新。\n\n## Indian Pale Ale\n\n当时英国为了长途运输，加入大量啤酒花，风味很足。\n\n## Trappist\n\n修道院，口感醇厚。\n\n## Stout\n\n采用烘烤过的啤酒花，泡沫细，有巧克力和咖啡的风味。\n\n# 精酿日记\n\n福佳白：味道很清爽，回味有一些蔬菜的气息。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/20768317\n\n","slug":"notebook/craftbrew","published":1,"date":"2021-03-01T07:53:20.404Z","updated":"2021-03-04T14:36:57.555Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zy0071018o7z8x87a8","content":"<h1 id=\"工艺\"><a href=\"#工艺\" class=\"headerlink\" title=\"工艺\"></a>工艺</h1><p>啤酒的酿造工艺不过两种</p>\n<ul>\n<li>Ale(艾尔)：酵母在<strong>麦芽汁上面</strong>以<strong>较高温度发酵</strong>。</li>\n<li>Lagers(拉各斯)：酵母在<strong>麦芽汁下面</strong>以<strong>较低温度发酵</strong>。</li>\n</ul>\n<p>精酿一般是指Ale工艺生产的啤酒。</p>\n<p>由于工艺的区别，自然Ale啤酒可以先闻到啤酒花，酵母等其他香气，然后是麦芽香气。lager则相反。</p>\n<h1 id=\"Ale\"><a href=\"#Ale\" class=\"headerlink\" title=\"Ale\"></a>Ale</h1><h2 id=\"Pale-Ale\"><a href=\"#Pale-Ale\" class=\"headerlink\" title=\"Pale Ale\"></a>Pale Ale</h2><p>酒味淡，味苦，清新。</p>\n<h2 id=\"Indian-Pale-Ale\"><a href=\"#Indian-Pale-Ale\" class=\"headerlink\" title=\"Indian Pale Ale\"></a>Indian Pale Ale</h2><p>当时英国为了长途运输，加入大量啤酒花，风味很足。</p>\n<h2 id=\"Trappist\"><a href=\"#Trappist\" class=\"headerlink\" title=\"Trappist\"></a>Trappist</h2><p>修道院，口感醇厚。</p>\n<h2 id=\"Stout\"><a href=\"#Stout\" class=\"headerlink\" title=\"Stout\"></a>Stout</h2><p>采用烘烤过的啤酒花，泡沫细，有巧克力和咖啡的风味。</p>\n<h1 id=\"精酿日记\"><a href=\"#精酿日记\" class=\"headerlink\" title=\"精酿日记\"></a>精酿日记</h1><p>福佳白：味道很清爽，回味有一些蔬菜的气息。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yMDc2ODMxNw==\">https://zhuanlan.zhihu.com/p/20768317<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"工艺\"><a href=\"#工艺\" class=\"headerlink\" title=\"工艺\"></a>工艺</h1><p>啤酒的酿造工艺不过两种</p>\n<ul>\n<li>Ale(艾尔)：酵母在<strong>麦芽汁上面</strong>以<strong>较高温度发酵</strong>。</li>\n<li>Lagers(拉各斯)：酵母在<strong>麦芽汁下面</strong>以<strong>较低温度发酵</strong>。</li>\n</ul>\n<p>精酿一般是指Ale工艺生产的啤酒。</p>\n<p>由于工艺的区别，自然Ale啤酒可以先闻到啤酒花，酵母等其他香气，然后是麦芽香气。lager则相反。</p>\n<h1 id=\"Ale\"><a href=\"#Ale\" class=\"headerlink\" title=\"Ale\"></a>Ale</h1><h2 id=\"Pale-Ale\"><a href=\"#Pale-Ale\" class=\"headerlink\" title=\"Pale Ale\"></a>Pale Ale</h2><p>酒味淡，味苦，清新。</p>\n<h2 id=\"Indian-Pale-Ale\"><a href=\"#Indian-Pale-Ale\" class=\"headerlink\" title=\"Indian Pale Ale\"></a>Indian Pale Ale</h2><p>当时英国为了长途运输，加入大量啤酒花，风味很足。</p>\n<h2 id=\"Trappist\"><a href=\"#Trappist\" class=\"headerlink\" title=\"Trappist\"></a>Trappist</h2><p>修道院，口感醇厚。</p>\n<h2 id=\"Stout\"><a href=\"#Stout\" class=\"headerlink\" title=\"Stout\"></a>Stout</h2><p>采用烘烤过的啤酒花，泡沫细，有巧克力和咖啡的风味。</p>\n<h1 id=\"精酿日记\"><a href=\"#精酿日记\" class=\"headerlink\" title=\"精酿日记\"></a>精酿日记</h1><p>福佳白：味道很清爽，回味有一些蔬菜的气息。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yMDc2ODMxNw==\">https://zhuanlan.zhihu.com/p/20768317<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 设计模式\n\n## Summary\n设计模式是面向对象设计中反复出现的问题的解决方案。这个术语在1990年代由Erich Gamma等人从建筑设计领域引入到计算机科学中来。*算法不是设计模式*因为算法致力于解决问题而非设计问题。设计模式通常提供一种讨论软件设计的公共语言，使得熟练设计者的设计经验可以被初学者和其他设计者掌握。＊设计模式还为软件重构提供了目标。\n\n## History\nErich Gamma与Richard Helm, Ralph Johnson ,John Vlissides合作出版了Design Patterns - Elements of Reusable Object-Oriented Software 一书，在此书中共收录了23个设计模式。这四位作者在软件开发领域里也以他们的匿名著称Gang of Four(四人帮，简称GoF),并且是他们在此书中的协作导致了软件设计模式的突破。\n\n## Pattern Format\n尽管名称和顺序在不同的资料中各有不同，描述模式的格式大致分为以下四个主要部分：  \n**模式名称（Pattern Name）**：每一个模式都有自己的名字，模式的名字使得我们可以讨论我们的设计。    \n**问题（Problem）**：在面向对象的系统设计过程中反复出现的特定场合，它导致我们采用某个模式。  \n**解决方案（Solution）**：上述问题的解决方案，其内容给出了设计的各个组成部分，它们之间的关系、职责划分和协作方式。  \n**效果（Consequence）**：采用该模式对软件系统其他部分的影响，比如对系统的扩充性、可移植性的影响。影响也包括负面的影响。  \n**别名（Also Known As）**：一个模式可以有超过一个以上的名称。这些名称应该要在这一节注明。  \n**动机（Motivation）**：该模式应该利用在哪种情况下是本节提供的方案（包括问题与来龙去脉）的责任。  \n**应用（Applicability）**  \n**结构（Structure）**：这部分常用类图与互动图阐述此模式。  \n**参与者（Participants）**：这部分提供一份本模式用到的类与物件清单，与它们在设计下扮演的角色。  \n**合作（Collaboration）**：描述在此模式下，类与物件间的互动。  \n**结果（Consequences）**：这部分应描述使用本模式後的结果、副作用、与交换(trade-off)  \n**实现（Implementaion）**：这部分应描述实现该模式、该模式的部分方案、实现该模式的可能技术、或者建议实现模式的方法。  \n**例程（Sample Code）**：示范程式。  \n**已知应用（Known Uses）**：业界已知的实做范例。  \n**相关模式（Related Patterns）**：这部分包括其他相关模式，以及与其他类似模式的不同。  \n\n## Mode\n**模式列表**\n\n- 基础模式\n- 委托模式\n- 接口模式\n- 代理模式\n\n**创建模式**\n\n- 抽象工厂模式(Abstract Factory) ,提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。\n- 生成器模式 (Builder)，将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。\n- 工厂方法模式(Factory Method) ，定义一个用于创建对象的接口，让子类决定将哪一个类实例化。Factory Method使一个类的实例化延迟到其子类。\n- 原型模式 (Prototype) ，用原型实例指定创建对象的种类，并且通过拷贝这个原型来创建新的对象。\n- 单例模式(Singleton)，保证一个类仅有一个实例，并提供一个访问它的全局访问点。  \n\n**结构模式**\n\n- 适配器模式 (Adapter) ，将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。\n- 桥接模式(Bridge) ，将抽象部分与它的实现部分分离，使它们都可以独立地变化。\n- 组合模式(Composite) ，将对象组合成树形结构以表示“部分-整体”的层次结构。它使得客户对单个对象和复合对象的使用具有一致性。\n- 容器模式\n- 修饰模式 (Decorator) ，动态地给一个对象添加一些额外的职责。就扩展功能而言， 它比生成子类方式更为灵活。\n- 扩展性模式\n- 外观模式\n- 享元模式\n- 管道与过滤器模式\n- 代理模式(Proxy) ，为其他对象提供一个代理以控制对这个对象的访问。\n\n**行为模式**\n\n- 责任链模式 (Chain of Responsibility) ，为解除请求的发送者和接收者之间耦合，而使多个对象都有机会处理这个请求。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它。\n- 命令模式 (Command) ，将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可取消的操作。\n- 柯里化模式\n- 事件监听器模式\n- 解释器模式\n- 迭代器模式\n- 中介者模式\n- 备忘录模式 (Memento) ，在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到保存的状态。\n- 观察者模式(Observer) ，定义对象间的一种一对多的依赖关系,以便当一个对象的状态发生改变时,所有依赖于它的对象都得到通知并自动刷新。\n- 状态模式 (State) ，允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它所属的类。\n- 策略模式 (Strategy) ，定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。本模式使得算法的变化可独立于使用它的客户。\n模板方法模式\n- 访问者模式 (Visitor)，表示一个作用于某对象结构中的各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。\n- 层次访问者模式\n\n**并发模式**\n\n- 模式 Action at a distance\n- 模式 Balking\n- 模式 Guarded suspension\n- 模式 Scheduler\n- 模式 Read write lock\n- 模式 Double checked locking\n- 模式 Disable job requests while running job\n\n**实时模式**\n\n- 模式 Scheduled task\n- 模式 User interface\n- 模式 Disable job requests while running job\n\n**其他**\n\n- 模型—视图—控制器模式","source":"_posts/notebook/design-pattern.md","raw":"# 设计模式\n\n## Summary\n设计模式是面向对象设计中反复出现的问题的解决方案。这个术语在1990年代由Erich Gamma等人从建筑设计领域引入到计算机科学中来。*算法不是设计模式*因为算法致力于解决问题而非设计问题。设计模式通常提供一种讨论软件设计的公共语言，使得熟练设计者的设计经验可以被初学者和其他设计者掌握。＊设计模式还为软件重构提供了目标。\n\n## History\nErich Gamma与Richard Helm, Ralph Johnson ,John Vlissides合作出版了Design Patterns - Elements of Reusable Object-Oriented Software 一书，在此书中共收录了23个设计模式。这四位作者在软件开发领域里也以他们的匿名著称Gang of Four(四人帮，简称GoF),并且是他们在此书中的协作导致了软件设计模式的突破。\n\n## Pattern Format\n尽管名称和顺序在不同的资料中各有不同，描述模式的格式大致分为以下四个主要部分：  \n**模式名称（Pattern Name）**：每一个模式都有自己的名字，模式的名字使得我们可以讨论我们的设计。    \n**问题（Problem）**：在面向对象的系统设计过程中反复出现的特定场合，它导致我们采用某个模式。  \n**解决方案（Solution）**：上述问题的解决方案，其内容给出了设计的各个组成部分，它们之间的关系、职责划分和协作方式。  \n**效果（Consequence）**：采用该模式对软件系统其他部分的影响，比如对系统的扩充性、可移植性的影响。影响也包括负面的影响。  \n**别名（Also Known As）**：一个模式可以有超过一个以上的名称。这些名称应该要在这一节注明。  \n**动机（Motivation）**：该模式应该利用在哪种情况下是本节提供的方案（包括问题与来龙去脉）的责任。  \n**应用（Applicability）**  \n**结构（Structure）**：这部分常用类图与互动图阐述此模式。  \n**参与者（Participants）**：这部分提供一份本模式用到的类与物件清单，与它们在设计下扮演的角色。  \n**合作（Collaboration）**：描述在此模式下，类与物件间的互动。  \n**结果（Consequences）**：这部分应描述使用本模式後的结果、副作用、与交换(trade-off)  \n**实现（Implementaion）**：这部分应描述实现该模式、该模式的部分方案、实现该模式的可能技术、或者建议实现模式的方法。  \n**例程（Sample Code）**：示范程式。  \n**已知应用（Known Uses）**：业界已知的实做范例。  \n**相关模式（Related Patterns）**：这部分包括其他相关模式，以及与其他类似模式的不同。  \n\n## Mode\n**模式列表**\n\n- 基础模式\n- 委托模式\n- 接口模式\n- 代理模式\n\n**创建模式**\n\n- 抽象工厂模式(Abstract Factory) ,提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。\n- 生成器模式 (Builder)，将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。\n- 工厂方法模式(Factory Method) ，定义一个用于创建对象的接口，让子类决定将哪一个类实例化。Factory Method使一个类的实例化延迟到其子类。\n- 原型模式 (Prototype) ，用原型实例指定创建对象的种类，并且通过拷贝这个原型来创建新的对象。\n- 单例模式(Singleton)，保证一个类仅有一个实例，并提供一个访问它的全局访问点。  \n\n**结构模式**\n\n- 适配器模式 (Adapter) ，将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。\n- 桥接模式(Bridge) ，将抽象部分与它的实现部分分离，使它们都可以独立地变化。\n- 组合模式(Composite) ，将对象组合成树形结构以表示“部分-整体”的层次结构。它使得客户对单个对象和复合对象的使用具有一致性。\n- 容器模式\n- 修饰模式 (Decorator) ，动态地给一个对象添加一些额外的职责。就扩展功能而言， 它比生成子类方式更为灵活。\n- 扩展性模式\n- 外观模式\n- 享元模式\n- 管道与过滤器模式\n- 代理模式(Proxy) ，为其他对象提供一个代理以控制对这个对象的访问。\n\n**行为模式**\n\n- 责任链模式 (Chain of Responsibility) ，为解除请求的发送者和接收者之间耦合，而使多个对象都有机会处理这个请求。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它。\n- 命令模式 (Command) ，将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可取消的操作。\n- 柯里化模式\n- 事件监听器模式\n- 解释器模式\n- 迭代器模式\n- 中介者模式\n- 备忘录模式 (Memento) ，在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到保存的状态。\n- 观察者模式(Observer) ，定义对象间的一种一对多的依赖关系,以便当一个对象的状态发生改变时,所有依赖于它的对象都得到通知并自动刷新。\n- 状态模式 (State) ，允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它所属的类。\n- 策略模式 (Strategy) ，定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。本模式使得算法的变化可独立于使用它的客户。\n模板方法模式\n- 访问者模式 (Visitor)，表示一个作用于某对象结构中的各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。\n- 层次访问者模式\n\n**并发模式**\n\n- 模式 Action at a distance\n- 模式 Balking\n- 模式 Guarded suspension\n- 模式 Scheduler\n- 模式 Read write lock\n- 模式 Double checked locking\n- 模式 Disable job requests while running job\n\n**实时模式**\n\n- 模式 Scheduled task\n- 模式 User interface\n- 模式 Disable job requests while running job\n\n**其他**\n\n- 模型—视图—控制器模式","slug":"notebook/design-pattern","published":1,"date":"2020-03-03T14:18:59.402Z","updated":"2020-03-03T15:07:10.288Z","title":"notebook/design-pattern","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zy0073018obohm5o84","content":"<h1 id=\"设计模式\"><a href=\"#设计模式\" class=\"headerlink\" title=\"设计模式\"></a>设计模式</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>设计模式是面向对象设计中反复出现的问题的解决方案。这个术语在1990年代由Erich Gamma等人从建筑设计领域引入到计算机科学中来。<em>算法不是设计模式</em>因为算法致力于解决问题而非设计问题。设计模式通常提供一种讨论软件设计的公共语言，使得熟练设计者的设计经验可以被初学者和其他设计者掌握。＊设计模式还为软件重构提供了目标。</p>\n<h2 id=\"History\"><a href=\"#History\" class=\"headerlink\" title=\"History\"></a>History</h2><p>Erich Gamma与Richard Helm, Ralph Johnson ,John Vlissides合作出版了Design Patterns - Elements of Reusable Object-Oriented Software 一书，在此书中共收录了23个设计模式。这四位作者在软件开发领域里也以他们的匿名著称Gang of Four(四人帮，简称GoF),并且是他们在此书中的协作导致了软件设计模式的突破。</p>\n<h2 id=\"Pattern-Format\"><a href=\"#Pattern-Format\" class=\"headerlink\" title=\"Pattern Format\"></a>Pattern Format</h2><p>尽管名称和顺序在不同的资料中各有不同，描述模式的格式大致分为以下四个主要部分：<br><strong>模式名称（Pattern Name）</strong>：每一个模式都有自己的名字，模式的名字使得我们可以讨论我们的设计。<br><strong>问题（Problem）</strong>：在面向对象的系统设计过程中反复出现的特定场合，它导致我们采用某个模式。<br><strong>解决方案（Solution）</strong>：上述问题的解决方案，其内容给出了设计的各个组成部分，它们之间的关系、职责划分和协作方式。<br><strong>效果（Consequence）</strong>：采用该模式对软件系统其他部分的影响，比如对系统的扩充性、可移植性的影响。影响也包括负面的影响。<br><strong>别名（Also Known As）</strong>：一个模式可以有超过一个以上的名称。这些名称应该要在这一节注明。<br><strong>动机（Motivation）</strong>：该模式应该利用在哪种情况下是本节提供的方案（包括问题与来龙去脉）的责任。<br><strong>应用（Applicability）</strong><br><strong>结构（Structure）</strong>：这部分常用类图与互动图阐述此模式。<br><strong>参与者（Participants）</strong>：这部分提供一份本模式用到的类与物件清单，与它们在设计下扮演的角色。<br><strong>合作（Collaboration）</strong>：描述在此模式下，类与物件间的互动。<br><strong>结果（Consequences）</strong>：这部分应描述使用本模式後的结果、副作用、与交换(trade-off)<br><strong>实现（Implementaion）</strong>：这部分应描述实现该模式、该模式的部分方案、实现该模式的可能技术、或者建议实现模式的方法。<br><strong>例程（Sample Code）</strong>：示范程式。<br><strong>已知应用（Known Uses）</strong>：业界已知的实做范例。<br><strong>相关模式（Related Patterns）</strong>：这部分包括其他相关模式，以及与其他类似模式的不同。  </p>\n<h2 id=\"Mode\"><a href=\"#Mode\" class=\"headerlink\" title=\"Mode\"></a>Mode</h2><p><strong>模式列表</strong></p>\n<ul>\n<li>基础模式</li>\n<li>委托模式</li>\n<li>接口模式</li>\n<li>代理模式</li>\n</ul>\n<p><strong>创建模式</strong></p>\n<ul>\n<li>抽象工厂模式(Abstract Factory) ,提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</li>\n<li>生成器模式 (Builder)，将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</li>\n<li>工厂方法模式(Factory Method) ，定义一个用于创建对象的接口，让子类决定将哪一个类实例化。Factory Method使一个类的实例化延迟到其子类。</li>\n<li>原型模式 (Prototype) ，用原型实例指定创建对象的种类，并且通过拷贝这个原型来创建新的对象。</li>\n<li>单例模式(Singleton)，保证一个类仅有一个实例，并提供一个访问它的全局访问点。  </li>\n</ul>\n<p><strong>结构模式</strong></p>\n<ul>\n<li>适配器模式 (Adapter) ，将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</li>\n<li>桥接模式(Bridge) ，将抽象部分与它的实现部分分离，使它们都可以独立地变化。</li>\n<li>组合模式(Composite) ，将对象组合成树形结构以表示“部分-整体”的层次结构。它使得客户对单个对象和复合对象的使用具有一致性。</li>\n<li>容器模式</li>\n<li>修饰模式 (Decorator) ，动态地给一个对象添加一些额外的职责。就扩展功能而言， 它比生成子类方式更为灵活。</li>\n<li>扩展性模式</li>\n<li>外观模式</li>\n<li>享元模式</li>\n<li>管道与过滤器模式</li>\n<li>代理模式(Proxy) ，为其他对象提供一个代理以控制对这个对象的访问。</li>\n</ul>\n<p><strong>行为模式</strong></p>\n<ul>\n<li>责任链模式 (Chain of Responsibility) ，为解除请求的发送者和接收者之间耦合，而使多个对象都有机会处理这个请求。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它。</li>\n<li>命令模式 (Command) ，将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可取消的操作。</li>\n<li>柯里化模式</li>\n<li>事件监听器模式</li>\n<li>解释器模式</li>\n<li>迭代器模式</li>\n<li>中介者模式</li>\n<li>备忘录模式 (Memento) ，在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到保存的状态。</li>\n<li>观察者模式(Observer) ，定义对象间的一种一对多的依赖关系,以便当一个对象的状态发生改变时,所有依赖于它的对象都得到通知并自动刷新。</li>\n<li>状态模式 (State) ，允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它所属的类。</li>\n<li>策略模式 (Strategy) ，定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。本模式使得算法的变化可独立于使用它的客户。<br>模板方法模式</li>\n<li>访问者模式 (Visitor)，表示一个作用于某对象结构中的各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</li>\n<li>层次访问者模式</li>\n</ul>\n<p><strong>并发模式</strong></p>\n<ul>\n<li>模式 Action at a distance</li>\n<li>模式 Balking</li>\n<li>模式 Guarded suspension</li>\n<li>模式 Scheduler</li>\n<li>模式 Read write lock</li>\n<li>模式 Double checked locking</li>\n<li>模式 Disable job requests while running job</li>\n</ul>\n<p><strong>实时模式</strong></p>\n<ul>\n<li>模式 Scheduled task</li>\n<li>模式 User interface</li>\n<li>模式 Disable job requests while running job</li>\n</ul>\n<p><strong>其他</strong></p>\n<ul>\n<li>模型—视图—控制器模式</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"设计模式\"><a href=\"#设计模式\" class=\"headerlink\" title=\"设计模式\"></a>设计模式</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>设计模式是面向对象设计中反复出现的问题的解决方案。这个术语在1990年代由Erich Gamma等人从建筑设计领域引入到计算机科学中来。<em>算法不是设计模式</em>因为算法致力于解决问题而非设计问题。设计模式通常提供一种讨论软件设计的公共语言，使得熟练设计者的设计经验可以被初学者和其他设计者掌握。＊设计模式还为软件重构提供了目标。</p>\n<h2 id=\"History\"><a href=\"#History\" class=\"headerlink\" title=\"History\"></a>History</h2><p>Erich Gamma与Richard Helm, Ralph Johnson ,John Vlissides合作出版了Design Patterns - Elements of Reusable Object-Oriented Software 一书，在此书中共收录了23个设计模式。这四位作者在软件开发领域里也以他们的匿名著称Gang of Four(四人帮，简称GoF),并且是他们在此书中的协作导致了软件设计模式的突破。</p>\n<h2 id=\"Pattern-Format\"><a href=\"#Pattern-Format\" class=\"headerlink\" title=\"Pattern Format\"></a>Pattern Format</h2><p>尽管名称和顺序在不同的资料中各有不同，描述模式的格式大致分为以下四个主要部分：<br><strong>模式名称（Pattern Name）</strong>：每一个模式都有自己的名字，模式的名字使得我们可以讨论我们的设计。<br><strong>问题（Problem）</strong>：在面向对象的系统设计过程中反复出现的特定场合，它导致我们采用某个模式。<br><strong>解决方案（Solution）</strong>：上述问题的解决方案，其内容给出了设计的各个组成部分，它们之间的关系、职责划分和协作方式。<br><strong>效果（Consequence）</strong>：采用该模式对软件系统其他部分的影响，比如对系统的扩充性、可移植性的影响。影响也包括负面的影响。<br><strong>别名（Also Known As）</strong>：一个模式可以有超过一个以上的名称。这些名称应该要在这一节注明。<br><strong>动机（Motivation）</strong>：该模式应该利用在哪种情况下是本节提供的方案（包括问题与来龙去脉）的责任。<br><strong>应用（Applicability）</strong><br><strong>结构（Structure）</strong>：这部分常用类图与互动图阐述此模式。<br><strong>参与者（Participants）</strong>：这部分提供一份本模式用到的类与物件清单，与它们在设计下扮演的角色。<br><strong>合作（Collaboration）</strong>：描述在此模式下，类与物件间的互动。<br><strong>结果（Consequences）</strong>：这部分应描述使用本模式後的结果、副作用、与交换(trade-off)<br><strong>实现（Implementaion）</strong>：这部分应描述实现该模式、该模式的部分方案、实现该模式的可能技术、或者建议实现模式的方法。<br><strong>例程（Sample Code）</strong>：示范程式。<br><strong>已知应用（Known Uses）</strong>：业界已知的实做范例。<br><strong>相关模式（Related Patterns）</strong>：这部分包括其他相关模式，以及与其他类似模式的不同。  </p>\n<h2 id=\"Mode\"><a href=\"#Mode\" class=\"headerlink\" title=\"Mode\"></a>Mode</h2><p><strong>模式列表</strong></p>\n<ul>\n<li>基础模式</li>\n<li>委托模式</li>\n<li>接口模式</li>\n<li>代理模式</li>\n</ul>\n<p><strong>创建模式</strong></p>\n<ul>\n<li>抽象工厂模式(Abstract Factory) ,提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</li>\n<li>生成器模式 (Builder)，将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</li>\n<li>工厂方法模式(Factory Method) ，定义一个用于创建对象的接口，让子类决定将哪一个类实例化。Factory Method使一个类的实例化延迟到其子类。</li>\n<li>原型模式 (Prototype) ，用原型实例指定创建对象的种类，并且通过拷贝这个原型来创建新的对象。</li>\n<li>单例模式(Singleton)，保证一个类仅有一个实例，并提供一个访问它的全局访问点。  </li>\n</ul>\n<p><strong>结构模式</strong></p>\n<ul>\n<li>适配器模式 (Adapter) ，将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</li>\n<li>桥接模式(Bridge) ，将抽象部分与它的实现部分分离，使它们都可以独立地变化。</li>\n<li>组合模式(Composite) ，将对象组合成树形结构以表示“部分-整体”的层次结构。它使得客户对单个对象和复合对象的使用具有一致性。</li>\n<li>容器模式</li>\n<li>修饰模式 (Decorator) ，动态地给一个对象添加一些额外的职责。就扩展功能而言， 它比生成子类方式更为灵活。</li>\n<li>扩展性模式</li>\n<li>外观模式</li>\n<li>享元模式</li>\n<li>管道与过滤器模式</li>\n<li>代理模式(Proxy) ，为其他对象提供一个代理以控制对这个对象的访问。</li>\n</ul>\n<p><strong>行为模式</strong></p>\n<ul>\n<li>责任链模式 (Chain of Responsibility) ，为解除请求的发送者和接收者之间耦合，而使多个对象都有机会处理这个请求。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它。</li>\n<li>命令模式 (Command) ，将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可取消的操作。</li>\n<li>柯里化模式</li>\n<li>事件监听器模式</li>\n<li>解释器模式</li>\n<li>迭代器模式</li>\n<li>中介者模式</li>\n<li>备忘录模式 (Memento) ，在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到保存的状态。</li>\n<li>观察者模式(Observer) ，定义对象间的一种一对多的依赖关系,以便当一个对象的状态发生改变时,所有依赖于它的对象都得到通知并自动刷新。</li>\n<li>状态模式 (State) ，允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它所属的类。</li>\n<li>策略模式 (Strategy) ，定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。本模式使得算法的变化可独立于使用它的客户。<br>模板方法模式</li>\n<li>访问者模式 (Visitor)，表示一个作用于某对象结构中的各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</li>\n<li>层次访问者模式</li>\n</ul>\n<p><strong>并发模式</strong></p>\n<ul>\n<li>模式 Action at a distance</li>\n<li>模式 Balking</li>\n<li>模式 Guarded suspension</li>\n<li>模式 Scheduler</li>\n<li>模式 Read write lock</li>\n<li>模式 Double checked locking</li>\n<li>模式 Disable job requests while running job</li>\n</ul>\n<p><strong>实时模式</strong></p>\n<ul>\n<li>模式 Scheduled task</li>\n<li>模式 User interface</li>\n<li>模式 Disable job requests while running job</li>\n</ul>\n<p><strong>其他</strong></p>\n<ul>\n<li>模型—视图—控制器模式</li>\n</ul>\n"},{"title":"Druid连接池加密","catagories":["Notebook"],"_content":"\n# 数据库连接加密\n\n项目有需求连接数据库的信息需要加密。\n\n刚好Druid可以通过拦截器使用秘文和公钥将密码还原成真实的密码。\n\n# 坑\n\n## 问题\n\ndurid过滤器一直没起作用\n\n## 解决方案\n\n由于项目配置文件里有区分主从数据库，因此在对主数据库的加密解密要写在`spring.datasource.druid.master`配置下。不能配置在`spring.datasource.druid`下。\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/vipstone/p/14467140.html","source":"_posts/notebook/druid-pwd.md","raw":"---\ntitle: Druid连接池加密\ncatagories:\n- Notebook\ntags:\n- java\n- springboot\n---\n\n# 数据库连接加密\n\n项目有需求连接数据库的信息需要加密。\n\n刚好Druid可以通过拦截器使用秘文和公钥将密码还原成真实的密码。\n\n# 坑\n\n## 问题\n\ndurid过滤器一直没起作用\n\n## 解决方案\n\n由于项目配置文件里有区分主从数据库，因此在对主数据库的加密解密要写在`spring.datasource.druid.master`配置下。不能配置在`spring.datasource.druid`下。\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/vipstone/p/14467140.html","slug":"notebook/druid-pwd","published":1,"date":"2021-03-08T14:03:38.053Z","updated":"2021-03-08T14:10:42.723Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx97zz0077018ohbspebpt","content":"<h1 id=\"数据库连接加密\"><a href=\"#数据库连接加密\" class=\"headerlink\" title=\"数据库连接加密\"></a>数据库连接加密</h1><p>项目有需求连接数据库的信息需要加密。</p>\n<p>刚好Druid可以通过拦截器使用秘文和公钥将密码还原成真实的密码。</p>\n<h1 id=\"坑\"><a href=\"#坑\" class=\"headerlink\" title=\"坑\"></a>坑</h1><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>durid过滤器一直没起作用</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>由于项目配置文件里有区分主从数据库，因此在对主数据库的加密解密要写在<code>spring.datasource.druid.master</code>配置下。不能配置在<code>spring.datasource.druid</code>下。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdmlwc3RvbmUvcC8xNDQ2NzE0MC5odG1s\">https://www.cnblogs.com/vipstone/p/14467140.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"数据库连接加密\"><a href=\"#数据库连接加密\" class=\"headerlink\" title=\"数据库连接加密\"></a>数据库连接加密</h1><p>项目有需求连接数据库的信息需要加密。</p>\n<p>刚好Druid可以通过拦截器使用秘文和公钥将密码还原成真实的密码。</p>\n<h1 id=\"坑\"><a href=\"#坑\" class=\"headerlink\" title=\"坑\"></a>坑</h1><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>durid过滤器一直没起作用</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>由于项目配置文件里有区分主从数据库，因此在对主数据库的加密解密要写在<code>spring.datasource.druid.master</code>配置下。不能配置在<code>spring.datasource.druid</code>下。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdmlwc3RvbmUvcC8xNDQ2NzE0MC5odG1s\">https://www.cnblogs.com/vipstone/p/14467140.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"coffee入门","catagories":["Notebook"],"_content":"\n# 冲泡\n\n我觉得咖啡冲泡最本质的不过在于将咖啡粉中可溶于水的部分萃取出来。\n\n# 影响因素\n\n其实就是从源头到最终的产物，每个环节都会对最终的成品产生影响。\n\n- 咖啡豆的产地（光照）\n- 咖啡豆的烘焙（产地，深度）\n- 咖啡豆的研磨（粗细）\n- 咖啡粉的萃取（时间，水压，温度）\n\n# Espresso\n\n咖啡最精华的部分也就是Espresso了，其他的衍生物也就是对Espresso的各种创意加工方式。\n\n## 萃取细节\n\n- 粉重\n- 液重\n- 时间\n- 温度\n\n## 评价指标\n\n### 维度\n\n- creama（油脂）\n- body（质地）\n- 酸甜苦\n- 风味\n\n### 金杯标准\n\n- 萃取率（18～22%） 溶解在咖啡里的咖啡物质的质量/参与萃取的咖啡粉质量\n- 浓度（1.15～1.35%） 溶解在咖啡里的咖啡物质的质量/参与萃取的水的体积\n\n# 创意饮品\n\n美式 = espresso + 水\n\n拿铁 = espresso + 牛奶 + 奶泡\n\n摩卡 = espresso + 巧克力糖浆 + 牛奶 + 鲜奶泡\n\n卡布奇诺 = espresso + 牛奶 + 奶泡\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/141259325\n\nhttps://www.bilibili.com/video/BV1Zt4y1y7Vx?t=519\n\n","source":"_posts/notebook/coffee.md","raw":"---\ntitle: coffee入门\ncatagories:\n- Notebook\ntags:\n- coffee\n---\n\n# 冲泡\n\n我觉得咖啡冲泡最本质的不过在于将咖啡粉中可溶于水的部分萃取出来。\n\n# 影响因素\n\n其实就是从源头到最终的产物，每个环节都会对最终的成品产生影响。\n\n- 咖啡豆的产地（光照）\n- 咖啡豆的烘焙（产地，深度）\n- 咖啡豆的研磨（粗细）\n- 咖啡粉的萃取（时间，水压，温度）\n\n# Espresso\n\n咖啡最精华的部分也就是Espresso了，其他的衍生物也就是对Espresso的各种创意加工方式。\n\n## 萃取细节\n\n- 粉重\n- 液重\n- 时间\n- 温度\n\n## 评价指标\n\n### 维度\n\n- creama（油脂）\n- body（质地）\n- 酸甜苦\n- 风味\n\n### 金杯标准\n\n- 萃取率（18～22%） 溶解在咖啡里的咖啡物质的质量/参与萃取的咖啡粉质量\n- 浓度（1.15～1.35%） 溶解在咖啡里的咖啡物质的质量/参与萃取的水的体积\n\n# 创意饮品\n\n美式 = espresso + 水\n\n拿铁 = espresso + 牛奶 + 奶泡\n\n摩卡 = espresso + 巧克力糖浆 + 牛奶 + 鲜奶泡\n\n卡布奇诺 = espresso + 牛奶 + 奶泡\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/141259325\n\nhttps://www.bilibili.com/video/BV1Zt4y1y7Vx?t=519\n\n","slug":"notebook/coffee","published":1,"date":"2021-03-01T06:58:18.143Z","updated":"2021-03-01T07:57:44.045Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9800007a018o0wed7l0i","content":"<h1 id=\"冲泡\"><a href=\"#冲泡\" class=\"headerlink\" title=\"冲泡\"></a>冲泡</h1><p>我觉得咖啡冲泡最本质的不过在于将咖啡粉中可溶于水的部分萃取出来。</p>\n<h1 id=\"影响因素\"><a href=\"#影响因素\" class=\"headerlink\" title=\"影响因素\"></a>影响因素</h1><p>其实就是从源头到最终的产物，每个环节都会对最终的成品产生影响。</p>\n<ul>\n<li>咖啡豆的产地（光照）</li>\n<li>咖啡豆的烘焙（产地，深度）</li>\n<li>咖啡豆的研磨（粗细）</li>\n<li>咖啡粉的萃取（时间，水压，温度）</li>\n</ul>\n<h1 id=\"Espresso\"><a href=\"#Espresso\" class=\"headerlink\" title=\"Espresso\"></a>Espresso</h1><p>咖啡最精华的部分也就是Espresso了，其他的衍生物也就是对Espresso的各种创意加工方式。</p>\n<h2 id=\"萃取细节\"><a href=\"#萃取细节\" class=\"headerlink\" title=\"萃取细节\"></a>萃取细节</h2><ul>\n<li>粉重</li>\n<li>液重</li>\n<li>时间</li>\n<li>温度</li>\n</ul>\n<h2 id=\"评价指标\"><a href=\"#评价指标\" class=\"headerlink\" title=\"评价指标\"></a>评价指标</h2><h3 id=\"维度\"><a href=\"#维度\" class=\"headerlink\" title=\"维度\"></a>维度</h3><ul>\n<li>creama（油脂）</li>\n<li>body（质地）</li>\n<li>酸甜苦</li>\n<li>风味</li>\n</ul>\n<h3 id=\"金杯标准\"><a href=\"#金杯标准\" class=\"headerlink\" title=\"金杯标准\"></a>金杯标准</h3><ul>\n<li>萃取率（18～22%） 溶解在咖啡里的咖啡物质的质量/参与萃取的咖啡粉质量</li>\n<li>浓度（1.15～1.35%） 溶解在咖啡里的咖啡物质的质量/参与萃取的水的体积</li>\n</ul>\n<h1 id=\"创意饮品\"><a href=\"#创意饮品\" class=\"headerlink\" title=\"创意饮品\"></a>创意饮品</h1><p>美式 = espresso + 水</p>\n<p>拿铁 = espresso + 牛奶 + 奶泡</p>\n<p>摩卡 = espresso + 巧克力糖浆 + 牛奶 + 鲜奶泡</p>\n<p>卡布奇诺 = espresso + 牛奶 + 奶泡</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDEyNTkzMjU=\">https://zhuanlan.zhihu.com/p/141259325<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVp0NHkxeTdWeD90PTUxOQ==\">https://www.bilibili.com/video/BV1Zt4y1y7Vx?t=519<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"冲泡\"><a href=\"#冲泡\" class=\"headerlink\" title=\"冲泡\"></a>冲泡</h1><p>我觉得咖啡冲泡最本质的不过在于将咖啡粉中可溶于水的部分萃取出来。</p>\n<h1 id=\"影响因素\"><a href=\"#影响因素\" class=\"headerlink\" title=\"影响因素\"></a>影响因素</h1><p>其实就是从源头到最终的产物，每个环节都会对最终的成品产生影响。</p>\n<ul>\n<li>咖啡豆的产地（光照）</li>\n<li>咖啡豆的烘焙（产地，深度）</li>\n<li>咖啡豆的研磨（粗细）</li>\n<li>咖啡粉的萃取（时间，水压，温度）</li>\n</ul>\n<h1 id=\"Espresso\"><a href=\"#Espresso\" class=\"headerlink\" title=\"Espresso\"></a>Espresso</h1><p>咖啡最精华的部分也就是Espresso了，其他的衍生物也就是对Espresso的各种创意加工方式。</p>\n<h2 id=\"萃取细节\"><a href=\"#萃取细节\" class=\"headerlink\" title=\"萃取细节\"></a>萃取细节</h2><ul>\n<li>粉重</li>\n<li>液重</li>\n<li>时间</li>\n<li>温度</li>\n</ul>\n<h2 id=\"评价指标\"><a href=\"#评价指标\" class=\"headerlink\" title=\"评价指标\"></a>评价指标</h2><h3 id=\"维度\"><a href=\"#维度\" class=\"headerlink\" title=\"维度\"></a>维度</h3><ul>\n<li>creama（油脂）</li>\n<li>body（质地）</li>\n<li>酸甜苦</li>\n<li>风味</li>\n</ul>\n<h3 id=\"金杯标准\"><a href=\"#金杯标准\" class=\"headerlink\" title=\"金杯标准\"></a>金杯标准</h3><ul>\n<li>萃取率（18～22%） 溶解在咖啡里的咖啡物质的质量/参与萃取的咖啡粉质量</li>\n<li>浓度（1.15～1.35%） 溶解在咖啡里的咖啡物质的质量/参与萃取的水的体积</li>\n</ul>\n<h1 id=\"创意饮品\"><a href=\"#创意饮品\" class=\"headerlink\" title=\"创意饮品\"></a>创意饮品</h1><p>美式 = espresso + 水</p>\n<p>拿铁 = espresso + 牛奶 + 奶泡</p>\n<p>摩卡 = espresso + 巧克力糖浆 + 牛奶 + 鲜奶泡</p>\n<p>卡布奇诺 = espresso + 牛奶 + 奶泡</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDEyNTkzMjU=\">https://zhuanlan.zhihu.com/p/141259325<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVp0NHkxeTdWeD90PTUxOQ==\">https://www.bilibili.com/video/BV1Zt4y1y7Vx?t=519<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"Cookie, Session, Token, JWT\n\n# Authentication(认证)\n认证当前的用户的身份\n\n互联网中的认证\n  - 用户名密码登陆\n  - 邮箱发送登陆链接\n  - 手机号接受验证码\n\n# Authorization(授权)\n用户权限\n\n实现授权的方式\n  - Cookie\n  - Session\n  - Token\n  - OAuth\n\n# Credentials(凭证)\n**实现认证和授权的前提是需要一种媒介（证书）来标记访问者的身份。**\n\n在互联网应用中，一般网站（如掘金）会有两种模式，游客模式和登录模式。游客模式下，可以正常浏览网站上面的文章，一旦想要点赞/收藏/分享文章，就需要登录或者注册账号。当用户登录成功后，服务器会给该用户使用的浏览器颁发一个令牌（token），这个令牌用来表明你的身份，每次浏览器发送请求时会带上这个令牌，就可以使用游客模式下无法使用的功能。\n\n# Cookie\n- HTTP 是无状态的协议（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不会保存任何会话信息）：每个请求都是完全独立的，服务端无法确认当前访问者的身份信息，无法分辨上一次的请求发送者和这一次的发送者是不是同一个人。所以服务器与浏览器为了进行会话跟踪（知道是谁在访问我），就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求是否来自同一浏览器。而这个状态需要通过 cookie 或者 session 去实现。\n- cookie 存储在客户端： cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。\n- cookie 是不可跨域的： 每个 cookie 都会绑定单一的域名，无法在别的域名下获取使用，一级域名和二级域名之间是允许共享使用的（靠的是 domain）。\n\n# Session\n- Session是另一种记录服务器和客户端会话状态的机制。\n- Session是基于Cookie实现的，Session存储在服务器端，SessionId会被存储到客户端的Cookie中。\n- Session认证流程\n  - 用户第一次请求服务器的时候，服务器根据用户提交的相关信息，创建对应的Session。\n  - 请求返回时将此Session对应的唯一标识信息SessionId返回给浏览器。\n  - 浏览器接受到服务器返回的SessionId信息后，会将此信息存入到Cookie中，同时Cookie记录此SessionId属于哪个域名。\n  - 当用户第二次访问服务器的时候，请求会自动判断此域名下是否存在Cookie信息，如果存在自动将Cookie信息信息也发送到服务端，服务端会从Cookie中获取SessionId，再根据SessionId查找到对应的Session信息，如果没有找到说明用户没有登陆或登陆失效，如果找到Session证明用户已经登陆可执行后面操作。\n\n根据以上流程可知，SessionID 是连接 Cookie 和 Session 的一道桥梁，大部分系统也是根据此原理来验证用户登录状态。\n\n# Cookie和Session的区别\n- **安全性：**Session比Cookie安全，Session是存储在服务端的，Cookie是存储在客户端的。\n- **存取值的类型不同：**Cookie只支持存字符串数据，想要设置其他类型的数据，需要将其转换成字符串，Session可以存任意数据类型。\n- **有效期不同：**Cookie可设置为长时间按保持，比如我们经常使用的默认登陆功能，Session一半失效时间较短，客户端关闭或Session超时都会失效。\n- **存储大小不同：**单个Cookie保存的数据不能超过4K，Session可存储数据远高于Cookie，但是当访问量过多，会占用过多的服务器资源。\n\n# Token(令牌)\n## Access Token\n- 访问资源接口（API）时所需要的资源凭证\n- 简单Token的组成：uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign（签名，token 的前几位以哈希算法压缩成的一定长度的十六进制字符串）\n- 特点\n  - 服务端无状态化、可扩展性好。\n  - 支持移动端设备\n  - 安全\n  - 支持跨程序调用\n- Token的身份验证流程  \n![accessToken](../static/img/accesstoken.png)\n  1. 客户端使用用户名跟密码请求登陆\n  2. 服务端收到请求，去验证用户名与密码\n  3. 验证成功后，服务端会签发一个Token并把这个Token发送到客户端\n  4. 客户端收到Token后，会把它存储起来（Cookie, LocalStorage）\n  5. 客户端每次向服务端请求资源的时候需要带着服务端签发的Token\n  6. 服务端收到请求，然后去验证客户端请求里面带着的Token，如果验证成功，就向客户端返回请求的数据\n\n- 每一次请求都需要携带Token，需要把Token放到HTTP的Header里\n- 基于Token的用户认证是一种服务端无状态的认证方法，服务端不用存放Token数据。用解析Token的实践换取Session的存储空间，从而减轻服务器的压力，减少频繁的查询数据库\n- Token完全由应用管理，所以可以避开同源策略\n\n## Refresh Token\n\n- Refresh Token是专用于刷新Access Token的Token。如果没有Refresh Token，也可以刷新Access Token，但每次刷新都要用户输入登陆用户名和和密码。有了Refresh Token，客户端直接用Refresh Token去更新Access Token。\n\n![refreshToken](../static/img/refreshtoken.png)\n\n- Access Token 的有效期比较短，当 Acesss Token 由于过期而失效时，使用 Refresh Token 就可以获取到新的 Token，如果 Refresh Token 也失效了，用户就只能重新登录了。\n- Refresh Token 及过期时间是存储在服务器的数据库中，只有在申请新的 Acesss Token 时才会验证，不会对业务接口响应时间造成影响，也不需要向 Session 一样一直保持在内存中以应对大量的请求。\n\n# Token和Session的区别\n\n- Session 是一种记录服务器和客户端会话状态的机制，使服务端有状态化，可以记录会话信息。而 Token 是令牌，访问资源接口（API）时所需要的资源凭证。Token 使服务端无状态化，不会存储会话信息。\n- Session 和 Token 并不矛盾，作为身份认证 Token 安全性比 Session 好，因为每一个请求都有签名还能防止监听以及重放攻击，而 Session 就必须依赖链路层来保障通讯安全了。如果你需要实现有状态的会话，仍然可以增加 Session 来在服务器端保存一些状态。\n- 所谓 Session 认证只是简单的把 User 信息存储到 Session 里，因为 SessionID 的不可预测性，暂且认为是安全的。而 Token ，如果指的是 OAuth Token 或类似的机制的话，提供的是 认证 和 授权 ，认证是针对用户，授权是针对 App 。其目的是让某 App 有权利访问某用户的信息。这里的 Token 是唯一的。不可以转移到其它 App上，也不可以转到其它用户上。Session 只提供一种简单的认证，即只要有此 SessionID ，即认为有此 User 的全部权利。是需要严格保密的，这个数据应该只保存在站方，不应该共享给其它网站或者第三方 App。所以简单来说：如果你的用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，用 Token 。如果永远只是自己的网站，自己的 App，用什么就无所谓了。\n\n# JWT\n\n- JSON Web Token（简称 JWT）是目前最流行的跨域认证解决方案。\n- 是一种认证授权机制\n- JWT 是为了在网络应用环境间传递声明而执行的一种基于 JSON 的开放标准（RFC 7519）。JWT 的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源。比如用在用户登录上。\n- 可以使用 HMAC 算法或者是 RSA 的公/私秘钥对 JWT 进行签名。因为数字签名的存在，这些传递的信息是可信的。\n\n## 原理\n![jwt](../static/img/jwt.png)\n- JWT认证流程\n  - 用户输入用户名/密码登录，服务端认证成功后，会返回给客户端一个 JWT\n  - 客户端将 token 保存到本地（通常使用 localstorage，也可以使用 cookie）\n  - 当用户希望访问一个受保护的路由或者资源的时候，需要请求头的 Authorization 字段中使用Bearer 模式添加 JWT，其内容看起来是下面这样`Authorization: Bearer <token>`\n- 服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为\n- 因为 JWT 是自包含的（内部包含了一些会话信息），因此减少了需要查询数据库的需要\n- 因为 JWT 并不使用 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n- 因为用户的状态不再存储在服务端的内存中，所以这是一种无状态的认证机制\n\n## 使用方式\n客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。\n\n**方法一**\n- 当用户希望访问一个受保护的路由或者资源的时候，可以把它放在 Cookie 里面自动发送，但是这样不能跨域，所以更好的做法是放在 HTTP 请求头信息的 Authorization 字段里，使用 Bearer 模式添加 JWT。\n```\nGET /calendar/v1/events\nHost: api.example.com\nAuthorization: Bearer <token>\n```\n  - 用户的状态不会存储在服务端的内存中，这是一种 无状态的认证机制\n  - 服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为。\n  - 由于 JWT 是自包含的，因此减少了需要查询数据库的需要\n  - JWT 的这些特性使得我们可以完全依赖其无状态的特性提供数据 API 服务，甚至是创建一个下载流服务。\n  - 因为 JWT 并不使用 Cookie ，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n\n**方法二**\n- 跨域的时候，可以把 JWT 放在 POST 请求的数据体里。\n\n**方法三**\n- 通过URL传输。\n`http://www.example.com/user?token=xxx`\n\n# Token和JWT的区别\n\n相同：\n- 都是访问资源的令牌\n- 都可以记录用户的信息\n- 都是使服务端无状态化\n- 都是只有验证成功后，客户端才能访问服务端上手保护的资源\n\n区别：\n- Token: 服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户信息，然后验证 Token 是否有效。\n- JWT: 将 Token 和 Payload 加密后存储于客户端，服务端只需要使用密钥解密进行校验（校验也是 JWT 自己实现的）即可，不需要查询或者减少查询数据库，因为 JWT 自包含了用户信息和加密的数据。\n\n# 常见的前后端鉴权方式\n- Session-Cookie\n- Token(JWT, SSO)\n- OAuth2.0\n\n# 问题\n\n**使用Cookie时需要考虑的问题**\n\n- 因为存储在客户端，容易被客户端篡改，使用前需要验证合法性\n- 不要存储敏感数据，比如用户密码，账户余额\n- 使用 httpOnly 在一定程度上提高安全性\n- 尽量减少 cookie 的体积，能存储的数据量不能超过 4kb\n- 设置正确的 domain 和 path，减少数据传输\n- cookie 无法跨域\n- 一个浏览器针对一个网站最多存 20 个Cookie，浏览器一般只允许存放 300 个Cookie\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用Session时需要考虑的问题**\n\n- 将 session 存储在服务器里面，当用户同时在线量比较多时，这些 session 会占据较多的内存，需要在服务端定期的去清理过期的 session\n- 当网站采用集群部署的时候，会遇到多台 web 服务器之间如何做 session 共享的问题。因为 session 是由单个服务器创建的，但是处理用户请求的服务器不一定是那个创建 session 的服务器，那么该服务器就无法拿到之前已经放入到 session 中的登录凭证之类的信息了。\n- 当多个应用要共享 session 时，除了以上问题，还会遇到跨域问题，因为不同的应用可能部署的主机不一样，需要在各个应用做好 cookie 跨域的处理。\n- sessionId 是存储在 cookie 中的，假如浏览器禁止 cookie 或不支持 cookie 怎么办？ 一般会把 sessionId 跟在 url 参数后面即重写 url，所以 session 不一定非得需要靠 cookie 实现\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用Token时需要考虑的问题**\n\n- 如果你认为用数据库来存储 token 会导致查询时间太长，可以选择放在内存当中。比如 redis 很适合你对 token 查询的需求。\n- token 完全由应用管理，所以它可以避开同源策略\n- token 可以避免 CSRF 攻击(因为不需要 cookie 了)\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用JWT时需要考虑的问题**\n\n- 因为 JWT 并不依赖 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n- JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。\n- JWT 不加密的情况下，不能将秘密数据写入 JWT。\n- JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。\n- JWT 最大的优势是服务器不再需要存储 Session，使得服务器认证鉴权业务可以方便扩展。但这也是 JWT 最大的缺点：由于服务器不需要存储 Session 状态，因此使用过程中无法废弃某个 Token 或者更改 Token 的权限。也就是说一旦 JWT 签发了，到期之前就会始终有效，除非服务器部署额外的逻辑。\n- JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。\n- JWT 适合一次性的命令认证，颁发一个有效期极短的 JWT，即使暴露了危险也很小，由于每次操作都会生成新的 JWT，因此也没必要保存 JWT，真正实现无状态。\n- 为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。\n\n**使用加密算法时需要考虑的问题**\n\n- 绝不要以明文存储密码\n- 永远使用 哈希算法 来处理密码，绝不要使用 Base64 或其他编码方式来存储密码，这和以明文存储密码是一样的，使用哈希，而不要使用编码。编码以及加密，都是双向的过程，而密码是保密的，应该只被它的所有者知道， 这个过程必须是单向的。哈希正是用于做这个的，从来没有解哈希这种说法， 但是编码就存在解码，加密就存在解密。\n- 绝不要使用弱哈希或已被破解的哈希算法，像 MD5 或 SHA1 ，只使用强密码哈希算法。\n- 绝不要以明文形式显示或发送密码，即使是对密码的所有者也应该这样。如果你需要 “忘记密码” 的功能，可以随机生成一个新的 一次性的（这点很重要）密码，然后把这个密码发送给用户。\n\n**只要关闭浏览器，Session就消失了**\n不对。对 session 来说，除非程序通知服务器删除一个 session，否则服务器会一直保留，程序一般都是在用户做 log off 的时候发个指令去删除 session。\n然而浏览器从来不会主动在关闭之前通知服务器它将要关闭，因此服务器根本不会有机会知道浏览器已经关闭，之所以会有这种错觉，是大部分 session 机制都使用会话 cookie 来保存 session id，而关闭浏览器后这个 session id 就消失了，再次连接服务器时也就无法找到原来的 session。如果服务器设置的 cookie 被保存在硬盘上，或者使用某种手段改写浏览器发出的 HTTP 请求头，把原来的 session id 发送给服务器，则再次打开浏览器仍然能够打开原来的 session。\n恰恰是由于关闭浏览器不会导致 session 被删除，迫使服务器为 session 设置了一个失效时间，当距离客户端上一次使用 session 的时间超过这个失效时间时，服务器就认为客户端已经停止了活动，才会把 session 删除以节省存储空间。\n\n\n\n# 分布式下Session共享方案\n\n1. Session复制\n\n任何一个服务器上的 session 发生改变（增删改），该节点会把这个 session 的所有内容序列化，然后广播给所有其它节点，不管其他服务器需不需要 session ，以此来保证 session 同步\n\n优点：可容错，各个服务器间Session能够实时响应。\n\n缺点：会对网络负荷造成一定压力，如果 session 量大的话可能会造成网络堵塞，拖慢服务器性能。\n\n1. 粘性Session/IP绑定策略\n\n采用 Ngnix 中的 ip_hash 机制，将某个 ip的所有请求都定向到同一台服务器上，即将用户与服务器绑定。 用户第一次请求时，负载均衡器将用户的请求转发到了 A 服务器上，如果负载均衡器设置了粘性 session 的话，那么用户以后的每次请求都会转发到 A 服务器上，相当于把用户和 A 服务器粘到了一块，这就是粘性 session 机制。\n\n优点：简单，不需要对Session做任何个处理。\n\n缺点：缺乏容错性，如果当前访问的服务器发生故障，用户被转移到第二个服务器上时，他的 session 信息都将失效。\n\n3. Session共享（常用）\n\n- 使用分布式缓存方案比如 Memcached 、Redis 来缓存 session，但是要求 Memcached 或 Redis 必须是集群\n- 把 session 放到 Redis 中存储，虽然架构上变得复杂，并且需要多访问一次 Redis ，但是这种方案带来的好处也是很大的：\n  - 实现了 session 共享；\n  - 可以水平扩展（增加 Redis 服务器）；\n  - 服务器重启 session 不丢失（不过也要注意 session 在 Redis 中的刷新/失效机制）；\n  - 不仅可以跨服务器 session 共享，甚至可以跨平台（例如网页端和 APP 端）\n\n4. Session持久化\n\n将 session 存储到数据库中，保证 session 的持久化\n\n优点：服务器出现问题，session 不会丢失\n\n缺点：如果网站的访问量很大，把 session 存储到数据库中，会对数据库造成很大压力，还需要增加额外的开销维护数据库。","source":"_posts/notebook/authentication_authorization.md","raw":"Cookie, Session, Token, JWT\n\n# Authentication(认证)\n认证当前的用户的身份\n\n互联网中的认证\n  - 用户名密码登陆\n  - 邮箱发送登陆链接\n  - 手机号接受验证码\n\n# Authorization(授权)\n用户权限\n\n实现授权的方式\n  - Cookie\n  - Session\n  - Token\n  - OAuth\n\n# Credentials(凭证)\n**实现认证和授权的前提是需要一种媒介（证书）来标记访问者的身份。**\n\n在互联网应用中，一般网站（如掘金）会有两种模式，游客模式和登录模式。游客模式下，可以正常浏览网站上面的文章，一旦想要点赞/收藏/分享文章，就需要登录或者注册账号。当用户登录成功后，服务器会给该用户使用的浏览器颁发一个令牌（token），这个令牌用来表明你的身份，每次浏览器发送请求时会带上这个令牌，就可以使用游客模式下无法使用的功能。\n\n# Cookie\n- HTTP 是无状态的协议（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不会保存任何会话信息）：每个请求都是完全独立的，服务端无法确认当前访问者的身份信息，无法分辨上一次的请求发送者和这一次的发送者是不是同一个人。所以服务器与浏览器为了进行会话跟踪（知道是谁在访问我），就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求是否来自同一浏览器。而这个状态需要通过 cookie 或者 session 去实现。\n- cookie 存储在客户端： cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。\n- cookie 是不可跨域的： 每个 cookie 都会绑定单一的域名，无法在别的域名下获取使用，一级域名和二级域名之间是允许共享使用的（靠的是 domain）。\n\n# Session\n- Session是另一种记录服务器和客户端会话状态的机制。\n- Session是基于Cookie实现的，Session存储在服务器端，SessionId会被存储到客户端的Cookie中。\n- Session认证流程\n  - 用户第一次请求服务器的时候，服务器根据用户提交的相关信息，创建对应的Session。\n  - 请求返回时将此Session对应的唯一标识信息SessionId返回给浏览器。\n  - 浏览器接受到服务器返回的SessionId信息后，会将此信息存入到Cookie中，同时Cookie记录此SessionId属于哪个域名。\n  - 当用户第二次访问服务器的时候，请求会自动判断此域名下是否存在Cookie信息，如果存在自动将Cookie信息信息也发送到服务端，服务端会从Cookie中获取SessionId，再根据SessionId查找到对应的Session信息，如果没有找到说明用户没有登陆或登陆失效，如果找到Session证明用户已经登陆可执行后面操作。\n\n根据以上流程可知，SessionID 是连接 Cookie 和 Session 的一道桥梁，大部分系统也是根据此原理来验证用户登录状态。\n\n# Cookie和Session的区别\n- **安全性：**Session比Cookie安全，Session是存储在服务端的，Cookie是存储在客户端的。\n- **存取值的类型不同：**Cookie只支持存字符串数据，想要设置其他类型的数据，需要将其转换成字符串，Session可以存任意数据类型。\n- **有效期不同：**Cookie可设置为长时间按保持，比如我们经常使用的默认登陆功能，Session一半失效时间较短，客户端关闭或Session超时都会失效。\n- **存储大小不同：**单个Cookie保存的数据不能超过4K，Session可存储数据远高于Cookie，但是当访问量过多，会占用过多的服务器资源。\n\n# Token(令牌)\n## Access Token\n- 访问资源接口（API）时所需要的资源凭证\n- 简单Token的组成：uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign（签名，token 的前几位以哈希算法压缩成的一定长度的十六进制字符串）\n- 特点\n  - 服务端无状态化、可扩展性好。\n  - 支持移动端设备\n  - 安全\n  - 支持跨程序调用\n- Token的身份验证流程  \n![accessToken](../static/img/accesstoken.png)\n  1. 客户端使用用户名跟密码请求登陆\n  2. 服务端收到请求，去验证用户名与密码\n  3. 验证成功后，服务端会签发一个Token并把这个Token发送到客户端\n  4. 客户端收到Token后，会把它存储起来（Cookie, LocalStorage）\n  5. 客户端每次向服务端请求资源的时候需要带着服务端签发的Token\n  6. 服务端收到请求，然后去验证客户端请求里面带着的Token，如果验证成功，就向客户端返回请求的数据\n\n- 每一次请求都需要携带Token，需要把Token放到HTTP的Header里\n- 基于Token的用户认证是一种服务端无状态的认证方法，服务端不用存放Token数据。用解析Token的实践换取Session的存储空间，从而减轻服务器的压力，减少频繁的查询数据库\n- Token完全由应用管理，所以可以避开同源策略\n\n## Refresh Token\n\n- Refresh Token是专用于刷新Access Token的Token。如果没有Refresh Token，也可以刷新Access Token，但每次刷新都要用户输入登陆用户名和和密码。有了Refresh Token，客户端直接用Refresh Token去更新Access Token。\n\n![refreshToken](../static/img/refreshtoken.png)\n\n- Access Token 的有效期比较短，当 Acesss Token 由于过期而失效时，使用 Refresh Token 就可以获取到新的 Token，如果 Refresh Token 也失效了，用户就只能重新登录了。\n- Refresh Token 及过期时间是存储在服务器的数据库中，只有在申请新的 Acesss Token 时才会验证，不会对业务接口响应时间造成影响，也不需要向 Session 一样一直保持在内存中以应对大量的请求。\n\n# Token和Session的区别\n\n- Session 是一种记录服务器和客户端会话状态的机制，使服务端有状态化，可以记录会话信息。而 Token 是令牌，访问资源接口（API）时所需要的资源凭证。Token 使服务端无状态化，不会存储会话信息。\n- Session 和 Token 并不矛盾，作为身份认证 Token 安全性比 Session 好，因为每一个请求都有签名还能防止监听以及重放攻击，而 Session 就必须依赖链路层来保障通讯安全了。如果你需要实现有状态的会话，仍然可以增加 Session 来在服务器端保存一些状态。\n- 所谓 Session 认证只是简单的把 User 信息存储到 Session 里，因为 SessionID 的不可预测性，暂且认为是安全的。而 Token ，如果指的是 OAuth Token 或类似的机制的话，提供的是 认证 和 授权 ，认证是针对用户，授权是针对 App 。其目的是让某 App 有权利访问某用户的信息。这里的 Token 是唯一的。不可以转移到其它 App上，也不可以转到其它用户上。Session 只提供一种简单的认证，即只要有此 SessionID ，即认为有此 User 的全部权利。是需要严格保密的，这个数据应该只保存在站方，不应该共享给其它网站或者第三方 App。所以简单来说：如果你的用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，用 Token 。如果永远只是自己的网站，自己的 App，用什么就无所谓了。\n\n# JWT\n\n- JSON Web Token（简称 JWT）是目前最流行的跨域认证解决方案。\n- 是一种认证授权机制\n- JWT 是为了在网络应用环境间传递声明而执行的一种基于 JSON 的开放标准（RFC 7519）。JWT 的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源。比如用在用户登录上。\n- 可以使用 HMAC 算法或者是 RSA 的公/私秘钥对 JWT 进行签名。因为数字签名的存在，这些传递的信息是可信的。\n\n## 原理\n![jwt](../static/img/jwt.png)\n- JWT认证流程\n  - 用户输入用户名/密码登录，服务端认证成功后，会返回给客户端一个 JWT\n  - 客户端将 token 保存到本地（通常使用 localstorage，也可以使用 cookie）\n  - 当用户希望访问一个受保护的路由或者资源的时候，需要请求头的 Authorization 字段中使用Bearer 模式添加 JWT，其内容看起来是下面这样`Authorization: Bearer <token>`\n- 服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为\n- 因为 JWT 是自包含的（内部包含了一些会话信息），因此减少了需要查询数据库的需要\n- 因为 JWT 并不使用 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n- 因为用户的状态不再存储在服务端的内存中，所以这是一种无状态的认证机制\n\n## 使用方式\n客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。\n\n**方法一**\n- 当用户希望访问一个受保护的路由或者资源的时候，可以把它放在 Cookie 里面自动发送，但是这样不能跨域，所以更好的做法是放在 HTTP 请求头信息的 Authorization 字段里，使用 Bearer 模式添加 JWT。\n```\nGET /calendar/v1/events\nHost: api.example.com\nAuthorization: Bearer <token>\n```\n  - 用户的状态不会存储在服务端的内存中，这是一种 无状态的认证机制\n  - 服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为。\n  - 由于 JWT 是自包含的，因此减少了需要查询数据库的需要\n  - JWT 的这些特性使得我们可以完全依赖其无状态的特性提供数据 API 服务，甚至是创建一个下载流服务。\n  - 因为 JWT 并不使用 Cookie ，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n\n**方法二**\n- 跨域的时候，可以把 JWT 放在 POST 请求的数据体里。\n\n**方法三**\n- 通过URL传输。\n`http://www.example.com/user?token=xxx`\n\n# Token和JWT的区别\n\n相同：\n- 都是访问资源的令牌\n- 都可以记录用户的信息\n- 都是使服务端无状态化\n- 都是只有验证成功后，客户端才能访问服务端上手保护的资源\n\n区别：\n- Token: 服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户信息，然后验证 Token 是否有效。\n- JWT: 将 Token 和 Payload 加密后存储于客户端，服务端只需要使用密钥解密进行校验（校验也是 JWT 自己实现的）即可，不需要查询或者减少查询数据库，因为 JWT 自包含了用户信息和加密的数据。\n\n# 常见的前后端鉴权方式\n- Session-Cookie\n- Token(JWT, SSO)\n- OAuth2.0\n\n# 问题\n\n**使用Cookie时需要考虑的问题**\n\n- 因为存储在客户端，容易被客户端篡改，使用前需要验证合法性\n- 不要存储敏感数据，比如用户密码，账户余额\n- 使用 httpOnly 在一定程度上提高安全性\n- 尽量减少 cookie 的体积，能存储的数据量不能超过 4kb\n- 设置正确的 domain 和 path，减少数据传输\n- cookie 无法跨域\n- 一个浏览器针对一个网站最多存 20 个Cookie，浏览器一般只允许存放 300 个Cookie\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用Session时需要考虑的问题**\n\n- 将 session 存储在服务器里面，当用户同时在线量比较多时，这些 session 会占据较多的内存，需要在服务端定期的去清理过期的 session\n- 当网站采用集群部署的时候，会遇到多台 web 服务器之间如何做 session 共享的问题。因为 session 是由单个服务器创建的，但是处理用户请求的服务器不一定是那个创建 session 的服务器，那么该服务器就无法拿到之前已经放入到 session 中的登录凭证之类的信息了。\n- 当多个应用要共享 session 时，除了以上问题，还会遇到跨域问题，因为不同的应用可能部署的主机不一样，需要在各个应用做好 cookie 跨域的处理。\n- sessionId 是存储在 cookie 中的，假如浏览器禁止 cookie 或不支持 cookie 怎么办？ 一般会把 sessionId 跟在 url 参数后面即重写 url，所以 session 不一定非得需要靠 cookie 实现\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用Token时需要考虑的问题**\n\n- 如果你认为用数据库来存储 token 会导致查询时间太长，可以选择放在内存当中。比如 redis 很适合你对 token 查询的需求。\n- token 完全由应用管理，所以它可以避开同源策略\n- token 可以避免 CSRF 攻击(因为不需要 cookie 了)\n- 移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token\n\n**使用JWT时需要考虑的问题**\n\n- 因为 JWT 并不依赖 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）\n- JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。\n- JWT 不加密的情况下，不能将秘密数据写入 JWT。\n- JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。\n- JWT 最大的优势是服务器不再需要存储 Session，使得服务器认证鉴权业务可以方便扩展。但这也是 JWT 最大的缺点：由于服务器不需要存储 Session 状态，因此使用过程中无法废弃某个 Token 或者更改 Token 的权限。也就是说一旦 JWT 签发了，到期之前就会始终有效，除非服务器部署额外的逻辑。\n- JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。\n- JWT 适合一次性的命令认证，颁发一个有效期极短的 JWT，即使暴露了危险也很小，由于每次操作都会生成新的 JWT，因此也没必要保存 JWT，真正实现无状态。\n- 为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。\n\n**使用加密算法时需要考虑的问题**\n\n- 绝不要以明文存储密码\n- 永远使用 哈希算法 来处理密码，绝不要使用 Base64 或其他编码方式来存储密码，这和以明文存储密码是一样的，使用哈希，而不要使用编码。编码以及加密，都是双向的过程，而密码是保密的，应该只被它的所有者知道， 这个过程必须是单向的。哈希正是用于做这个的，从来没有解哈希这种说法， 但是编码就存在解码，加密就存在解密。\n- 绝不要使用弱哈希或已被破解的哈希算法，像 MD5 或 SHA1 ，只使用强密码哈希算法。\n- 绝不要以明文形式显示或发送密码，即使是对密码的所有者也应该这样。如果你需要 “忘记密码” 的功能，可以随机生成一个新的 一次性的（这点很重要）密码，然后把这个密码发送给用户。\n\n**只要关闭浏览器，Session就消失了**\n不对。对 session 来说，除非程序通知服务器删除一个 session，否则服务器会一直保留，程序一般都是在用户做 log off 的时候发个指令去删除 session。\n然而浏览器从来不会主动在关闭之前通知服务器它将要关闭，因此服务器根本不会有机会知道浏览器已经关闭，之所以会有这种错觉，是大部分 session 机制都使用会话 cookie 来保存 session id，而关闭浏览器后这个 session id 就消失了，再次连接服务器时也就无法找到原来的 session。如果服务器设置的 cookie 被保存在硬盘上，或者使用某种手段改写浏览器发出的 HTTP 请求头，把原来的 session id 发送给服务器，则再次打开浏览器仍然能够打开原来的 session。\n恰恰是由于关闭浏览器不会导致 session 被删除，迫使服务器为 session 设置了一个失效时间，当距离客户端上一次使用 session 的时间超过这个失效时间时，服务器就认为客户端已经停止了活动，才会把 session 删除以节省存储空间。\n\n\n\n# 分布式下Session共享方案\n\n1. Session复制\n\n任何一个服务器上的 session 发生改变（增删改），该节点会把这个 session 的所有内容序列化，然后广播给所有其它节点，不管其他服务器需不需要 session ，以此来保证 session 同步\n\n优点：可容错，各个服务器间Session能够实时响应。\n\n缺点：会对网络负荷造成一定压力，如果 session 量大的话可能会造成网络堵塞，拖慢服务器性能。\n\n1. 粘性Session/IP绑定策略\n\n采用 Ngnix 中的 ip_hash 机制，将某个 ip的所有请求都定向到同一台服务器上，即将用户与服务器绑定。 用户第一次请求时，负载均衡器将用户的请求转发到了 A 服务器上，如果负载均衡器设置了粘性 session 的话，那么用户以后的每次请求都会转发到 A 服务器上，相当于把用户和 A 服务器粘到了一块，这就是粘性 session 机制。\n\n优点：简单，不需要对Session做任何个处理。\n\n缺点：缺乏容错性，如果当前访问的服务器发生故障，用户被转移到第二个服务器上时，他的 session 信息都将失效。\n\n3. Session共享（常用）\n\n- 使用分布式缓存方案比如 Memcached 、Redis 来缓存 session，但是要求 Memcached 或 Redis 必须是集群\n- 把 session 放到 Redis 中存储，虽然架构上变得复杂，并且需要多访问一次 Redis ，但是这种方案带来的好处也是很大的：\n  - 实现了 session 共享；\n  - 可以水平扩展（增加 Redis 服务器）；\n  - 服务器重启 session 不丢失（不过也要注意 session 在 Redis 中的刷新/失效机制）；\n  - 不仅可以跨服务器 session 共享，甚至可以跨平台（例如网页端和 APP 端）\n\n4. Session持久化\n\n将 session 存储到数据库中，保证 session 的持久化\n\n优点：服务器出现问题，session 不会丢失\n\n缺点：如果网站的访问量很大，把 session 存储到数据库中，会对数据库造成很大压力，还需要增加额外的开销维护数据库。","slug":"notebook/authentication_authorization","published":1,"date":"2020-08-16T01:44:17.082Z","updated":"2021-10-15T19:37:02.927Z","title":"notebook/authentication_authorization","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9800007c018obet93m6u","content":"<p>Cookie, Session, Token, JWT</p>\n<h1 id=\"Authentication-认证\"><a href=\"#Authentication-认证\" class=\"headerlink\" title=\"Authentication(认证)\"></a>Authentication(认证)</h1><p>认证当前的用户的身份</p>\n<p>互联网中的认证</p>\n<ul>\n<li>用户名密码登陆</li>\n<li>邮箱发送登陆链接</li>\n<li>手机号接受验证码</li>\n</ul>\n<h1 id=\"Authorization-授权\"><a href=\"#Authorization-授权\" class=\"headerlink\" title=\"Authorization(授权)\"></a>Authorization(授权)</h1><p>用户权限</p>\n<p>实现授权的方式</p>\n<ul>\n<li>Cookie</li>\n<li>Session</li>\n<li>Token</li>\n<li>OAuth</li>\n</ul>\n<h1 id=\"Credentials-凭证\"><a href=\"#Credentials-凭证\" class=\"headerlink\" title=\"Credentials(凭证)\"></a>Credentials(凭证)</h1><p><strong>实现认证和授权的前提是需要一种媒介（证书）来标记访问者的身份。</strong></p>\n<p>在互联网应用中，一般网站（如掘金）会有两种模式，游客模式和登录模式。游客模式下，可以正常浏览网站上面的文章，一旦想要点赞/收藏/分享文章，就需要登录或者注册账号。当用户登录成功后，服务器会给该用户使用的浏览器颁发一个令牌（token），这个令牌用来表明你的身份，每次浏览器发送请求时会带上这个令牌，就可以使用游客模式下无法使用的功能。</p>\n<h1 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h1><ul>\n<li>HTTP 是无状态的协议（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不会保存任何会话信息）：每个请求都是完全独立的，服务端无法确认当前访问者的身份信息，无法分辨上一次的请求发送者和这一次的发送者是不是同一个人。所以服务器与浏览器为了进行会话跟踪（知道是谁在访问我），就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求是否来自同一浏览器。而这个状态需要通过 cookie 或者 session 去实现。</li>\n<li>cookie 存储在客户端： cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。</li>\n<li>cookie 是不可跨域的： 每个 cookie 都会绑定单一的域名，无法在别的域名下获取使用，一级域名和二级域名之间是允许共享使用的（靠的是 domain）。</li>\n</ul>\n<h1 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h1><ul>\n<li>Session是另一种记录服务器和客户端会话状态的机制。</li>\n<li>Session是基于Cookie实现的，Session存储在服务器端，SessionId会被存储到客户端的Cookie中。</li>\n<li>Session认证流程<ul>\n<li>用户第一次请求服务器的时候，服务器根据用户提交的相关信息，创建对应的Session。</li>\n<li>请求返回时将此Session对应的唯一标识信息SessionId返回给浏览器。</li>\n<li>浏览器接受到服务器返回的SessionId信息后，会将此信息存入到Cookie中，同时Cookie记录此SessionId属于哪个域名。</li>\n<li>当用户第二次访问服务器的时候，请求会自动判断此域名下是否存在Cookie信息，如果存在自动将Cookie信息信息也发送到服务端，服务端会从Cookie中获取SessionId，再根据SessionId查找到对应的Session信息，如果没有找到说明用户没有登陆或登陆失效，如果找到Session证明用户已经登陆可执行后面操作。</li>\n</ul>\n</li>\n</ul>\n<p>根据以上流程可知，SessionID 是连接 Cookie 和 Session 的一道桥梁，大部分系统也是根据此原理来验证用户登录状态。</p>\n<h1 id=\"Cookie和Session的区别\"><a href=\"#Cookie和Session的区别\" class=\"headerlink\" title=\"Cookie和Session的区别\"></a>Cookie和Session的区别</h1><ul>\n<li><strong>安全性：</strong>Session比Cookie安全，Session是存储在服务端的，Cookie是存储在客户端的。</li>\n<li><strong>存取值的类型不同：</strong>Cookie只支持存字符串数据，想要设置其他类型的数据，需要将其转换成字符串，Session可以存任意数据类型。</li>\n<li><strong>有效期不同：</strong>Cookie可设置为长时间按保持，比如我们经常使用的默认登陆功能，Session一半失效时间较短，客户端关闭或Session超时都会失效。</li>\n<li><strong>存储大小不同：</strong>单个Cookie保存的数据不能超过4K，Session可存储数据远高于Cookie，但是当访问量过多，会占用过多的服务器资源。</li>\n</ul>\n<h1 id=\"Token-令牌\"><a href=\"#Token-令牌\" class=\"headerlink\" title=\"Token(令牌)\"></a>Token(令牌)</h1><h2 id=\"Access-Token\"><a href=\"#Access-Token\" class=\"headerlink\" title=\"Access Token\"></a>Access Token</h2><ul>\n<li><p>访问资源接口（API）时所需要的资源凭证</p>\n</li>\n<li><p>简单Token的组成：uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign（签名，token 的前几位以哈希算法压缩成的一定长度的十六进制字符串）</p>\n</li>\n<li><p>特点</p>\n<ul>\n<li>服务端无状态化、可扩展性好。</li>\n<li>支持移动端设备</li>\n<li>安全</li>\n<li>支持跨程序调用</li>\n</ul>\n</li>\n<li><p>Token的身份验证流程<br><img src=\"../static/img/accesstoken.png\" alt=\"accessToken\"></p>\n<ol>\n<li>客户端使用用户名跟密码请求登陆</li>\n<li>服务端收到请求，去验证用户名与密码</li>\n<li>验证成功后，服务端会签发一个Token并把这个Token发送到客户端</li>\n<li>客户端收到Token后，会把它存储起来（Cookie, LocalStorage）</li>\n<li>客户端每次向服务端请求资源的时候需要带着服务端签发的Token</li>\n<li>服务端收到请求，然后去验证客户端请求里面带着的Token，如果验证成功，就向客户端返回请求的数据</li>\n</ol>\n</li>\n<li><p>每一次请求都需要携带Token，需要把Token放到HTTP的Header里</p>\n</li>\n<li><p>基于Token的用户认证是一种服务端无状态的认证方法，服务端不用存放Token数据。用解析Token的实践换取Session的存储空间，从而减轻服务器的压力，减少频繁的查询数据库</p>\n</li>\n<li><p>Token完全由应用管理，所以可以避开同源策略</p>\n</li>\n</ul>\n<h2 id=\"Refresh-Token\"><a href=\"#Refresh-Token\" class=\"headerlink\" title=\"Refresh Token\"></a>Refresh Token</h2><ul>\n<li>Refresh Token是专用于刷新Access Token的Token。如果没有Refresh Token，也可以刷新Access Token，但每次刷新都要用户输入登陆用户名和和密码。有了Refresh Token，客户端直接用Refresh Token去更新Access Token。</li>\n</ul>\n<p><img src=\"../static/img/refreshtoken.png\" alt=\"refreshToken\"></p>\n<ul>\n<li>Access Token 的有效期比较短，当 Acesss Token 由于过期而失效时，使用 Refresh Token 就可以获取到新的 Token，如果 Refresh Token 也失效了，用户就只能重新登录了。</li>\n<li>Refresh Token 及过期时间是存储在服务器的数据库中，只有在申请新的 Acesss Token 时才会验证，不会对业务接口响应时间造成影响，也不需要向 Session 一样一直保持在内存中以应对大量的请求。</li>\n</ul>\n<h1 id=\"Token和Session的区别\"><a href=\"#Token和Session的区别\" class=\"headerlink\" title=\"Token和Session的区别\"></a>Token和Session的区别</h1><ul>\n<li>Session 是一种记录服务器和客户端会话状态的机制，使服务端有状态化，可以记录会话信息。而 Token 是令牌，访问资源接口（API）时所需要的资源凭证。Token 使服务端无状态化，不会存储会话信息。</li>\n<li>Session 和 Token 并不矛盾，作为身份认证 Token 安全性比 Session 好，因为每一个请求都有签名还能防止监听以及重放攻击，而 Session 就必须依赖链路层来保障通讯安全了。如果你需要实现有状态的会话，仍然可以增加 Session 来在服务器端保存一些状态。</li>\n<li>所谓 Session 认证只是简单的把 User 信息存储到 Session 里，因为 SessionID 的不可预测性，暂且认为是安全的。而 Token ，如果指的是 OAuth Token 或类似的机制的话，提供的是 认证 和 授权 ，认证是针对用户，授权是针对 App 。其目的是让某 App 有权利访问某用户的信息。这里的 Token 是唯一的。不可以转移到其它 App上，也不可以转到其它用户上。Session 只提供一种简单的认证，即只要有此 SessionID ，即认为有此 User 的全部权利。是需要严格保密的，这个数据应该只保存在站方，不应该共享给其它网站或者第三方 App。所以简单来说：如果你的用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，用 Token 。如果永远只是自己的网站，自己的 App，用什么就无所谓了。</li>\n</ul>\n<h1 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h1><ul>\n<li>JSON Web Token（简称 JWT）是目前最流行的跨域认证解决方案。</li>\n<li>是一种认证授权机制</li>\n<li>JWT 是为了在网络应用环境间传递声明而执行的一种基于 JSON 的开放标准（RFC 7519）。JWT 的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源。比如用在用户登录上。</li>\n<li>可以使用 HMAC 算法或者是 RSA 的公/私秘钥对 JWT 进行签名。因为数字签名的存在，这些传递的信息是可信的。</li>\n</ul>\n<h2 id=\"原理\"><a href=\"#原理\" class=\"headerlink\" title=\"原理\"></a>原理</h2><p><img src=\"../static/img/jwt.png\" alt=\"jwt\"></p>\n<ul>\n<li>JWT认证流程<ul>\n<li>用户输入用户名/密码登录，服务端认证成功后，会返回给客户端一个 JWT</li>\n<li>客户端将 token 保存到本地（通常使用 localstorage，也可以使用 cookie）</li>\n<li>当用户希望访问一个受保护的路由或者资源的时候，需要请求头的 Authorization 字段中使用Bearer 模式添加 JWT，其内容看起来是下面这样<code>Authorization: Bearer &lt;token&gt;</code></li>\n</ul>\n</li>\n<li>服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为</li>\n<li>因为 JWT 是自包含的（内部包含了一些会话信息），因此减少了需要查询数据库的需要</li>\n<li>因为 JWT 并不使用 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n<li>因为用户的状态不再存储在服务端的内存中，所以这是一种无状态的认证机制</li>\n</ul>\n<h2 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h2><p>客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。</p>\n<p><strong>方法一</strong></p>\n<ul>\n<li>当用户希望访问一个受保护的路由或者资源的时候，可以把它放在 Cookie 里面自动发送，但是这样不能跨域，所以更好的做法是放在 HTTP 请求头信息的 Authorization 字段里，使用 Bearer 模式添加 JWT。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET &#x2F;calendar&#x2F;v1&#x2F;events</span><br><span class=\"line\">Host: api.example.com</span><br><span class=\"line\">Authorization: Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>用户的状态不会存储在服务端的内存中，这是一种 无状态的认证机制</li>\n<li>服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为。</li>\n<li>由于 JWT 是自包含的，因此减少了需要查询数据库的需要</li>\n<li>JWT 的这些特性使得我们可以完全依赖其无状态的特性提供数据 API 服务，甚至是创建一个下载流服务。</li>\n<li>因为 JWT 并不使用 Cookie ，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n</ul>\n</li>\n</ul>\n<p><strong>方法二</strong></p>\n<ul>\n<li>跨域的时候，可以把 JWT 放在 POST 请求的数据体里。</li>\n</ul>\n<p><strong>方法三</strong></p>\n<ul>\n<li>通过URL传输。<br><code>http://www.example.com/user?token=xxx</code></li>\n</ul>\n<h1 id=\"Token和JWT的区别\"><a href=\"#Token和JWT的区别\" class=\"headerlink\" title=\"Token和JWT的区别\"></a>Token和JWT的区别</h1><p>相同：</p>\n<ul>\n<li>都是访问资源的令牌</li>\n<li>都可以记录用户的信息</li>\n<li>都是使服务端无状态化</li>\n<li>都是只有验证成功后，客户端才能访问服务端上手保护的资源</li>\n</ul>\n<p>区别：</p>\n<ul>\n<li>Token: 服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户信息，然后验证 Token 是否有效。</li>\n<li>JWT: 将 Token 和 Payload 加密后存储于客户端，服务端只需要使用密钥解密进行校验（校验也是 JWT 自己实现的）即可，不需要查询或者减少查询数据库，因为 JWT 自包含了用户信息和加密的数据。</li>\n</ul>\n<h1 id=\"常见的前后端鉴权方式\"><a href=\"#常见的前后端鉴权方式\" class=\"headerlink\" title=\"常见的前后端鉴权方式\"></a>常见的前后端鉴权方式</h1><ul>\n<li>Session-Cookie</li>\n<li>Token(JWT, SSO)</li>\n<li>OAuth2.0</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p><strong>使用Cookie时需要考虑的问题</strong></p>\n<ul>\n<li>因为存储在客户端，容易被客户端篡改，使用前需要验证合法性</li>\n<li>不要存储敏感数据，比如用户密码，账户余额</li>\n<li>使用 httpOnly 在一定程度上提高安全性</li>\n<li>尽量减少 cookie 的体积，能存储的数据量不能超过 4kb</li>\n<li>设置正确的 domain 和 path，减少数据传输</li>\n<li>cookie 无法跨域</li>\n<li>一个浏览器针对一个网站最多存 20 个Cookie，浏览器一般只允许存放 300 个Cookie</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用Session时需要考虑的问题</strong></p>\n<ul>\n<li>将 session 存储在服务器里面，当用户同时在线量比较多时，这些 session 会占据较多的内存，需要在服务端定期的去清理过期的 session</li>\n<li>当网站采用集群部署的时候，会遇到多台 web 服务器之间如何做 session 共享的问题。因为 session 是由单个服务器创建的，但是处理用户请求的服务器不一定是那个创建 session 的服务器，那么该服务器就无法拿到之前已经放入到 session 中的登录凭证之类的信息了。</li>\n<li>当多个应用要共享 session 时，除了以上问题，还会遇到跨域问题，因为不同的应用可能部署的主机不一样，需要在各个应用做好 cookie 跨域的处理。</li>\n<li>sessionId 是存储在 cookie 中的，假如浏览器禁止 cookie 或不支持 cookie 怎么办？ 一般会把 sessionId 跟在 url 参数后面即重写 url，所以 session 不一定非得需要靠 cookie 实现</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用Token时需要考虑的问题</strong></p>\n<ul>\n<li>如果你认为用数据库来存储 token 会导致查询时间太长，可以选择放在内存当中。比如 redis 很适合你对 token 查询的需求。</li>\n<li>token 完全由应用管理，所以它可以避开同源策略</li>\n<li>token 可以避免 CSRF 攻击(因为不需要 cookie 了)</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用JWT时需要考虑的问题</strong></p>\n<ul>\n<li>因为 JWT 并不依赖 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n<li>JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。</li>\n<li>JWT 不加密的情况下，不能将秘密数据写入 JWT。</li>\n<li>JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。</li>\n<li>JWT 最大的优势是服务器不再需要存储 Session，使得服务器认证鉴权业务可以方便扩展。但这也是 JWT 最大的缺点：由于服务器不需要存储 Session 状态，因此使用过程中无法废弃某个 Token 或者更改 Token 的权限。也就是说一旦 JWT 签发了，到期之前就会始终有效，除非服务器部署额外的逻辑。</li>\n<li>JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。</li>\n<li>JWT 适合一次性的命令认证，颁发一个有效期极短的 JWT，即使暴露了危险也很小，由于每次操作都会生成新的 JWT，因此也没必要保存 JWT，真正实现无状态。</li>\n<li>为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。</li>\n</ul>\n<p><strong>使用加密算法时需要考虑的问题</strong></p>\n<ul>\n<li>绝不要以明文存储密码</li>\n<li>永远使用 哈希算法 来处理密码，绝不要使用 Base64 或其他编码方式来存储密码，这和以明文存储密码是一样的，使用哈希，而不要使用编码。编码以及加密，都是双向的过程，而密码是保密的，应该只被它的所有者知道， 这个过程必须是单向的。哈希正是用于做这个的，从来没有解哈希这种说法， 但是编码就存在解码，加密就存在解密。</li>\n<li>绝不要使用弱哈希或已被破解的哈希算法，像 MD5 或 SHA1 ，只使用强密码哈希算法。</li>\n<li>绝不要以明文形式显示或发送密码，即使是对密码的所有者也应该这样。如果你需要 “忘记密码” 的功能，可以随机生成一个新的 一次性的（这点很重要）密码，然后把这个密码发送给用户。</li>\n</ul>\n<p><strong>只要关闭浏览器，Session就消失了</strong><br>不对。对 session 来说，除非程序通知服务器删除一个 session，否则服务器会一直保留，程序一般都是在用户做 log off 的时候发个指令去删除 session。<br>然而浏览器从来不会主动在关闭之前通知服务器它将要关闭，因此服务器根本不会有机会知道浏览器已经关闭，之所以会有这种错觉，是大部分 session 机制都使用会话 cookie 来保存 session id，而关闭浏览器后这个 session id 就消失了，再次连接服务器时也就无法找到原来的 session。如果服务器设置的 cookie 被保存在硬盘上，或者使用某种手段改写浏览器发出的 HTTP 请求头，把原来的 session id 发送给服务器，则再次打开浏览器仍然能够打开原来的 session。<br>恰恰是由于关闭浏览器不会导致 session 被删除，迫使服务器为 session 设置了一个失效时间，当距离客户端上一次使用 session 的时间超过这个失效时间时，服务器就认为客户端已经停止了活动，才会把 session 删除以节省存储空间。</p>\n<h1 id=\"分布式下Session共享方案\"><a href=\"#分布式下Session共享方案\" class=\"headerlink\" title=\"分布式下Session共享方案\"></a>分布式下Session共享方案</h1><ol>\n<li>Session复制</li>\n</ol>\n<p>任何一个服务器上的 session 发生改变（增删改），该节点会把这个 session 的所有内容序列化，然后广播给所有其它节点，不管其他服务器需不需要 session ，以此来保证 session 同步</p>\n<p>优点：可容错，各个服务器间Session能够实时响应。</p>\n<p>缺点：会对网络负荷造成一定压力，如果 session 量大的话可能会造成网络堵塞，拖慢服务器性能。</p>\n<ol>\n<li>粘性Session/IP绑定策略</li>\n</ol>\n<p>采用 Ngnix 中的 ip_hash 机制，将某个 ip的所有请求都定向到同一台服务器上，即将用户与服务器绑定。 用户第一次请求时，负载均衡器将用户的请求转发到了 A 服务器上，如果负载均衡器设置了粘性 session 的话，那么用户以后的每次请求都会转发到 A 服务器上，相当于把用户和 A 服务器粘到了一块，这就是粘性 session 机制。</p>\n<p>优点：简单，不需要对Session做任何个处理。</p>\n<p>缺点：缺乏容错性，如果当前访问的服务器发生故障，用户被转移到第二个服务器上时，他的 session 信息都将失效。</p>\n<ol start=\"3\">\n<li>Session共享（常用）</li>\n</ol>\n<ul>\n<li>使用分布式缓存方案比如 Memcached 、Redis 来缓存 session，但是要求 Memcached 或 Redis 必须是集群</li>\n<li>把 session 放到 Redis 中存储，虽然架构上变得复杂，并且需要多访问一次 Redis ，但是这种方案带来的好处也是很大的：<ul>\n<li>实现了 session 共享；</li>\n<li>可以水平扩展（增加 Redis 服务器）；</li>\n<li>服务器重启 session 不丢失（不过也要注意 session 在 Redis 中的刷新/失效机制）；</li>\n<li>不仅可以跨服务器 session 共享，甚至可以跨平台（例如网页端和 APP 端）</li>\n</ul>\n</li>\n</ul>\n<ol start=\"4\">\n<li>Session持久化</li>\n</ol>\n<p>将 session 存储到数据库中，保证 session 的持久化</p>\n<p>优点：服务器出现问题，session 不会丢失</p>\n<p>缺点：如果网站的访问量很大，把 session 存储到数据库中，会对数据库造成很大压力，还需要增加额外的开销维护数据库。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Cookie, Session, Token, JWT</p>\n<h1 id=\"Authentication-认证\"><a href=\"#Authentication-认证\" class=\"headerlink\" title=\"Authentication(认证)\"></a>Authentication(认证)</h1><p>认证当前的用户的身份</p>\n<p>互联网中的认证</p>\n<ul>\n<li>用户名密码登陆</li>\n<li>邮箱发送登陆链接</li>\n<li>手机号接受验证码</li>\n</ul>\n<h1 id=\"Authorization-授权\"><a href=\"#Authorization-授权\" class=\"headerlink\" title=\"Authorization(授权)\"></a>Authorization(授权)</h1><p>用户权限</p>\n<p>实现授权的方式</p>\n<ul>\n<li>Cookie</li>\n<li>Session</li>\n<li>Token</li>\n<li>OAuth</li>\n</ul>\n<h1 id=\"Credentials-凭证\"><a href=\"#Credentials-凭证\" class=\"headerlink\" title=\"Credentials(凭证)\"></a>Credentials(凭证)</h1><p><strong>实现认证和授权的前提是需要一种媒介（证书）来标记访问者的身份。</strong></p>\n<p>在互联网应用中，一般网站（如掘金）会有两种模式，游客模式和登录模式。游客模式下，可以正常浏览网站上面的文章，一旦想要点赞/收藏/分享文章，就需要登录或者注册账号。当用户登录成功后，服务器会给该用户使用的浏览器颁发一个令牌（token），这个令牌用来表明你的身份，每次浏览器发送请求时会带上这个令牌，就可以使用游客模式下无法使用的功能。</p>\n<h1 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h1><ul>\n<li>HTTP 是无状态的协议（对于事务处理没有记忆能力，每次客户端和服务端会话完成时，服务端不会保存任何会话信息）：每个请求都是完全独立的，服务端无法确认当前访问者的身份信息，无法分辨上一次的请求发送者和这一次的发送者是不是同一个人。所以服务器与浏览器为了进行会话跟踪（知道是谁在访问我），就必须主动的去维护一个状态，这个状态用于告知服务端前后两个请求是否来自同一浏览器。而这个状态需要通过 cookie 或者 session 去实现。</li>\n<li>cookie 存储在客户端： cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。</li>\n<li>cookie 是不可跨域的： 每个 cookie 都会绑定单一的域名，无法在别的域名下获取使用，一级域名和二级域名之间是允许共享使用的（靠的是 domain）。</li>\n</ul>\n<h1 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h1><ul>\n<li>Session是另一种记录服务器和客户端会话状态的机制。</li>\n<li>Session是基于Cookie实现的，Session存储在服务器端，SessionId会被存储到客户端的Cookie中。</li>\n<li>Session认证流程<ul>\n<li>用户第一次请求服务器的时候，服务器根据用户提交的相关信息，创建对应的Session。</li>\n<li>请求返回时将此Session对应的唯一标识信息SessionId返回给浏览器。</li>\n<li>浏览器接受到服务器返回的SessionId信息后，会将此信息存入到Cookie中，同时Cookie记录此SessionId属于哪个域名。</li>\n<li>当用户第二次访问服务器的时候，请求会自动判断此域名下是否存在Cookie信息，如果存在自动将Cookie信息信息也发送到服务端，服务端会从Cookie中获取SessionId，再根据SessionId查找到对应的Session信息，如果没有找到说明用户没有登陆或登陆失效，如果找到Session证明用户已经登陆可执行后面操作。</li>\n</ul>\n</li>\n</ul>\n<p>根据以上流程可知，SessionID 是连接 Cookie 和 Session 的一道桥梁，大部分系统也是根据此原理来验证用户登录状态。</p>\n<h1 id=\"Cookie和Session的区别\"><a href=\"#Cookie和Session的区别\" class=\"headerlink\" title=\"Cookie和Session的区别\"></a>Cookie和Session的区别</h1><ul>\n<li><strong>安全性：</strong>Session比Cookie安全，Session是存储在服务端的，Cookie是存储在客户端的。</li>\n<li><strong>存取值的类型不同：</strong>Cookie只支持存字符串数据，想要设置其他类型的数据，需要将其转换成字符串，Session可以存任意数据类型。</li>\n<li><strong>有效期不同：</strong>Cookie可设置为长时间按保持，比如我们经常使用的默认登陆功能，Session一半失效时间较短，客户端关闭或Session超时都会失效。</li>\n<li><strong>存储大小不同：</strong>单个Cookie保存的数据不能超过4K，Session可存储数据远高于Cookie，但是当访问量过多，会占用过多的服务器资源。</li>\n</ul>\n<h1 id=\"Token-令牌\"><a href=\"#Token-令牌\" class=\"headerlink\" title=\"Token(令牌)\"></a>Token(令牌)</h1><h2 id=\"Access-Token\"><a href=\"#Access-Token\" class=\"headerlink\" title=\"Access Token\"></a>Access Token</h2><ul>\n<li><p>访问资源接口（API）时所需要的资源凭证</p>\n</li>\n<li><p>简单Token的组成：uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign（签名，token 的前几位以哈希算法压缩成的一定长度的十六进制字符串）</p>\n</li>\n<li><p>特点</p>\n<ul>\n<li>服务端无状态化、可扩展性好。</li>\n<li>支持移动端设备</li>\n<li>安全</li>\n<li>支持跨程序调用</li>\n</ul>\n</li>\n<li><p>Token的身份验证流程<br><img src=\"../static/img/accesstoken.png\" alt=\"accessToken\"></p>\n<ol>\n<li>客户端使用用户名跟密码请求登陆</li>\n<li>服务端收到请求，去验证用户名与密码</li>\n<li>验证成功后，服务端会签发一个Token并把这个Token发送到客户端</li>\n<li>客户端收到Token后，会把它存储起来（Cookie, LocalStorage）</li>\n<li>客户端每次向服务端请求资源的时候需要带着服务端签发的Token</li>\n<li>服务端收到请求，然后去验证客户端请求里面带着的Token，如果验证成功，就向客户端返回请求的数据</li>\n</ol>\n</li>\n<li><p>每一次请求都需要携带Token，需要把Token放到HTTP的Header里</p>\n</li>\n<li><p>基于Token的用户认证是一种服务端无状态的认证方法，服务端不用存放Token数据。用解析Token的实践换取Session的存储空间，从而减轻服务器的压力，减少频繁的查询数据库</p>\n</li>\n<li><p>Token完全由应用管理，所以可以避开同源策略</p>\n</li>\n</ul>\n<h2 id=\"Refresh-Token\"><a href=\"#Refresh-Token\" class=\"headerlink\" title=\"Refresh Token\"></a>Refresh Token</h2><ul>\n<li>Refresh Token是专用于刷新Access Token的Token。如果没有Refresh Token，也可以刷新Access Token，但每次刷新都要用户输入登陆用户名和和密码。有了Refresh Token，客户端直接用Refresh Token去更新Access Token。</li>\n</ul>\n<p><img src=\"../static/img/refreshtoken.png\" alt=\"refreshToken\"></p>\n<ul>\n<li>Access Token 的有效期比较短，当 Acesss Token 由于过期而失效时，使用 Refresh Token 就可以获取到新的 Token，如果 Refresh Token 也失效了，用户就只能重新登录了。</li>\n<li>Refresh Token 及过期时间是存储在服务器的数据库中，只有在申请新的 Acesss Token 时才会验证，不会对业务接口响应时间造成影响，也不需要向 Session 一样一直保持在内存中以应对大量的请求。</li>\n</ul>\n<h1 id=\"Token和Session的区别\"><a href=\"#Token和Session的区别\" class=\"headerlink\" title=\"Token和Session的区别\"></a>Token和Session的区别</h1><ul>\n<li>Session 是一种记录服务器和客户端会话状态的机制，使服务端有状态化，可以记录会话信息。而 Token 是令牌，访问资源接口（API）时所需要的资源凭证。Token 使服务端无状态化，不会存储会话信息。</li>\n<li>Session 和 Token 并不矛盾，作为身份认证 Token 安全性比 Session 好，因为每一个请求都有签名还能防止监听以及重放攻击，而 Session 就必须依赖链路层来保障通讯安全了。如果你需要实现有状态的会话，仍然可以增加 Session 来在服务器端保存一些状态。</li>\n<li>所谓 Session 认证只是简单的把 User 信息存储到 Session 里，因为 SessionID 的不可预测性，暂且认为是安全的。而 Token ，如果指的是 OAuth Token 或类似的机制的话，提供的是 认证 和 授权 ，认证是针对用户，授权是针对 App 。其目的是让某 App 有权利访问某用户的信息。这里的 Token 是唯一的。不可以转移到其它 App上，也不可以转到其它用户上。Session 只提供一种简单的认证，即只要有此 SessionID ，即认为有此 User 的全部权利。是需要严格保密的，这个数据应该只保存在站方，不应该共享给其它网站或者第三方 App。所以简单来说：如果你的用户数据可能需要和第三方共享，或者允许第三方调用 API 接口，用 Token 。如果永远只是自己的网站，自己的 App，用什么就无所谓了。</li>\n</ul>\n<h1 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h1><ul>\n<li>JSON Web Token（简称 JWT）是目前最流行的跨域认证解决方案。</li>\n<li>是一种认证授权机制</li>\n<li>JWT 是为了在网络应用环境间传递声明而执行的一种基于 JSON 的开放标准（RFC 7519）。JWT 的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源。比如用在用户登录上。</li>\n<li>可以使用 HMAC 算法或者是 RSA 的公/私秘钥对 JWT 进行签名。因为数字签名的存在，这些传递的信息是可信的。</li>\n</ul>\n<h2 id=\"原理\"><a href=\"#原理\" class=\"headerlink\" title=\"原理\"></a>原理</h2><p><img src=\"../static/img/jwt.png\" alt=\"jwt\"></p>\n<ul>\n<li>JWT认证流程<ul>\n<li>用户输入用户名/密码登录，服务端认证成功后，会返回给客户端一个 JWT</li>\n<li>客户端将 token 保存到本地（通常使用 localstorage，也可以使用 cookie）</li>\n<li>当用户希望访问一个受保护的路由或者资源的时候，需要请求头的 Authorization 字段中使用Bearer 模式添加 JWT，其内容看起来是下面这样<code>Authorization: Bearer &lt;token&gt;</code></li>\n</ul>\n</li>\n<li>服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为</li>\n<li>因为 JWT 是自包含的（内部包含了一些会话信息），因此减少了需要查询数据库的需要</li>\n<li>因为 JWT 并不使用 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n<li>因为用户的状态不再存储在服务端的内存中，所以这是一种无状态的认证机制</li>\n</ul>\n<h2 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h2><p>客户端收到服务器返回的 JWT，可以储存在 Cookie 里面，也可以储存在 localStorage。</p>\n<p><strong>方法一</strong></p>\n<ul>\n<li>当用户希望访问一个受保护的路由或者资源的时候，可以把它放在 Cookie 里面自动发送，但是这样不能跨域，所以更好的做法是放在 HTTP 请求头信息的 Authorization 字段里，使用 Bearer 模式添加 JWT。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET &#x2F;calendar&#x2F;v1&#x2F;events</span><br><span class=\"line\">Host: api.example.com</span><br><span class=\"line\">Authorization: Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>用户的状态不会存储在服务端的内存中，这是一种 无状态的认证机制</li>\n<li>服务端的保护路由将会检查请求头 Authorization 中的 JWT 信息，如果合法，则允许用户的行为。</li>\n<li>由于 JWT 是自包含的，因此减少了需要查询数据库的需要</li>\n<li>JWT 的这些特性使得我们可以完全依赖其无状态的特性提供数据 API 服务，甚至是创建一个下载流服务。</li>\n<li>因为 JWT 并不使用 Cookie ，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n</ul>\n</li>\n</ul>\n<p><strong>方法二</strong></p>\n<ul>\n<li>跨域的时候，可以把 JWT 放在 POST 请求的数据体里。</li>\n</ul>\n<p><strong>方法三</strong></p>\n<ul>\n<li>通过URL传输。<br><code>http://www.example.com/user?token=xxx</code></li>\n</ul>\n<h1 id=\"Token和JWT的区别\"><a href=\"#Token和JWT的区别\" class=\"headerlink\" title=\"Token和JWT的区别\"></a>Token和JWT的区别</h1><p>相同：</p>\n<ul>\n<li>都是访问资源的令牌</li>\n<li>都可以记录用户的信息</li>\n<li>都是使服务端无状态化</li>\n<li>都是只有验证成功后，客户端才能访问服务端上手保护的资源</li>\n</ul>\n<p>区别：</p>\n<ul>\n<li>Token: 服务端验证客户端发送过来的 Token 时，还需要查询数据库获取用户信息，然后验证 Token 是否有效。</li>\n<li>JWT: 将 Token 和 Payload 加密后存储于客户端，服务端只需要使用密钥解密进行校验（校验也是 JWT 自己实现的）即可，不需要查询或者减少查询数据库，因为 JWT 自包含了用户信息和加密的数据。</li>\n</ul>\n<h1 id=\"常见的前后端鉴权方式\"><a href=\"#常见的前后端鉴权方式\" class=\"headerlink\" title=\"常见的前后端鉴权方式\"></a>常见的前后端鉴权方式</h1><ul>\n<li>Session-Cookie</li>\n<li>Token(JWT, SSO)</li>\n<li>OAuth2.0</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p><strong>使用Cookie时需要考虑的问题</strong></p>\n<ul>\n<li>因为存储在客户端，容易被客户端篡改，使用前需要验证合法性</li>\n<li>不要存储敏感数据，比如用户密码，账户余额</li>\n<li>使用 httpOnly 在一定程度上提高安全性</li>\n<li>尽量减少 cookie 的体积，能存储的数据量不能超过 4kb</li>\n<li>设置正确的 domain 和 path，减少数据传输</li>\n<li>cookie 无法跨域</li>\n<li>一个浏览器针对一个网站最多存 20 个Cookie，浏览器一般只允许存放 300 个Cookie</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用Session时需要考虑的问题</strong></p>\n<ul>\n<li>将 session 存储在服务器里面，当用户同时在线量比较多时，这些 session 会占据较多的内存，需要在服务端定期的去清理过期的 session</li>\n<li>当网站采用集群部署的时候，会遇到多台 web 服务器之间如何做 session 共享的问题。因为 session 是由单个服务器创建的，但是处理用户请求的服务器不一定是那个创建 session 的服务器，那么该服务器就无法拿到之前已经放入到 session 中的登录凭证之类的信息了。</li>\n<li>当多个应用要共享 session 时，除了以上问题，还会遇到跨域问题，因为不同的应用可能部署的主机不一样，需要在各个应用做好 cookie 跨域的处理。</li>\n<li>sessionId 是存储在 cookie 中的，假如浏览器禁止 cookie 或不支持 cookie 怎么办？ 一般会把 sessionId 跟在 url 参数后面即重写 url，所以 session 不一定非得需要靠 cookie 实现</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用Token时需要考虑的问题</strong></p>\n<ul>\n<li>如果你认为用数据库来存储 token 会导致查询时间太长，可以选择放在内存当中。比如 redis 很适合你对 token 查询的需求。</li>\n<li>token 完全由应用管理，所以它可以避开同源策略</li>\n<li>token 可以避免 CSRF 攻击(因为不需要 cookie 了)</li>\n<li>移动端对 cookie 的支持不是很好，而 session 需要基于 cookie 实现，所以移动端常用的是 token</li>\n</ul>\n<p><strong>使用JWT时需要考虑的问题</strong></p>\n<ul>\n<li>因为 JWT 并不依赖 Cookie 的，所以你可以使用任何域名提供你的 API 服务而不需要担心跨域资源共享问题（CORS）</li>\n<li>JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。</li>\n<li>JWT 不加密的情况下，不能将秘密数据写入 JWT。</li>\n<li>JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。</li>\n<li>JWT 最大的优势是服务器不再需要存储 Session，使得服务器认证鉴权业务可以方便扩展。但这也是 JWT 最大的缺点：由于服务器不需要存储 Session 状态，因此使用过程中无法废弃某个 Token 或者更改 Token 的权限。也就是说一旦 JWT 签发了，到期之前就会始终有效，除非服务器部署额外的逻辑。</li>\n<li>JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。</li>\n<li>JWT 适合一次性的命令认证，颁发一个有效期极短的 JWT，即使暴露了危险也很小，由于每次操作都会生成新的 JWT，因此也没必要保存 JWT，真正实现无状态。</li>\n<li>为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。</li>\n</ul>\n<p><strong>使用加密算法时需要考虑的问题</strong></p>\n<ul>\n<li>绝不要以明文存储密码</li>\n<li>永远使用 哈希算法 来处理密码，绝不要使用 Base64 或其他编码方式来存储密码，这和以明文存储密码是一样的，使用哈希，而不要使用编码。编码以及加密，都是双向的过程，而密码是保密的，应该只被它的所有者知道， 这个过程必须是单向的。哈希正是用于做这个的，从来没有解哈希这种说法， 但是编码就存在解码，加密就存在解密。</li>\n<li>绝不要使用弱哈希或已被破解的哈希算法，像 MD5 或 SHA1 ，只使用强密码哈希算法。</li>\n<li>绝不要以明文形式显示或发送密码，即使是对密码的所有者也应该这样。如果你需要 “忘记密码” 的功能，可以随机生成一个新的 一次性的（这点很重要）密码，然后把这个密码发送给用户。</li>\n</ul>\n<p><strong>只要关闭浏览器，Session就消失了</strong><br>不对。对 session 来说，除非程序通知服务器删除一个 session，否则服务器会一直保留，程序一般都是在用户做 log off 的时候发个指令去删除 session。<br>然而浏览器从来不会主动在关闭之前通知服务器它将要关闭，因此服务器根本不会有机会知道浏览器已经关闭，之所以会有这种错觉，是大部分 session 机制都使用会话 cookie 来保存 session id，而关闭浏览器后这个 session id 就消失了，再次连接服务器时也就无法找到原来的 session。如果服务器设置的 cookie 被保存在硬盘上，或者使用某种手段改写浏览器发出的 HTTP 请求头，把原来的 session id 发送给服务器，则再次打开浏览器仍然能够打开原来的 session。<br>恰恰是由于关闭浏览器不会导致 session 被删除，迫使服务器为 session 设置了一个失效时间，当距离客户端上一次使用 session 的时间超过这个失效时间时，服务器就认为客户端已经停止了活动，才会把 session 删除以节省存储空间。</p>\n<h1 id=\"分布式下Session共享方案\"><a href=\"#分布式下Session共享方案\" class=\"headerlink\" title=\"分布式下Session共享方案\"></a>分布式下Session共享方案</h1><ol>\n<li>Session复制</li>\n</ol>\n<p>任何一个服务器上的 session 发生改变（增删改），该节点会把这个 session 的所有内容序列化，然后广播给所有其它节点，不管其他服务器需不需要 session ，以此来保证 session 同步</p>\n<p>优点：可容错，各个服务器间Session能够实时响应。</p>\n<p>缺点：会对网络负荷造成一定压力，如果 session 量大的话可能会造成网络堵塞，拖慢服务器性能。</p>\n<ol>\n<li>粘性Session/IP绑定策略</li>\n</ol>\n<p>采用 Ngnix 中的 ip_hash 机制，将某个 ip的所有请求都定向到同一台服务器上，即将用户与服务器绑定。 用户第一次请求时，负载均衡器将用户的请求转发到了 A 服务器上，如果负载均衡器设置了粘性 session 的话，那么用户以后的每次请求都会转发到 A 服务器上，相当于把用户和 A 服务器粘到了一块，这就是粘性 session 机制。</p>\n<p>优点：简单，不需要对Session做任何个处理。</p>\n<p>缺点：缺乏容错性，如果当前访问的服务器发生故障，用户被转移到第二个服务器上时，他的 session 信息都将失效。</p>\n<ol start=\"3\">\n<li>Session共享（常用）</li>\n</ol>\n<ul>\n<li>使用分布式缓存方案比如 Memcached 、Redis 来缓存 session，但是要求 Memcached 或 Redis 必须是集群</li>\n<li>把 session 放到 Redis 中存储，虽然架构上变得复杂，并且需要多访问一次 Redis ，但是这种方案带来的好处也是很大的：<ul>\n<li>实现了 session 共享；</li>\n<li>可以水平扩展（增加 Redis 服务器）；</li>\n<li>服务器重启 session 不丢失（不过也要注意 session 在 Redis 中的刷新/失效机制）；</li>\n<li>不仅可以跨服务器 session 共享，甚至可以跨平台（例如网页端和 APP 端）</li>\n</ul>\n</li>\n</ul>\n<ol start=\"4\">\n<li>Session持久化</li>\n</ol>\n<p>将 session 存储到数据库中，保证 session 的持久化</p>\n<p>优点：服务器出现问题，session 不会丢失</p>\n<p>缺点：如果网站的访问量很大，把 session 存储到数据库中，会对数据库造成很大压力，还需要增加额外的开销维护数据库。</p>\n"},{"title":"Github push 发生SSL错误","_content":"\n# 问题描述\n\n`LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443`\n\n# 解决方案\n\n`git config --global http.sslBackend \"openssl\" `\n\n配置`~/.gitconfig`\n\n```\n[http]\n        sslVerify = false\n[https]\n        sslVerify = false\n```\n\n或者直接输入指令\n\n```shell\ngit config --global http.sslVerify false\ngit config --global https.sslVerify false\n```\n\n","source":"_posts/notebook/git-ssl.md","raw":"---\ntitle: Github push 发生SSL错误\ncategories:\n- Notebook\ntags:\n- git\n---\n\n# 问题描述\n\n`LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443`\n\n# 解决方案\n\n`git config --global http.sslBackend \"openssl\" `\n\n配置`~/.gitconfig`\n\n```\n[http]\n        sslVerify = false\n[https]\n        sslVerify = false\n```\n\n或者直接输入指令\n\n```shell\ngit config --global http.sslVerify false\ngit config --global https.sslVerify false\n```\n\n","slug":"notebook/git-ssl","published":1,"date":"2021-07-06T18:00:32.621Z","updated":"2021-07-07T12:23:46.856Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9801007e018oepj65he1","content":"<h1 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h1><p><code>LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443</code></p>\n<h1 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h1><p><code>git config --global http.sslBackend &quot;openssl&quot;</code></p>\n<p>配置<code>~/.gitconfig</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[http]</span><br><span class=\"line\">        sslVerify &#x3D; false</span><br><span class=\"line\">[https]</span><br><span class=\"line\">        sslVerify &#x3D; false</span><br></pre></td></tr></table></figure>\n\n<p>或者直接输入指令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global http.sslVerify false</span><br><span class=\"line\">git config --global https.sslVerify false</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h1><p><code>LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443</code></p>\n<h1 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h1><p><code>git config --global http.sslBackend &quot;openssl&quot;</code></p>\n<p>配置<code>~/.gitconfig</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[http]</span><br><span class=\"line\">        sslVerify &#x3D; false</span><br><span class=\"line\">[https]</span><br><span class=\"line\">        sslVerify &#x3D; false</span><br></pre></td></tr></table></figure>\n\n<p>或者直接输入指令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global http.sslVerify false</span><br><span class=\"line\">git config --global https.sslVerify false</span><br></pre></td></tr></table></figure>\n\n"},{"_content":"# Final 理解\n\n## 一．Final 修饰成员变量的注意事项\n\nfinal修饰成员变量，该成员变量必须在创建对象之前进行赋值，否则编译失败  \nfinal修饰成员变量，固定的不是成员变量拥有的默认值，如果固定的是默认值，那么将导致被final修饰的成员变量的值永远无法修改，只能是默认值，这也不符合语法规则  \n\n成员变量的赋值有三种实现方式：\n- 定义成员变量的时候手动赋值\n- 利用构造器对成员变量进行赋值\n- 利用set函数进行赋值（也即利用一般的方法进行赋值）\n\n**注意** \n被final修饰的成员变量，只能拥有3中所描述的赋值方法的1，2。3为什么不行？\n\n解释：如1所描述，被final修饰的成员变量必须在对象创建之前进行赋值，如果方法3可以，那么我们知道对象创建后，才能调用方法3，也就是说成员变量利用方法3进行赋值，会导致成员变量的赋值发生在对象创建之后\n\n## 二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\n\n理解：  \n被final关键字修饰的东西有一个特点，那就是一旦被修饰，那么它的值也就终生不变，可见final关键字起到了固定的作用，既然起到固定那么，你就要提前告诉final固定的是谁，如果允许被final修饰的成员变量赋值发生在对象创建之后，那么对象创建完成后final固定的值还是未可知的\n\n## 三. final修饰成员变量和final修饰局部变量的区别与联系：\n\n1. 被final修饰的成员变量与局部变量均具有：一旦赋值，该值就终身不变\n2. 被final修饰的成员变量必须要在创建对象之前进行赋值，否则会编译失败，但是局部变量可以不赋值，但是没有被赋值的局部变量不能够被使用，一旦被使用就会编译失败\n3. 综上：一旦决定使用final关键字来修饰成员变量或者局部变量，一定要做到提前赋值\n\n## 四．Final修饰成员方法：\n\n1. final修饰成员方法，该成员方法就不能被子类重写，但是仍然可以被子类继承并可以通过子类对象调用该方法\n\n## 五．Final修饰类\n\n1.final修饰类，该类便不能被其他类继承，但是该类仍然能够创建对象，并且，可以利用该对象调用该类的成员变量或者成员方法\n\n## 六．Final使用范围：\n\nFinal关键字可以修饰类，类的成员变量，类的成员方法，成员方法的局部变量，等等，\n\n但是final关键字不能用来修饰构造方法？  \n理解：  \nfinal修饰普通方法，将导致子类无法重写该方法，而构造方法本身就不能够被子类重写，故如果用final修饰，如同多此一举\n\n> Reference  \n> https://blog.csdn.net/xichengfengyulou/article/details/81155290","source":"_posts/notebook/final.md","raw":"# Final 理解\n\n## 一．Final 修饰成员变量的注意事项\n\nfinal修饰成员变量，该成员变量必须在创建对象之前进行赋值，否则编译失败  \nfinal修饰成员变量，固定的不是成员变量拥有的默认值，如果固定的是默认值，那么将导致被final修饰的成员变量的值永远无法修改，只能是默认值，这也不符合语法规则  \n\n成员变量的赋值有三种实现方式：\n- 定义成员变量的时候手动赋值\n- 利用构造器对成员变量进行赋值\n- 利用set函数进行赋值（也即利用一般的方法进行赋值）\n\n**注意** \n被final修饰的成员变量，只能拥有3中所描述的赋值方法的1，2。3为什么不行？\n\n解释：如1所描述，被final修饰的成员变量必须在对象创建之前进行赋值，如果方法3可以，那么我们知道对象创建后，才能调用方法3，也就是说成员变量利用方法3进行赋值，会导致成员变量的赋值发生在对象创建之后\n\n## 二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\n\n理解：  \n被final关键字修饰的东西有一个特点，那就是一旦被修饰，那么它的值也就终生不变，可见final关键字起到了固定的作用，既然起到固定那么，你就要提前告诉final固定的是谁，如果允许被final修饰的成员变量赋值发生在对象创建之后，那么对象创建完成后final固定的值还是未可知的\n\n## 三. final修饰成员变量和final修饰局部变量的区别与联系：\n\n1. 被final修饰的成员变量与局部变量均具有：一旦赋值，该值就终身不变\n2. 被final修饰的成员变量必须要在创建对象之前进行赋值，否则会编译失败，但是局部变量可以不赋值，但是没有被赋值的局部变量不能够被使用，一旦被使用就会编译失败\n3. 综上：一旦决定使用final关键字来修饰成员变量或者局部变量，一定要做到提前赋值\n\n## 四．Final修饰成员方法：\n\n1. final修饰成员方法，该成员方法就不能被子类重写，但是仍然可以被子类继承并可以通过子类对象调用该方法\n\n## 五．Final修饰类\n\n1.final修饰类，该类便不能被其他类继承，但是该类仍然能够创建对象，并且，可以利用该对象调用该类的成员变量或者成员方法\n\n## 六．Final使用范围：\n\nFinal关键字可以修饰类，类的成员变量，类的成员方法，成员方法的局部变量，等等，\n\n但是final关键字不能用来修饰构造方法？  \n理解：  \nfinal修饰普通方法，将导致子类无法重写该方法，而构造方法本身就不能够被子类重写，故如果用final修饰，如同多此一举\n\n> Reference  \n> https://blog.csdn.net/xichengfengyulou/article/details/81155290","slug":"notebook/final","published":1,"date":"2020-03-11T13:50:04.608Z","updated":"2020-03-11T16:10:48.039Z","title":"notebook/final","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9802007h018o2o3508dm","content":"<h1 id=\"Final-理解\"><a href=\"#Final-理解\" class=\"headerlink\" title=\"Final 理解\"></a>Final 理解</h1><h2 id=\"一．Final-修饰成员变量的注意事项\"><a href=\"#一．Final-修饰成员变量的注意事项\" class=\"headerlink\" title=\"一．Final 修饰成员变量的注意事项\"></a>一．Final 修饰成员变量的注意事项</h2><p>final修饰成员变量，该成员变量必须在创建对象之前进行赋值，否则编译失败<br>final修饰成员变量，固定的不是成员变量拥有的默认值，如果固定的是默认值，那么将导致被final修饰的成员变量的值永远无法修改，只能是默认值，这也不符合语法规则  </p>\n<p>成员变量的赋值有三种实现方式：</p>\n<ul>\n<li>定义成员变量的时候手动赋值</li>\n<li>利用构造器对成员变量进行赋值</li>\n<li>利用set函数进行赋值（也即利用一般的方法进行赋值）</li>\n</ul>\n<p><strong>注意</strong><br>被final修饰的成员变量，只能拥有3中所描述的赋值方法的1，2。3为什么不行？</p>\n<p>解释：如1所描述，被final修饰的成员变量必须在对象创建之前进行赋值，如果方法3可以，那么我们知道对象创建后，才能调用方法3，也就是说成员变量利用方法3进行赋值，会导致成员变量的赋值发生在对象创建之后</p>\n<h2 id=\"二-为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\"><a href=\"#二-为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\" class=\"headerlink\" title=\"二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\"></a>二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？</h2><p>理解：<br>被final关键字修饰的东西有一个特点，那就是一旦被修饰，那么它的值也就终生不变，可见final关键字起到了固定的作用，既然起到固定那么，你就要提前告诉final固定的是谁，如果允许被final修饰的成员变量赋值发生在对象创建之后，那么对象创建完成后final固定的值还是未可知的</p>\n<h2 id=\"三-final修饰成员变量和final修饰局部变量的区别与联系：\"><a href=\"#三-final修饰成员变量和final修饰局部变量的区别与联系：\" class=\"headerlink\" title=\"三. final修饰成员变量和final修饰局部变量的区别与联系：\"></a>三. final修饰成员变量和final修饰局部变量的区别与联系：</h2><ol>\n<li>被final修饰的成员变量与局部变量均具有：一旦赋值，该值就终身不变</li>\n<li>被final修饰的成员变量必须要在创建对象之前进行赋值，否则会编译失败，但是局部变量可以不赋值，但是没有被赋值的局部变量不能够被使用，一旦被使用就会编译失败</li>\n<li>综上：一旦决定使用final关键字来修饰成员变量或者局部变量，一定要做到提前赋值</li>\n</ol>\n<h2 id=\"四．Final修饰成员方法：\"><a href=\"#四．Final修饰成员方法：\" class=\"headerlink\" title=\"四．Final修饰成员方法：\"></a>四．Final修饰成员方法：</h2><ol>\n<li>final修饰成员方法，该成员方法就不能被子类重写，但是仍然可以被子类继承并可以通过子类对象调用该方法</li>\n</ol>\n<h2 id=\"五．Final修饰类\"><a href=\"#五．Final修饰类\" class=\"headerlink\" title=\"五．Final修饰类\"></a>五．Final修饰类</h2><p>1.final修饰类，该类便不能被其他类继承，但是该类仍然能够创建对象，并且，可以利用该对象调用该类的成员变量或者成员方法</p>\n<h2 id=\"六．Final使用范围：\"><a href=\"#六．Final使用范围：\" class=\"headerlink\" title=\"六．Final使用范围：\"></a>六．Final使用范围：</h2><p>Final关键字可以修饰类，类的成员变量，类的成员方法，成员方法的局部变量，等等，</p>\n<p>但是final关键字不能用来修饰构造方法？<br>理解：<br>final修饰普通方法，将导致子类无法重写该方法，而构造方法本身就不能够被子类重写，故如果用final修饰，如同多此一举</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpY2hlbmdmZW5neXVsb3UvYXJ0aWNsZS9kZXRhaWxzLzgxMTU1Mjkw\">https://blog.csdn.net/xichengfengyulou/article/details/81155290<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Final-理解\"><a href=\"#Final-理解\" class=\"headerlink\" title=\"Final 理解\"></a>Final 理解</h1><h2 id=\"一．Final-修饰成员变量的注意事项\"><a href=\"#一．Final-修饰成员变量的注意事项\" class=\"headerlink\" title=\"一．Final 修饰成员变量的注意事项\"></a>一．Final 修饰成员变量的注意事项</h2><p>final修饰成员变量，该成员变量必须在创建对象之前进行赋值，否则编译失败<br>final修饰成员变量，固定的不是成员变量拥有的默认值，如果固定的是默认值，那么将导致被final修饰的成员变量的值永远无法修改，只能是默认值，这也不符合语法规则  </p>\n<p>成员变量的赋值有三种实现方式：</p>\n<ul>\n<li>定义成员变量的时候手动赋值</li>\n<li>利用构造器对成员变量进行赋值</li>\n<li>利用set函数进行赋值（也即利用一般的方法进行赋值）</li>\n</ul>\n<p><strong>注意</strong><br>被final修饰的成员变量，只能拥有3中所描述的赋值方法的1，2。3为什么不行？</p>\n<p>解释：如1所描述，被final修饰的成员变量必须在对象创建之前进行赋值，如果方法3可以，那么我们知道对象创建后，才能调用方法3，也就是说成员变量利用方法3进行赋值，会导致成员变量的赋值发生在对象创建之后</p>\n<h2 id=\"二-为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\"><a href=\"#二-为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\" class=\"headerlink\" title=\"二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？\"></a>二. 为什么被Final修饰的成员变量必须在对象创建之前进行赋值？</h2><p>理解：<br>被final关键字修饰的东西有一个特点，那就是一旦被修饰，那么它的值也就终生不变，可见final关键字起到了固定的作用，既然起到固定那么，你就要提前告诉final固定的是谁，如果允许被final修饰的成员变量赋值发生在对象创建之后，那么对象创建完成后final固定的值还是未可知的</p>\n<h2 id=\"三-final修饰成员变量和final修饰局部变量的区别与联系：\"><a href=\"#三-final修饰成员变量和final修饰局部变量的区别与联系：\" class=\"headerlink\" title=\"三. final修饰成员变量和final修饰局部变量的区别与联系：\"></a>三. final修饰成员变量和final修饰局部变量的区别与联系：</h2><ol>\n<li>被final修饰的成员变量与局部变量均具有：一旦赋值，该值就终身不变</li>\n<li>被final修饰的成员变量必须要在创建对象之前进行赋值，否则会编译失败，但是局部变量可以不赋值，但是没有被赋值的局部变量不能够被使用，一旦被使用就会编译失败</li>\n<li>综上：一旦决定使用final关键字来修饰成员变量或者局部变量，一定要做到提前赋值</li>\n</ol>\n<h2 id=\"四．Final修饰成员方法：\"><a href=\"#四．Final修饰成员方法：\" class=\"headerlink\" title=\"四．Final修饰成员方法：\"></a>四．Final修饰成员方法：</h2><ol>\n<li>final修饰成员方法，该成员方法就不能被子类重写，但是仍然可以被子类继承并可以通过子类对象调用该方法</li>\n</ol>\n<h2 id=\"五．Final修饰类\"><a href=\"#五．Final修饰类\" class=\"headerlink\" title=\"五．Final修饰类\"></a>五．Final修饰类</h2><p>1.final修饰类，该类便不能被其他类继承，但是该类仍然能够创建对象，并且，可以利用该对象调用该类的成员变量或者成员方法</p>\n<h2 id=\"六．Final使用范围：\"><a href=\"#六．Final使用范围：\" class=\"headerlink\" title=\"六．Final使用范围：\"></a>六．Final使用范围：</h2><p>Final关键字可以修饰类，类的成员变量，类的成员方法，成员方法的局部变量，等等，</p>\n<p>但是final关键字不能用来修饰构造方法？<br>理解：<br>final修饰普通方法，将导致子类无法重写该方法，而构造方法本身就不能够被子类重写，故如果用final修饰，如同多此一举</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpY2hlbmdmZW5neXVsb3UvYXJ0aWNsZS9kZXRhaWxzLzgxMTU1Mjkw\">https://blog.csdn.net/xichengfengyulou/article/details/81155290<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"title":"Github慢","catagories":["Notebook"],"_content":"\n# Ubuntu上修改Hosts有问题\n\n`service networking restart`\n\n修改hosts的方法在腾讯云上不行，没有network服务？\n\n# MacOS修改Host\n\n去[DNS](http://tool.chinaz.com/dns)查找最小TTL的响应IP\n\n修改`/etc/hosts`\n\n刷新DNS缓存\n\n```\ndscacheutil -flushcache\n```\n\n# 备用方案\n\n将仓库的地址手动改为github的镜像地址再进行`clone`.\n\n`https://github.com.cnpmjs.org/`\n\n","source":"_posts/notebook/github-slow.md","raw":"---\ntitle: Github慢\ncatagories:\n- Notebook\ntags:\n- github\n---\n\n# Ubuntu上修改Hosts有问题\n\n`service networking restart`\n\n修改hosts的方法在腾讯云上不行，没有network服务？\n\n# MacOS修改Host\n\n去[DNS](http://tool.chinaz.com/dns)查找最小TTL的响应IP\n\n修改`/etc/hosts`\n\n刷新DNS缓存\n\n```\ndscacheutil -flushcache\n```\n\n# 备用方案\n\n将仓库的地址手动改为github的镜像地址再进行`clone`.\n\n`https://github.com.cnpmjs.org/`\n\n","slug":"notebook/github-slow","published":1,"date":"2021-03-09T18:20:53.407Z","updated":"2021-03-14T15:55:20.577Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9802007i018oe8pk3fbz","content":"<h1 id=\"Ubuntu上修改Hosts有问题\"><a href=\"#Ubuntu上修改Hosts有问题\" class=\"headerlink\" title=\"Ubuntu上修改Hosts有问题\"></a>Ubuntu上修改Hosts有问题</h1><p><code>service networking restart</code></p>\n<p>修改hosts的方法在腾讯云上不行，没有network服务？</p>\n<h1 id=\"MacOS修改Host\"><a href=\"#MacOS修改Host\" class=\"headerlink\" title=\"MacOS修改Host\"></a>MacOS修改Host</h1><p>去<span class=\"exturl\" data-url=\"aHR0cDovL3Rvb2wuY2hpbmF6LmNvbS9kbnM=\">DNS<i class=\"fa fa-external-link-alt\"></i></span>查找最小TTL的响应IP</p>\n<p>修改<code>/etc/hosts</code></p>\n<p>刷新DNS缓存</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dscacheutil -flushcache</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"备用方案\"><a href=\"#备用方案\" class=\"headerlink\" title=\"备用方案\"></a>备用方案</h1><p>将仓库的地址手动改为github的镜像地址再进行<code>clone</code>.</p>\n<p><code>https://github.com.cnpmjs.org/</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Ubuntu上修改Hosts有问题\"><a href=\"#Ubuntu上修改Hosts有问题\" class=\"headerlink\" title=\"Ubuntu上修改Hosts有问题\"></a>Ubuntu上修改Hosts有问题</h1><p><code>service networking restart</code></p>\n<p>修改hosts的方法在腾讯云上不行，没有network服务？</p>\n<h1 id=\"MacOS修改Host\"><a href=\"#MacOS修改Host\" class=\"headerlink\" title=\"MacOS修改Host\"></a>MacOS修改Host</h1><p>去<span class=\"exturl\" data-url=\"aHR0cDovL3Rvb2wuY2hpbmF6LmNvbS9kbnM=\">DNS<i class=\"fa fa-external-link-alt\"></i></span>查找最小TTL的响应IP</p>\n<p>修改<code>/etc/hosts</code></p>\n<p>刷新DNS缓存</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dscacheutil -flushcache</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"备用方案\"><a href=\"#备用方案\" class=\"headerlink\" title=\"备用方案\"></a>备用方案</h1><p>将仓库的地址手动改为github的镜像地址再进行<code>clone</code>.</p>\n<p><code>https://github.com.cnpmjs.org/</code></p>\n"},{"title":"gitignore不起作用","catagories":["Notebook"],"_content":"\n# 原因\n\n如果项目不是在一开始添加了`.gitignore`文件来管理仓库的忽略规则的话，就会出现不起作用的情况。\n\n# 解决\n\n1. 清除本地当前的Git缓存\n\n```\ngit rm -r --cached .\n```\n\n2. 应用.gitignore等本地配置文件重新建立Git索引\n\n```\ngit add .\n```\n\n3. 提交当前Git版本\n\n```\ngit cm -m 'update'\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/334908553","source":"_posts/notebook/gitignore.md","raw":"---\ntitle: gitignore不起作用\ncatagories:\n- Notebook\ntags:\n- git\n---\n\n# 原因\n\n如果项目不是在一开始添加了`.gitignore`文件来管理仓库的忽略规则的话，就会出现不起作用的情况。\n\n# 解决\n\n1. 清除本地当前的Git缓存\n\n```\ngit rm -r --cached .\n```\n\n2. 应用.gitignore等本地配置文件重新建立Git索引\n\n```\ngit add .\n```\n\n3. 提交当前Git版本\n\n```\ngit cm -m 'update'\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/334908553","slug":"notebook/gitignore","published":1,"date":"2021-03-27T13:08:41.335Z","updated":"2021-03-27T13:12:57.299Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9804007k018o0iengjlq","content":"<h1 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h1><p>如果项目不是在一开始添加了<code>.gitignore</code>文件来管理仓库的忽略规则的话，就会出现不起作用的情况。</p>\n<h1 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h1><ol>\n<li>清除本地当前的Git缓存</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rm -r --cached .</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>应用.gitignore等本地配置文件重新建立Git索引</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>提交当前Git版本</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git cm -m &#39;update&#39;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMzQ5MDg1NTM=\">https://zhuanlan.zhihu.com/p/334908553<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h1><p>如果项目不是在一开始添加了<code>.gitignore</code>文件来管理仓库的忽略规则的话，就会出现不起作用的情况。</p>\n<h1 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h1><ol>\n<li>清除本地当前的Git缓存</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rm -r --cached .</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>应用.gitignore等本地配置文件重新建立Git索引</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>提交当前Git版本</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git cm -m &#39;update&#39;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMzQ5MDg1NTM=\">https://zhuanlan.zhihu.com/p/334908553<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# gRPC入门\n\n## 下载依赖\n\n`pip install grpc`  \n`pip install proto`  \n`pip install grpc-tools`  \n\n## 设置接口\n在.proto文件中定义接口\n\n## 生成文件\n`python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. api.proto`\n\n## proto示例\n```proto\nsyntax = \"proto3\";\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n  // Sends another greeting\n  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n```\n\n## server示例\n```py\nclass Greeter(api_pb2_grpc.GreeterServicer):\n\n    def SayHello(self, request, context):\n        return api_pb2.HelloReply(message='Hello, %s!' % request.name)\n\n    def SayHelloAgain(self, request, context):\n        return api_pb2.HelloReply(message='Hello again, %s!' % request.name)\n\n\ndef serve():\n    server = grpc.server(futures.ThreadPoolExecutor(max_workers=4))\n    api_pb2_grpc.add_GreeterServicer_to_server(Greeter(), server)\n    server.add_insecure_port('localhost:50051')\n    server.start()\n    try:\n        while True:\n            time.sleep(60 * 60 * 24)\n    except KeyboardInterrupt:\n        server.stop(0)\n\n\nif __name__ == '__main__':\n    serve()\n\n```\n\n## client示例\n```py\ndef run():\n  channel = grpc.insecure_channel('localhost:50051')\n  stub = api_pb2_grpc.GreeterStub(channel)\n  response = stub.SayHello(api_pb2.HelloRequest(name='you'))\n  print(\"Greeter client received: \" + response.message)\n  response = stub.SayHelloAgain(api_pb2.HelloRequest(name='you'))\n  print(\"Greeter client received: \" + response.message)\n\n\nif __name__ == '__main__':\n    run()\n```","source":"_posts/notebook/grpc.md","raw":"# gRPC入门\n\n## 下载依赖\n\n`pip install grpc`  \n`pip install proto`  \n`pip install grpc-tools`  \n\n## 设置接口\n在.proto文件中定义接口\n\n## 生成文件\n`python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. api.proto`\n\n## proto示例\n```proto\nsyntax = \"proto3\";\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n  // Sends another greeting\n  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n```\n\n## server示例\n```py\nclass Greeter(api_pb2_grpc.GreeterServicer):\n\n    def SayHello(self, request, context):\n        return api_pb2.HelloReply(message='Hello, %s!' % request.name)\n\n    def SayHelloAgain(self, request, context):\n        return api_pb2.HelloReply(message='Hello again, %s!' % request.name)\n\n\ndef serve():\n    server = grpc.server(futures.ThreadPoolExecutor(max_workers=4))\n    api_pb2_grpc.add_GreeterServicer_to_server(Greeter(), server)\n    server.add_insecure_port('localhost:50051')\n    server.start()\n    try:\n        while True:\n            time.sleep(60 * 60 * 24)\n    except KeyboardInterrupt:\n        server.stop(0)\n\n\nif __name__ == '__main__':\n    serve()\n\n```\n\n## client示例\n```py\ndef run():\n  channel = grpc.insecure_channel('localhost:50051')\n  stub = api_pb2_grpc.GreeterStub(channel)\n  response = stub.SayHello(api_pb2.HelloRequest(name='you'))\n  print(\"Greeter client received: \" + response.message)\n  response = stub.SayHelloAgain(api_pb2.HelloRequest(name='you'))\n  print(\"Greeter client received: \" + response.message)\n\n\nif __name__ == '__main__':\n    run()\n```","slug":"notebook/grpc","published":1,"date":"2020-07-14T15:31:04.198Z","updated":"2020-07-14T15:31:04.198Z","title":"notebook/grpc","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9805007n018oexuu8e4g","content":"<h1 id=\"gRPC入门\"><a href=\"#gRPC入门\" class=\"headerlink\" title=\"gRPC入门\"></a>gRPC入门</h1><h2 id=\"下载依赖\"><a href=\"#下载依赖\" class=\"headerlink\" title=\"下载依赖\"></a>下载依赖</h2><p><code>pip install grpc</code><br><code>pip install proto</code><br><code>pip install grpc-tools</code>  </p>\n<h2 id=\"设置接口\"><a href=\"#设置接口\" class=\"headerlink\" title=\"设置接口\"></a>设置接口</h2><p>在.proto文件中定义接口</p>\n<h2 id=\"生成文件\"><a href=\"#生成文件\" class=\"headerlink\" title=\"生成文件\"></a>生成文件</h2><p><code>python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. api.proto</code></p>\n<h2 id=\"proto示例\"><a href=\"#proto示例\" class=\"headerlink\" title=\"proto示例\"></a>proto示例</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax &#x3D; &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The greeting service definition.</span><br><span class=\"line\">service Greeter &#123;</span><br><span class=\"line\">  &#x2F;&#x2F; Sends a greeting</span><br><span class=\"line\">  rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125;</span><br><span class=\"line\">  &#x2F;&#x2F; Sends another greeting</span><br><span class=\"line\">  rpc SayHelloAgain (HelloRequest) returns (HelloReply) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The request message containing the user&#39;s name.</span><br><span class=\"line\">message HelloRequest &#123;</span><br><span class=\"line\">  string name &#x3D; 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The response message containing the greetings</span><br><span class=\"line\">message HelloReply &#123;</span><br><span class=\"line\">  string message &#x3D; 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"server示例\"><a href=\"#server示例\" class=\"headerlink\" title=\"server示例\"></a>server示例</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Greeter</span><span class=\"params\">(api_pb2_grpc.GreeterServicer)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">SayHello</span><span class=\"params\">(self, request, context)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> api_pb2.HelloReply(message=<span class=\"string\">'Hello, %s!'</span> % request.name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">SayHelloAgain</span><span class=\"params\">(self, request, context)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> api_pb2.HelloReply(message=<span class=\"string\">'Hello again, %s!'</span> % request.name)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">serve</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    server = grpc.server(futures.ThreadPoolExecutor(max_workers=<span class=\"number\">4</span>))</span><br><span class=\"line\">    api_pb2_grpc.add_GreeterServicer_to_server(Greeter(), server)</span><br><span class=\"line\">    server.add_insecure_port(<span class=\"string\">'localhost:50051'</span>)</span><br><span class=\"line\">    server.start()</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">            time.sleep(<span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> KeyboardInterrupt:</span><br><span class=\"line\">        server.stop(<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    serve()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"client示例\"><a href=\"#client示例\" class=\"headerlink\" title=\"client示例\"></a>client示例</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  channel = grpc.insecure_channel(<span class=\"string\">'localhost:50051'</span>)</span><br><span class=\"line\">  stub = api_pb2_grpc.GreeterStub(channel)</span><br><span class=\"line\">  response = stub.SayHello(api_pb2.HelloRequest(name=<span class=\"string\">'you'</span>))</span><br><span class=\"line\">  print(<span class=\"string\">\"Greeter client received: \"</span> + response.message)</span><br><span class=\"line\">  response = stub.SayHelloAgain(api_pb2.HelloRequest(name=<span class=\"string\">'you'</span>))</span><br><span class=\"line\">  print(<span class=\"string\">\"Greeter client received: \"</span> + response.message)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    run()</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"gRPC入门\"><a href=\"#gRPC入门\" class=\"headerlink\" title=\"gRPC入门\"></a>gRPC入门</h1><h2 id=\"下载依赖\"><a href=\"#下载依赖\" class=\"headerlink\" title=\"下载依赖\"></a>下载依赖</h2><p><code>pip install grpc</code><br><code>pip install proto</code><br><code>pip install grpc-tools</code>  </p>\n<h2 id=\"设置接口\"><a href=\"#设置接口\" class=\"headerlink\" title=\"设置接口\"></a>设置接口</h2><p>在.proto文件中定义接口</p>\n<h2 id=\"生成文件\"><a href=\"#生成文件\" class=\"headerlink\" title=\"生成文件\"></a>生成文件</h2><p><code>python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. api.proto</code></p>\n<h2 id=\"proto示例\"><a href=\"#proto示例\" class=\"headerlink\" title=\"proto示例\"></a>proto示例</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syntax &#x3D; &quot;proto3&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The greeting service definition.</span><br><span class=\"line\">service Greeter &#123;</span><br><span class=\"line\">  &#x2F;&#x2F; Sends a greeting</span><br><span class=\"line\">  rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125;</span><br><span class=\"line\">  &#x2F;&#x2F; Sends another greeting</span><br><span class=\"line\">  rpc SayHelloAgain (HelloRequest) returns (HelloReply) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The request message containing the user&#39;s name.</span><br><span class=\"line\">message HelloRequest &#123;</span><br><span class=\"line\">  string name &#x3D; 1;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; The response message containing the greetings</span><br><span class=\"line\">message HelloReply &#123;</span><br><span class=\"line\">  string message &#x3D; 1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"server示例\"><a href=\"#server示例\" class=\"headerlink\" title=\"server示例\"></a>server示例</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Greeter</span><span class=\"params\">(api_pb2_grpc.GreeterServicer)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">SayHello</span><span class=\"params\">(self, request, context)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> api_pb2.HelloReply(message=<span class=\"string\">'Hello, %s!'</span> % request.name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">SayHelloAgain</span><span class=\"params\">(self, request, context)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> api_pb2.HelloReply(message=<span class=\"string\">'Hello again, %s!'</span> % request.name)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">serve</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    server = grpc.server(futures.ThreadPoolExecutor(max_workers=<span class=\"number\">4</span>))</span><br><span class=\"line\">    api_pb2_grpc.add_GreeterServicer_to_server(Greeter(), server)</span><br><span class=\"line\">    server.add_insecure_port(<span class=\"string\">'localhost:50051'</span>)</span><br><span class=\"line\">    server.start()</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">            time.sleep(<span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> KeyboardInterrupt:</span><br><span class=\"line\">        server.stop(<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    serve()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"client示例\"><a href=\"#client示例\" class=\"headerlink\" title=\"client示例\"></a>client示例</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  channel = grpc.insecure_channel(<span class=\"string\">'localhost:50051'</span>)</span><br><span class=\"line\">  stub = api_pb2_grpc.GreeterStub(channel)</span><br><span class=\"line\">  response = stub.SayHello(api_pb2.HelloRequest(name=<span class=\"string\">'you'</span>))</span><br><span class=\"line\">  print(<span class=\"string\">\"Greeter client received: \"</span> + response.message)</span><br><span class=\"line\">  response = stub.SayHelloAgain(api_pb2.HelloRequest(name=<span class=\"string\">'you'</span>))</span><br><span class=\"line\">  print(<span class=\"string\">\"Greeter client received: \"</span> + response.message)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    run()</span><br></pre></td></tr></table></figure>"},{"title":"Git日常使用笔记","_content":"\n![img](https://upload-images.jianshu.io/upload_images/8048507-9ea56a58f75ebc00.png?imageMogr2/auto-orient/strip|imageView2/2/w/617/format/webp)\n\n## reset\n`git reset [--soft | --mixed | --hard] [HEAD]`\n\n`--soft`  \n修改版本库，保留暂存区，保留工作区。头指针全部重置到指定版本，也会重置暂存区，并且会将工作区代码也回退到这个版本。\n\n`--hard`  \n修改版本库，修改暂存区，修改工作区。头指针全部重置到指定版本，且将这次提交之后的所有变更都移动到暂存区。\n\nTips:  \n使用`git reset --hard HEAD`移除当前暂存区及工作区所有的修改。\n\n\n## tag\n给当前commit打标签。\n`git tag v1.0`\n\n删除标签\n`git tag -d v1.0`\n\n显示标签修改内容\n`git show v1.0`\n\n## log\n查看最近提交的文件差异，最近两篇。  \n`git log -p -2`\n\n## clean\n用于删除Untracked file, 常与`git reset --hard`一起使用，完全回复到指定commit。  \n`git clean -df`d为文件夹，f为文件。\n\n","source":"_posts/notebook/git.md","raw":"---\ntitle: Git日常使用笔记\ncategories:\n- Notebook\ntags:\n- git\n---\n\n![img](https://upload-images.jianshu.io/upload_images/8048507-9ea56a58f75ebc00.png?imageMogr2/auto-orient/strip|imageView2/2/w/617/format/webp)\n\n## reset\n`git reset [--soft | --mixed | --hard] [HEAD]`\n\n`--soft`  \n修改版本库，保留暂存区，保留工作区。头指针全部重置到指定版本，也会重置暂存区，并且会将工作区代码也回退到这个版本。\n\n`--hard`  \n修改版本库，修改暂存区，修改工作区。头指针全部重置到指定版本，且将这次提交之后的所有变更都移动到暂存区。\n\nTips:  \n使用`git reset --hard HEAD`移除当前暂存区及工作区所有的修改。\n\n\n## tag\n给当前commit打标签。\n`git tag v1.0`\n\n删除标签\n`git tag -d v1.0`\n\n显示标签修改内容\n`git show v1.0`\n\n## log\n查看最近提交的文件差异，最近两篇。  \n`git log -p -2`\n\n## clean\n用于删除Untracked file, 常与`git reset --hard`一起使用，完全回复到指定commit。  \n`git clean -df`d为文件夹，f为文件。\n\n","slug":"notebook/git","published":1,"date":"2020-11-15T16:58:51.925Z","updated":"2020-11-15T17:39:25.569Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9806007q018o6wuw7trb","content":"<p><img src=\"https://upload-images.jianshu.io/upload_images/8048507-9ea56a58f75ebc00.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/617/format/webp\" alt=\"img\"></p>\n<h2 id=\"reset\"><a href=\"#reset\" class=\"headerlink\" title=\"reset\"></a>reset</h2><p><code>git reset [--soft | --mixed | --hard] [HEAD]</code></p>\n<p><code>--soft</code><br>修改版本库，保留暂存区，保留工作区。头指针全部重置到指定版本，也会重置暂存区，并且会将工作区代码也回退到这个版本。</p>\n<p><code>--hard</code><br>修改版本库，修改暂存区，修改工作区。头指针全部重置到指定版本，且将这次提交之后的所有变更都移动到暂存区。</p>\n<p>Tips:<br>使用<code>git reset --hard HEAD</code>移除当前暂存区及工作区所有的修改。</p>\n<h2 id=\"tag\"><a href=\"#tag\" class=\"headerlink\" title=\"tag\"></a>tag</h2><p>给当前commit打标签。<br><code>git tag v1.0</code></p>\n<p>删除标签<br><code>git tag -d v1.0</code></p>\n<p>显示标签修改内容<br><code>git show v1.0</code></p>\n<h2 id=\"log\"><a href=\"#log\" class=\"headerlink\" title=\"log\"></a>log</h2><p>查看最近提交的文件差异，最近两篇。<br><code>git log -p -2</code></p>\n<h2 id=\"clean\"><a href=\"#clean\" class=\"headerlink\" title=\"clean\"></a>clean</h2><p>用于删除Untracked file, 常与<code>git reset --hard</code>一起使用，完全回复到指定commit。<br><code>git clean -df</code>d为文件夹，f为文件。</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"https://upload-images.jianshu.io/upload_images/8048507-9ea56a58f75ebc00.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/617/format/webp\" alt=\"img\"></p>\n<h2 id=\"reset\"><a href=\"#reset\" class=\"headerlink\" title=\"reset\"></a>reset</h2><p><code>git reset [--soft | --mixed | --hard] [HEAD]</code></p>\n<p><code>--soft</code><br>修改版本库，保留暂存区，保留工作区。头指针全部重置到指定版本，也会重置暂存区，并且会将工作区代码也回退到这个版本。</p>\n<p><code>--hard</code><br>修改版本库，修改暂存区，修改工作区。头指针全部重置到指定版本，且将这次提交之后的所有变更都移动到暂存区。</p>\n<p>Tips:<br>使用<code>git reset --hard HEAD</code>移除当前暂存区及工作区所有的修改。</p>\n<h2 id=\"tag\"><a href=\"#tag\" class=\"headerlink\" title=\"tag\"></a>tag</h2><p>给当前commit打标签。<br><code>git tag v1.0</code></p>\n<p>删除标签<br><code>git tag -d v1.0</code></p>\n<p>显示标签修改内容<br><code>git show v1.0</code></p>\n<h2 id=\"log\"><a href=\"#log\" class=\"headerlink\" title=\"log\"></a>log</h2><p>查看最近提交的文件差异，最近两篇。<br><code>git log -p -2</code></p>\n<h2 id=\"clean\"><a href=\"#clean\" class=\"headerlink\" title=\"clean\"></a>clean</h2><p>用于删除Untracked file, 常与<code>git reset --hard</code>一起使用，完全回复到指定commit。<br><code>git clean -df</code>d为文件夹，f为文件。</p>\n"},{"title":"Flask入门","_content":"\n## Flask模块化管理\nBluepoint可以实现Flask的模块化管理，在每个包的`__init__`文件中可以定义对应的蓝图。蓝图仅是静态的，需要在应用运行时，对其进行装载。\n\n**注意**\n1. `__init__`文件中定义好蓝图后一定要将包含路由的文件import进来，否则不能识别相应的路由。\n2. import文件时不能使用通配符*进行导入。\n\n## Flask中的request与respond\n\n### request\n`from flask import request`\n\n1. param传参\n使用request.args.get('argname')获取键值对。\n\n2. body传参\n使用request.form.get('argname')获取form格式传参键值对。\n使用request.get_data()获取全部raw格式内容。\n使用request.get_json()获取全部raw格式内容，且必须为json格式。\n\n**注意**\nform-data: 可以传键值对和文件。\nx-www-form-urlencodes: 只能传键值对。\n\n### respond\n`from flask import jsoniify`\n`import json`\n\n1. 直接返回json\n- jsonify()可以直接制作json返回 (返回的格式也定义为application/json)\n- json.dumps()可以将dict生成json (返回的格式默认为text)\n\n2. 简易定义make_respond\n\n| args | 含义 |  \n| - | - |  \n| `respond` | 返回的内容data |  \n| `status_code` | 返回状态码 |  \n| `headers` | 返回头部信息为键值对 |  \n\n3. 详细定义Respond\n\n| args | 含义 |  \n| - | - |  \n| `respond` | 返回的内容data |  \n| `status` | 返回状态 格式为'200 OK' |  \n| `status_code` | 返回状态码 |  \n| `headers` | 返回头部信息为键值对 |  \n| `set_cookie` | 设置cookie |  \n| `del_cookie` | 删除cookie |  \n\n## Flask中的session\n`from flask import session`\n\n1. 使用session需要设置config  \napp.config['SECRET_KEY']=os.urandom(24)\n\n2. Flask提供的session是储存在cookie中的  \nsession['username'] = data['username']  \n此时的cookie中存储了加密过的username。\n\n3. 获取session  \nsession.get('key')或session['key']  \n但是后者如果没有这个key会报错。  \n获取到的session自动经过了解密。\n\n4. 删除session  \nsession.pop('key')或session['key']=False  \nsession.clear清除session中所有数据。\n\n## Flask_SQLAlechemy\n**注意**\n1. 如果蓝图中有用到db，则一定要在db创建后import蓝图！！！\n```py\ndb = SQLAlchemy()\n\ndef create_app():\n    app = Flask(__name__)\n    app.config['SECRET_KEY'] = os.urandom(24)\n    app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://library:library@119.23.107.61:3306/library'\n    app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = True\n    db.init_app(app)\n    from .user import user_blu\n    app.register_blueprint(user_blu)\n    print(app.url_map)\n    return app\n```\n因为代码是按照顺序执行的，当你从其他模块导入蓝图的时候就需要 db 了，但是这个时候db 还没有生成，所以会报出错误 提示不可以从当中导入相应的模块。\n\n2. 如果db=SQLAlechemy()中没有传app，则后面需要先`db.app=app`然后再`db.init_app(app)`???\n\n## Flask g\n\n1. g对象\n- 专门用来存储用户信息\n- g只在一次请求中的所有代码有用\n\n2. g与session的区别\n- session只要未失效，不同的request请求都可以获得session，由cookie决定\n- 每一次请求都会改变g对象","source":"_posts/notebook/flask-start.md","raw":"---\ntitle: Flask入门\ncategories:\n- Notebook\ntags:\n- python\n- flask\n---\n\n## Flask模块化管理\nBluepoint可以实现Flask的模块化管理，在每个包的`__init__`文件中可以定义对应的蓝图。蓝图仅是静态的，需要在应用运行时，对其进行装载。\n\n**注意**\n1. `__init__`文件中定义好蓝图后一定要将包含路由的文件import进来，否则不能识别相应的路由。\n2. import文件时不能使用通配符*进行导入。\n\n## Flask中的request与respond\n\n### request\n`from flask import request`\n\n1. param传参\n使用request.args.get('argname')获取键值对。\n\n2. body传参\n使用request.form.get('argname')获取form格式传参键值对。\n使用request.get_data()获取全部raw格式内容。\n使用request.get_json()获取全部raw格式内容，且必须为json格式。\n\n**注意**\nform-data: 可以传键值对和文件。\nx-www-form-urlencodes: 只能传键值对。\n\n### respond\n`from flask import jsoniify`\n`import json`\n\n1. 直接返回json\n- jsonify()可以直接制作json返回 (返回的格式也定义为application/json)\n- json.dumps()可以将dict生成json (返回的格式默认为text)\n\n2. 简易定义make_respond\n\n| args | 含义 |  \n| - | - |  \n| `respond` | 返回的内容data |  \n| `status_code` | 返回状态码 |  \n| `headers` | 返回头部信息为键值对 |  \n\n3. 详细定义Respond\n\n| args | 含义 |  \n| - | - |  \n| `respond` | 返回的内容data |  \n| `status` | 返回状态 格式为'200 OK' |  \n| `status_code` | 返回状态码 |  \n| `headers` | 返回头部信息为键值对 |  \n| `set_cookie` | 设置cookie |  \n| `del_cookie` | 删除cookie |  \n\n## Flask中的session\n`from flask import session`\n\n1. 使用session需要设置config  \napp.config['SECRET_KEY']=os.urandom(24)\n\n2. Flask提供的session是储存在cookie中的  \nsession['username'] = data['username']  \n此时的cookie中存储了加密过的username。\n\n3. 获取session  \nsession.get('key')或session['key']  \n但是后者如果没有这个key会报错。  \n获取到的session自动经过了解密。\n\n4. 删除session  \nsession.pop('key')或session['key']=False  \nsession.clear清除session中所有数据。\n\n## Flask_SQLAlechemy\n**注意**\n1. 如果蓝图中有用到db，则一定要在db创建后import蓝图！！！\n```py\ndb = SQLAlchemy()\n\ndef create_app():\n    app = Flask(__name__)\n    app.config['SECRET_KEY'] = os.urandom(24)\n    app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://library:library@119.23.107.61:3306/library'\n    app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = True\n    db.init_app(app)\n    from .user import user_blu\n    app.register_blueprint(user_blu)\n    print(app.url_map)\n    return app\n```\n因为代码是按照顺序执行的，当你从其他模块导入蓝图的时候就需要 db 了，但是这个时候db 还没有生成，所以会报出错误 提示不可以从当中导入相应的模块。\n\n2. 如果db=SQLAlechemy()中没有传app，则后面需要先`db.app=app`然后再`db.init_app(app)`???\n\n## Flask g\n\n1. g对象\n- 专门用来存储用户信息\n- g只在一次请求中的所有代码有用\n\n2. g与session的区别\n- session只要未失效，不同的request请求都可以获得session，由cookie决定\n- 每一次请求都会改变g对象","slug":"notebook/flask-start","published":1,"date":"2020-12-28T16:14:51.755Z","updated":"2020-12-30T15:22:15.178Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9806007r018o0dzkbwcv","content":"<h2 id=\"Flask模块化管理\"><a href=\"#Flask模块化管理\" class=\"headerlink\" title=\"Flask模块化管理\"></a>Flask模块化管理</h2><p>Bluepoint可以实现Flask的模块化管理，在每个包的<code>__init__</code>文件中可以定义对应的蓝图。蓝图仅是静态的，需要在应用运行时，对其进行装载。</p>\n<p><strong>注意</strong></p>\n<ol>\n<li><code>__init__</code>文件中定义好蓝图后一定要将包含路由的文件import进来，否则不能识别相应的路由。</li>\n<li>import文件时不能使用通配符*进行导入。</li>\n</ol>\n<h2 id=\"Flask中的request与respond\"><a href=\"#Flask中的request与respond\" class=\"headerlink\" title=\"Flask中的request与respond\"></a>Flask中的request与respond</h2><h3 id=\"request\"><a href=\"#request\" class=\"headerlink\" title=\"request\"></a>request</h3><p><code>from flask import request</code></p>\n<ol>\n<li><p>param传参<br>使用request.args.get(‘argname’)获取键值对。</p>\n</li>\n<li><p>body传参<br>使用request.form.get(‘argname’)获取form格式传参键值对。<br>使用request.get_data()获取全部raw格式内容。<br>使用request.get_json()获取全部raw格式内容，且必须为json格式。</p>\n</li>\n</ol>\n<p><strong>注意</strong><br>form-data: 可以传键值对和文件。<br>x-www-form-urlencodes: 只能传键值对。</p>\n<h3 id=\"respond\"><a href=\"#respond\" class=\"headerlink\" title=\"respond\"></a>respond</h3><p><code>from flask import jsoniify</code><br><code>import json</code></p>\n<ol>\n<li>直接返回json</li>\n</ol>\n<ul>\n<li>jsonify()可以直接制作json返回 (返回的格式也定义为application/json)</li>\n<li>json.dumps()可以将dict生成json (返回的格式默认为text)</li>\n</ul>\n<ol start=\"2\">\n<li>简易定义make_respond</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>args</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>respond</code></td>\n<td>返回的内容data</td>\n</tr>\n<tr>\n<td><code>status_code</code></td>\n<td>返回状态码</td>\n</tr>\n<tr>\n<td><code>headers</code></td>\n<td>返回头部信息为键值对</td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>详细定义Respond</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>args</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>respond</code></td>\n<td>返回的内容data</td>\n</tr>\n<tr>\n<td><code>status</code></td>\n<td>返回状态 格式为’200 OK’</td>\n</tr>\n<tr>\n<td><code>status_code</code></td>\n<td>返回状态码</td>\n</tr>\n<tr>\n<td><code>headers</code></td>\n<td>返回头部信息为键值对</td>\n</tr>\n<tr>\n<td><code>set_cookie</code></td>\n<td>设置cookie</td>\n</tr>\n<tr>\n<td><code>del_cookie</code></td>\n<td>删除cookie</td>\n</tr>\n</tbody></table>\n<h2 id=\"Flask中的session\"><a href=\"#Flask中的session\" class=\"headerlink\" title=\"Flask中的session\"></a>Flask中的session</h2><p><code>from flask import session</code></p>\n<ol>\n<li><p>使用session需要设置config<br>app.config[‘SECRET_KEY’]=os.urandom(24)</p>\n</li>\n<li><p>Flask提供的session是储存在cookie中的<br>session[‘username’] = data[‘username’]<br>此时的cookie中存储了加密过的username。</p>\n</li>\n<li><p>获取session<br>session.get(‘key’)或session[‘key’]<br>但是后者如果没有这个key会报错。<br>获取到的session自动经过了解密。</p>\n</li>\n<li><p>删除session<br>session.pop(‘key’)或session[‘key’]=False<br>session.clear清除session中所有数据。</p>\n</li>\n</ol>\n<h2 id=\"Flask-SQLAlechemy\"><a href=\"#Flask-SQLAlechemy\" class=\"headerlink\" title=\"Flask_SQLAlechemy\"></a>Flask_SQLAlechemy</h2><p><strong>注意</strong></p>\n<ol>\n<li><p>如果蓝图中有用到db，则一定要在db创建后import蓝图！！！</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db = SQLAlchemy()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_app</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    app = Flask(__name__)</span><br><span class=\"line\">    app.config[<span class=\"string\">'SECRET_KEY'</span>] = os.urandom(<span class=\"number\">24</span>)</span><br><span class=\"line\">    app.config[<span class=\"string\">'SQLALCHEMY_DATABASE_URI'</span>] = <span class=\"string\">'mysql+pymysql://library:library@119.23.107.61:3306/library'</span></span><br><span class=\"line\">    app.config[<span class=\"string\">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">    db.init_app(app)</span><br><span class=\"line\">    <span class=\"keyword\">from</span> .user <span class=\"keyword\">import</span> user_blu</span><br><span class=\"line\">    app.register_blueprint(user_blu)</span><br><span class=\"line\">    print(app.url_map)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> app</span><br></pre></td></tr></table></figure>\n<p>因为代码是按照顺序执行的，当你从其他模块导入蓝图的时候就需要 db 了，但是这个时候db 还没有生成，所以会报出错误 提示不可以从当中导入相应的模块。</p>\n</li>\n<li><p>如果db=SQLAlechemy()中没有传app，则后面需要先<code>db.app=app</code>然后再<code>db.init_app(app)</code>???</p>\n</li>\n</ol>\n<h2 id=\"Flask-g\"><a href=\"#Flask-g\" class=\"headerlink\" title=\"Flask g\"></a>Flask g</h2><ol>\n<li>g对象</li>\n</ol>\n<ul>\n<li>专门用来存储用户信息</li>\n<li>g只在一次请求中的所有代码有用</li>\n</ul>\n<ol start=\"2\">\n<li>g与session的区别</li>\n</ol>\n<ul>\n<li>session只要未失效，不同的request请求都可以获得session，由cookie决定</li>\n<li>每一次请求都会改变g对象</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Flask模块化管理\"><a href=\"#Flask模块化管理\" class=\"headerlink\" title=\"Flask模块化管理\"></a>Flask模块化管理</h2><p>Bluepoint可以实现Flask的模块化管理，在每个包的<code>__init__</code>文件中可以定义对应的蓝图。蓝图仅是静态的，需要在应用运行时，对其进行装载。</p>\n<p><strong>注意</strong></p>\n<ol>\n<li><code>__init__</code>文件中定义好蓝图后一定要将包含路由的文件import进来，否则不能识别相应的路由。</li>\n<li>import文件时不能使用通配符*进行导入。</li>\n</ol>\n<h2 id=\"Flask中的request与respond\"><a href=\"#Flask中的request与respond\" class=\"headerlink\" title=\"Flask中的request与respond\"></a>Flask中的request与respond</h2><h3 id=\"request\"><a href=\"#request\" class=\"headerlink\" title=\"request\"></a>request</h3><p><code>from flask import request</code></p>\n<ol>\n<li><p>param传参<br>使用request.args.get(‘argname’)获取键值对。</p>\n</li>\n<li><p>body传参<br>使用request.form.get(‘argname’)获取form格式传参键值对。<br>使用request.get_data()获取全部raw格式内容。<br>使用request.get_json()获取全部raw格式内容，且必须为json格式。</p>\n</li>\n</ol>\n<p><strong>注意</strong><br>form-data: 可以传键值对和文件。<br>x-www-form-urlencodes: 只能传键值对。</p>\n<h3 id=\"respond\"><a href=\"#respond\" class=\"headerlink\" title=\"respond\"></a>respond</h3><p><code>from flask import jsoniify</code><br><code>import json</code></p>\n<ol>\n<li>直接返回json</li>\n</ol>\n<ul>\n<li>jsonify()可以直接制作json返回 (返回的格式也定义为application/json)</li>\n<li>json.dumps()可以将dict生成json (返回的格式默认为text)</li>\n</ul>\n<ol start=\"2\">\n<li>简易定义make_respond</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>args</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>respond</code></td>\n<td>返回的内容data</td>\n</tr>\n<tr>\n<td><code>status_code</code></td>\n<td>返回状态码</td>\n</tr>\n<tr>\n<td><code>headers</code></td>\n<td>返回头部信息为键值对</td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>详细定义Respond</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>args</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>respond</code></td>\n<td>返回的内容data</td>\n</tr>\n<tr>\n<td><code>status</code></td>\n<td>返回状态 格式为’200 OK’</td>\n</tr>\n<tr>\n<td><code>status_code</code></td>\n<td>返回状态码</td>\n</tr>\n<tr>\n<td><code>headers</code></td>\n<td>返回头部信息为键值对</td>\n</tr>\n<tr>\n<td><code>set_cookie</code></td>\n<td>设置cookie</td>\n</tr>\n<tr>\n<td><code>del_cookie</code></td>\n<td>删除cookie</td>\n</tr>\n</tbody></table>\n<h2 id=\"Flask中的session\"><a href=\"#Flask中的session\" class=\"headerlink\" title=\"Flask中的session\"></a>Flask中的session</h2><p><code>from flask import session</code></p>\n<ol>\n<li><p>使用session需要设置config<br>app.config[‘SECRET_KEY’]=os.urandom(24)</p>\n</li>\n<li><p>Flask提供的session是储存在cookie中的<br>session[‘username’] = data[‘username’]<br>此时的cookie中存储了加密过的username。</p>\n</li>\n<li><p>获取session<br>session.get(‘key’)或session[‘key’]<br>但是后者如果没有这个key会报错。<br>获取到的session自动经过了解密。</p>\n</li>\n<li><p>删除session<br>session.pop(‘key’)或session[‘key’]=False<br>session.clear清除session中所有数据。</p>\n</li>\n</ol>\n<h2 id=\"Flask-SQLAlechemy\"><a href=\"#Flask-SQLAlechemy\" class=\"headerlink\" title=\"Flask_SQLAlechemy\"></a>Flask_SQLAlechemy</h2><p><strong>注意</strong></p>\n<ol>\n<li><p>如果蓝图中有用到db，则一定要在db创建后import蓝图！！！</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">db = SQLAlchemy()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create_app</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    app = Flask(__name__)</span><br><span class=\"line\">    app.config[<span class=\"string\">'SECRET_KEY'</span>] = os.urandom(<span class=\"number\">24</span>)</span><br><span class=\"line\">    app.config[<span class=\"string\">'SQLALCHEMY_DATABASE_URI'</span>] = <span class=\"string\">'mysql+pymysql://library:library@119.23.107.61:3306/library'</span></span><br><span class=\"line\">    app.config[<span class=\"string\">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">    db.init_app(app)</span><br><span class=\"line\">    <span class=\"keyword\">from</span> .user <span class=\"keyword\">import</span> user_blu</span><br><span class=\"line\">    app.register_blueprint(user_blu)</span><br><span class=\"line\">    print(app.url_map)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> app</span><br></pre></td></tr></table></figure>\n<p>因为代码是按照顺序执行的，当你从其他模块导入蓝图的时候就需要 db 了，但是这个时候db 还没有生成，所以会报出错误 提示不可以从当中导入相应的模块。</p>\n</li>\n<li><p>如果db=SQLAlechemy()中没有传app，则后面需要先<code>db.app=app</code>然后再<code>db.init_app(app)</code>???</p>\n</li>\n</ol>\n<h2 id=\"Flask-g\"><a href=\"#Flask-g\" class=\"headerlink\" title=\"Flask g\"></a>Flask g</h2><ol>\n<li>g对象</li>\n</ol>\n<ul>\n<li>专门用来存储用户信息</li>\n<li>g只在一次请求中的所有代码有用</li>\n</ul>\n<ol start=\"2\">\n<li>g与session的区别</li>\n</ol>\n<ul>\n<li>session只要未失效，不同的request请求都可以获得session，由cookie决定</li>\n<li>每一次请求都会改变g对象</li>\n</ul>\n"},{"title":"Idea编译Java版本出错","_content":"\n# Idea控制Java版本\n\n## 1. 包管理中\n\n- Project\n\n- Modules\n\n两个地方都有设置Java版本的位置。\n\n## 2. 偏好设置中\n\n`Cmd` + `,`\n\n在`Java Compiler`中也可以指定Java版本\n\n# Maven控制Java版本\n\n如果是Maven项目，很有可能是因为Maven默认的Java的版本而出错。\n\n在`pom.xml`中进行配置\n\n```xml\n<build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <configuration>\n                    <source>11</source>\n                    <target>11</target>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n```\n\n只要刷新Maven项目，就可以解决Java版本问题。\n\n","source":"_posts/notebook/idea-jdk-version.md","raw":"---\ntitle: Idea编译Java版本出错\ncategories:\n- Notebook\n- Error\ntags:\n- java\n- idea\n---\n\n# Idea控制Java版本\n\n## 1. 包管理中\n\n- Project\n\n- Modules\n\n两个地方都有设置Java版本的位置。\n\n## 2. 偏好设置中\n\n`Cmd` + `,`\n\n在`Java Compiler`中也可以指定Java版本\n\n# Maven控制Java版本\n\n如果是Maven项目，很有可能是因为Maven默认的Java的版本而出错。\n\n在`pom.xml`中进行配置\n\n```xml\n<build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <configuration>\n                    <source>11</source>\n                    <target>11</target>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n```\n\n只要刷新Maven项目，就可以解决Java版本问题。\n\n","slug":"notebook/idea-jdk-version","published":1,"date":"2021-02-02T15:16:00.776Z","updated":"2021-02-02T15:22:05.414Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9807007s018od5z26jbl","content":"<h1 id=\"Idea控制Java版本\"><a href=\"#Idea控制Java版本\" class=\"headerlink\" title=\"Idea控制Java版本\"></a>Idea控制Java版本</h1><h2 id=\"1-包管理中\"><a href=\"#1-包管理中\" class=\"headerlink\" title=\"1. 包管理中\"></a>1. 包管理中</h2><ul>\n<li><p>Project</p>\n</li>\n<li><p>Modules</p>\n</li>\n</ul>\n<p>两个地方都有设置Java版本的位置。</p>\n<h2 id=\"2-偏好设置中\"><a href=\"#2-偏好设置中\" class=\"headerlink\" title=\"2. 偏好设置中\"></a>2. 偏好设置中</h2><p><code>Cmd</code> + <code>,</code></p>\n<p>在<code>Java Compiler</code>中也可以指定Java版本</p>\n<h1 id=\"Maven控制Java版本\"><a href=\"#Maven控制Java版本\" class=\"headerlink\" title=\"Maven控制Java版本\"></a>Maven控制Java版本</h1><p>如果是Maven项目，很有可能是因为Maven默认的Java的版本而出错。</p>\n<p>在<code>pom.xml</code>中进行配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>11<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>11<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>只要刷新Maven项目，就可以解决Java版本问题。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Idea控制Java版本\"><a href=\"#Idea控制Java版本\" class=\"headerlink\" title=\"Idea控制Java版本\"></a>Idea控制Java版本</h1><h2 id=\"1-包管理中\"><a href=\"#1-包管理中\" class=\"headerlink\" title=\"1. 包管理中\"></a>1. 包管理中</h2><ul>\n<li><p>Project</p>\n</li>\n<li><p>Modules</p>\n</li>\n</ul>\n<p>两个地方都有设置Java版本的位置。</p>\n<h2 id=\"2-偏好设置中\"><a href=\"#2-偏好设置中\" class=\"headerlink\" title=\"2. 偏好设置中\"></a>2. 偏好设置中</h2><p><code>Cmd</code> + <code>,</code></p>\n<p>在<code>Java Compiler</code>中也可以指定Java版本</p>\n<h1 id=\"Maven控制Java版本\"><a href=\"#Maven控制Java版本\" class=\"headerlink\" title=\"Maven控制Java版本\"></a>Maven控制Java版本</h1><p>如果是Maven项目，很有可能是因为Maven默认的Java的版本而出错。</p>\n<p>在<code>pom.xml</code>中进行配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>11<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>11<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>只要刷新Maven项目，就可以解决Java版本问题。</p>\n"},{"title":"Github SSH-Key","_content":"\n# Assign private key\n\nmodify config in `~/.ssh/config`.\n\n```shell\n# Github\nHost *\nAddKeysToAgent yes\nUseKeychain yes\nHostName github.com\nUser git\nIdentityFile ~/.ssh/id_rsa_common\n```\n\n# Switch protocol\n\nSwitch url from `http` type to `ssh` type in each repo.\n\n```shell\n# deprecated\nurl = http://github.com/Edlison/xxx.git\n# approved\nurl = git@github.com:Edlison/xxx.git\n```\n\n\n\n----\n\nReference\n\nhttps://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n","source":"_posts/notebook/github-ssh.md","raw":"---\ntitle: Github SSH-Key\ncategories:\n- Notebook\ntags:\n- git\n---\n\n# Assign private key\n\nmodify config in `~/.ssh/config`.\n\n```shell\n# Github\nHost *\nAddKeysToAgent yes\nUseKeychain yes\nHostName github.com\nUser git\nIdentityFile ~/.ssh/id_rsa_common\n```\n\n# Switch protocol\n\nSwitch url from `http` type to `ssh` type in each repo.\n\n```shell\n# deprecated\nurl = http://github.com/Edlison/xxx.git\n# approved\nurl = git@github.com:Edlison/xxx.git\n```\n\n\n\n----\n\nReference\n\nhttps://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\n\n","slug":"notebook/github-ssh","published":1,"date":"2021-08-20T17:28:49.753Z","updated":"2021-08-20T20:45:00.232Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9808007v018o2zk6gfij","content":"<h1 id=\"Assign-private-key\"><a href=\"#Assign-private-key\" class=\"headerlink\" title=\"Assign private key\"></a>Assign private key</h1><p>modify config in <code>~/.ssh/config</code>.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Github</span></span><br><span class=\"line\">Host *</span><br><span class=\"line\">AddKeysToAgent yes</span><br><span class=\"line\">UseKeychain yes</span><br><span class=\"line\">HostName github.com</span><br><span class=\"line\">User git</span><br><span class=\"line\">IdentityFile ~/.ssh/id_rsa_common</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Switch-protocol\"><a href=\"#Switch-protocol\" class=\"headerlink\" title=\"Switch protocol\"></a>Switch protocol</h1><p>Switch url from <code>http</code> type to <code>ssh</code> type in each repo.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> deprecated</span></span><br><span class=\"line\">url = http://github.com/Edlison/xxx.git</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> approved</span></span><br><span class=\"line\">url = git@github.com:Edlison/xxx.git</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vZW4vZ2l0aHViL2F1dGhlbnRpY2F0aW5nLXRvLWdpdGh1Yi9jb25uZWN0aW5nLXRvLWdpdGh1Yi13aXRoLXNzaC9nZW5lcmF0aW5nLWEtbmV3LXNzaC1rZXktYW5kLWFkZGluZy1pdC10by10aGUtc3NoLWFnZW50\">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Assign-private-key\"><a href=\"#Assign-private-key\" class=\"headerlink\" title=\"Assign private key\"></a>Assign private key</h1><p>modify config in <code>~/.ssh/config</code>.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Github</span></span><br><span class=\"line\">Host *</span><br><span class=\"line\">AddKeysToAgent yes</span><br><span class=\"line\">UseKeychain yes</span><br><span class=\"line\">HostName github.com</span><br><span class=\"line\">User git</span><br><span class=\"line\">IdentityFile ~/.ssh/id_rsa_common</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Switch-protocol\"><a href=\"#Switch-protocol\" class=\"headerlink\" title=\"Switch protocol\"></a>Switch protocol</h1><p>Switch url from <code>http</code> type to <code>ssh</code> type in each repo.</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> deprecated</span></span><br><span class=\"line\">url = http://github.com/Edlison/xxx.git</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> approved</span></span><br><span class=\"line\">url = git@github.com:Edlison/xxx.git</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vZW4vZ2l0aHViL2F1dGhlbnRpY2F0aW5nLXRvLWdpdGh1Yi9jb25uZWN0aW5nLXRvLWdpdGh1Yi13aXRoLXNzaC9nZW5lcmF0aW5nLWEtbmV3LXNzaC1rZXktYW5kLWFkZGluZy1pdC10by10aGUtc3NoLWFnZW50\">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Config in Next theme","_content":"\n# Pagination\n\nEdit `_config.yml` in blog.\n\n```\nindex_generator:\n  path: ''\n  per_page: 5\n  order_by: -date\n```\n\n# SEO\n\nEdit `_config.yml` in `next` theme.\n\n```\n# Google Analytics\ngoogle_analytics:\n  tracking_id: G-1B9EHJMCZY\n  # By default, NexT will load an external gtag.js script on your site.\n  # If you only need the pageview feature, set the following option to true to get a better performance.\n  only_pageview: false\n```\n\nDue to the anti-spider, SEO on the website that deployed on github doesn't work.\n\n## Plan A\n\n`Vercel.com`\n\n\n\n## Plan B\n\nEstablish another git repo on `coding.net`\n\n\n\n# Excerpt\n\n## method1\n\n```\n---\ntitle: xxx\ndescription: xxxxxxxxx\n---\n```\n\n## method2\n\nAdd this code to your content where you want to truncate.\n\n```\n<!--more-->\n```\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/yueyue200830/article/details/104470646","source":"_posts/notebook/hexo.md","raw":"---\ntitle: Config in Next theme\ncategories:\n- Notebook\ntags:\n- hexo\n---\n\n# Pagination\n\nEdit `_config.yml` in blog.\n\n```\nindex_generator:\n  path: ''\n  per_page: 5\n  order_by: -date\n```\n\n# SEO\n\nEdit `_config.yml` in `next` theme.\n\n```\n# Google Analytics\ngoogle_analytics:\n  tracking_id: G-1B9EHJMCZY\n  # By default, NexT will load an external gtag.js script on your site.\n  # If you only need the pageview feature, set the following option to true to get a better performance.\n  only_pageview: false\n```\n\nDue to the anti-spider, SEO on the website that deployed on github doesn't work.\n\n## Plan A\n\n`Vercel.com`\n\n\n\n## Plan B\n\nEstablish another git repo on `coding.net`\n\n\n\n# Excerpt\n\n## method1\n\n```\n---\ntitle: xxx\ndescription: xxxxxxxxx\n---\n```\n\n## method2\n\nAdd this code to your content where you want to truncate.\n\n```\n<!--more-->\n```\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/yueyue200830/article/details/104470646","slug":"notebook/hexo","published":1,"date":"2021-08-20T19:05:26.175Z","updated":"2021-08-20T20:21:17.782Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9809007y018o0m047o5z","content":"<h1 id=\"Pagination\"><a href=\"#Pagination\" class=\"headerlink\" title=\"Pagination\"></a>Pagination</h1><p>Edit <code>_config.yml</code> in blog.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index_generator:</span><br><span class=\"line\">  path: &#39;&#39;</span><br><span class=\"line\">  per_page: 5</span><br><span class=\"line\">  order_by: -date</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"SEO\"><a href=\"#SEO\" class=\"headerlink\" title=\"SEO\"></a>SEO</h1><p>Edit <code>_config.yml</code> in <code>next</code> theme.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Google Analytics</span><br><span class=\"line\">google_analytics:</span><br><span class=\"line\">  tracking_id: G-1B9EHJMCZY</span><br><span class=\"line\">  # By default, NexT will load an external gtag.js script on your site.</span><br><span class=\"line\">  # If you only need the pageview feature, set the following option to true to get a better performance.</span><br><span class=\"line\">  only_pageview: false</span><br></pre></td></tr></table></figure>\n\n<p>Due to the anti-spider, SEO on the website that deployed on github doesn’t work.</p>\n<h2 id=\"Plan-A\"><a href=\"#Plan-A\" class=\"headerlink\" title=\"Plan A\"></a>Plan A</h2><p><code>Vercel.com</code></p>\n<h2 id=\"Plan-B\"><a href=\"#Plan-B\" class=\"headerlink\" title=\"Plan B\"></a>Plan B</h2><p>Establish another git repo on <code>coding.net</code></p>\n<h1 id=\"Excerpt\"><a href=\"#Excerpt\" class=\"headerlink\" title=\"Excerpt\"></a>Excerpt</h1><h2 id=\"method1\"><a href=\"#method1\" class=\"headerlink\" title=\"method1\"></a>method1</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: xxx</span><br><span class=\"line\">description: xxxxxxxxx</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"method2\"><a href=\"#method2\" class=\"headerlink\" title=\"method2\"></a>method2</h2><p>Add this code to your content where you want to truncate.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--more--&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXl1ZTIwMDgzMC9hcnRpY2xlL2RldGFpbHMvMTA0NDcwNjQ2\">https://blog.csdn.net/yueyue200830/article/details/104470646<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Pagination\"><a href=\"#Pagination\" class=\"headerlink\" title=\"Pagination\"></a>Pagination</h1><p>Edit <code>_config.yml</code> in blog.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index_generator:</span><br><span class=\"line\">  path: &#39;&#39;</span><br><span class=\"line\">  per_page: 5</span><br><span class=\"line\">  order_by: -date</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"SEO\"><a href=\"#SEO\" class=\"headerlink\" title=\"SEO\"></a>SEO</h1><p>Edit <code>_config.yml</code> in <code>next</code> theme.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Google Analytics</span><br><span class=\"line\">google_analytics:</span><br><span class=\"line\">  tracking_id: G-1B9EHJMCZY</span><br><span class=\"line\">  # By default, NexT will load an external gtag.js script on your site.</span><br><span class=\"line\">  # If you only need the pageview feature, set the following option to true to get a better performance.</span><br><span class=\"line\">  only_pageview: false</span><br></pre></td></tr></table></figure>\n\n<p>Due to the anti-spider, SEO on the website that deployed on github doesn’t work.</p>\n<h2 id=\"Plan-A\"><a href=\"#Plan-A\" class=\"headerlink\" title=\"Plan A\"></a>Plan A</h2><p><code>Vercel.com</code></p>\n<h2 id=\"Plan-B\"><a href=\"#Plan-B\" class=\"headerlink\" title=\"Plan B\"></a>Plan B</h2><p>Establish another git repo on <code>coding.net</code></p>\n<h1 id=\"Excerpt\"><a href=\"#Excerpt\" class=\"headerlink\" title=\"Excerpt\"></a>Excerpt</h1><h2 id=\"method1\"><a href=\"#method1\" class=\"headerlink\" title=\"method1\"></a>method1</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: xxx</span><br><span class=\"line\">description: xxxxxxxxx</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"method2\"><a href=\"#method2\" class=\"headerlink\" title=\"method2\"></a>method2</h2><p>Add this code to your content where you want to truncate.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--more--&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXl1ZTIwMDgzMC9hcnRpY2xlL2RldGFpbHMvMTA0NDcwNjQ2\">https://blog.csdn.net/yueyue200830/article/details/104470646<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# 控制反转\n## Summary\n\n控制反转（Inversion of Control，缩写为IoC），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体将其所依赖的对象的引用传递给它。也可以说，依赖被注入到对象中。\n\n## Description\n\nClass A中用到了Class B的对象b，一般情况下，需要在A的代码中显式的new一个B的对象。\n\n采用依赖注入技术之后，A的代码只需要定义一个私有的B对象，不需要直接new来获得这个对象，而是通过相关的容器控制程序来将B对象在外部new出来并注入到A类里的引用中。而具体获取的方法、对象被获取时的状态由配置文件（如XML）来指定。\n\n## 设计模式\n\nIoC可以认为是一种全新的设计模式，但是理论和时间成熟相对较晚，并没有包含在GoF中。\nInterface Driven Design接口驱动，接口驱动有很多好处，可以提供不同灵活的子类实现，增加代码稳定和健壮性等等，但是接口一定是需要实现的，也就是如下语句迟早要执行：AInterface a = new AInterfaceImp(); 这样一来，耦合关系就产生了，如：\n```java\nclassA\n{\n    AInterface a;\n \n    A(){}\n     \n    AMethod()//一个方法\n    {\n        a = new AInterfaceImp();\n    }\n}\n```\n\nClass A与AInterfaceImp就是依赖关系，如果想使用AInterface的另外一个实现就需要更改代码了。当然我们可以建立一个Factory来根据条件生成想要的AInterface的具体实现，即：\n\n```java\nInterfaceImplFactory\n{\n   AInterface create(Object condition)\n   {\n      if(condition == condA)\n      {\n          return new AInterfaceImpA();\n      }\n      else if(condition == condB)\n      {\n          return new AInterfaceImpB();\n      }\n      else\n      {\n          return new AInterfaceImp();\n      }\n    }\n}\n```\n\n表面上是在一定程度上缓解了以上问题，但实质上这种代码耦合并没有改变。通过IoC模式可以彻底解决这种耦合，它把耦合从代码中移出去，放到统一的XML 文件中，通过一个容器在需要的时候把这个依赖关系形成，即把需要的接口实现注入到需要它的类中，这可能就是“依赖注入”说法的来源了。\n\nIoC模式，系统中通过引入实现了IoC模式的IoC容器，即可由IoC容器来管理对象的生命周期、依赖关系等，从而使得应用程序的配置和依赖性规范与实际的应用程序代码分离。其中一个特点就是通过文本的配置文件进行应用程序组件间相互关系的配置，而不用重新修改并编译具体的代码。\n\n当前比较知名的IoC容器有：Pico Container、Avalon 、Spring、JBoss、HiveMind、EJB等。\n\n在上面的几个IoC容器中，轻量级的有Pico Container、Avalon、Spring、HiveMind等，超重量级的有EJB，而半轻半重的有容器有JBoss，Jdon等。\n\n可以把IoC模式看作工厂模式的升华，把IoC容器看作是一个大工厂，只不过这个大工厂里要生成的对象都是在XML文件中给出定义的。利用Java 的“反射”编程，根据XML中给出的类定义生成相应的对象。从实现来看，以前在工厂模式里写死了的对象，IoC模式改为配置XML文件，这就把工厂和要生成的对象两者隔离，极大提高了灵活性和可维护性。\n\nIoC中最基本的Java技术就是“反射”编程。通俗的说，反射就是根据给出的类名（字符串）来生成对象。这种编程方式可以让应用在运行时才动态决定生成哪一种对象。反射的应用是很广泛的，像Hibernate、Spring中都是用“反射”做为最基本的技术手段。\n\n在过去，反射编程方式相对于正常的对象生成方式要慢10几倍，这也许也是当时为什么反射技术没有普遍应用开来的原因。但经SUN改良优化后，反射方式生成对象和通常对象生成方式，速度已经相差不大了（但依然有一倍以上的差距）。\n","source":"_posts/notebook/ioc.md","raw":"# 控制反转\n## Summary\n\n控制反转（Inversion of Control，缩写为IoC），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体将其所依赖的对象的引用传递给它。也可以说，依赖被注入到对象中。\n\n## Description\n\nClass A中用到了Class B的对象b，一般情况下，需要在A的代码中显式的new一个B的对象。\n\n采用依赖注入技术之后，A的代码只需要定义一个私有的B对象，不需要直接new来获得这个对象，而是通过相关的容器控制程序来将B对象在外部new出来并注入到A类里的引用中。而具体获取的方法、对象被获取时的状态由配置文件（如XML）来指定。\n\n## 设计模式\n\nIoC可以认为是一种全新的设计模式，但是理论和时间成熟相对较晚，并没有包含在GoF中。\nInterface Driven Design接口驱动，接口驱动有很多好处，可以提供不同灵活的子类实现，增加代码稳定和健壮性等等，但是接口一定是需要实现的，也就是如下语句迟早要执行：AInterface a = new AInterfaceImp(); 这样一来，耦合关系就产生了，如：\n```java\nclassA\n{\n    AInterface a;\n \n    A(){}\n     \n    AMethod()//一个方法\n    {\n        a = new AInterfaceImp();\n    }\n}\n```\n\nClass A与AInterfaceImp就是依赖关系，如果想使用AInterface的另外一个实现就需要更改代码了。当然我们可以建立一个Factory来根据条件生成想要的AInterface的具体实现，即：\n\n```java\nInterfaceImplFactory\n{\n   AInterface create(Object condition)\n   {\n      if(condition == condA)\n      {\n          return new AInterfaceImpA();\n      }\n      else if(condition == condB)\n      {\n          return new AInterfaceImpB();\n      }\n      else\n      {\n          return new AInterfaceImp();\n      }\n    }\n}\n```\n\n表面上是在一定程度上缓解了以上问题，但实质上这种代码耦合并没有改变。通过IoC模式可以彻底解决这种耦合，它把耦合从代码中移出去，放到统一的XML 文件中，通过一个容器在需要的时候把这个依赖关系形成，即把需要的接口实现注入到需要它的类中，这可能就是“依赖注入”说法的来源了。\n\nIoC模式，系统中通过引入实现了IoC模式的IoC容器，即可由IoC容器来管理对象的生命周期、依赖关系等，从而使得应用程序的配置和依赖性规范与实际的应用程序代码分离。其中一个特点就是通过文本的配置文件进行应用程序组件间相互关系的配置，而不用重新修改并编译具体的代码。\n\n当前比较知名的IoC容器有：Pico Container、Avalon 、Spring、JBoss、HiveMind、EJB等。\n\n在上面的几个IoC容器中，轻量级的有Pico Container、Avalon、Spring、HiveMind等，超重量级的有EJB，而半轻半重的有容器有JBoss，Jdon等。\n\n可以把IoC模式看作工厂模式的升华，把IoC容器看作是一个大工厂，只不过这个大工厂里要生成的对象都是在XML文件中给出定义的。利用Java 的“反射”编程，根据XML中给出的类定义生成相应的对象。从实现来看，以前在工厂模式里写死了的对象，IoC模式改为配置XML文件，这就把工厂和要生成的对象两者隔离，极大提高了灵活性和可维护性。\n\nIoC中最基本的Java技术就是“反射”编程。通俗的说，反射就是根据给出的类名（字符串）来生成对象。这种编程方式可以让应用在运行时才动态决定生成哪一种对象。反射的应用是很广泛的，像Hibernate、Spring中都是用“反射”做为最基本的技术手段。\n\n在过去，反射编程方式相对于正常的对象生成方式要慢10几倍，这也许也是当时为什么反射技术没有普遍应用开来的原因。但经SUN改良优化后，反射方式生成对象和通常对象生成方式，速度已经相差不大了（但依然有一倍以上的差距）。\n","slug":"notebook/ioc","published":1,"date":"2020-03-03T15:07:46.547Z","updated":"2020-03-03T15:13:24.424Z","title":"notebook/ioc","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx98090082018o61txehoi","content":"<h1 id=\"控制反转\"><a href=\"#控制反转\" class=\"headerlink\" title=\"控制反转\"></a>控制反转</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>控制反转（Inversion of Control，缩写为IoC），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体将其所依赖的对象的引用传递给它。也可以说，依赖被注入到对象中。</p>\n<h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>Class A中用到了Class B的对象b，一般情况下，需要在A的代码中显式的new一个B的对象。</p>\n<p>采用依赖注入技术之后，A的代码只需要定义一个私有的B对象，不需要直接new来获得这个对象，而是通过相关的容器控制程序来将B对象在外部new出来并注入到A类里的引用中。而具体获取的方法、对象被获取时的状态由配置文件（如XML）来指定。</p>\n<h2 id=\"设计模式\"><a href=\"#设计模式\" class=\"headerlink\" title=\"设计模式\"></a>设计模式</h2><p>IoC可以认为是一种全新的设计模式，但是理论和时间成熟相对较晚，并没有包含在GoF中。<br>Interface Driven Design接口驱动，接口驱动有很多好处，可以提供不同灵活的子类实现，增加代码稳定和健壮性等等，但是接口一定是需要实现的，也就是如下语句迟早要执行：AInterface a = new AInterfaceImp(); 这样一来，耦合关系就产生了，如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classA</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    AInterface a;</span><br><span class=\"line\"> </span><br><span class=\"line\">    A()&#123;&#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    AMethod()<span class=\"comment\">//一个方法</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a = <span class=\"keyword\">new</span> AInterfaceImp();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Class A与AInterfaceImp就是依赖关系，如果想使用AInterface的另外一个实现就需要更改代码了。当然我们可以建立一个Factory来根据条件生成想要的AInterface的具体实现，即：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">InterfaceImplFactory</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"function\">AInterface <span class=\"title\">create</span><span class=\"params\">(Object condition)</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(condition == condA)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImpA();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(condition == condB)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImpB();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">else</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImp();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>表面上是在一定程度上缓解了以上问题，但实质上这种代码耦合并没有改变。通过IoC模式可以彻底解决这种耦合，它把耦合从代码中移出去，放到统一的XML 文件中，通过一个容器在需要的时候把这个依赖关系形成，即把需要的接口实现注入到需要它的类中，这可能就是“依赖注入”说法的来源了。</p>\n<p>IoC模式，系统中通过引入实现了IoC模式的IoC容器，即可由IoC容器来管理对象的生命周期、依赖关系等，从而使得应用程序的配置和依赖性规范与实际的应用程序代码分离。其中一个特点就是通过文本的配置文件进行应用程序组件间相互关系的配置，而不用重新修改并编译具体的代码。</p>\n<p>当前比较知名的IoC容器有：Pico Container、Avalon 、Spring、JBoss、HiveMind、EJB等。</p>\n<p>在上面的几个IoC容器中，轻量级的有Pico Container、Avalon、Spring、HiveMind等，超重量级的有EJB，而半轻半重的有容器有JBoss，Jdon等。</p>\n<p>可以把IoC模式看作工厂模式的升华，把IoC容器看作是一个大工厂，只不过这个大工厂里要生成的对象都是在XML文件中给出定义的。利用Java 的“反射”编程，根据XML中给出的类定义生成相应的对象。从实现来看，以前在工厂模式里写死了的对象，IoC模式改为配置XML文件，这就把工厂和要生成的对象两者隔离，极大提高了灵活性和可维护性。</p>\n<p>IoC中最基本的Java技术就是“反射”编程。通俗的说，反射就是根据给出的类名（字符串）来生成对象。这种编程方式可以让应用在运行时才动态决定生成哪一种对象。反射的应用是很广泛的，像Hibernate、Spring中都是用“反射”做为最基本的技术手段。</p>\n<p>在过去，反射编程方式相对于正常的对象生成方式要慢10几倍，这也许也是当时为什么反射技术没有普遍应用开来的原因。但经SUN改良优化后，反射方式生成对象和通常对象生成方式，速度已经相差不大了（但依然有一倍以上的差距）。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"控制反转\"><a href=\"#控制反转\" class=\"headerlink\" title=\"控制反转\"></a>控制反转</h1><h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>控制反转（Inversion of Control，缩写为IoC），是面向对象编程中的一种设计原则，可以用来减低计算机代码之间的耦合度。其中最常见的方式叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。通过控制反转，对象在被创建的时候，由一个调控系统内所有对象的外界实体将其所依赖的对象的引用传递给它。也可以说，依赖被注入到对象中。</p>\n<h2 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h2><p>Class A中用到了Class B的对象b，一般情况下，需要在A的代码中显式的new一个B的对象。</p>\n<p>采用依赖注入技术之后，A的代码只需要定义一个私有的B对象，不需要直接new来获得这个对象，而是通过相关的容器控制程序来将B对象在外部new出来并注入到A类里的引用中。而具体获取的方法、对象被获取时的状态由配置文件（如XML）来指定。</p>\n<h2 id=\"设计模式\"><a href=\"#设计模式\" class=\"headerlink\" title=\"设计模式\"></a>设计模式</h2><p>IoC可以认为是一种全新的设计模式，但是理论和时间成熟相对较晚，并没有包含在GoF中。<br>Interface Driven Design接口驱动，接口驱动有很多好处，可以提供不同灵活的子类实现，增加代码稳定和健壮性等等，但是接口一定是需要实现的，也就是如下语句迟早要执行：AInterface a = new AInterfaceImp(); 这样一来，耦合关系就产生了，如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">classA</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    AInterface a;</span><br><span class=\"line\"> </span><br><span class=\"line\">    A()&#123;&#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    AMethod()<span class=\"comment\">//一个方法</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        a = <span class=\"keyword\">new</span> AInterfaceImp();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Class A与AInterfaceImp就是依赖关系，如果想使用AInterface的另外一个实现就需要更改代码了。当然我们可以建立一个Factory来根据条件生成想要的AInterface的具体实现，即：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">InterfaceImplFactory</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"function\">AInterface <span class=\"title\">create</span><span class=\"params\">(Object condition)</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(condition == condA)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImpA();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(condition == condB)</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImpB();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">else</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> AInterfaceImp();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>表面上是在一定程度上缓解了以上问题，但实质上这种代码耦合并没有改变。通过IoC模式可以彻底解决这种耦合，它把耦合从代码中移出去，放到统一的XML 文件中，通过一个容器在需要的时候把这个依赖关系形成，即把需要的接口实现注入到需要它的类中，这可能就是“依赖注入”说法的来源了。</p>\n<p>IoC模式，系统中通过引入实现了IoC模式的IoC容器，即可由IoC容器来管理对象的生命周期、依赖关系等，从而使得应用程序的配置和依赖性规范与实际的应用程序代码分离。其中一个特点就是通过文本的配置文件进行应用程序组件间相互关系的配置，而不用重新修改并编译具体的代码。</p>\n<p>当前比较知名的IoC容器有：Pico Container、Avalon 、Spring、JBoss、HiveMind、EJB等。</p>\n<p>在上面的几个IoC容器中，轻量级的有Pico Container、Avalon、Spring、HiveMind等，超重量级的有EJB，而半轻半重的有容器有JBoss，Jdon等。</p>\n<p>可以把IoC模式看作工厂模式的升华，把IoC容器看作是一个大工厂，只不过这个大工厂里要生成的对象都是在XML文件中给出定义的。利用Java 的“反射”编程，根据XML中给出的类定义生成相应的对象。从实现来看，以前在工厂模式里写死了的对象，IoC模式改为配置XML文件，这就把工厂和要生成的对象两者隔离，极大提高了灵活性和可维护性。</p>\n<p>IoC中最基本的Java技术就是“反射”编程。通俗的说，反射就是根据给出的类名（字符串）来生成对象。这种编程方式可以让应用在运行时才动态决定生成哪一种对象。反射的应用是很广泛的，像Hibernate、Spring中都是用“反射”做为最基本的技术手段。</p>\n<p>在过去，反射编程方式相对于正常的对象生成方式要慢10几倍，这也许也是当时为什么反射技术没有普遍应用开来的原因。但经SUN改良优化后，反射方式生成对象和通常对象生成方式，速度已经相差不大了（但依然有一倍以上的差距）。</p>\n"},{"_content":"## Welcome to GitHub Pages\n\nYou can use the [editor on GitHub](https://github.com/Edlison/edlison.github.io/edit/master/index.md) to maintain and preview the content for your website in Markdown files.\n\nWhenever you commit to this repository, GitHub Pages will run [Jekyll](https://jekyllrb.com/) to rebuild the pages in your site, from the content in your Markdown files.\n\n### Markdown\n\nMarkdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for\n\n```markdown\nSyntax highlighted code block\n\n# Header 1\n## Header 2\n### Header 3\n\n- Bulleted\n- List\n\n1. Numbered\n2. List\n\n**Bold** and _Italic_ and `Code` text\n\n[Link](url) and ![Image](src)\n```\n\nFor more details see [GitHub Flavored Markdown](https://guides.github.com/features/mastering-markdown/).\n\n### Jekyll Themes\n\nYour Pages site will use the layout and styles from the Jekyll theme you have selected in your [repository settings](https://github.com/Edlison/edlison.github.io/settings). The name of this theme is saved in the Jekyll `_config.yml` configuration file.\n\n### Support or Contact\n\nHaving trouble with Pages? Check out our [documentation](https://help.github.com/categories/github-pages-basics/) or [contact support](https://github.com/contact) and we’ll help you sort it out.\n","source":"_posts/notebook/guide.md","raw":"## Welcome to GitHub Pages\n\nYou can use the [editor on GitHub](https://github.com/Edlison/edlison.github.io/edit/master/index.md) to maintain and preview the content for your website in Markdown files.\n\nWhenever you commit to this repository, GitHub Pages will run [Jekyll](https://jekyllrb.com/) to rebuild the pages in your site, from the content in your Markdown files.\n\n### Markdown\n\nMarkdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for\n\n```markdown\nSyntax highlighted code block\n\n# Header 1\n## Header 2\n### Header 3\n\n- Bulleted\n- List\n\n1. Numbered\n2. List\n\n**Bold** and _Italic_ and `Code` text\n\n[Link](url) and ![Image](src)\n```\n\nFor more details see [GitHub Flavored Markdown](https://guides.github.com/features/mastering-markdown/).\n\n### Jekyll Themes\n\nYour Pages site will use the layout and styles from the Jekyll theme you have selected in your [repository settings](https://github.com/Edlison/edlison.github.io/settings). The name of this theme is saved in the Jekyll `_config.yml` configuration file.\n\n### Support or Contact\n\nHaving trouble with Pages? Check out our [documentation](https://help.github.com/categories/github-pages-basics/) or [contact support](https://github.com/contact) and we’ll help you sort it out.\n","slug":"notebook/guide","published":1,"date":"2020-03-03T13:13:41.670Z","updated":"2020-03-03T13:45:07.262Z","title":"notebook/guide","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980a0083018oczh0fepj","content":"<h2 id=\"Welcome-to-GitHub-Pages\"><a href=\"#Welcome-to-GitHub-Pages\" class=\"headerlink\" title=\"Welcome to GitHub Pages\"></a>Welcome to GitHub Pages</h2><p>You can use the <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VkbGlzb24vZWRsaXNvbi5naXRodWIuaW8vZWRpdC9tYXN0ZXIvaW5kZXgubWQ=\">editor on GitHub<i class=\"fa fa-external-link-alt\"></i></span> to maintain and preview the content for your website in Markdown files.</p>\n<p>Whenever you commit to this repository, GitHub Pages will run <span class=\"exturl\" data-url=\"aHR0cHM6Ly9qZWt5bGxyYi5jb20v\">Jekyll<i class=\"fa fa-external-link-alt\"></i></span> to rebuild the pages in your site, from the content in your Markdown files.</p>\n<h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><p>Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Syntax highlighted code block</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\"># Header 1</span></span><br><span class=\"line\"><span class=\"section\">## Header 2</span></span><br><span class=\"line\"><span class=\"section\">### Header 3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">- </span>Bulleted</span><br><span class=\"line\"><span class=\"bullet\">- </span>List</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">1. </span>Numbered</span><br><span class=\"line\"><span class=\"bullet\">2. </span>List</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">**Bold**</span> and <span class=\"emphasis\">_Italic_</span> and <span class=\"code\">`Code`</span> text</span><br><span class=\"line\"></span><br><span class=\"line\">[<span class=\"string\">Link</span>](<span class=\"link\">url</span>) and ![<span class=\"string\">Image</span>](<span class=\"link\">src</span>)</span><br></pre></td></tr></table></figure>\n\n<p>For more details see <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndWlkZXMuZ2l0aHViLmNvbS9mZWF0dXJlcy9tYXN0ZXJpbmctbWFya2Rvd24v\">GitHub Flavored Markdown<i class=\"fa fa-external-link-alt\"></i></span>.</p>\n<h3 id=\"Jekyll-Themes\"><a href=\"#Jekyll-Themes\" class=\"headerlink\" title=\"Jekyll Themes\"></a>Jekyll Themes</h3><p>Your Pages site will use the layout and styles from the Jekyll theme you have selected in your <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VkbGlzb24vZWRsaXNvbi5naXRodWIuaW8vc2V0dGluZ3M=\">repository settings<i class=\"fa fa-external-link-alt\"></i></span>. The name of this theme is saved in the Jekyll <code>_config.yml</code> configuration file.</p>\n<h3 id=\"Support-or-Contact\"><a href=\"#Support-or-Contact\" class=\"headerlink\" title=\"Support or Contact\"></a>Support or Contact</h3><p>Having trouble with Pages? Check out our <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZWxwLmdpdGh1Yi5jb20vY2F0ZWdvcmllcy9naXRodWItcGFnZXMtYmFzaWNzLw==\">documentation<i class=\"fa fa-external-link-alt\"></i></span> or <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NvbnRhY3Q=\">contact support<i class=\"fa fa-external-link-alt\"></i></span> and we’ll help you sort it out.</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Welcome-to-GitHub-Pages\"><a href=\"#Welcome-to-GitHub-Pages\" class=\"headerlink\" title=\"Welcome to GitHub Pages\"></a>Welcome to GitHub Pages</h2><p>You can use the <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VkbGlzb24vZWRsaXNvbi5naXRodWIuaW8vZWRpdC9tYXN0ZXIvaW5kZXgubWQ=\">editor on GitHub<i class=\"fa fa-external-link-alt\"></i></span> to maintain and preview the content for your website in Markdown files.</p>\n<p>Whenever you commit to this repository, GitHub Pages will run <span class=\"exturl\" data-url=\"aHR0cHM6Ly9qZWt5bGxyYi5jb20v\">Jekyll<i class=\"fa fa-external-link-alt\"></i></span> to rebuild the pages in your site, from the content in your Markdown files.</p>\n<h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><p>Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Syntax highlighted code block</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\"># Header 1</span></span><br><span class=\"line\"><span class=\"section\">## Header 2</span></span><br><span class=\"line\"><span class=\"section\">### Header 3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">- </span>Bulleted</span><br><span class=\"line\"><span class=\"bullet\">- </span>List</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">1. </span>Numbered</span><br><span class=\"line\"><span class=\"bullet\">2. </span>List</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"strong\">**Bold**</span> and <span class=\"emphasis\">_Italic_</span> and <span class=\"code\">`Code`</span> text</span><br><span class=\"line\"></span><br><span class=\"line\">[<span class=\"string\">Link</span>](<span class=\"link\">url</span>) and ![<span class=\"string\">Image</span>](<span class=\"link\">src</span>)</span><br></pre></td></tr></table></figure>\n\n<p>For more details see <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ndWlkZXMuZ2l0aHViLmNvbS9mZWF0dXJlcy9tYXN0ZXJpbmctbWFya2Rvd24v\">GitHub Flavored Markdown<i class=\"fa fa-external-link-alt\"></i></span>.</p>\n<h3 id=\"Jekyll-Themes\"><a href=\"#Jekyll-Themes\" class=\"headerlink\" title=\"Jekyll Themes\"></a>Jekyll Themes</h3><p>Your Pages site will use the layout and styles from the Jekyll theme you have selected in your <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VkbGlzb24vZWRsaXNvbi5naXRodWIuaW8vc2V0dGluZ3M=\">repository settings<i class=\"fa fa-external-link-alt\"></i></span>. The name of this theme is saved in the Jekyll <code>_config.yml</code> configuration file.</p>\n<h3 id=\"Support-or-Contact\"><a href=\"#Support-or-Contact\" class=\"headerlink\" title=\"Support or Contact\"></a>Support or Contact</h3><p>Having trouble with Pages? Check out our <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZWxwLmdpdGh1Yi5jb20vY2F0ZWdvcmllcy9naXRodWItcGFnZXMtYmFzaWNzLw==\">documentation<i class=\"fa fa-external-link-alt\"></i></span> or <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NvbnRhY3Q=\">contact support<i class=\"fa fa-external-link-alt\"></i></span> and we’ll help you sort it out.</p>\n"},{"_content":"# java 内部类和静态内部类的区别\n下面说一说内部类（Inner Class）和静态内部类（Static Nested Class）的区别：\n定义在一个类内部的类叫内部类，包含内部类的类称为外部类。内部类可以声明public、protected、private等访问限制，可以声明 为abstract的供其他内部类或外部类继承与扩展，或者声明为static、final的，也可以实现特定的接口。外部类按常规的类访问方式使用内部 类，唯一的差别是外部类可以访问内部类的所有方法与属性，包括私有方法与属性。\n\n## 一. 创建实例\n\n   OutClass.InnerClass obj = outClassInstance.new InnerClass(); //注意是外部类实例.new，内部类\n\n   AAA.StaticInner in = new AAA.StaticInner();//注意是外部类本身，静态内部类\n\n## 二. 内部类中的this\n\n   内 部类中的this与其他类一样是指的本身。创建内部类对象时，它会与创造它的外围对象有了某种联系，于是能访问外围类的所有成员，不需任何特殊条件，可理 解为内部类链接到外部类。 用外部类创建内部类对象时，此内部类对象会秘密的捕获一个指向外部类的引用，于是，可以通过这个引用来访问外围类的成员。\n\n## 三. 外部类访问内部类\n\n   内部类类似外部类的属性，因此访问内部类对象时总是需要一个创建好的外部类对象。内部类对象通过‘外部类名.this.xxx’的形式访问外部类的属性与方法。如：\n       System.out.println(\"Print in inner Outer.index=\" + pouter.this.index);\n       System.out.println(\"Print in inner Inner.index=\" + this.index);\n\n## 四. 内部类向上转型\n\n   内部类也可以和普通类一样拥有向上转型的特性。将内部类向上转型为基类型，尤其是接口时，内部类就有了用武之地。如果内部类是private的，只可以被它的外部类问，从而完全隐藏实现的细节。\n\n## 五. 方法内的类\n\n   方法内创建的类（注意方法中也能定义类），不能加访问修饰符。另外，方法内部的类也不是在调用方法时才会创建的，它们一样也被事先编译了。\n\n## 六. 静态内部类\n\n   定义静态内部类：在定义内部类的时候，可以在其前面加上一个权限修饰符static。此时这个内部类就变为了静态内部类。\n\n通常称为嵌套类，当内部类是static时，意味着：\n\n   [1]要创建嵌套类的对象，并不需要其外围类的对象；\n\n   [2]不能从嵌套类的对象中访问非静态的外围类对象（不能够从静态内部类的对象中访问外部类的非静态成员）；\n\n   嵌 套类与普通的内部类还有一个区别：普通内部类的字段与方法，只能放在类的外部层次上，所以普通的内部类不能有static数据和static字段， 也不能包含嵌套类。但是在嵌套类里可以包含所有这些东西。也就是说，在非静态内部类中不可以声明静态成员，只有将某个内部类修饰为静态类，然后才能够在这 个类中定义静态的成员变量与成员方法。\n\n   另外，在创建静态内部类时不需要将静态内部类的实例绑定在外部类的实例上。普通非静态内部类的 对象是依附在外部类对象之中的，要在一个外部类中定义一个静态的内部类，不需要利用关键字new来创建内部类的实例。静态类和方法只属于类本身，并不属于 该类的对象，更不属于其他外部类的对象。\n\n## 七. 内部类标识符\n\n   每个类会产生一个.class文件，文件名即为类名。同样，内部类也会产生这么一个.class文件，但是它的名称却不是内部类的类名，而是有着严格的限制：外围类的名字，加上$,再加上内部类名字。\n\n## 八. 为何要用内部类？\n\n   1.   内部类一般只为其外部类使用；\n\n   2.   内部类提供了某种进入外部类的窗户；\n\n   3.   也是最吸引人的原因，每个内部类都能独立地继承一个接口，而无论外部类是否已经继承了某个接口。因此，内部类使多重继承的解决方案变得更加完整。\n\n \n\n加深印象，参考一下：\n```java\npackage com.test.xml;\npublic class OutClassTest {\n    static int a;\n\n    int b;\n\n    public static void test() {\n        System.out.println(\"outer class static function\");\n    }\n\n    public static void main(String[] args) {\n        OutClassTest oc = new OutClassTest();\n        // new一个外部类\n        OutClassTest oc1 = new OutClassTest();\n        // 通过外部类的对象new一个非静态的内部类\n        OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();\n        // 调用非静态内部类的方法\n        System.out.println(no_static_inner.getKey());\n\n        // 调用静态内部类的静态变量\n        System.out.println(OutClassTest.InnerStaticClass.static_value);\n        // 不依赖于外部类实例,直接实例化内部静态类\n        OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();\n        // 调用静态内部类的非静态方法\n        System.out.println(inner.getValue());\n        // 调用内部静态类的静态方法\n        System.out.println(OutClassTest.InnerStaticClass.getMessage());\n    }\n\n    private class InnerClass {\n        // 只有在静态内部类中才能够声明或定义静态成员\n        // private static String tt = \"0\";\n        private int flag = 0;\n\n        public InnerClass() {\n            // 三.非静态内部类的非静态成员可以访问外部类的非静态变量和静态变量\n            System.out.println(\"InnerClass create a:\" + a);\n            System.out.println(\"InnerClass create b:\" + b);\n            System.out.println(\"InnerClass create flag:\" + flag);\n            //\n            System.out.println(\"InnerClass call outer static function\");\n            // 调用外部类的静态方法\n            test();\n        }\n\n        public  String getKey() {\n            return \"no-static-inner\";\n        }\n    }\n\n    private static class InnerStaticClass {\n        // 静态内部类可以有静态成员，而非静态内部类则不能有静态成员。\n        private static String static_value = \"0\";\n\n        private int flag = 0;\n\n        public InnerStaticClass() {\n            System.out.println(\"InnerClass create a:\" + a);\n            // 静态内部类不能够访问外部类的非静态成员\n            // System.out.println(\"InnerClass create b:\" + b);\n            System.out.println(\"InnerStaticClass flag is \" + flag);\n            System.out.println(\"InnerStaticClass tt is \" + static_value);\n        }\n\n        public int getValue() {\n            // 静态内部类访问外部类的静态方法\n            test();\n            return 1;\n        }\n\n        public static String getMessage() {\n            return \"static-inner\";\n        }\n    }\n\n    public OutClassTest() {\n        // new一个非静态的内部类\n        InnerClass ic = new InnerClass();\n        System.out.println(\"OuterClass create\");\n    }\n\n}\n```\n\n**总结：** \n * 1.静态内部类可以有静态成员(方法，属性)，而非静态内部类则不能有静态成员(方法，属性)。\n * 2.静态内部类只能够访问外部类的静态成员,而非静态内部类则可以访问外部类的所有成员(方法，属性)。\n * 3.实例化一个非静态的内部类的方法：\n *  a.先生成一个外部类对象实例\n *  OutClassTest oc1 = new OutClassTest();\n *  b.通过外部类的对象实例生成内部类对象\n *  OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();\n *  4.实例化一个静态内部类的方法：\n *  a.不依赖于外部类的实例,直接实例化内部类对象\n *  OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();\n *  b.调用内部静态类的方法或静态变量,通过类名直接调用\n *  OutClassTest.InnerStaticClass.static_value\n *  OutClassTest.InnerStaticClass.getMessage()\n\n> references:  \n> http://hi.baidu.com/zhumulangma/item/bcd478c140427b2cef466532  \n> http://duqiangcise.iteye.com/blog/697476","source":"_posts/notebook/innerclass.md","raw":"# java 内部类和静态内部类的区别\n下面说一说内部类（Inner Class）和静态内部类（Static Nested Class）的区别：\n定义在一个类内部的类叫内部类，包含内部类的类称为外部类。内部类可以声明public、protected、private等访问限制，可以声明 为abstract的供其他内部类或外部类继承与扩展，或者声明为static、final的，也可以实现特定的接口。外部类按常规的类访问方式使用内部 类，唯一的差别是外部类可以访问内部类的所有方法与属性，包括私有方法与属性。\n\n## 一. 创建实例\n\n   OutClass.InnerClass obj = outClassInstance.new InnerClass(); //注意是外部类实例.new，内部类\n\n   AAA.StaticInner in = new AAA.StaticInner();//注意是外部类本身，静态内部类\n\n## 二. 内部类中的this\n\n   内 部类中的this与其他类一样是指的本身。创建内部类对象时，它会与创造它的外围对象有了某种联系，于是能访问外围类的所有成员，不需任何特殊条件，可理 解为内部类链接到外部类。 用外部类创建内部类对象时，此内部类对象会秘密的捕获一个指向外部类的引用，于是，可以通过这个引用来访问外围类的成员。\n\n## 三. 外部类访问内部类\n\n   内部类类似外部类的属性，因此访问内部类对象时总是需要一个创建好的外部类对象。内部类对象通过‘外部类名.this.xxx’的形式访问外部类的属性与方法。如：\n       System.out.println(\"Print in inner Outer.index=\" + pouter.this.index);\n       System.out.println(\"Print in inner Inner.index=\" + this.index);\n\n## 四. 内部类向上转型\n\n   内部类也可以和普通类一样拥有向上转型的特性。将内部类向上转型为基类型，尤其是接口时，内部类就有了用武之地。如果内部类是private的，只可以被它的外部类问，从而完全隐藏实现的细节。\n\n## 五. 方法内的类\n\n   方法内创建的类（注意方法中也能定义类），不能加访问修饰符。另外，方法内部的类也不是在调用方法时才会创建的，它们一样也被事先编译了。\n\n## 六. 静态内部类\n\n   定义静态内部类：在定义内部类的时候，可以在其前面加上一个权限修饰符static。此时这个内部类就变为了静态内部类。\n\n通常称为嵌套类，当内部类是static时，意味着：\n\n   [1]要创建嵌套类的对象，并不需要其外围类的对象；\n\n   [2]不能从嵌套类的对象中访问非静态的外围类对象（不能够从静态内部类的对象中访问外部类的非静态成员）；\n\n   嵌 套类与普通的内部类还有一个区别：普通内部类的字段与方法，只能放在类的外部层次上，所以普通的内部类不能有static数据和static字段， 也不能包含嵌套类。但是在嵌套类里可以包含所有这些东西。也就是说，在非静态内部类中不可以声明静态成员，只有将某个内部类修饰为静态类，然后才能够在这 个类中定义静态的成员变量与成员方法。\n\n   另外，在创建静态内部类时不需要将静态内部类的实例绑定在外部类的实例上。普通非静态内部类的 对象是依附在外部类对象之中的，要在一个外部类中定义一个静态的内部类，不需要利用关键字new来创建内部类的实例。静态类和方法只属于类本身，并不属于 该类的对象，更不属于其他外部类的对象。\n\n## 七. 内部类标识符\n\n   每个类会产生一个.class文件，文件名即为类名。同样，内部类也会产生这么一个.class文件，但是它的名称却不是内部类的类名，而是有着严格的限制：外围类的名字，加上$,再加上内部类名字。\n\n## 八. 为何要用内部类？\n\n   1.   内部类一般只为其外部类使用；\n\n   2.   内部类提供了某种进入外部类的窗户；\n\n   3.   也是最吸引人的原因，每个内部类都能独立地继承一个接口，而无论外部类是否已经继承了某个接口。因此，内部类使多重继承的解决方案变得更加完整。\n\n \n\n加深印象，参考一下：\n```java\npackage com.test.xml;\npublic class OutClassTest {\n    static int a;\n\n    int b;\n\n    public static void test() {\n        System.out.println(\"outer class static function\");\n    }\n\n    public static void main(String[] args) {\n        OutClassTest oc = new OutClassTest();\n        // new一个外部类\n        OutClassTest oc1 = new OutClassTest();\n        // 通过外部类的对象new一个非静态的内部类\n        OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();\n        // 调用非静态内部类的方法\n        System.out.println(no_static_inner.getKey());\n\n        // 调用静态内部类的静态变量\n        System.out.println(OutClassTest.InnerStaticClass.static_value);\n        // 不依赖于外部类实例,直接实例化内部静态类\n        OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();\n        // 调用静态内部类的非静态方法\n        System.out.println(inner.getValue());\n        // 调用内部静态类的静态方法\n        System.out.println(OutClassTest.InnerStaticClass.getMessage());\n    }\n\n    private class InnerClass {\n        // 只有在静态内部类中才能够声明或定义静态成员\n        // private static String tt = \"0\";\n        private int flag = 0;\n\n        public InnerClass() {\n            // 三.非静态内部类的非静态成员可以访问外部类的非静态变量和静态变量\n            System.out.println(\"InnerClass create a:\" + a);\n            System.out.println(\"InnerClass create b:\" + b);\n            System.out.println(\"InnerClass create flag:\" + flag);\n            //\n            System.out.println(\"InnerClass call outer static function\");\n            // 调用外部类的静态方法\n            test();\n        }\n\n        public  String getKey() {\n            return \"no-static-inner\";\n        }\n    }\n\n    private static class InnerStaticClass {\n        // 静态内部类可以有静态成员，而非静态内部类则不能有静态成员。\n        private static String static_value = \"0\";\n\n        private int flag = 0;\n\n        public InnerStaticClass() {\n            System.out.println(\"InnerClass create a:\" + a);\n            // 静态内部类不能够访问外部类的非静态成员\n            // System.out.println(\"InnerClass create b:\" + b);\n            System.out.println(\"InnerStaticClass flag is \" + flag);\n            System.out.println(\"InnerStaticClass tt is \" + static_value);\n        }\n\n        public int getValue() {\n            // 静态内部类访问外部类的静态方法\n            test();\n            return 1;\n        }\n\n        public static String getMessage() {\n            return \"static-inner\";\n        }\n    }\n\n    public OutClassTest() {\n        // new一个非静态的内部类\n        InnerClass ic = new InnerClass();\n        System.out.println(\"OuterClass create\");\n    }\n\n}\n```\n\n**总结：** \n * 1.静态内部类可以有静态成员(方法，属性)，而非静态内部类则不能有静态成员(方法，属性)。\n * 2.静态内部类只能够访问外部类的静态成员,而非静态内部类则可以访问外部类的所有成员(方法，属性)。\n * 3.实例化一个非静态的内部类的方法：\n *  a.先生成一个外部类对象实例\n *  OutClassTest oc1 = new OutClassTest();\n *  b.通过外部类的对象实例生成内部类对象\n *  OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();\n *  4.实例化一个静态内部类的方法：\n *  a.不依赖于外部类的实例,直接实例化内部类对象\n *  OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();\n *  b.调用内部静态类的方法或静态变量,通过类名直接调用\n *  OutClassTest.InnerStaticClass.static_value\n *  OutClassTest.InnerStaticClass.getMessage()\n\n> references:  \n> http://hi.baidu.com/zhumulangma/item/bcd478c140427b2cef466532  \n> http://duqiangcise.iteye.com/blog/697476","slug":"notebook/innerclass","published":1,"date":"2020-03-11T15:49:48.779Z","updated":"2020-03-11T15:52:31.602Z","title":"notebook/innerclass","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980b0086018oe7za831l","content":"<h1 id=\"java-内部类和静态内部类的区别\"><a href=\"#java-内部类和静态内部类的区别\" class=\"headerlink\" title=\"java 内部类和静态内部类的区别\"></a>java 内部类和静态内部类的区别</h1><p>下面说一说内部类（Inner Class）和静态内部类（Static Nested Class）的区别：<br>定义在一个类内部的类叫内部类，包含内部类的类称为外部类。内部类可以声明public、protected、private等访问限制，可以声明 为abstract的供其他内部类或外部类继承与扩展，或者声明为static、final的，也可以实现特定的接口。外部类按常规的类访问方式使用内部 类，唯一的差别是外部类可以访问内部类的所有方法与属性，包括私有方法与属性。</p>\n<h2 id=\"一-创建实例\"><a href=\"#一-创建实例\" class=\"headerlink\" title=\"一. 创建实例\"></a>一. 创建实例</h2><p>   OutClass.InnerClass obj = outClassInstance.new InnerClass(); //注意是外部类实例.new，内部类</p>\n<p>   AAA.StaticInner in = new AAA.StaticInner();//注意是外部类本身，静态内部类</p>\n<h2 id=\"二-内部类中的this\"><a href=\"#二-内部类中的this\" class=\"headerlink\" title=\"二. 内部类中的this\"></a>二. 内部类中的this</h2><p>   内 部类中的this与其他类一样是指的本身。创建内部类对象时，它会与创造它的外围对象有了某种联系，于是能访问外围类的所有成员，不需任何特殊条件，可理 解为内部类链接到外部类。 用外部类创建内部类对象时，此内部类对象会秘密的捕获一个指向外部类的引用，于是，可以通过这个引用来访问外围类的成员。</p>\n<h2 id=\"三-外部类访问内部类\"><a href=\"#三-外部类访问内部类\" class=\"headerlink\" title=\"三. 外部类访问内部类\"></a>三. 外部类访问内部类</h2><p>   内部类类似外部类的属性，因此访问内部类对象时总是需要一个创建好的外部类对象。内部类对象通过‘外部类名.this.xxx’的形式访问外部类的属性与方法。如：<br>       System.out.println(“Print in inner Outer.index=” + pouter.this.index);<br>       System.out.println(“Print in inner Inner.index=” + this.index);</p>\n<h2 id=\"四-内部类向上转型\"><a href=\"#四-内部类向上转型\" class=\"headerlink\" title=\"四. 内部类向上转型\"></a>四. 内部类向上转型</h2><p>   内部类也可以和普通类一样拥有向上转型的特性。将内部类向上转型为基类型，尤其是接口时，内部类就有了用武之地。如果内部类是private的，只可以被它的外部类问，从而完全隐藏实现的细节。</p>\n<h2 id=\"五-方法内的类\"><a href=\"#五-方法内的类\" class=\"headerlink\" title=\"五. 方法内的类\"></a>五. 方法内的类</h2><p>   方法内创建的类（注意方法中也能定义类），不能加访问修饰符。另外，方法内部的类也不是在调用方法时才会创建的，它们一样也被事先编译了。</p>\n<h2 id=\"六-静态内部类\"><a href=\"#六-静态内部类\" class=\"headerlink\" title=\"六. 静态内部类\"></a>六. 静态内部类</h2><p>   定义静态内部类：在定义内部类的时候，可以在其前面加上一个权限修饰符static。此时这个内部类就变为了静态内部类。</p>\n<p>通常称为嵌套类，当内部类是static时，意味着：</p>\n<p>   [1]要创建嵌套类的对象，并不需要其外围类的对象；</p>\n<p>   [2]不能从嵌套类的对象中访问非静态的外围类对象（不能够从静态内部类的对象中访问外部类的非静态成员）；</p>\n<p>   嵌 套类与普通的内部类还有一个区别：普通内部类的字段与方法，只能放在类的外部层次上，所以普通的内部类不能有static数据和static字段， 也不能包含嵌套类。但是在嵌套类里可以包含所有这些东西。也就是说，在非静态内部类中不可以声明静态成员，只有将某个内部类修饰为静态类，然后才能够在这 个类中定义静态的成员变量与成员方法。</p>\n<p>   另外，在创建静态内部类时不需要将静态内部类的实例绑定在外部类的实例上。普通非静态内部类的 对象是依附在外部类对象之中的，要在一个外部类中定义一个静态的内部类，不需要利用关键字new来创建内部类的实例。静态类和方法只属于类本身，并不属于 该类的对象，更不属于其他外部类的对象。</p>\n<h2 id=\"七-内部类标识符\"><a href=\"#七-内部类标识符\" class=\"headerlink\" title=\"七. 内部类标识符\"></a>七. 内部类标识符</h2><p>   每个类会产生一个.class文件，文件名即为类名。同样，内部类也会产生这么一个.class文件，但是它的名称却不是内部类的类名，而是有着严格的限制：外围类的名字，加上$,再加上内部类名字。</p>\n<h2 id=\"八-为何要用内部类？\"><a href=\"#八-为何要用内部类？\" class=\"headerlink\" title=\"八. 为何要用内部类？\"></a>八. 为何要用内部类？</h2><ol>\n<li><p>内部类一般只为其外部类使用；</p>\n</li>\n<li><p>内部类提供了某种进入外部类的窗户；</p>\n</li>\n<li><p>也是最吸引人的原因，每个内部类都能独立地继承一个接口，而无论外部类是否已经继承了某个接口。因此，内部类使多重继承的解决方案变得更加完整。</p>\n</li>\n</ol>\n<p>加深印象，参考一下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.test.xml;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OutClassTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> a;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> b;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"outer class static function\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        OutClassTest oc = <span class=\"keyword\">new</span> OutClassTest();</span><br><span class=\"line\">        <span class=\"comment\">// new一个外部类</span></span><br><span class=\"line\">        OutClassTest oc1 = <span class=\"keyword\">new</span> OutClassTest();</span><br><span class=\"line\">        <span class=\"comment\">// 通过外部类的对象new一个非静态的内部类</span></span><br><span class=\"line\">        OutClassTest.InnerClass no_static_inner = oc1.<span class=\"keyword\">new</span> InnerClass();</span><br><span class=\"line\">        <span class=\"comment\">// 调用非静态内部类的方法</span></span><br><span class=\"line\">        System.out.println(no_static_inner.getKey());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 调用静态内部类的静态变量</span></span><br><span class=\"line\">        System.out.println(OutClassTest.InnerStaticClass.static_value);</span><br><span class=\"line\">        <span class=\"comment\">// 不依赖于外部类实例,直接实例化内部静态类</span></span><br><span class=\"line\">        OutClassTest.InnerStaticClass inner = <span class=\"keyword\">new</span> OutClassTest.InnerStaticClass();</span><br><span class=\"line\">        <span class=\"comment\">// 调用静态内部类的非静态方法</span></span><br><span class=\"line\">        System.out.println(inner.getValue());</span><br><span class=\"line\">        <span class=\"comment\">// 调用内部静态类的静态方法</span></span><br><span class=\"line\">        System.out.println(OutClassTest.InnerStaticClass.getMessage());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InnerClass</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 只有在静态内部类中才能够声明或定义静态成员</span></span><br><span class=\"line\">        <span class=\"comment\">// private static String tt = \"0\";</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">InnerClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 三.非静态内部类的非静态成员可以访问外部类的非静态变量和静态变量</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create a:\"</span> + a);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create b:\"</span> + b);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create flag:\"</span> + flag);</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass call outer static function\"</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 调用外部类的静态方法</span></span><br><span class=\"line\">            test();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span>  String <span class=\"title\">getKey</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"no-static-inner\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InnerStaticClass</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 静态内部类可以有静态成员，而非静态内部类则不能有静态成员。</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String static_value = <span class=\"string\">\"0\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">InnerStaticClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create a:\"</span> + a);</span><br><span class=\"line\">            <span class=\"comment\">// 静态内部类不能够访问外部类的非静态成员</span></span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(\"InnerClass create b:\" + b);</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerStaticClass flag is \"</span> + flag);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerStaticClass tt is \"</span> + static_value);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getValue</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 静态内部类访问外部类的静态方法</span></span><br><span class=\"line\">            test();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getMessage</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"static-inner\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">OutClassTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// new一个非静态的内部类</span></span><br><span class=\"line\">        InnerClass ic = <span class=\"keyword\">new</span> InnerClass();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"OuterClass create\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>总结：</strong> </p>\n<ul>\n<li>1.静态内部类可以有静态成员(方法，属性)，而非静态内部类则不能有静态成员(方法，属性)。</li>\n<li>2.静态内部类只能够访问外部类的静态成员,而非静态内部类则可以访问外部类的所有成员(方法，属性)。</li>\n<li>3.实例化一个非静态的内部类的方法：</li>\n<li>a.先生成一个外部类对象实例</li>\n<li>OutClassTest oc1 = new OutClassTest();</li>\n<li>b.通过外部类的对象实例生成内部类对象</li>\n<li>OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();</li>\n<li>4.实例化一个静态内部类的方法：</li>\n<li>a.不依赖于外部类的实例,直接实例化内部类对象</li>\n<li>OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();</li>\n<li>b.调用内部静态类的方法或静态变量,通过类名直接调用</li>\n<li>OutClassTest.InnerStaticClass.static_value</li>\n<li>OutClassTest.InnerStaticClass.getMessage()</li>\n</ul>\n<blockquote>\n<p>references:<br><span class=\"exturl\" data-url=\"aHR0cDovL2hpLmJhaWR1LmNvbS96aHVtdWxhbmdtYS9pdGVtL2JjZDQ3OGMxNDA0MjdiMmNlZjQ2NjUzMg==\">http://hi.baidu.com/zhumulangma/item/bcd478c140427b2cef466532<i class=\"fa fa-external-link-alt\"></i></span><br><span class=\"exturl\" data-url=\"aHR0cDovL2R1cWlhbmdjaXNlLml0ZXllLmNvbS9ibG9nLzY5NzQ3Ng==\">http://duqiangcise.iteye.com/blog/697476<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"java-内部类和静态内部类的区别\"><a href=\"#java-内部类和静态内部类的区别\" class=\"headerlink\" title=\"java 内部类和静态内部类的区别\"></a>java 内部类和静态内部类的区别</h1><p>下面说一说内部类（Inner Class）和静态内部类（Static Nested Class）的区别：<br>定义在一个类内部的类叫内部类，包含内部类的类称为外部类。内部类可以声明public、protected、private等访问限制，可以声明 为abstract的供其他内部类或外部类继承与扩展，或者声明为static、final的，也可以实现特定的接口。外部类按常规的类访问方式使用内部 类，唯一的差别是外部类可以访问内部类的所有方法与属性，包括私有方法与属性。</p>\n<h2 id=\"一-创建实例\"><a href=\"#一-创建实例\" class=\"headerlink\" title=\"一. 创建实例\"></a>一. 创建实例</h2><p>   OutClass.InnerClass obj = outClassInstance.new InnerClass(); //注意是外部类实例.new，内部类</p>\n<p>   AAA.StaticInner in = new AAA.StaticInner();//注意是外部类本身，静态内部类</p>\n<h2 id=\"二-内部类中的this\"><a href=\"#二-内部类中的this\" class=\"headerlink\" title=\"二. 内部类中的this\"></a>二. 内部类中的this</h2><p>   内 部类中的this与其他类一样是指的本身。创建内部类对象时，它会与创造它的外围对象有了某种联系，于是能访问外围类的所有成员，不需任何特殊条件，可理 解为内部类链接到外部类。 用外部类创建内部类对象时，此内部类对象会秘密的捕获一个指向外部类的引用，于是，可以通过这个引用来访问外围类的成员。</p>\n<h2 id=\"三-外部类访问内部类\"><a href=\"#三-外部类访问内部类\" class=\"headerlink\" title=\"三. 外部类访问内部类\"></a>三. 外部类访问内部类</h2><p>   内部类类似外部类的属性，因此访问内部类对象时总是需要一个创建好的外部类对象。内部类对象通过‘外部类名.this.xxx’的形式访问外部类的属性与方法。如：<br>       System.out.println(“Print in inner Outer.index=” + pouter.this.index);<br>       System.out.println(“Print in inner Inner.index=” + this.index);</p>\n<h2 id=\"四-内部类向上转型\"><a href=\"#四-内部类向上转型\" class=\"headerlink\" title=\"四. 内部类向上转型\"></a>四. 内部类向上转型</h2><p>   内部类也可以和普通类一样拥有向上转型的特性。将内部类向上转型为基类型，尤其是接口时，内部类就有了用武之地。如果内部类是private的，只可以被它的外部类问，从而完全隐藏实现的细节。</p>\n<h2 id=\"五-方法内的类\"><a href=\"#五-方法内的类\" class=\"headerlink\" title=\"五. 方法内的类\"></a>五. 方法内的类</h2><p>   方法内创建的类（注意方法中也能定义类），不能加访问修饰符。另外，方法内部的类也不是在调用方法时才会创建的，它们一样也被事先编译了。</p>\n<h2 id=\"六-静态内部类\"><a href=\"#六-静态内部类\" class=\"headerlink\" title=\"六. 静态内部类\"></a>六. 静态内部类</h2><p>   定义静态内部类：在定义内部类的时候，可以在其前面加上一个权限修饰符static。此时这个内部类就变为了静态内部类。</p>\n<p>通常称为嵌套类，当内部类是static时，意味着：</p>\n<p>   [1]要创建嵌套类的对象，并不需要其外围类的对象；</p>\n<p>   [2]不能从嵌套类的对象中访问非静态的外围类对象（不能够从静态内部类的对象中访问外部类的非静态成员）；</p>\n<p>   嵌 套类与普通的内部类还有一个区别：普通内部类的字段与方法，只能放在类的外部层次上，所以普通的内部类不能有static数据和static字段， 也不能包含嵌套类。但是在嵌套类里可以包含所有这些东西。也就是说，在非静态内部类中不可以声明静态成员，只有将某个内部类修饰为静态类，然后才能够在这 个类中定义静态的成员变量与成员方法。</p>\n<p>   另外，在创建静态内部类时不需要将静态内部类的实例绑定在外部类的实例上。普通非静态内部类的 对象是依附在外部类对象之中的，要在一个外部类中定义一个静态的内部类，不需要利用关键字new来创建内部类的实例。静态类和方法只属于类本身，并不属于 该类的对象，更不属于其他外部类的对象。</p>\n<h2 id=\"七-内部类标识符\"><a href=\"#七-内部类标识符\" class=\"headerlink\" title=\"七. 内部类标识符\"></a>七. 内部类标识符</h2><p>   每个类会产生一个.class文件，文件名即为类名。同样，内部类也会产生这么一个.class文件，但是它的名称却不是内部类的类名，而是有着严格的限制：外围类的名字，加上$,再加上内部类名字。</p>\n<h2 id=\"八-为何要用内部类？\"><a href=\"#八-为何要用内部类？\" class=\"headerlink\" title=\"八. 为何要用内部类？\"></a>八. 为何要用内部类？</h2><ol>\n<li><p>内部类一般只为其外部类使用；</p>\n</li>\n<li><p>内部类提供了某种进入外部类的窗户；</p>\n</li>\n<li><p>也是最吸引人的原因，每个内部类都能独立地继承一个接口，而无论外部类是否已经继承了某个接口。因此，内部类使多重继承的解决方案变得更加完整。</p>\n</li>\n</ol>\n<p>加深印象，参考一下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.test.xml;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OutClassTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> a;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> b;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"outer class static function\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        OutClassTest oc = <span class=\"keyword\">new</span> OutClassTest();</span><br><span class=\"line\">        <span class=\"comment\">// new一个外部类</span></span><br><span class=\"line\">        OutClassTest oc1 = <span class=\"keyword\">new</span> OutClassTest();</span><br><span class=\"line\">        <span class=\"comment\">// 通过外部类的对象new一个非静态的内部类</span></span><br><span class=\"line\">        OutClassTest.InnerClass no_static_inner = oc1.<span class=\"keyword\">new</span> InnerClass();</span><br><span class=\"line\">        <span class=\"comment\">// 调用非静态内部类的方法</span></span><br><span class=\"line\">        System.out.println(no_static_inner.getKey());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 调用静态内部类的静态变量</span></span><br><span class=\"line\">        System.out.println(OutClassTest.InnerStaticClass.static_value);</span><br><span class=\"line\">        <span class=\"comment\">// 不依赖于外部类实例,直接实例化内部静态类</span></span><br><span class=\"line\">        OutClassTest.InnerStaticClass inner = <span class=\"keyword\">new</span> OutClassTest.InnerStaticClass();</span><br><span class=\"line\">        <span class=\"comment\">// 调用静态内部类的非静态方法</span></span><br><span class=\"line\">        System.out.println(inner.getValue());</span><br><span class=\"line\">        <span class=\"comment\">// 调用内部静态类的静态方法</span></span><br><span class=\"line\">        System.out.println(OutClassTest.InnerStaticClass.getMessage());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InnerClass</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 只有在静态内部类中才能够声明或定义静态成员</span></span><br><span class=\"line\">        <span class=\"comment\">// private static String tt = \"0\";</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">InnerClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 三.非静态内部类的非静态成员可以访问外部类的非静态变量和静态变量</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create a:\"</span> + a);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create b:\"</span> + b);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create flag:\"</span> + flag);</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass call outer static function\"</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 调用外部类的静态方法</span></span><br><span class=\"line\">            test();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span>  String <span class=\"title\">getKey</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"no-static-inner\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InnerStaticClass</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 静态内部类可以有静态成员，而非静态内部类则不能有静态成员。</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String static_value = <span class=\"string\">\"0\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">InnerStaticClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerClass create a:\"</span> + a);</span><br><span class=\"line\">            <span class=\"comment\">// 静态内部类不能够访问外部类的非静态成员</span></span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(\"InnerClass create b:\" + b);</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerStaticClass flag is \"</span> + flag);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"InnerStaticClass tt is \"</span> + static_value);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getValue</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 静态内部类访问外部类的静态方法</span></span><br><span class=\"line\">            test();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getMessage</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"static-inner\"</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">OutClassTest</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// new一个非静态的内部类</span></span><br><span class=\"line\">        InnerClass ic = <span class=\"keyword\">new</span> InnerClass();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"OuterClass create\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>总结：</strong> </p>\n<ul>\n<li>1.静态内部类可以有静态成员(方法，属性)，而非静态内部类则不能有静态成员(方法，属性)。</li>\n<li>2.静态内部类只能够访问外部类的静态成员,而非静态内部类则可以访问外部类的所有成员(方法，属性)。</li>\n<li>3.实例化一个非静态的内部类的方法：</li>\n<li>a.先生成一个外部类对象实例</li>\n<li>OutClassTest oc1 = new OutClassTest();</li>\n<li>b.通过外部类的对象实例生成内部类对象</li>\n<li>OutClassTest.InnerClass no_static_inner = oc1.new InnerClass();</li>\n<li>4.实例化一个静态内部类的方法：</li>\n<li>a.不依赖于外部类的实例,直接实例化内部类对象</li>\n<li>OutClassTest.InnerStaticClass inner = new OutClassTest.InnerStaticClass();</li>\n<li>b.调用内部静态类的方法或静态变量,通过类名直接调用</li>\n<li>OutClassTest.InnerStaticClass.static_value</li>\n<li>OutClassTest.InnerStaticClass.getMessage()</li>\n</ul>\n<blockquote>\n<p>references:<br><span class=\"exturl\" data-url=\"aHR0cDovL2hpLmJhaWR1LmNvbS96aHVtdWxhbmdtYS9pdGVtL2JjZDQ3OGMxNDA0MjdiMmNlZjQ2NjUzMg==\">http://hi.baidu.com/zhumulangma/item/bcd478c140427b2cef466532<i class=\"fa fa-external-link-alt\"></i></span><br><span class=\"exturl\" data-url=\"aHR0cDovL2R1cWlhbmdjaXNlLml0ZXllLmNvbS9ibG9nLzY5NzQ3Ng==\">http://duqiangcise.iteye.com/blog/697476<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"_content":"# Java反射\n\n","source":"_posts/notebook/java-class.md","raw":"# Java反射\n\n","slug":"notebook/java-class","published":1,"date":"2020-04-08T13:27:23.783Z","updated":"2020-04-08T13:29:34.765Z","title":"notebook/java-class","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980b0089018obdgdaw6k","content":"<h1 id=\"Java反射\"><a href=\"#Java反射\" class=\"headerlink\" title=\"Java反射\"></a>Java反射</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Java反射\"><a href=\"#Java反射\" class=\"headerlink\" title=\"Java反射\"></a>Java反射</h1>"},{"_content":"# 对Jupyter添加Kernel\n\n## 对虚拟环境的操作\n\n进入想要添加到Jupyter的Python虚拟环境\n\n`conda activate pytorch`\n\n安装`ipykernel`\n\n`conda install ipykernel`\n\n在虚拟环境中执行以下以添加Kernel到Jupyter\n\n`python -m ipykernel install --name kernelname`\n\n## 对Jupyter的操作\n\n查看存在的Kernel\n\n`jupyter kernelspec list`\n\n删除Kernel\n\n`jupyter kernelspec remove kernelname`\n\n","source":"_posts/notebook/jupyter-kernel.md","raw":"# 对Jupyter添加Kernel\n\n## 对虚拟环境的操作\n\n进入想要添加到Jupyter的Python虚拟环境\n\n`conda activate pytorch`\n\n安装`ipykernel`\n\n`conda install ipykernel`\n\n在虚拟环境中执行以下以添加Kernel到Jupyter\n\n`python -m ipykernel install --name kernelname`\n\n## 对Jupyter的操作\n\n查看存在的Kernel\n\n`jupyter kernelspec list`\n\n删除Kernel\n\n`jupyter kernelspec remove kernelname`\n\n","slug":"notebook/jupyter-kernel","published":1,"date":"2020-11-06T17:34:26.627Z","updated":"2020-11-06T17:38:41.165Z","title":"notebook/jupyter-kernel","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980c008d018o82cta178","content":"<h1 id=\"对Jupyter添加Kernel\"><a href=\"#对Jupyter添加Kernel\" class=\"headerlink\" title=\"对Jupyter添加Kernel\"></a>对Jupyter添加Kernel</h1><h2 id=\"对虚拟环境的操作\"><a href=\"#对虚拟环境的操作\" class=\"headerlink\" title=\"对虚拟环境的操作\"></a>对虚拟环境的操作</h2><p>进入想要添加到Jupyter的Python虚拟环境</p>\n<p><code>conda activate pytorch</code></p>\n<p>安装<code>ipykernel</code></p>\n<p><code>conda install ipykernel</code></p>\n<p>在虚拟环境中执行以下以添加Kernel到Jupyter</p>\n<p><code>python -m ipykernel install --name kernelname</code></p>\n<h2 id=\"对Jupyter的操作\"><a href=\"#对Jupyter的操作\" class=\"headerlink\" title=\"对Jupyter的操作\"></a>对Jupyter的操作</h2><p>查看存在的Kernel</p>\n<p><code>jupyter kernelspec list</code></p>\n<p>删除Kernel</p>\n<p><code>jupyter kernelspec remove kernelname</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"对Jupyter添加Kernel\"><a href=\"#对Jupyter添加Kernel\" class=\"headerlink\" title=\"对Jupyter添加Kernel\"></a>对Jupyter添加Kernel</h1><h2 id=\"对虚拟环境的操作\"><a href=\"#对虚拟环境的操作\" class=\"headerlink\" title=\"对虚拟环境的操作\"></a>对虚拟环境的操作</h2><p>进入想要添加到Jupyter的Python虚拟环境</p>\n<p><code>conda activate pytorch</code></p>\n<p>安装<code>ipykernel</code></p>\n<p><code>conda install ipykernel</code></p>\n<p>在虚拟环境中执行以下以添加Kernel到Jupyter</p>\n<p><code>python -m ipykernel install --name kernelname</code></p>\n<h2 id=\"对Jupyter的操作\"><a href=\"#对Jupyter的操作\" class=\"headerlink\" title=\"对Jupyter的操作\"></a>对Jupyter的操作</h2><p>查看存在的Kernel</p>\n<p><code>jupyter kernelspec list</code></p>\n<p>删除Kernel</p>\n<p><code>jupyter kernelspec remove kernelname</code></p>\n"},{"_content":"# Implements & Extends 的不同\n\n**在类的声明中，通过关键字extends来创建一个类的子类；一个类通过关键字implements声明自己使用一个或者多个接口。**\n\n- extends 是继承某个类, 继承之后可以使用父类的方法, 也可以重写父类的方法; \n\n- implements 是实现多个接口, 接口的方法一般为空的, 必须重写才能使用；\n\n- extends是继承父类，只要那个类不是声明为final或者那个类定义为abstract的就能继承；\n\n- Java中不支持多重继承，但是可以用接口来实现，这样就要用到implements，继承只能继承一个类，但implements可以实现多个接口，用逗号分开就行了 比如 ：`class A extends B implements C,D,E`。\n\n**接口实现的注意点：**  \n\n- 实现一个接口就是要实现该接口的所有的方法(抽象类除外)；\n\n- 接口中的方法都是抽象的；\n\n- 多个无关的类可以实现同一个接口，一个类可以实现多个无关的接口。\n\n**Implements与Extends的不同**\n\nextends， 可以实现父类，也可以调用父类初始化 this.parent()。而且会覆盖父类定义的变量或者函数。这样的好处是：架构师定义好接口，让工程师实现就可以了。整个项目开发效率和开发成本大大降低。    \n\nimplements，实现父类，子类不可以覆盖父类的方法或者变量。即使子类定义与父类相同的变量或者函数，也会被父类取代掉。  \n\n这两种实现的具体使用，是要看项目的实际情况，需要实现，不可以修改implements，只定义接口需要具体实现，或者可以被修改扩展性好，用extends。\n\n> Reference  \n> https://blog.csdn.net/tolcf/article/details/46135645","source":"_posts/notebook/implements-extends.md","raw":"# Implements & Extends 的不同\n\n**在类的声明中，通过关键字extends来创建一个类的子类；一个类通过关键字implements声明自己使用一个或者多个接口。**\n\n- extends 是继承某个类, 继承之后可以使用父类的方法, 也可以重写父类的方法; \n\n- implements 是实现多个接口, 接口的方法一般为空的, 必须重写才能使用；\n\n- extends是继承父类，只要那个类不是声明为final或者那个类定义为abstract的就能继承；\n\n- Java中不支持多重继承，但是可以用接口来实现，这样就要用到implements，继承只能继承一个类，但implements可以实现多个接口，用逗号分开就行了 比如 ：`class A extends B implements C,D,E`。\n\n**接口实现的注意点：**  \n\n- 实现一个接口就是要实现该接口的所有的方法(抽象类除外)；\n\n- 接口中的方法都是抽象的；\n\n- 多个无关的类可以实现同一个接口，一个类可以实现多个无关的接口。\n\n**Implements与Extends的不同**\n\nextends， 可以实现父类，也可以调用父类初始化 this.parent()。而且会覆盖父类定义的变量或者函数。这样的好处是：架构师定义好接口，让工程师实现就可以了。整个项目开发效率和开发成本大大降低。    \n\nimplements，实现父类，子类不可以覆盖父类的方法或者变量。即使子类定义与父类相同的变量或者函数，也会被父类取代掉。  \n\n这两种实现的具体使用，是要看项目的实际情况，需要实现，不可以修改implements，只定义接口需要具体实现，或者可以被修改扩展性好，用extends。\n\n> Reference  \n> https://blog.csdn.net/tolcf/article/details/46135645","slug":"notebook/implements-extends","published":1,"date":"2020-03-08T10:56:21.551Z","updated":"2020-03-11T15:48:52.517Z","title":"notebook/implements-extends","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980d008g018oh1z9gzb9","content":"<h1 id=\"Implements-amp-Extends-的不同\"><a href=\"#Implements-amp-Extends-的不同\" class=\"headerlink\" title=\"Implements &amp; Extends 的不同\"></a>Implements &amp; Extends 的不同</h1><p><strong>在类的声明中，通过关键字extends来创建一个类的子类；一个类通过关键字implements声明自己使用一个或者多个接口。</strong></p>\n<ul>\n<li><p>extends 是继承某个类, 继承之后可以使用父类的方法, 也可以重写父类的方法; </p>\n</li>\n<li><p>implements 是实现多个接口, 接口的方法一般为空的, 必须重写才能使用；</p>\n</li>\n<li><p>extends是继承父类，只要那个类不是声明为final或者那个类定义为abstract的就能继承；</p>\n</li>\n<li><p>Java中不支持多重继承，但是可以用接口来实现，这样就要用到implements，继承只能继承一个类，但implements可以实现多个接口，用逗号分开就行了 比如 ：<code>class A extends B implements C,D,E</code>。</p>\n</li>\n</ul>\n<p><strong>接口实现的注意点：</strong>  </p>\n<ul>\n<li><p>实现一个接口就是要实现该接口的所有的方法(抽象类除外)；</p>\n</li>\n<li><p>接口中的方法都是抽象的；</p>\n</li>\n<li><p>多个无关的类可以实现同一个接口，一个类可以实现多个无关的接口。</p>\n</li>\n</ul>\n<p><strong>Implements与Extends的不同</strong></p>\n<p>extends， 可以实现父类，也可以调用父类初始化 this.parent()。而且会覆盖父类定义的变量或者函数。这样的好处是：架构师定义好接口，让工程师实现就可以了。整个项目开发效率和开发成本大大降低。    </p>\n<p>implements，实现父类，子类不可以覆盖父类的方法或者变量。即使子类定义与父类相同的变量或者函数，也会被父类取代掉。  </p>\n<p>这两种实现的具体使用，是要看项目的实际情况，需要实现，不可以修改implements，只定义接口需要具体实现，或者可以被修改扩展性好，用extends。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbGNmL2FydGljbGUvZGV0YWlscy80NjEzNTY0NQ==\">https://blog.csdn.net/tolcf/article/details/46135645<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Implements-amp-Extends-的不同\"><a href=\"#Implements-amp-Extends-的不同\" class=\"headerlink\" title=\"Implements &amp; Extends 的不同\"></a>Implements &amp; Extends 的不同</h1><p><strong>在类的声明中，通过关键字extends来创建一个类的子类；一个类通过关键字implements声明自己使用一个或者多个接口。</strong></p>\n<ul>\n<li><p>extends 是继承某个类, 继承之后可以使用父类的方法, 也可以重写父类的方法; </p>\n</li>\n<li><p>implements 是实现多个接口, 接口的方法一般为空的, 必须重写才能使用；</p>\n</li>\n<li><p>extends是继承父类，只要那个类不是声明为final或者那个类定义为abstract的就能继承；</p>\n</li>\n<li><p>Java中不支持多重继承，但是可以用接口来实现，这样就要用到implements，继承只能继承一个类，但implements可以实现多个接口，用逗号分开就行了 比如 ：<code>class A extends B implements C,D,E</code>。</p>\n</li>\n</ul>\n<p><strong>接口实现的注意点：</strong>  </p>\n<ul>\n<li><p>实现一个接口就是要实现该接口的所有的方法(抽象类除外)；</p>\n</li>\n<li><p>接口中的方法都是抽象的；</p>\n</li>\n<li><p>多个无关的类可以实现同一个接口，一个类可以实现多个无关的接口。</p>\n</li>\n</ul>\n<p><strong>Implements与Extends的不同</strong></p>\n<p>extends， 可以实现父类，也可以调用父类初始化 this.parent()。而且会覆盖父类定义的变量或者函数。这样的好处是：架构师定义好接口，让工程师实现就可以了。整个项目开发效率和开发成本大大降低。    </p>\n<p>implements，实现父类，子类不可以覆盖父类的方法或者变量。即使子类定义与父类相同的变量或者函数，也会被父类取代掉。  </p>\n<p>这两种实现的具体使用，是要看项目的实际情况，需要实现，不可以修改implements，只定义接口需要具体实现，或者可以被修改扩展性好，用extends。</p>\n<blockquote>\n<p>Reference<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RvbGNmL2FydGljbGUvZGV0YWlscy80NjEzNTY0NQ==\">https://blog.csdn.net/tolcf/article/details/46135645<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"title":"键帽入坑","catagories":["Notebook"],"_content":"\n# 材质\n\n## ABS\n\n### 缺点\n\n- 打油（之前的雷蛇黑寡妇87）\n\n### 优点\n\n- 透光好\n- 耐高温\n\n## PBT\n\n### 优点\n\n- 磨砂质感不易打油\n\n### 缺点\n\n- 透光不好\n- 不耐高温\n\n# 印刷\n\n- 激光蚀刻（容易磨）\n- 热升华（）\n- 二色成型（两种颜色镂空显色）\n\n# 高度\n\n- Cherry高度\n- OEM高度\n- 球帽高度\n\n\n\n\n\n\n\n","source":"_posts/notebook/keycap.md","raw":"---\ntitle: 键帽入坑\ncatagories:\n- Notebook\ntags:\n- keyboard\n- keycap\n---\n\n# 材质\n\n## ABS\n\n### 缺点\n\n- 打油（之前的雷蛇黑寡妇87）\n\n### 优点\n\n- 透光好\n- 耐高温\n\n## PBT\n\n### 优点\n\n- 磨砂质感不易打油\n\n### 缺点\n\n- 透光不好\n- 不耐高温\n\n# 印刷\n\n- 激光蚀刻（容易磨）\n- 热升华（）\n- 二色成型（两种颜色镂空显色）\n\n# 高度\n\n- Cherry高度\n- OEM高度\n- 球帽高度\n\n\n\n\n\n\n\n","slug":"notebook/keycap","published":1,"date":"2021-03-09T14:19:30.256Z","updated":"2021-03-09T15:02:38.218Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx980e008i018o8oizfad9","content":"<h1 id=\"材质\"><a href=\"#材质\" class=\"headerlink\" title=\"材质\"></a>材质</h1><h2 id=\"ABS\"><a href=\"#ABS\" class=\"headerlink\" title=\"ABS\"></a>ABS</h2><h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>打油（之前的雷蛇黑寡妇87）</li>\n</ul>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>透光好</li>\n<li>耐高温</li>\n</ul>\n<h2 id=\"PBT\"><a href=\"#PBT\" class=\"headerlink\" title=\"PBT\"></a>PBT</h2><h3 id=\"优点-1\"><a href=\"#优点-1\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>磨砂质感不易打油</li>\n</ul>\n<h3 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>透光不好</li>\n<li>不耐高温</li>\n</ul>\n<h1 id=\"印刷\"><a href=\"#印刷\" class=\"headerlink\" title=\"印刷\"></a>印刷</h1><ul>\n<li>激光蚀刻（容易磨）</li>\n<li>热升华（）</li>\n<li>二色成型（两种颜色镂空显色）</li>\n</ul>\n<h1 id=\"高度\"><a href=\"#高度\" class=\"headerlink\" title=\"高度\"></a>高度</h1><ul>\n<li>Cherry高度</li>\n<li>OEM高度</li>\n<li>球帽高度</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"材质\"><a href=\"#材质\" class=\"headerlink\" title=\"材质\"></a>材质</h1><h2 id=\"ABS\"><a href=\"#ABS\" class=\"headerlink\" title=\"ABS\"></a>ABS</h2><h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>打油（之前的雷蛇黑寡妇87）</li>\n</ul>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>透光好</li>\n<li>耐高温</li>\n</ul>\n<h2 id=\"PBT\"><a href=\"#PBT\" class=\"headerlink\" title=\"PBT\"></a>PBT</h2><h3 id=\"优点-1\"><a href=\"#优点-1\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>磨砂质感不易打油</li>\n</ul>\n<h3 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>透光不好</li>\n<li>不耐高温</li>\n</ul>\n<h1 id=\"印刷\"><a href=\"#印刷\" class=\"headerlink\" title=\"印刷\"></a>印刷</h1><ul>\n<li>激光蚀刻（容易磨）</li>\n<li>热升华（）</li>\n<li>二色成型（两种颜色镂空显色）</li>\n</ul>\n<h1 id=\"高度\"><a href=\"#高度\" class=\"headerlink\" title=\"高度\"></a>高度</h1><ul>\n<li>Cherry高度</li>\n<li>OEM高度</li>\n<li>球帽高度</li>\n</ul>\n"},{"title":"Bilibili直播","_content":"\n# OBS推流的设置\n\n## 推流\n\n开始直播后把B站给的Server和StreamKey配置到OBS中。\n\n## 音频设置\n\n播放电脑内部声音。\n\n1. 下载Sound Flower捕捉电脑桌面的声音。\n2. 设置MIDI，创建多输出。\n3. 在OBS里设置音频输出就可以了。\n\n# 自习室的一些东西\n\n## Video\n\n录制好的视频可以通过AE的Mocha特效变成卡通风格～\n\n## Audio\n\nChill & Lofi Beats","source":"_posts/notebook/live-bilibili.md","raw":"---\ntitle: Bilibili直播\ncategories:\n- Notebook\ntags:\n- live\n- obs\n---\n\n# OBS推流的设置\n\n## 推流\n\n开始直播后把B站给的Server和StreamKey配置到OBS中。\n\n## 音频设置\n\n播放电脑内部声音。\n\n1. 下载Sound Flower捕捉电脑桌面的声音。\n2. 设置MIDI，创建多输出。\n3. 在OBS里设置音频输出就可以了。\n\n# 自习室的一些东西\n\n## Video\n\n录制好的视频可以通过AE的Mocha特效变成卡通风格～\n\n## Audio\n\nChill & Lofi Beats","slug":"notebook/live-bilibili","published":1,"date":"2021-02-21T06:53:46.236Z","updated":"2021-02-21T07:02:36.696Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9810009r018o8brr0sco","content":"<h1 id=\"OBS推流的设置\"><a href=\"#OBS推流的设置\" class=\"headerlink\" title=\"OBS推流的设置\"></a>OBS推流的设置</h1><h2 id=\"推流\"><a href=\"#推流\" class=\"headerlink\" title=\"推流\"></a>推流</h2><p>开始直播后把B站给的Server和StreamKey配置到OBS中。</p>\n<h2 id=\"音频设置\"><a href=\"#音频设置\" class=\"headerlink\" title=\"音频设置\"></a>音频设置</h2><p>播放电脑内部声音。</p>\n<ol>\n<li>下载Sound Flower捕捉电脑桌面的声音。</li>\n<li>设置MIDI，创建多输出。</li>\n<li>在OBS里设置音频输出就可以了。</li>\n</ol>\n<h1 id=\"自习室的一些东西\"><a href=\"#自习室的一些东西\" class=\"headerlink\" title=\"自习室的一些东西\"></a>自习室的一些东西</h1><h2 id=\"Video\"><a href=\"#Video\" class=\"headerlink\" title=\"Video\"></a>Video</h2><p>录制好的视频可以通过AE的Mocha特效变成卡通风格～</p>\n<h2 id=\"Audio\"><a href=\"#Audio\" class=\"headerlink\" title=\"Audio\"></a>Audio</h2><p>Chill &amp; Lofi Beats</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"OBS推流的设置\"><a href=\"#OBS推流的设置\" class=\"headerlink\" title=\"OBS推流的设置\"></a>OBS推流的设置</h1><h2 id=\"推流\"><a href=\"#推流\" class=\"headerlink\" title=\"推流\"></a>推流</h2><p>开始直播后把B站给的Server和StreamKey配置到OBS中。</p>\n<h2 id=\"音频设置\"><a href=\"#音频设置\" class=\"headerlink\" title=\"音频设置\"></a>音频设置</h2><p>播放电脑内部声音。</p>\n<ol>\n<li>下载Sound Flower捕捉电脑桌面的声音。</li>\n<li>设置MIDI，创建多输出。</li>\n<li>在OBS里设置音频输出就可以了。</li>\n</ol>\n<h1 id=\"自习室的一些东西\"><a href=\"#自习室的一些东西\" class=\"headerlink\" title=\"自习室的一些东西\"></a>自习室的一些东西</h1><h2 id=\"Video\"><a href=\"#Video\" class=\"headerlink\" title=\"Video\"></a>Video</h2><p>录制好的视频可以通过AE的Mocha特效变成卡通风格～</p>\n<h2 id=\"Audio\"><a href=\"#Audio\" class=\"headerlink\" title=\"Audio\"></a>Audio</h2><p>Chill &amp; Lofi Beats</p>\n"},{"_content":"# Java中继承与实现的思考\n\n继承(extend): 继承传达的意思是is-a, 比如Cat is an Animal.\n\n实现(Implement): 实现传达的意思是able一种能力, 比如Cat is swimmable.\n\n## extend\n比较灵活可以继承抽象类，也可以继承实体类。\n抽象类可以定义非抽象方法与抽象方法，如果有抽象方法则子类必须继承，如果子类没有重写非抽象方法则子类的实例使用的是父类的方法。\n\n**多态**\n如果实例化一个子类赋给一个父类(例: Animal cat = new Cat())， 则只能够使用父类中的field与method，如果method被子类重写则会调用子类的method。\n\n\n\n## implement\n比较严格，若实现则必须实现所有方法。\n其中的field都是static final修饰的，且只能被实现的子类获取。method不能有body，但是如果static修饰则可以有body(怎么用？)。\n\n**多态**\n如果实例化一个子类赋给一个接口(例: Swimmable cat = new Cat())，则只能够使用该接口的field并且无法获得field。\n如果一个子类继承了一个实现了该接口的父类则可以重写方法，如果没有重写则(Swimmable cat = new Cat())中cat获取的方法则是父类中实现的方法。","source":"_posts/notebook/implements-extends-2.md","raw":"# Java中继承与实现的思考\n\n继承(extend): 继承传达的意思是is-a, 比如Cat is an Animal.\n\n实现(Implement): 实现传达的意思是able一种能力, 比如Cat is swimmable.\n\n## extend\n比较灵活可以继承抽象类，也可以继承实体类。\n抽象类可以定义非抽象方法与抽象方法，如果有抽象方法则子类必须继承，如果子类没有重写非抽象方法则子类的实例使用的是父类的方法。\n\n**多态**\n如果实例化一个子类赋给一个父类(例: Animal cat = new Cat())， 则只能够使用父类中的field与method，如果method被子类重写则会调用子类的method。\n\n\n\n## implement\n比较严格，若实现则必须实现所有方法。\n其中的field都是static final修饰的，且只能被实现的子类获取。method不能有body，但是如果static修饰则可以有body(怎么用？)。\n\n**多态**\n如果实例化一个子类赋给一个接口(例: Swimmable cat = new Cat())，则只能够使用该接口的field并且无法获得field。\n如果一个子类继承了一个实现了该接口的父类则可以重写方法，如果没有重写则(Swimmable cat = new Cat())中cat获取的方法则是父类中实现的方法。","slug":"notebook/implements-extends-2","published":1,"date":"2020-09-16T03:31:35.238Z","updated":"2020-09-16T04:14:19.685Z","title":"notebook/implements-extends-2","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9811009s018og44j1bbd","content":"<h1 id=\"Java中继承与实现的思考\"><a href=\"#Java中继承与实现的思考\" class=\"headerlink\" title=\"Java中继承与实现的思考\"></a>Java中继承与实现的思考</h1><p>继承(extend): 继承传达的意思是is-a, 比如Cat is an Animal.</p>\n<p>实现(Implement): 实现传达的意思是able一种能力, 比如Cat is swimmable.</p>\n<h2 id=\"extend\"><a href=\"#extend\" class=\"headerlink\" title=\"extend\"></a>extend</h2><p>比较灵活可以继承抽象类，也可以继承实体类。<br>抽象类可以定义非抽象方法与抽象方法，如果有抽象方法则子类必须继承，如果子类没有重写非抽象方法则子类的实例使用的是父类的方法。</p>\n<p><strong>多态</strong><br>如果实例化一个子类赋给一个父类(例: Animal cat = new Cat())， 则只能够使用父类中的field与method，如果method被子类重写则会调用子类的method。</p>\n<h2 id=\"implement\"><a href=\"#implement\" class=\"headerlink\" title=\"implement\"></a>implement</h2><p>比较严格，若实现则必须实现所有方法。<br>其中的field都是static final修饰的，且只能被实现的子类获取。method不能有body，但是如果static修饰则可以有body(怎么用？)。</p>\n<p><strong>多态</strong><br>如果实例化一个子类赋给一个接口(例: Swimmable cat = new Cat())，则只能够使用该接口的field并且无法获得field。<br>如果一个子类继承了一个实现了该接口的父类则可以重写方法，如果没有重写则(Swimmable cat = new Cat())中cat获取的方法则是父类中实现的方法。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Java中继承与实现的思考\"><a href=\"#Java中继承与实现的思考\" class=\"headerlink\" title=\"Java中继承与实现的思考\"></a>Java中继承与实现的思考</h1><p>继承(extend): 继承传达的意思是is-a, 比如Cat is an Animal.</p>\n<p>实现(Implement): 实现传达的意思是able一种能力, 比如Cat is swimmable.</p>\n<h2 id=\"extend\"><a href=\"#extend\" class=\"headerlink\" title=\"extend\"></a>extend</h2><p>比较灵活可以继承抽象类，也可以继承实体类。<br>抽象类可以定义非抽象方法与抽象方法，如果有抽象方法则子类必须继承，如果子类没有重写非抽象方法则子类的实例使用的是父类的方法。</p>\n<p><strong>多态</strong><br>如果实例化一个子类赋给一个父类(例: Animal cat = new Cat())， 则只能够使用父类中的field与method，如果method被子类重写则会调用子类的method。</p>\n<h2 id=\"implement\"><a href=\"#implement\" class=\"headerlink\" title=\"implement\"></a>implement</h2><p>比较严格，若实现则必须实现所有方法。<br>其中的field都是static final修饰的，且只能被实现的子类获取。method不能有body，但是如果static修饰则可以有body(怎么用？)。</p>\n<p><strong>多态</strong><br>如果实例化一个子类赋给一个接口(例: Swimmable cat = new Cat())，则只能够使用该接口的field并且无法获得field。<br>如果一个子类继承了一个实现了该接口的父类则可以重写方法，如果没有重写则(Swimmable cat = new Cat())中cat获取的方法则是父类中实现的方法。</p>\n"},{"title":"Mysql改密码","catagories":["Notebook"],"_content":"\n# 进入Mysql后Set修改\n\n```mysql\nset password for root@localhost = password('abc');\n```\n\n# 用mysqladmin指令\n\n```shell\nmysqladmin -uroot -p123 password abc\n```\n\n把root的密码从123 改为 abc\n\n# 用update直接更新\n\n```mysql\nuse mysql;\nupdate user set password=password('abc') where user='root' and host='localhost';\nflush privileges;\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.w3cschool.cn/mysql/mysql-wauz2owl.html","source":"_posts/notebook/mysql-pwd.md","raw":"---\ntitle: Mysql改密码\ncatagories:\n- Notebook\ntags:\n- Mysql\n---\n\n# 进入Mysql后Set修改\n\n```mysql\nset password for root@localhost = password('abc');\n```\n\n# 用mysqladmin指令\n\n```shell\nmysqladmin -uroot -p123 password abc\n```\n\n把root的密码从123 改为 abc\n\n# 用update直接更新\n\n```mysql\nuse mysql;\nupdate user set password=password('abc') where user='root' and host='localhost';\nflush privileges;\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.w3cschool.cn/mysql/mysql-wauz2owl.html","slug":"notebook/mysql-pwd","published":1,"date":"2021-04-07T00:50:24.672Z","updated":"2021-04-07T00:58:48.205Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9812009u018o1gd204ft","content":"<h1 id=\"进入Mysql后Set修改\"><a href=\"#进入Mysql后Set修改\" class=\"headerlink\" title=\"进入Mysql后Set修改\"></a>进入Mysql后Set修改</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set password for root@localhost &#x3D; password(&#39;abc&#39;);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"用mysqladmin指令\"><a href=\"#用mysqladmin指令\" class=\"headerlink\" title=\"用mysqladmin指令\"></a>用mysqladmin指令</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -uroot -p123 password abc</span><br></pre></td></tr></table></figure>\n\n<p>把root的密码从123 改为 abc</p>\n<h1 id=\"用update直接更新\"><a href=\"#用update直接更新\" class=\"headerlink\" title=\"用update直接更新\"></a>用update直接更新</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use mysql;</span><br><span class=\"line\">update user set password&#x3D;password(&#39;abc&#39;) where user&#x3D;&#39;root&#39; and host&#x3D;&#39;localhost&#39;;</span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudzNjc2Nob29sLmNuL215c3FsL215c3FsLXdhdXoyb3dsLmh0bWw=\">https://www.w3cschool.cn/mysql/mysql-wauz2owl.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"进入Mysql后Set修改\"><a href=\"#进入Mysql后Set修改\" class=\"headerlink\" title=\"进入Mysql后Set修改\"></a>进入Mysql后Set修改</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set password for root@localhost &#x3D; password(&#39;abc&#39;);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"用mysqladmin指令\"><a href=\"#用mysqladmin指令\" class=\"headerlink\" title=\"用mysqladmin指令\"></a>用mysqladmin指令</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -uroot -p123 password abc</span><br></pre></td></tr></table></figure>\n\n<p>把root的密码从123 改为 abc</p>\n<h1 id=\"用update直接更新\"><a href=\"#用update直接更新\" class=\"headerlink\" title=\"用update直接更新\"></a>用update直接更新</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use mysql;</span><br><span class=\"line\">update user set password&#x3D;password(&#39;abc&#39;) where user&#x3D;&#39;root&#39; and host&#x3D;&#39;localhost&#39;;</span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudzNjc2Nob29sLmNuL215c3FsL215c3FsLXdhdXoyb3dsLmh0bWw=\">https://www.w3cschool.cn/mysql/mysql-wauz2owl.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Set default open up for specific extension file","_content":"\n# Procedure\n\nRight Click -> Get Info -> Open with -> Select App and Change All\n\n","source":"_posts/notebook/mac-default.md","raw":"---\ntitle: Set default open up for specific extension file\ncategories:\n- Notebook\ntags:\n- mac\n---\n\n# Procedure\n\nRight Click -> Get Info -> Open with -> Select App and Change All\n\n","slug":"notebook/mac-default","published":1,"date":"2021-08-29T03:44:42.210Z","updated":"2021-08-29T03:46:31.847Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9813009v018o4nam6ptb","content":"<h1 id=\"Procedure\"><a href=\"#Procedure\" class=\"headerlink\" title=\"Procedure\"></a>Procedure</h1><p>Right Click -&gt; Get Info -&gt; Open with -&gt; Select App and Change All</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Procedure\"><a href=\"#Procedure\" class=\"headerlink\" title=\"Procedure\"></a>Procedure</h1><p>Right Click -&gt; Get Info -&gt; Open with -&gt; Select App and Change All</p>\n"},{"title":"Set shortcut for screen saver","_content":"\n# Download\n\ndownload `Aerial`\n\n# Add shortcut\n\nThere's only hot corner, one way, to wake up screen saver. We need to use `Automator` to add a quickaction of start screen saver.\n\nThen set a short cut for this service in System Preferences -> Keyboard -> Shortcuts -> Services\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/carlos-liye/p/6681289.html","source":"_posts/notebook/mac-shortcut.md","raw":"---\ntitle: Set shortcut for screen saver\ncategories:\n- Notebook\ntags:\n- mac\n---\n\n# Download\n\ndownload `Aerial`\n\n# Add shortcut\n\nThere's only hot corner, one way, to wake up screen saver. We need to use `Automator` to add a quickaction of start screen saver.\n\nThen set a short cut for this service in System Preferences -> Keyboard -> Shortcuts -> Services\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/carlos-liye/p/6681289.html","slug":"notebook/mac-shortcut","published":1,"date":"2021-08-29T03:23:34.914Z","updated":"2021-08-29T03:44:08.206Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9813009x018oae438a4m","content":"<h1 id=\"Download\"><a href=\"#Download\" class=\"headerlink\" title=\"Download\"></a>Download</h1><p>download <code>Aerial</code></p>\n<h1 id=\"Add-shortcut\"><a href=\"#Add-shortcut\" class=\"headerlink\" title=\"Add shortcut\"></a>Add shortcut</h1><p>There’s only hot corner, one way, to wake up screen saver. We need to use <code>Automator</code> to add a quickaction of start screen saver.</p>\n<p>Then set a short cut for this service in System Preferences -&gt; Keyboard -&gt; Shortcuts -&gt; Services</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY2FybG9zLWxpeWUvcC82NjgxMjg5Lmh0bWw=\">https://www.cnblogs.com/carlos-liye/p/6681289.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Download\"><a href=\"#Download\" class=\"headerlink\" title=\"Download\"></a>Download</h1><p>download <code>Aerial</code></p>\n<h1 id=\"Add-shortcut\"><a href=\"#Add-shortcut\" class=\"headerlink\" title=\"Add shortcut\"></a>Add shortcut</h1><p>There’s only hot corner, one way, to wake up screen saver. We need to use <code>Automator</code> to add a quickaction of start screen saver.</p>\n<p>Then set a short cut for this service in System Preferences -&gt; Keyboard -&gt; Shortcuts -&gt; Services</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY2FybG9zLWxpeWUvcC82NjgxMjg5Lmh0bWw=\">https://www.cnblogs.com/carlos-liye/p/6681289.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Nginx\n\n检测配置文件\n`nginx -t`\n\n重启服务\n`nginx -s reload`\n\n若重启报错 先运行 \n`nginx -c /etc/nginx/nginx.conf`\n\n配置目录文件\n\n- /etc/nginx: nginx配置文件目录。所有的nginx配置文件都在这里。\n- /etc/nginx/nginx.conf: Nginx的主配置文件. 可以修改他来改变nginx的全局配置。\n- /etc/nginx/sites-available/: 这个目录存储每一个网站的”server blocks”。nginx通常不会使用这些配置，除非它们陪连接到 sites-enabled 目录 (see below)。一般所有的server block 配置都在这个目录中设置，然后软连接到别的目录 。\n- /etc/nginx/sites-enabled/: 这个目录存储生效的 “server blocks” 配置. 通常,这个配置都是链接到 sites-available目录中的配置文件\n- /etc/nginx/snippets: 这个目录主要可以包含在其它nginx配置文件中的配置片段。重复的配置都可以重构为配置片段。\n\nSSL config\n```conf\n    server {\n        listen       80 default_server;\n        listen       [::]:80 default_server;\n        server_name  api.gfgf.tech;\n        root         /usr/share/nginx/html;\n\n\t    return 301 https://$server_name$request_uri;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n                proxy_pass http://127.0.0.1:21000;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n\n    server {\n        listen       443 ssl http2 default_server;\n        listen       [::]:443 ssl http2 default_server;\n        server_name  api.gfgf.tech;\n        root         /usr/share/nginx/html;\n\n        ssl_certificate \"/root/.acme.sh/api.gfgf.tech/api.gfgf.tech.cer\";\n        ssl_certificate_key \"/root/.acme.sh/api.gfgf.tech/api.gfgf.tech.key\";\n        ssl_session_cache shared:SSL:1m;\n        ssl_session_timeout  10m;\n        ssl_ciphers HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers on;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n\t\tproxy_pass http://localhost:21000;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n```","source":"_posts/notebook/nginx.md","raw":"# Nginx\n\n检测配置文件\n`nginx -t`\n\n重启服务\n`nginx -s reload`\n\n若重启报错 先运行 \n`nginx -c /etc/nginx/nginx.conf`\n\n配置目录文件\n\n- /etc/nginx: nginx配置文件目录。所有的nginx配置文件都在这里。\n- /etc/nginx/nginx.conf: Nginx的主配置文件. 可以修改他来改变nginx的全局配置。\n- /etc/nginx/sites-available/: 这个目录存储每一个网站的”server blocks”。nginx通常不会使用这些配置，除非它们陪连接到 sites-enabled 目录 (see below)。一般所有的server block 配置都在这个目录中设置，然后软连接到别的目录 。\n- /etc/nginx/sites-enabled/: 这个目录存储生效的 “server blocks” 配置. 通常,这个配置都是链接到 sites-available目录中的配置文件\n- /etc/nginx/snippets: 这个目录主要可以包含在其它nginx配置文件中的配置片段。重复的配置都可以重构为配置片段。\n\nSSL config\n```conf\n    server {\n        listen       80 default_server;\n        listen       [::]:80 default_server;\n        server_name  api.gfgf.tech;\n        root         /usr/share/nginx/html;\n\n\t    return 301 https://$server_name$request_uri;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n                proxy_pass http://127.0.0.1:21000;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n\n    server {\n        listen       443 ssl http2 default_server;\n        listen       [::]:443 ssl http2 default_server;\n        server_name  api.gfgf.tech;\n        root         /usr/share/nginx/html;\n\n        ssl_certificate \"/root/.acme.sh/api.gfgf.tech/api.gfgf.tech.cer\";\n        ssl_certificate_key \"/root/.acme.sh/api.gfgf.tech/api.gfgf.tech.key\";\n        ssl_session_cache shared:SSL:1m;\n        ssl_session_timeout  10m;\n        ssl_ciphers HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers on;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n\t\tproxy_pass http://localhost:21000;\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n```","slug":"notebook/nginx","published":1,"date":"2020-07-14T15:31:04.198Z","updated":"2021-10-10T14:21:48.970Z","title":"notebook/nginx","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx9814009z018o9zmp1mjc","content":"<h1 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h1><p>检测配置文件<br><code>nginx -t</code></p>\n<p>重启服务<br><code>nginx -s reload</code></p>\n<p>若重启报错 先运行<br><code>nginx -c /etc/nginx/nginx.conf</code></p>\n<p>配置目录文件</p>\n<ul>\n<li>/etc/nginx: nginx配置文件目录。所有的nginx配置文件都在这里。</li>\n<li>/etc/nginx/nginx.conf: Nginx的主配置文件. 可以修改他来改变nginx的全局配置。</li>\n<li>/etc/nginx/sites-available/: 这个目录存储每一个网站的”server blocks”。nginx通常不会使用这些配置，除非它们陪连接到 sites-enabled 目录 (see below)。一般所有的server block 配置都在这个目录中设置，然后软连接到别的目录 。</li>\n<li>/etc/nginx/sites-enabled/: 这个目录存储生效的 “server blocks” 配置. 通常,这个配置都是链接到 sites-available目录中的配置文件</li>\n<li>/etc/nginx/snippets: 这个目录主要可以包含在其它nginx配置文件中的配置片段。重复的配置都可以重构为配置片段。</li>\n</ul>\n<p>SSL config</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  server &#123;</span><br><span class=\"line\">      listen       80 default_server;</span><br><span class=\"line\">      listen       [::]:80 default_server;</span><br><span class=\"line\">      server_name  api.gfgf.tech;</span><br><span class=\"line\">      root         &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\"></span><br><span class=\"line\">   return 301 https:&#x2F;&#x2F;$server_name$request_uri;</span><br><span class=\"line\"></span><br><span class=\"line\">      # Load configuration files for the default server block.</span><br><span class=\"line\">      include &#x2F;etc&#x2F;nginx&#x2F;default.d&#x2F;*.conf;</span><br><span class=\"line\"></span><br><span class=\"line\">      location &#x2F; &#123;</span><br><span class=\"line\">              proxy_pass http:&#x2F;&#x2F;127.0.0.1:21000;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 404 &#x2F;404.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;40x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 500 502 503 504 &#x2F;50x.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;50x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  server &#123;</span><br><span class=\"line\">      listen       443 ssl http2 default_server;</span><br><span class=\"line\">      listen       [::]:443 ssl http2 default_server;</span><br><span class=\"line\">      server_name  api.gfgf.tech;</span><br><span class=\"line\">      root         &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\"></span><br><span class=\"line\">      ssl_certificate &quot;&#x2F;root&#x2F;.acme.sh&#x2F;api.gfgf.tech&#x2F;api.gfgf.tech.cer&quot;;</span><br><span class=\"line\">      ssl_certificate_key &quot;&#x2F;root&#x2F;.acme.sh&#x2F;api.gfgf.tech&#x2F;api.gfgf.tech.key&quot;;</span><br><span class=\"line\">      ssl_session_cache shared:SSL:1m;</span><br><span class=\"line\">      ssl_session_timeout  10m;</span><br><span class=\"line\">      ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class=\"line\">      ssl_prefer_server_ciphers on;</span><br><span class=\"line\"></span><br><span class=\"line\">      # Load configuration files for the default server block.</span><br><span class=\"line\">      include &#x2F;etc&#x2F;nginx&#x2F;default.d&#x2F;*.conf;</span><br><span class=\"line\"></span><br><span class=\"line\">      location &#x2F; &#123;</span><br><span class=\"line\">proxy_pass http:&#x2F;&#x2F;localhost:21000;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 404 &#x2F;404.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;40x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 500 502 503 504 &#x2F;50x.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;50x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h1><p>检测配置文件<br><code>nginx -t</code></p>\n<p>重启服务<br><code>nginx -s reload</code></p>\n<p>若重启报错 先运行<br><code>nginx -c /etc/nginx/nginx.conf</code></p>\n<p>配置目录文件</p>\n<ul>\n<li>/etc/nginx: nginx配置文件目录。所有的nginx配置文件都在这里。</li>\n<li>/etc/nginx/nginx.conf: Nginx的主配置文件. 可以修改他来改变nginx的全局配置。</li>\n<li>/etc/nginx/sites-available/: 这个目录存储每一个网站的”server blocks”。nginx通常不会使用这些配置，除非它们陪连接到 sites-enabled 目录 (see below)。一般所有的server block 配置都在这个目录中设置，然后软连接到别的目录 。</li>\n<li>/etc/nginx/sites-enabled/: 这个目录存储生效的 “server blocks” 配置. 通常,这个配置都是链接到 sites-available目录中的配置文件</li>\n<li>/etc/nginx/snippets: 这个目录主要可以包含在其它nginx配置文件中的配置片段。重复的配置都可以重构为配置片段。</li>\n</ul>\n<p>SSL config</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  server &#123;</span><br><span class=\"line\">      listen       80 default_server;</span><br><span class=\"line\">      listen       [::]:80 default_server;</span><br><span class=\"line\">      server_name  api.gfgf.tech;</span><br><span class=\"line\">      root         &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\"></span><br><span class=\"line\">   return 301 https:&#x2F;&#x2F;$server_name$request_uri;</span><br><span class=\"line\"></span><br><span class=\"line\">      # Load configuration files for the default server block.</span><br><span class=\"line\">      include &#x2F;etc&#x2F;nginx&#x2F;default.d&#x2F;*.conf;</span><br><span class=\"line\"></span><br><span class=\"line\">      location &#x2F; &#123;</span><br><span class=\"line\">              proxy_pass http:&#x2F;&#x2F;127.0.0.1:21000;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 404 &#x2F;404.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;40x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 500 502 503 504 &#x2F;50x.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;50x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  server &#123;</span><br><span class=\"line\">      listen       443 ssl http2 default_server;</span><br><span class=\"line\">      listen       [::]:443 ssl http2 default_server;</span><br><span class=\"line\">      server_name  api.gfgf.tech;</span><br><span class=\"line\">      root         &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class=\"line\"></span><br><span class=\"line\">      ssl_certificate &quot;&#x2F;root&#x2F;.acme.sh&#x2F;api.gfgf.tech&#x2F;api.gfgf.tech.cer&quot;;</span><br><span class=\"line\">      ssl_certificate_key &quot;&#x2F;root&#x2F;.acme.sh&#x2F;api.gfgf.tech&#x2F;api.gfgf.tech.key&quot;;</span><br><span class=\"line\">      ssl_session_cache shared:SSL:1m;</span><br><span class=\"line\">      ssl_session_timeout  10m;</span><br><span class=\"line\">      ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class=\"line\">      ssl_prefer_server_ciphers on;</span><br><span class=\"line\"></span><br><span class=\"line\">      # Load configuration files for the default server block.</span><br><span class=\"line\">      include &#x2F;etc&#x2F;nginx&#x2F;default.d&#x2F;*.conf;</span><br><span class=\"line\"></span><br><span class=\"line\">      location &#x2F; &#123;</span><br><span class=\"line\">proxy_pass http:&#x2F;&#x2F;localhost:21000;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 404 &#x2F;404.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;40x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      error_page 500 502 503 504 &#x2F;50x.html;</span><br><span class=\"line\">          location &#x3D; &#x2F;50x.html &#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>"},{"title":"Python装饰器(Decorator)","_content":"\n## 一切皆对象\n函数也可以是对象，如果不加()即视为不调用该函数，只是获取函数的对象。\n```py\ndef hi(name='edlison')\n    return 'hello' + name\n\ngreet = hi\n\nprint(greet())  # 'hi edlison'\n```\n\n\n## 函数中定义函数\n```py\ndef hi(name='edlison')\n    print('in hi()')\n\n    def greet():\n        return 'in greet'\n    \n    def hello():\n        return 'in hello'\n    \n    print('back')\n```\n函数内部依次执行，函数内部的函数只能内部调用。\n\n\n## 函数中返回函数\n```py\ndef hi(name='edlison'):\n    def greet()\n        return 'in greet()'\n    \n    if name == 'edlison':\n        return greet\n    else:\n        return 'no'\n\na = hi()\nb = a()\n```\n此时a指向greet函数，但并没有执行这个函数。\nb执行了greet函数，输出'in greet()'。\n\n\n## 函数作为参数传给另一个函数\n```py\ndef hi():\n    return 'hi'\n\ndef before_hi(f):\n    print('before')\n    print(f())\n\nbefore_hi(hi)\n```\n将hi函数作为参数传入另一个函数中，并在函数中调用。\n\n\n## 装饰器\n```py\ndef dec(f):\n    def wrap_func():\n        # before func\n        f()\n        # after func\n    return wrap_func  # 这里返回里层的函数，但并不会调用。\n\ndef need_dec():\n    print('need dec')\n\nneed_dec = dec(need_dec)\nneed_dec()\n```\n\n或者可以使用@符号来简化生成一个被装饰的函数。\n\n```py\n@dec\ndef need_dec():\n    print('need dec')\n\ndeed_dec()\n```\n使用@注解只是简化了need_dec = dec(need_dec)这一步。\n\n```py\ndef dec(f):\n    @wrap(f)  # 保留原函数的所有属性\n    def wrap_func():\n        # before func\n        f()\n        # after func\n    return wrap_func\n```\n经过装饰器后，由于返回的里层的wrap_func，所以拿到的函数变为了里层的wrap_func。使用`@wrap`可以保留原函数的所有属性。\n\n如果想要带参数的装饰类，则需要再创建一个函数，然后在内嵌套装饰器。\n\n\n## 装饰类\n```py\nclass logit():\n    def __init__(self, logfile='out.log'):\n        self.logfile = logfile\n    \n    def __call__(self, func):\n        @wrap(func)\n        def wrap_func(*args, **kwargs):\n            ...\n            return func(*args, **kwargs)\n        return wrap_func\n    \n    def notify(self):\n        raise NotImplementError\n```\n优点：\n- 如果想设计带参数的装饰类，不需要使用函数嵌套装饰器。\n- 可以创建一个基类，装饰过程中可能会用到一些重写的方法，通过子类继承重写。\n\n\n## 多个装饰器的执行顺序\n先会执行离需要装饰的函数近的装饰器。但是，内部的wrap_func函数中执行的顺序其实是先执行离函数最远的装饰器中的内容。\n\n相当于先依次调用装饰器内的东西，再从内到外层层封装。\n\n```py\ndef dec_a(func):\n    print('dec_a')\n    def inner_a():\n        print('inner_a')\n        func()\n    return inner_a\n\ndef dec_b(func):\n    print('dec_b')\n    def inner_b():\n        print('inner_b')\n        func()\n    return inner_b\n\n@dec_b\n@dec_a\ndef need_dec():\n    print('need_dec')\n\n# dec_a\n# dec_b\n# inner_b\n# inner_a\n# need_dec\n```\n\n如果装饰器内**没**东西执行，可以认为**从上到下**依次执行装饰器。\n\n\n## 总结\n1. 装饰器可以在每个函数的执行前或执行后进行一些其他操作。\n2. 被装饰的函数可以在内部函数内执行，也可以作为内部函数的返回值，但是**一定要调用这个函数**。\n3. 装饰类与装饰函数其实都是使用了对象的思想，个人认为装饰类的实现更优，更简单也更灵活。\n4. 装饰器的常见应用：授权，日志。\n\n\n\n\n\n----\nReference: https://www.runoob.com/w3cnote/python-func-decorators.html","source":"_posts/notebook/py-decorator.md","raw":"---\ntitle: Python装饰器(Decorator)\ncategories:\n- Notebook\ntags:\n- python\n---\n\n## 一切皆对象\n函数也可以是对象，如果不加()即视为不调用该函数，只是获取函数的对象。\n```py\ndef hi(name='edlison')\n    return 'hello' + name\n\ngreet = hi\n\nprint(greet())  # 'hi edlison'\n```\n\n\n## 函数中定义函数\n```py\ndef hi(name='edlison')\n    print('in hi()')\n\n    def greet():\n        return 'in greet'\n    \n    def hello():\n        return 'in hello'\n    \n    print('back')\n```\n函数内部依次执行，函数内部的函数只能内部调用。\n\n\n## 函数中返回函数\n```py\ndef hi(name='edlison'):\n    def greet()\n        return 'in greet()'\n    \n    if name == 'edlison':\n        return greet\n    else:\n        return 'no'\n\na = hi()\nb = a()\n```\n此时a指向greet函数，但并没有执行这个函数。\nb执行了greet函数，输出'in greet()'。\n\n\n## 函数作为参数传给另一个函数\n```py\ndef hi():\n    return 'hi'\n\ndef before_hi(f):\n    print('before')\n    print(f())\n\nbefore_hi(hi)\n```\n将hi函数作为参数传入另一个函数中，并在函数中调用。\n\n\n## 装饰器\n```py\ndef dec(f):\n    def wrap_func():\n        # before func\n        f()\n        # after func\n    return wrap_func  # 这里返回里层的函数，但并不会调用。\n\ndef need_dec():\n    print('need dec')\n\nneed_dec = dec(need_dec)\nneed_dec()\n```\n\n或者可以使用@符号来简化生成一个被装饰的函数。\n\n```py\n@dec\ndef need_dec():\n    print('need dec')\n\ndeed_dec()\n```\n使用@注解只是简化了need_dec = dec(need_dec)这一步。\n\n```py\ndef dec(f):\n    @wrap(f)  # 保留原函数的所有属性\n    def wrap_func():\n        # before func\n        f()\n        # after func\n    return wrap_func\n```\n经过装饰器后，由于返回的里层的wrap_func，所以拿到的函数变为了里层的wrap_func。使用`@wrap`可以保留原函数的所有属性。\n\n如果想要带参数的装饰类，则需要再创建一个函数，然后在内嵌套装饰器。\n\n\n## 装饰类\n```py\nclass logit():\n    def __init__(self, logfile='out.log'):\n        self.logfile = logfile\n    \n    def __call__(self, func):\n        @wrap(func)\n        def wrap_func(*args, **kwargs):\n            ...\n            return func(*args, **kwargs)\n        return wrap_func\n    \n    def notify(self):\n        raise NotImplementError\n```\n优点：\n- 如果想设计带参数的装饰类，不需要使用函数嵌套装饰器。\n- 可以创建一个基类，装饰过程中可能会用到一些重写的方法，通过子类继承重写。\n\n\n## 多个装饰器的执行顺序\n先会执行离需要装饰的函数近的装饰器。但是，内部的wrap_func函数中执行的顺序其实是先执行离函数最远的装饰器中的内容。\n\n相当于先依次调用装饰器内的东西，再从内到外层层封装。\n\n```py\ndef dec_a(func):\n    print('dec_a')\n    def inner_a():\n        print('inner_a')\n        func()\n    return inner_a\n\ndef dec_b(func):\n    print('dec_b')\n    def inner_b():\n        print('inner_b')\n        func()\n    return inner_b\n\n@dec_b\n@dec_a\ndef need_dec():\n    print('need_dec')\n\n# dec_a\n# dec_b\n# inner_b\n# inner_a\n# need_dec\n```\n\n如果装饰器内**没**东西执行，可以认为**从上到下**依次执行装饰器。\n\n\n## 总结\n1. 装饰器可以在每个函数的执行前或执行后进行一些其他操作。\n2. 被装饰的函数可以在内部函数内执行，也可以作为内部函数的返回值，但是**一定要调用这个函数**。\n3. 装饰类与装饰函数其实都是使用了对象的思想，个人认为装饰类的实现更优，更简单也更灵活。\n4. 装饰器的常见应用：授权，日志。\n\n\n\n\n\n----\nReference: https://www.runoob.com/w3cnote/python-func-decorators.html","slug":"notebook/py-decorator","published":1,"date":"2020-12-30T15:21:45.564Z","updated":"2020-12-30T17:41:29.911Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981500a0018ohaal7xyl","content":"<h2 id=\"一切皆对象\"><a href=\"#一切皆对象\" class=\"headerlink\" title=\"一切皆对象\"></a>一切皆对象</h2><p>函数也可以是对象，如果不加()即视为不调用该函数，只是获取函数的对象。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">return</span> '<span class=\"title\">hello</span>' + <span class=\"title\">name</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\">greet = hi</span><br><span class=\"line\"></span><br><span class=\"line\">print(greet())  <span class=\"comment\"># 'hi edlison'</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"函数中定义函数\"><a href=\"#函数中定义函数\" class=\"headerlink\" title=\"函数中定义函数\"></a>函数中定义函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">print</span><span class=\"params\">(<span class=\"string\">'in hi()'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">def</span> <span class=\"title\">greet</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'in greet'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'in hello'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    print(<span class=\"string\">'back'</span>)</span><br></pre></td></tr></table></figure>\n<p>函数内部依次执行，函数内部的函数只能内部调用。</p>\n<h2 id=\"函数中返回函数\"><a href=\"#函数中返回函数\" class=\"headerlink\" title=\"函数中返回函数\"></a>函数中返回函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">greet</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"title\">return</span> '<span class=\"title\">in</span> <span class=\"title\">greet</span><span class=\"params\">()</span>'</span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\">    if name == 'edlison':</span><br><span class=\"line\">        <span class=\"keyword\">return</span> greet</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'no'</span></span><br><span class=\"line\"></span><br><span class=\"line\">a = hi()</span><br><span class=\"line\">b = a()</span><br></pre></td></tr></table></figure>\n<p>此时a指向greet函数，但并没有执行这个函数。<br>b执行了greet函数，输出’in greet()’。</p>\n<h2 id=\"函数作为参数传给另一个函数\"><a href=\"#函数作为参数传给另一个函数\" class=\"headerlink\" title=\"函数作为参数传给另一个函数\"></a>函数作为参数传给另一个函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'hi'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">before_hi</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'before'</span>)</span><br><span class=\"line\">    print(f())</span><br><span class=\"line\"></span><br><span class=\"line\">before_hi(hi)</span><br></pre></td></tr></table></figure>\n<p>将hi函数作为参数传入另一个函数中，并在函数中调用。</p>\n<h2 id=\"装饰器\"><a href=\"#装饰器\" class=\"headerlink\" title=\"装饰器\"></a>装饰器</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># before func</span></span><br><span class=\"line\">        f()</span><br><span class=\"line\">        <span class=\"comment\"># after func</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrap_func  <span class=\"comment\"># 这里返回里层的函数，但并不会调用。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">need_dec = dec(need_dec)</span><br><span class=\"line\">need_dec()</span><br></pre></td></tr></table></figure>\n\n<p>或者可以使用@符号来简化生成一个被装饰的函数。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@dec</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">deed_dec()</span><br></pre></td></tr></table></figure>\n<p>使用@注解只是简化了need_dec = dec(need_dec)这一步。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">    @wrap(f)  # 保留原函数的所有属性</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># before func</span></span><br><span class=\"line\">        f()</span><br><span class=\"line\">        <span class=\"comment\"># after func</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrap_func</span><br></pre></td></tr></table></figure>\n<p>经过装饰器后，由于返回的里层的wrap_func，所以拿到的函数变为了里层的wrap_func。使用<code>@wrap</code>可以保留原函数的所有属性。</p>\n<p>如果想要带参数的装饰类，则需要再创建一个函数，然后在内嵌套装饰器。</p>\n<h2 id=\"装饰类\"><a href=\"#装饰类\" class=\"headerlink\" title=\"装饰类\"></a>装饰类</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">logit</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, logfile=<span class=\"string\">'out.log'</span>)</span>:</span></span><br><span class=\"line\">        self.logfile = logfile</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__call__</span><span class=\"params\">(self, func)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">        @wrap(func)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">(*args, **kwargs)</span>:</span></span><br><span class=\"line\">            ...</span><br><span class=\"line\">            <span class=\"keyword\">return</span> func(*args, **kwargs)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> wrap_func</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">notify</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">raise</span> NotImplementError</span><br></pre></td></tr></table></figure>\n<p>优点：</p>\n<ul>\n<li>如果想设计带参数的装饰类，不需要使用函数嵌套装饰器。</li>\n<li>可以创建一个基类，装饰过程中可能会用到一些重写的方法，通过子类继承重写。</li>\n</ul>\n<h2 id=\"多个装饰器的执行顺序\"><a href=\"#多个装饰器的执行顺序\" class=\"headerlink\" title=\"多个装饰器的执行顺序\"></a>多个装饰器的执行顺序</h2><p>先会执行离需要装饰的函数近的装饰器。但是，内部的wrap_func函数中执行的顺序其实是先执行离函数最远的装饰器中的内容。</p>\n<p>相当于先依次调用装饰器内的东西，再从内到外层层封装。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec_a</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'dec_a'</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">inner_a</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        print(<span class=\"string\">'inner_a'</span>)</span><br><span class=\"line\">        func()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> inner_a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec_b</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'dec_b'</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">inner_b</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        print(<span class=\"string\">'inner_b'</span>)</span><br><span class=\"line\">        func()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> inner_b</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@dec_b</span></span><br><span class=\"line\"><span class=\"meta\">@dec_a</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need_dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># dec_a</span></span><br><span class=\"line\"><span class=\"comment\"># dec_b</span></span><br><span class=\"line\"><span class=\"comment\"># inner_b</span></span><br><span class=\"line\"><span class=\"comment\"># inner_a</span></span><br><span class=\"line\"><span class=\"comment\"># need_dec</span></span><br></pre></td></tr></table></figure>\n\n<p>如果装饰器内<strong>没</strong>东西执行，可以认为<strong>从上到下</strong>依次执行装饰器。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><ol>\n<li>装饰器可以在每个函数的执行前或执行后进行一些其他操作。</li>\n<li>被装饰的函数可以在内部函数内执行，也可以作为内部函数的返回值，但是<strong>一定要调用这个函数</strong>。</li>\n<li>装饰类与装饰函数其实都是使用了对象的思想，个人认为装饰类的实现更优，更简单也更灵活。</li>\n<li>装饰器的常见应用：授权，日志。</li>\n</ol>\n<hr>\n<p>Reference: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS93M2Nub3RlL3B5dGhvbi1mdW5jLWRlY29yYXRvcnMuaHRtbA==\">https://www.runoob.com/w3cnote/python-func-decorators.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"一切皆对象\"><a href=\"#一切皆对象\" class=\"headerlink\" title=\"一切皆对象\"></a>一切皆对象</h2><p>函数也可以是对象，如果不加()即视为不调用该函数，只是获取函数的对象。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">return</span> '<span class=\"title\">hello</span>' + <span class=\"title\">name</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\">greet = hi</span><br><span class=\"line\"></span><br><span class=\"line\">print(greet())  <span class=\"comment\"># 'hi edlison'</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"函数中定义函数\"><a href=\"#函数中定义函数\" class=\"headerlink\" title=\"函数中定义函数\"></a>函数中定义函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">print</span><span class=\"params\">(<span class=\"string\">'in hi()'</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">def</span> <span class=\"title\">greet</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'in greet'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'in hello'</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    print(<span class=\"string\">'back'</span>)</span><br></pre></td></tr></table></figure>\n<p>函数内部依次执行，函数内部的函数只能内部调用。</p>\n<h2 id=\"函数中返回函数\"><a href=\"#函数中返回函数\" class=\"headerlink\" title=\"函数中返回函数\"></a>函数中返回函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">(name=<span class=\"string\">'edlison'</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">greet</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"title\">return</span> '<span class=\"title\">in</span> <span class=\"title\">greet</span><span class=\"params\">()</span>'</span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\">    if name == 'edlison':</span><br><span class=\"line\">        <span class=\"keyword\">return</span> greet</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'no'</span></span><br><span class=\"line\"></span><br><span class=\"line\">a = hi()</span><br><span class=\"line\">b = a()</span><br></pre></td></tr></table></figure>\n<p>此时a指向greet函数，但并没有执行这个函数。<br>b执行了greet函数，输出’in greet()’。</p>\n<h2 id=\"函数作为参数传给另一个函数\"><a href=\"#函数作为参数传给另一个函数\" class=\"headerlink\" title=\"函数作为参数传给另一个函数\"></a>函数作为参数传给另一个函数</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hi</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'hi'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">before_hi</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'before'</span>)</span><br><span class=\"line\">    print(f())</span><br><span class=\"line\"></span><br><span class=\"line\">before_hi(hi)</span><br></pre></td></tr></table></figure>\n<p>将hi函数作为参数传入另一个函数中，并在函数中调用。</p>\n<h2 id=\"装饰器\"><a href=\"#装饰器\" class=\"headerlink\" title=\"装饰器\"></a>装饰器</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># before func</span></span><br><span class=\"line\">        f()</span><br><span class=\"line\">        <span class=\"comment\"># after func</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrap_func  <span class=\"comment\"># 这里返回里层的函数，但并不会调用。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">need_dec = dec(need_dec)</span><br><span class=\"line\">need_dec()</span><br></pre></td></tr></table></figure>\n\n<p>或者可以使用@符号来简化生成一个被装饰的函数。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@dec</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">deed_dec()</span><br></pre></td></tr></table></figure>\n<p>使用@注解只是简化了need_dec = dec(need_dec)这一步。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec</span><span class=\"params\">(f)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">    @wrap(f)  # 保留原函数的所有属性</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># before func</span></span><br><span class=\"line\">        f()</span><br><span class=\"line\">        <span class=\"comment\"># after func</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrap_func</span><br></pre></td></tr></table></figure>\n<p>经过装饰器后，由于返回的里层的wrap_func，所以拿到的函数变为了里层的wrap_func。使用<code>@wrap</code>可以保留原函数的所有属性。</p>\n<p>如果想要带参数的装饰类，则需要再创建一个函数，然后在内嵌套装饰器。</p>\n<h2 id=\"装饰类\"><a href=\"#装饰类\" class=\"headerlink\" title=\"装饰类\"></a>装饰类</h2><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">logit</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, logfile=<span class=\"string\">'out.log'</span>)</span>:</span></span><br><span class=\"line\">        self.logfile = logfile</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__call__</span><span class=\"params\">(self, func)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">        @wrap(func)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wrap_func</span><span class=\"params\">(*args, **kwargs)</span>:</span></span><br><span class=\"line\">            ...</span><br><span class=\"line\">            <span class=\"keyword\">return</span> func(*args, **kwargs)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> wrap_func</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">notify</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">raise</span> NotImplementError</span><br></pre></td></tr></table></figure>\n<p>优点：</p>\n<ul>\n<li>如果想设计带参数的装饰类，不需要使用函数嵌套装饰器。</li>\n<li>可以创建一个基类，装饰过程中可能会用到一些重写的方法，通过子类继承重写。</li>\n</ul>\n<h2 id=\"多个装饰器的执行顺序\"><a href=\"#多个装饰器的执行顺序\" class=\"headerlink\" title=\"多个装饰器的执行顺序\"></a>多个装饰器的执行顺序</h2><p>先会执行离需要装饰的函数近的装饰器。但是，内部的wrap_func函数中执行的顺序其实是先执行离函数最远的装饰器中的内容。</p>\n<p>相当于先依次调用装饰器内的东西，再从内到外层层封装。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec_a</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'dec_a'</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">inner_a</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        print(<span class=\"string\">'inner_a'</span>)</span><br><span class=\"line\">        func()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> inner_a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dec_b</span><span class=\"params\">(func)</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'dec_b'</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">inner_b</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        print(<span class=\"string\">'inner_b'</span>)</span><br><span class=\"line\">        func()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> inner_b</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@dec_b</span></span><br><span class=\"line\"><span class=\"meta\">@dec_a</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">need_dec</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'need_dec'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># dec_a</span></span><br><span class=\"line\"><span class=\"comment\"># dec_b</span></span><br><span class=\"line\"><span class=\"comment\"># inner_b</span></span><br><span class=\"line\"><span class=\"comment\"># inner_a</span></span><br><span class=\"line\"><span class=\"comment\"># need_dec</span></span><br></pre></td></tr></table></figure>\n\n<p>如果装饰器内<strong>没</strong>东西执行，可以认为<strong>从上到下</strong>依次执行装饰器。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><ol>\n<li>装饰器可以在每个函数的执行前或执行后进行一些其他操作。</li>\n<li>被装饰的函数可以在内部函数内执行，也可以作为内部函数的返回值，但是<strong>一定要调用这个函数</strong>。</li>\n<li>装饰类与装饰函数其实都是使用了对象的思想，个人认为装饰类的实现更优，更简单也更灵活。</li>\n<li>装饰器的常见应用：授权，日志。</li>\n</ol>\n<hr>\n<p>Reference: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS93M2Nub3RlL3B5dGhvbi1mdW5jLWRlY29yYXRvcnMuaHRtbA==\">https://www.runoob.com/w3cnote/python-func-decorators.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Notion","catagories":["Notebook"],"_content":"\n# 开始使用Notion\n\n最近对于时间规划的问题很苦恼，找到了这个软件，对我的效率提升有很大帮助。\n\n# 使用思路\n\n操作单元分为`block`与`page`.\n\n都可以随意进行改变，以及分级操作，对页面布局及结构化分层归纳十分方便。\n\n# 好用的操作\n\n- 可以`add template`\n- 将`page`放到`data base`中进行归档\n- `/`的指令很方便\n\n# 不足\n\n- 写公式不方便","source":"_posts/notebook/notion.md","raw":"---\ntitle: Notion\ncatagories:\n- Notebook\ntags:\n- notion\n---\n\n# 开始使用Notion\n\n最近对于时间规划的问题很苦恼，找到了这个软件，对我的效率提升有很大帮助。\n\n# 使用思路\n\n操作单元分为`block`与`page`.\n\n都可以随意进行改变，以及分级操作，对页面布局及结构化分层归纳十分方便。\n\n# 好用的操作\n\n- 可以`add template`\n- 将`page`放到`data base`中进行归档\n- `/`的指令很方便\n\n# 不足\n\n- 写公式不方便","slug":"notebook/notion","published":1,"date":"2021-02-27T16:38:56.185Z","updated":"2021-02-27T16:49:22.501Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981700a3018o0clr0uzd","content":"<h1 id=\"开始使用Notion\"><a href=\"#开始使用Notion\" class=\"headerlink\" title=\"开始使用Notion\"></a>开始使用Notion</h1><p>最近对于时间规划的问题很苦恼，找到了这个软件，对我的效率提升有很大帮助。</p>\n<h1 id=\"使用思路\"><a href=\"#使用思路\" class=\"headerlink\" title=\"使用思路\"></a>使用思路</h1><p>操作单元分为<code>block</code>与<code>page</code>.</p>\n<p>都可以随意进行改变，以及分级操作，对页面布局及结构化分层归纳十分方便。</p>\n<h1 id=\"好用的操作\"><a href=\"#好用的操作\" class=\"headerlink\" title=\"好用的操作\"></a>好用的操作</h1><ul>\n<li>可以<code>add template</code></li>\n<li>将<code>page</code>放到<code>data base</code>中进行归档</li>\n<li><code>/</code>的指令很方便</li>\n</ul>\n<h1 id=\"不足\"><a href=\"#不足\" class=\"headerlink\" title=\"不足\"></a>不足</h1><ul>\n<li>写公式不方便</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始使用Notion\"><a href=\"#开始使用Notion\" class=\"headerlink\" title=\"开始使用Notion\"></a>开始使用Notion</h1><p>最近对于时间规划的问题很苦恼，找到了这个软件，对我的效率提升有很大帮助。</p>\n<h1 id=\"使用思路\"><a href=\"#使用思路\" class=\"headerlink\" title=\"使用思路\"></a>使用思路</h1><p>操作单元分为<code>block</code>与<code>page</code>.</p>\n<p>都可以随意进行改变，以及分级操作，对页面布局及结构化分层归纳十分方便。</p>\n<h1 id=\"好用的操作\"><a href=\"#好用的操作\" class=\"headerlink\" title=\"好用的操作\"></a>好用的操作</h1><ul>\n<li>可以<code>add template</code></li>\n<li>将<code>page</code>放到<code>data base</code>中进行归档</li>\n<li><code>/</code>的指令很方便</li>\n</ul>\n<h1 id=\"不足\"><a href=\"#不足\" class=\"headerlink\" title=\"不足\"></a>不足</h1><ul>\n<li>写公式不方便</li>\n</ul>\n"},{"title":"Python中的*arg与**kwarg","_content":"\n\n## 参数的规则\n\n### 参数的顺序1：\n位置参数 - *arg - **kwarg\n\n*arg会把多出来的位置参数转化为`tuple`\n**kwarg会把关键字参数转化为`dict`\n\n### 参数的顺序2：\n位置参数 - * - 关键字...\n\n关键字亦看作位置参数，如果**不传则会报错**。\n\n\n## 传参时的技巧\n\n获取参数时：\n*可以看作是将参数打包成`tuple`\n**可以看作是将参数打包成`dict`\n\n传参时：\n可以将*tuple解压包并传入\n可以将**dict解压包并传入\n\n\n\n\n----\nReference: https://www.jianshu.com/p/e0d4705e8293\n","source":"_posts/notebook/py-*args**kwargs.md","raw":"---\ntitle: Python中的*arg与**kwarg\ncategories:\n- Notebook\ntags:\n- python\n---\n\n\n## 参数的规则\n\n### 参数的顺序1：\n位置参数 - *arg - **kwarg\n\n*arg会把多出来的位置参数转化为`tuple`\n**kwarg会把关键字参数转化为`dict`\n\n### 参数的顺序2：\n位置参数 - * - 关键字...\n\n关键字亦看作位置参数，如果**不传则会报错**。\n\n\n## 传参时的技巧\n\n获取参数时：\n*可以看作是将参数打包成`tuple`\n**可以看作是将参数打包成`dict`\n\n传参时：\n可以将*tuple解压包并传入\n可以将**dict解压包并传入\n\n\n\n\n----\nReference: https://www.jianshu.com/p/e0d4705e8293\n","slug":"notebook/py-*args**kwargs","published":1,"date":"2020-12-30T16:46:38.215Z","updated":"2020-12-30T16:54:37.837Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981700a6018o809hew9j","content":"<h2 id=\"参数的规则\"><a href=\"#参数的规则\" class=\"headerlink\" title=\"参数的规则\"></a>参数的规则</h2><h3 id=\"参数的顺序1：\"><a href=\"#参数的顺序1：\" class=\"headerlink\" title=\"参数的顺序1：\"></a>参数的顺序1：</h3><p>位置参数 - <em>arg - *</em>kwarg</p>\n<p><em>arg会把多出来的位置参数转化为<code>tuple</code><br>*</em>kwarg会把关键字参数转化为<code>dict</code></p>\n<h3 id=\"参数的顺序2：\"><a href=\"#参数的顺序2：\" class=\"headerlink\" title=\"参数的顺序2：\"></a>参数的顺序2：</h3><p>位置参数 - * - 关键字…</p>\n<p>关键字亦看作位置参数，如果<strong>不传则会报错</strong>。</p>\n<h2 id=\"传参时的技巧\"><a href=\"#传参时的技巧\" class=\"headerlink\" title=\"传参时的技巧\"></a>传参时的技巧</h2><p>获取参数时：<br><em>可以看作是将参数打包成<code>tuple</code><br>*</em>可以看作是将参数打包成<code>dict</code></p>\n<p>传参时：<br>可以将<em>tuple解压包并传入<br>可以将*</em>dict解压包并传入</p>\n<hr>\n<p>Reference: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9lMGQ0NzA1ZTgyOTM=\">https://www.jianshu.com/p/e0d4705e8293<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"参数的规则\"><a href=\"#参数的规则\" class=\"headerlink\" title=\"参数的规则\"></a>参数的规则</h2><h3 id=\"参数的顺序1：\"><a href=\"#参数的顺序1：\" class=\"headerlink\" title=\"参数的顺序1：\"></a>参数的顺序1：</h3><p>位置参数 - <em>arg - *</em>kwarg</p>\n<p><em>arg会把多出来的位置参数转化为<code>tuple</code><br>*</em>kwarg会把关键字参数转化为<code>dict</code></p>\n<h3 id=\"参数的顺序2：\"><a href=\"#参数的顺序2：\" class=\"headerlink\" title=\"参数的顺序2：\"></a>参数的顺序2：</h3><p>位置参数 - * - 关键字…</p>\n<p>关键字亦看作位置参数，如果<strong>不传则会报错</strong>。</p>\n<h2 id=\"传参时的技巧\"><a href=\"#传参时的技巧\" class=\"headerlink\" title=\"传参时的技巧\"></a>传参时的技巧</h2><p>获取参数时：<br><em>可以看作是将参数打包成<code>tuple</code><br>*</em>可以看作是将参数打包成<code>dict</code></p>\n<p>传参时：<br>可以将<em>tuple解压包并传入<br>可以将*</em>dict解压包并传入</p>\n<hr>\n<p>Reference: <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9lMGQ0NzA1ZTgyOTM=\">https://www.jianshu.com/p/e0d4705e8293<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"about PT(private tracker)","_content":"\n# Famous PT website\n\n- TTG\n- M-Team\n- HDGG\n- CMCT\n\n\n\nAll above websites are private, needing invitation or donating.","source":"_posts/notebook/pt.md","raw":"---\ntitle: about PT(private tracker)\ncategories:\n- Notebook\n---\n\n# Famous PT website\n\n- TTG\n- M-Team\n- HDGG\n- CMCT\n\n\n\nAll above websites are private, needing invitation or donating.","slug":"notebook/pt","published":1,"date":"2021-10-06T10:31:50.572Z","updated":"2021-10-06T10:36:10.087Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981800a9018o079o4sac","content":"<h1 id=\"Famous-PT-website\"><a href=\"#Famous-PT-website\" class=\"headerlink\" title=\"Famous PT website\"></a>Famous PT website</h1><ul>\n<li>TTG</li>\n<li>M-Team</li>\n<li>HDGG</li>\n<li>CMCT</li>\n</ul>\n<p>All above websites are private, needing invitation or donating.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Famous-PT-website\"><a href=\"#Famous-PT-website\" class=\"headerlink\" title=\"Famous PT website\"></a>Famous PT website</h1><ul>\n<li>TTG</li>\n<li>M-Team</li>\n<li>HDGG</li>\n<li>CMCT</li>\n</ul>\n<p>All above websites are private, needing invitation or donating.</p>\n"},{"title":"Python的__init__.py文件","_content":"\n# init.py文件的主要作用\n\n用来管理当前目录下的`.py`文件。\n\n1. `__init__.py`是package的标识。\n2. 其中`__all__`可以用来进行模糊导入(`import *`)。\n\n使用`import`导入包的时候，就相当于导入了这个包的`__init__.py`。\n\n# import的理解\n\n可以导入**包**或**文件**或**变量**。\n\n# from的理解\n\n只能**包**或**文件**。\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/BlueSkyyj/p/9415087.html","source":"_posts/notebook/py-init.md","raw":"---\ntitle: Python的__init__.py文件\ncategories:\n- Notebook\ntags:\n- python\n---\n\n# init.py文件的主要作用\n\n用来管理当前目录下的`.py`文件。\n\n1. `__init__.py`是package的标识。\n2. 其中`__all__`可以用来进行模糊导入(`import *`)。\n\n使用`import`导入包的时候，就相当于导入了这个包的`__init__.py`。\n\n# import的理解\n\n可以导入**包**或**文件**或**变量**。\n\n# from的理解\n\n只能**包**或**文件**。\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/BlueSkyyj/p/9415087.html","slug":"notebook/py-init","published":1,"date":"2021-02-10T16:18:04.281Z","updated":"2021-02-10T17:12:44.618Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981900ac018ohiy94qkc","content":"<h1 id=\"init-py文件的主要作用\"><a href=\"#init-py文件的主要作用\" class=\"headerlink\" title=\"init.py文件的主要作用\"></a>init.py文件的主要作用</h1><p>用来管理当前目录下的<code>.py</code>文件。</p>\n<ol>\n<li><code>__init__.py</code>是package的标识。</li>\n<li>其中<code>__all__</code>可以用来进行模糊导入(<code>import *</code>)。</li>\n</ol>\n<p>使用<code>import</code>导入包的时候，就相当于导入了这个包的<code>__init__.py</code>。</p>\n<h1 id=\"import的理解\"><a href=\"#import的理解\" class=\"headerlink\" title=\"import的理解\"></a>import的理解</h1><p>可以导入<strong>包</strong>或<strong>文件</strong>或<strong>变量</strong>。</p>\n<h1 id=\"from的理解\"><a href=\"#from的理解\" class=\"headerlink\" title=\"from的理解\"></a>from的理解</h1><p>只能<strong>包</strong>或<strong>文件</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vQmx1ZVNreXlqL3AvOTQxNTA4Ny5odG1s\">https://www.cnblogs.com/BlueSkyyj/p/9415087.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"init-py文件的主要作用\"><a href=\"#init-py文件的主要作用\" class=\"headerlink\" title=\"init.py文件的主要作用\"></a>init.py文件的主要作用</h1><p>用来管理当前目录下的<code>.py</code>文件。</p>\n<ol>\n<li><code>__init__.py</code>是package的标识。</li>\n<li>其中<code>__all__</code>可以用来进行模糊导入(<code>import *</code>)。</li>\n</ol>\n<p>使用<code>import</code>导入包的时候，就相当于导入了这个包的<code>__init__.py</code>。</p>\n<h1 id=\"import的理解\"><a href=\"#import的理解\" class=\"headerlink\" title=\"import的理解\"></a>import的理解</h1><p>可以导入<strong>包</strong>或<strong>文件</strong>或<strong>变量</strong>。</p>\n<h1 id=\"from的理解\"><a href=\"#from的理解\" class=\"headerlink\" title=\"from的理解\"></a>from的理解</h1><p>只能<strong>包</strong>或<strong>文件</strong>。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vQmx1ZVNreXlqL3AvOTQxNTA4Ny5odG1s\">https://www.cnblogs.com/BlueSkyyj/p/9415087.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Python 添加系统路径","_content":"\n# 报错'No Module'\n\n没有讲目录添加到`sys path`下，导致python没有扫描到。\n\n```python\nimport sys\nsys.path.append('/home/xxx/xxx')\n```\n\n","source":"_posts/notebook/py_sys_path.md","raw":"---\ntitle: Python 添加系统路径\ncategories:\n- Notebook\ntags:\n- python\n- sys\n---\n\n# 报错'No Module'\n\n没有讲目录添加到`sys path`下，导致python没有扫描到。\n\n```python\nimport sys\nsys.path.append('/home/xxx/xxx')\n```\n\n","slug":"notebook/py_sys_path","published":1,"date":"2021-05-30T10:36:00.944Z","updated":"2021-05-30T10:46:32.532Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981a00af018oe3lf2xmq","content":"<h1 id=\"报错’No-Module’\"><a href=\"#报错’No-Module’\" class=\"headerlink\" title=\"报错’No Module’\"></a>报错’No Module’</h1><p>没有讲目录添加到<code>sys path</code>下，导致python没有扫描到。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\">sys.path.append(<span class=\"string\">'/home/xxx/xxx'</span>)</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"报错’No-Module’\"><a href=\"#报错’No-Module’\" class=\"headerlink\" title=\"报错’No Module’\"></a>报错’No Module’</h1><p>没有讲目录添加到<code>sys path</code>下，导致python没有扫描到。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\">sys.path.append(<span class=\"string\">'/home/xxx/xxx'</span>)</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Scala - Start","_content":"\n# 安装\n\n从官网下载二进制文件\n\n`mv scala /opt/scala`\n\n打开Idea指定SDK之后就可以创建Scala项目了\n\n# 开始\n\n在Idea中新建一个Scala项目\n\n创建一个`scala object`\n\n```scala\nobject Test {\n  def main(args: Array[String]): Unit = {  \n    print(\"hello world!\")\n  }\n}\n```\n\n可以直接运行\n\n也可以使用命令行\n\n```sh\nscala Test.scala\n```\n\n# 注意\n\nScala中的object相当于静态类，main只能处于object中。\n\nclass只有在被实例化的时候才会被加载。\n\n\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/e0fc0ab7a9d2","source":"_posts/notebook/scala-start.md","raw":"---\ntitle: Scala - Start\ncategories:\n- Notebook\ntags:\n- scala\n---\n\n# 安装\n\n从官网下载二进制文件\n\n`mv scala /opt/scala`\n\n打开Idea指定SDK之后就可以创建Scala项目了\n\n# 开始\n\n在Idea中新建一个Scala项目\n\n创建一个`scala object`\n\n```scala\nobject Test {\n  def main(args: Array[String]): Unit = {  \n    print(\"hello world!\")\n  }\n}\n```\n\n可以直接运行\n\n也可以使用命令行\n\n```sh\nscala Test.scala\n```\n\n# 注意\n\nScala中的object相当于静态类，main只能处于object中。\n\nclass只有在被实例化的时候才会被加载。\n\n\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/e0fc0ab7a9d2","slug":"notebook/scala-start","published":1,"date":"2021-01-29T08:42:38.452Z","updated":"2021-01-29T08:59:49.388Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981b00ai018o7z5x0x66","content":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><p>从官网下载二进制文件</p>\n<p><code>mv scala /opt/scala</code></p>\n<p>打开Idea指定SDK之后就可以创建Scala项目了</p>\n<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>在Idea中新建一个Scala项目</p>\n<p>创建一个<code>scala object</code></p>\n<figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">object</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span></span>(args: <span class=\"type\">Array</span>[<span class=\"type\">String</span>]): <span class=\"type\">Unit</span> = &#123;  </span><br><span class=\"line\">    print(<span class=\"string\">\"hello world!\"</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>可以直接运行</p>\n<p>也可以使用命令行</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scala Test.scala</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p>Scala中的object相当于静态类，main只能处于object中。</p>\n<p>class只有在被实例化的时候才会被加载。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9lMGZjMGFiN2E5ZDI=\">https://www.jianshu.com/p/e0fc0ab7a9d2<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><p>从官网下载二进制文件</p>\n<p><code>mv scala /opt/scala</code></p>\n<p>打开Idea指定SDK之后就可以创建Scala项目了</p>\n<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>在Idea中新建一个Scala项目</p>\n<p>创建一个<code>scala object</code></p>\n<figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">object</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span></span>(args: <span class=\"type\">Array</span>[<span class=\"type\">String</span>]): <span class=\"type\">Unit</span> = &#123;  </span><br><span class=\"line\">    print(<span class=\"string\">\"hello world!\"</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>可以直接运行</p>\n<p>也可以使用命令行</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scala Test.scala</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p>Scala中的object相当于静态类，main只能处于object中。</p>\n<p>class只有在被实例化的时候才会被加载。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9lMGZjMGFiN2E5ZDI=\">https://www.jianshu.com/p/e0fc0ab7a9d2<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Static 理解\n\n## 一. Static关键字的用途\n\n在《Java编程思想》P86页有这样一段话：\n\n　　*“static方法就是没有this的方法。在static方法内部不能调用非静态方法，反过来是可以的。而且可以在没有创建任何对象的前提下，仅仅通过类本身来调用static方法。这实际上正是static方法的主要用途。”*\n\n这段话虽然只是说明了static方法的特殊之处，但是可以看出static关键字的基本作用，简而言之，一句话来描述就是：\n\n方便在没有创建对象的情况下来进行调用（方法/变量）。\n\n很显然，被static关键字修饰的方法或者变量不需要依赖于对象来进行访问，只要类被加载了，就可以通过类名去进行访问。\n\nstatic可以用来修饰类的成员方法、类的成员变量，另外可以编写static代码块来优化程序性能。\n\n**1. static方法**\n\nstatic方法一般称作静态方法，由于静态方法不依赖于任何对象就可以进行访问，因此对于静态方法来说，是没有this的，因为它不依附于任何对象，既然都没有对象，就谈不上this了。并且由于这个特性，在静态方法中不能访问类的非静态成员变量和非静态成员方法，因为非静态成员方法/变量都是必须依赖具体的对象才能够被调用。\n\n但是要注意的是，虽然在静态方法中不能访问非静态成员方法和非静态成员变量，但是在非静态成员方法中是可以访问静态成员方法/变量的。举个简单的例子：\n\n在上面的代码中，由于print2方法是独立于对象存在的，可以直接用过类名调用。假如说可以在静态方法中访问非静态方法/变量的话，那么如果在main方法中有下面一条语句：\n\nMyObject.print2();\n\n此时对象都没有，str2根本就不存在，所以就会产生矛盾了。同样对于方法也是一样，由于你无法预知在print1方法中是否访问了非静态成员变量，所以也禁止在静态成员方法中访问非静态成员方法。\n\n而对于非静态成员方法，它访问静态成员方法/变量显然是毫无限制的。\n\n因此，如果说想在不创建对象的情况下调用某个方法，就可以将这个方法设置为static。我们最常见的static方法就是main方法，至于为什么main方法必须是static的，现在就很清楚了。因为程序在执行main方法的时候没有创建任何对象，因此只有通过类名来访问。\n\n另外记住，关于构造器是否是static方法可参考：http://blog.csdn.net/qq_17864929/article/details/48006835\n\n**2. static变量**\n\nstatic变量也称作静态变量，静态变量和非静态变量的区别是：静态变量被所有的对象所共享，在内存中只有一个副本，它当且仅当在类初次加载时会被初始化。而非静态变量是对象所拥有的，在创建对象的时候被初始化，存在多个副本，各个对象拥有的副本互不影响。\n\nstatic成员变量的初始化顺序按照定义的顺序进行初始化。\n\n**3. static代码块**\n\nstatic关键字还有一个比较关键的作用就是 用来形成静态代码块以优化程序性能。static块可以置于类中的任何地方，类中可以有多个static块。在类初次被加载的时候，会按照static块的顺序来执行每个static块，并且只会执行一次。\n\n为什么说static块可以用来优化程序性能，是因为它的特性:只会在类加载的时候执行一次。下面看个例子:\n\n```java\nclass Person{\n    private Date birthDate;\n     \n    public Person(Date birthDate) {\n        this.birthDate = birthDate;\n    }\n     \n    boolean isBornBoomer() {\n        Date startDate = Date.valueOf(\"1946\");\n        Date endDate = Date.valueOf(\"1964\");\n        return birthDate.compareTo(startDate)>=0 && birthDate.compareTo(endDate) < 0;\n    }\n}\n```\nisBornBoomer是用来这个人是否是1946-1964年出生的，而每次isBornBoomer被调用的时候，都会生成startDate和birthDate两个对象，造成了空间浪费，如果改成这样效率会更好：\n\n```java \nclass Person{\n    private Date birthDate;\n    private static Date startDate,endDate;\n    static{\n        startDate = Date.valueOf(\"1946\");\n        endDate = Date.valueOf(\"1964\");\n    }\n     \n    public Person(Date birthDate) {\n        this.birthDate = birthDate;\n    }\n     \n    boolean isBornBoomer() {\n        return birthDate.compareTo(startDate)>=0 && birthDate.compareTo(endDate) < 0;\n    }\n}\n```\n因此，很多时候会将一些只需要进行一次的初始化操作都放在static代码块中进行。\n\n## 二. Static关键字的误区\n\n**1. static关键字会改变类中成员的访问权限吗？**\n\n有些初学的朋友会将java中的static与C/C++中的static关键字的功能混淆了。在这里只需要记住一点：与C/C++中的static不同，Java中的static关键字不会影响到变量或者方法的作用域。在Java中能够影响到访问权限的只有private、public、protected（包括包访问权限）这几个关键字。static关键字并不会改变变量和方法的访问权限。\n\n**2. 能通过this访问静态成员变量吗？**\n\n虽然对于静态方法来说没有this，那么在非静态方法中能够通过this访问静态成员变量吗？先看下面的一个例子，这段代码输出的结果是什么？\n\n```java\npublic class Main {　　\n    static int value = 33;\n \n    public static void main(String[] args) throws Exception{\n        new Main().printValue();\n    }\n \n    private void printValue(){\n        int value = 3;\n        System.out.println(this.value);\n    }\n}\n/**\n33\n*/\n```\n\n这里面主要考察队this和static的理解。this代表什么？this代表当前对象，那么通过new Main()来调用printValue的话，当前对象就是通过new Main()生成的对象。而static变量是被对象所享有的，因此在printValue中的this.value的值毫无疑问是33。在printValue方法内部的value是局部变量，根本不可能与this关联，所以输出结果是33。在这里永远要记住一点：静态成员变量虽然独立于对象，但是不代表不可以通过对象去访问，所有的静态方法和静态变量都可以通过对象访问（只要访问权限足够）。\n\n**3. static能作用于局部变量么？**\n\n在C/C++中static是可以作用域局部变量的，但是在Java中切记：static是不允许用来修饰局部变量。不要问为什么，这是Java语法的规定。\n\n具体原因可以参考这篇博文的讨论：http://www.debugease.com/j2se/178932.html\n\n## 三. 常见笔试面试题\n\n**1. 下面这段代码的输出结果是什么？**\n\n```java\npublic class Test extends Base{\n \n    static{\n        System.out.println(\"test static\");\n    }\n     \n    public Test(){\n        System.out.println(\"test constructor\");\n    }\n     \n    public static void main(String[] args) {\n        new Test();\n    }\n}\n \nclass Base{\n     \n    static{\n        System.out.println(\"base static\");\n    }\n     \n    public Base(){\n        System.out.println(\"base constructor\");\n    }\n}\n\n/**\nbase static\ntest static\nbase constructor\ntest constructor\n*/\n```\n\n至于为什么是这个结果，我们先不讨论，先来想一下这段代码具体的执行过程，在执行开始，先要寻找到main方法，因为main方法是程序的入口，但是在执行main方法之前，必须先加载Test类，而在加载Test类的时候发现Test类继承自Base类，因此会转去先加载Base类，在加载Base类的时候，发现有static块，便执行了static块。在Base类加载完成之后，便继续加载Test类，然后发现Test类中也有static块，便执行static块。在加载完所需的类之后，便开始执行main方法。在main方法中执行new Test()的时候会先调用父类的构造器，然后再调用自身的构造器。因此，便出现了上面的输出结果。\n\n**2. 这段代码的输出结果是什么？**\n\n```java\npublic class Test {\n    Person person = new Person(\"Test\");\n    static{\n        System.out.println(\"test static\");\n    }\n     \n    public Test() {\n        System.out.println(\"test constructor\");\n    }\n     \n    public static void main(String[] args) {\n        new MyClass();\n    }\n}\n \nclass Person{\n    static{\n        System.out.println(\"person static\");\n    }\n    public Person(String str) {\n        System.out.println(\"person \"+str);\n    }\n}\n \n \nclass MyClass extends Test {\n    Person person = new Person(\"MyClass\");\n    static{\n        System.out.println(\"myclass static\");\n    }\n     \n    public MyClass() {\n        System.out.println(\"myclass constructor\");\n    }\n}\n\n/**\ntest static\nmyclass static\nperson static\nperson Test\ntest constructor\nperson MyClass\nmyclass constructor\n*/\n```\n\n类似地，我们还是来想一下这段代码的具体执行过程。首先加载Test类，因此会执行Test类中的static块。接着执行new MyClass()，而MyClass类还没有被加载，因此需要加载MyClass类。在加载MyClass类的时候，发现MyClass类继承自Test类，但是由于Test类已经被加载了，所以只需要加载MyClass类，那么就会执行MyClass类的中的static块。在加载完之后，就通过构造器来生成对象。而在生成对象的时候，必须先初始化父类的成员变量，因此会执行Test中的Person person = new Person()，而Person类还没有被加载过，因此会先加载Person类并执行Person类中的static块，接着执行父类的构造器，完成了父类的初始化，然后就来初始化自身了，因此会接着执行MyClass中的Person person = new Person()，最后执行MyClass的构造器。\n\n**3. 这段代码的输出结果是什么？**\n\n```java\npublic class Test {\n     \n    static{\n        System.out.println(\"test static 1\");\n    }\n    public static void main(String[] args) {\n         \n    }\n     \n    static{\n        System.out.println(\"test static 2\");\n    }\n}\n\n/**\ntest static 1\ntest static 2\n*/\n```\n虽然在main方法中没有任何语句，但是还是会输出，原因上面已经讲述过了。另外，static块可以出现类中的任何地方 **只要不是方法内部，记住，任何方法内部都不行** ，并且执行是按照static块的顺序执行的。","source":"_posts/notebook/static.md","raw":"# Static 理解\n\n## 一. Static关键字的用途\n\n在《Java编程思想》P86页有这样一段话：\n\n　　*“static方法就是没有this的方法。在static方法内部不能调用非静态方法，反过来是可以的。而且可以在没有创建任何对象的前提下，仅仅通过类本身来调用static方法。这实际上正是static方法的主要用途。”*\n\n这段话虽然只是说明了static方法的特殊之处，但是可以看出static关键字的基本作用，简而言之，一句话来描述就是：\n\n方便在没有创建对象的情况下来进行调用（方法/变量）。\n\n很显然，被static关键字修饰的方法或者变量不需要依赖于对象来进行访问，只要类被加载了，就可以通过类名去进行访问。\n\nstatic可以用来修饰类的成员方法、类的成员变量，另外可以编写static代码块来优化程序性能。\n\n**1. static方法**\n\nstatic方法一般称作静态方法，由于静态方法不依赖于任何对象就可以进行访问，因此对于静态方法来说，是没有this的，因为它不依附于任何对象，既然都没有对象，就谈不上this了。并且由于这个特性，在静态方法中不能访问类的非静态成员变量和非静态成员方法，因为非静态成员方法/变量都是必须依赖具体的对象才能够被调用。\n\n但是要注意的是，虽然在静态方法中不能访问非静态成员方法和非静态成员变量，但是在非静态成员方法中是可以访问静态成员方法/变量的。举个简单的例子：\n\n在上面的代码中，由于print2方法是独立于对象存在的，可以直接用过类名调用。假如说可以在静态方法中访问非静态方法/变量的话，那么如果在main方法中有下面一条语句：\n\nMyObject.print2();\n\n此时对象都没有，str2根本就不存在，所以就会产生矛盾了。同样对于方法也是一样，由于你无法预知在print1方法中是否访问了非静态成员变量，所以也禁止在静态成员方法中访问非静态成员方法。\n\n而对于非静态成员方法，它访问静态成员方法/变量显然是毫无限制的。\n\n因此，如果说想在不创建对象的情况下调用某个方法，就可以将这个方法设置为static。我们最常见的static方法就是main方法，至于为什么main方法必须是static的，现在就很清楚了。因为程序在执行main方法的时候没有创建任何对象，因此只有通过类名来访问。\n\n另外记住，关于构造器是否是static方法可参考：http://blog.csdn.net/qq_17864929/article/details/48006835\n\n**2. static变量**\n\nstatic变量也称作静态变量，静态变量和非静态变量的区别是：静态变量被所有的对象所共享，在内存中只有一个副本，它当且仅当在类初次加载时会被初始化。而非静态变量是对象所拥有的，在创建对象的时候被初始化，存在多个副本，各个对象拥有的副本互不影响。\n\nstatic成员变量的初始化顺序按照定义的顺序进行初始化。\n\n**3. static代码块**\n\nstatic关键字还有一个比较关键的作用就是 用来形成静态代码块以优化程序性能。static块可以置于类中的任何地方，类中可以有多个static块。在类初次被加载的时候，会按照static块的顺序来执行每个static块，并且只会执行一次。\n\n为什么说static块可以用来优化程序性能，是因为它的特性:只会在类加载的时候执行一次。下面看个例子:\n\n```java\nclass Person{\n    private Date birthDate;\n     \n    public Person(Date birthDate) {\n        this.birthDate = birthDate;\n    }\n     \n    boolean isBornBoomer() {\n        Date startDate = Date.valueOf(\"1946\");\n        Date endDate = Date.valueOf(\"1964\");\n        return birthDate.compareTo(startDate)>=0 && birthDate.compareTo(endDate) < 0;\n    }\n}\n```\nisBornBoomer是用来这个人是否是1946-1964年出生的，而每次isBornBoomer被调用的时候，都会生成startDate和birthDate两个对象，造成了空间浪费，如果改成这样效率会更好：\n\n```java \nclass Person{\n    private Date birthDate;\n    private static Date startDate,endDate;\n    static{\n        startDate = Date.valueOf(\"1946\");\n        endDate = Date.valueOf(\"1964\");\n    }\n     \n    public Person(Date birthDate) {\n        this.birthDate = birthDate;\n    }\n     \n    boolean isBornBoomer() {\n        return birthDate.compareTo(startDate)>=0 && birthDate.compareTo(endDate) < 0;\n    }\n}\n```\n因此，很多时候会将一些只需要进行一次的初始化操作都放在static代码块中进行。\n\n## 二. Static关键字的误区\n\n**1. static关键字会改变类中成员的访问权限吗？**\n\n有些初学的朋友会将java中的static与C/C++中的static关键字的功能混淆了。在这里只需要记住一点：与C/C++中的static不同，Java中的static关键字不会影响到变量或者方法的作用域。在Java中能够影响到访问权限的只有private、public、protected（包括包访问权限）这几个关键字。static关键字并不会改变变量和方法的访问权限。\n\n**2. 能通过this访问静态成员变量吗？**\n\n虽然对于静态方法来说没有this，那么在非静态方法中能够通过this访问静态成员变量吗？先看下面的一个例子，这段代码输出的结果是什么？\n\n```java\npublic class Main {　　\n    static int value = 33;\n \n    public static void main(String[] args) throws Exception{\n        new Main().printValue();\n    }\n \n    private void printValue(){\n        int value = 3;\n        System.out.println(this.value);\n    }\n}\n/**\n33\n*/\n```\n\n这里面主要考察队this和static的理解。this代表什么？this代表当前对象，那么通过new Main()来调用printValue的话，当前对象就是通过new Main()生成的对象。而static变量是被对象所享有的，因此在printValue中的this.value的值毫无疑问是33。在printValue方法内部的value是局部变量，根本不可能与this关联，所以输出结果是33。在这里永远要记住一点：静态成员变量虽然独立于对象，但是不代表不可以通过对象去访问，所有的静态方法和静态变量都可以通过对象访问（只要访问权限足够）。\n\n**3. static能作用于局部变量么？**\n\n在C/C++中static是可以作用域局部变量的，但是在Java中切记：static是不允许用来修饰局部变量。不要问为什么，这是Java语法的规定。\n\n具体原因可以参考这篇博文的讨论：http://www.debugease.com/j2se/178932.html\n\n## 三. 常见笔试面试题\n\n**1. 下面这段代码的输出结果是什么？**\n\n```java\npublic class Test extends Base{\n \n    static{\n        System.out.println(\"test static\");\n    }\n     \n    public Test(){\n        System.out.println(\"test constructor\");\n    }\n     \n    public static void main(String[] args) {\n        new Test();\n    }\n}\n \nclass Base{\n     \n    static{\n        System.out.println(\"base static\");\n    }\n     \n    public Base(){\n        System.out.println(\"base constructor\");\n    }\n}\n\n/**\nbase static\ntest static\nbase constructor\ntest constructor\n*/\n```\n\n至于为什么是这个结果，我们先不讨论，先来想一下这段代码具体的执行过程，在执行开始，先要寻找到main方法，因为main方法是程序的入口，但是在执行main方法之前，必须先加载Test类，而在加载Test类的时候发现Test类继承自Base类，因此会转去先加载Base类，在加载Base类的时候，发现有static块，便执行了static块。在Base类加载完成之后，便继续加载Test类，然后发现Test类中也有static块，便执行static块。在加载完所需的类之后，便开始执行main方法。在main方法中执行new Test()的时候会先调用父类的构造器，然后再调用自身的构造器。因此，便出现了上面的输出结果。\n\n**2. 这段代码的输出结果是什么？**\n\n```java\npublic class Test {\n    Person person = new Person(\"Test\");\n    static{\n        System.out.println(\"test static\");\n    }\n     \n    public Test() {\n        System.out.println(\"test constructor\");\n    }\n     \n    public static void main(String[] args) {\n        new MyClass();\n    }\n}\n \nclass Person{\n    static{\n        System.out.println(\"person static\");\n    }\n    public Person(String str) {\n        System.out.println(\"person \"+str);\n    }\n}\n \n \nclass MyClass extends Test {\n    Person person = new Person(\"MyClass\");\n    static{\n        System.out.println(\"myclass static\");\n    }\n     \n    public MyClass() {\n        System.out.println(\"myclass constructor\");\n    }\n}\n\n/**\ntest static\nmyclass static\nperson static\nperson Test\ntest constructor\nperson MyClass\nmyclass constructor\n*/\n```\n\n类似地，我们还是来想一下这段代码的具体执行过程。首先加载Test类，因此会执行Test类中的static块。接着执行new MyClass()，而MyClass类还没有被加载，因此需要加载MyClass类。在加载MyClass类的时候，发现MyClass类继承自Test类，但是由于Test类已经被加载了，所以只需要加载MyClass类，那么就会执行MyClass类的中的static块。在加载完之后，就通过构造器来生成对象。而在生成对象的时候，必须先初始化父类的成员变量，因此会执行Test中的Person person = new Person()，而Person类还没有被加载过，因此会先加载Person类并执行Person类中的static块，接着执行父类的构造器，完成了父类的初始化，然后就来初始化自身了，因此会接着执行MyClass中的Person person = new Person()，最后执行MyClass的构造器。\n\n**3. 这段代码的输出结果是什么？**\n\n```java\npublic class Test {\n     \n    static{\n        System.out.println(\"test static 1\");\n    }\n    public static void main(String[] args) {\n         \n    }\n     \n    static{\n        System.out.println(\"test static 2\");\n    }\n}\n\n/**\ntest static 1\ntest static 2\n*/\n```\n虽然在main方法中没有任何语句，但是还是会输出，原因上面已经讲述过了。另外，static块可以出现类中的任何地方 **只要不是方法内部，记住，任何方法内部都不行** ，并且执行是按照static块的顺序执行的。","slug":"notebook/static","published":1,"date":"2020-03-11T15:53:05.122Z","updated":"2020-03-11T16:41:39.484Z","title":"notebook/static","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981c00am018o5ehz30n4","content":"<h1 id=\"Static-理解\"><a href=\"#Static-理解\" class=\"headerlink\" title=\"Static 理解\"></a>Static 理解</h1><h2 id=\"一-Static关键字的用途\"><a href=\"#一-Static关键字的用途\" class=\"headerlink\" title=\"一. Static关键字的用途\"></a>一. Static关键字的用途</h2><p>在《Java编程思想》P86页有这样一段话：</p>\n<p>　　<em>“static方法就是没有this的方法。在static方法内部不能调用非静态方法，反过来是可以的。而且可以在没有创建任何对象的前提下，仅仅通过类本身来调用static方法。这实际上正是static方法的主要用途。”</em></p>\n<p>这段话虽然只是说明了static方法的特殊之处，但是可以看出static关键字的基本作用，简而言之，一句话来描述就是：</p>\n<p>方便在没有创建对象的情况下来进行调用（方法/变量）。</p>\n<p>很显然，被static关键字修饰的方法或者变量不需要依赖于对象来进行访问，只要类被加载了，就可以通过类名去进行访问。</p>\n<p>static可以用来修饰类的成员方法、类的成员变量，另外可以编写static代码块来优化程序性能。</p>\n<p><strong>1. static方法</strong></p>\n<p>static方法一般称作静态方法，由于静态方法不依赖于任何对象就可以进行访问，因此对于静态方法来说，是没有this的，因为它不依附于任何对象，既然都没有对象，就谈不上this了。并且由于这个特性，在静态方法中不能访问类的非静态成员变量和非静态成员方法，因为非静态成员方法/变量都是必须依赖具体的对象才能够被调用。</p>\n<p>但是要注意的是，虽然在静态方法中不能访问非静态成员方法和非静态成员变量，但是在非静态成员方法中是可以访问静态成员方法/变量的。举个简单的例子：</p>\n<p>在上面的代码中，由于print2方法是独立于对象存在的，可以直接用过类名调用。假如说可以在静态方法中访问非静态方法/变量的话，那么如果在main方法中有下面一条语句：</p>\n<p>MyObject.print2();</p>\n<p>此时对象都没有，str2根本就不存在，所以就会产生矛盾了。同样对于方法也是一样，由于你无法预知在print1方法中是否访问了非静态成员变量，所以也禁止在静态成员方法中访问非静态成员方法。</p>\n<p>而对于非静态成员方法，它访问静态成员方法/变量显然是毫无限制的。</p>\n<p>因此，如果说想在不创建对象的情况下调用某个方法，就可以将这个方法设置为static。我们最常见的static方法就是main方法，至于为什么main方法必须是static的，现在就很清楚了。因为程序在执行main方法的时候没有创建任何对象，因此只有通过类名来访问。</p>\n<p>另外记住，关于构造器是否是static方法可参考：<span class=\"exturl\" data-url=\"aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMTc4NjQ5MjkvYXJ0aWNsZS9kZXRhaWxzLzQ4MDA2ODM1\">http://blog.csdn.net/qq_17864929/article/details/48006835<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><strong>2. static变量</strong></p>\n<p>static变量也称作静态变量，静态变量和非静态变量的区别是：静态变量被所有的对象所共享，在内存中只有一个副本，它当且仅当在类初次加载时会被初始化。而非静态变量是对象所拥有的，在创建对象的时候被初始化，存在多个副本，各个对象拥有的副本互不影响。</p>\n<p>static成员变量的初始化顺序按照定义的顺序进行初始化。</p>\n<p><strong>3. static代码块</strong></p>\n<p>static关键字还有一个比较关键的作用就是 用来形成静态代码块以优化程序性能。static块可以置于类中的任何地方，类中可以有多个static块。在类初次被加载的时候，会按照static块的顺序来执行每个static块，并且只会执行一次。</p>\n<p>为什么说static块可以用来优化程序性能，是因为它的特性:只会在类加载的时候执行一次。下面看个例子:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthDate;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(Date birthDate)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.birthDate = birthDate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isBornBoomer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Date startDate = Date.valueOf(<span class=\"string\">\"1946\"</span>);</span><br><span class=\"line\">        Date endDate = Date.valueOf(<span class=\"string\">\"1964\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> birthDate.compareTo(startDate)&gt;=<span class=\"number\">0</span> &amp;&amp; birthDate.compareTo(endDate) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>isBornBoomer是用来这个人是否是1946-1964年出生的，而每次isBornBoomer被调用的时候，都会生成startDate和birthDate两个对象，造成了空间浪费，如果改成这样效率会更好：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthDate;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Date startDate,endDate;</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        startDate = Date.valueOf(<span class=\"string\">\"1946\"</span>);</span><br><span class=\"line\">        endDate = Date.valueOf(<span class=\"string\">\"1964\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(Date birthDate)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.birthDate = birthDate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isBornBoomer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> birthDate.compareTo(startDate)&gt;=<span class=\"number\">0</span> &amp;&amp; birthDate.compareTo(endDate) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>因此，很多时候会将一些只需要进行一次的初始化操作都放在static代码块中进行。</p>\n<h2 id=\"二-Static关键字的误区\"><a href=\"#二-Static关键字的误区\" class=\"headerlink\" title=\"二. Static关键字的误区\"></a>二. Static关键字的误区</h2><p><strong>1. static关键字会改变类中成员的访问权限吗？</strong></p>\n<p>有些初学的朋友会将java中的static与C/C++中的static关键字的功能混淆了。在这里只需要记住一点：与C/C++中的static不同，Java中的static关键字不会影响到变量或者方法的作用域。在Java中能够影响到访问权限的只有private、public、protected（包括包访问权限）这几个关键字。static关键字并不会改变变量和方法的访问权限。</p>\n<p><strong>2. 能通过this访问静态成员变量吗？</strong></p>\n<p>虽然对于静态方法来说没有this，那么在非静态方法中能够通过this访问静态成员变量吗？先看下面的一个例子，这段代码输出的结果是什么？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;　　</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> value = <span class=\"number\">33</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Main().printValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">printValue</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> value = <span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">33</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>这里面主要考察队this和static的理解。this代表什么？this代表当前对象，那么通过new Main()来调用printValue的话，当前对象就是通过new Main()生成的对象。而static变量是被对象所享有的，因此在printValue中的this.value的值毫无疑问是33。在printValue方法内部的value是局部变量，根本不可能与this关联，所以输出结果是33。在这里永远要记住一点：静态成员变量虽然独立于对象，但是不代表不可以通过对象去访问，所有的静态方法和静态变量都可以通过对象访问（只要访问权限足够）。</p>\n<p><strong>3. static能作用于局部变量么？</strong></p>\n<p>在C/C++中static是可以作用域局部变量的，但是在Java中切记：static是不允许用来修饰局部变量。不要问为什么，这是Java语法的规定。</p>\n<p>具体原因可以参考这篇博文的讨论：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5kZWJ1Z2Vhc2UuY29tL2oyc2UvMTc4OTMyLmh0bWw=\">http://www.debugease.com/j2se/178932.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h2 id=\"三-常见笔试面试题\"><a href=\"#三-常见笔试面试题\" class=\"headerlink\" title=\"三. 常见笔试面试题\"></a>三. 常见笔试面试题</h2><p><strong>1. 下面这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> <span class=\"keyword\">extends</span> <span class=\"title\">Base</span></span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Test();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Base</span></span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"base static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Base</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"base constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">base static</span></span><br><span class=\"line\"><span class=\"comment\">test static</span></span><br><span class=\"line\"><span class=\"comment\">base constructor</span></span><br><span class=\"line\"><span class=\"comment\">test constructor</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>至于为什么是这个结果，我们先不讨论，先来想一下这段代码具体的执行过程，在执行开始，先要寻找到main方法，因为main方法是程序的入口，但是在执行main方法之前，必须先加载Test类，而在加载Test类的时候发现Test类继承自Base类，因此会转去先加载Base类，在加载Base类的时候，发现有static块，便执行了static块。在Base类加载完成之后，便继续加载Test类，然后发现Test类中也有static块，便执行static块。在加载完所需的类之后，便开始执行main方法。在main方法中执行new Test()的时候会先调用父类的构造器，然后再调用自身的构造器。因此，便出现了上面的输出结果。</p>\n<p><strong>2. 这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    Person person = <span class=\"keyword\">new</span> Person(<span class=\"string\">\"Test\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> MyClass();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(String str)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person \"</span>+str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> <span class=\"keyword\">extends</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    Person person = <span class=\"keyword\">new</span> Person(<span class=\"string\">\"MyClass\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"myclass static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"myclass constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">test static</span></span><br><span class=\"line\"><span class=\"comment\">myclass static</span></span><br><span class=\"line\"><span class=\"comment\">person static</span></span><br><span class=\"line\"><span class=\"comment\">person Test</span></span><br><span class=\"line\"><span class=\"comment\">test constructor</span></span><br><span class=\"line\"><span class=\"comment\">person MyClass</span></span><br><span class=\"line\"><span class=\"comment\">myclass constructor</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>类似地，我们还是来想一下这段代码的具体执行过程。首先加载Test类，因此会执行Test类中的static块。接着执行new MyClass()，而MyClass类还没有被加载，因此需要加载MyClass类。在加载MyClass类的时候，发现MyClass类继承自Test类，但是由于Test类已经被加载了，所以只需要加载MyClass类，那么就会执行MyClass类的中的static块。在加载完之后，就通过构造器来生成对象。而在生成对象的时候，必须先初始化父类的成员变量，因此会执行Test中的Person person = new Person()，而Person类还没有被加载过，因此会先加载Person类并执行Person类中的static块，接着执行父类的构造器，完成了父类的初始化，然后就来初始化自身了，因此会接着执行MyClass中的Person person = new Person()，最后执行MyClass的构造器。</p>\n<p><strong>3. 这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static 1\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">         </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static 2\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">test static 1</span></span><br><span class=\"line\"><span class=\"comment\">test static 2</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>虽然在main方法中没有任何语句，但是还是会输出，原因上面已经讲述过了。另外，static块可以出现类中的任何地方 <strong>只要不是方法内部，记住，任何方法内部都不行</strong> ，并且执行是按照static块的顺序执行的。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Static-理解\"><a href=\"#Static-理解\" class=\"headerlink\" title=\"Static 理解\"></a>Static 理解</h1><h2 id=\"一-Static关键字的用途\"><a href=\"#一-Static关键字的用途\" class=\"headerlink\" title=\"一. Static关键字的用途\"></a>一. Static关键字的用途</h2><p>在《Java编程思想》P86页有这样一段话：</p>\n<p>　　<em>“static方法就是没有this的方法。在static方法内部不能调用非静态方法，反过来是可以的。而且可以在没有创建任何对象的前提下，仅仅通过类本身来调用static方法。这实际上正是static方法的主要用途。”</em></p>\n<p>这段话虽然只是说明了static方法的特殊之处，但是可以看出static关键字的基本作用，简而言之，一句话来描述就是：</p>\n<p>方便在没有创建对象的情况下来进行调用（方法/变量）。</p>\n<p>很显然，被static关键字修饰的方法或者变量不需要依赖于对象来进行访问，只要类被加载了，就可以通过类名去进行访问。</p>\n<p>static可以用来修饰类的成员方法、类的成员变量，另外可以编写static代码块来优化程序性能。</p>\n<p><strong>1. static方法</strong></p>\n<p>static方法一般称作静态方法，由于静态方法不依赖于任何对象就可以进行访问，因此对于静态方法来说，是没有this的，因为它不依附于任何对象，既然都没有对象，就谈不上this了。并且由于这个特性，在静态方法中不能访问类的非静态成员变量和非静态成员方法，因为非静态成员方法/变量都是必须依赖具体的对象才能够被调用。</p>\n<p>但是要注意的是，虽然在静态方法中不能访问非静态成员方法和非静态成员变量，但是在非静态成员方法中是可以访问静态成员方法/变量的。举个简单的例子：</p>\n<p>在上面的代码中，由于print2方法是独立于对象存在的，可以直接用过类名调用。假如说可以在静态方法中访问非静态方法/变量的话，那么如果在main方法中有下面一条语句：</p>\n<p>MyObject.print2();</p>\n<p>此时对象都没有，str2根本就不存在，所以就会产生矛盾了。同样对于方法也是一样，由于你无法预知在print1方法中是否访问了非静态成员变量，所以也禁止在静态成员方法中访问非静态成员方法。</p>\n<p>而对于非静态成员方法，它访问静态成员方法/变量显然是毫无限制的。</p>\n<p>因此，如果说想在不创建对象的情况下调用某个方法，就可以将这个方法设置为static。我们最常见的static方法就是main方法，至于为什么main方法必须是static的，现在就很清楚了。因为程序在执行main方法的时候没有创建任何对象，因此只有通过类名来访问。</p>\n<p>另外记住，关于构造器是否是static方法可参考：<span class=\"exturl\" data-url=\"aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMTc4NjQ5MjkvYXJ0aWNsZS9kZXRhaWxzLzQ4MDA2ODM1\">http://blog.csdn.net/qq_17864929/article/details/48006835<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><strong>2. static变量</strong></p>\n<p>static变量也称作静态变量，静态变量和非静态变量的区别是：静态变量被所有的对象所共享，在内存中只有一个副本，它当且仅当在类初次加载时会被初始化。而非静态变量是对象所拥有的，在创建对象的时候被初始化，存在多个副本，各个对象拥有的副本互不影响。</p>\n<p>static成员变量的初始化顺序按照定义的顺序进行初始化。</p>\n<p><strong>3. static代码块</strong></p>\n<p>static关键字还有一个比较关键的作用就是 用来形成静态代码块以优化程序性能。static块可以置于类中的任何地方，类中可以有多个static块。在类初次被加载的时候，会按照static块的顺序来执行每个static块，并且只会执行一次。</p>\n<p>为什么说static块可以用来优化程序性能，是因为它的特性:只会在类加载的时候执行一次。下面看个例子:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthDate;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(Date birthDate)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.birthDate = birthDate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isBornBoomer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Date startDate = Date.valueOf(<span class=\"string\">\"1946\"</span>);</span><br><span class=\"line\">        Date endDate = Date.valueOf(<span class=\"string\">\"1964\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> birthDate.compareTo(startDate)&gt;=<span class=\"number\">0</span> &amp;&amp; birthDate.compareTo(endDate) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>isBornBoomer是用来这个人是否是1946-1964年出生的，而每次isBornBoomer被调用的时候，都会生成startDate和birthDate两个对象，造成了空间浪费，如果改成这样效率会更好：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthDate;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Date startDate,endDate;</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        startDate = Date.valueOf(<span class=\"string\">\"1946\"</span>);</span><br><span class=\"line\">        endDate = Date.valueOf(<span class=\"string\">\"1964\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(Date birthDate)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.birthDate = birthDate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">isBornBoomer</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> birthDate.compareTo(startDate)&gt;=<span class=\"number\">0</span> &amp;&amp; birthDate.compareTo(endDate) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>因此，很多时候会将一些只需要进行一次的初始化操作都放在static代码块中进行。</p>\n<h2 id=\"二-Static关键字的误区\"><a href=\"#二-Static关键字的误区\" class=\"headerlink\" title=\"二. Static关键字的误区\"></a>二. Static关键字的误区</h2><p><strong>1. static关键字会改变类中成员的访问权限吗？</strong></p>\n<p>有些初学的朋友会将java中的static与C/C++中的static关键字的功能混淆了。在这里只需要记住一点：与C/C++中的static不同，Java中的static关键字不会影响到变量或者方法的作用域。在Java中能够影响到访问权限的只有private、public、protected（包括包访问权限）这几个关键字。static关键字并不会改变变量和方法的访问权限。</p>\n<p><strong>2. 能通过this访问静态成员变量吗？</strong></p>\n<p>虽然对于静态方法来说没有this，那么在非静态方法中能够通过this访问静态成员变量吗？先看下面的一个例子，这段代码输出的结果是什么？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;　　</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> value = <span class=\"number\">33</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Main().printValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">printValue</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> value = <span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">33</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>这里面主要考察队this和static的理解。this代表什么？this代表当前对象，那么通过new Main()来调用printValue的话，当前对象就是通过new Main()生成的对象。而static变量是被对象所享有的，因此在printValue中的this.value的值毫无疑问是33。在printValue方法内部的value是局部变量，根本不可能与this关联，所以输出结果是33。在这里永远要记住一点：静态成员变量虽然独立于对象，但是不代表不可以通过对象去访问，所有的静态方法和静态变量都可以通过对象访问（只要访问权限足够）。</p>\n<p><strong>3. static能作用于局部变量么？</strong></p>\n<p>在C/C++中static是可以作用域局部变量的，但是在Java中切记：static是不允许用来修饰局部变量。不要问为什么，这是Java语法的规定。</p>\n<p>具体原因可以参考这篇博文的讨论：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5kZWJ1Z2Vhc2UuY29tL2oyc2UvMTc4OTMyLmh0bWw=\">http://www.debugease.com/j2se/178932.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h2 id=\"三-常见笔试面试题\"><a href=\"#三-常见笔试面试题\" class=\"headerlink\" title=\"三. 常见笔试面试题\"></a>三. 常见笔试面试题</h2><p><strong>1. 下面这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> <span class=\"keyword\">extends</span> <span class=\"title\">Base</span></span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Test();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Base</span></span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"base static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Base</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"base constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">base static</span></span><br><span class=\"line\"><span class=\"comment\">test static</span></span><br><span class=\"line\"><span class=\"comment\">base constructor</span></span><br><span class=\"line\"><span class=\"comment\">test constructor</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>至于为什么是这个结果，我们先不讨论，先来想一下这段代码具体的执行过程，在执行开始，先要寻找到main方法，因为main方法是程序的入口，但是在执行main方法之前，必须先加载Test类，而在加载Test类的时候发现Test类继承自Base类，因此会转去先加载Base类，在加载Base类的时候，发现有static块，便执行了static块。在Base类加载完成之后，便继续加载Test类，然后发现Test类中也有static块，便执行static块。在加载完所需的类之后，便开始执行main方法。在main方法中执行new Test()的时候会先调用父类的构造器，然后再调用自身的构造器。因此，便出现了上面的输出结果。</p>\n<p><strong>2. 这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    Person person = <span class=\"keyword\">new</span> Person(<span class=\"string\">\"Test\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> MyClass();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(String str)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"person \"</span>+str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> <span class=\"keyword\">extends</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    Person person = <span class=\"keyword\">new</span> Person(<span class=\"string\">\"MyClass\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"myclass static\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"myclass constructor\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">test static</span></span><br><span class=\"line\"><span class=\"comment\">myclass static</span></span><br><span class=\"line\"><span class=\"comment\">person static</span></span><br><span class=\"line\"><span class=\"comment\">person Test</span></span><br><span class=\"line\"><span class=\"comment\">test constructor</span></span><br><span class=\"line\"><span class=\"comment\">person MyClass</span></span><br><span class=\"line\"><span class=\"comment\">myclass constructor</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<p>类似地，我们还是来想一下这段代码的具体执行过程。首先加载Test类，因此会执行Test类中的static块。接着执行new MyClass()，而MyClass类还没有被加载，因此需要加载MyClass类。在加载MyClass类的时候，发现MyClass类继承自Test类，但是由于Test类已经被加载了，所以只需要加载MyClass类，那么就会执行MyClass类的中的static块。在加载完之后，就通过构造器来生成对象。而在生成对象的时候，必须先初始化父类的成员变量，因此会执行Test中的Person person = new Person()，而Person类还没有被加载过，因此会先加载Person类并执行Person类中的static块，接着执行父类的构造器，完成了父类的初始化，然后就来初始化自身了，因此会接着执行MyClass中的Person person = new Person()，最后执行MyClass的构造器。</p>\n<p><strong>3. 这段代码的输出结果是什么？</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static 1\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">         </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"test static 2\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">test static 1</span></span><br><span class=\"line\"><span class=\"comment\">test static 2</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n<p>虽然在main方法中没有任何语句，但是还是会输出，原因上面已经讲述过了。另外，static块可以出现类中的任何地方 <strong>只要不是方法内部，记住，任何方法内部都不行</strong> ，并且执行是按照static块的顺序执行的。</p>\n"},{"title":"自定义sh脚本","catagories":["Notebook"],"_content":"\n# 变量\n\n```sh\nVAL=\"this is val\"\n\nLIST=(\nThis\nis\nlist\n)\n\n```\n\n使用`$VAL`或`${VAL}`获取\n\n# 流程控制\n\n```sh\nif [ $VAL == \"sz\" ]\nthen\n  ...\nelif [ condition ]\nthen\n  ...\nelse\n  ...\nfi\n```\n\n\n\n**注意**\n\n1. []中的判断语句必须与[]间由空格隔开\n2. then必须换行\n\n## 配置文件\n\nServer.sh\n\n```sh\n# Banner\necho \"\nShenZhen: sz\nV2Ray: v2ray\nT40: t40(need vpn-ncepu)\n\"\n\n# All servers name\nSERVER_NAME=(\nsz\nv2ray\nt40\n)\n\n# Configuration\nSHENZHEN_HOST=\"119.23.107.61\"\nSHENZHEN_PORT=\"22\"\nV2RAY_HOST=\"47.240.166.68\"\nV2RAY_PORT=\"22\"\nT40_HOST=\"127.0.0.1\"\nT40_PORT=\"6002\"\n\n# SSH Server\nif [ $1 == \"sz\" ]\nthen\n  ssh root@${SHENZHEN_HOST} -p${SHENZHEN_PORT}\nelif [ $1 == 'v2ray' ]\nthen\n  ssh root@${V2RAY_HOST} -p${V2RAY_PORT}\nelif [ $1 == 't40' ]\nthen\n  ssh t40@${T40_HOST} -p${T40_PORT}\nelse\n  echo \"error: no this server!\"\nfi\n```\n\nVpn.sh\n\n```sh\n# Banner\necho \"\nNCEPU VPN\nport:6000 4*V100\nport:6001 2*2080Ti\nport:6002 4*T4\n\"\n\n# Configueration\nFRP_DIR=\"/Users/edlison/ExecApp/Frp/frpc\"\nFRP_CFG=\"/Users/edlison/ExecApp/Frp/cfg/frpc-ncepu.ini\"\n\n# Run Frp\n${FRP_DIR} -c${FRP_CFG}\n```\n\n","source":"_posts/notebook/sh.md","raw":"---\ntitle: 自定义sh脚本\ncatagories: \n- Notebook\ntags:\n- shell\n- zsh\n---\n\n# 变量\n\n```sh\nVAL=\"this is val\"\n\nLIST=(\nThis\nis\nlist\n)\n\n```\n\n使用`$VAL`或`${VAL}`获取\n\n# 流程控制\n\n```sh\nif [ $VAL == \"sz\" ]\nthen\n  ...\nelif [ condition ]\nthen\n  ...\nelse\n  ...\nfi\n```\n\n\n\n**注意**\n\n1. []中的判断语句必须与[]间由空格隔开\n2. then必须换行\n\n## 配置文件\n\nServer.sh\n\n```sh\n# Banner\necho \"\nShenZhen: sz\nV2Ray: v2ray\nT40: t40(need vpn-ncepu)\n\"\n\n# All servers name\nSERVER_NAME=(\nsz\nv2ray\nt40\n)\n\n# Configuration\nSHENZHEN_HOST=\"119.23.107.61\"\nSHENZHEN_PORT=\"22\"\nV2RAY_HOST=\"47.240.166.68\"\nV2RAY_PORT=\"22\"\nT40_HOST=\"127.0.0.1\"\nT40_PORT=\"6002\"\n\n# SSH Server\nif [ $1 == \"sz\" ]\nthen\n  ssh root@${SHENZHEN_HOST} -p${SHENZHEN_PORT}\nelif [ $1 == 'v2ray' ]\nthen\n  ssh root@${V2RAY_HOST} -p${V2RAY_PORT}\nelif [ $1 == 't40' ]\nthen\n  ssh t40@${T40_HOST} -p${T40_PORT}\nelse\n  echo \"error: no this server!\"\nfi\n```\n\nVpn.sh\n\n```sh\n# Banner\necho \"\nNCEPU VPN\nport:6000 4*V100\nport:6001 2*2080Ti\nport:6002 4*T4\n\"\n\n# Configueration\nFRP_DIR=\"/Users/edlison/ExecApp/Frp/frpc\"\nFRP_CFG=\"/Users/edlison/ExecApp/Frp/cfg/frpc-ncepu.ini\"\n\n# Run Frp\n${FRP_DIR} -c${FRP_CFG}\n```\n\n","slug":"notebook/sh","published":1,"date":"2021-01-20T08:13:37.136Z","updated":"2021-01-20T10:04:51.562Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981d00ap018oh5czfm50","content":"<h1 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VAL=<span class=\"string\">\"this is val\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">LIST=(</span><br><span class=\"line\">This</span><br><span class=\"line\">is</span><br><span class=\"line\">list</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>使用<code>$VAL</code>或<code>${VAL}</code>获取</p>\n<h1 id=\"流程控制\"><a href=\"#流程控制\" class=\"headerlink\" title=\"流程控制\"></a>流程控制</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$VAL</span> == <span class=\"string\">\"sz\"</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ condition ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>注意</strong></p>\n<ol>\n<li>[]中的判断语句必须与[]间由空格隔开</li>\n<li>then必须换行</li>\n</ol>\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>Server.sh</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Banner</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">ShenZhen: sz</span></span><br><span class=\"line\"><span class=\"string\">V2Ray: v2ray</span></span><br><span class=\"line\"><span class=\"string\">T40: t40(need vpn-ncepu)</span></span><br><span class=\"line\"><span class=\"string\">\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># All servers name</span></span><br><span class=\"line\">SERVER_NAME=(</span><br><span class=\"line\">sz</span><br><span class=\"line\">v2ray</span><br><span class=\"line\">t40</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Configuration</span></span><br><span class=\"line\">SHENZHEN_HOST=<span class=\"string\">\"119.23.107.61\"</span></span><br><span class=\"line\">SHENZHEN_PORT=<span class=\"string\">\"22\"</span></span><br><span class=\"line\">V2RAY_HOST=<span class=\"string\">\"47.240.166.68\"</span></span><br><span class=\"line\">V2RAY_PORT=<span class=\"string\">\"22\"</span></span><br><span class=\"line\">T40_HOST=<span class=\"string\">\"127.0.0.1\"</span></span><br><span class=\"line\">T40_PORT=<span class=\"string\">\"6002\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># SSH Server</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">\"sz\"</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh root@<span class=\"variable\">$&#123;SHENZHEN_HOST&#125;</span> -p<span class=\"variable\">$&#123;SHENZHEN_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">'v2ray'</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh root@<span class=\"variable\">$&#123;V2RAY_HOST&#125;</span> -p<span class=\"variable\">$&#123;V2RAY_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">'t40'</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh t40@<span class=\"variable\">$&#123;T40_HOST&#125;</span> -p<span class=\"variable\">$&#123;T40_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"error: no this server!\"</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<p>Vpn.sh</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Banner</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">NCEPU VPN</span></span><br><span class=\"line\"><span class=\"string\">port:6000 4*V100</span></span><br><span class=\"line\"><span class=\"string\">port:6001 2*2080Ti</span></span><br><span class=\"line\"><span class=\"string\">port:6002 4*T4</span></span><br><span class=\"line\"><span class=\"string\">\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Configueration</span></span><br><span class=\"line\">FRP_DIR=<span class=\"string\">\"/Users/edlison/ExecApp/Frp/frpc\"</span></span><br><span class=\"line\">FRP_CFG=<span class=\"string\">\"/Users/edlison/ExecApp/Frp/cfg/frpc-ncepu.ini\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Run Frp</span></span><br><span class=\"line\"><span class=\"variable\">$&#123;FRP_DIR&#125;</span> -c<span class=\"variable\">$&#123;FRP_CFG&#125;</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VAL=<span class=\"string\">\"this is val\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">LIST=(</span><br><span class=\"line\">This</span><br><span class=\"line\">is</span><br><span class=\"line\">list</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>使用<code>$VAL</code>或<code>${VAL}</code>获取</p>\n<h1 id=\"流程控制\"><a href=\"#流程控制\" class=\"headerlink\" title=\"流程控制\"></a>流程控制</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$VAL</span> == <span class=\"string\">\"sz\"</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ condition ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>注意</strong></p>\n<ol>\n<li>[]中的判断语句必须与[]间由空格隔开</li>\n<li>then必须换行</li>\n</ol>\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>Server.sh</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Banner</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">ShenZhen: sz</span></span><br><span class=\"line\"><span class=\"string\">V2Ray: v2ray</span></span><br><span class=\"line\"><span class=\"string\">T40: t40(need vpn-ncepu)</span></span><br><span class=\"line\"><span class=\"string\">\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># All servers name</span></span><br><span class=\"line\">SERVER_NAME=(</span><br><span class=\"line\">sz</span><br><span class=\"line\">v2ray</span><br><span class=\"line\">t40</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Configuration</span></span><br><span class=\"line\">SHENZHEN_HOST=<span class=\"string\">\"119.23.107.61\"</span></span><br><span class=\"line\">SHENZHEN_PORT=<span class=\"string\">\"22\"</span></span><br><span class=\"line\">V2RAY_HOST=<span class=\"string\">\"47.240.166.68\"</span></span><br><span class=\"line\">V2RAY_PORT=<span class=\"string\">\"22\"</span></span><br><span class=\"line\">T40_HOST=<span class=\"string\">\"127.0.0.1\"</span></span><br><span class=\"line\">T40_PORT=<span class=\"string\">\"6002\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># SSH Server</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">\"sz\"</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh root@<span class=\"variable\">$&#123;SHENZHEN_HOST&#125;</span> -p<span class=\"variable\">$&#123;SHENZHEN_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">'v2ray'</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh root@<span class=\"variable\">$&#123;V2RAY_HOST&#125;</span> -p<span class=\"variable\">$&#123;V2RAY_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">elif</span> [ <span class=\"variable\">$1</span> == <span class=\"string\">'t40'</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">  ssh t40@<span class=\"variable\">$&#123;T40_HOST&#125;</span> -p<span class=\"variable\">$&#123;T40_PORT&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"error: no this server!\"</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<p>Vpn.sh</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Banner</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">NCEPU VPN</span></span><br><span class=\"line\"><span class=\"string\">port:6000 4*V100</span></span><br><span class=\"line\"><span class=\"string\">port:6001 2*2080Ti</span></span><br><span class=\"line\"><span class=\"string\">port:6002 4*T4</span></span><br><span class=\"line\"><span class=\"string\">\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Configueration</span></span><br><span class=\"line\">FRP_DIR=<span class=\"string\">\"/Users/edlison/ExecApp/Frp/frpc\"</span></span><br><span class=\"line\">FRP_CFG=<span class=\"string\">\"/Users/edlison/ExecApp/Frp/cfg/frpc-ncepu.ini\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Run Frp</span></span><br><span class=\"line\"><span class=\"variable\">$&#123;FRP_DIR&#125;</span> -c<span class=\"variable\">$&#123;FRP_CFG&#125;</span></span><br></pre></td></tr></table></figure>\n\n"},{"title":"从0开始配置Ubuntu系统","catagories":["Notebook"],"_content":"\n# 创建Ubuntu系统镜像\n\nUbuntu默认的账号是ubuntu，腾讯云创建的密码也是ubuntu对应的密码。\n\n默认情况下，不能通过root使用密码远程登录。\n\n执行一下操作获取root用户远程密码登录的权限。\n\n- 设置root密码`sudo passwd root`\n- 设置ssh配置文件`sudo vim /etc/ssh/sshd_config`修改`PermitRootLogin yes`\n- 重启服务`sudo service ssh restart`\n\n# Ubuntu用户\n\n用户默认使用Ubuntu，在执行特殊操作时使用`sudo`指令。\n\n需要新建`.bashrc`来存储用户的`bash`配置文件。\n\n\n\n\n\n----\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1405735","source":"_posts/notebook/tx-ubuntu.md","raw":"---\ntitle: 从0开始配置Ubuntu系统\ncatagories: \n- Notebook\ntags: \n- cloud\n- vps\n---\n\n# 创建Ubuntu系统镜像\n\nUbuntu默认的账号是ubuntu，腾讯云创建的密码也是ubuntu对应的密码。\n\n默认情况下，不能通过root使用密码远程登录。\n\n执行一下操作获取root用户远程密码登录的权限。\n\n- 设置root密码`sudo passwd root`\n- 设置ssh配置文件`sudo vim /etc/ssh/sshd_config`修改`PermitRootLogin yes`\n- 重启服务`sudo service ssh restart`\n\n# Ubuntu用户\n\n用户默认使用Ubuntu，在执行特殊操作时使用`sudo`指令。\n\n需要新建`.bashrc`来存储用户的`bash`配置文件。\n\n\n\n\n\n----\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1405735","slug":"notebook/tx-ubuntu","published":1,"date":"2021-01-28T01:11:39.307Z","updated":"2021-01-29T03:32:26.790Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981e00as018o3r4ydc5e","content":"<h1 id=\"创建Ubuntu系统镜像\"><a href=\"#创建Ubuntu系统镜像\" class=\"headerlink\" title=\"创建Ubuntu系统镜像\"></a>创建Ubuntu系统镜像</h1><p>Ubuntu默认的账号是ubuntu，腾讯云创建的密码也是ubuntu对应的密码。</p>\n<p>默认情况下，不能通过root使用密码远程登录。</p>\n<p>执行一下操作获取root用户远程密码登录的权限。</p>\n<ul>\n<li>设置root密码<code>sudo passwd root</code></li>\n<li>设置ssh配置文件<code>sudo vim /etc/ssh/sshd_config</code>修改<code>PermitRootLogin yes</code></li>\n<li>重启服务<code>sudo service ssh restart</code></li>\n</ul>\n<h1 id=\"Ubuntu用户\"><a href=\"#Ubuntu用户\" class=\"headerlink\" title=\"Ubuntu用户\"></a>Ubuntu用户</h1><p>用户默认使用Ubuntu，在执行特殊操作时使用<code>sudo</code>指令。</p>\n<p>需要新建<code>.bashrc</code>来存储用户的<code>bash</code>配置文件。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNDA1NzM1\">https://cloud.tencent.com/developer/article/1405735<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"创建Ubuntu系统镜像\"><a href=\"#创建Ubuntu系统镜像\" class=\"headerlink\" title=\"创建Ubuntu系统镜像\"></a>创建Ubuntu系统镜像</h1><p>Ubuntu默认的账号是ubuntu，腾讯云创建的密码也是ubuntu对应的密码。</p>\n<p>默认情况下，不能通过root使用密码远程登录。</p>\n<p>执行一下操作获取root用户远程密码登录的权限。</p>\n<ul>\n<li>设置root密码<code>sudo passwd root</code></li>\n<li>设置ssh配置文件<code>sudo vim /etc/ssh/sshd_config</code>修改<code>PermitRootLogin yes</code></li>\n<li>重启服务<code>sudo service ssh restart</code></li>\n</ul>\n<h1 id=\"Ubuntu用户\"><a href=\"#Ubuntu用户\" class=\"headerlink\" title=\"Ubuntu用户\"></a>Ubuntu用户</h1><p>用户默认使用Ubuntu，在执行特殊操作时使用<code>sudo</code>指令。</p>\n<p>需要新建<code>.bashrc</code>来存储用户的<code>bash</code>配置文件。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNDA1NzM1\">https://cloud.tencent.com/developer/article/1405735<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"TensorFlow 训练流程","catagories":["Notebook"],"_content":"\n# 训练流程\n\nTODO\n\n# MNIST 数据集实例\n\nTODO","source":"_posts/notebook/tensorflow-start.md","raw":"---\ntitle: TensorFlow 训练流程\ncatagories:\n- Notebook\ntags:\n- python\n- tensorflow\n---\n\n# 训练流程\n\nTODO\n\n# MNIST 数据集实例\n\nTODO","slug":"notebook/tensorflow-start","published":1,"date":"2021-07-04T03:09:42.870Z","updated":"2021-10-15T19:39:03.696Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981f00aw018o3atzhzbx","content":"<h1 id=\"训练流程\"><a href=\"#训练流程\" class=\"headerlink\" title=\"训练流程\"></a>训练流程</h1><p>TODO</p>\n<h1 id=\"MNIST-数据集实例\"><a href=\"#MNIST-数据集实例\" class=\"headerlink\" title=\"MNIST 数据集实例\"></a>MNIST 数据集实例</h1><p>TODO</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"训练流程\"><a href=\"#训练流程\" class=\"headerlink\" title=\"训练流程\"></a>训练流程</h1><p>TODO</p>\n<h1 id=\"MNIST-数据集实例\"><a href=\"#MNIST-数据集实例\" class=\"headerlink\" title=\"MNIST 数据集实例\"></a>MNIST 数据集实例</h1><p>TODO</p>\n"},{"_content":"# 数据库笔记\n以下Mysql为例\n## 数据库完整性\n### 实体完整性\n实体完整性即主码，用`PRIMARY KEY`定义.\n\n- 列级约束：只能应用于一列上。\n- 表级约束：可以应用于表的多个列上。\n\n简而言之，如果完整性约束涉及到该表的多个属性列，必须定义在表级上，否则既可以定义在列级也可以定义在表级。\n\n\n\n### 参照完整性\n参照完整性即外码，用`FOREIGN KEY (列名) REFERENCES <表名>(列名)`定义.\n\n用constraint指定约束名，约束不指定名称时，系统会给定一个名称。\n\n**注意**：外码一定参照主码（可以是其他表的主码，也可以时自己的）,而且外码的列数一定要等于被参照表的主码列数。\n\n**违约处理**：对被参照表进行`update`/`delete`/`insert`操作时会破坏参照完整性时，参照表需要告诉被参照表听改怎么做。需要对参照表定义外码时添加`on delete`/`on update[<no action>/<cascade>]`\n\n- CASCADE:在父表（被参照表）上update/delete记录时，同步子表（参照表）的匹配记录。\n- SET NULL:在父表（被参照表）上update/delete记录时，将子表（参照表）上匹配的列设为null（子表的外键列不能为not null）。\n- NO ACTION:如果子表中有匹配的记录，不允许对父表进行操作。\n- RESTRICT:同NO ACTION，立即检查外键约束。\n\nNULL、RESTRICT、NO ACTION  \n删除：从表记录不存在时，主表才可以删除。删除从表，主表不变  \n更新：从表记录不存在时，主表才可以更新。更新从表，主表不变(无法更新从表)\n\nCASCADE  \n删除：删除主表时自动删除从表。删除从表，主表不变  \n更新：更新主表时自动更新从表。更新从表，主表不变(无法更新从表)\n\nSET NULL  \n删除：删除主表时自动更新从表值为NULL。删除从表，主表不变  \n更新：更新主表时自动更新从表值为NULL。更新从表，主表不变\n\n总结：CASCADE对主表操作 主表影响子表.  \nRESTRICT对主表操作 子表限制主表.  \nMysql中均无法更新子表.\n\n\n\n### 用户定义完整性\n列值非空（not null），列值唯一（unique），列值需要满足条件表达式（check）.\n- not null:列值不能为空，（列级完整性约束）\n- unique:列值唯一，（列级或表级约束）\n- check:列值应该满足的条件，（列级或表级约束）\n\n|a|b|\n|-|-|\n|属性|列级|\n|元组|表级|\n\n\n\n### 完整性约束命名子句\n完整性约束命名子句是用来给完整性约束命名，这样我们就可以通过该名称对完整性约束进行删除、增加操作。\n\n\n\n## 数据定义\n### 索引类型\n\n|类型|特点|\n|-|-|\n| 普通索引 | 是最基本的索引，它没有任何限制。 |\n| 唯一索引 | 索引列的值必须唯一，但允许有空值。 |\n| 主键索引 | 是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。 |\n| 组合索引 | 指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。 |\n| 全文索引 | 主要用来查找文本中的关键字，而不是直接与索引中的值相比较。fulltext索引配合match against操作使用，而不是一般的where语句加like。 |\n\n\n\n### 索引方法\n\n|类型|特点|\n|-|-|\n|BTREE|BTree索引是最常用的mysql数据库索引算法，因为它不仅可以被用在=,>,>=,<,<=和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量|\n|HASH|Hash索引只能用于对等比较，例如=,<=>（相当于=）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到页节点这样多次IO访问，所以检索效率远高于BTree索引。|\n\n\n\n## 数据查询\n\n### 连接查询\n\n1. 等值与非等值连接查询\n\n=为等值连接，连接字段必须为可比的。\n\n2. 自身连接\n\n自己对自己相连，比如要查询先修课的先修课，要对自己查询两次。\n\n3. 外连接\n\n`LEFT JOIN` 保存左侧所有元组，右侧不存在的用`NULL`补齐.(Mysql中`LEFT JOIN`与`LEFT OUTER JOIN`相同)\n\n4. 多表连接\n\n跨多个表进行连接查询。\n\n5. *交叉连接\n\n笛卡尔积。  \n`SELECT * FROM <TABLE1>, <TABLE2>`或`SELECT * FROM <TABLE1> CROSS JOIN <TABLE2>`\n\n6. *内连接\n\n**如果没有连接条件，INNER JOIN 和 CROSS JOIN 在语法上是等同的，两者可以互换。**\n\n`SELECT <字段名> FROM <表1> INNER JOIN <表2> [ON子句]`\n\n\n\n### 嵌套查询\n\n1. 不相关子查询\n\n子查询的查询条件不依赖于父查询。  \n有些嵌套查询可以使用连接运算替代，有些不可以。\n\n2. 相关子查询\n\n子查询的条件依赖于父查询。\n`SELECT Sno, Cno FROM SC x WHERE Grade >= (SELECT AVG(Grade) FROM SC y WHERE y.Sno = x.Sno)`\n\n3. 带有ANY(SOME)或ALL谓词的子查询\n\n子查询返回单值用比较运算符，返回多值时需要用ANY(SOME)或ALL谓词修饰符。且使用ANY或ALL时需要同时使用比较运算符。\n\n4. 带有EXISTS谓词的子查询\n\n子查询不返回任何数据，只产生逻辑真值`true`或`false`。\n\n**注意**：全称量词可以通过否运算转换成存在量词。\n**注意**：蕴含式可以转换为析取式。\n\n5. 集合查询\n\n并操作`UNION`,交操作`INTERSECT`,差操作`EXCEPT`.\n\n6. 派生表查询\n\n子查询出现在FROM子句中时，这是子查询生成临时的派生表。\n\n**注意**：必须为派生关系指定一个别名。\n\n","source":"_posts/notebook/sql.md","raw":"# 数据库笔记\n以下Mysql为例\n## 数据库完整性\n### 实体完整性\n实体完整性即主码，用`PRIMARY KEY`定义.\n\n- 列级约束：只能应用于一列上。\n- 表级约束：可以应用于表的多个列上。\n\n简而言之，如果完整性约束涉及到该表的多个属性列，必须定义在表级上，否则既可以定义在列级也可以定义在表级。\n\n\n\n### 参照完整性\n参照完整性即外码，用`FOREIGN KEY (列名) REFERENCES <表名>(列名)`定义.\n\n用constraint指定约束名，约束不指定名称时，系统会给定一个名称。\n\n**注意**：外码一定参照主码（可以是其他表的主码，也可以时自己的）,而且外码的列数一定要等于被参照表的主码列数。\n\n**违约处理**：对被参照表进行`update`/`delete`/`insert`操作时会破坏参照完整性时，参照表需要告诉被参照表听改怎么做。需要对参照表定义外码时添加`on delete`/`on update[<no action>/<cascade>]`\n\n- CASCADE:在父表（被参照表）上update/delete记录时，同步子表（参照表）的匹配记录。\n- SET NULL:在父表（被参照表）上update/delete记录时，将子表（参照表）上匹配的列设为null（子表的外键列不能为not null）。\n- NO ACTION:如果子表中有匹配的记录，不允许对父表进行操作。\n- RESTRICT:同NO ACTION，立即检查外键约束。\n\nNULL、RESTRICT、NO ACTION  \n删除：从表记录不存在时，主表才可以删除。删除从表，主表不变  \n更新：从表记录不存在时，主表才可以更新。更新从表，主表不变(无法更新从表)\n\nCASCADE  \n删除：删除主表时自动删除从表。删除从表，主表不变  \n更新：更新主表时自动更新从表。更新从表，主表不变(无法更新从表)\n\nSET NULL  \n删除：删除主表时自动更新从表值为NULL。删除从表，主表不变  \n更新：更新主表时自动更新从表值为NULL。更新从表，主表不变\n\n总结：CASCADE对主表操作 主表影响子表.  \nRESTRICT对主表操作 子表限制主表.  \nMysql中均无法更新子表.\n\n\n\n### 用户定义完整性\n列值非空（not null），列值唯一（unique），列值需要满足条件表达式（check）.\n- not null:列值不能为空，（列级完整性约束）\n- unique:列值唯一，（列级或表级约束）\n- check:列值应该满足的条件，（列级或表级约束）\n\n|a|b|\n|-|-|\n|属性|列级|\n|元组|表级|\n\n\n\n### 完整性约束命名子句\n完整性约束命名子句是用来给完整性约束命名，这样我们就可以通过该名称对完整性约束进行删除、增加操作。\n\n\n\n## 数据定义\n### 索引类型\n\n|类型|特点|\n|-|-|\n| 普通索引 | 是最基本的索引，它没有任何限制。 |\n| 唯一索引 | 索引列的值必须唯一，但允许有空值。 |\n| 主键索引 | 是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。 |\n| 组合索引 | 指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。 |\n| 全文索引 | 主要用来查找文本中的关键字，而不是直接与索引中的值相比较。fulltext索引配合match against操作使用，而不是一般的where语句加like。 |\n\n\n\n### 索引方法\n\n|类型|特点|\n|-|-|\n|BTREE|BTree索引是最常用的mysql数据库索引算法，因为它不仅可以被用在=,>,>=,<,<=和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量|\n|HASH|Hash索引只能用于对等比较，例如=,<=>（相当于=）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到页节点这样多次IO访问，所以检索效率远高于BTree索引。|\n\n\n\n## 数据查询\n\n### 连接查询\n\n1. 等值与非等值连接查询\n\n=为等值连接，连接字段必须为可比的。\n\n2. 自身连接\n\n自己对自己相连，比如要查询先修课的先修课，要对自己查询两次。\n\n3. 外连接\n\n`LEFT JOIN` 保存左侧所有元组，右侧不存在的用`NULL`补齐.(Mysql中`LEFT JOIN`与`LEFT OUTER JOIN`相同)\n\n4. 多表连接\n\n跨多个表进行连接查询。\n\n5. *交叉连接\n\n笛卡尔积。  \n`SELECT * FROM <TABLE1>, <TABLE2>`或`SELECT * FROM <TABLE1> CROSS JOIN <TABLE2>`\n\n6. *内连接\n\n**如果没有连接条件，INNER JOIN 和 CROSS JOIN 在语法上是等同的，两者可以互换。**\n\n`SELECT <字段名> FROM <表1> INNER JOIN <表2> [ON子句]`\n\n\n\n### 嵌套查询\n\n1. 不相关子查询\n\n子查询的查询条件不依赖于父查询。  \n有些嵌套查询可以使用连接运算替代，有些不可以。\n\n2. 相关子查询\n\n子查询的条件依赖于父查询。\n`SELECT Sno, Cno FROM SC x WHERE Grade >= (SELECT AVG(Grade) FROM SC y WHERE y.Sno = x.Sno)`\n\n3. 带有ANY(SOME)或ALL谓词的子查询\n\n子查询返回单值用比较运算符，返回多值时需要用ANY(SOME)或ALL谓词修饰符。且使用ANY或ALL时需要同时使用比较运算符。\n\n4. 带有EXISTS谓词的子查询\n\n子查询不返回任何数据，只产生逻辑真值`true`或`false`。\n\n**注意**：全称量词可以通过否运算转换成存在量词。\n**注意**：蕴含式可以转换为析取式。\n\n5. 集合查询\n\n并操作`UNION`,交操作`INTERSECT`,差操作`EXCEPT`.\n\n6. 派生表查询\n\n子查询出现在FROM子句中时，这是子查询生成临时的派生表。\n\n**注意**：必须为派生关系指定一个别名。\n\n","slug":"notebook/sql","published":1,"date":"2020-10-25T03:43:43.946Z","updated":"2020-10-26T14:05:45.038Z","title":"notebook/sql","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981g00ax018o7et719qb","content":"<h1 id=\"数据库笔记\"><a href=\"#数据库笔记\" class=\"headerlink\" title=\"数据库笔记\"></a>数据库笔记</h1><p>以下Mysql为例</p>\n<h2 id=\"数据库完整性\"><a href=\"#数据库完整性\" class=\"headerlink\" title=\"数据库完整性\"></a>数据库完整性</h2><h3 id=\"实体完整性\"><a href=\"#实体完整性\" class=\"headerlink\" title=\"实体完整性\"></a>实体完整性</h3><p>实体完整性即主码，用<code>PRIMARY KEY</code>定义.</p>\n<ul>\n<li>列级约束：只能应用于一列上。</li>\n<li>表级约束：可以应用于表的多个列上。</li>\n</ul>\n<p>简而言之，如果完整性约束涉及到该表的多个属性列，必须定义在表级上，否则既可以定义在列级也可以定义在表级。</p>\n<h3 id=\"参照完整性\"><a href=\"#参照完整性\" class=\"headerlink\" title=\"参照完整性\"></a>参照完整性</h3><p>参照完整性即外码，用<code>FOREIGN KEY (列名) REFERENCES &lt;表名&gt;(列名)</code>定义.</p>\n<p>用constraint指定约束名，约束不指定名称时，系统会给定一个名称。</p>\n<p><strong>注意</strong>：外码一定参照主码（可以是其他表的主码，也可以时自己的）,而且外码的列数一定要等于被参照表的主码列数。</p>\n<p><strong>违约处理</strong>：对被参照表进行<code>update</code>/<code>delete</code>/<code>insert</code>操作时会破坏参照完整性时，参照表需要告诉被参照表听改怎么做。需要对参照表定义外码时添加<code>on delete</code>/<code>on update[&lt;no action&gt;/&lt;cascade&gt;]</code></p>\n<ul>\n<li>CASCADE:在父表（被参照表）上update/delete记录时，同步子表（参照表）的匹配记录。</li>\n<li>SET NULL:在父表（被参照表）上update/delete记录时，将子表（参照表）上匹配的列设为null（子表的外键列不能为not null）。</li>\n<li>NO ACTION:如果子表中有匹配的记录，不允许对父表进行操作。</li>\n<li>RESTRICT:同NO ACTION，立即检查外键约束。</li>\n</ul>\n<p>NULL、RESTRICT、NO ACTION<br>删除：从表记录不存在时，主表才可以删除。删除从表，主表不变<br>更新：从表记录不存在时，主表才可以更新。更新从表，主表不变(无法更新从表)</p>\n<p>CASCADE<br>删除：删除主表时自动删除从表。删除从表，主表不变<br>更新：更新主表时自动更新从表。更新从表，主表不变(无法更新从表)</p>\n<p>SET NULL<br>删除：删除主表时自动更新从表值为NULL。删除从表，主表不变<br>更新：更新主表时自动更新从表值为NULL。更新从表，主表不变</p>\n<p>总结：CASCADE对主表操作 主表影响子表.<br>RESTRICT对主表操作 子表限制主表.<br>Mysql中均无法更新子表.</p>\n<h3 id=\"用户定义完整性\"><a href=\"#用户定义完整性\" class=\"headerlink\" title=\"用户定义完整性\"></a>用户定义完整性</h3><p>列值非空（not null），列值唯一（unique），列值需要满足条件表达式（check）.</p>\n<ul>\n<li>not null:列值不能为空，（列级完整性约束）</li>\n<li>unique:列值唯一，（列级或表级约束）</li>\n<li>check:列值应该满足的条件，（列级或表级约束）</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>a</th>\n<th>b</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>属性</td>\n<td>列级</td>\n</tr>\n<tr>\n<td>元组</td>\n<td>表级</td>\n</tr>\n</tbody></table>\n<h3 id=\"完整性约束命名子句\"><a href=\"#完整性约束命名子句\" class=\"headerlink\" title=\"完整性约束命名子句\"></a>完整性约束命名子句</h3><p>完整性约束命名子句是用来给完整性约束命名，这样我们就可以通过该名称对完整性约束进行删除、增加操作。</p>\n<h2 id=\"数据定义\"><a href=\"#数据定义\" class=\"headerlink\" title=\"数据定义\"></a>数据定义</h2><h3 id=\"索引类型\"><a href=\"#索引类型\" class=\"headerlink\" title=\"索引类型\"></a>索引类型</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>普通索引</td>\n<td>是最基本的索引，它没有任何限制。</td>\n</tr>\n<tr>\n<td>唯一索引</td>\n<td>索引列的值必须唯一，但允许有空值。</td>\n</tr>\n<tr>\n<td>主键索引</td>\n<td>是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。</td>\n</tr>\n<tr>\n<td>组合索引</td>\n<td>指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。</td>\n</tr>\n<tr>\n<td>全文索引</td>\n<td>主要用来查找文本中的关键字，而不是直接与索引中的值相比较。fulltext索引配合match against操作使用，而不是一般的where语句加like。</td>\n</tr>\n</tbody></table>\n<h3 id=\"索引方法\"><a href=\"#索引方法\" class=\"headerlink\" title=\"索引方法\"></a>索引方法</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>BTREE</td>\n<td>BTree索引是最常用的mysql数据库索引算法，因为它不仅可以被用在=,&gt;,&gt;=,&lt;,&lt;=和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量</td>\n</tr>\n<tr>\n<td>HASH</td>\n<td>Hash索引只能用于对等比较，例如=,&lt;=&gt;（相当于=）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到页节点这样多次IO访问，所以检索效率远高于BTree索引。</td>\n</tr>\n</tbody></table>\n<h2 id=\"数据查询\"><a href=\"#数据查询\" class=\"headerlink\" title=\"数据查询\"></a>数据查询</h2><h3 id=\"连接查询\"><a href=\"#连接查询\" class=\"headerlink\" title=\"连接查询\"></a>连接查询</h3><ol>\n<li>等值与非等值连接查询</li>\n</ol>\n<p>=为等值连接，连接字段必须为可比的。</p>\n<ol start=\"2\">\n<li>自身连接</li>\n</ol>\n<p>自己对自己相连，比如要查询先修课的先修课，要对自己查询两次。</p>\n<ol start=\"3\">\n<li>外连接</li>\n</ol>\n<p><code>LEFT JOIN</code> 保存左侧所有元组，右侧不存在的用<code>NULL</code>补齐.(Mysql中<code>LEFT JOIN</code>与<code>LEFT OUTER JOIN</code>相同)</p>\n<ol start=\"4\">\n<li>多表连接</li>\n</ol>\n<p>跨多个表进行连接查询。</p>\n<ol start=\"5\">\n<li>*交叉连接</li>\n</ol>\n<p>笛卡尔积。<br><code>SELECT * FROM &lt;TABLE1&gt;, &lt;TABLE2&gt;</code>或<code>SELECT * FROM &lt;TABLE1&gt; CROSS JOIN &lt;TABLE2&gt;</code></p>\n<ol start=\"6\">\n<li>*内连接</li>\n</ol>\n<p><strong>如果没有连接条件，INNER JOIN 和 CROSS JOIN 在语法上是等同的，两者可以互换。</strong></p>\n<p><code>SELECT &lt;字段名&gt; FROM &lt;表1&gt; INNER JOIN &lt;表2&gt; [ON子句]</code></p>\n<h3 id=\"嵌套查询\"><a href=\"#嵌套查询\" class=\"headerlink\" title=\"嵌套查询\"></a>嵌套查询</h3><ol>\n<li>不相关子查询</li>\n</ol>\n<p>子查询的查询条件不依赖于父查询。<br>有些嵌套查询可以使用连接运算替代，有些不可以。</p>\n<ol start=\"2\">\n<li>相关子查询</li>\n</ol>\n<p>子查询的条件依赖于父查询。<br><code>SELECT Sno, Cno FROM SC x WHERE Grade &gt;= (SELECT AVG(Grade) FROM SC y WHERE y.Sno = x.Sno)</code></p>\n<ol start=\"3\">\n<li>带有ANY(SOME)或ALL谓词的子查询</li>\n</ol>\n<p>子查询返回单值用比较运算符，返回多值时需要用ANY(SOME)或ALL谓词修饰符。且使用ANY或ALL时需要同时使用比较运算符。</p>\n<ol start=\"4\">\n<li>带有EXISTS谓词的子查询</li>\n</ol>\n<p>子查询不返回任何数据，只产生逻辑真值<code>true</code>或<code>false</code>。</p>\n<p><strong>注意</strong>：全称量词可以通过否运算转换成存在量词。<br><strong>注意</strong>：蕴含式可以转换为析取式。</p>\n<ol start=\"5\">\n<li>集合查询</li>\n</ol>\n<p>并操作<code>UNION</code>,交操作<code>INTERSECT</code>,差操作<code>EXCEPT</code>.</p>\n<ol start=\"6\">\n<li>派生表查询</li>\n</ol>\n<p>子查询出现在FROM子句中时，这是子查询生成临时的派生表。</p>\n<p><strong>注意</strong>：必须为派生关系指定一个别名。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"数据库笔记\"><a href=\"#数据库笔记\" class=\"headerlink\" title=\"数据库笔记\"></a>数据库笔记</h1><p>以下Mysql为例</p>\n<h2 id=\"数据库完整性\"><a href=\"#数据库完整性\" class=\"headerlink\" title=\"数据库完整性\"></a>数据库完整性</h2><h3 id=\"实体完整性\"><a href=\"#实体完整性\" class=\"headerlink\" title=\"实体完整性\"></a>实体完整性</h3><p>实体完整性即主码，用<code>PRIMARY KEY</code>定义.</p>\n<ul>\n<li>列级约束：只能应用于一列上。</li>\n<li>表级约束：可以应用于表的多个列上。</li>\n</ul>\n<p>简而言之，如果完整性约束涉及到该表的多个属性列，必须定义在表级上，否则既可以定义在列级也可以定义在表级。</p>\n<h3 id=\"参照完整性\"><a href=\"#参照完整性\" class=\"headerlink\" title=\"参照完整性\"></a>参照完整性</h3><p>参照完整性即外码，用<code>FOREIGN KEY (列名) REFERENCES &lt;表名&gt;(列名)</code>定义.</p>\n<p>用constraint指定约束名，约束不指定名称时，系统会给定一个名称。</p>\n<p><strong>注意</strong>：外码一定参照主码（可以是其他表的主码，也可以时自己的）,而且外码的列数一定要等于被参照表的主码列数。</p>\n<p><strong>违约处理</strong>：对被参照表进行<code>update</code>/<code>delete</code>/<code>insert</code>操作时会破坏参照完整性时，参照表需要告诉被参照表听改怎么做。需要对参照表定义外码时添加<code>on delete</code>/<code>on update[&lt;no action&gt;/&lt;cascade&gt;]</code></p>\n<ul>\n<li>CASCADE:在父表（被参照表）上update/delete记录时，同步子表（参照表）的匹配记录。</li>\n<li>SET NULL:在父表（被参照表）上update/delete记录时，将子表（参照表）上匹配的列设为null（子表的外键列不能为not null）。</li>\n<li>NO ACTION:如果子表中有匹配的记录，不允许对父表进行操作。</li>\n<li>RESTRICT:同NO ACTION，立即检查外键约束。</li>\n</ul>\n<p>NULL、RESTRICT、NO ACTION<br>删除：从表记录不存在时，主表才可以删除。删除从表，主表不变<br>更新：从表记录不存在时，主表才可以更新。更新从表，主表不变(无法更新从表)</p>\n<p>CASCADE<br>删除：删除主表时自动删除从表。删除从表，主表不变<br>更新：更新主表时自动更新从表。更新从表，主表不变(无法更新从表)</p>\n<p>SET NULL<br>删除：删除主表时自动更新从表值为NULL。删除从表，主表不变<br>更新：更新主表时自动更新从表值为NULL。更新从表，主表不变</p>\n<p>总结：CASCADE对主表操作 主表影响子表.<br>RESTRICT对主表操作 子表限制主表.<br>Mysql中均无法更新子表.</p>\n<h3 id=\"用户定义完整性\"><a href=\"#用户定义完整性\" class=\"headerlink\" title=\"用户定义完整性\"></a>用户定义完整性</h3><p>列值非空（not null），列值唯一（unique），列值需要满足条件表达式（check）.</p>\n<ul>\n<li>not null:列值不能为空，（列级完整性约束）</li>\n<li>unique:列值唯一，（列级或表级约束）</li>\n<li>check:列值应该满足的条件，（列级或表级约束）</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>a</th>\n<th>b</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>属性</td>\n<td>列级</td>\n</tr>\n<tr>\n<td>元组</td>\n<td>表级</td>\n</tr>\n</tbody></table>\n<h3 id=\"完整性约束命名子句\"><a href=\"#完整性约束命名子句\" class=\"headerlink\" title=\"完整性约束命名子句\"></a>完整性约束命名子句</h3><p>完整性约束命名子句是用来给完整性约束命名，这样我们就可以通过该名称对完整性约束进行删除、增加操作。</p>\n<h2 id=\"数据定义\"><a href=\"#数据定义\" class=\"headerlink\" title=\"数据定义\"></a>数据定义</h2><h3 id=\"索引类型\"><a href=\"#索引类型\" class=\"headerlink\" title=\"索引类型\"></a>索引类型</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>普通索引</td>\n<td>是最基本的索引，它没有任何限制。</td>\n</tr>\n<tr>\n<td>唯一索引</td>\n<td>索引列的值必须唯一，但允许有空值。</td>\n</tr>\n<tr>\n<td>主键索引</td>\n<td>是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。</td>\n</tr>\n<tr>\n<td>组合索引</td>\n<td>指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。</td>\n</tr>\n<tr>\n<td>全文索引</td>\n<td>主要用来查找文本中的关键字，而不是直接与索引中的值相比较。fulltext索引配合match against操作使用，而不是一般的where语句加like。</td>\n</tr>\n</tbody></table>\n<h3 id=\"索引方法\"><a href=\"#索引方法\" class=\"headerlink\" title=\"索引方法\"></a>索引方法</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>BTREE</td>\n<td>BTree索引是最常用的mysql数据库索引算法，因为它不仅可以被用在=,&gt;,&gt;=,&lt;,&lt;=和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量</td>\n</tr>\n<tr>\n<td>HASH</td>\n<td>Hash索引只能用于对等比较，例如=,&lt;=&gt;（相当于=）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到页节点这样多次IO访问，所以检索效率远高于BTree索引。</td>\n</tr>\n</tbody></table>\n<h2 id=\"数据查询\"><a href=\"#数据查询\" class=\"headerlink\" title=\"数据查询\"></a>数据查询</h2><h3 id=\"连接查询\"><a href=\"#连接查询\" class=\"headerlink\" title=\"连接查询\"></a>连接查询</h3><ol>\n<li>等值与非等值连接查询</li>\n</ol>\n<p>=为等值连接，连接字段必须为可比的。</p>\n<ol start=\"2\">\n<li>自身连接</li>\n</ol>\n<p>自己对自己相连，比如要查询先修课的先修课，要对自己查询两次。</p>\n<ol start=\"3\">\n<li>外连接</li>\n</ol>\n<p><code>LEFT JOIN</code> 保存左侧所有元组，右侧不存在的用<code>NULL</code>补齐.(Mysql中<code>LEFT JOIN</code>与<code>LEFT OUTER JOIN</code>相同)</p>\n<ol start=\"4\">\n<li>多表连接</li>\n</ol>\n<p>跨多个表进行连接查询。</p>\n<ol start=\"5\">\n<li>*交叉连接</li>\n</ol>\n<p>笛卡尔积。<br><code>SELECT * FROM &lt;TABLE1&gt;, &lt;TABLE2&gt;</code>或<code>SELECT * FROM &lt;TABLE1&gt; CROSS JOIN &lt;TABLE2&gt;</code></p>\n<ol start=\"6\">\n<li>*内连接</li>\n</ol>\n<p><strong>如果没有连接条件，INNER JOIN 和 CROSS JOIN 在语法上是等同的，两者可以互换。</strong></p>\n<p><code>SELECT &lt;字段名&gt; FROM &lt;表1&gt; INNER JOIN &lt;表2&gt; [ON子句]</code></p>\n<h3 id=\"嵌套查询\"><a href=\"#嵌套查询\" class=\"headerlink\" title=\"嵌套查询\"></a>嵌套查询</h3><ol>\n<li>不相关子查询</li>\n</ol>\n<p>子查询的查询条件不依赖于父查询。<br>有些嵌套查询可以使用连接运算替代，有些不可以。</p>\n<ol start=\"2\">\n<li>相关子查询</li>\n</ol>\n<p>子查询的条件依赖于父查询。<br><code>SELECT Sno, Cno FROM SC x WHERE Grade &gt;= (SELECT AVG(Grade) FROM SC y WHERE y.Sno = x.Sno)</code></p>\n<ol start=\"3\">\n<li>带有ANY(SOME)或ALL谓词的子查询</li>\n</ol>\n<p>子查询返回单值用比较运算符，返回多值时需要用ANY(SOME)或ALL谓词修饰符。且使用ANY或ALL时需要同时使用比较运算符。</p>\n<ol start=\"4\">\n<li>带有EXISTS谓词的子查询</li>\n</ol>\n<p>子查询不返回任何数据，只产生逻辑真值<code>true</code>或<code>false</code>。</p>\n<p><strong>注意</strong>：全称量词可以通过否运算转换成存在量词。<br><strong>注意</strong>：蕴含式可以转换为析取式。</p>\n<ol start=\"5\">\n<li>集合查询</li>\n</ol>\n<p>并操作<code>UNION</code>,交操作<code>INTERSECT</code>,差操作<code>EXCEPT</code>.</p>\n<ol start=\"6\">\n<li>派生表查询</li>\n</ol>\n<p>子查询出现在FROM子句中时，这是子查询生成临时的派生表。</p>\n<p><strong>注意</strong>：必须为派生关系指定一个别名。</p>\n"},{"title":"websocket入门","catagories":["Notebook"],"_content":"\n# \n\n","source":"_posts/notebook/websocket-start.md","raw":"---\ntitle: websocket入门\ncatagories: \n- Notebook\ntags: \n- websocket\n---\n\n# \n\n","slug":"notebook/websocket-start","published":1,"date":"2021-01-22T07:26:15.031Z","updated":"2021-01-22T10:03:39.073Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981g00az018o1cva16c3","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"VPN协议比较","catagories":["Notebook"],"_content":"\n# PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2\n\n\n\n----\n\nReference\n\nhttps://zh.vpnmentor.com/blog/%E6%AF%94%E8%BE%83vpn%E5%8D%8F%E8%AE%AE-pptp-%E5%AF%B9-l2tp-%E5%AF%B9-openvpn-%E5%AF%B9sstp-%E5%AF%B9-ikev2/","source":"_posts/notebook/vpn.md","raw":"---\ntitle: VPN协议比较\ncatagories:\n- Notebook\ntags:\n- vpn\n---\n\n# PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2\n\n\n\n----\n\nReference\n\nhttps://zh.vpnmentor.com/blog/%E6%AF%94%E8%BE%83vpn%E5%8D%8F%E8%AE%AE-pptp-%E5%AF%B9-l2tp-%E5%AF%B9-openvpn-%E5%AF%B9sstp-%E5%AF%B9-ikev2/","slug":"notebook/vpn","published":1,"date":"2021-02-26T13:11:47.218Z","updated":"2021-02-26T13:12:50.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981h00b1018o22bj24jv","content":"<h1 id=\"PPTP-对-L2TP-对-OpenVPN-对SSTP-对-IKEv2\"><a href=\"#PPTP-对-L2TP-对-OpenVPN-对SSTP-对-IKEv2\" class=\"headerlink\" title=\"PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2\"></a>PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2</h1><hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC52cG5tZW50b3IuY29tL2Jsb2cvJUU2JUFGJTk0JUU4JUJFJTgzdnBuJUU1JThEJThGJUU4JUFFJUFFLXBwdHAtJUU1JUFGJUI5LWwydHAtJUU1JUFGJUI5LW9wZW52cG4tJUU1JUFGJUI5c3N0cC0lRTUlQUYlQjktaWtldjIv\">https://zh.vpnmentor.com/blog/%E6%AF%94%E8%BE%83vpn%E5%8D%8F%E8%AE%AE-pptp-%E5%AF%B9-l2tp-%E5%AF%B9-openvpn-%E5%AF%B9sstp-%E5%AF%B9-ikev2/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"PPTP-对-L2TP-对-OpenVPN-对SSTP-对-IKEv2\"><a href=\"#PPTP-对-L2TP-对-OpenVPN-对SSTP-对-IKEv2\" class=\"headerlink\" title=\"PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2\"></a>PPTP 对 L2TP 对 OpenVPN 对SSTP 对 IKEv2</h1><hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC52cG5tZW50b3IuY29tL2Jsb2cvJUU2JUFGJTk0JUU4JUJFJTgzdnBuJUU1JThEJThGJUU4JUFFJUFFLXBwdHAtJUU1JUFGJUI5LWwydHAtJUU1JUFGJUI5LW9wZW52cG4tJUU1JUFGJUI5c3N0cC0lRTUlQUYlQjktaWtldjIv\">https://zh.vpnmentor.com/blog/%E6%AF%94%E8%BE%83vpn%E5%8D%8F%E8%AE%AE-pptp-%E5%AF%B9-l2tp-%E5%AF%B9-openvpn-%E5%AF%B9sstp-%E5%AF%B9-ikev2/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Contents in reserch paper","_content":"\n# Content\n\n- Abstract\n- Introduction\n- Methods\n- Results and Discussion\n- Conclusion\n- References\n\n\n\nThis is a general outline for **conference paper**. There's a little bit differences in **journal paper** the structure of which is specified by the publisher.\n\n","source":"_posts/paper/paper-content.md","raw":"---\ntitle: Contents in reserch paper\ncategories:\n- Paper\n---\n\n# Content\n\n- Abstract\n- Introduction\n- Methods\n- Results and Discussion\n- Conclusion\n- References\n\n\n\nThis is a general outline for **conference paper**. There's a little bit differences in **journal paper** the structure of which is specified by the publisher.\n\n","slug":"paper/paper-content","published":1,"date":"2021-08-26T16:39:24.729Z","updated":"2021-08-26T16:44:11.734Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981i00b4018o6ze31eih","content":"<h1 id=\"Content\"><a href=\"#Content\" class=\"headerlink\" title=\"Content\"></a>Content</h1><ul>\n<li>Abstract</li>\n<li>Introduction</li>\n<li>Methods</li>\n<li>Results and Discussion</li>\n<li>Conclusion</li>\n<li>References</li>\n</ul>\n<p>This is a general outline for <strong>conference paper</strong>. There’s a little bit differences in <strong>journal paper</strong> the structure of which is specified by the publisher.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Content\"><a href=\"#Content\" class=\"headerlink\" title=\"Content\"></a>Content</h1><ul>\n<li>Abstract</li>\n<li>Introduction</li>\n<li>Methods</li>\n<li>Results and Discussion</li>\n<li>Conclusion</li>\n<li>References</li>\n</ul>\n<p>This is a general outline for <strong>conference paper</strong>. There’s a little bit differences in <strong>journal paper</strong> the structure of which is specified by the publisher.</p>\n"},{"title":"Zotero 文献管理","tages":["paper management"],"_content":"\n# 开始\n\n使用Zotero做个人文献管理，多平台实时同步。\n\nMac(Zotero) + iPad(PaperShip)\n\n# 使用\n\n## 新建\n\nZotero可以创建Group与Collection\n\nGroup相当于创建一个空间，个人空间或团队协作空间等。\n\nCollection相当于在空间下创建文件夹，及subcollection分级管理文献。\n\n## 下载\n\n下载Chrome插件可以实现直接在网页下载PDF+snapshot\n\n## 删除\n\nremove item from collection\n\n仅将项目从当前文件夹删除，其他文件夹的文件**不受影响**。\n\nmove item to trash\n\n将项目移动到回收站，所有subcollection中含有该项目的**一同删除**。\n\n\n\n\n\n\n\n----\n\nhttps://www.zhihu.com/question/288186107/answer/1327966061\n\n","source":"_posts/notebook/zotero.md","raw":"---\ntitle: Zotero 文献管理\ncategories: Notebook\ntages:\n- paper management\n---\n\n# 开始\n\n使用Zotero做个人文献管理，多平台实时同步。\n\nMac(Zotero) + iPad(PaperShip)\n\n# 使用\n\n## 新建\n\nZotero可以创建Group与Collection\n\nGroup相当于创建一个空间，个人空间或团队协作空间等。\n\nCollection相当于在空间下创建文件夹，及subcollection分级管理文献。\n\n## 下载\n\n下载Chrome插件可以实现直接在网页下载PDF+snapshot\n\n## 删除\n\nremove item from collection\n\n仅将项目从当前文件夹删除，其他文件夹的文件**不受影响**。\n\nmove item to trash\n\n将项目移动到回收站，所有subcollection中含有该项目的**一同删除**。\n\n\n\n\n\n\n\n----\n\nhttps://www.zhihu.com/question/288186107/answer/1327966061\n\n","slug":"notebook/zotero","published":1,"date":"2021-05-22T09:22:56.950Z","updated":"2021-05-22T09:36:10.604Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981j00b6018o2zuu9k71","content":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>使用Zotero做个人文献管理，多平台实时同步。</p>\n<p>Mac(Zotero) + iPad(PaperShip)</p>\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><h2 id=\"新建\"><a href=\"#新建\" class=\"headerlink\" title=\"新建\"></a>新建</h2><p>Zotero可以创建Group与Collection</p>\n<p>Group相当于创建一个空间，个人空间或团队协作空间等。</p>\n<p>Collection相当于在空间下创建文件夹，及subcollection分级管理文献。</p>\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><p>下载Chrome插件可以实现直接在网页下载PDF+snapshot</p>\n<h2 id=\"删除\"><a href=\"#删除\" class=\"headerlink\" title=\"删除\"></a>删除</h2><p>remove item from collection</p>\n<p>仅将项目从当前文件夹删除，其他文件夹的文件<strong>不受影响</strong>。</p>\n<p>move item to trash</p>\n<p>将项目移动到回收站，所有subcollection中含有该项目的<strong>一同删除</strong>。</p>\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4ODE4NjEwNy9hbnN3ZXIvMTMyNzk2NjA2MQ==\">https://www.zhihu.com/question/288186107/answer/1327966061<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h1><p>使用Zotero做个人文献管理，多平台实时同步。</p>\n<p>Mac(Zotero) + iPad(PaperShip)</p>\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><h2 id=\"新建\"><a href=\"#新建\" class=\"headerlink\" title=\"新建\"></a>新建</h2><p>Zotero可以创建Group与Collection</p>\n<p>Group相当于创建一个空间，个人空间或团队协作空间等。</p>\n<p>Collection相当于在空间下创建文件夹，及subcollection分级管理文献。</p>\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><p>下载Chrome插件可以实现直接在网页下载PDF+snapshot</p>\n<h2 id=\"删除\"><a href=\"#删除\" class=\"headerlink\" title=\"删除\"></a>删除</h2><p>remove item from collection</p>\n<p>仅将项目从当前文件夹删除，其他文件夹的文件<strong>不受影响</strong>。</p>\n<p>move item to trash</p>\n<p>将项目移动到回收站，所有subcollection中含有该项目的<strong>一同删除</strong>。</p>\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4ODE4NjEwNy9hbnN3ZXIvMTMyNzk2NjA2MQ==\">https://www.zhihu.com/question/288186107/answer/1327966061<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Batch Size","_content":"\n# 对Batch_size与lr的认识\n\n## 大Batch(Batch -> Full)：\n\n好处：\n\n- 更好的代表样本总体，更准确指向极值。\n- 不同权重梯度差别大，学习率不统一。\n\n坏处：\n\n- 内存局限，无法一次性载入全部样本。\n- 每个Batch，由于**采样性差异**，梯度修正值**相互抵消**。\n\n## 小Batch(Batch -> 1)：\n\n好处：\n\n- 可以在一个epoch上迭代很多次，参数更新多次。\n\n坏处：\n\n- 每次修正都向各自样本的梯度方向修正，**难收敛**。","source":"_posts/paper_exp/batch.md","raw":"---\ntitle: Batch Size\ncategories:\n- Paper\ntags:\n- batch_size\n---\n\n# 对Batch_size与lr的认识\n\n## 大Batch(Batch -> Full)：\n\n好处：\n\n- 更好的代表样本总体，更准确指向极值。\n- 不同权重梯度差别大，学习率不统一。\n\n坏处：\n\n- 内存局限，无法一次性载入全部样本。\n- 每个Batch，由于**采样性差异**，梯度修正值**相互抵消**。\n\n## 小Batch(Batch -> 1)：\n\n好处：\n\n- 可以在一个epoch上迭代很多次，参数更新多次。\n\n坏处：\n\n- 每次修正都向各自样本的梯度方向修正，**难收敛**。","slug":"paper_exp/batch","published":1,"date":"2021-02-08T18:19:12.507Z","updated":"2021-02-08T18:23:09.629Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981j00b9018oaniffzks","content":"<h1 id=\"对Batch-size与lr的认识\"><a href=\"#对Batch-size与lr的认识\" class=\"headerlink\" title=\"对Batch_size与lr的认识\"></a>对Batch_size与lr的认识</h1><h2 id=\"大Batch-Batch-gt-Full-：\"><a href=\"#大Batch-Batch-gt-Full-：\" class=\"headerlink\" title=\"大Batch(Batch -&gt; Full)：\"></a>大Batch(Batch -&gt; Full)：</h2><p>好处：</p>\n<ul>\n<li>更好的代表样本总体，更准确指向极值。</li>\n<li>不同权重梯度差别大，学习率不统一。</li>\n</ul>\n<p>坏处：</p>\n<ul>\n<li>内存局限，无法一次性载入全部样本。</li>\n<li>每个Batch，由于<strong>采样性差异</strong>，梯度修正值<strong>相互抵消</strong>。</li>\n</ul>\n<h2 id=\"小Batch-Batch-gt-1-：\"><a href=\"#小Batch-Batch-gt-1-：\" class=\"headerlink\" title=\"小Batch(Batch -&gt; 1)：\"></a>小Batch(Batch -&gt; 1)：</h2><p>好处：</p>\n<ul>\n<li>可以在一个epoch上迭代很多次，参数更新多次。</li>\n</ul>\n<p>坏处：</p>\n<ul>\n<li>每次修正都向各自样本的梯度方向修正，<strong>难收敛</strong>。</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"对Batch-size与lr的认识\"><a href=\"#对Batch-size与lr的认识\" class=\"headerlink\" title=\"对Batch_size与lr的认识\"></a>对Batch_size与lr的认识</h1><h2 id=\"大Batch-Batch-gt-Full-：\"><a href=\"#大Batch-Batch-gt-Full-：\" class=\"headerlink\" title=\"大Batch(Batch -&gt; Full)：\"></a>大Batch(Batch -&gt; Full)：</h2><p>好处：</p>\n<ul>\n<li>更好的代表样本总体，更准确指向极值。</li>\n<li>不同权重梯度差别大，学习率不统一。</li>\n</ul>\n<p>坏处：</p>\n<ul>\n<li>内存局限，无法一次性载入全部样本。</li>\n<li>每个Batch，由于<strong>采样性差异</strong>，梯度修正值<strong>相互抵消</strong>。</li>\n</ul>\n<h2 id=\"小Batch-Batch-gt-1-：\"><a href=\"#小Batch-Batch-gt-1-：\" class=\"headerlink\" title=\"小Batch(Batch -&gt; 1)：\"></a>小Batch(Batch -&gt; 1)：</h2><p>好处：</p>\n<ul>\n<li>可以在一个epoch上迭代很多次，参数更新多次。</li>\n</ul>\n<p>坏处：</p>\n<ul>\n<li>每次修正都向各自样本的梯度方向修正，<strong>难收敛</strong>。</li>\n</ul>\n"},{"_content":"# 波士顿房价预测\n\n```python\nimport numpy as np\nimport json\nimport matplotlib.pyplot as plt\n\n\ndef load_data():\n    datafile = './data/housing.data'\n    data = np.fromfile(datafile, sep=' ')\n\n    feature_names = ['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS',\n                     'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'MEDV']\n    feature_num = len(feature_names)\n    data = data.reshape([data.shape[0] // feature_num, feature_num])\n\n    ratio = 0.8\n    offset = int(data.shape[0] * ratio)\n    training_data = data[:offset]\n\n    maximums, minimums, avgs = training_data.max(axis=0), training_data.min(axis=0), training_data.sum(axis=0) / \\\n                               training_data.shape[0]\n    for i in range(feature_num):\n        data[:, i] = (data[:, i] - avgs[i]) / (maximums[i] - minimums[i])\n\n    training_data = data[:offset]\n    test_data = data[offset:]\n\n    return training_data, test_data\n\n\nclass Network(object):\n    def __init__(self, num_of_weights):\n        # 随机产生w的初始值\n        # 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子\n        np.random.seed(0)\n        self.w = np.random.randn(num_of_weights, 1)\n        self.b = 0.\n\n    def forward(self, x):\n        z = np.dot(x, self.w) + self.b\n        return z\n\n    def loss(self, z, y):\n        error = z - y\n        cost = error * error\n        cost = np.mean(cost)\n        return cost\n\n    def gradient(self, x, y):\n        z = self.forward(x)\n        gradient_w = (z - y) * x\n        gradient_w = np.mean(gradient_w, axis=0)\n        gradient_w = gradient_w[:, np.newaxis]\n        gradient_b = (z - y)\n        gradient_b = np.mean(gradient_b)\n\n        return gradient_w, gradient_b\n\n    def update(self, gradient_w, gradient_b, eta=0.01):\n        self.w = self.w - eta * gradient_w\n        self.b = self.b - eta * gradient_b\n\n    def train(self, x, y, iterations=100, eta=0.01):\n        losses = []\n        for i in range(iterations):\n            z = self.forward(x)\n            L = self.loss(z, y)\n            gradient_w, gradient_b = self.gradient(x, y)\n            self.update(gradient_w, gradient_b, eta)\n            losses.append(L)\n            if (i + 1) % 10 == 0:\n                print('iter {}, loss {}'.format(i, L))\n        return losses\n\n\n\n# 获取数据\ntrain_data, test_data = load_data()\nx = train_data[:, :-1]\ny = train_data[:, -1:]\n# 创建网络\nnet = Network(13)\nnum_iterations=1000\n# 启动训练\nlosses = net.train(x,y, iterations=num_iterations, eta=0.01)\n\n# 画出损失函数的变化趋势\nplot_x = np.arange(num_iterations)\nplot_y = np.array(losses)\nplt.plot(plot_x, plot_y)\nplt.show()\n\n\nclass NetworkOfSGD(object):\n    def __init__(self, num_of_weights):\n        # 随机产生w的初始值\n        # 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子\n        # np.random.seed(0)\n        self.w = np.random.randn(num_of_weights, 1)\n        self.b = 0.\n\n    def forward(self, x):\n        z = np.dot(x, self.w) + self.b\n        return z\n\n    def loss(self, z, y):\n        error = z - y\n        num_samples = error.shape[0]\n        cost = error * error\n        cost = np.sum(cost) / num_samples\n        return cost\n\n    def gradient(self, x, y):\n        z = self.forward(x)\n        N = x.shape[0]\n        gradient_w = 1. / N * np.sum((z - y) * x, axis=0)\n        gradient_w = gradient_w[:, np.newaxis]\n        gradient_b = 1. / N * np.sum(z - y)\n        return gradient_w, gradient_b\n\n    def update(self, gradient_w, gradient_b, eta=0.01):\n        self.w = self.w - eta * gradient_w\n        self.b = self.b - eta * gradient_b\n\n    def train(self, training_data, num_epoches, batch_size=10, eta=0.01):\n        n = len(training_data)\n        losses = []\n        for epoch_id in range(num_epoches):\n            # 在每轮迭代开始之前，将训练数据的顺序随机的打乱，\n            # 然后再按每次取batch_size条数据的方式取出\n            np.random.shuffle(training_data)\n            # 将训练数据进行拆分，每个mini_batch包含batch_size条的数据\n            mini_batches = [training_data[k:k + batch_size] for k in range(0, n, batch_size)]\n            for iter_id, mini_batch in enumerate(mini_batches):\n                # print(self.w.shape)\n                # print(self.b)\n                x = mini_batch[:, :-1]\n                y = mini_batch[:, -1:]\n                a = self.forward(x)\n                loss = self.loss(a, y)\n                gradient_w, gradient_b = self.gradient(x, y)\n                self.update(gradient_w, gradient_b, eta)\n                losses.append(loss)\n                print('Epoch {:3d} / iter {:3d}, loss = {:.4f}'.\n                      format(epoch_id, iter_id, loss))\n\n        return losses\n\n\n# 获取数据\ntrain_data, test_data = load_data()\n\n# 创建网络\nnet = NetworkOfSGD(13)\n# 启动训练\nlosses = net.train(train_data, num_epoches=50, batch_size=100, eta=0.1)\n\n# 画出损失函数的变化趋势\nplot_x = np.arange(len(losses))\nplot_y = np.array(losses)\nplt.plot(plot_x, plot_y)\nplt.show()\n```","source":"_posts/ml/lesson1.md","raw":"# 波士顿房价预测\n\n```python\nimport numpy as np\nimport json\nimport matplotlib.pyplot as plt\n\n\ndef load_data():\n    datafile = './data/housing.data'\n    data = np.fromfile(datafile, sep=' ')\n\n    feature_names = ['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS',\n                     'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'MEDV']\n    feature_num = len(feature_names)\n    data = data.reshape([data.shape[0] // feature_num, feature_num])\n\n    ratio = 0.8\n    offset = int(data.shape[0] * ratio)\n    training_data = data[:offset]\n\n    maximums, minimums, avgs = training_data.max(axis=0), training_data.min(axis=0), training_data.sum(axis=0) / \\\n                               training_data.shape[0]\n    for i in range(feature_num):\n        data[:, i] = (data[:, i] - avgs[i]) / (maximums[i] - minimums[i])\n\n    training_data = data[:offset]\n    test_data = data[offset:]\n\n    return training_data, test_data\n\n\nclass Network(object):\n    def __init__(self, num_of_weights):\n        # 随机产生w的初始值\n        # 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子\n        np.random.seed(0)\n        self.w = np.random.randn(num_of_weights, 1)\n        self.b = 0.\n\n    def forward(self, x):\n        z = np.dot(x, self.w) + self.b\n        return z\n\n    def loss(self, z, y):\n        error = z - y\n        cost = error * error\n        cost = np.mean(cost)\n        return cost\n\n    def gradient(self, x, y):\n        z = self.forward(x)\n        gradient_w = (z - y) * x\n        gradient_w = np.mean(gradient_w, axis=0)\n        gradient_w = gradient_w[:, np.newaxis]\n        gradient_b = (z - y)\n        gradient_b = np.mean(gradient_b)\n\n        return gradient_w, gradient_b\n\n    def update(self, gradient_w, gradient_b, eta=0.01):\n        self.w = self.w - eta * gradient_w\n        self.b = self.b - eta * gradient_b\n\n    def train(self, x, y, iterations=100, eta=0.01):\n        losses = []\n        for i in range(iterations):\n            z = self.forward(x)\n            L = self.loss(z, y)\n            gradient_w, gradient_b = self.gradient(x, y)\n            self.update(gradient_w, gradient_b, eta)\n            losses.append(L)\n            if (i + 1) % 10 == 0:\n                print('iter {}, loss {}'.format(i, L))\n        return losses\n\n\n\n# 获取数据\ntrain_data, test_data = load_data()\nx = train_data[:, :-1]\ny = train_data[:, -1:]\n# 创建网络\nnet = Network(13)\nnum_iterations=1000\n# 启动训练\nlosses = net.train(x,y, iterations=num_iterations, eta=0.01)\n\n# 画出损失函数的变化趋势\nplot_x = np.arange(num_iterations)\nplot_y = np.array(losses)\nplt.plot(plot_x, plot_y)\nplt.show()\n\n\nclass NetworkOfSGD(object):\n    def __init__(self, num_of_weights):\n        # 随机产生w的初始值\n        # 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子\n        # np.random.seed(0)\n        self.w = np.random.randn(num_of_weights, 1)\n        self.b = 0.\n\n    def forward(self, x):\n        z = np.dot(x, self.w) + self.b\n        return z\n\n    def loss(self, z, y):\n        error = z - y\n        num_samples = error.shape[0]\n        cost = error * error\n        cost = np.sum(cost) / num_samples\n        return cost\n\n    def gradient(self, x, y):\n        z = self.forward(x)\n        N = x.shape[0]\n        gradient_w = 1. / N * np.sum((z - y) * x, axis=0)\n        gradient_w = gradient_w[:, np.newaxis]\n        gradient_b = 1. / N * np.sum(z - y)\n        return gradient_w, gradient_b\n\n    def update(self, gradient_w, gradient_b, eta=0.01):\n        self.w = self.w - eta * gradient_w\n        self.b = self.b - eta * gradient_b\n\n    def train(self, training_data, num_epoches, batch_size=10, eta=0.01):\n        n = len(training_data)\n        losses = []\n        for epoch_id in range(num_epoches):\n            # 在每轮迭代开始之前，将训练数据的顺序随机的打乱，\n            # 然后再按每次取batch_size条数据的方式取出\n            np.random.shuffle(training_data)\n            # 将训练数据进行拆分，每个mini_batch包含batch_size条的数据\n            mini_batches = [training_data[k:k + batch_size] for k in range(0, n, batch_size)]\n            for iter_id, mini_batch in enumerate(mini_batches):\n                # print(self.w.shape)\n                # print(self.b)\n                x = mini_batch[:, :-1]\n                y = mini_batch[:, -1:]\n                a = self.forward(x)\n                loss = self.loss(a, y)\n                gradient_w, gradient_b = self.gradient(x, y)\n                self.update(gradient_w, gradient_b, eta)\n                losses.append(loss)\n                print('Epoch {:3d} / iter {:3d}, loss = {:.4f}'.\n                      format(epoch_id, iter_id, loss))\n\n        return losses\n\n\n# 获取数据\ntrain_data, test_data = load_data()\n\n# 创建网络\nnet = NetworkOfSGD(13)\n# 启动训练\nlosses = net.train(train_data, num_epoches=50, batch_size=100, eta=0.1)\n\n# 画出损失函数的变化趋势\nplot_x = np.arange(len(losses))\nplot_y = np.array(losses)\nplt.plot(plot_x, plot_y)\nplt.show()\n```","slug":"ml/lesson1","published":1,"date":"2020-04-15T14:07:08.873Z","updated":"2020-04-24T14:42:11.514Z","title":"ml/lesson1","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981k00ba018o77x11mtb","content":"<h1 id=\"波士顿房价预测\"><a href=\"#波士顿房价预测\" class=\"headerlink\" title=\"波士顿房价预测\"></a>波士顿房价预测</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">load_data</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    datafile = <span class=\"string\">'./data/housing.data'</span></span><br><span class=\"line\">    data = np.fromfile(datafile, sep=<span class=\"string\">' '</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    feature_names = [<span class=\"string\">'CRIM'</span>, <span class=\"string\">'ZN'</span>, <span class=\"string\">'INDUS'</span>, <span class=\"string\">'CHAS'</span>, <span class=\"string\">'NOX'</span>, <span class=\"string\">'RM'</span>, <span class=\"string\">'AGE'</span>, <span class=\"string\">'DIS'</span>,</span><br><span class=\"line\">                     <span class=\"string\">'RAD'</span>, <span class=\"string\">'TAX'</span>, <span class=\"string\">'PTRATIO'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'LSTAT'</span>, <span class=\"string\">'MEDV'</span>]</span><br><span class=\"line\">    feature_num = len(feature_names)</span><br><span class=\"line\">    data = data.reshape([data.shape[<span class=\"number\">0</span>] // feature_num, feature_num])</span><br><span class=\"line\"></span><br><span class=\"line\">    ratio = <span class=\"number\">0.8</span></span><br><span class=\"line\">    offset = int(data.shape[<span class=\"number\">0</span>] * ratio)</span><br><span class=\"line\">    training_data = data[:offset]</span><br><span class=\"line\"></span><br><span class=\"line\">    maximums, minimums, avgs = training_data.max(axis=<span class=\"number\">0</span>), training_data.min(axis=<span class=\"number\">0</span>), training_data.sum(axis=<span class=\"number\">0</span>) / \\</span><br><span class=\"line\">                               training_data.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(feature_num):</span><br><span class=\"line\">        data[:, i] = (data[:, i] - avgs[i]) / (maximums[i] - minimums[i])</span><br><span class=\"line\"></span><br><span class=\"line\">    training_data = data[:offset]</span><br><span class=\"line\">    test_data = data[offset:]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> training_data, test_data</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Network</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, num_of_weights)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 随机产生w的初始值</span></span><br><span class=\"line\">        <span class=\"comment\"># 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子</span></span><br><span class=\"line\">        np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">        self.w = np.random.randn(num_of_weights, <span class=\"number\">1</span>)</span><br><span class=\"line\">        self.b = <span class=\"number\">0.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">forward</span><span class=\"params\">(self, x)</span>:</span></span><br><span class=\"line\">        z = np.dot(x, self.w) + self.b</span><br><span class=\"line\">        <span class=\"keyword\">return</span> z</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">loss</span><span class=\"params\">(self, z, y)</span>:</span></span><br><span class=\"line\">        error = z - y</span><br><span class=\"line\">        cost = error * error</span><br><span class=\"line\">        cost = np.mean(cost)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cost</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gradient</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        z = self.forward(x)</span><br><span class=\"line\">        gradient_w = (z - y) * x</span><br><span class=\"line\">        gradient_w = np.mean(gradient_w, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        gradient_w = gradient_w[:, np.newaxis]</span><br><span class=\"line\">        gradient_b = (z - y)</span><br><span class=\"line\">        gradient_b = np.mean(gradient_b)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> gradient_w, gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">update</span><span class=\"params\">(self, gradient_w, gradient_b, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        self.w = self.w - eta * gradient_w</span><br><span class=\"line\">        self.b = self.b - eta * gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">train</span><span class=\"params\">(self, x, y, iterations=<span class=\"number\">100</span>, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        losses = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(iterations):</span><br><span class=\"line\">            z = self.forward(x)</span><br><span class=\"line\">            L = self.loss(z, y)</span><br><span class=\"line\">            gradient_w, gradient_b = self.gradient(x, y)</span><br><span class=\"line\">            self.update(gradient_w, gradient_b, eta)</span><br><span class=\"line\">            losses.append(L)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i + <span class=\"number\">1</span>) % <span class=\"number\">10</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">                print(<span class=\"string\">'iter &#123;&#125;, loss &#123;&#125;'</span>.format(i, L))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> losses</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取数据</span></span><br><span class=\"line\">train_data, test_data = load_data()</span><br><span class=\"line\">x = train_data[:, :<span class=\"number\">-1</span>]</span><br><span class=\"line\">y = train_data[:, <span class=\"number\">-1</span>:]</span><br><span class=\"line\"><span class=\"comment\"># 创建网络</span></span><br><span class=\"line\">net = Network(<span class=\"number\">13</span>)</span><br><span class=\"line\">num_iterations=<span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"comment\"># 启动训练</span></span><br><span class=\"line\">losses = net.train(x,y, iterations=num_iterations, eta=<span class=\"number\">0.01</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画出损失函数的变化趋势</span></span><br><span class=\"line\">plot_x = np.arange(num_iterations)</span><br><span class=\"line\">plot_y = np.array(losses)</span><br><span class=\"line\">plt.plot(plot_x, plot_y)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NetworkOfSGD</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, num_of_weights)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 随机产生w的初始值</span></span><br><span class=\"line\">        <span class=\"comment\"># 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子</span></span><br><span class=\"line\">        <span class=\"comment\"># np.random.seed(0)</span></span><br><span class=\"line\">        self.w = np.random.randn(num_of_weights, <span class=\"number\">1</span>)</span><br><span class=\"line\">        self.b = <span class=\"number\">0.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">forward</span><span class=\"params\">(self, x)</span>:</span></span><br><span class=\"line\">        z = np.dot(x, self.w) + self.b</span><br><span class=\"line\">        <span class=\"keyword\">return</span> z</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">loss</span><span class=\"params\">(self, z, y)</span>:</span></span><br><span class=\"line\">        error = z - y</span><br><span class=\"line\">        num_samples = error.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        cost = error * error</span><br><span class=\"line\">        cost = np.sum(cost) / num_samples</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cost</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gradient</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        z = self.forward(x)</span><br><span class=\"line\">        N = x.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        gradient_w = <span class=\"number\">1.</span> / N * np.sum((z - y) * x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        gradient_w = gradient_w[:, np.newaxis]</span><br><span class=\"line\">        gradient_b = <span class=\"number\">1.</span> / N * np.sum(z - y)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> gradient_w, gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">update</span><span class=\"params\">(self, gradient_w, gradient_b, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        self.w = self.w - eta * gradient_w</span><br><span class=\"line\">        self.b = self.b - eta * gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">train</span><span class=\"params\">(self, training_data, num_epoches, batch_size=<span class=\"number\">10</span>, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        n = len(training_data)</span><br><span class=\"line\">        losses = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> epoch_id <span class=\"keyword\">in</span> range(num_epoches):</span><br><span class=\"line\">            <span class=\"comment\"># 在每轮迭代开始之前，将训练数据的顺序随机的打乱，</span></span><br><span class=\"line\">            <span class=\"comment\"># 然后再按每次取batch_size条数据的方式取出</span></span><br><span class=\"line\">            np.random.shuffle(training_data)</span><br><span class=\"line\">            <span class=\"comment\"># 将训练数据进行拆分，每个mini_batch包含batch_size条的数据</span></span><br><span class=\"line\">            mini_batches = [training_data[k:k + batch_size] <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, n, batch_size)]</span><br><span class=\"line\">            <span class=\"keyword\">for</span> iter_id, mini_batch <span class=\"keyword\">in</span> enumerate(mini_batches):</span><br><span class=\"line\">                <span class=\"comment\"># print(self.w.shape)</span></span><br><span class=\"line\">                <span class=\"comment\"># print(self.b)</span></span><br><span class=\"line\">                x = mini_batch[:, :<span class=\"number\">-1</span>]</span><br><span class=\"line\">                y = mini_batch[:, <span class=\"number\">-1</span>:]</span><br><span class=\"line\">                a = self.forward(x)</span><br><span class=\"line\">                loss = self.loss(a, y)</span><br><span class=\"line\">                gradient_w, gradient_b = self.gradient(x, y)</span><br><span class=\"line\">                self.update(gradient_w, gradient_b, eta)</span><br><span class=\"line\">                losses.append(loss)</span><br><span class=\"line\">                print(<span class=\"string\">'Epoch &#123;:3d&#125; / iter &#123;:3d&#125;, loss = &#123;:.4f&#125;'</span>.</span><br><span class=\"line\">                      format(epoch_id, iter_id, loss))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> losses</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取数据</span></span><br><span class=\"line\">train_data, test_data = load_data()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建网络</span></span><br><span class=\"line\">net = NetworkOfSGD(<span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"comment\"># 启动训练</span></span><br><span class=\"line\">losses = net.train(train_data, num_epoches=<span class=\"number\">50</span>, batch_size=<span class=\"number\">100</span>, eta=<span class=\"number\">0.1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画出损失函数的变化趋势</span></span><br><span class=\"line\">plot_x = np.arange(len(losses))</span><br><span class=\"line\">plot_y = np.array(losses)</span><br><span class=\"line\">plt.plot(plot_x, plot_y)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"波士顿房价预测\"><a href=\"#波士顿房价预测\" class=\"headerlink\" title=\"波士顿房价预测\"></a>波士顿房价预测</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">load_data</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    datafile = <span class=\"string\">'./data/housing.data'</span></span><br><span class=\"line\">    data = np.fromfile(datafile, sep=<span class=\"string\">' '</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    feature_names = [<span class=\"string\">'CRIM'</span>, <span class=\"string\">'ZN'</span>, <span class=\"string\">'INDUS'</span>, <span class=\"string\">'CHAS'</span>, <span class=\"string\">'NOX'</span>, <span class=\"string\">'RM'</span>, <span class=\"string\">'AGE'</span>, <span class=\"string\">'DIS'</span>,</span><br><span class=\"line\">                     <span class=\"string\">'RAD'</span>, <span class=\"string\">'TAX'</span>, <span class=\"string\">'PTRATIO'</span>, <span class=\"string\">'B'</span>, <span class=\"string\">'LSTAT'</span>, <span class=\"string\">'MEDV'</span>]</span><br><span class=\"line\">    feature_num = len(feature_names)</span><br><span class=\"line\">    data = data.reshape([data.shape[<span class=\"number\">0</span>] // feature_num, feature_num])</span><br><span class=\"line\"></span><br><span class=\"line\">    ratio = <span class=\"number\">0.8</span></span><br><span class=\"line\">    offset = int(data.shape[<span class=\"number\">0</span>] * ratio)</span><br><span class=\"line\">    training_data = data[:offset]</span><br><span class=\"line\"></span><br><span class=\"line\">    maximums, minimums, avgs = training_data.max(axis=<span class=\"number\">0</span>), training_data.min(axis=<span class=\"number\">0</span>), training_data.sum(axis=<span class=\"number\">0</span>) / \\</span><br><span class=\"line\">                               training_data.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(feature_num):</span><br><span class=\"line\">        data[:, i] = (data[:, i] - avgs[i]) / (maximums[i] - minimums[i])</span><br><span class=\"line\"></span><br><span class=\"line\">    training_data = data[:offset]</span><br><span class=\"line\">    test_data = data[offset:]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> training_data, test_data</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Network</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, num_of_weights)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 随机产生w的初始值</span></span><br><span class=\"line\">        <span class=\"comment\"># 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子</span></span><br><span class=\"line\">        np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">        self.w = np.random.randn(num_of_weights, <span class=\"number\">1</span>)</span><br><span class=\"line\">        self.b = <span class=\"number\">0.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">forward</span><span class=\"params\">(self, x)</span>:</span></span><br><span class=\"line\">        z = np.dot(x, self.w) + self.b</span><br><span class=\"line\">        <span class=\"keyword\">return</span> z</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">loss</span><span class=\"params\">(self, z, y)</span>:</span></span><br><span class=\"line\">        error = z - y</span><br><span class=\"line\">        cost = error * error</span><br><span class=\"line\">        cost = np.mean(cost)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cost</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gradient</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        z = self.forward(x)</span><br><span class=\"line\">        gradient_w = (z - y) * x</span><br><span class=\"line\">        gradient_w = np.mean(gradient_w, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        gradient_w = gradient_w[:, np.newaxis]</span><br><span class=\"line\">        gradient_b = (z - y)</span><br><span class=\"line\">        gradient_b = np.mean(gradient_b)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> gradient_w, gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">update</span><span class=\"params\">(self, gradient_w, gradient_b, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        self.w = self.w - eta * gradient_w</span><br><span class=\"line\">        self.b = self.b - eta * gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">train</span><span class=\"params\">(self, x, y, iterations=<span class=\"number\">100</span>, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        losses = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(iterations):</span><br><span class=\"line\">            z = self.forward(x)</span><br><span class=\"line\">            L = self.loss(z, y)</span><br><span class=\"line\">            gradient_w, gradient_b = self.gradient(x, y)</span><br><span class=\"line\">            self.update(gradient_w, gradient_b, eta)</span><br><span class=\"line\">            losses.append(L)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i + <span class=\"number\">1</span>) % <span class=\"number\">10</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">                print(<span class=\"string\">'iter &#123;&#125;, loss &#123;&#125;'</span>.format(i, L))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> losses</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取数据</span></span><br><span class=\"line\">train_data, test_data = load_data()</span><br><span class=\"line\">x = train_data[:, :<span class=\"number\">-1</span>]</span><br><span class=\"line\">y = train_data[:, <span class=\"number\">-1</span>:]</span><br><span class=\"line\"><span class=\"comment\"># 创建网络</span></span><br><span class=\"line\">net = Network(<span class=\"number\">13</span>)</span><br><span class=\"line\">num_iterations=<span class=\"number\">1000</span></span><br><span class=\"line\"><span class=\"comment\"># 启动训练</span></span><br><span class=\"line\">losses = net.train(x,y, iterations=num_iterations, eta=<span class=\"number\">0.01</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画出损失函数的变化趋势</span></span><br><span class=\"line\">plot_x = np.arange(num_iterations)</span><br><span class=\"line\">plot_y = np.array(losses)</span><br><span class=\"line\">plt.plot(plot_x, plot_y)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NetworkOfSGD</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, num_of_weights)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 随机产生w的初始值</span></span><br><span class=\"line\">        <span class=\"comment\"># 为了保持程序每次运行结果的一致性，此处设置固定的随机数种子</span></span><br><span class=\"line\">        <span class=\"comment\"># np.random.seed(0)</span></span><br><span class=\"line\">        self.w = np.random.randn(num_of_weights, <span class=\"number\">1</span>)</span><br><span class=\"line\">        self.b = <span class=\"number\">0.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">forward</span><span class=\"params\">(self, x)</span>:</span></span><br><span class=\"line\">        z = np.dot(x, self.w) + self.b</span><br><span class=\"line\">        <span class=\"keyword\">return</span> z</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">loss</span><span class=\"params\">(self, z, y)</span>:</span></span><br><span class=\"line\">        error = z - y</span><br><span class=\"line\">        num_samples = error.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        cost = error * error</span><br><span class=\"line\">        cost = np.sum(cost) / num_samples</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cost</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gradient</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        z = self.forward(x)</span><br><span class=\"line\">        N = x.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        gradient_w = <span class=\"number\">1.</span> / N * np.sum((z - y) * x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        gradient_w = gradient_w[:, np.newaxis]</span><br><span class=\"line\">        gradient_b = <span class=\"number\">1.</span> / N * np.sum(z - y)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> gradient_w, gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">update</span><span class=\"params\">(self, gradient_w, gradient_b, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        self.w = self.w - eta * gradient_w</span><br><span class=\"line\">        self.b = self.b - eta * gradient_b</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">train</span><span class=\"params\">(self, training_data, num_epoches, batch_size=<span class=\"number\">10</span>, eta=<span class=\"number\">0.01</span>)</span>:</span></span><br><span class=\"line\">        n = len(training_data)</span><br><span class=\"line\">        losses = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> epoch_id <span class=\"keyword\">in</span> range(num_epoches):</span><br><span class=\"line\">            <span class=\"comment\"># 在每轮迭代开始之前，将训练数据的顺序随机的打乱，</span></span><br><span class=\"line\">            <span class=\"comment\"># 然后再按每次取batch_size条数据的方式取出</span></span><br><span class=\"line\">            np.random.shuffle(training_data)</span><br><span class=\"line\">            <span class=\"comment\"># 将训练数据进行拆分，每个mini_batch包含batch_size条的数据</span></span><br><span class=\"line\">            mini_batches = [training_data[k:k + batch_size] <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, n, batch_size)]</span><br><span class=\"line\">            <span class=\"keyword\">for</span> iter_id, mini_batch <span class=\"keyword\">in</span> enumerate(mini_batches):</span><br><span class=\"line\">                <span class=\"comment\"># print(self.w.shape)</span></span><br><span class=\"line\">                <span class=\"comment\"># print(self.b)</span></span><br><span class=\"line\">                x = mini_batch[:, :<span class=\"number\">-1</span>]</span><br><span class=\"line\">                y = mini_batch[:, <span class=\"number\">-1</span>:]</span><br><span class=\"line\">                a = self.forward(x)</span><br><span class=\"line\">                loss = self.loss(a, y)</span><br><span class=\"line\">                gradient_w, gradient_b = self.gradient(x, y)</span><br><span class=\"line\">                self.update(gradient_w, gradient_b, eta)</span><br><span class=\"line\">                losses.append(loss)</span><br><span class=\"line\">                print(<span class=\"string\">'Epoch &#123;:3d&#125; / iter &#123;:3d&#125;, loss = &#123;:.4f&#125;'</span>.</span><br><span class=\"line\">                      format(epoch_id, iter_id, loss))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> losses</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取数据</span></span><br><span class=\"line\">train_data, test_data = load_data()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建网络</span></span><br><span class=\"line\">net = NetworkOfSGD(<span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"comment\"># 启动训练</span></span><br><span class=\"line\">losses = net.train(train_data, num_epoches=<span class=\"number\">50</span>, batch_size=<span class=\"number\">100</span>, eta=<span class=\"number\">0.1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画出损失函数的变化趋势</span></span><br><span class=\"line\">plot_x = np.arange(len(losses))</span><br><span class=\"line\">plot_y = np.array(losses)</span><br><span class=\"line\">plt.plot(plot_x, plot_y)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>"},{"title":"How to write a paper - Intro","_content":"\n# Importance\n\n","source":"_posts/paper/paper-intro.md","raw":"---\ntitle: How to write a paper - Intro\ncategories:\n- Paper\n---\n\n# Importance\n\n","slug":"paper/paper-intro","published":1,"date":"2021-08-26T16:37:06.756Z","updated":"2021-08-26T16:51:26.529Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981l00bb018oajvcfdh5","content":"<h1 id=\"Importance\"><a href=\"#Importance\" class=\"headerlink\" title=\"Importance\"></a>Importance</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Importance\"><a href=\"#Importance\" class=\"headerlink\" title=\"Importance\"></a>Importance</h1>"},{"title":"Python原生高阶用法","catagories":["Paper"],"_content":"\n# new\n\n静态方法，传入`cls`类，返回`self`实例。在`__init__`之前调用。\n\n# init\n\n接收`__new__`返回的实例，对实例进行初始化。\n\n# call\n\n使实例化后的对象变成了`callable`可以调用的对象（）。同时\n\n```python\nclass Hello:\n\tdef __call__(self, arg):\n  \tprint('hello' + arg)\n    \n  def hello():\n    print('hello word')\nh = Hello()\nh('world')\n# hello world\nh.hello.__call__()\n# hello world\n```\n\n# getitem\n\n`getitem`可以直接对对象进行取值。\n\n```python\ndef __getitem__(self, idx):\n  return self.data[idx]\n```\n\n# 反射\n\nPython也有**反射**，即可以通过字符串的形式操作实例的属性。\n\n`__hasattr__`, `__getattr__`, `__setattr__`, `__delattr__`\n\n# 类变量\n\n```python\nclass C:\n  var_class = 0\n  def __init__(self):\n    self.var_instance = 1\n```\n\n类似静态成员。\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/3aca78a84def","source":"_posts/paper_exp/buildin.md","raw":"---\ntitle: Python原生高阶用法\ncatagories:\n- Paper\ntags:\n- python\n- buildin\n---\n\n# new\n\n静态方法，传入`cls`类，返回`self`实例。在`__init__`之前调用。\n\n# init\n\n接收`__new__`返回的实例，对实例进行初始化。\n\n# call\n\n使实例化后的对象变成了`callable`可以调用的对象（）。同时\n\n```python\nclass Hello:\n\tdef __call__(self, arg):\n  \tprint('hello' + arg)\n    \n  def hello():\n    print('hello word')\nh = Hello()\nh('world')\n# hello world\nh.hello.__call__()\n# hello world\n```\n\n# getitem\n\n`getitem`可以直接对对象进行取值。\n\n```python\ndef __getitem__(self, idx):\n  return self.data[idx]\n```\n\n# 反射\n\nPython也有**反射**，即可以通过字符串的形式操作实例的属性。\n\n`__hasattr__`, `__getattr__`, `__setattr__`, `__delattr__`\n\n# 类变量\n\n```python\nclass C:\n  var_class = 0\n  def __init__(self):\n    self.var_instance = 1\n```\n\n类似静态成员。\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/3aca78a84def","slug":"paper_exp/buildin","published":1,"date":"2021-03-05T08:12:25.918Z","updated":"2021-03-05T08:46:02.722Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981m00bg018of1ij8lsz","content":"<h1 id=\"new\"><a href=\"#new\" class=\"headerlink\" title=\"new\"></a>new</h1><p>静态方法，传入<code>cls</code>类，返回<code>self</code>实例。在<code>__init__</code>之前调用。</p>\n<h1 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h1><p>接收<code>__new__</code>返回的实例，对实例进行初始化。</p>\n<h1 id=\"call\"><a href=\"#call\" class=\"headerlink\" title=\"call\"></a>call</h1><p>使实例化后的对象变成了<code>callable</code>可以调用的对象（）。同时</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hello</span>:</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__call__</span><span class=\"params\">(self, arg)</span>:</span></span><br><span class=\"line\">  \tprint(<span class=\"string\">'hello'</span> + arg)</span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'hello word'</span>)</span><br><span class=\"line\">h = Hello()</span><br><span class=\"line\">h(<span class=\"string\">'world'</span>)</span><br><span class=\"line\"><span class=\"comment\"># hello world</span></span><br><span class=\"line\">h.hello.__call__()</span><br><span class=\"line\"><span class=\"comment\"># hello world</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"getitem\"><a href=\"#getitem\" class=\"headerlink\" title=\"getitem\"></a>getitem</h1><p><code>getitem</code>可以直接对对象进行取值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__getitem__</span><span class=\"params\">(self, idx)</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> self.data[idx]</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"反射\"><a href=\"#反射\" class=\"headerlink\" title=\"反射\"></a>反射</h1><p>Python也有<strong>反射</strong>，即可以通过字符串的形式操作实例的属性。</p>\n<p><code>__hasattr__</code>, <code>__getattr__</code>, <code>__setattr__</code>, <code>__delattr__</code></p>\n<h1 id=\"类变量\"><a href=\"#类变量\" class=\"headerlink\" title=\"类变量\"></a>类变量</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">C</span>:</span></span><br><span class=\"line\">  var_class = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    self.var_instance = <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>类似静态成员。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8zYWNhNzhhODRkZWY=\">https://www.jianshu.com/p/3aca78a84def<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"new\"><a href=\"#new\" class=\"headerlink\" title=\"new\"></a>new</h1><p>静态方法，传入<code>cls</code>类，返回<code>self</code>实例。在<code>__init__</code>之前调用。</p>\n<h1 id=\"init\"><a href=\"#init\" class=\"headerlink\" title=\"init\"></a>init</h1><p>接收<code>__new__</code>返回的实例，对实例进行初始化。</p>\n<h1 id=\"call\"><a href=\"#call\" class=\"headerlink\" title=\"call\"></a>call</h1><p>使实例化后的对象变成了<code>callable</code>可以调用的对象（）。同时</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Hello</span>:</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__call__</span><span class=\"params\">(self, arg)</span>:</span></span><br><span class=\"line\">  \tprint(<span class=\"string\">'hello'</span> + arg)</span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">'hello word'</span>)</span><br><span class=\"line\">h = Hello()</span><br><span class=\"line\">h(<span class=\"string\">'world'</span>)</span><br><span class=\"line\"><span class=\"comment\"># hello world</span></span><br><span class=\"line\">h.hello.__call__()</span><br><span class=\"line\"><span class=\"comment\"># hello world</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"getitem\"><a href=\"#getitem\" class=\"headerlink\" title=\"getitem\"></a>getitem</h1><p><code>getitem</code>可以直接对对象进行取值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__getitem__</span><span class=\"params\">(self, idx)</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> self.data[idx]</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"反射\"><a href=\"#反射\" class=\"headerlink\" title=\"反射\"></a>反射</h1><p>Python也有<strong>反射</strong>，即可以通过字符串的形式操作实例的属性。</p>\n<p><code>__hasattr__</code>, <code>__getattr__</code>, <code>__setattr__</code>, <code>__delattr__</code></p>\n<h1 id=\"类变量\"><a href=\"#类变量\" class=\"headerlink\" title=\"类变量\"></a>类变量</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">C</span>:</span></span><br><span class=\"line\">  var_class = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">    self.var_instance = <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>类似静态成员。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8zYWNhNzhhODRkZWY=\">https://www.jianshu.com/p/3aca78a84def<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"特征工程","_content":"\n# 特征工程\n\n## SIFT\n\n尺度不变特征转换(Scale-invariant feature transform).\n\n```python\n# @Author  : Edlison\n# @Date    : 5/30/21 23:26\n\nimport cv2\nimport numpy as np\nfrom matplotlib import pyplot as plt\n\n# Load\nimgname = 'Image.jpeg'\nsift = cv2.SIFT_create()\nimg = cv2.imread(imgname)\n\n# Calculate\ngray = cv2.cvtColor(img.numpy(), cv2.COLOR_BGR2GRAY)\nkp, des = sift.detectAndCompute(img, None)\n\n# Draw sift\nimg1 = cv2.drawKeypoints(gray, kp, img, color=(255, 0, 0))\n\nplt.imshow(img1)\nplt.title('after')\nplt.show()\n```\n\n调用cv2中的SIFT算法。\n\n1. 读取图片，cv读取通道默认是BGR，需要手动转换为RGB或其他。\n2. 计算keypoints\n3. 在原图上画出keypoints，可以选择keypoint的color或者flag。\n\n\n\n## LBP\n\n局部二值模型（Local Binary Pattern）.\n\n是一种用来描述图像局部纹理特征的算子，它具有**旋转不变性**和**灰度不变性**的特点。\n\n```python\nimport numpy as np\nimport cv2\nimport torch\nfrom PIL import Image\nfrom pylab import*\n\n\nclass LBP:\n    def __init__(self):\n        super()\n        \n    #将图像载入，并转化为灰度图，获取图像灰度图的像素信息\n    def describe(self,image):\n        image_array=np.array(Image.open(image).convert('L'))\n        return image_array\n    \n    #图像的LBP原始特征计算算法：将图像指定位置的像素与周围8个像素比较\n    #比中心像素大的点赋值为1，比中心像素小的赋值为0，返回得到的二进制序列\n    def calute_basic_lbp(self,image_array,i,j):\n        sum=[]\n        if image_array[i-1,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i-1,j]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i-1,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        return sum\n    \n    #获取二进制序列进行不断环形旋转得到新的二进制序列的最小十进制值\n    def get_min_for_revolve(self,arr): \n        values=[]\n        circle=arr\n        circle.extend(arr)\n        for i in range(0,8):\n            j=0\n            sum=0\n            bit_num=0\n            while j<8:\n                sum+=circle[i+j]<<bit_num\n                bit_num+=1\n                j+=1\n            values.append(sum)\n        return min(values)\n\n    #获取值r的二进制中1的位数\n    def calc_sum(self,r):\n        num=0\n        while(r):\n            r&=(r-1)\n            num+=1\n        return num\n\n    #获取图像的LBP原始模式特征\n    def lbp_basic(self,image_array):\n        basic_array=np.zeros(image_array.shape, np.uint8)\n        width=image_array.shape[0]\n        height=image_array.shape[1]\n        for i in range(1,width-1):\n            for j in range(1,height-1):\n                sum=self.calute_basic_lbp(image_array,i,j)\n                bit_num=0\n                result=0\n                for s in sum:\n                    result+=s<<bit_num\n                    bit_num+=1\n                basic_array[i,j]=result\n        return basic_array\n\n    #显示图像\n    def show_image(self,image_array):\n        plt.imshow(image_array)\n        plt.show()\n\n\nif __name__ == '__main__':\n    image = '../Image.jpeg'\n    lbp=LBP()\n    img=lbp.describe(image)\n    #获取图像原始LBP特征，并显示其统计直方图与特征图像\n    basic_array=lbp.lbp_basic(img)\n    lbp.show_image(basic_array)\n\n```\n\n\n\n## GLCM\n\n灰度共生矩阵（Gray-Level Co-occurrence Matrix）,\n\n一种描述图像局部区域或整体区域的某像素与相邻像素或一定距离内的像素的灰度关系的矩阵。\n\n```python\n# coding: utf-8\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport cv2\nimport torch\nfrom skimage import data\n\n\ndef main():\n    pass\n\n\ndef fast_glcm(img, vmin=0, vmax=255, nbit=8, kernel_size=5):\n    mi, ma = vmin, vmax\n    ks = kernel_size\n    h,w = img.shape\n\n    # digitize\n    bins = np.linspace(mi, ma+1, nbit+1)\n    gl1 = np.digitize(img, bins) - 1\n    gl2 = np.append(gl1[:,1:], gl1[:,-1:], axis=1)\n\n    # make glcm\n    glcm = np.zeros((nbit, nbit, h, w), dtype=np.uint8)\n    for i in range(nbit):\n        for j in range(nbit):\n            mask = ((gl1==i) & (gl2==j))\n            glcm[i,j, mask] = 1\n\n    kernel = np.ones((ks, ks), dtype=np.uint8)\n    for i in range(nbit):\n        for j in range(nbit):\n            glcm[i,j] = cv2.filter2D(glcm[i,j], -1, kernel)\n\n    glcm = glcm.astype(np.float32)\n    return glcm\n\n\ndef fast_glcm_mean(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm mean\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    mean = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            mean += glcm[i,j] * i / (nbit)**2\n\n    return mean\n\n\ndef fast_glcm_std(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm std\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    mean = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            mean += glcm[i,j] * i / (nbit)**2\n\n    std2 = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            std2 += (glcm[i,j] * i - mean)**2\n\n    std = np.sqrt(std2)\n    return std\n\n\ndef fast_glcm_contrast(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm contrast\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    cont = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            cont += glcm[i,j] * (i-j)**2\n\n    return cont\n\n\ndef fast_glcm_dissimilarity(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm dissimilarity\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    diss = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            diss += glcm[i,j] * np.abs(i-j)\n\n    return diss\n\n\ndef fast_glcm_homogeneity(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm homogeneity\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    homo = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            homo += glcm[i,j] / (1.+(i-j)**2)\n\n    return homo\n\n\ndef fast_glcm_ASM(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm asm, energy\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    asm = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            asm  += glcm[i,j]**2\n\n    ene = np.sqrt(asm)\n    return asm, ene\n\n\ndef fast_glcm_max(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm max\n    '''\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    max_  = np.max(glcm, axis=(0,1))\n    return max_\n\n\ndef fast_glcm_entropy(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm entropy\n    '''\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    pnorm = glcm / np.sum(glcm, axis=(0,1)) + 1./ks**2\n    ent  = np.sum(-pnorm * np.log(pnorm), axis=(0,1))\n    return ent\n\n\nif __name__ == '__main__':\n    nbit = 8\n    ks = 5\n    mi, ma = 0, 255\n\n    tar_f = '../../data/MNIST/processed/training.pt'\n    imgs, labels = torch.load(tar_f)\n    img = imgs[2]\n\n    img = fast_glcm_mean(img, vmin=mi, vmax=ma, nbit=nbit, ks=ks)\n    plt.imshow(img)\n    plt.title('after')\n    plt.show()\n```\n\n\n\n## GIST\n\n一种宏观意义的场景特征描述。\n\n只识别’大街上有一些行人’这个场景，无需知道图像中在那些位置有多少人，或者有其他什么对象。\n\nGIST特征向量可以一定程度表征这种宏观场景特征。","source":"_posts/paper_exp/features.md","raw":"---\ntitle: 特征工程\ncategories:\n- Paper\ntags:\n- features\n---\n\n# 特征工程\n\n## SIFT\n\n尺度不变特征转换(Scale-invariant feature transform).\n\n```python\n# @Author  : Edlison\n# @Date    : 5/30/21 23:26\n\nimport cv2\nimport numpy as np\nfrom matplotlib import pyplot as plt\n\n# Load\nimgname = 'Image.jpeg'\nsift = cv2.SIFT_create()\nimg = cv2.imread(imgname)\n\n# Calculate\ngray = cv2.cvtColor(img.numpy(), cv2.COLOR_BGR2GRAY)\nkp, des = sift.detectAndCompute(img, None)\n\n# Draw sift\nimg1 = cv2.drawKeypoints(gray, kp, img, color=(255, 0, 0))\n\nplt.imshow(img1)\nplt.title('after')\nplt.show()\n```\n\n调用cv2中的SIFT算法。\n\n1. 读取图片，cv读取通道默认是BGR，需要手动转换为RGB或其他。\n2. 计算keypoints\n3. 在原图上画出keypoints，可以选择keypoint的color或者flag。\n\n\n\n## LBP\n\n局部二值模型（Local Binary Pattern）.\n\n是一种用来描述图像局部纹理特征的算子，它具有**旋转不变性**和**灰度不变性**的特点。\n\n```python\nimport numpy as np\nimport cv2\nimport torch\nfrom PIL import Image\nfrom pylab import*\n\n\nclass LBP:\n    def __init__(self):\n        super()\n        \n    #将图像载入，并转化为灰度图，获取图像灰度图的像素信息\n    def describe(self,image):\n        image_array=np.array(Image.open(image).convert('L'))\n        return image_array\n    \n    #图像的LBP原始特征计算算法：将图像指定位置的像素与周围8个像素比较\n    #比中心像素大的点赋值为1，比中心像素小的赋值为0，返回得到的二进制序列\n    def calute_basic_lbp(self,image_array,i,j):\n        sum=[]\n        if image_array[i-1,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i-1,j]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i-1,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j-1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        if image_array[i+1,j+1]>image_array[i,j]:\n            sum.append(1)\n        else:\n            sum.append(0)\n        return sum\n    \n    #获取二进制序列进行不断环形旋转得到新的二进制序列的最小十进制值\n    def get_min_for_revolve(self,arr): \n        values=[]\n        circle=arr\n        circle.extend(arr)\n        for i in range(0,8):\n            j=0\n            sum=0\n            bit_num=0\n            while j<8:\n                sum+=circle[i+j]<<bit_num\n                bit_num+=1\n                j+=1\n            values.append(sum)\n        return min(values)\n\n    #获取值r的二进制中1的位数\n    def calc_sum(self,r):\n        num=0\n        while(r):\n            r&=(r-1)\n            num+=1\n        return num\n\n    #获取图像的LBP原始模式特征\n    def lbp_basic(self,image_array):\n        basic_array=np.zeros(image_array.shape, np.uint8)\n        width=image_array.shape[0]\n        height=image_array.shape[1]\n        for i in range(1,width-1):\n            for j in range(1,height-1):\n                sum=self.calute_basic_lbp(image_array,i,j)\n                bit_num=0\n                result=0\n                for s in sum:\n                    result+=s<<bit_num\n                    bit_num+=1\n                basic_array[i,j]=result\n        return basic_array\n\n    #显示图像\n    def show_image(self,image_array):\n        plt.imshow(image_array)\n        plt.show()\n\n\nif __name__ == '__main__':\n    image = '../Image.jpeg'\n    lbp=LBP()\n    img=lbp.describe(image)\n    #获取图像原始LBP特征，并显示其统计直方图与特征图像\n    basic_array=lbp.lbp_basic(img)\n    lbp.show_image(basic_array)\n\n```\n\n\n\n## GLCM\n\n灰度共生矩阵（Gray-Level Co-occurrence Matrix）,\n\n一种描述图像局部区域或整体区域的某像素与相邻像素或一定距离内的像素的灰度关系的矩阵。\n\n```python\n# coding: utf-8\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport cv2\nimport torch\nfrom skimage import data\n\n\ndef main():\n    pass\n\n\ndef fast_glcm(img, vmin=0, vmax=255, nbit=8, kernel_size=5):\n    mi, ma = vmin, vmax\n    ks = kernel_size\n    h,w = img.shape\n\n    # digitize\n    bins = np.linspace(mi, ma+1, nbit+1)\n    gl1 = np.digitize(img, bins) - 1\n    gl2 = np.append(gl1[:,1:], gl1[:,-1:], axis=1)\n\n    # make glcm\n    glcm = np.zeros((nbit, nbit, h, w), dtype=np.uint8)\n    for i in range(nbit):\n        for j in range(nbit):\n            mask = ((gl1==i) & (gl2==j))\n            glcm[i,j, mask] = 1\n\n    kernel = np.ones((ks, ks), dtype=np.uint8)\n    for i in range(nbit):\n        for j in range(nbit):\n            glcm[i,j] = cv2.filter2D(glcm[i,j], -1, kernel)\n\n    glcm = glcm.astype(np.float32)\n    return glcm\n\n\ndef fast_glcm_mean(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm mean\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    mean = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            mean += glcm[i,j] * i / (nbit)**2\n\n    return mean\n\n\ndef fast_glcm_std(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm std\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    mean = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            mean += glcm[i,j] * i / (nbit)**2\n\n    std2 = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            std2 += (glcm[i,j] * i - mean)**2\n\n    std = np.sqrt(std2)\n    return std\n\n\ndef fast_glcm_contrast(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm contrast\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    cont = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            cont += glcm[i,j] * (i-j)**2\n\n    return cont\n\n\ndef fast_glcm_dissimilarity(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm dissimilarity\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    diss = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            diss += glcm[i,j] * np.abs(i-j)\n\n    return diss\n\n\ndef fast_glcm_homogeneity(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm homogeneity\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    homo = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            homo += glcm[i,j] / (1.+(i-j)**2)\n\n    return homo\n\n\ndef fast_glcm_ASM(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm asm, energy\n    '''\n    h,w = img.shape\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    asm = np.zeros((h,w), dtype=np.float32)\n    for i in range(nbit):\n        for j in range(nbit):\n            asm  += glcm[i,j]**2\n\n    ene = np.sqrt(asm)\n    return asm, ene\n\n\ndef fast_glcm_max(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm max\n    '''\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    max_  = np.max(glcm, axis=(0,1))\n    return max_\n\n\ndef fast_glcm_entropy(img, vmin=0, vmax=255, nbit=8, ks=5):\n    '''\n    calc glcm entropy\n    '''\n    glcm = fast_glcm(img, vmin, vmax, nbit, ks)\n    pnorm = glcm / np.sum(glcm, axis=(0,1)) + 1./ks**2\n    ent  = np.sum(-pnorm * np.log(pnorm), axis=(0,1))\n    return ent\n\n\nif __name__ == '__main__':\n    nbit = 8\n    ks = 5\n    mi, ma = 0, 255\n\n    tar_f = '../../data/MNIST/processed/training.pt'\n    imgs, labels = torch.load(tar_f)\n    img = imgs[2]\n\n    img = fast_glcm_mean(img, vmin=mi, vmax=ma, nbit=nbit, ks=ks)\n    plt.imshow(img)\n    plt.title('after')\n    plt.show()\n```\n\n\n\n## GIST\n\n一种宏观意义的场景特征描述。\n\n只识别’大街上有一些行人’这个场景，无需知道图像中在那些位置有多少人，或者有其他什么对象。\n\nGIST特征向量可以一定程度表征这种宏观场景特征。","slug":"paper_exp/features","published":1,"date":"2021-06-06T14:41:03.413Z","updated":"2021-06-07T09:59:24.081Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981n00bi018oazopd622","content":"<h1 id=\"特征工程\"><a href=\"#特征工程\" class=\"headerlink\" title=\"特征工程\"></a>特征工程</h1><h2 id=\"SIFT\"><a href=\"#SIFT\" class=\"headerlink\" title=\"SIFT\"></a>SIFT</h2><p>尺度不变特征转换(Scale-invariant feature transform).</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># @Author  : Edlison</span></span><br><span class=\"line\"><span class=\"comment\"># @Date    : 5/30/21 23:26</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Load</span></span><br><span class=\"line\">imgname = <span class=\"string\">'Image.jpeg'</span></span><br><span class=\"line\">sift = cv2.SIFT_create()</span><br><span class=\"line\">img = cv2.imread(imgname)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Calculate</span></span><br><span class=\"line\">gray = cv2.cvtColor(img.numpy(), cv2.COLOR_BGR2GRAY)</span><br><span class=\"line\">kp, des = sift.detectAndCompute(img, <span class=\"literal\">None</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Draw sift</span></span><br><span class=\"line\">img1 = cv2.drawKeypoints(gray, kp, img, color=(<span class=\"number\">255</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">plt.imshow(img1)</span><br><span class=\"line\">plt.title(<span class=\"string\">'after'</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n<p>调用cv2中的SIFT算法。</p>\n<ol>\n<li>读取图片，cv读取通道默认是BGR，需要手动转换为RGB或其他。</li>\n<li>计算keypoints</li>\n<li>在原图上画出keypoints，可以选择keypoint的color或者flag。</li>\n</ol>\n<h2 id=\"LBP\"><a href=\"#LBP\" class=\"headerlink\" title=\"LBP\"></a>LBP</h2><p>局部二值模型（Local Binary Pattern）.</p>\n<p>是一种用来描述图像局部纹理特征的算子，它具有<strong>旋转不变性</strong>和<strong>灰度不变性</strong>的特点。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">from</span> PIL <span class=\"keyword\">import</span> Image</span><br><span class=\"line\"><span class=\"keyword\">from</span> pylab <span class=\"keyword\">import</span>*</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LBP</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        super()</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"comment\">#将图像载入，并转化为灰度图，获取图像灰度图的像素信息</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">describe</span><span class=\"params\">(self,image)</span>:</span></span><br><span class=\"line\">        image_array=np.array(Image.open(image).convert(<span class=\"string\">'L'</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> image_array</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#图像的LBP原始特征计算算法：将图像指定位置的像素与周围8个像素比较</span></span><br><span class=\"line\">    <span class=\"comment\">#比中心像素大的点赋值为1，比中心像素小的赋值为0，返回得到的二进制序列</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calute_basic_lbp</span><span class=\"params\">(self,image_array,i,j)</span>:</span></span><br><span class=\"line\">        sum=[]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sum</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#获取二进制序列进行不断环形旋转得到新的二进制序列的最小十进制值</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_min_for_revolve</span><span class=\"params\">(self,arr)</span>:</span> </span><br><span class=\"line\">        values=[]</span><br><span class=\"line\">        circle=arr</span><br><span class=\"line\">        circle.extend(arr)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">8</span>):</span><br><span class=\"line\">            j=<span class=\"number\">0</span></span><br><span class=\"line\">            sum=<span class=\"number\">0</span></span><br><span class=\"line\">            bit_num=<span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> j&lt;<span class=\"number\">8</span>:</span><br><span class=\"line\">                sum+=circle[i+j]&lt;&lt;bit_num</span><br><span class=\"line\">                bit_num+=<span class=\"number\">1</span></span><br><span class=\"line\">                j+=<span class=\"number\">1</span></span><br><span class=\"line\">            values.append(sum)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> min(values)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取值r的二进制中1的位数</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calc_sum</span><span class=\"params\">(self,r)</span>:</span></span><br><span class=\"line\">        num=<span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span>(r):</span><br><span class=\"line\">            r&amp;=(r<span class=\"number\">-1</span>)</span><br><span class=\"line\">            num+=<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> num</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取图像的LBP原始模式特征</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">lbp_basic</span><span class=\"params\">(self,image_array)</span>:</span></span><br><span class=\"line\">        basic_array=np.zeros(image_array.shape, np.uint8)</span><br><span class=\"line\">        width=image_array.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        height=image_array.shape[<span class=\"number\">1</span>]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,width<span class=\"number\">-1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,height<span class=\"number\">-1</span>):</span><br><span class=\"line\">                sum=self.calute_basic_lbp(image_array,i,j)</span><br><span class=\"line\">                bit_num=<span class=\"number\">0</span></span><br><span class=\"line\">                result=<span class=\"number\">0</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> sum:</span><br><span class=\"line\">                    result+=s&lt;&lt;bit_num</span><br><span class=\"line\">                    bit_num+=<span class=\"number\">1</span></span><br><span class=\"line\">                basic_array[i,j]=result</span><br><span class=\"line\">        <span class=\"keyword\">return</span> basic_array</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#显示图像</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show_image</span><span class=\"params\">(self,image_array)</span>:</span></span><br><span class=\"line\">        plt.imshow(image_array)</span><br><span class=\"line\">        plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    image = <span class=\"string\">'../Image.jpeg'</span></span><br><span class=\"line\">    lbp=LBP()</span><br><span class=\"line\">    img=lbp.describe(image)</span><br><span class=\"line\">    <span class=\"comment\">#获取图像原始LBP特征，并显示其统计直方图与特征图像</span></span><br><span class=\"line\">    basic_array=lbp.lbp_basic(img)</span><br><span class=\"line\">    lbp.show_image(basic_array)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"GLCM\"><a href=\"#GLCM\" class=\"headerlink\" title=\"GLCM\"></a>GLCM</h2><p>灰度共生矩阵（Gray-Level Co-occurrence Matrix）,</p>\n<p>一种描述图像局部区域或整体区域的某像素与相邻像素或一定距离内的像素的灰度关系的矩阵。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding: utf-8</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">from</span> skimage <span class=\"keyword\">import</span> data</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, kernel_size=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    mi, ma = vmin, vmax</span><br><span class=\"line\">    ks = kernel_size</span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># digitize</span></span><br><span class=\"line\">    bins = np.linspace(mi, ma+<span class=\"number\">1</span>, nbit+<span class=\"number\">1</span>)</span><br><span class=\"line\">    gl1 = np.digitize(img, bins) - <span class=\"number\">1</span></span><br><span class=\"line\">    gl2 = np.append(gl1[:,<span class=\"number\">1</span>:], gl1[:,<span class=\"number\">-1</span>:], axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># make glcm</span></span><br><span class=\"line\">    glcm = np.zeros((nbit, nbit, h, w), dtype=np.uint8)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mask = ((gl1==i) &amp; (gl2==j))</span><br><span class=\"line\">            glcm[i,j, mask] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    kernel = np.ones((ks, ks), dtype=np.uint8)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            glcm[i,j] = cv2.filter2D(glcm[i,j], <span class=\"number\">-1</span>, kernel)</span><br><span class=\"line\"></span><br><span class=\"line\">    glcm = glcm.astype(np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> glcm</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_mean</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm mean</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    mean = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mean += glcm[i,j] * i / (nbit)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> mean</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_std</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm std</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    mean = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mean += glcm[i,j] * i / (nbit)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    std2 = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            std2 += (glcm[i,j] * i - mean)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    std = np.sqrt(std2)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> std</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_contrast</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm contrast</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    cont = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            cont += glcm[i,j] * (i-j)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> cont</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_dissimilarity</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm dissimilarity</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    diss = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            diss += glcm[i,j] * np.abs(i-j)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> diss</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_homogeneity</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm homogeneity</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    homo = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            homo += glcm[i,j] / (<span class=\"number\">1.</span>+(i-j)**<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> homo</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_ASM</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm asm, energy</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    asm = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            asm  += glcm[i,j]**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    ene = np.sqrt(asm)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> asm, ene</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_max</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm max</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    max_  = np.max(glcm, axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> max_</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_entropy</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm entropy</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    pnorm = glcm / np.sum(glcm, axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>)) + <span class=\"number\">1.</span>/ks**<span class=\"number\">2</span></span><br><span class=\"line\">    ent  = np.sum(-pnorm * np.log(pnorm), axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ent</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    nbit = <span class=\"number\">8</span></span><br><span class=\"line\">    ks = <span class=\"number\">5</span></span><br><span class=\"line\">    mi, ma = <span class=\"number\">0</span>, <span class=\"number\">255</span></span><br><span class=\"line\"></span><br><span class=\"line\">    tar_f = <span class=\"string\">'../../data/MNIST/processed/training.pt'</span></span><br><span class=\"line\">    imgs, labels = torch.load(tar_f)</span><br><span class=\"line\">    img = imgs[<span class=\"number\">2</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    img = fast_glcm_mean(img, vmin=mi, vmax=ma, nbit=nbit, ks=ks)</span><br><span class=\"line\">    plt.imshow(img)</span><br><span class=\"line\">    plt.title(<span class=\"string\">'after'</span>)</span><br><span class=\"line\">    plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"GIST\"><a href=\"#GIST\" class=\"headerlink\" title=\"GIST\"></a>GIST</h2><p>一种宏观意义的场景特征描述。</p>\n<p>只识别’大街上有一些行人’这个场景，无需知道图像中在那些位置有多少人，或者有其他什么对象。</p>\n<p>GIST特征向量可以一定程度表征这种宏观场景特征。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"特征工程\"><a href=\"#特征工程\" class=\"headerlink\" title=\"特征工程\"></a>特征工程</h1><h2 id=\"SIFT\"><a href=\"#SIFT\" class=\"headerlink\" title=\"SIFT\"></a>SIFT</h2><p>尺度不变特征转换(Scale-invariant feature transform).</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># @Author  : Edlison</span></span><br><span class=\"line\"><span class=\"comment\"># @Date    : 5/30/21 23:26</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Load</span></span><br><span class=\"line\">imgname = <span class=\"string\">'Image.jpeg'</span></span><br><span class=\"line\">sift = cv2.SIFT_create()</span><br><span class=\"line\">img = cv2.imread(imgname)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Calculate</span></span><br><span class=\"line\">gray = cv2.cvtColor(img.numpy(), cv2.COLOR_BGR2GRAY)</span><br><span class=\"line\">kp, des = sift.detectAndCompute(img, <span class=\"literal\">None</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Draw sift</span></span><br><span class=\"line\">img1 = cv2.drawKeypoints(gray, kp, img, color=(<span class=\"number\">255</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">plt.imshow(img1)</span><br><span class=\"line\">plt.title(<span class=\"string\">'after'</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n<p>调用cv2中的SIFT算法。</p>\n<ol>\n<li>读取图片，cv读取通道默认是BGR，需要手动转换为RGB或其他。</li>\n<li>计算keypoints</li>\n<li>在原图上画出keypoints，可以选择keypoint的color或者flag。</li>\n</ol>\n<h2 id=\"LBP\"><a href=\"#LBP\" class=\"headerlink\" title=\"LBP\"></a>LBP</h2><p>局部二值模型（Local Binary Pattern）.</p>\n<p>是一种用来描述图像局部纹理特征的算子，它具有<strong>旋转不变性</strong>和<strong>灰度不变性</strong>的特点。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">from</span> PIL <span class=\"keyword\">import</span> Image</span><br><span class=\"line\"><span class=\"keyword\">from</span> pylab <span class=\"keyword\">import</span>*</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LBP</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        super()</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"comment\">#将图像载入，并转化为灰度图，获取图像灰度图的像素信息</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">describe</span><span class=\"params\">(self,image)</span>:</span></span><br><span class=\"line\">        image_array=np.array(Image.open(image).convert(<span class=\"string\">'L'</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> image_array</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#图像的LBP原始特征计算算法：将图像指定位置的像素与周围8个像素比较</span></span><br><span class=\"line\">    <span class=\"comment\">#比中心像素大的点赋值为1，比中心像素小的赋值为0，返回得到的二进制序列</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calute_basic_lbp</span><span class=\"params\">(self,image_array,i,j)</span>:</span></span><br><span class=\"line\">        sum=[]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i<span class=\"number\">-1</span>,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j<span class=\"number\">-1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> image_array[i+<span class=\"number\">1</span>,j+<span class=\"number\">1</span>]&gt;image_array[i,j]:</span><br><span class=\"line\">            sum.append(<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            sum.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sum</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#获取二进制序列进行不断环形旋转得到新的二进制序列的最小十进制值</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_min_for_revolve</span><span class=\"params\">(self,arr)</span>:</span> </span><br><span class=\"line\">        values=[]</span><br><span class=\"line\">        circle=arr</span><br><span class=\"line\">        circle.extend(arr)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">8</span>):</span><br><span class=\"line\">            j=<span class=\"number\">0</span></span><br><span class=\"line\">            sum=<span class=\"number\">0</span></span><br><span class=\"line\">            bit_num=<span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> j&lt;<span class=\"number\">8</span>:</span><br><span class=\"line\">                sum+=circle[i+j]&lt;&lt;bit_num</span><br><span class=\"line\">                bit_num+=<span class=\"number\">1</span></span><br><span class=\"line\">                j+=<span class=\"number\">1</span></span><br><span class=\"line\">            values.append(sum)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> min(values)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取值r的二进制中1的位数</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">calc_sum</span><span class=\"params\">(self,r)</span>:</span></span><br><span class=\"line\">        num=<span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span>(r):</span><br><span class=\"line\">            r&amp;=(r<span class=\"number\">-1</span>)</span><br><span class=\"line\">            num+=<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> num</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#获取图像的LBP原始模式特征</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">lbp_basic</span><span class=\"params\">(self,image_array)</span>:</span></span><br><span class=\"line\">        basic_array=np.zeros(image_array.shape, np.uint8)</span><br><span class=\"line\">        width=image_array.shape[<span class=\"number\">0</span>]</span><br><span class=\"line\">        height=image_array.shape[<span class=\"number\">1</span>]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,width<span class=\"number\">-1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,height<span class=\"number\">-1</span>):</span><br><span class=\"line\">                sum=self.calute_basic_lbp(image_array,i,j)</span><br><span class=\"line\">                bit_num=<span class=\"number\">0</span></span><br><span class=\"line\">                result=<span class=\"number\">0</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> sum:</span><br><span class=\"line\">                    result+=s&lt;&lt;bit_num</span><br><span class=\"line\">                    bit_num+=<span class=\"number\">1</span></span><br><span class=\"line\">                basic_array[i,j]=result</span><br><span class=\"line\">        <span class=\"keyword\">return</span> basic_array</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#显示图像</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show_image</span><span class=\"params\">(self,image_array)</span>:</span></span><br><span class=\"line\">        plt.imshow(image_array)</span><br><span class=\"line\">        plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    image = <span class=\"string\">'../Image.jpeg'</span></span><br><span class=\"line\">    lbp=LBP()</span><br><span class=\"line\">    img=lbp.describe(image)</span><br><span class=\"line\">    <span class=\"comment\">#获取图像原始LBP特征，并显示其统计直方图与特征图像</span></span><br><span class=\"line\">    basic_array=lbp.lbp_basic(img)</span><br><span class=\"line\">    lbp.show_image(basic_array)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"GLCM\"><a href=\"#GLCM\" class=\"headerlink\" title=\"GLCM\"></a>GLCM</h2><p>灰度共生矩阵（Gray-Level Co-occurrence Matrix）,</p>\n<p>一种描述图像局部区域或整体区域的某像素与相邻像素或一定距离内的像素的灰度关系的矩阵。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding: utf-8</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">from</span> skimage <span class=\"keyword\">import</span> data</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, kernel_size=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    mi, ma = vmin, vmax</span><br><span class=\"line\">    ks = kernel_size</span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># digitize</span></span><br><span class=\"line\">    bins = np.linspace(mi, ma+<span class=\"number\">1</span>, nbit+<span class=\"number\">1</span>)</span><br><span class=\"line\">    gl1 = np.digitize(img, bins) - <span class=\"number\">1</span></span><br><span class=\"line\">    gl2 = np.append(gl1[:,<span class=\"number\">1</span>:], gl1[:,<span class=\"number\">-1</span>:], axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># make glcm</span></span><br><span class=\"line\">    glcm = np.zeros((nbit, nbit, h, w), dtype=np.uint8)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mask = ((gl1==i) &amp; (gl2==j))</span><br><span class=\"line\">            glcm[i,j, mask] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    kernel = np.ones((ks, ks), dtype=np.uint8)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            glcm[i,j] = cv2.filter2D(glcm[i,j], <span class=\"number\">-1</span>, kernel)</span><br><span class=\"line\"></span><br><span class=\"line\">    glcm = glcm.astype(np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> glcm</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_mean</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm mean</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    mean = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mean += glcm[i,j] * i / (nbit)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> mean</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_std</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm std</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    mean = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            mean += glcm[i,j] * i / (nbit)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    std2 = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            std2 += (glcm[i,j] * i - mean)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    std = np.sqrt(std2)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> std</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_contrast</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm contrast</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    cont = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            cont += glcm[i,j] * (i-j)**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> cont</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_dissimilarity</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm dissimilarity</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    diss = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            diss += glcm[i,j] * np.abs(i-j)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> diss</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_homogeneity</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm homogeneity</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    homo = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            homo += glcm[i,j] / (<span class=\"number\">1.</span>+(i-j)**<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> homo</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_ASM</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm asm, energy</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    h,w = img.shape</span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    asm = np.zeros((h,w), dtype=np.float32)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(nbit):</span><br><span class=\"line\">            asm  += glcm[i,j]**<span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">    ene = np.sqrt(asm)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> asm, ene</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_max</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm max</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    max_  = np.max(glcm, axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> max_</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fast_glcm_entropy</span><span class=\"params\">(img, vmin=<span class=\"number\">0</span>, vmax=<span class=\"number\">255</span>, nbit=<span class=\"number\">8</span>, ks=<span class=\"number\">5</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">    calc glcm entropy</span></span><br><span class=\"line\"><span class=\"string\">    '''</span></span><br><span class=\"line\">    glcm = fast_glcm(img, vmin, vmax, nbit, ks)</span><br><span class=\"line\">    pnorm = glcm / np.sum(glcm, axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>)) + <span class=\"number\">1.</span>/ks**<span class=\"number\">2</span></span><br><span class=\"line\">    ent  = np.sum(-pnorm * np.log(pnorm), axis=(<span class=\"number\">0</span>,<span class=\"number\">1</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ent</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    nbit = <span class=\"number\">8</span></span><br><span class=\"line\">    ks = <span class=\"number\">5</span></span><br><span class=\"line\">    mi, ma = <span class=\"number\">0</span>, <span class=\"number\">255</span></span><br><span class=\"line\"></span><br><span class=\"line\">    tar_f = <span class=\"string\">'../../data/MNIST/processed/training.pt'</span></span><br><span class=\"line\">    imgs, labels = torch.load(tar_f)</span><br><span class=\"line\">    img = imgs[<span class=\"number\">2</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    img = fast_glcm_mean(img, vmin=mi, vmax=ma, nbit=nbit, ks=ks)</span><br><span class=\"line\">    plt.imshow(img)</span><br><span class=\"line\">    plt.title(<span class=\"string\">'after'</span>)</span><br><span class=\"line\">    plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"GIST\"><a href=\"#GIST\" class=\"headerlink\" title=\"GIST\"></a>GIST</h2><p>一种宏观意义的场景特征描述。</p>\n<p>只识别’大街上有一些行人’这个场景，无需知道图像中在那些位置有多少人，或者有其他什么对象。</p>\n<p>GIST特征向量可以一定程度表征这种宏观场景特征。</p>\n"},{"title":"GAN","_content":"\n# 图片Img数组的取值范围及含义\n\nLoader返回的值形式为[batch, channel, row, col]. (N * C * H * W)\n\nchannel：通道数，**通道的维度上就保存了各个通道上的值**，如RGB。\n\ntorchvision.transforms中的`.toTensor()`就是将图片的[0, 255]范围转换为了Tensor上的[0.0, 1.0]。因此mnist数据集中每个像素点上的值在[0, 1]区间上。\n\n# G 与 D 进行两次前向传播\n\n**两次的参数均独立生成。**\n\n```python\n# G的前向传播\nnoise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\ng_loss = sef.bce_loss(d_fake, real_label)\n# 训练G\n...\n# D的前向传播\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\nd_real = self.D(real_imgs)\nd_loss_fake = self.bce_loss(d_fake, fake_label)\nd_loss_real = self.bce_loss(d_real, real_label)\nd_loss = d_loss_fake + d_loss_real\n# 训练D\n...\n```\n\n**注意：**\n\n每一次进行前向计算的参数都是独立的参数，在生成计算图时都是独立的。因此，如果计算后一个网络的时候还传的是一开始的`gen_imgs`其实没有变化，指向的还是同一个参数。但是如果再次让`noise`经过G生成一个`gen_imgs`，因为G已经更新过了，此时的`gen_imgs`也发生了变化，因此再进行前向传播，生成的就是另外一个计算图了。\n\n因此这种情况根本不需要再第一次反向传播的时候设置`retain_graph=True`.\n\n# G 与 D 只进行一次前向传播\n\n**共用一次前向计算的参数。**\n\n```python\n# 参数只进行一次前向传播\nnoise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\nd_real = self.D(real_imgs)\n\ng_loss = self.bce_loss(d_fake, real_label)\nd_loss_fake = self.bce_loss(d_fake, fake_label)\nd_loss_real = self.bce_loss(d_real, real_label)\nd_loss = d_loss_fake + d_loss_real\n# 同时训练\n```\n\n\n\n## 方法一（错误的）\n\n两个网络**同时训练**的参数的优化器同时梯度清零->损失反向传播->梯度下降，此时的网络无法得到优化。而且此时因为两个loss的反向传播有重合的部分，必须要`retain_graph=True`。\n\n```python\nself.optimizer_G.zero_grad()\nself.optimizer_D.zero_grad()\ng_loss.backward(retain_graph=True)\nd_loss.backward()\nself.optimizer_G.step()\nself.optimizer_D.step()\n```\n\n**注意：**\n\n此时根本不会对网络有优化的作用，并没有产生‘对抗’的效果。\n\n## 方法二\n\n两个网络**先后训练**，先优化G，后优化D。但是此时loss反向传播时，仍然会有参数重复计算梯度且没有更新的部分（网络D中的参数）。必须要在先进行反向传播的loss加上`retain_graph=True`.\n\n```python\nself.optimizer_G.zero_grad()\ng_loss.backward(retain_graph=True)\nself.optimizer_G.step()\n\nself.optimizer_D.zero_grad()\nd_loss.backward()\nself.optimizer_D.step()\n```\n\n**注意：**\n\n这种方法更注重的是**二次**求导，也就是原计算图保存的是`g_loss`对网络D中参数的梯度，然后叠加上`d_loss`对网络D中参数的梯度。一并对网络D的参数进行更新。\n\n# Conv2d\n\n```python\nnn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)\n```\n\nin_channels: 输入通道数。\n\nout_channels: 输出通道数。\n\nkernel_size: 卷积核大小。（如果长宽不一样，传一个tuple）\n\nstride: 卷积核移动步长。\n\npadding: 图片上下左右的填充。\n\n输入的shape应该是：[batch_size, channels, height, weight]\n\n# 思考\n\nGAN这种结构最大的问题就是虽然**可以生成很相似的东西**，但是如果生成的东西有很强的类别属性，**无法指定生成的类别**。\n\nOptimizer**优化器就是训练网络**，虽然进入网络的样本也被装入了`Variable`计算图中，其实际上不会被更新，如果没有设置`requires_grad=False`本质上还是会被计算梯度的，因此对非网络中的参数指定不计算梯度，可以提升运行效率。\n\n`retain_graph`实质上是**对计算图进行保留**，由于训练基本上是不断生成一个计算图然后反向传播，默认在反向传播后就抛弃掉了这个计算图结构。\n\n只进行一次前向计算就是**同时训练两个网络**（训练网络D并不是在更新了网络G的基础上）；进行两次前向计算就是**分别训练两个网络**（训练网络D是在网络G更新的基础上）。\n\n保留计算图或不保留计算图的本质就在于，对网络D的更新是否**叠加**上了网络G更新时反向传播的`g_loss`对网络D中参数的梯度。（**不是计算二阶导数！**）\n\n网络的最后一层要在[0, 1]上，由于没有用卷积，在数字意外部分多还是噪声的影响大，因此造成了数字以外区域黑白。\n\nbatch大小的调整直接影响到了权重的迭代。（问题就出在batch=10000忘记调回来了！！！）：很大的一个作用是可以在一个epoch上迭代很多次！！！\n\n# 问题\n\nshape操作 reshape, view, squeeze, flatten...\n\n共享内存 如(a.view(-1, 1)/ b = a.view(-1, 1)) a内存中的tensor都会变吗，还是只有b拿到了？inplace\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?q=batch%20size&utm_content=search_suggestion&type=content\n\nhttps://blog.csdn.net/weixin_43202635/article/details/84204180\n\n\n\n","source":"_posts/paper_exp/gan.md","raw":"---\ntitle: GAN\ncategories:\n- Paper\ntags:\n- gan\n---\n\n# 图片Img数组的取值范围及含义\n\nLoader返回的值形式为[batch, channel, row, col]. (N * C * H * W)\n\nchannel：通道数，**通道的维度上就保存了各个通道上的值**，如RGB。\n\ntorchvision.transforms中的`.toTensor()`就是将图片的[0, 255]范围转换为了Tensor上的[0.0, 1.0]。因此mnist数据集中每个像素点上的值在[0, 1]区间上。\n\n# G 与 D 进行两次前向传播\n\n**两次的参数均独立生成。**\n\n```python\n# G的前向传播\nnoise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\ng_loss = sef.bce_loss(d_fake, real_label)\n# 训练G\n...\n# D的前向传播\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\nd_real = self.D(real_imgs)\nd_loss_fake = self.bce_loss(d_fake, fake_label)\nd_loss_real = self.bce_loss(d_real, real_label)\nd_loss = d_loss_fake + d_loss_real\n# 训练D\n...\n```\n\n**注意：**\n\n每一次进行前向计算的参数都是独立的参数，在生成计算图时都是独立的。因此，如果计算后一个网络的时候还传的是一开始的`gen_imgs`其实没有变化，指向的还是同一个参数。但是如果再次让`noise`经过G生成一个`gen_imgs`，因为G已经更新过了，此时的`gen_imgs`也发生了变化，因此再进行前向传播，生成的就是另外一个计算图了。\n\n因此这种情况根本不需要再第一次反向传播的时候设置`retain_graph=True`.\n\n# G 与 D 只进行一次前向传播\n\n**共用一次前向计算的参数。**\n\n```python\n# 参数只进行一次前向传播\nnoise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()\ngen_imgs = self.G(noise)\nd_fake = self.D(gen_imgs)\nd_real = self.D(real_imgs)\n\ng_loss = self.bce_loss(d_fake, real_label)\nd_loss_fake = self.bce_loss(d_fake, fake_label)\nd_loss_real = self.bce_loss(d_real, real_label)\nd_loss = d_loss_fake + d_loss_real\n# 同时训练\n```\n\n\n\n## 方法一（错误的）\n\n两个网络**同时训练**的参数的优化器同时梯度清零->损失反向传播->梯度下降，此时的网络无法得到优化。而且此时因为两个loss的反向传播有重合的部分，必须要`retain_graph=True`。\n\n```python\nself.optimizer_G.zero_grad()\nself.optimizer_D.zero_grad()\ng_loss.backward(retain_graph=True)\nd_loss.backward()\nself.optimizer_G.step()\nself.optimizer_D.step()\n```\n\n**注意：**\n\n此时根本不会对网络有优化的作用，并没有产生‘对抗’的效果。\n\n## 方法二\n\n两个网络**先后训练**，先优化G，后优化D。但是此时loss反向传播时，仍然会有参数重复计算梯度且没有更新的部分（网络D中的参数）。必须要在先进行反向传播的loss加上`retain_graph=True`.\n\n```python\nself.optimizer_G.zero_grad()\ng_loss.backward(retain_graph=True)\nself.optimizer_G.step()\n\nself.optimizer_D.zero_grad()\nd_loss.backward()\nself.optimizer_D.step()\n```\n\n**注意：**\n\n这种方法更注重的是**二次**求导，也就是原计算图保存的是`g_loss`对网络D中参数的梯度，然后叠加上`d_loss`对网络D中参数的梯度。一并对网络D的参数进行更新。\n\n# Conv2d\n\n```python\nnn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)\n```\n\nin_channels: 输入通道数。\n\nout_channels: 输出通道数。\n\nkernel_size: 卷积核大小。（如果长宽不一样，传一个tuple）\n\nstride: 卷积核移动步长。\n\npadding: 图片上下左右的填充。\n\n输入的shape应该是：[batch_size, channels, height, weight]\n\n# 思考\n\nGAN这种结构最大的问题就是虽然**可以生成很相似的东西**，但是如果生成的东西有很强的类别属性，**无法指定生成的类别**。\n\nOptimizer**优化器就是训练网络**，虽然进入网络的样本也被装入了`Variable`计算图中，其实际上不会被更新，如果没有设置`requires_grad=False`本质上还是会被计算梯度的，因此对非网络中的参数指定不计算梯度，可以提升运行效率。\n\n`retain_graph`实质上是**对计算图进行保留**，由于训练基本上是不断生成一个计算图然后反向传播，默认在反向传播后就抛弃掉了这个计算图结构。\n\n只进行一次前向计算就是**同时训练两个网络**（训练网络D并不是在更新了网络G的基础上）；进行两次前向计算就是**分别训练两个网络**（训练网络D是在网络G更新的基础上）。\n\n保留计算图或不保留计算图的本质就在于，对网络D的更新是否**叠加**上了网络G更新时反向传播的`g_loss`对网络D中参数的梯度。（**不是计算二阶导数！**）\n\n网络的最后一层要在[0, 1]上，由于没有用卷积，在数字意外部分多还是噪声的影响大，因此造成了数字以外区域黑白。\n\nbatch大小的调整直接影响到了权重的迭代。（问题就出在batch=10000忘记调回来了！！！）：很大的一个作用是可以在一个epoch上迭代很多次！！！\n\n# 问题\n\nshape操作 reshape, view, squeeze, flatten...\n\n共享内存 如(a.view(-1, 1)/ b = a.view(-1, 1)) a内存中的tensor都会变吗，还是只有b拿到了？inplace\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?q=batch%20size&utm_content=search_suggestion&type=content\n\nhttps://blog.csdn.net/weixin_43202635/article/details/84204180\n\n\n\n","slug":"paper_exp/gan","published":1,"date":"2021-02-04T02:50:20.323Z","updated":"2021-02-10T18:31:36.694Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981p00bl018o52ne4zqz","content":"<h1 id=\"图片Img数组的取值范围及含义\"><a href=\"#图片Img数组的取值范围及含义\" class=\"headerlink\" title=\"图片Img数组的取值范围及含义\"></a>图片Img数组的取值范围及含义</h1><p>Loader返回的值形式为[batch, channel, row, col]. (N * C * H * W)</p>\n<p>channel：通道数，<strong>通道的维度上就保存了各个通道上的值</strong>，如RGB。</p>\n<p>torchvision.transforms中的<code>.toTensor()</code>就是将图片的[0, 255]范围转换为了Tensor上的[0.0, 1.0]。因此mnist数据集中每个像素点上的值在[0, 1]区间上。</p>\n<h1 id=\"G-与-D-进行两次前向传播\"><a href=\"#G-与-D-进行两次前向传播\" class=\"headerlink\" title=\"G 与 D 进行两次前向传播\"></a>G 与 D 进行两次前向传播</h1><p><strong>两次的参数均独立生成。</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># G的前向传播</span></span><br><span class=\"line\">noise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()</span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">g_loss = sef.bce_loss(d_fake, real_label)</span><br><span class=\"line\"><span class=\"comment\"># 训练G</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\"># D的前向传播</span></span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">d_real = self.D(real_imgs)</span><br><span class=\"line\">d_loss_fake = self.bce_loss(d_fake, fake_label)</span><br><span class=\"line\">d_loss_real = self.bce_loss(d_real, real_label)</span><br><span class=\"line\">d_loss = d_loss_fake + d_loss_real</span><br><span class=\"line\"><span class=\"comment\"># 训练D</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>每一次进行前向计算的参数都是独立的参数，在生成计算图时都是独立的。因此，如果计算后一个网络的时候还传的是一开始的<code>gen_imgs</code>其实没有变化，指向的还是同一个参数。但是如果再次让<code>noise</code>经过G生成一个<code>gen_imgs</code>，因为G已经更新过了，此时的<code>gen_imgs</code>也发生了变化，因此再进行前向传播，生成的就是另外一个计算图了。</p>\n<p>因此这种情况根本不需要再第一次反向传播的时候设置<code>retain_graph=True</code>.</p>\n<h1 id=\"G-与-D-只进行一次前向传播\"><a href=\"#G-与-D-只进行一次前向传播\" class=\"headerlink\" title=\"G 与 D 只进行一次前向传播\"></a>G 与 D 只进行一次前向传播</h1><p><strong>共用一次前向计算的参数。</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 参数只进行一次前向传播</span></span><br><span class=\"line\">noise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()</span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">d_real = self.D(real_imgs)</span><br><span class=\"line\"></span><br><span class=\"line\">g_loss = self.bce_loss(d_fake, real_label)</span><br><span class=\"line\">d_loss_fake = self.bce_loss(d_fake, fake_label)</span><br><span class=\"line\">d_loss_real = self.bce_loss(d_real, real_label)</span><br><span class=\"line\">d_loss = d_loss_fake + d_loss_real</span><br><span class=\"line\"><span class=\"comment\"># 同时训练</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"方法一（错误的）\"><a href=\"#方法一（错误的）\" class=\"headerlink\" title=\"方法一（错误的）\"></a>方法一（错误的）</h2><p>两个网络<strong>同时训练</strong>的参数的优化器同时梯度清零-&gt;损失反向传播-&gt;梯度下降，此时的网络无法得到优化。而且此时因为两个loss的反向传播有重合的部分，必须要<code>retain_graph=True</code>。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.optimizer_G.zero_grad()</span><br><span class=\"line\">self.optimizer_D.zero_grad()</span><br><span class=\"line\">g_loss.backward(retain_graph=<span class=\"literal\">True</span>)</span><br><span class=\"line\">d_loss.backward()</span><br><span class=\"line\">self.optimizer_G.step()</span><br><span class=\"line\">self.optimizer_D.step()</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>此时根本不会对网络有优化的作用，并没有产生‘对抗’的效果。</p>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><p>两个网络<strong>先后训练</strong>，先优化G，后优化D。但是此时loss反向传播时，仍然会有参数重复计算梯度且没有更新的部分（网络D中的参数）。必须要在先进行反向传播的loss加上<code>retain_graph=True</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.optimizer_G.zero_grad()</span><br><span class=\"line\">g_loss.backward(retain_graph=<span class=\"literal\">True</span>)</span><br><span class=\"line\">self.optimizer_G.step()</span><br><span class=\"line\"></span><br><span class=\"line\">self.optimizer_D.zero_grad()</span><br><span class=\"line\">d_loss.backward()</span><br><span class=\"line\">self.optimizer_D.step()</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>这种方法更注重的是<strong>二次</strong>求导，也就是原计算图保存的是<code>g_loss</code>对网络D中参数的梯度，然后叠加上<code>d_loss</code>对网络D中参数的梯度。一并对网络D的参数进行更新。</p>\n<h1 id=\"Conv2d\"><a href=\"#Conv2d\" class=\"headerlink\" title=\"Conv2d\"></a>Conv2d</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)</span><br></pre></td></tr></table></figure>\n\n<p>in_channels: 输入通道数。</p>\n<p>out_channels: 输出通道数。</p>\n<p>kernel_size: 卷积核大小。（如果长宽不一样，传一个tuple）</p>\n<p>stride: 卷积核移动步长。</p>\n<p>padding: 图片上下左右的填充。</p>\n<p>输入的shape应该是：[batch_size, channels, height, weight]</p>\n<h1 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h1><p>GAN这种结构最大的问题就是虽然<strong>可以生成很相似的东西</strong>，但是如果生成的东西有很强的类别属性，<strong>无法指定生成的类别</strong>。</p>\n<p>Optimizer<strong>优化器就是训练网络</strong>，虽然进入网络的样本也被装入了<code>Variable</code>计算图中，其实际上不会被更新，如果没有设置<code>requires_grad=False</code>本质上还是会被计算梯度的，因此对非网络中的参数指定不计算梯度，可以提升运行效率。</p>\n<p><code>retain_graph</code>实质上是<strong>对计算图进行保留</strong>，由于训练基本上是不断生成一个计算图然后反向传播，默认在反向传播后就抛弃掉了这个计算图结构。</p>\n<p>只进行一次前向计算就是<strong>同时训练两个网络</strong>（训练网络D并不是在更新了网络G的基础上）；进行两次前向计算就是<strong>分别训练两个网络</strong>（训练网络D是在网络G更新的基础上）。</p>\n<p>保留计算图或不保留计算图的本质就在于，对网络D的更新是否<strong>叠加</strong>上了网络G更新时反向传播的<code>g_loss</code>对网络D中参数的梯度。（<strong>不是计算二阶导数！</strong>）</p>\n<p>网络的最后一层要在[0, 1]上，由于没有用卷积，在数字意外部分多还是噪声的影响大，因此造成了数字以外区域黑白。</p>\n<p>batch大小的调整直接影响到了权重的迭代。（问题就出在batch=10000忘记调回来了！！！）：很大的一个作用是可以在一个epoch上迭代很多次！！！</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>shape操作 reshape, view, squeeze, flatten…</p>\n<p>共享内存 如(a.view(-1, 1)/ b = a.view(-1, 1)) a内存中的tensor都会变吗，还是只有b拿到了？inplace</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPWJhdGNoJTIwc2l6ZSZhbXA7dXRtX2NvbnRlbnQ9c2VhcmNoX3N1Z2dlc3Rpb24mYW1wO3R5cGU9Y29udGVudA==\">https://www.zhihu.com/search?q=batch%20size&amp;utm_content=search_suggestion&amp;type=content<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzIwMjYzNS9hcnRpY2xlL2RldGFpbHMvODQyMDQxODA=\">https://blog.csdn.net/weixin_43202635/article/details/84204180<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"图片Img数组的取值范围及含义\"><a href=\"#图片Img数组的取值范围及含义\" class=\"headerlink\" title=\"图片Img数组的取值范围及含义\"></a>图片Img数组的取值范围及含义</h1><p>Loader返回的值形式为[batch, channel, row, col]. (N * C * H * W)</p>\n<p>channel：通道数，<strong>通道的维度上就保存了各个通道上的值</strong>，如RGB。</p>\n<p>torchvision.transforms中的<code>.toTensor()</code>就是将图片的[0, 255]范围转换为了Tensor上的[0.0, 1.0]。因此mnist数据集中每个像素点上的值在[0, 1]区间上。</p>\n<h1 id=\"G-与-D-进行两次前向传播\"><a href=\"#G-与-D-进行两次前向传播\" class=\"headerlink\" title=\"G 与 D 进行两次前向传播\"></a>G 与 D 进行两次前向传播</h1><p><strong>两次的参数均独立生成。</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># G的前向传播</span></span><br><span class=\"line\">noise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()</span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">g_loss = sef.bce_loss(d_fake, real_label)</span><br><span class=\"line\"><span class=\"comment\"># 训练G</span></span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\"># D的前向传播</span></span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">d_real = self.D(real_imgs)</span><br><span class=\"line\">d_loss_fake = self.bce_loss(d_fake, fake_label)</span><br><span class=\"line\">d_loss_real = self.bce_loss(d_real, real_label)</span><br><span class=\"line\">d_loss = d_loss_fake + d_loss_real</span><br><span class=\"line\"><span class=\"comment\"># 训练D</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>每一次进行前向计算的参数都是独立的参数，在生成计算图时都是独立的。因此，如果计算后一个网络的时候还传的是一开始的<code>gen_imgs</code>其实没有变化，指向的还是同一个参数。但是如果再次让<code>noise</code>经过G生成一个<code>gen_imgs</code>，因为G已经更新过了，此时的<code>gen_imgs</code>也发生了变化，因此再进行前向传播，生成的就是另外一个计算图了。</p>\n<p>因此这种情况根本不需要再第一次反向传播的时候设置<code>retain_graph=True</code>.</p>\n<h1 id=\"G-与-D-只进行一次前向传播\"><a href=\"#G-与-D-只进行一次前向传播\" class=\"headerlink\" title=\"G 与 D 只进行一次前向传播\"></a>G 与 D 只进行一次前向传播</h1><p><strong>共用一次前向计算的参数。</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 参数只进行一次前向传播</span></span><br><span class=\"line\">noise = torch.autograd.Variable(torch.randn(imgs_batch, self.latent_dim)).cuda()</span><br><span class=\"line\">gen_imgs = self.G(noise)</span><br><span class=\"line\">d_fake = self.D(gen_imgs)</span><br><span class=\"line\">d_real = self.D(real_imgs)</span><br><span class=\"line\"></span><br><span class=\"line\">g_loss = self.bce_loss(d_fake, real_label)</span><br><span class=\"line\">d_loss_fake = self.bce_loss(d_fake, fake_label)</span><br><span class=\"line\">d_loss_real = self.bce_loss(d_real, real_label)</span><br><span class=\"line\">d_loss = d_loss_fake + d_loss_real</span><br><span class=\"line\"><span class=\"comment\"># 同时训练</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"方法一（错误的）\"><a href=\"#方法一（错误的）\" class=\"headerlink\" title=\"方法一（错误的）\"></a>方法一（错误的）</h2><p>两个网络<strong>同时训练</strong>的参数的优化器同时梯度清零-&gt;损失反向传播-&gt;梯度下降，此时的网络无法得到优化。而且此时因为两个loss的反向传播有重合的部分，必须要<code>retain_graph=True</code>。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.optimizer_G.zero_grad()</span><br><span class=\"line\">self.optimizer_D.zero_grad()</span><br><span class=\"line\">g_loss.backward(retain_graph=<span class=\"literal\">True</span>)</span><br><span class=\"line\">d_loss.backward()</span><br><span class=\"line\">self.optimizer_G.step()</span><br><span class=\"line\">self.optimizer_D.step()</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>此时根本不会对网络有优化的作用，并没有产生‘对抗’的效果。</p>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><p>两个网络<strong>先后训练</strong>，先优化G，后优化D。但是此时loss反向传播时，仍然会有参数重复计算梯度且没有更新的部分（网络D中的参数）。必须要在先进行反向传播的loss加上<code>retain_graph=True</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.optimizer_G.zero_grad()</span><br><span class=\"line\">g_loss.backward(retain_graph=<span class=\"literal\">True</span>)</span><br><span class=\"line\">self.optimizer_G.step()</span><br><span class=\"line\"></span><br><span class=\"line\">self.optimizer_D.zero_grad()</span><br><span class=\"line\">d_loss.backward()</span><br><span class=\"line\">self.optimizer_D.step()</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<p>这种方法更注重的是<strong>二次</strong>求导，也就是原计算图保存的是<code>g_loss</code>对网络D中参数的梯度，然后叠加上<code>d_loss</code>对网络D中参数的梯度。一并对网络D的参数进行更新。</p>\n<h1 id=\"Conv2d\"><a href=\"#Conv2d\" class=\"headerlink\" title=\"Conv2d\"></a>Conv2d</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)</span><br></pre></td></tr></table></figure>\n\n<p>in_channels: 输入通道数。</p>\n<p>out_channels: 输出通道数。</p>\n<p>kernel_size: 卷积核大小。（如果长宽不一样，传一个tuple）</p>\n<p>stride: 卷积核移动步长。</p>\n<p>padding: 图片上下左右的填充。</p>\n<p>输入的shape应该是：[batch_size, channels, height, weight]</p>\n<h1 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h1><p>GAN这种结构最大的问题就是虽然<strong>可以生成很相似的东西</strong>，但是如果生成的东西有很强的类别属性，<strong>无法指定生成的类别</strong>。</p>\n<p>Optimizer<strong>优化器就是训练网络</strong>，虽然进入网络的样本也被装入了<code>Variable</code>计算图中，其实际上不会被更新，如果没有设置<code>requires_grad=False</code>本质上还是会被计算梯度的，因此对非网络中的参数指定不计算梯度，可以提升运行效率。</p>\n<p><code>retain_graph</code>实质上是<strong>对计算图进行保留</strong>，由于训练基本上是不断生成一个计算图然后反向传播，默认在反向传播后就抛弃掉了这个计算图结构。</p>\n<p>只进行一次前向计算就是<strong>同时训练两个网络</strong>（训练网络D并不是在更新了网络G的基础上）；进行两次前向计算就是<strong>分别训练两个网络</strong>（训练网络D是在网络G更新的基础上）。</p>\n<p>保留计算图或不保留计算图的本质就在于，对网络D的更新是否<strong>叠加</strong>上了网络G更新时反向传播的<code>g_loss</code>对网络D中参数的梯度。（<strong>不是计算二阶导数！</strong>）</p>\n<p>网络的最后一层要在[0, 1]上，由于没有用卷积，在数字意外部分多还是噪声的影响大，因此造成了数字以外区域黑白。</p>\n<p>batch大小的调整直接影响到了权重的迭代。（问题就出在batch=10000忘记调回来了！！！）：很大的一个作用是可以在一个epoch上迭代很多次！！！</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>shape操作 reshape, view, squeeze, flatten…</p>\n<p>共享内存 如(a.view(-1, 1)/ b = a.view(-1, 1)) a内存中的tensor都会变吗，还是只有b拿到了？inplace</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPWJhdGNoJTIwc2l6ZSZhbXA7dXRtX2NvbnRlbnQ9c2VhcmNoX3N1Z2dlc3Rpb24mYW1wO3R5cGU9Y29udGVudA==\">https://www.zhihu.com/search?q=batch%20size&amp;utm_content=search_suggestion&amp;type=content<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzIwMjYzNS9hcnRpY2xlL2RldGFpbHMvODQyMDQxODA=\">https://blog.csdn.net/weixin_43202635/article/details/84204180<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Numpy训练实例\n\n## 绘制Sigmoid函数与ReLU函数\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# 设置图片大小\nplt.figure(figsize=(8, 3))\n\n# x为1维数组\nx = np.arange(-10, 10, 0.1)\n\n# Sigmoid函数\ns = 1. / (1 + np.exp(-x))\n\n# ReLU函数\ny = np.clip(x, a_min=0., a_max=None)\n\n# 绘制Sigmoid函数\nf = plt.subplot(121)\nplt.plot(x, s, color='r')\nplt.text(-5, 0.9, r'$y=\\sigma(x)$', fontsize=13)\ncurrentAxis = plt.gca()\ncurrentAxis.xaxis.set_label_text('x', fontsize=15)\ncurrentAxis.yaxis.set_label_text('y', fontsize=15)\n\n# 绘制ReLU函数\nf = plt.subplot(122)\nplt.plot(x, y, color='g')\nplt.text(-3, 9, r'$y=ReLU(x)$', fontsize=13)\ncurrentAxis = plt.gca()\ncurrentAxis.xaxis.set_label_text('x', fontsize=15)\ncurrentAxis.yaxis.set_label_text('y', fontsize=15)\n\nplt.show()\n```","source":"_posts/ml/numpy-training.md","raw":"# Numpy训练实例\n\n## 绘制Sigmoid函数与ReLU函数\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# 设置图片大小\nplt.figure(figsize=(8, 3))\n\n# x为1维数组\nx = np.arange(-10, 10, 0.1)\n\n# Sigmoid函数\ns = 1. / (1 + np.exp(-x))\n\n# ReLU函数\ny = np.clip(x, a_min=0., a_max=None)\n\n# 绘制Sigmoid函数\nf = plt.subplot(121)\nplt.plot(x, s, color='r')\nplt.text(-5, 0.9, r'$y=\\sigma(x)$', fontsize=13)\ncurrentAxis = plt.gca()\ncurrentAxis.xaxis.set_label_text('x', fontsize=15)\ncurrentAxis.yaxis.set_label_text('y', fontsize=15)\n\n# 绘制ReLU函数\nf = plt.subplot(122)\nplt.plot(x, y, color='g')\nplt.text(-3, 9, r'$y=ReLU(x)$', fontsize=13)\ncurrentAxis = plt.gca()\ncurrentAxis.xaxis.set_label_text('x', fontsize=15)\ncurrentAxis.yaxis.set_label_text('y', fontsize=15)\n\nplt.show()\n```","slug":"ml/numpy-training","published":1,"date":"2020-04-24T14:42:57.056Z","updated":"2020-04-24T14:46:01.346Z","title":"ml/numpy-training","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981t00bn018ob7qggtbu","content":"<h1 id=\"Numpy训练实例\"><a href=\"#Numpy训练实例\" class=\"headerlink\" title=\"Numpy训练实例\"></a>Numpy训练实例</h1><h2 id=\"绘制Sigmoid函数与ReLU函数\"><a href=\"#绘制Sigmoid函数与ReLU函数\" class=\"headerlink\" title=\"绘制Sigmoid函数与ReLU函数\"></a>绘制Sigmoid函数与ReLU函数</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置图片大小</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">3</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># x为1维数组</span></span><br><span class=\"line\">x = np.arange(<span class=\"number\">-10</span>, <span class=\"number\">10</span>, <span class=\"number\">0.1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Sigmoid函数</span></span><br><span class=\"line\">s = <span class=\"number\">1.</span> / (<span class=\"number\">1</span> + np.exp(-x))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ReLU函数</span></span><br><span class=\"line\">y = np.clip(x, a_min=<span class=\"number\">0.</span>, a_max=<span class=\"literal\">None</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制Sigmoid函数</span></span><br><span class=\"line\">f = plt.subplot(<span class=\"number\">121</span>)</span><br><span class=\"line\">plt.plot(x, s, color=<span class=\"string\">'r'</span>)</span><br><span class=\"line\">plt.text(<span class=\"number\">-5</span>, <span class=\"number\">0.9</span>, <span class=\"string\">r'$y=\\sigma(x)$'</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">currentAxis = plt.gca()</span><br><span class=\"line\">currentAxis.xaxis.set_label_text(<span class=\"string\">'x'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">currentAxis.yaxis.set_label_text(<span class=\"string\">'y'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制ReLU函数</span></span><br><span class=\"line\">f = plt.subplot(<span class=\"number\">122</span>)</span><br><span class=\"line\">plt.plot(x, y, color=<span class=\"string\">'g'</span>)</span><br><span class=\"line\">plt.text(<span class=\"number\">-3</span>, <span class=\"number\">9</span>, <span class=\"string\">r'$y=ReLU(x)$'</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">currentAxis = plt.gca()</span><br><span class=\"line\">currentAxis.xaxis.set_label_text(<span class=\"string\">'x'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">currentAxis.yaxis.set_label_text(<span class=\"string\">'y'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Numpy训练实例\"><a href=\"#Numpy训练实例\" class=\"headerlink\" title=\"Numpy训练实例\"></a>Numpy训练实例</h1><h2 id=\"绘制Sigmoid函数与ReLU函数\"><a href=\"#绘制Sigmoid函数与ReLU函数\" class=\"headerlink\" title=\"绘制Sigmoid函数与ReLU函数\"></a>绘制Sigmoid函数与ReLU函数</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置图片大小</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">3</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># x为1维数组</span></span><br><span class=\"line\">x = np.arange(<span class=\"number\">-10</span>, <span class=\"number\">10</span>, <span class=\"number\">0.1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Sigmoid函数</span></span><br><span class=\"line\">s = <span class=\"number\">1.</span> / (<span class=\"number\">1</span> + np.exp(-x))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ReLU函数</span></span><br><span class=\"line\">y = np.clip(x, a_min=<span class=\"number\">0.</span>, a_max=<span class=\"literal\">None</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制Sigmoid函数</span></span><br><span class=\"line\">f = plt.subplot(<span class=\"number\">121</span>)</span><br><span class=\"line\">plt.plot(x, s, color=<span class=\"string\">'r'</span>)</span><br><span class=\"line\">plt.text(<span class=\"number\">-5</span>, <span class=\"number\">0.9</span>, <span class=\"string\">r'$y=\\sigma(x)$'</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">currentAxis = plt.gca()</span><br><span class=\"line\">currentAxis.xaxis.set_label_text(<span class=\"string\">'x'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">currentAxis.yaxis.set_label_text(<span class=\"string\">'y'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制ReLU函数</span></span><br><span class=\"line\">f = plt.subplot(<span class=\"number\">122</span>)</span><br><span class=\"line\">plt.plot(x, y, color=<span class=\"string\">'g'</span>)</span><br><span class=\"line\">plt.text(<span class=\"number\">-3</span>, <span class=\"number\">9</span>, <span class=\"string\">r'$y=ReLU(x)$'</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">currentAxis = plt.gca()</span><br><span class=\"line\">currentAxis.xaxis.set_label_text(<span class=\"string\">'x'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">currentAxis.yaxis.set_label_text(<span class=\"string\">'y'</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>"},{"title":"卷积与反卷积","_content":"\n# 卷积\n\n","source":"_posts/paper_exp/conv.md","raw":"---\ntitle: 卷积与反卷积\ncategories:\n- Paper\ntags:\n- conv\n---\n\n# 卷积\n\n","slug":"paper_exp/conv","published":1,"date":"2021-02-13T04:27:38.211Z","updated":"2021-02-13T04:28:35.246Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981u00bq018oadnb1qkz","content":"<h1 id=\"卷积\"><a href=\"#卷积\" class=\"headerlink\" title=\"卷积\"></a>卷积</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"卷积\"><a href=\"#卷积\" class=\"headerlink\" title=\"卷积\"></a>卷积</h1>"},{"title":"logits的含义","_content":"\nlogits一般是全连接层的输出，不必关心其值在[0, 1]之间，或者相加为1。\n\n但是logits经过Softmax层后又很容易变为表示概率的值。\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/question/60751553","source":"_posts/paper_exp/logits.md","raw":"---\ntitle: logits的含义\ncategories:\n- Paper\n---\n\nlogits一般是全连接层的输出，不必关心其值在[0, 1]之间，或者相加为1。\n\n但是logits经过Softmax层后又很容易变为表示概率的值。\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/question/60751553","slug":"paper_exp/logits","published":1,"date":"2021-05-11T12:03:48.362Z","updated":"2021-05-11T12:07:18.173Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981v00bt018o3pr6fwt1","content":"<p>logits一般是全连接层的输出，不必关心其值在[0, 1]之间，或者相加为1。</p>\n<p>但是logits经过Softmax层后又很容易变为表示概率的值。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzYwNzUxNTUz\">https://www.zhihu.com/question/60751553<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<p>logits一般是全连接层的输出，不必关心其值在[0, 1]之间，或者相加为1。</p>\n<p>但是logits经过Softmax层后又很容易变为表示概率的值。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzYwNzUxNTUz\">https://www.zhihu.com/question/60751553<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"几个损失函数","_content":"\n# XE\n\n可以是one_hot矩阵与一个对应的index向量？","source":"_posts/paper_exp/loss.md","raw":"---\ntitle: 几个损失函数\ncategories:\n- Paper\ntags:\n- loss\n---\n\n# XE\n\n可以是one_hot矩阵与一个对应的index向量？","slug":"paper_exp/loss","published":1,"date":"2021-02-13T08:04:17.595Z","updated":"2021-02-13T08:05:24.335Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981v00bx018o92n9bq3m","content":"<h1 id=\"XE\"><a href=\"#XE\" class=\"headerlink\" title=\"XE\"></a>XE</h1><p>可以是one_hot矩阵与一个对应的index向量？</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"XE\"><a href=\"#XE\" class=\"headerlink\" title=\"XE\"></a>XE</h1><p>可以是one_hot矩阵与一个对应的index向量？</p>\n"},{"title":"一些数学概念","_content":"\n# 范数\n\n## 向量范数\n\n### 1-norm\n\n$$\n\\parallel x\\parallel_1 = \\sum_{i=1}^N\\vert x_i\\vert\n$$\n\n元素绝对值之和。\n\n### 2-norm\n\n$$\n\\parallel x\\parallel = \\sqrt{\\sum_{i=1}^Nx_i^2}\n$$\n\n欧几里得范数，元素绝对值的平方再开方。\n$$\n\\parallel x\\parallel_\\infin = \\max_i\\vert x_i\\vert\n$$\n$\\infin$范数，所有元素中绝对值的最大值。\n$$\n\\parallel x\\parallel_{-\\infin} = \\min_i\\vert x_i\\vert\n$$\n$-\\infin$范数，所有元素中绝对值最小的值。\n\n## p-norm\n\n$$\n\\parallel x\\parallel_p = {(\\sum_{i=1}^N\\vert x_i\\vert^p)}^{1/p}\n$$\n\n元素的p次方和1/p次幂。\n\n## 矩阵范数\n\n...\n\n# 距离\n\n## 欧氏距离\n\n$$\nD(X,Y) = \\sqrt{\\sum_{i=1}^n(x_i-y_i)^2}\n$$\n\n## 明可夫斯基距离\n\n$$\nD(X,Y) = (\\sum_{i=1}^n\\vert x_i-y_i\\vert^p)^{1/p}\n$$\n\n当p=2时，就是欧氏距离。\n\n## 曼哈顿距离\n\n$$\nD(X,Y) = \\sum_{i=1}^n\\vert x_i-y_i\\vert\n$$\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/6e5dff42a77e\n\nhttps://blog.csdn.net/susanzhang1231/article/details/52127011\n\nhttps://zhuanlan.zhihu.com/p/137073968\n\n","source":"_posts/paper_exp/math.md","raw":"---\ntitle: 一些数学概念\ncategories:\n- Paper\ntags:\n- math\n---\n\n# 范数\n\n## 向量范数\n\n### 1-norm\n\n$$\n\\parallel x\\parallel_1 = \\sum_{i=1}^N\\vert x_i\\vert\n$$\n\n元素绝对值之和。\n\n### 2-norm\n\n$$\n\\parallel x\\parallel = \\sqrt{\\sum_{i=1}^Nx_i^2}\n$$\n\n欧几里得范数，元素绝对值的平方再开方。\n$$\n\\parallel x\\parallel_\\infin = \\max_i\\vert x_i\\vert\n$$\n$\\infin$范数，所有元素中绝对值的最大值。\n$$\n\\parallel x\\parallel_{-\\infin} = \\min_i\\vert x_i\\vert\n$$\n$-\\infin$范数，所有元素中绝对值最小的值。\n\n## p-norm\n\n$$\n\\parallel x\\parallel_p = {(\\sum_{i=1}^N\\vert x_i\\vert^p)}^{1/p}\n$$\n\n元素的p次方和1/p次幂。\n\n## 矩阵范数\n\n...\n\n# 距离\n\n## 欧氏距离\n\n$$\nD(X,Y) = \\sqrt{\\sum_{i=1}^n(x_i-y_i)^2}\n$$\n\n## 明可夫斯基距离\n\n$$\nD(X,Y) = (\\sum_{i=1}^n\\vert x_i-y_i\\vert^p)^{1/p}\n$$\n\n当p=2时，就是欧氏距离。\n\n## 曼哈顿距离\n\n$$\nD(X,Y) = \\sum_{i=1}^n\\vert x_i-y_i\\vert\n$$\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.jianshu.com/p/6e5dff42a77e\n\nhttps://blog.csdn.net/susanzhang1231/article/details/52127011\n\nhttps://zhuanlan.zhihu.com/p/137073968\n\n","slug":"paper_exp/math","published":1,"date":"2021-02-24T17:38:49.803Z","updated":"2021-02-24T18:10:04.560Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981x00bz018o8o1j0cd9","content":"<h1 id=\"范数\"><a href=\"#范数\" class=\"headerlink\" title=\"范数\"></a>范数</h1><h2 id=\"向量范数\"><a href=\"#向量范数\" class=\"headerlink\" title=\"向量范数\"></a>向量范数</h2><h3 id=\"1-norm\"><a href=\"#1-norm\" class=\"headerlink\" title=\"1-norm\"></a>1-norm</h3><p>$$<br>\\parallel x\\parallel_1 = \\sum_{i=1}^N\\vert x_i\\vert<br>$$</p>\n<p>元素绝对值之和。</p>\n<h3 id=\"2-norm\"><a href=\"#2-norm\" class=\"headerlink\" title=\"2-norm\"></a>2-norm</h3><p>$$<br>\\parallel x\\parallel = \\sqrt{\\sum_{i=1}^Nx_i^2}<br>$$</p>\n<p>欧几里得范数，元素绝对值的平方再开方。<br>$$<br>\\parallel x\\parallel_\\infin = \\max_i\\vert x_i\\vert<br>$$<br>$\\infin$范数，所有元素中绝对值的最大值。<br>$$<br>\\parallel x\\parallel_{-\\infin} = \\min_i\\vert x_i\\vert<br>$$<br>$-\\infin$范数，所有元素中绝对值最小的值。</p>\n<h2 id=\"p-norm\"><a href=\"#p-norm\" class=\"headerlink\" title=\"p-norm\"></a>p-norm</h2><p>$$<br>\\parallel x\\parallel_p = {(\\sum_{i=1}^N\\vert x_i\\vert^p)}^{1/p}<br>$$</p>\n<p>元素的p次方和1/p次幂。</p>\n<h2 id=\"矩阵范数\"><a href=\"#矩阵范数\" class=\"headerlink\" title=\"矩阵范数\"></a>矩阵范数</h2><p>…</p>\n<h1 id=\"距离\"><a href=\"#距离\" class=\"headerlink\" title=\"距离\"></a>距离</h1><h2 id=\"欧氏距离\"><a href=\"#欧氏距离\" class=\"headerlink\" title=\"欧氏距离\"></a>欧氏距离</h2><p>$$<br>D(X,Y) = \\sqrt{\\sum_{i=1}^n(x_i-y_i)^2}<br>$$</p>\n<h2 id=\"明可夫斯基距离\"><a href=\"#明可夫斯基距离\" class=\"headerlink\" title=\"明可夫斯基距离\"></a>明可夫斯基距离</h2><p>$$<br>D(X,Y) = (\\sum_{i=1}^n\\vert x_i-y_i\\vert^p)^{1/p}<br>$$</p>\n<p>当p=2时，就是欧氏距离。</p>\n<h2 id=\"曼哈顿距离\"><a href=\"#曼哈顿距离\" class=\"headerlink\" title=\"曼哈顿距离\"></a>曼哈顿距离</h2><p>$$<br>D(X,Y) = \\sum_{i=1}^n\\vert x_i-y_i\\vert<br>$$</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82ZTVkZmY0MmE3N2U=\">https://www.jianshu.com/p/6e5dff42a77e<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1c2FuemhhbmcxMjMxL2FydGljbGUvZGV0YWlscy81MjEyNzAxMQ==\">https://blog.csdn.net/susanzhang1231/article/details/52127011<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xMzcwNzM5Njg=\">https://zhuanlan.zhihu.com/p/137073968<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"范数\"><a href=\"#范数\" class=\"headerlink\" title=\"范数\"></a>范数</h1><h2 id=\"向量范数\"><a href=\"#向量范数\" class=\"headerlink\" title=\"向量范数\"></a>向量范数</h2><h3 id=\"1-norm\"><a href=\"#1-norm\" class=\"headerlink\" title=\"1-norm\"></a>1-norm</h3><p>$$<br>\\parallel x\\parallel_1 = \\sum_{i=1}^N\\vert x_i\\vert<br>$$</p>\n<p>元素绝对值之和。</p>\n<h3 id=\"2-norm\"><a href=\"#2-norm\" class=\"headerlink\" title=\"2-norm\"></a>2-norm</h3><p>$$<br>\\parallel x\\parallel = \\sqrt{\\sum_{i=1}^Nx_i^2}<br>$$</p>\n<p>欧几里得范数，元素绝对值的平方再开方。<br>$$<br>\\parallel x\\parallel_\\infin = \\max_i\\vert x_i\\vert<br>$$<br>$\\infin$范数，所有元素中绝对值的最大值。<br>$$<br>\\parallel x\\parallel_{-\\infin} = \\min_i\\vert x_i\\vert<br>$$<br>$-\\infin$范数，所有元素中绝对值最小的值。</p>\n<h2 id=\"p-norm\"><a href=\"#p-norm\" class=\"headerlink\" title=\"p-norm\"></a>p-norm</h2><p>$$<br>\\parallel x\\parallel_p = {(\\sum_{i=1}^N\\vert x_i\\vert^p)}^{1/p}<br>$$</p>\n<p>元素的p次方和1/p次幂。</p>\n<h2 id=\"矩阵范数\"><a href=\"#矩阵范数\" class=\"headerlink\" title=\"矩阵范数\"></a>矩阵范数</h2><p>…</p>\n<h1 id=\"距离\"><a href=\"#距离\" class=\"headerlink\" title=\"距离\"></a>距离</h1><h2 id=\"欧氏距离\"><a href=\"#欧氏距离\" class=\"headerlink\" title=\"欧氏距离\"></a>欧氏距离</h2><p>$$<br>D(X,Y) = \\sqrt{\\sum_{i=1}^n(x_i-y_i)^2}<br>$$</p>\n<h2 id=\"明可夫斯基距离\"><a href=\"#明可夫斯基距离\" class=\"headerlink\" title=\"明可夫斯基距离\"></a>明可夫斯基距离</h2><p>$$<br>D(X,Y) = (\\sum_{i=1}^n\\vert x_i-y_i\\vert^p)^{1/p}<br>$$</p>\n<p>当p=2时，就是欧氏距离。</p>\n<h2 id=\"曼哈顿距离\"><a href=\"#曼哈顿距离\" class=\"headerlink\" title=\"曼哈顿距离\"></a>曼哈顿距离</h2><p>$$<br>D(X,Y) = \\sum_{i=1}^n\\vert x_i-y_i\\vert<br>$$</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82ZTVkZmY0MmE3N2U=\">https://www.jianshu.com/p/6e5dff42a77e<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1c2FuemhhbmcxMjMxL2FydGljbGUvZGV0YWlscy81MjEyNzAxMQ==\">https://blog.csdn.net/susanzhang1231/article/details/52127011<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xMzcwNzM5Njg=\">https://zhuanlan.zhihu.com/p/137073968<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"在GAN上实现Multi-View","_content":"\n# 遇到的坑\n\n## 网络的组合\n\n用列表的数据结构，存储Module。\n\n使用 Python 的 list 添加的全连接层和它们的 parameters **并没有自动注册**到我们的网络中。\n\n**解决方案：**如果想要继承了nn.Module的网络组合多个子网络，需要通过`nn.Sequential`, `nn.ModuleList`等**对网络参数进行注册**。\n\n## 计算Loss的两个Tensor形状不一致\n\n由于通过网络经过各种**矩阵相乘**，最后得到的结果是一个二维的Tensor。自己定义的real_label是一个一维的Tensor。`torch.Size([256])` 不等于 `torch.Size([256, 1])`.\n\n```python\ng_loss = self.losser.get_loss(d_fake, real_label)\n```\n\n**解决方案：**在网络D最后的输出使用`.squeeze()`对维度值为1的维度进行挤压。\n\n# 注意\n\n对在每个View上的数据，使用list或tuple的数据结构进行存储，不必再转到Tensor上。\n\n使用Processor再训练(train)过程中对数据进行处理，虽然可能会影响效率，但是是最方便的实现方法，在Pytorch的DataLoader只能返回Batch_size的数据，无法再加一个维度，保存View。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://discuss.pytorch.org/t/when-should-i-use-nn-modulelist-and-when-should-i-use-nn-sequential/5463","source":"_posts/paper_exp/mv_gan.md","raw":"---\ntitle: 在GAN上实现Multi-View\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n- gan\n- multi_view\n---\n\n# 遇到的坑\n\n## 网络的组合\n\n用列表的数据结构，存储Module。\n\n使用 Python 的 list 添加的全连接层和它们的 parameters **并没有自动注册**到我们的网络中。\n\n**解决方案：**如果想要继承了nn.Module的网络组合多个子网络，需要通过`nn.Sequential`, `nn.ModuleList`等**对网络参数进行注册**。\n\n## 计算Loss的两个Tensor形状不一致\n\n由于通过网络经过各种**矩阵相乘**，最后得到的结果是一个二维的Tensor。自己定义的real_label是一个一维的Tensor。`torch.Size([256])` 不等于 `torch.Size([256, 1])`.\n\n```python\ng_loss = self.losser.get_loss(d_fake, real_label)\n```\n\n**解决方案：**在网络D最后的输出使用`.squeeze()`对维度值为1的维度进行挤压。\n\n# 注意\n\n对在每个View上的数据，使用list或tuple的数据结构进行存储，不必再转到Tensor上。\n\n使用Processor再训练(train)过程中对数据进行处理，虽然可能会影响效率，但是是最方便的实现方法，在Pytorch的DataLoader只能返回Batch_size的数据，无法再加一个维度，保存View。\n\n\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://discuss.pytorch.org/t/when-should-i-use-nn-modulelist-and-when-should-i-use-nn-sequential/5463","slug":"paper_exp/mv_gan","published":1,"date":"2021-02-09T10:52:45.139Z","updated":"2021-03-04T06:51:25.178Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981y00c2018obue70btw","content":"<h1 id=\"遇到的坑\"><a href=\"#遇到的坑\" class=\"headerlink\" title=\"遇到的坑\"></a>遇到的坑</h1><h2 id=\"网络的组合\"><a href=\"#网络的组合\" class=\"headerlink\" title=\"网络的组合\"></a>网络的组合</h2><p>用列表的数据结构，存储Module。</p>\n<p>使用 Python 的 list 添加的全连接层和它们的 parameters <strong>并没有自动注册</strong>到我们的网络中。</p>\n<p><strong>解决方案：</strong>如果想要继承了nn.Module的网络组合多个子网络，需要通过<code>nn.Sequential</code>, <code>nn.ModuleList</code>等<strong>对网络参数进行注册</strong>。</p>\n<h2 id=\"计算Loss的两个Tensor形状不一致\"><a href=\"#计算Loss的两个Tensor形状不一致\" class=\"headerlink\" title=\"计算Loss的两个Tensor形状不一致\"></a>计算Loss的两个Tensor形状不一致</h2><p>由于通过网络经过各种<strong>矩阵相乘</strong>，最后得到的结果是一个二维的Tensor。自己定义的real_label是一个一维的Tensor。<code>torch.Size([256])</code> 不等于 <code>torch.Size([256, 1])</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">g_loss = self.losser.get_loss(d_fake, real_label)</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案：</strong>在网络D最后的输出使用<code>.squeeze()</code>对维度值为1的维度进行挤压。</p>\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p>对在每个View上的数据，使用list或tuple的数据结构进行存储，不必再转到Tensor上。</p>\n<p>使用Processor再训练(train)过程中对数据进行处理，虽然可能会影响效率，但是是最方便的实现方法，在Pytorch的DataLoader只能返回Batch_size的数据，无法再加一个维度，保存View。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kaXNjdXNzLnB5dG9yY2gub3JnL3Qvd2hlbi1zaG91bGQtaS11c2Utbm4tbW9kdWxlbGlzdC1hbmQtd2hlbi1zaG91bGQtaS11c2Utbm4tc2VxdWVudGlhbC81NDYz\">https://discuss.pytorch.org/t/when-should-i-use-nn-modulelist-and-when-should-i-use-nn-sequential/5463<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"遇到的坑\"><a href=\"#遇到的坑\" class=\"headerlink\" title=\"遇到的坑\"></a>遇到的坑</h1><h2 id=\"网络的组合\"><a href=\"#网络的组合\" class=\"headerlink\" title=\"网络的组合\"></a>网络的组合</h2><p>用列表的数据结构，存储Module。</p>\n<p>使用 Python 的 list 添加的全连接层和它们的 parameters <strong>并没有自动注册</strong>到我们的网络中。</p>\n<p><strong>解决方案：</strong>如果想要继承了nn.Module的网络组合多个子网络，需要通过<code>nn.Sequential</code>, <code>nn.ModuleList</code>等<strong>对网络参数进行注册</strong>。</p>\n<h2 id=\"计算Loss的两个Tensor形状不一致\"><a href=\"#计算Loss的两个Tensor形状不一致\" class=\"headerlink\" title=\"计算Loss的两个Tensor形状不一致\"></a>计算Loss的两个Tensor形状不一致</h2><p>由于通过网络经过各种<strong>矩阵相乘</strong>，最后得到的结果是一个二维的Tensor。自己定义的real_label是一个一维的Tensor。<code>torch.Size([256])</code> 不等于 <code>torch.Size([256, 1])</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">g_loss = self.losser.get_loss(d_fake, real_label)</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决方案：</strong>在网络D最后的输出使用<code>.squeeze()</code>对维度值为1的维度进行挤压。</p>\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p>对在每个View上的数据，使用list或tuple的数据结构进行存储，不必再转到Tensor上。</p>\n<p>使用Processor再训练(train)过程中对数据进行处理，虽然可能会影响效率，但是是最方便的实现方法，在Pytorch的DataLoader只能返回Batch_size的数据，无法再加一个维度，保存View。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kaXNjdXNzLnB5dG9yY2gub3JnL3Qvd2hlbi1zaG91bGQtaS11c2Utbm4tbW9kdWxlbGlzdC1hbmQtd2hlbi1zaG91bGQtaS11c2Utbm4tc2VxdWVudGlhbC81NDYz\">https://discuss.pytorch.org/t/when-should-i-use-nn-modulelist-and-when-should-i-use-nn-sequential/5463<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"混淆矩阵","_content":"\n# Confusion Matrix 混淆矩阵\n\n| 预测类别\\实际类别 | Positive | Negative |\n| ----------------- | -------- | -------- |\n| Positive          | TP       | FP       |\n| Negative          | FN       | TN       |\n\n纵向是**真实类别**\n\n横向是**预测类别**\n\n左上到右下的对角线上是正确分类的个数。\n\n# 评价指标\n\n## Accuracy 准确率\n\n在全部集合中正确分类的个数占比。\n\n**分类器分对了多少**\n$$\naccuracy = {TP+TN \\over TP+TN+FP+FN}\n$$\n\n\n## Precision 精确率\n\n预测为正向的样本中，预测正确的比例。\n\n**返回的正确的有多少**\n$$\nprecision = {TP\\over TP+FP}\n$$\n\n## Recall 召回率\n\n真实数据集为正向的样本中，预测正确的比例。\n\n**返回的占应该返回的多少**\n$$\nrecall = {TP\\over TP+FN}\n$$\n\n## F1 精确率与召回率的调和平均\n\n由于不能单纯的看精确率与召回率，因此需要对这两个值进行调和平均。\n$$\nF_1 = {2*Precision*Recall\\over Precision+Recall}\n$$\n\n$$\nF_\\beta = {(1+\\beta^2)*{Precision*Recall\\over \\beta^2*Precision+Recall}}\n$$\n\n\n比如在医疗领域，我们会对模糊的案例也判为正向，不放过每一个可能，因此就**需要召回率的权重更大**。\n\n## 注意\n\n1. 精确率与召回率属于一个**此消彼长**的关系，反应的结果会很片面。如果我们预测的结果全部设为正确，那么**召回率就会很高**，但是**精确率就会很低**；如果真实数据集中全部是正向的样本，那么**精确率就会很高**，**召回率就会很低**。\n2. 如果是N分类问题那么可以计算**宏观的(macro)指标**，就是各个分类相对于正确分类的值；也可以计算**微观的(micro)指标**，就是只保留分类正确或错误的个数，转化为TP, TN, FP, FN.\n3. 如果分类器最后只返回一个类别的label, 那么准确率，精确率，召回率都相等？\n\n# ROC AUC\n\n分类器返回的结果是一个概率值。我们通过不断改变阈值，来影响分类结果（大于阈值则为正向，小于阈值则为负向），从而计算各个阈值下的混淆矩阵。\n\n把所有的混淆矩阵表示在一个二维空间，就是ROC(Receiver Operator Characteristic)曲线。\n\nTPR预测为正向的占真实正向的比例；FPR预测为正向的占真实负向的比例。\n$$\nTPR = {TP\\over TP+FN}\n$$\n\n$$\nFPR = {FP\\over FP+TN}\n$$\n\n坐标轴上横轴是：FPR，纵轴是：TPR。我们想让TPR尽可能的大，FPR尽可能的小。\n\nAUC就是ROC曲线与`x`轴围成的面积。\n\n## N分类\n\n宏观：对于每一个类别都可以画一个ROC曲线，最后在所有类别上做某种平均。\n\n微观：转化为正确分类的概率与其他的概率。\n\n![image-20210224235712286](/Users/edlison/Library/Application Support/typora-user-images/image-20210224235712286.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/paper_exp/metric.md","raw":"---\ntitle: 混淆矩阵\ncategories:\n- Paper\ntags:\n- metric\n---\n\n# Confusion Matrix 混淆矩阵\n\n| 预测类别\\实际类别 | Positive | Negative |\n| ----------------- | -------- | -------- |\n| Positive          | TP       | FP       |\n| Negative          | FN       | TN       |\n\n纵向是**真实类别**\n\n横向是**预测类别**\n\n左上到右下的对角线上是正确分类的个数。\n\n# 评价指标\n\n## Accuracy 准确率\n\n在全部集合中正确分类的个数占比。\n\n**分类器分对了多少**\n$$\naccuracy = {TP+TN \\over TP+TN+FP+FN}\n$$\n\n\n## Precision 精确率\n\n预测为正向的样本中，预测正确的比例。\n\n**返回的正确的有多少**\n$$\nprecision = {TP\\over TP+FP}\n$$\n\n## Recall 召回率\n\n真实数据集为正向的样本中，预测正确的比例。\n\n**返回的占应该返回的多少**\n$$\nrecall = {TP\\over TP+FN}\n$$\n\n## F1 精确率与召回率的调和平均\n\n由于不能单纯的看精确率与召回率，因此需要对这两个值进行调和平均。\n$$\nF_1 = {2*Precision*Recall\\over Precision+Recall}\n$$\n\n$$\nF_\\beta = {(1+\\beta^2)*{Precision*Recall\\over \\beta^2*Precision+Recall}}\n$$\n\n\n比如在医疗领域，我们会对模糊的案例也判为正向，不放过每一个可能，因此就**需要召回率的权重更大**。\n\n## 注意\n\n1. 精确率与召回率属于一个**此消彼长**的关系，反应的结果会很片面。如果我们预测的结果全部设为正确，那么**召回率就会很高**，但是**精确率就会很低**；如果真实数据集中全部是正向的样本，那么**精确率就会很高**，**召回率就会很低**。\n2. 如果是N分类问题那么可以计算**宏观的(macro)指标**，就是各个分类相对于正确分类的值；也可以计算**微观的(micro)指标**，就是只保留分类正确或错误的个数，转化为TP, TN, FP, FN.\n3. 如果分类器最后只返回一个类别的label, 那么准确率，精确率，召回率都相等？\n\n# ROC AUC\n\n分类器返回的结果是一个概率值。我们通过不断改变阈值，来影响分类结果（大于阈值则为正向，小于阈值则为负向），从而计算各个阈值下的混淆矩阵。\n\n把所有的混淆矩阵表示在一个二维空间，就是ROC(Receiver Operator Characteristic)曲线。\n\nTPR预测为正向的占真实正向的比例；FPR预测为正向的占真实负向的比例。\n$$\nTPR = {TP\\over TP+FN}\n$$\n\n$$\nFPR = {FP\\over FP+TN}\n$$\n\n坐标轴上横轴是：FPR，纵轴是：TPR。我们想让TPR尽可能的大，FPR尽可能的小。\n\nAUC就是ROC曲线与`x`轴围成的面积。\n\n## N分类\n\n宏观：对于每一个类别都可以画一个ROC曲线，最后在所有类别上做某种平均。\n\n微观：转化为正确分类的概率与其他的概率。\n\n![image-20210224235712286](/Users/edlison/Library/Application Support/typora-user-images/image-20210224235712286.png)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"paper_exp/metric","published":1,"date":"2021-02-24T14:34:20.237Z","updated":"2021-03-13T10:28:51.445Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx981z00c6018o20sm4xtd","content":"<h1 id=\"Confusion-Matrix-混淆矩阵\"><a href=\"#Confusion-Matrix-混淆矩阵\" class=\"headerlink\" title=\"Confusion Matrix 混淆矩阵\"></a>Confusion Matrix 混淆矩阵</h1><table>\n<thead>\n<tr>\n<th>预测类别\\实际类别</th>\n<th>Positive</th>\n<th>Negative</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Positive</td>\n<td>TP</td>\n<td>FP</td>\n</tr>\n<tr>\n<td>Negative</td>\n<td>FN</td>\n<td>TN</td>\n</tr>\n</tbody></table>\n<p>纵向是<strong>真实类别</strong></p>\n<p>横向是<strong>预测类别</strong></p>\n<p>左上到右下的对角线上是正确分类的个数。</p>\n<h1 id=\"评价指标\"><a href=\"#评价指标\" class=\"headerlink\" title=\"评价指标\"></a>评价指标</h1><h2 id=\"Accuracy-准确率\"><a href=\"#Accuracy-准确率\" class=\"headerlink\" title=\"Accuracy 准确率\"></a>Accuracy 准确率</h2><p>在全部集合中正确分类的个数占比。</p>\n<p><strong>分类器分对了多少</strong><br>$$<br>accuracy = {TP+TN \\over TP+TN+FP+FN}<br>$$</p>\n<h2 id=\"Precision-精确率\"><a href=\"#Precision-精确率\" class=\"headerlink\" title=\"Precision 精确率\"></a>Precision 精确率</h2><p>预测为正向的样本中，预测正确的比例。</p>\n<p><strong>返回的正确的有多少</strong><br>$$<br>precision = {TP\\over TP+FP}<br>$$</p>\n<h2 id=\"Recall-召回率\"><a href=\"#Recall-召回率\" class=\"headerlink\" title=\"Recall 召回率\"></a>Recall 召回率</h2><p>真实数据集为正向的样本中，预测正确的比例。</p>\n<p><strong>返回的占应该返回的多少</strong><br>$$<br>recall = {TP\\over TP+FN}<br>$$</p>\n<h2 id=\"F1-精确率与召回率的调和平均\"><a href=\"#F1-精确率与召回率的调和平均\" class=\"headerlink\" title=\"F1 精确率与召回率的调和平均\"></a>F1 精确率与召回率的调和平均</h2><p>由于不能单纯的看精确率与召回率，因此需要对这两个值进行调和平均。<br>$$<br>F_1 = {2<em>Precision</em>Recall\\over Precision+Recall}<br>$$</p>\n<p>$$<br>F_\\beta = {(1+\\beta^2)<em>{Precision</em>Recall\\over \\beta^2*Precision+Recall}}<br>$$</p>\n<p>比如在医疗领域，我们会对模糊的案例也判为正向，不放过每一个可能，因此就<strong>需要召回率的权重更大</strong>。</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><ol>\n<li>精确率与召回率属于一个<strong>此消彼长</strong>的关系，反应的结果会很片面。如果我们预测的结果全部设为正确，那么<strong>召回率就会很高</strong>，但是<strong>精确率就会很低</strong>；如果真实数据集中全部是正向的样本，那么<strong>精确率就会很高</strong>，<strong>召回率就会很低</strong>。</li>\n<li>如果是N分类问题那么可以计算<strong>宏观的(macro)指标</strong>，就是各个分类相对于正确分类的值；也可以计算<strong>微观的(micro)指标</strong>，就是只保留分类正确或错误的个数，转化为TP, TN, FP, FN.</li>\n<li>如果分类器最后只返回一个类别的label, 那么准确率，精确率，召回率都相等？</li>\n</ol>\n<h1 id=\"ROC-AUC\"><a href=\"#ROC-AUC\" class=\"headerlink\" title=\"ROC AUC\"></a>ROC AUC</h1><p>分类器返回的结果是一个概率值。我们通过不断改变阈值，来影响分类结果（大于阈值则为正向，小于阈值则为负向），从而计算各个阈值下的混淆矩阵。</p>\n<p>把所有的混淆矩阵表示在一个二维空间，就是ROC(Receiver Operator Characteristic)曲线。</p>\n<p>TPR预测为正向的占真实正向的比例；FPR预测为正向的占真实负向的比例。<br>$$<br>TPR = {TP\\over TP+FN}<br>$$</p>\n<p>$$<br>FPR = {FP\\over FP+TN}<br>$$</p>\n<p>坐标轴上横轴是：FPR，纵轴是：TPR。我们想让TPR尽可能的大，FPR尽可能的小。</p>\n<p>AUC就是ROC曲线与<code>x</code>轴围成的面积。</p>\n<h2 id=\"N分类\"><a href=\"#N分类\" class=\"headerlink\" title=\"N分类\"></a>N分类</h2><p>宏观：对于每一个类别都可以画一个ROC曲线，最后在所有类别上做某种平均。</p>\n<p>微观：转化为正确分类的概率与其他的概率。</p>\n<p>![image-20210224235712286](/Users/edlison/Library/Application Support/typora-user-images/image-20210224235712286.png)</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Confusion-Matrix-混淆矩阵\"><a href=\"#Confusion-Matrix-混淆矩阵\" class=\"headerlink\" title=\"Confusion Matrix 混淆矩阵\"></a>Confusion Matrix 混淆矩阵</h1><table>\n<thead>\n<tr>\n<th>预测类别\\实际类别</th>\n<th>Positive</th>\n<th>Negative</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Positive</td>\n<td>TP</td>\n<td>FP</td>\n</tr>\n<tr>\n<td>Negative</td>\n<td>FN</td>\n<td>TN</td>\n</tr>\n</tbody></table>\n<p>纵向是<strong>真实类别</strong></p>\n<p>横向是<strong>预测类别</strong></p>\n<p>左上到右下的对角线上是正确分类的个数。</p>\n<h1 id=\"评价指标\"><a href=\"#评价指标\" class=\"headerlink\" title=\"评价指标\"></a>评价指标</h1><h2 id=\"Accuracy-准确率\"><a href=\"#Accuracy-准确率\" class=\"headerlink\" title=\"Accuracy 准确率\"></a>Accuracy 准确率</h2><p>在全部集合中正确分类的个数占比。</p>\n<p><strong>分类器分对了多少</strong><br>$$<br>accuracy = {TP+TN \\over TP+TN+FP+FN}<br>$$</p>\n<h2 id=\"Precision-精确率\"><a href=\"#Precision-精确率\" class=\"headerlink\" title=\"Precision 精确率\"></a>Precision 精确率</h2><p>预测为正向的样本中，预测正确的比例。</p>\n<p><strong>返回的正确的有多少</strong><br>$$<br>precision = {TP\\over TP+FP}<br>$$</p>\n<h2 id=\"Recall-召回率\"><a href=\"#Recall-召回率\" class=\"headerlink\" title=\"Recall 召回率\"></a>Recall 召回率</h2><p>真实数据集为正向的样本中，预测正确的比例。</p>\n<p><strong>返回的占应该返回的多少</strong><br>$$<br>recall = {TP\\over TP+FN}<br>$$</p>\n<h2 id=\"F1-精确率与召回率的调和平均\"><a href=\"#F1-精确率与召回率的调和平均\" class=\"headerlink\" title=\"F1 精确率与召回率的调和平均\"></a>F1 精确率与召回率的调和平均</h2><p>由于不能单纯的看精确率与召回率，因此需要对这两个值进行调和平均。<br>$$<br>F_1 = {2<em>Precision</em>Recall\\over Precision+Recall}<br>$$</p>\n<p>$$<br>F_\\beta = {(1+\\beta^2)<em>{Precision</em>Recall\\over \\beta^2*Precision+Recall}}<br>$$</p>\n<p>比如在医疗领域，我们会对模糊的案例也判为正向，不放过每一个可能，因此就<strong>需要召回率的权重更大</strong>。</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><ol>\n<li>精确率与召回率属于一个<strong>此消彼长</strong>的关系，反应的结果会很片面。如果我们预测的结果全部设为正确，那么<strong>召回率就会很高</strong>，但是<strong>精确率就会很低</strong>；如果真实数据集中全部是正向的样本，那么<strong>精确率就会很高</strong>，<strong>召回率就会很低</strong>。</li>\n<li>如果是N分类问题那么可以计算<strong>宏观的(macro)指标</strong>，就是各个分类相对于正确分类的值；也可以计算<strong>微观的(micro)指标</strong>，就是只保留分类正确或错误的个数，转化为TP, TN, FP, FN.</li>\n<li>如果分类器最后只返回一个类别的label, 那么准确率，精确率，召回率都相等？</li>\n</ol>\n<h1 id=\"ROC-AUC\"><a href=\"#ROC-AUC\" class=\"headerlink\" title=\"ROC AUC\"></a>ROC AUC</h1><p>分类器返回的结果是一个概率值。我们通过不断改变阈值，来影响分类结果（大于阈值则为正向，小于阈值则为负向），从而计算各个阈值下的混淆矩阵。</p>\n<p>把所有的混淆矩阵表示在一个二维空间，就是ROC(Receiver Operator Characteristic)曲线。</p>\n<p>TPR预测为正向的占真实正向的比例；FPR预测为正向的占真实负向的比例。<br>$$<br>TPR = {TP\\over TP+FN}<br>$$</p>\n<p>$$<br>FPR = {FP\\over FP+TN}<br>$$</p>\n<p>坐标轴上横轴是：FPR，纵轴是：TPR。我们想让TPR尽可能的大，FPR尽可能的小。</p>\n<p>AUC就是ROC曲线与<code>x</code>轴围成的面积。</p>\n<h2 id=\"N分类\"><a href=\"#N分类\" class=\"headerlink\" title=\"N分类\"></a>N分类</h2><p>宏观：对于每一个类别都可以画一个ROC曲线，最后在所有类别上做某种平均。</p>\n<p>微观：转化为正确分类的概率与其他的概率。</p>\n<p>![image-20210224235712286](/Users/edlison/Library/Application Support/typora-user-images/image-20210224235712286.png)</p>\n"},{"title":"搭建MVADG网络","_content":"\n# 遇到的坑\n\n## 1. np.prod()\n\n对传入的list计算乘积，可以指定dim。\n\n## 2. nn.ConvTranspose2d()\n\n反卷积操作。\n\n## 3. argument after * must be an iterable\n\n如果在函数内部使用了*, 对传入的参数进行unpack, 需要注意需要传入一个可以迭代的对象。\n\n```python\ndef Reshape(input, shape):\n  return input.view(input.shape[0], *shape)\n```\n\n如果传的是一个标量，可以将它变为一个tuple传入。\n\n```python\nshape = np.prod([1, 2, 3])\nReshape(input, (shape,))\n```\n\n在传入的shape后加一个`,`就相当于是一个tuple了。\n\n## 4. reduce failed to synchronize: device-side assert triggered.\n\n这是神经网络最后一层没有normalize导致的，可以加一层Sigmoid()解决。\n\n## 5. d_fake的batch_size一直是torch.Size([256, 1])\n\n在计算`bce_loss(d_fake, real_label)`时，生成的d_fake没有与最后一个batch_size匹配。原因在于Net中d_fake是由gen_imgs输入D生成的，而一开始生成的噪声的batch_size决定了gen_imgs的第一维度的大小。\n\n问题出在一开始生成噪声的时候输入的是self.batch_size而不是imgs_batch.\n\n## 6. std evaluated to zero after conversion to torch.int64, leading to division by zero.\n\ndataset在返回数据时通过`transform.Normalize()`时出现的问题。\n\ndataset在读取自制的数据集时，类型转换的问题。需要将文本的`str`格式转成`float`,而不是`int`.\n\n## 7. output with shape [1, 28, 28] doesn't match the broadcast shape [3, 28, 28].\n\n由于MNIST数据集通道的问题。\n\n```python\ntransforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))\n# 改为\ntransforms.Normalize((0.5,), (0.5,))\n```\n\n## 8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load...\n\n由于pytorch版本所致，`torch.save()`, `torch.load()`里面保存了版本信息，不一样的话会报错。\n\n## 9. Only one class present in y_true. ROC AUC score is not defined in that case.\n\n在计算ROC AUC时，如果一个batch中的类别都是同样的，就会报错。\n\n解决方案\n\n- 整理0，1标签数据较为均衡\n- 使用try except然后pass\n\n## 10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑\n\n由于pytorch版本不一样，因此报错！！！\n\n都是Python3.7\n\nPytorch = 1.7.1 (报错)\n\nPytorch = 1.0.0 (不报错)\n\n## 11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑\n\nPytorch = 1.7.1 (指定到有mnist的目录)\n\nPytorch = 1.0.0 (指定到有raw的目录)\n\n","source":"_posts/paper_exp/mvadg.md","raw":"---\ntitle: 搭建MVADG网络\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n- multi_view\n- anomaly\n- gan\n---\n\n# 遇到的坑\n\n## 1. np.prod()\n\n对传入的list计算乘积，可以指定dim。\n\n## 2. nn.ConvTranspose2d()\n\n反卷积操作。\n\n## 3. argument after * must be an iterable\n\n如果在函数内部使用了*, 对传入的参数进行unpack, 需要注意需要传入一个可以迭代的对象。\n\n```python\ndef Reshape(input, shape):\n  return input.view(input.shape[0], *shape)\n```\n\n如果传的是一个标量，可以将它变为一个tuple传入。\n\n```python\nshape = np.prod([1, 2, 3])\nReshape(input, (shape,))\n```\n\n在传入的shape后加一个`,`就相当于是一个tuple了。\n\n## 4. reduce failed to synchronize: device-side assert triggered.\n\n这是神经网络最后一层没有normalize导致的，可以加一层Sigmoid()解决。\n\n## 5. d_fake的batch_size一直是torch.Size([256, 1])\n\n在计算`bce_loss(d_fake, real_label)`时，生成的d_fake没有与最后一个batch_size匹配。原因在于Net中d_fake是由gen_imgs输入D生成的，而一开始生成的噪声的batch_size决定了gen_imgs的第一维度的大小。\n\n问题出在一开始生成噪声的时候输入的是self.batch_size而不是imgs_batch.\n\n## 6. std evaluated to zero after conversion to torch.int64, leading to division by zero.\n\ndataset在返回数据时通过`transform.Normalize()`时出现的问题。\n\ndataset在读取自制的数据集时，类型转换的问题。需要将文本的`str`格式转成`float`,而不是`int`.\n\n## 7. output with shape [1, 28, 28] doesn't match the broadcast shape [3, 28, 28].\n\n由于MNIST数据集通道的问题。\n\n```python\ntransforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))\n# 改为\ntransforms.Normalize((0.5,), (0.5,))\n```\n\n## 8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load...\n\n由于pytorch版本所致，`torch.save()`, `torch.load()`里面保存了版本信息，不一样的话会报错。\n\n## 9. Only one class present in y_true. ROC AUC score is not defined in that case.\n\n在计算ROC AUC时，如果一个batch中的类别都是同样的，就会报错。\n\n解决方案\n\n- 整理0，1标签数据较为均衡\n- 使用try except然后pass\n\n## 10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑\n\n由于pytorch版本不一样，因此报错！！！\n\n都是Python3.7\n\nPytorch = 1.7.1 (报错)\n\nPytorch = 1.0.0 (不报错)\n\n## 11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑\n\nPytorch = 1.7.1 (指定到有mnist的目录)\n\nPytorch = 1.0.0 (指定到有raw的目录)\n\n","slug":"paper_exp/mvadg","published":1,"date":"2021-02-10T18:13:46.678Z","updated":"2021-03-17T16:14:44.480Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982000c9018o78usaxs9","content":"<h1 id=\"遇到的坑\"><a href=\"#遇到的坑\" class=\"headerlink\" title=\"遇到的坑\"></a>遇到的坑</h1><h2 id=\"1-np-prod\"><a href=\"#1-np-prod\" class=\"headerlink\" title=\"1. np.prod()\"></a>1. np.prod()</h2><p>对传入的list计算乘积，可以指定dim。</p>\n<h2 id=\"2-nn-ConvTranspose2d\"><a href=\"#2-nn-ConvTranspose2d\" class=\"headerlink\" title=\"2. nn.ConvTranspose2d()\"></a>2. nn.ConvTranspose2d()</h2><p>反卷积操作。</p>\n<h2 id=\"3-argument-after-must-be-an-iterable\"><a href=\"#3-argument-after-must-be-an-iterable\" class=\"headerlink\" title=\"3. argument after * must be an iterable\"></a>3. argument after * must be an iterable</h2><p>如果在函数内部使用了*, 对传入的参数进行unpack, 需要注意需要传入一个可以迭代的对象。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Reshape</span><span class=\"params\">(input, shape)</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> input.view(input.shape[<span class=\"number\">0</span>], *shape)</span><br></pre></td></tr></table></figure>\n\n<p>如果传的是一个标量，可以将它变为一个tuple传入。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shape = np.prod([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>])</span><br><span class=\"line\">Reshape(input, (shape,))</span><br></pre></td></tr></table></figure>\n\n<p>在传入的shape后加一个<code>,</code>就相当于是一个tuple了。</p>\n<h2 id=\"4-reduce-failed-to-synchronize-device-side-assert-triggered\"><a href=\"#4-reduce-failed-to-synchronize-device-side-assert-triggered\" class=\"headerlink\" title=\"4. reduce failed to synchronize: device-side assert triggered.\"></a>4. reduce failed to synchronize: device-side assert triggered.</h2><p>这是神经网络最后一层没有normalize导致的，可以加一层Sigmoid()解决。</p>\n<h2 id=\"5-d-fake的batch-size一直是torch-Size-256-1\"><a href=\"#5-d-fake的batch-size一直是torch-Size-256-1\" class=\"headerlink\" title=\"5. d_fake的batch_size一直是torch.Size([256, 1])\"></a>5. d_fake的batch_size一直是torch.Size([256, 1])</h2><p>在计算<code>bce_loss(d_fake, real_label)</code>时，生成的d_fake没有与最后一个batch_size匹配。原因在于Net中d_fake是由gen_imgs输入D生成的，而一开始生成的噪声的batch_size决定了gen_imgs的第一维度的大小。</p>\n<p>问题出在一开始生成噪声的时候输入的是self.batch_size而不是imgs_batch.</p>\n<h2 id=\"6-std-evaluated-to-zero-after-conversion-to-torch-int64-leading-to-division-by-zero\"><a href=\"#6-std-evaluated-to-zero-after-conversion-to-torch-int64-leading-to-division-by-zero\" class=\"headerlink\" title=\"6. std evaluated to zero after conversion to torch.int64, leading to division by zero.\"></a>6. std evaluated to zero after conversion to torch.int64, leading to division by zero.</h2><p>dataset在返回数据时通过<code>transform.Normalize()</code>时出现的问题。</p>\n<p>dataset在读取自制的数据集时，类型转换的问题。需要将文本的<code>str</code>格式转成<code>float</code>,而不是<code>int</code>.</p>\n<h2 id=\"7-output-with-shape-1-28-28-doesn’t-match-the-broadcast-shape-3-28-28\"><a href=\"#7-output-with-shape-1-28-28-doesn’t-match-the-broadcast-shape-3-28-28\" class=\"headerlink\" title=\"7. output with shape [1, 28, 28] doesn’t match the broadcast shape [3, 28, 28].\"></a>7. output with shape [1, 28, 28] doesn’t match the broadcast shape [3, 28, 28].</h2><p>由于MNIST数据集通道的问题。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">transforms.Normalize((<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>), (<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>))</span><br><span class=\"line\"><span class=\"comment\"># 改为</span></span><br><span class=\"line\">transforms.Normalize((<span class=\"number\">0.5</span>,), (<span class=\"number\">0.5</span>,))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8-pickle-UnpicklingError-A-load-persistent-id-instruction-was-encountered-but-no-persistent-load…\"><a href=\"#8-pickle-UnpicklingError-A-load-persistent-id-instruction-was-encountered-but-no-persistent-load…\" class=\"headerlink\" title=\"8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load…\"></a>8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load…</h2><p>由于pytorch版本所致，<code>torch.save()</code>, <code>torch.load()</code>里面保存了版本信息，不一样的话会报错。</p>\n<h2 id=\"9-Only-one-class-present-in-y-true-ROC-AUC-score-is-not-defined-in-that-case\"><a href=\"#9-Only-one-class-present-in-y-true-ROC-AUC-score-is-not-defined-in-that-case\" class=\"headerlink\" title=\"9. Only one class present in y_true. ROC AUC score is not defined in that case.\"></a>9. Only one class present in y_true. ROC AUC score is not defined in that case.</h2><p>在计算ROC AUC时，如果一个batch中的类别都是同样的，就会报错。</p>\n<p>解决方案</p>\n<ul>\n<li>整理0，1标签数据较为均衡</li>\n<li>使用try except然后pass</li>\n</ul>\n<h2 id=\"10-one-of-the-variables-needed-for-gradient-computation-has-been-modified-by-an-inplace-operation-由于Pytorch版本的大坑\"><a href=\"#10-one-of-the-variables-needed-for-gradient-computation-has-been-modified-by-an-inplace-operation-由于Pytorch版本的大坑\" class=\"headerlink\" title=\"10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑\"></a>10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑</h2><p>由于pytorch版本不一样，因此报错！！！</p>\n<p>都是Python3.7</p>\n<p>Pytorch = 1.7.1 (报错)</p>\n<p>Pytorch = 1.0.0 (不报错)</p>\n<h2 id=\"11-Pytorch自带的mnist数据集读取库-由于Pytorch版本的坑\"><a href=\"#11-Pytorch自带的mnist数据集读取库-由于Pytorch版本的坑\" class=\"headerlink\" title=\"11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑\"></a>11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑</h2><p>Pytorch = 1.7.1 (指定到有mnist的目录)</p>\n<p>Pytorch = 1.0.0 (指定到有raw的目录)</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"遇到的坑\"><a href=\"#遇到的坑\" class=\"headerlink\" title=\"遇到的坑\"></a>遇到的坑</h1><h2 id=\"1-np-prod\"><a href=\"#1-np-prod\" class=\"headerlink\" title=\"1. np.prod()\"></a>1. np.prod()</h2><p>对传入的list计算乘积，可以指定dim。</p>\n<h2 id=\"2-nn-ConvTranspose2d\"><a href=\"#2-nn-ConvTranspose2d\" class=\"headerlink\" title=\"2. nn.ConvTranspose2d()\"></a>2. nn.ConvTranspose2d()</h2><p>反卷积操作。</p>\n<h2 id=\"3-argument-after-must-be-an-iterable\"><a href=\"#3-argument-after-must-be-an-iterable\" class=\"headerlink\" title=\"3. argument after * must be an iterable\"></a>3. argument after * must be an iterable</h2><p>如果在函数内部使用了*, 对传入的参数进行unpack, 需要注意需要传入一个可以迭代的对象。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Reshape</span><span class=\"params\">(input, shape)</span>:</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> input.view(input.shape[<span class=\"number\">0</span>], *shape)</span><br></pre></td></tr></table></figure>\n\n<p>如果传的是一个标量，可以将它变为一个tuple传入。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shape = np.prod([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>])</span><br><span class=\"line\">Reshape(input, (shape,))</span><br></pre></td></tr></table></figure>\n\n<p>在传入的shape后加一个<code>,</code>就相当于是一个tuple了。</p>\n<h2 id=\"4-reduce-failed-to-synchronize-device-side-assert-triggered\"><a href=\"#4-reduce-failed-to-synchronize-device-side-assert-triggered\" class=\"headerlink\" title=\"4. reduce failed to synchronize: device-side assert triggered.\"></a>4. reduce failed to synchronize: device-side assert triggered.</h2><p>这是神经网络最后一层没有normalize导致的，可以加一层Sigmoid()解决。</p>\n<h2 id=\"5-d-fake的batch-size一直是torch-Size-256-1\"><a href=\"#5-d-fake的batch-size一直是torch-Size-256-1\" class=\"headerlink\" title=\"5. d_fake的batch_size一直是torch.Size([256, 1])\"></a>5. d_fake的batch_size一直是torch.Size([256, 1])</h2><p>在计算<code>bce_loss(d_fake, real_label)</code>时，生成的d_fake没有与最后一个batch_size匹配。原因在于Net中d_fake是由gen_imgs输入D生成的，而一开始生成的噪声的batch_size决定了gen_imgs的第一维度的大小。</p>\n<p>问题出在一开始生成噪声的时候输入的是self.batch_size而不是imgs_batch.</p>\n<h2 id=\"6-std-evaluated-to-zero-after-conversion-to-torch-int64-leading-to-division-by-zero\"><a href=\"#6-std-evaluated-to-zero-after-conversion-to-torch-int64-leading-to-division-by-zero\" class=\"headerlink\" title=\"6. std evaluated to zero after conversion to torch.int64, leading to division by zero.\"></a>6. std evaluated to zero after conversion to torch.int64, leading to division by zero.</h2><p>dataset在返回数据时通过<code>transform.Normalize()</code>时出现的问题。</p>\n<p>dataset在读取自制的数据集时，类型转换的问题。需要将文本的<code>str</code>格式转成<code>float</code>,而不是<code>int</code>.</p>\n<h2 id=\"7-output-with-shape-1-28-28-doesn’t-match-the-broadcast-shape-3-28-28\"><a href=\"#7-output-with-shape-1-28-28-doesn’t-match-the-broadcast-shape-3-28-28\" class=\"headerlink\" title=\"7. output with shape [1, 28, 28] doesn’t match the broadcast shape [3, 28, 28].\"></a>7. output with shape [1, 28, 28] doesn’t match the broadcast shape [3, 28, 28].</h2><p>由于MNIST数据集通道的问题。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">transforms.Normalize((<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>), (<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>))</span><br><span class=\"line\"><span class=\"comment\"># 改为</span></span><br><span class=\"line\">transforms.Normalize((<span class=\"number\">0.5</span>,), (<span class=\"number\">0.5</span>,))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8-pickle-UnpicklingError-A-load-persistent-id-instruction-was-encountered-but-no-persistent-load…\"><a href=\"#8-pickle-UnpicklingError-A-load-persistent-id-instruction-was-encountered-but-no-persistent-load…\" class=\"headerlink\" title=\"8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load…\"></a>8. _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load…</h2><p>由于pytorch版本所致，<code>torch.save()</code>, <code>torch.load()</code>里面保存了版本信息，不一样的话会报错。</p>\n<h2 id=\"9-Only-one-class-present-in-y-true-ROC-AUC-score-is-not-defined-in-that-case\"><a href=\"#9-Only-one-class-present-in-y-true-ROC-AUC-score-is-not-defined-in-that-case\" class=\"headerlink\" title=\"9. Only one class present in y_true. ROC AUC score is not defined in that case.\"></a>9. Only one class present in y_true. ROC AUC score is not defined in that case.</h2><p>在计算ROC AUC时，如果一个batch中的类别都是同样的，就会报错。</p>\n<p>解决方案</p>\n<ul>\n<li>整理0，1标签数据较为均衡</li>\n<li>使用try except然后pass</li>\n</ul>\n<h2 id=\"10-one-of-the-variables-needed-for-gradient-computation-has-been-modified-by-an-inplace-operation-由于Pytorch版本的大坑\"><a href=\"#10-one-of-the-variables-needed-for-gradient-computation-has-been-modified-by-an-inplace-operation-由于Pytorch版本的大坑\" class=\"headerlink\" title=\"10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑\"></a>10. one of the variables needed for gradient computation has been modified by an inplace operation 由于Pytorch版本的大坑</h2><p>由于pytorch版本不一样，因此报错！！！</p>\n<p>都是Python3.7</p>\n<p>Pytorch = 1.7.1 (报错)</p>\n<p>Pytorch = 1.0.0 (不报错)</p>\n<h2 id=\"11-Pytorch自带的mnist数据集读取库-由于Pytorch版本的坑\"><a href=\"#11-Pytorch自带的mnist数据集读取库-由于Pytorch版本的坑\" class=\"headerlink\" title=\"11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑\"></a>11. Pytorch自带的mnist数据集读取库 由于Pytorch版本的坑</h2><p>Pytorch = 1.7.1 (指定到有mnist的目录)</p>\n<p>Pytorch = 1.0.0 (指定到有raw的目录)</p>\n"},{"title":"matplotlib的使用","catagories":["Paper"],"_content":"\n# 子图\n\n## subplot\n\n```python\n    for i in range(100):\n        plt.subplot(10, 10, i + 1)\n        plt.xticks([])\n        plt.yticks([])\n        plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.gray())\n    plt.show()\n```\n\n\n\n## subplots\n\n# 出现的BUG\n\n```python\n    for i in range(100):\n        plt.subplot(10, 10, i + 1)\n        plt.xticks([])\n        plt.yticks([])\n        if labels[i] == 1:  # 需要是(i-1)才能确定我们想要的位置\n            print('highlight: ', i, end=' ')\n            plt.title(labels[i], fontsize=3)\n            plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.hot())  # 但是这里显示还是第i个，不知道是什么bug\n        else:\n            plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.gray())\n    plt.tight_layout()\n    plt.show()\n```\n\n\n\n","source":"_posts/paper_exp/plt.md","raw":"---\ntitle: matplotlib的使用\ncatagories:\n- Paper\ntags:\n- python\n- matplotlib\n---\n\n# 子图\n\n## subplot\n\n```python\n    for i in range(100):\n        plt.subplot(10, 10, i + 1)\n        plt.xticks([])\n        plt.yticks([])\n        plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.gray())\n    plt.show()\n```\n\n\n\n## subplots\n\n# 出现的BUG\n\n```python\n    for i in range(100):\n        plt.subplot(10, 10, i + 1)\n        plt.xticks([])\n        plt.yticks([])\n        if labels[i] == 1:  # 需要是(i-1)才能确定我们想要的位置\n            print('highlight: ', i, end=' ')\n            plt.title(labels[i], fontsize=3)\n            plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.hot())  # 但是这里显示还是第i个，不知道是什么bug\n        else:\n            plt.imshow(np.vstack((multiview_data[0][i], multiview_data[1][i])), cmap=plt.gray())\n    plt.tight_layout()\n    plt.show()\n```\n\n\n\n","slug":"paper_exp/plt","published":1,"date":"2021-03-04T06:51:46.185Z","updated":"2021-03-04T07:47:42.792Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982200cc018oc5q996dl","content":"<h1 id=\"子图\"><a href=\"#子图\" class=\"headerlink\" title=\"子图\"></a>子图</h1><h2 id=\"subplot\"><a href=\"#subplot\" class=\"headerlink\" title=\"subplot\"></a>subplot</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">10</span>, <span class=\"number\">10</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.xticks([])</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">    plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.gray())</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"subplots\"><a href=\"#subplots\" class=\"headerlink\" title=\"subplots\"></a>subplots</h2><h1 id=\"出现的BUG\"><a href=\"#出现的BUG\" class=\"headerlink\" title=\"出现的BUG\"></a>出现的BUG</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">10</span>, <span class=\"number\">10</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.xticks([])</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">    <span class=\"keyword\">if</span> labels[i] == <span class=\"number\">1</span>:  <span class=\"comment\"># 需要是(i-1)才能确定我们想要的位置</span></span><br><span class=\"line\">        print(<span class=\"string\">'highlight: '</span>, i, end=<span class=\"string\">' '</span>)</span><br><span class=\"line\">        plt.title(labels[i], fontsize=<span class=\"number\">3</span>)</span><br><span class=\"line\">        plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.hot())  <span class=\"comment\"># 但是这里显示还是第i个，不知道是什么bug</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.gray())</span><br><span class=\"line\">plt.tight_layout()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"子图\"><a href=\"#子图\" class=\"headerlink\" title=\"子图\"></a>子图</h1><h2 id=\"subplot\"><a href=\"#subplot\" class=\"headerlink\" title=\"subplot\"></a>subplot</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">10</span>, <span class=\"number\">10</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.xticks([])</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">    plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.gray())</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"subplots\"><a href=\"#subplots\" class=\"headerlink\" title=\"subplots\"></a>subplots</h2><h1 id=\"出现的BUG\"><a href=\"#出现的BUG\" class=\"headerlink\" title=\"出现的BUG\"></a>出现的BUG</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">10</span>, <span class=\"number\">10</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.xticks([])</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">    <span class=\"keyword\">if</span> labels[i] == <span class=\"number\">1</span>:  <span class=\"comment\"># 需要是(i-1)才能确定我们想要的位置</span></span><br><span class=\"line\">        print(<span class=\"string\">'highlight: '</span>, i, end=<span class=\"string\">' '</span>)</span><br><span class=\"line\">        plt.title(labels[i], fontsize=<span class=\"number\">3</span>)</span><br><span class=\"line\">        plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.hot())  <span class=\"comment\"># 但是这里显示还是第i个，不知道是什么bug</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        plt.imshow(np.vstack((multiview_data[<span class=\"number\">0</span>][i], multiview_data[<span class=\"number\">1</span>][i])), cmap=plt.gray())</span><br><span class=\"line\">plt.tight_layout()</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n\n\n\n"},{"title":"Pytorch中的Tensor","_content":"\n# 数据类型\n\n## 旧版：\n\nTensor是基本的数据类型，Variable是对Tensor的封装。只有Variable引入了计算图，实现自动求导`backward()`.\n\n定义是否需要梯度： `Variable(requires_grad=True)`.\n\n## 新版：\n\nVariable与Tensor进行合并了，`torch.Tensor`现在一样可以实现自动求导。\n\n定义是否需要梯度： `Tensor.requires_grad_()`.\n\n## 初始化：\n\n`Tensor([0, 1, 2])`\n\n`Tensor(2, 3).fill_(9)`\n\n`torch.ones(4, 5)`\n\n## 对Tensor内部属性的操作：\n\nTensor是一个对象，如果对其操作需要通过`.requires_grad_()`等方法对Field进行赋值。\n\n`torch.ones(2, 3)`等，是一个方法，其中可以通过传`requires_grad=True`等字典对Field进行赋值，由于返回的仍是一个Tensor类型的对象，也可以使用`.requires_grad_()`等方法进行赋值。\n\n## 浮点型\n\n可以通过`tensor.to(torch.float64)`将`Tensor`类型的数据转换成`FloatTensor`类型的数据。\n\n# 梯度\n\nPytorch计算图中有两种元素：数据（Tensor）和运算（可求导运算）。\n\nTensor分为两类：叶子结点，非叶子结点。\n\n计算Tensor梯度（即grad属性被赋值）的条件：\n\n- 叶子结点\n- `requires_grad=True`\n- 依赖该Tensor的所有Tensor`requires_grad=True`\n\n进行反向传播时，需要是一个**标量**。\n\n# 梯度下降\n\n就是在求得了grad的叶子结点，使用`Tensor.data + Tensor.grad.data`实现梯度下降。\n\n# Tensor在cuda上的转移\n\n所有需要使用GPU训练的参数以及关联的参数都需要放到cuda上。\n\n```python\ncuda = True if torch.cuda.is_available() else False\ndevice_id = 7\nif cuda:\n    torch.cuda.set_device(device_id)\nTensor = torch.cuda.FloatTensor if cuda else torch.FloatTensor\n```\n\n如果已经是在`torch.FloatTensor`中的参数，可以通过`.type(Tensor)`来转移参数。\n\n\n\n----\n\nReference\n\nhttps://pytorch.org/docs/stable/tensors.html\n\nhttps://zhuanlan.zhihu.com/p/85506092","source":"_posts/paper_exp/tensor.md","raw":"---\ntitle: Pytorch中的Tensor\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n- tensor\n---\n\n# 数据类型\n\n## 旧版：\n\nTensor是基本的数据类型，Variable是对Tensor的封装。只有Variable引入了计算图，实现自动求导`backward()`.\n\n定义是否需要梯度： `Variable(requires_grad=True)`.\n\n## 新版：\n\nVariable与Tensor进行合并了，`torch.Tensor`现在一样可以实现自动求导。\n\n定义是否需要梯度： `Tensor.requires_grad_()`.\n\n## 初始化：\n\n`Tensor([0, 1, 2])`\n\n`Tensor(2, 3).fill_(9)`\n\n`torch.ones(4, 5)`\n\n## 对Tensor内部属性的操作：\n\nTensor是一个对象，如果对其操作需要通过`.requires_grad_()`等方法对Field进行赋值。\n\n`torch.ones(2, 3)`等，是一个方法，其中可以通过传`requires_grad=True`等字典对Field进行赋值，由于返回的仍是一个Tensor类型的对象，也可以使用`.requires_grad_()`等方法进行赋值。\n\n## 浮点型\n\n可以通过`tensor.to(torch.float64)`将`Tensor`类型的数据转换成`FloatTensor`类型的数据。\n\n# 梯度\n\nPytorch计算图中有两种元素：数据（Tensor）和运算（可求导运算）。\n\nTensor分为两类：叶子结点，非叶子结点。\n\n计算Tensor梯度（即grad属性被赋值）的条件：\n\n- 叶子结点\n- `requires_grad=True`\n- 依赖该Tensor的所有Tensor`requires_grad=True`\n\n进行反向传播时，需要是一个**标量**。\n\n# 梯度下降\n\n就是在求得了grad的叶子结点，使用`Tensor.data + Tensor.grad.data`实现梯度下降。\n\n# Tensor在cuda上的转移\n\n所有需要使用GPU训练的参数以及关联的参数都需要放到cuda上。\n\n```python\ncuda = True if torch.cuda.is_available() else False\ndevice_id = 7\nif cuda:\n    torch.cuda.set_device(device_id)\nTensor = torch.cuda.FloatTensor if cuda else torch.FloatTensor\n```\n\n如果已经是在`torch.FloatTensor`中的参数，可以通过`.type(Tensor)`来转移参数。\n\n\n\n----\n\nReference\n\nhttps://pytorch.org/docs/stable/tensors.html\n\nhttps://zhuanlan.zhihu.com/p/85506092","slug":"paper_exp/tensor","published":1,"date":"2021-02-09T16:47:50.200Z","updated":"2021-03-08T16:53:47.921Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982200cf018of6u27vp2","content":"<h1 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h1><h2 id=\"旧版：\"><a href=\"#旧版：\" class=\"headerlink\" title=\"旧版：\"></a>旧版：</h2><p>Tensor是基本的数据类型，Variable是对Tensor的封装。只有Variable引入了计算图，实现自动求导<code>backward()</code>.</p>\n<p>定义是否需要梯度： <code>Variable(requires_grad=True)</code>.</p>\n<h2 id=\"新版：\"><a href=\"#新版：\" class=\"headerlink\" title=\"新版：\"></a>新版：</h2><p>Variable与Tensor进行合并了，<code>torch.Tensor</code>现在一样可以实现自动求导。</p>\n<p>定义是否需要梯度： <code>Tensor.requires_grad_()</code>.</p>\n<h2 id=\"初始化：\"><a href=\"#初始化：\" class=\"headerlink\" title=\"初始化：\"></a>初始化：</h2><p><code>Tensor([0, 1, 2])</code></p>\n<p><code>Tensor(2, 3).fill_(9)</code></p>\n<p><code>torch.ones(4, 5)</code></p>\n<h2 id=\"对Tensor内部属性的操作：\"><a href=\"#对Tensor内部属性的操作：\" class=\"headerlink\" title=\"对Tensor内部属性的操作：\"></a>对Tensor内部属性的操作：</h2><p>Tensor是一个对象，如果对其操作需要通过<code>.requires_grad_()</code>等方法对Field进行赋值。</p>\n<p><code>torch.ones(2, 3)</code>等，是一个方法，其中可以通过传<code>requires_grad=True</code>等字典对Field进行赋值，由于返回的仍是一个Tensor类型的对象，也可以使用<code>.requires_grad_()</code>等方法进行赋值。</p>\n<h2 id=\"浮点型\"><a href=\"#浮点型\" class=\"headerlink\" title=\"浮点型\"></a>浮点型</h2><p>可以通过<code>tensor.to(torch.float64)</code>将<code>Tensor</code>类型的数据转换成<code>FloatTensor</code>类型的数据。</p>\n<h1 id=\"梯度\"><a href=\"#梯度\" class=\"headerlink\" title=\"梯度\"></a>梯度</h1><p>Pytorch计算图中有两种元素：数据（Tensor）和运算（可求导运算）。</p>\n<p>Tensor分为两类：叶子结点，非叶子结点。</p>\n<p>计算Tensor梯度（即grad属性被赋值）的条件：</p>\n<ul>\n<li>叶子结点</li>\n<li><code>requires_grad=True</code></li>\n<li>依赖该Tensor的所有Tensor<code>requires_grad=True</code></li>\n</ul>\n<p>进行反向传播时，需要是一个<strong>标量</strong>。</p>\n<h1 id=\"梯度下降\"><a href=\"#梯度下降\" class=\"headerlink\" title=\"梯度下降\"></a>梯度下降</h1><p>就是在求得了grad的叶子结点，使用<code>Tensor.data + Tensor.grad.data</code>实现梯度下降。</p>\n<h1 id=\"Tensor在cuda上的转移\"><a href=\"#Tensor在cuda上的转移\" class=\"headerlink\" title=\"Tensor在cuda上的转移\"></a>Tensor在cuda上的转移</h1><p>所有需要使用GPU训练的参数以及关联的参数都需要放到cuda上。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cuda = <span class=\"literal\">True</span> <span class=\"keyword\">if</span> torch.cuda.is_available() <span class=\"keyword\">else</span> <span class=\"literal\">False</span></span><br><span class=\"line\">device_id = <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> cuda:</span><br><span class=\"line\">    torch.cuda.set_device(device_id)</span><br><span class=\"line\">Tensor = torch.cuda.FloatTensor <span class=\"keyword\">if</span> cuda <span class=\"keyword\">else</span> torch.FloatTensor</span><br></pre></td></tr></table></figure>\n\n<p>如果已经是在<code>torch.FloatTensor</code>中的参数，可以通过<code>.type(Tensor)</code>来转移参数。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9weXRvcmNoLm9yZy9kb2NzL3N0YWJsZS90ZW5zb3JzLmh0bWw=\">https://pytorch.org/docs/stable/tensors.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84NTUwNjA5Mg==\">https://zhuanlan.zhihu.com/p/85506092<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h1><h2 id=\"旧版：\"><a href=\"#旧版：\" class=\"headerlink\" title=\"旧版：\"></a>旧版：</h2><p>Tensor是基本的数据类型，Variable是对Tensor的封装。只有Variable引入了计算图，实现自动求导<code>backward()</code>.</p>\n<p>定义是否需要梯度： <code>Variable(requires_grad=True)</code>.</p>\n<h2 id=\"新版：\"><a href=\"#新版：\" class=\"headerlink\" title=\"新版：\"></a>新版：</h2><p>Variable与Tensor进行合并了，<code>torch.Tensor</code>现在一样可以实现自动求导。</p>\n<p>定义是否需要梯度： <code>Tensor.requires_grad_()</code>.</p>\n<h2 id=\"初始化：\"><a href=\"#初始化：\" class=\"headerlink\" title=\"初始化：\"></a>初始化：</h2><p><code>Tensor([0, 1, 2])</code></p>\n<p><code>Tensor(2, 3).fill_(9)</code></p>\n<p><code>torch.ones(4, 5)</code></p>\n<h2 id=\"对Tensor内部属性的操作：\"><a href=\"#对Tensor内部属性的操作：\" class=\"headerlink\" title=\"对Tensor内部属性的操作：\"></a>对Tensor内部属性的操作：</h2><p>Tensor是一个对象，如果对其操作需要通过<code>.requires_grad_()</code>等方法对Field进行赋值。</p>\n<p><code>torch.ones(2, 3)</code>等，是一个方法，其中可以通过传<code>requires_grad=True</code>等字典对Field进行赋值，由于返回的仍是一个Tensor类型的对象，也可以使用<code>.requires_grad_()</code>等方法进行赋值。</p>\n<h2 id=\"浮点型\"><a href=\"#浮点型\" class=\"headerlink\" title=\"浮点型\"></a>浮点型</h2><p>可以通过<code>tensor.to(torch.float64)</code>将<code>Tensor</code>类型的数据转换成<code>FloatTensor</code>类型的数据。</p>\n<h1 id=\"梯度\"><a href=\"#梯度\" class=\"headerlink\" title=\"梯度\"></a>梯度</h1><p>Pytorch计算图中有两种元素：数据（Tensor）和运算（可求导运算）。</p>\n<p>Tensor分为两类：叶子结点，非叶子结点。</p>\n<p>计算Tensor梯度（即grad属性被赋值）的条件：</p>\n<ul>\n<li>叶子结点</li>\n<li><code>requires_grad=True</code></li>\n<li>依赖该Tensor的所有Tensor<code>requires_grad=True</code></li>\n</ul>\n<p>进行反向传播时，需要是一个<strong>标量</strong>。</p>\n<h1 id=\"梯度下降\"><a href=\"#梯度下降\" class=\"headerlink\" title=\"梯度下降\"></a>梯度下降</h1><p>就是在求得了grad的叶子结点，使用<code>Tensor.data + Tensor.grad.data</code>实现梯度下降。</p>\n<h1 id=\"Tensor在cuda上的转移\"><a href=\"#Tensor在cuda上的转移\" class=\"headerlink\" title=\"Tensor在cuda上的转移\"></a>Tensor在cuda上的转移</h1><p>所有需要使用GPU训练的参数以及关联的参数都需要放到cuda上。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cuda = <span class=\"literal\">True</span> <span class=\"keyword\">if</span> torch.cuda.is_available() <span class=\"keyword\">else</span> <span class=\"literal\">False</span></span><br><span class=\"line\">device_id = <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> cuda:</span><br><span class=\"line\">    torch.cuda.set_device(device_id)</span><br><span class=\"line\">Tensor = torch.cuda.FloatTensor <span class=\"keyword\">if</span> cuda <span class=\"keyword\">else</span> torch.FloatTensor</span><br></pre></td></tr></table></figure>\n\n<p>如果已经是在<code>torch.FloatTensor</code>中的参数，可以通过<code>.type(Tensor)</code>来转移参数。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9weXRvcmNoLm9yZy9kb2NzL3N0YWJsZS90ZW5zb3JzLmh0bWw=\">https://pytorch.org/docs/stable/tensors.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84NTUwNjA5Mg==\">https://zhuanlan.zhihu.com/p/85506092<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"pytorch模型的保存与加载","_content":"\n# 只保存网络的参数\n\n## Save\n\n```python\ntorch.save(model.state_dict(), PATH)\n```\n\n## Load\n\n```python\nmodel.load_state_dict(torch.load(PATH))\n```\n\n**注意：**\n\n- 模型的加载需要使用`torch.load`加载路径下的文件，逆序列化dict\n\n# 保存全部的信息\n\n## Save\n\n```python\ntorch.save({\n  'epoch': epoch,\n  'model_state_dict': model.state_dict(),\n  ...\n}, PATH)\n```\n\n## Load\n\n```python\ncheckpoint = torch.load(PATH)\nepoch = checkpoint['epoch']\nmodel.load_state_dict(checkpoint['model_state_dict'])\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/dss_dssssd/article/details/89409183","source":"_posts/paper_exp/pt_save_load.md","raw":"---\ntitle: pytorch模型的保存与加载\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n---\n\n# 只保存网络的参数\n\n## Save\n\n```python\ntorch.save(model.state_dict(), PATH)\n```\n\n## Load\n\n```python\nmodel.load_state_dict(torch.load(PATH))\n```\n\n**注意：**\n\n- 模型的加载需要使用`torch.load`加载路径下的文件，逆序列化dict\n\n# 保存全部的信息\n\n## Save\n\n```python\ntorch.save({\n  'epoch': epoch,\n  'model_state_dict': model.state_dict(),\n  ...\n}, PATH)\n```\n\n## Load\n\n```python\ncheckpoint = torch.load(PATH)\nepoch = checkpoint['epoch']\nmodel.load_state_dict(checkpoint['model_state_dict'])\n```\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://blog.csdn.net/dss_dssssd/article/details/89409183","slug":"paper_exp/pt_save_load","published":1,"date":"2021-02-21T10:55:12.487Z","updated":"2021-03-04T06:51:42.467Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982300ci018o5yohb0ks","content":"<h1 id=\"只保存网络的参数\"><a href=\"#只保存网络的参数\" class=\"headerlink\" title=\"只保存网络的参数\"></a>只保存网络的参数</h1><h2 id=\"Save\"><a href=\"#Save\" class=\"headerlink\" title=\"Save\"></a>Save</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.save(model.state_dict(), PATH)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">model.load_state_dict(torch.load(PATH))</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>模型的加载需要使用<code>torch.load</code>加载路径下的文件，逆序列化dict</li>\n</ul>\n<h1 id=\"保存全部的信息\"><a href=\"#保存全部的信息\" class=\"headerlink\" title=\"保存全部的信息\"></a>保存全部的信息</h1><h2 id=\"Save-1\"><a href=\"#Save-1\" class=\"headerlink\" title=\"Save\"></a>Save</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.save(&#123;</span><br><span class=\"line\">  <span class=\"string\">'epoch'</span>: epoch,</span><br><span class=\"line\">  <span class=\"string\">'model_state_dict'</span>: model.state_dict(),</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;, PATH)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Load-1\"><a href=\"#Load-1\" class=\"headerlink\" title=\"Load\"></a>Load</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">checkpoint = torch.load(PATH)</span><br><span class=\"line\">epoch = checkpoint[<span class=\"string\">'epoch'</span>]</span><br><span class=\"line\">model.load_state_dict(checkpoint[<span class=\"string\">'model_state_dict'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Rzc19kc3Nzc2QvYXJ0aWNsZS9kZXRhaWxzLzg5NDA5MTgz\">https://blog.csdn.net/dss_dssssd/article/details/89409183<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"只保存网络的参数\"><a href=\"#只保存网络的参数\" class=\"headerlink\" title=\"只保存网络的参数\"></a>只保存网络的参数</h1><h2 id=\"Save\"><a href=\"#Save\" class=\"headerlink\" title=\"Save\"></a>Save</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.save(model.state_dict(), PATH)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Load\"><a href=\"#Load\" class=\"headerlink\" title=\"Load\"></a>Load</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">model.load_state_dict(torch.load(PATH))</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>模型的加载需要使用<code>torch.load</code>加载路径下的文件，逆序列化dict</li>\n</ul>\n<h1 id=\"保存全部的信息\"><a href=\"#保存全部的信息\" class=\"headerlink\" title=\"保存全部的信息\"></a>保存全部的信息</h1><h2 id=\"Save-1\"><a href=\"#Save-1\" class=\"headerlink\" title=\"Save\"></a>Save</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.save(&#123;</span><br><span class=\"line\">  <span class=\"string\">'epoch'</span>: epoch,</span><br><span class=\"line\">  <span class=\"string\">'model_state_dict'</span>: model.state_dict(),</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;, PATH)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Load-1\"><a href=\"#Load-1\" class=\"headerlink\" title=\"Load\"></a>Load</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">checkpoint = torch.load(PATH)</span><br><span class=\"line\">epoch = checkpoint[<span class=\"string\">'epoch'</span>]</span><br><span class=\"line\">model.load_state_dict(checkpoint[<span class=\"string\">'model_state_dict'</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Rzc19kc3Nzc2QvYXJ0aWNsZS9kZXRhaWxzLzg5NDA5MTgz\">https://blog.csdn.net/dss_dssssd/article/details/89409183<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"数据预处理","catagories":["Paper"],"_content":"\n# 介绍\n\n由于不同特征的量纲可能不一致，数值差值较大，可能会影响到数据分析的结果\n\n# MinMaxScaler(归一化)\n\n将数据映射到[0, 1]区间\n\n新数据 = (数值 - 最小值) / (最大值 - 最小值)\n\n# Z-Score(标准化)\n\n处理后的数据均值为0，方差为1\n\n新数据 = (数据 - 均值) / 标准差\n\n# 正则化\n\n**正则化是为了防止过拟合**\n\n\n\n# Tips\n\n`int`是带符号数\n\n`uint`是不带符号数\n\n----\n\nReference\n\n正则化 https://www.zhihu.com/question/20924039","source":"_posts/paper_exp/pre_process.md","raw":"---\ntitle: 数据预处理\ncatagories:\n- Paper\ntags:\n- python\n---\n\n# 介绍\n\n由于不同特征的量纲可能不一致，数值差值较大，可能会影响到数据分析的结果\n\n# MinMaxScaler(归一化)\n\n将数据映射到[0, 1]区间\n\n新数据 = (数值 - 最小值) / (最大值 - 最小值)\n\n# Z-Score(标准化)\n\n处理后的数据均值为0，方差为1\n\n新数据 = (数据 - 均值) / 标准差\n\n# 正则化\n\n**正则化是为了防止过拟合**\n\n\n\n# Tips\n\n`int`是带符号数\n\n`uint`是不带符号数\n\n----\n\nReference\n\n正则化 https://www.zhihu.com/question/20924039","slug":"paper_exp/pre_process","published":1,"date":"2021-03-05T14:12:27.213Z","updated":"2021-06-08T08:23:32.300Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982400cl018ohwbogfd3","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>由于不同特征的量纲可能不一致，数值差值较大，可能会影响到数据分析的结果</p>\n<h1 id=\"MinMaxScaler-归一化\"><a href=\"#MinMaxScaler-归一化\" class=\"headerlink\" title=\"MinMaxScaler(归一化)\"></a>MinMaxScaler(归一化)</h1><p>将数据映射到[0, 1]区间</p>\n<p>新数据 = (数值 - 最小值) / (最大值 - 最小值)</p>\n<h1 id=\"Z-Score-标准化\"><a href=\"#Z-Score-标准化\" class=\"headerlink\" title=\"Z-Score(标准化)\"></a>Z-Score(标准化)</h1><p>处理后的数据均值为0，方差为1</p>\n<p>新数据 = (数据 - 均值) / 标准差</p>\n<h1 id=\"正则化\"><a href=\"#正则化\" class=\"headerlink\" title=\"正则化\"></a>正则化</h1><p><strong>正则化是为了防止过拟合</strong></p>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><p><code>int</code>是带符号数</p>\n<p><code>uint</code>是不带符号数</p>\n<hr>\n<p>Reference</p>\n<p>正则化 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzIwOTI0MDM5\">https://www.zhihu.com/question/20924039<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>由于不同特征的量纲可能不一致，数值差值较大，可能会影响到数据分析的结果</p>\n<h1 id=\"MinMaxScaler-归一化\"><a href=\"#MinMaxScaler-归一化\" class=\"headerlink\" title=\"MinMaxScaler(归一化)\"></a>MinMaxScaler(归一化)</h1><p>将数据映射到[0, 1]区间</p>\n<p>新数据 = (数值 - 最小值) / (最大值 - 最小值)</p>\n<h1 id=\"Z-Score-标准化\"><a href=\"#Z-Score-标准化\" class=\"headerlink\" title=\"Z-Score(标准化)\"></a>Z-Score(标准化)</h1><p>处理后的数据均值为0，方差为1</p>\n<p>新数据 = (数据 - 均值) / 标准差</p>\n<h1 id=\"正则化\"><a href=\"#正则化\" class=\"headerlink\" title=\"正则化\"></a>正则化</h1><p><strong>正则化是为了防止过拟合</strong></p>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><p><code>int</code>是带符号数</p>\n<p><code>uint</code>是不带符号数</p>\n<hr>\n<p>Reference</p>\n<p>正则化 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzIwOTI0MDM5\">https://www.zhihu.com/question/20924039<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Pytorch中的inplace","_content":"\n# 简介\n\nInplace操作就是将操作后的**新值赋值到原变量地址**上的操作。如`x += 1`.\n\n# Pytorch中的操作\n\n带有`_`后缀对Tensor的操作都是Inplace操作。\n\n`.squeeze()`不是Inplace操作，`.squeeze_()`是Inplace操作。\n\n`x += 1`是Inplace操作，`x = x + 1`不是Inplace操作。\n\n# 注意\n\n**在 pytorch 中, 有两种情况不能使用 inplace operation:**\n\n1. 对于 requires_grad=True 的 **叶子张量(leaf tensor)** 不能使用 inplace operation\n2. 对于在 **求梯度阶段需要用到的张量** 不能使用 inplace operation\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/38475183","source":"_posts/paper_exp/tensor_inplace.md","raw":"---\ntitle: Pytorch中的inplace\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n---\n\n# 简介\n\nInplace操作就是将操作后的**新值赋值到原变量地址**上的操作。如`x += 1`.\n\n# Pytorch中的操作\n\n带有`_`后缀对Tensor的操作都是Inplace操作。\n\n`.squeeze()`不是Inplace操作，`.squeeze_()`是Inplace操作。\n\n`x += 1`是Inplace操作，`x = x + 1`不是Inplace操作。\n\n# 注意\n\n**在 pytorch 中, 有两种情况不能使用 inplace operation:**\n\n1. 对于 requires_grad=True 的 **叶子张量(leaf tensor)** 不能使用 inplace operation\n2. 对于在 **求梯度阶段需要用到的张量** 不能使用 inplace operation\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/38475183","slug":"paper_exp/tensor_inplace","published":1,"date":"2021-02-08T18:18:39.181Z","updated":"2021-02-09T18:21:19.928Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982500cn018o21la6loe","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Inplace操作就是将操作后的<strong>新值赋值到原变量地址</strong>上的操作。如<code>x += 1</code>.</p>\n<h1 id=\"Pytorch中的操作\"><a href=\"#Pytorch中的操作\" class=\"headerlink\" title=\"Pytorch中的操作\"></a>Pytorch中的操作</h1><p>带有<code>_</code>后缀对Tensor的操作都是Inplace操作。</p>\n<p><code>.squeeze()</code>不是Inplace操作，<code>.squeeze_()</code>是Inplace操作。</p>\n<p><code>x += 1</code>是Inplace操作，<code>x = x + 1</code>不是Inplace操作。</p>\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p><strong>在 pytorch 中, 有两种情况不能使用 inplace operation:</strong></p>\n<ol>\n<li>对于 requires_grad=True 的 <strong>叶子张量(leaf tensor)</strong> 不能使用 inplace operation</li>\n<li>对于在 <strong>求梯度阶段需要用到的张量</strong> 不能使用 inplace operation</li>\n</ol>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zODQ3NTE4Mw==\">https://zhuanlan.zhihu.com/p/38475183<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Inplace操作就是将操作后的<strong>新值赋值到原变量地址</strong>上的操作。如<code>x += 1</code>.</p>\n<h1 id=\"Pytorch中的操作\"><a href=\"#Pytorch中的操作\" class=\"headerlink\" title=\"Pytorch中的操作\"></a>Pytorch中的操作</h1><p>带有<code>_</code>后缀对Tensor的操作都是Inplace操作。</p>\n<p><code>.squeeze()</code>不是Inplace操作，<code>.squeeze_()</code>是Inplace操作。</p>\n<p><code>x += 1</code>是Inplace操作，<code>x = x + 1</code>不是Inplace操作。</p>\n<h1 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h1><p><strong>在 pytorch 中, 有两种情况不能使用 inplace operation:</strong></p>\n<ol>\n<li>对于 requires_grad=True 的 <strong>叶子张量(leaf tensor)</strong> 不能使用 inplace operation</li>\n<li>对于在 <strong>求梯度阶段需要用到的张量</strong> 不能使用 inplace operation</li>\n</ol>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zODQ3NTE4Mw==\">https://zhuanlan.zhihu.com/p/38475183<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Tensor的Shape操作","_content":"\n# 改变Tensor形状\n\n改变Tensor形状时，原Tensor中的数据是如何重构的。\n\n## Tensor数据形状的变化\n\n### 同一维度\n\n每一行往前或往后拼接，直到满足这个维度要求的值。\n\n```python\nx = torch.autograd.Variable(torch.Tensor([[1, 2], [3, 4], [5, 6]]), requires_grad=True)\ntensor([[1., 2.],\n        [3., 4.],\n        [5., 6.]], requires_grad=True)\nx = x.view(2, 3)\ntensor([[1., 2., 3.],\n        [4., 5., 6.]], grad_fn=<ViewBackward>)\n```\n\n### 跨维度\n\n从最低维上的数值一直到高纬进行拼接，不同维度上不够的会跨维度进行拼接。\n\n```python\nx = torch.autograd.Variable(torch.Tensor([[[1, 2], [3, 4], [5, 6]], [[7, 8], [9, 10], [11, 12]]]), requires_grad=True)\ntensor([[[ 1.,  2.],\n         [ 3.,  4.],\n         [ 5.,  6.]],\n\n        [[ 7.,  8.],\n         [ 9., 10.],\n         [11., 12.]]], requires_grad=True)\nx = x.view(3, 4)\ntensor([[ 1.,  2.,  3.,  4.],\n        [ 5.,  6.,  7.,  8.],\n        [ 9., 10., 11., 12.]], grad_fn=<ViewBackward>)\n```\n\n## 查看形状的方式\n\n### 1. shape\n\n通过`Tensor.shape`可以获取该Tensor的形状信息。这里的`shape`属于Field，它是一个数组。\n\n使用方法：想要获取某个维度的大小只需要`.shape[0]`就可以了。\n\n### 2. size\n\n通过`Tensor.size()`可以获取该Tensor**某个维度上**的信息。这里的`size`属于Method，它是一个方法，需要传dim信息。\n\n使用方法：`.size(0)`\n\n## 改变形状的方式\n\n### 1. reshape\n\n- 不受该Tensor是否是连续的影响。\n\n- 返回的**可能是**Tensor的copy，**也可能不是**。\n\n### 2. view\n\n- 只能改变连续的Tensor（没有调用过`transpose`, `permute`等）。\n- 与原Tensor共享存储器（不是内存）。\n\n### 3. squeeze/unsqueeze\n\n对Tensor维度值为1的维度进行删除或增加。\n\n```python\na = Tensor(2, 1, 3, 1)\n# torch.Size([2, 1, 3, 1])\na = a.squeeze(1)\n# torch.Size([2, 3, 1])\na = a.unsqueeze(0)\n# torch.Size([1, 2, 3, 1])\na = a.squeeze()\n# torch.Size([2, 3])\n```\n\n**注意：**\n\n- 不传参删除所有维度值为1的维度。\n- 不在原本的存储空间上操作，**只是显示改变样子**，想要获取需要赋值。\n\n# Tensor的拼接\n\n将多个Tensor进行拼接，使用`torch.cat(inputs, dim=0)`.\n\n将输入在dim维度上进行拼接。\n\n```python\nx = Tensor([[1, 2, 3], [4, 5, 6]])\n# x:  tensor([[1., 2., 3.],\n#         [4., 5., 6.]], device='cuda:7')\ny = Tensor([[4, 5, 6], [7, 8, 9]])\n# y:  tensor([[4., 5., 6.],\n#         [7., 8., 9.]], device='cuda:7')\nz = torch.cat([x, y], dim=0)\n# tensor([[1., 2., 3.],\n#         [4., 5., 6.],\n#         [4., 5., 6.],\n#         [7., 8., 9.]], device='cuda:7') torch.Size([4, 3])\nz = torch.cat([x, y], dim=1)\n# tensor([[1., 2., 3., 4., 5., 6.],\n#         [4., 5., 6., 7., 8., 9.]], device='cuda:7') torch.Size([2, 6])\n```\n\n**注意：**\n\n- 传入的inputs是一个序列，`list`或`tuple`.\n- 传入的inputs在需要拼接的dim上shape必须一致。\n\n# Tensor的合并\n\n`torch.flatten(input, start_dim, end_dim)`\n\n将`start_dim`到`end_dim`维度之间的值合并。\n\n**好像**torch下的方法，都可以通过`Tensor.flatten()`来调用。\n\n# Tensor的分解\n\n## 1. torch.split()\n\n`torch.split(tensor, split_size, dim)`\n\n`split_size`: 间隔大小。\n\n```python\na = Tensor(3, 2)\nx, y, z = a.split(1, 0)\n```\n\n**注意**：\n\n- 最后不足的也会被分成一个块。\n- 注意类型，返回的是一个tuple，可以用多个变量来接收，tuple里装的是Tensor。\n\n## 2. torch.chunk()\n\n`torch.chunk(tensor, chunks, dim)`\n\n`chunks`: 分块数。\n\n```python\na = Tensor(3, 2)\nx, y, z = a.chunk(3, 0)\n```\n\n**注意**：最后不足的也会被分成一个块。\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/dilthey/p/12376179.html","source":"_posts/paper_exp/tensor_shape.md","raw":"---\ntitle: Tensor的Shape操作\ncategories:\n- Paper\ntags:\n- python\n- pytorch\n---\n\n# 改变Tensor形状\n\n改变Tensor形状时，原Tensor中的数据是如何重构的。\n\n## Tensor数据形状的变化\n\n### 同一维度\n\n每一行往前或往后拼接，直到满足这个维度要求的值。\n\n```python\nx = torch.autograd.Variable(torch.Tensor([[1, 2], [3, 4], [5, 6]]), requires_grad=True)\ntensor([[1., 2.],\n        [3., 4.],\n        [5., 6.]], requires_grad=True)\nx = x.view(2, 3)\ntensor([[1., 2., 3.],\n        [4., 5., 6.]], grad_fn=<ViewBackward>)\n```\n\n### 跨维度\n\n从最低维上的数值一直到高纬进行拼接，不同维度上不够的会跨维度进行拼接。\n\n```python\nx = torch.autograd.Variable(torch.Tensor([[[1, 2], [3, 4], [5, 6]], [[7, 8], [9, 10], [11, 12]]]), requires_grad=True)\ntensor([[[ 1.,  2.],\n         [ 3.,  4.],\n         [ 5.,  6.]],\n\n        [[ 7.,  8.],\n         [ 9., 10.],\n         [11., 12.]]], requires_grad=True)\nx = x.view(3, 4)\ntensor([[ 1.,  2.,  3.,  4.],\n        [ 5.,  6.,  7.,  8.],\n        [ 9., 10., 11., 12.]], grad_fn=<ViewBackward>)\n```\n\n## 查看形状的方式\n\n### 1. shape\n\n通过`Tensor.shape`可以获取该Tensor的形状信息。这里的`shape`属于Field，它是一个数组。\n\n使用方法：想要获取某个维度的大小只需要`.shape[0]`就可以了。\n\n### 2. size\n\n通过`Tensor.size()`可以获取该Tensor**某个维度上**的信息。这里的`size`属于Method，它是一个方法，需要传dim信息。\n\n使用方法：`.size(0)`\n\n## 改变形状的方式\n\n### 1. reshape\n\n- 不受该Tensor是否是连续的影响。\n\n- 返回的**可能是**Tensor的copy，**也可能不是**。\n\n### 2. view\n\n- 只能改变连续的Tensor（没有调用过`transpose`, `permute`等）。\n- 与原Tensor共享存储器（不是内存）。\n\n### 3. squeeze/unsqueeze\n\n对Tensor维度值为1的维度进行删除或增加。\n\n```python\na = Tensor(2, 1, 3, 1)\n# torch.Size([2, 1, 3, 1])\na = a.squeeze(1)\n# torch.Size([2, 3, 1])\na = a.unsqueeze(0)\n# torch.Size([1, 2, 3, 1])\na = a.squeeze()\n# torch.Size([2, 3])\n```\n\n**注意：**\n\n- 不传参删除所有维度值为1的维度。\n- 不在原本的存储空间上操作，**只是显示改变样子**，想要获取需要赋值。\n\n# Tensor的拼接\n\n将多个Tensor进行拼接，使用`torch.cat(inputs, dim=0)`.\n\n将输入在dim维度上进行拼接。\n\n```python\nx = Tensor([[1, 2, 3], [4, 5, 6]])\n# x:  tensor([[1., 2., 3.],\n#         [4., 5., 6.]], device='cuda:7')\ny = Tensor([[4, 5, 6], [7, 8, 9]])\n# y:  tensor([[4., 5., 6.],\n#         [7., 8., 9.]], device='cuda:7')\nz = torch.cat([x, y], dim=0)\n# tensor([[1., 2., 3.],\n#         [4., 5., 6.],\n#         [4., 5., 6.],\n#         [7., 8., 9.]], device='cuda:7') torch.Size([4, 3])\nz = torch.cat([x, y], dim=1)\n# tensor([[1., 2., 3., 4., 5., 6.],\n#         [4., 5., 6., 7., 8., 9.]], device='cuda:7') torch.Size([2, 6])\n```\n\n**注意：**\n\n- 传入的inputs是一个序列，`list`或`tuple`.\n- 传入的inputs在需要拼接的dim上shape必须一致。\n\n# Tensor的合并\n\n`torch.flatten(input, start_dim, end_dim)`\n\n将`start_dim`到`end_dim`维度之间的值合并。\n\n**好像**torch下的方法，都可以通过`Tensor.flatten()`来调用。\n\n# Tensor的分解\n\n## 1. torch.split()\n\n`torch.split(tensor, split_size, dim)`\n\n`split_size`: 间隔大小。\n\n```python\na = Tensor(3, 2)\nx, y, z = a.split(1, 0)\n```\n\n**注意**：\n\n- 最后不足的也会被分成一个块。\n- 注意类型，返回的是一个tuple，可以用多个变量来接收，tuple里装的是Tensor。\n\n## 2. torch.chunk()\n\n`torch.chunk(tensor, chunks, dim)`\n\n`chunks`: 分块数。\n\n```python\na = Tensor(3, 2)\nx, y, z = a.chunk(3, 0)\n```\n\n**注意**：最后不足的也会被分成一个块。\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/dilthey/p/12376179.html","slug":"paper_exp/tensor_shape","published":1,"date":"2021-02-04T02:49:48.656Z","updated":"2021-02-10T11:51:52.214Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982600cq018ohe0k5wyz","content":"<h1 id=\"改变Tensor形状\"><a href=\"#改变Tensor形状\" class=\"headerlink\" title=\"改变Tensor形状\"></a>改变Tensor形状</h1><p>改变Tensor形状时，原Tensor中的数据是如何重构的。</p>\n<h2 id=\"Tensor数据形状的变化\"><a href=\"#Tensor数据形状的变化\" class=\"headerlink\" title=\"Tensor数据形状的变化\"></a>Tensor数据形状的变化</h2><h3 id=\"同一维度\"><a href=\"#同一维度\" class=\"headerlink\" title=\"同一维度\"></a>同一维度</h3><p>每一行往前或往后拼接，直到满足这个维度要求的值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.autograd.Variable(torch.Tensor([[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>], [<span class=\"number\">5</span>, <span class=\"number\">6</span>]]), requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">tensor([[<span class=\"number\">1.</span>, <span class=\"number\">2.</span>],</span><br><span class=\"line\">        [<span class=\"number\">3.</span>, <span class=\"number\">4.</span>],</span><br><span class=\"line\">        [<span class=\"number\">5.</span>, <span class=\"number\">6.</span>]], requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">x = x.view(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">tensor([[<span class=\"number\">1.</span>, <span class=\"number\">2.</span>, <span class=\"number\">3.</span>],</span><br><span class=\"line\">        [<span class=\"number\">4.</span>, <span class=\"number\">5.</span>, <span class=\"number\">6.</span>]], grad_fn=&lt;ViewBackward&gt;)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"跨维度\"><a href=\"#跨维度\" class=\"headerlink\" title=\"跨维度\"></a>跨维度</h3><p>从最低维上的数值一直到高纬进行拼接，不同维度上不够的会跨维度进行拼接。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.autograd.Variable(torch.Tensor([[[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>], [<span class=\"number\">5</span>, <span class=\"number\">6</span>]], [[<span class=\"number\">7</span>, <span class=\"number\">8</span>], [<span class=\"number\">9</span>, <span class=\"number\">10</span>], [<span class=\"number\">11</span>, <span class=\"number\">12</span>]]]), requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">tensor([[[ <span class=\"number\">1.</span>,  <span class=\"number\">2.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">3.</span>,  <span class=\"number\">4.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">5.</span>,  <span class=\"number\">6.</span>]],</span><br><span class=\"line\"></span><br><span class=\"line\">        [[ <span class=\"number\">7.</span>,  <span class=\"number\">8.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">9.</span>, <span class=\"number\">10.</span>],</span><br><span class=\"line\">         [<span class=\"number\">11.</span>, <span class=\"number\">12.</span>]]], requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">x = x.view(<span class=\"number\">3</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">tensor([[ <span class=\"number\">1.</span>,  <span class=\"number\">2.</span>,  <span class=\"number\">3.</span>,  <span class=\"number\">4.</span>],</span><br><span class=\"line\">        [ <span class=\"number\">5.</span>,  <span class=\"number\">6.</span>,  <span class=\"number\">7.</span>,  <span class=\"number\">8.</span>],</span><br><span class=\"line\">        [ <span class=\"number\">9.</span>, <span class=\"number\">10.</span>, <span class=\"number\">11.</span>, <span class=\"number\">12.</span>]], grad_fn=&lt;ViewBackward&gt;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看形状的方式\"><a href=\"#查看形状的方式\" class=\"headerlink\" title=\"查看形状的方式\"></a>查看形状的方式</h2><h3 id=\"1-shape\"><a href=\"#1-shape\" class=\"headerlink\" title=\"1. shape\"></a>1. shape</h3><p>通过<code>Tensor.shape</code>可以获取该Tensor的形状信息。这里的<code>shape</code>属于Field，它是一个数组。</p>\n<p>使用方法：想要获取某个维度的大小只需要<code>.shape[0]</code>就可以了。</p>\n<h3 id=\"2-size\"><a href=\"#2-size\" class=\"headerlink\" title=\"2. size\"></a>2. size</h3><p>通过<code>Tensor.size()</code>可以获取该Tensor<strong>某个维度上</strong>的信息。这里的<code>size</code>属于Method，它是一个方法，需要传dim信息。</p>\n<p>使用方法：<code>.size(0)</code></p>\n<h2 id=\"改变形状的方式\"><a href=\"#改变形状的方式\" class=\"headerlink\" title=\"改变形状的方式\"></a>改变形状的方式</h2><h3 id=\"1-reshape\"><a href=\"#1-reshape\" class=\"headerlink\" title=\"1. reshape\"></a>1. reshape</h3><ul>\n<li><p>不受该Tensor是否是连续的影响。</p>\n</li>\n<li><p>返回的<strong>可能是</strong>Tensor的copy，<strong>也可能不是</strong>。</p>\n</li>\n</ul>\n<h3 id=\"2-view\"><a href=\"#2-view\" class=\"headerlink\" title=\"2. view\"></a>2. view</h3><ul>\n<li>只能改变连续的Tensor（没有调用过<code>transpose</code>, <code>permute</code>等）。</li>\n<li>与原Tensor共享存储器（不是内存）。</li>\n</ul>\n<h3 id=\"3-squeeze-unsqueeze\"><a href=\"#3-squeeze-unsqueeze\" class=\"headerlink\" title=\"3. squeeze/unsqueeze\"></a>3. squeeze/unsqueeze</h3><p>对Tensor维度值为1的维度进行删除或增加。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 1, 3, 1])</span></span><br><span class=\"line\">a = a.squeeze(<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 3, 1])</span></span><br><span class=\"line\">a = a.unsqueeze(<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([1, 2, 3, 1])</span></span><br><span class=\"line\">a = a.squeeze()</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 3])</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>不传参删除所有维度值为1的维度。</li>\n<li>不在原本的存储空间上操作，<strong>只是显示改变样子</strong>，想要获取需要赋值。</li>\n</ul>\n<h1 id=\"Tensor的拼接\"><a href=\"#Tensor的拼接\" class=\"headerlink\" title=\"Tensor的拼接\"></a>Tensor的拼接</h1><p>将多个Tensor进行拼接，使用<code>torch.cat(inputs, dim=0)</code>.</p>\n<p>将输入在dim维度上进行拼接。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = Tensor([[<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>]])</span><br><span class=\"line\"><span class=\"comment\"># x:  tensor([[1., 2., 3.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.]], device='cuda:7')</span></span><br><span class=\"line\">y = Tensor([[<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>]])</span><br><span class=\"line\"><span class=\"comment\"># y:  tensor([[4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [7., 8., 9.]], device='cuda:7')</span></span><br><span class=\"line\">z = torch.cat([x, y], dim=<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\"># tensor([[1., 2., 3.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [7., 8., 9.]], device='cuda:7') torch.Size([4, 3])</span></span><br><span class=\"line\">z = torch.cat([x, y], dim=<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># tensor([[1., 2., 3., 4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6., 7., 8., 9.]], device='cuda:7') torch.Size([2, 6])</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>传入的inputs是一个序列，<code>list</code>或<code>tuple</code>.</li>\n<li>传入的inputs在需要拼接的dim上shape必须一致。</li>\n</ul>\n<h1 id=\"Tensor的合并\"><a href=\"#Tensor的合并\" class=\"headerlink\" title=\"Tensor的合并\"></a>Tensor的合并</h1><p><code>torch.flatten(input, start_dim, end_dim)</code></p>\n<p>将<code>start_dim</code>到<code>end_dim</code>维度之间的值合并。</p>\n<p><strong>好像</strong>torch下的方法，都可以通过<code>Tensor.flatten()</code>来调用。</p>\n<h1 id=\"Tensor的分解\"><a href=\"#Tensor的分解\" class=\"headerlink\" title=\"Tensor的分解\"></a>Tensor的分解</h1><h2 id=\"1-torch-split\"><a href=\"#1-torch-split\" class=\"headerlink\" title=\"1. torch.split()\"></a>1. torch.split()</h2><p><code>torch.split(tensor, split_size, dim)</code></p>\n<p><code>split_size</code>: 间隔大小。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">x, y, z = a.split(<span class=\"number\">1</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：</p>\n<ul>\n<li>最后不足的也会被分成一个块。</li>\n<li>注意类型，返回的是一个tuple，可以用多个变量来接收，tuple里装的是Tensor。</li>\n</ul>\n<h2 id=\"2-torch-chunk\"><a href=\"#2-torch-chunk\" class=\"headerlink\" title=\"2. torch.chunk()\"></a>2. torch.chunk()</h2><p><code>torch.chunk(tensor, chunks, dim)</code></p>\n<p><code>chunks</code>: 分块数。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">x, y, z = a.chunk(<span class=\"number\">3</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：最后不足的也会被分成一个块。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZGlsdGhleS9wLzEyMzc2MTc5Lmh0bWw=\">https://www.cnblogs.com/dilthey/p/12376179.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"改变Tensor形状\"><a href=\"#改变Tensor形状\" class=\"headerlink\" title=\"改变Tensor形状\"></a>改变Tensor形状</h1><p>改变Tensor形状时，原Tensor中的数据是如何重构的。</p>\n<h2 id=\"Tensor数据形状的变化\"><a href=\"#Tensor数据形状的变化\" class=\"headerlink\" title=\"Tensor数据形状的变化\"></a>Tensor数据形状的变化</h2><h3 id=\"同一维度\"><a href=\"#同一维度\" class=\"headerlink\" title=\"同一维度\"></a>同一维度</h3><p>每一行往前或往后拼接，直到满足这个维度要求的值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.autograd.Variable(torch.Tensor([[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>], [<span class=\"number\">5</span>, <span class=\"number\">6</span>]]), requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">tensor([[<span class=\"number\">1.</span>, <span class=\"number\">2.</span>],</span><br><span class=\"line\">        [<span class=\"number\">3.</span>, <span class=\"number\">4.</span>],</span><br><span class=\"line\">        [<span class=\"number\">5.</span>, <span class=\"number\">6.</span>]], requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">x = x.view(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">tensor([[<span class=\"number\">1.</span>, <span class=\"number\">2.</span>, <span class=\"number\">3.</span>],</span><br><span class=\"line\">        [<span class=\"number\">4.</span>, <span class=\"number\">5.</span>, <span class=\"number\">6.</span>]], grad_fn=&lt;ViewBackward&gt;)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"跨维度\"><a href=\"#跨维度\" class=\"headerlink\" title=\"跨维度\"></a>跨维度</h3><p>从最低维上的数值一直到高纬进行拼接，不同维度上不够的会跨维度进行拼接。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.autograd.Variable(torch.Tensor([[[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>], [<span class=\"number\">5</span>, <span class=\"number\">6</span>]], [[<span class=\"number\">7</span>, <span class=\"number\">8</span>], [<span class=\"number\">9</span>, <span class=\"number\">10</span>], [<span class=\"number\">11</span>, <span class=\"number\">12</span>]]]), requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">tensor([[[ <span class=\"number\">1.</span>,  <span class=\"number\">2.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">3.</span>,  <span class=\"number\">4.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">5.</span>,  <span class=\"number\">6.</span>]],</span><br><span class=\"line\"></span><br><span class=\"line\">        [[ <span class=\"number\">7.</span>,  <span class=\"number\">8.</span>],</span><br><span class=\"line\">         [ <span class=\"number\">9.</span>, <span class=\"number\">10.</span>],</span><br><span class=\"line\">         [<span class=\"number\">11.</span>, <span class=\"number\">12.</span>]]], requires_grad=<span class=\"literal\">True</span>)</span><br><span class=\"line\">x = x.view(<span class=\"number\">3</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">tensor([[ <span class=\"number\">1.</span>,  <span class=\"number\">2.</span>,  <span class=\"number\">3.</span>,  <span class=\"number\">4.</span>],</span><br><span class=\"line\">        [ <span class=\"number\">5.</span>,  <span class=\"number\">6.</span>,  <span class=\"number\">7.</span>,  <span class=\"number\">8.</span>],</span><br><span class=\"line\">        [ <span class=\"number\">9.</span>, <span class=\"number\">10.</span>, <span class=\"number\">11.</span>, <span class=\"number\">12.</span>]], grad_fn=&lt;ViewBackward&gt;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看形状的方式\"><a href=\"#查看形状的方式\" class=\"headerlink\" title=\"查看形状的方式\"></a>查看形状的方式</h2><h3 id=\"1-shape\"><a href=\"#1-shape\" class=\"headerlink\" title=\"1. shape\"></a>1. shape</h3><p>通过<code>Tensor.shape</code>可以获取该Tensor的形状信息。这里的<code>shape</code>属于Field，它是一个数组。</p>\n<p>使用方法：想要获取某个维度的大小只需要<code>.shape[0]</code>就可以了。</p>\n<h3 id=\"2-size\"><a href=\"#2-size\" class=\"headerlink\" title=\"2. size\"></a>2. size</h3><p>通过<code>Tensor.size()</code>可以获取该Tensor<strong>某个维度上</strong>的信息。这里的<code>size</code>属于Method，它是一个方法，需要传dim信息。</p>\n<p>使用方法：<code>.size(0)</code></p>\n<h2 id=\"改变形状的方式\"><a href=\"#改变形状的方式\" class=\"headerlink\" title=\"改变形状的方式\"></a>改变形状的方式</h2><h3 id=\"1-reshape\"><a href=\"#1-reshape\" class=\"headerlink\" title=\"1. reshape\"></a>1. reshape</h3><ul>\n<li><p>不受该Tensor是否是连续的影响。</p>\n</li>\n<li><p>返回的<strong>可能是</strong>Tensor的copy，<strong>也可能不是</strong>。</p>\n</li>\n</ul>\n<h3 id=\"2-view\"><a href=\"#2-view\" class=\"headerlink\" title=\"2. view\"></a>2. view</h3><ul>\n<li>只能改变连续的Tensor（没有调用过<code>transpose</code>, <code>permute</code>等）。</li>\n<li>与原Tensor共享存储器（不是内存）。</li>\n</ul>\n<h3 id=\"3-squeeze-unsqueeze\"><a href=\"#3-squeeze-unsqueeze\" class=\"headerlink\" title=\"3. squeeze/unsqueeze\"></a>3. squeeze/unsqueeze</h3><p>对Tensor维度值为1的维度进行删除或增加。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 1, 3, 1])</span></span><br><span class=\"line\">a = a.squeeze(<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 3, 1])</span></span><br><span class=\"line\">a = a.unsqueeze(<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([1, 2, 3, 1])</span></span><br><span class=\"line\">a = a.squeeze()</span><br><span class=\"line\"><span class=\"comment\"># torch.Size([2, 3])</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>不传参删除所有维度值为1的维度。</li>\n<li>不在原本的存储空间上操作，<strong>只是显示改变样子</strong>，想要获取需要赋值。</li>\n</ul>\n<h1 id=\"Tensor的拼接\"><a href=\"#Tensor的拼接\" class=\"headerlink\" title=\"Tensor的拼接\"></a>Tensor的拼接</h1><p>将多个Tensor进行拼接，使用<code>torch.cat(inputs, dim=0)</code>.</p>\n<p>将输入在dim维度上进行拼接。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = Tensor([[<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>]])</span><br><span class=\"line\"><span class=\"comment\"># x:  tensor([[1., 2., 3.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.]], device='cuda:7')</span></span><br><span class=\"line\">y = Tensor([[<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>]])</span><br><span class=\"line\"><span class=\"comment\"># y:  tensor([[4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [7., 8., 9.]], device='cuda:7')</span></span><br><span class=\"line\">z = torch.cat([x, y], dim=<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\"># tensor([[1., 2., 3.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [7., 8., 9.]], device='cuda:7') torch.Size([4, 3])</span></span><br><span class=\"line\">z = torch.cat([x, y], dim=<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\"># tensor([[1., 2., 3., 4., 5., 6.],</span></span><br><span class=\"line\"><span class=\"comment\">#         [4., 5., 6., 7., 8., 9.]], device='cuda:7') torch.Size([2, 6])</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong></p>\n<ul>\n<li>传入的inputs是一个序列，<code>list</code>或<code>tuple</code>.</li>\n<li>传入的inputs在需要拼接的dim上shape必须一致。</li>\n</ul>\n<h1 id=\"Tensor的合并\"><a href=\"#Tensor的合并\" class=\"headerlink\" title=\"Tensor的合并\"></a>Tensor的合并</h1><p><code>torch.flatten(input, start_dim, end_dim)</code></p>\n<p>将<code>start_dim</code>到<code>end_dim</code>维度之间的值合并。</p>\n<p><strong>好像</strong>torch下的方法，都可以通过<code>Tensor.flatten()</code>来调用。</p>\n<h1 id=\"Tensor的分解\"><a href=\"#Tensor的分解\" class=\"headerlink\" title=\"Tensor的分解\"></a>Tensor的分解</h1><h2 id=\"1-torch-split\"><a href=\"#1-torch-split\" class=\"headerlink\" title=\"1. torch.split()\"></a>1. torch.split()</h2><p><code>torch.split(tensor, split_size, dim)</code></p>\n<p><code>split_size</code>: 间隔大小。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">x, y, z = a.split(<span class=\"number\">1</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：</p>\n<ul>\n<li>最后不足的也会被分成一个块。</li>\n<li>注意类型，返回的是一个tuple，可以用多个变量来接收，tuple里装的是Tensor。</li>\n</ul>\n<h2 id=\"2-torch-chunk\"><a href=\"#2-torch-chunk\" class=\"headerlink\" title=\"2. torch.chunk()\"></a>2. torch.chunk()</h2><p><code>torch.chunk(tensor, chunks, dim)</code></p>\n<p><code>chunks</code>: 分块数。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = Tensor(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">x, y, z = a.chunk(<span class=\"number\">3</span>, <span class=\"number\">0</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：最后不足的也会被分成一个块。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZGlsdGhleS9wLzEyMzc2MTc5Lmh0bWw=\">https://www.cnblogs.com/dilthey/p/12376179.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"ClusterGAN训练的一些思考","_content":"\nGAN太难训练，经常遇到先收敛后发散的情况。\n\n# 数据集\n\n数据类别不平衡的问题可能会导致encoder效果不佳的状况\n\n\n\n# 预处理\n\n注意分**连续数据**与**离散数据**。\n\n连续数据注意**归一化**\n\n离散数据处理成**one_hot**\n\n图像一定要归一化！！！\n\n\n\n# 网络设计\n\n归一化后的数据要与选择的**激活函数相对应**\n\n离散数据最后一层改成**softmax**\n\n\n\n# 训练\n\nDiscriminator可以设定clamp防止训练发散\n\n\n\n# 超参数\n\nbatch_size 大概能将整个数据集分成20个iter左右\n\nbeta 对于联合loss训练的注意设置倍数 来**弱化或增强**某个loss组成\n\n\n\n# Tips\n\n查看效果的时候注意记录各个参数下的结果\n\n","source":"_posts/paper_exp/thoughts.md","raw":"---\ntitle: ClusterGAN训练的一些思考\ncategories:\n- Paper\n---\n\nGAN太难训练，经常遇到先收敛后发散的情况。\n\n# 数据集\n\n数据类别不平衡的问题可能会导致encoder效果不佳的状况\n\n\n\n# 预处理\n\n注意分**连续数据**与**离散数据**。\n\n连续数据注意**归一化**\n\n离散数据处理成**one_hot**\n\n图像一定要归一化！！！\n\n\n\n# 网络设计\n\n归一化后的数据要与选择的**激活函数相对应**\n\n离散数据最后一层改成**softmax**\n\n\n\n# 训练\n\nDiscriminator可以设定clamp防止训练发散\n\n\n\n# 超参数\n\nbatch_size 大概能将整个数据集分成20个iter左右\n\nbeta 对于联合loss训练的注意设置倍数 来**弱化或增强**某个loss组成\n\n\n\n# Tips\n\n查看效果的时候注意记录各个参数下的结果\n\n","slug":"paper_exp/thoughts","published":1,"date":"2021-05-12T08:11:27.366Z","updated":"2021-06-08T07:04:54.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982700ct018oa1xq7ui0","content":"<p>GAN太难训练，经常遇到先收敛后发散的情况。</p>\n<h1 id=\"数据集\"><a href=\"#数据集\" class=\"headerlink\" title=\"数据集\"></a>数据集</h1><p>数据类别不平衡的问题可能会导致encoder效果不佳的状况</p>\n<h1 id=\"预处理\"><a href=\"#预处理\" class=\"headerlink\" title=\"预处理\"></a>预处理</h1><p>注意分<strong>连续数据</strong>与<strong>离散数据</strong>。</p>\n<p>连续数据注意<strong>归一化</strong></p>\n<p>离散数据处理成<strong>one_hot</strong></p>\n<p>图像一定要归一化！！！</p>\n<h1 id=\"网络设计\"><a href=\"#网络设计\" class=\"headerlink\" title=\"网络设计\"></a>网络设计</h1><p>归一化后的数据要与选择的<strong>激活函数相对应</strong></p>\n<p>离散数据最后一层改成<strong>softmax</strong></p>\n<h1 id=\"训练\"><a href=\"#训练\" class=\"headerlink\" title=\"训练\"></a>训练</h1><p>Discriminator可以设定clamp防止训练发散</p>\n<h1 id=\"超参数\"><a href=\"#超参数\" class=\"headerlink\" title=\"超参数\"></a>超参数</h1><p>batch_size 大概能将整个数据集分成20个iter左右</p>\n<p>beta 对于联合loss训练的注意设置倍数 来<strong>弱化或增强</strong>某个loss组成</p>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><p>查看效果的时候注意记录各个参数下的结果</p>\n","site":{"data":{}},"excerpt":"","more":"<p>GAN太难训练，经常遇到先收敛后发散的情况。</p>\n<h1 id=\"数据集\"><a href=\"#数据集\" class=\"headerlink\" title=\"数据集\"></a>数据集</h1><p>数据类别不平衡的问题可能会导致encoder效果不佳的状况</p>\n<h1 id=\"预处理\"><a href=\"#预处理\" class=\"headerlink\" title=\"预处理\"></a>预处理</h1><p>注意分<strong>连续数据</strong>与<strong>离散数据</strong>。</p>\n<p>连续数据注意<strong>归一化</strong></p>\n<p>离散数据处理成<strong>one_hot</strong></p>\n<p>图像一定要归一化！！！</p>\n<h1 id=\"网络设计\"><a href=\"#网络设计\" class=\"headerlink\" title=\"网络设计\"></a>网络设计</h1><p>归一化后的数据要与选择的<strong>激活函数相对应</strong></p>\n<p>离散数据最后一层改成<strong>softmax</strong></p>\n<h1 id=\"训练\"><a href=\"#训练\" class=\"headerlink\" title=\"训练\"></a>训练</h1><p>Discriminator可以设定clamp防止训练发散</p>\n<h1 id=\"超参数\"><a href=\"#超参数\" class=\"headerlink\" title=\"超参数\"></a>超参数</h1><p>batch_size 大概能将整个数据集分成20个iter左右</p>\n<p>beta 对于联合loss训练的注意设置倍数 来<strong>弱化或增强</strong>某个loss组成</p>\n<h1 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h1><p>查看效果的时候注意记录各个参数下的结果</p>\n"},{"title":"生成随机数","catagories":["Paper"],"_content":"\n# torch.rand()\n\n均匀分布 [0, 1)区间\n\n```python\ntorch.rand(shape)\n```\n\n\n\n# torch.randn()\n\n标准正态分布（均值为0， 方差为1）即高斯白噪声\n\n```python\ntorch.randn(shape)\n```\n\n","source":"_posts/paper_exp/torch_random.md","raw":"---\ntitle: 生成随机数\ncatagories:\n- Paper\ntags:\n- python\n- pytorch\n- random\n---\n\n# torch.rand()\n\n均匀分布 [0, 1)区间\n\n```python\ntorch.rand(shape)\n```\n\n\n\n# torch.randn()\n\n标准正态分布（均值为0， 方差为1）即高斯白噪声\n\n```python\ntorch.randn(shape)\n```\n\n","slug":"paper_exp/torch_random","published":1,"date":"2021-03-05T14:36:15.689Z","updated":"2021-03-05T14:45:22.310Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982800cw018o0qn4c2nw","content":"<h1 id=\"torch-rand\"><a href=\"#torch-rand\" class=\"headerlink\" title=\"torch.rand()\"></a>torch.rand()</h1><p>均匀分布 [0, 1)区间</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.rand(shape)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"torch-randn\"><a href=\"#torch-randn\" class=\"headerlink\" title=\"torch.randn()\"></a>torch.randn()</h1><p>标准正态分布（均值为0， 方差为1）即高斯白噪声</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.randn(shape)</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"torch-rand\"><a href=\"#torch-rand\" class=\"headerlink\" title=\"torch.rand()\"></a>torch.rand()</h1><p>均匀分布 [0, 1)区间</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.rand(shape)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"torch-randn\"><a href=\"#torch-randn\" class=\"headerlink\" title=\"torch.randn()\"></a>torch.randn()</h1><p>标准正态分布（均值为0， 方差为1）即高斯白噪声</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.randn(shape)</span><br></pre></td></tr></table></figure>\n\n"},{"title":"PyTorch Tutorial - Chatbot","_content":"\n# Intro\n\nBuild a simple Chatbot with the dataset Cornell Movie-Dialogs Corpus.\n\n# Preprocess\n\n","source":"_posts/nlp/chatbot.md","raw":"---\ntitle: PyTorch Tutorial - Chatbot\ncategories:\n- NLP\ntags:\n- python\n- pytorch\n- chatbot\n- seq2seq\n---\n\n# Intro\n\nBuild a simple Chatbot with the dataset Cornell Movie-Dialogs Corpus.\n\n# Preprocess\n\n","slug":"nlp/chatbot","published":1,"date":"2021-07-25T03:03:03.569Z","updated":"2021-07-25T03:14:24.412Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982900cz018oc2g4an57","content":"<h1 id=\"Intro\"><a href=\"#Intro\" class=\"headerlink\" title=\"Intro\"></a>Intro</h1><p>Build a simple Chatbot with the dataset Cornell Movie-Dialogs Corpus.</p>\n<h1 id=\"Preprocess\"><a href=\"#Preprocess\" class=\"headerlink\" title=\"Preprocess\"></a>Preprocess</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Intro\"><a href=\"#Intro\" class=\"headerlink\" title=\"Intro\"></a>Intro</h1><p>Build a simple Chatbot with the dataset Cornell Movie-Dialogs Corpus.</p>\n<h1 id=\"Preprocess\"><a href=\"#Preprocess\" class=\"headerlink\" title=\"Preprocess\"></a>Preprocess</h1>"},{"_content":"# BERT 概述\n\nBERT的全称是Bidirectional Encoder Representation from Transformers，即双向Transformer的Encoder，因为decoder是不能获要预测的信息的。模型的主要创新点都在pre-train方法上，即用了Masked LM和Next Sentence Prediction两种方法分别捕捉词语和句子级别的representation。\n\n训练方法：\n- 它在训练双向语言模型时以减小的概率把少量的词替成了Mask或另一个随机的单词。\n- 增加了一个预测下一句的loss。\n\n特点：\n- 模型深，12层，中间层只有1024wide。Transformer的中间层有2048。（深而窄 比 浅而宽 的模型更好？）\n- MLM(Masked Language Model)，同时利用左侧和右侧的词语。\n\n\n\n----\nReference\n\nBERT | Bidirectional Encoder Representation from Transformers\nhttps://easyai.tech/ai-definition/bert/","source":"_posts/nlp/BERT.md","raw":"# BERT 概述\n\nBERT的全称是Bidirectional Encoder Representation from Transformers，即双向Transformer的Encoder，因为decoder是不能获要预测的信息的。模型的主要创新点都在pre-train方法上，即用了Masked LM和Next Sentence Prediction两种方法分别捕捉词语和句子级别的representation。\n\n训练方法：\n- 它在训练双向语言模型时以减小的概率把少量的词替成了Mask或另一个随机的单词。\n- 增加了一个预测下一句的loss。\n\n特点：\n- 模型深，12层，中间层只有1024wide。Transformer的中间层有2048。（深而窄 比 浅而宽 的模型更好？）\n- MLM(Masked Language Model)，同时利用左侧和右侧的词语。\n\n\n\n----\nReference\n\nBERT | Bidirectional Encoder Representation from Transformers\nhttps://easyai.tech/ai-definition/bert/","slug":"nlp/BERT","published":1,"date":"2020-09-23T03:57:29.359Z","updated":"2020-09-23T14:18:02.838Z","title":"nlp/BERT","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982a00d2018o43711yv8","content":"<h1 id=\"BERT-概述\"><a href=\"#BERT-概述\" class=\"headerlink\" title=\"BERT 概述\"></a>BERT 概述</h1><p>BERT的全称是Bidirectional Encoder Representation from Transformers，即双向Transformer的Encoder，因为decoder是不能获要预测的信息的。模型的主要创新点都在pre-train方法上，即用了Masked LM和Next Sentence Prediction两种方法分别捕捉词语和句子级别的representation。</p>\n<p>训练方法：</p>\n<ul>\n<li>它在训练双向语言模型时以减小的概率把少量的词替成了Mask或另一个随机的单词。</li>\n<li>增加了一个预测下一句的loss。</li>\n</ul>\n<p>特点：</p>\n<ul>\n<li>模型深，12层，中间层只有1024wide。Transformer的中间层有2048。（深而窄 比 浅而宽 的模型更好？）</li>\n<li>MLM(Masked Language Model)，同时利用左侧和右侧的词语。</li>\n</ul>\n<hr>\n<p>Reference</p>\n<p>BERT | Bidirectional Encoder Representation from Transformers<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2JlcnQv\">https://easyai.tech/ai-definition/bert/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"BERT-概述\"><a href=\"#BERT-概述\" class=\"headerlink\" title=\"BERT 概述\"></a>BERT 概述</h1><p>BERT的全称是Bidirectional Encoder Representation from Transformers，即双向Transformer的Encoder，因为decoder是不能获要预测的信息的。模型的主要创新点都在pre-train方法上，即用了Masked LM和Next Sentence Prediction两种方法分别捕捉词语和句子级别的representation。</p>\n<p>训练方法：</p>\n<ul>\n<li>它在训练双向语言模型时以减小的概率把少量的词替成了Mask或另一个随机的单词。</li>\n<li>增加了一个预测下一句的loss。</li>\n</ul>\n<p>特点：</p>\n<ul>\n<li>模型深，12层，中间层只有1024wide。Transformer的中间层有2048。（深而窄 比 浅而宽 的模型更好？）</li>\n<li>MLM(Masked Language Model)，同时利用左侧和右侧的词语。</li>\n</ul>\n<hr>\n<p>Reference</p>\n<p>BERT | Bidirectional Encoder Representation from Transformers<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2JlcnQv\">https://easyai.tech/ai-definition/bert/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"NLP文本分类引导","_content":"\n# NLP文本分类引导\n\n## en\n\n## 1. 数据读取  \n\n### python原生读取txt文件\n```py\nf = open(filedir, mode='r')\n```\n\n- `f.read()`一次读取全部数据。\n- `f.readline()`分行读取，一次读取一行。\n- `f.readlines()`读取全部数据，保留`\\n`换行符。\n\n### pandas读取txt文件\npd.read_table(filedir, splitsign, header=指定第几行为列名, names=如果没有列名手动指定['x', 'y'])\n\n## 2. 数据预处理\n\n### 分词\n\n### 去除停词 去除低频词\n```python\n    def optimize_words_dict(self, data, stop_words, threshold):\n        freq_dict = {}\n        for line in data:  # 去除停词 + 计算词频\n            for word in line:\n                if word in stop_words:\n                    continue\n                if word not in freq_dict:\n                    freq_dict[word] = 1\n                else:\n                    freq_dict[word] += 1\n        words_list = []\n        values = sorted(list(set(freq_dict.values())), reverse=True)\n        for w in values:  # 通过阈值筛选词表 算法可以优化？？？\n            if w < threshold:\n                continue\n            for k, v in freq_dict.items():\n                if v == w:\n                    words_list.append((k, v))\n        return words_list\n```\n\n### 通过TF-IDF算法筛选单词\n\n```python\n    def tf_idf(self, data):\n        doc_num = len(data)\n        df = {}\n        for sample in data:\n            for word in set(sample):  # 避免一个单词在一个Sample里出现多次\n                if word not in df:\n                    df[word] = 1.0\n                else:\n                    df[word] += 1.0\n        for word in df:  # 计算document frequency 文档总数/单词出现过的文档数\n            df[word] = log10(doc_num / df[word])\n        res = {}\n        index = 0\n        for sample in data:\n            res[index] = {}\n            tf = {}\n            for word in sample:  # 计算term frequency 一个样本里单词的频率\n                if word not in tf:\n                    tf[word] = 1.0\n                else:\n                    tf[word] += 1.0\n            sample_len = len(sample)\n            for word in sample:  # 计算tf * idf 一个样本中各单词的tf_idf\n                tf_idf = tf[word] / sample_len * df[word]\n                res[index][word] = tf_idf\n            index += 1\n\n        return res  # res格式为每一个样本中每一个单词对应的tf_idf值\n```\n\n**在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。**\n\n## 3. 建立词典\n\n词典 = {‘单词’:索引}\n\n## 4. 提取特征\n\n### 词袋模型（BOW）\n\n假设建立的词典有1000维，那么我们将为数据集中的每一个Sample建立一个1000维的向量。\n\n词袋模型有三种形式：\n- 对于每个Smaple单词是否出现\n- 对于每个Sample单词出现次数\n- 对于每个Smaple单词的TF-IDF值\n\n**在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。**\n\n例：\n词典：1000. [北京，天气，真，好，北京] = [0, 1, 0, ...,0], 或 [0, 2, 0, ...,0]，或 [0, 0.4, 0, ..., 0]\n\n#### 独热编码（One-Hot）\n\n对于一个特征有N个状态则可以用N位来表示\n\n例：Feature_2有2个状态\n\nSample_1 = [0, 1], Sample_2 = [1, 0] ...\n\n例：Feature_1有4个状态\n\nSample_1 = [0, 0, 1, 0], Sample_2 = [0, 1, 0, 0] ...\n\n当一个样本有多个状态时\n\nSample_1 = [0, 1, 0, 0, 1, 0], Sample_2 = [1, 0, 0, 1, 0, 0] ...\n\n----\n一点想法\n不确定应该建立多大的词典时，可以考虑Corpus的大小或是每个Sample中Word的个数\n词典的大小就与Corpus或Sample中Word的个数成某个比例\n\n## zh\n\n## 1. 数据处理\n\n- 去除空格\n- 符号转换（省略号->句号）？\n- 去除无意义符号\n- 繁体转换简体\n","source":"_posts/nlp/week-1.md","raw":"---\ntitle: NLP文本分类引导\ncategories:\n- Notebook\ntags:\n- python\n- nlp\n---\n\n# NLP文本分类引导\n\n## en\n\n## 1. 数据读取  \n\n### python原生读取txt文件\n```py\nf = open(filedir, mode='r')\n```\n\n- `f.read()`一次读取全部数据。\n- `f.readline()`分行读取，一次读取一行。\n- `f.readlines()`读取全部数据，保留`\\n`换行符。\n\n### pandas读取txt文件\npd.read_table(filedir, splitsign, header=指定第几行为列名, names=如果没有列名手动指定['x', 'y'])\n\n## 2. 数据预处理\n\n### 分词\n\n### 去除停词 去除低频词\n```python\n    def optimize_words_dict(self, data, stop_words, threshold):\n        freq_dict = {}\n        for line in data:  # 去除停词 + 计算词频\n            for word in line:\n                if word in stop_words:\n                    continue\n                if word not in freq_dict:\n                    freq_dict[word] = 1\n                else:\n                    freq_dict[word] += 1\n        words_list = []\n        values = sorted(list(set(freq_dict.values())), reverse=True)\n        for w in values:  # 通过阈值筛选词表 算法可以优化？？？\n            if w < threshold:\n                continue\n            for k, v in freq_dict.items():\n                if v == w:\n                    words_list.append((k, v))\n        return words_list\n```\n\n### 通过TF-IDF算法筛选单词\n\n```python\n    def tf_idf(self, data):\n        doc_num = len(data)\n        df = {}\n        for sample in data:\n            for word in set(sample):  # 避免一个单词在一个Sample里出现多次\n                if word not in df:\n                    df[word] = 1.0\n                else:\n                    df[word] += 1.0\n        for word in df:  # 计算document frequency 文档总数/单词出现过的文档数\n            df[word] = log10(doc_num / df[word])\n        res = {}\n        index = 0\n        for sample in data:\n            res[index] = {}\n            tf = {}\n            for word in sample:  # 计算term frequency 一个样本里单词的频率\n                if word not in tf:\n                    tf[word] = 1.0\n                else:\n                    tf[word] += 1.0\n            sample_len = len(sample)\n            for word in sample:  # 计算tf * idf 一个样本中各单词的tf_idf\n                tf_idf = tf[word] / sample_len * df[word]\n                res[index][word] = tf_idf\n            index += 1\n\n        return res  # res格式为每一个样本中每一个单词对应的tf_idf值\n```\n\n**在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。**\n\n## 3. 建立词典\n\n词典 = {‘单词’:索引}\n\n## 4. 提取特征\n\n### 词袋模型（BOW）\n\n假设建立的词典有1000维，那么我们将为数据集中的每一个Sample建立一个1000维的向量。\n\n词袋模型有三种形式：\n- 对于每个Smaple单词是否出现\n- 对于每个Sample单词出现次数\n- 对于每个Smaple单词的TF-IDF值\n\n**在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。**\n\n例：\n词典：1000. [北京，天气，真，好，北京] = [0, 1, 0, ...,0], 或 [0, 2, 0, ...,0]，或 [0, 0.4, 0, ..., 0]\n\n#### 独热编码（One-Hot）\n\n对于一个特征有N个状态则可以用N位来表示\n\n例：Feature_2有2个状态\n\nSample_1 = [0, 1], Sample_2 = [1, 0] ...\n\n例：Feature_1有4个状态\n\nSample_1 = [0, 0, 1, 0], Sample_2 = [0, 1, 0, 0] ...\n\n当一个样本有多个状态时\n\nSample_1 = [0, 1, 0, 0, 1, 0], Sample_2 = [1, 0, 0, 1, 0, 0] ...\n\n----\n一点想法\n不确定应该建立多大的词典时，可以考虑Corpus的大小或是每个Sample中Word的个数\n词典的大小就与Corpus或Sample中Word的个数成某个比例\n\n## zh\n\n## 1. 数据处理\n\n- 去除空格\n- 符号转换（省略号->句号）？\n- 去除无意义符号\n- 繁体转换简体\n","slug":"nlp/week-1","published":1,"date":"2020-07-14T15:31:04.196Z","updated":"2021-01-26T09:25:12.987Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982b00d6018odb0e9qai","content":"<h1 id=\"NLP文本分类引导\"><a href=\"#NLP文本分类引导\" class=\"headerlink\" title=\"NLP文本分类引导\"></a>NLP文本分类引导</h1><h2 id=\"en\"><a href=\"#en\" class=\"headerlink\" title=\"en\"></a>en</h2><h2 id=\"1-数据读取\"><a href=\"#1-数据读取\" class=\"headerlink\" title=\"1. 数据读取\"></a>1. 数据读取</h2><h3 id=\"python原生读取txt文件\"><a href=\"#python原生读取txt文件\" class=\"headerlink\" title=\"python原生读取txt文件\"></a>python原生读取txt文件</h3><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f = open(filedir, mode=<span class=\"string\">'r'</span>)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>f.read()</code>一次读取全部数据。</li>\n<li><code>f.readline()</code>分行读取，一次读取一行。</li>\n<li><code>f.readlines()</code>读取全部数据，保留<code>\\n</code>换行符。</li>\n</ul>\n<h3 id=\"pandas读取txt文件\"><a href=\"#pandas读取txt文件\" class=\"headerlink\" title=\"pandas读取txt文件\"></a>pandas读取txt文件</h3><p>pd.read_table(filedir, splitsign, header=指定第几行为列名, names=如果没有列名手动指定[‘x’, ‘y’])</p>\n<h2 id=\"2-数据预处理\"><a href=\"#2-数据预处理\" class=\"headerlink\" title=\"2. 数据预处理\"></a>2. 数据预处理</h2><h3 id=\"分词\"><a href=\"#分词\" class=\"headerlink\" title=\"分词\"></a>分词</h3><h3 id=\"去除停词-去除低频词\"><a href=\"#去除停词-去除低频词\" class=\"headerlink\" title=\"去除停词 去除低频词\"></a>去除停词 去除低频词</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">optimize_words_dict</span><span class=\"params\">(self, data, stop_words, threshold)</span>:</span></span><br><span class=\"line\">    freq_dict = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> data:  <span class=\"comment\"># 去除停词 + 计算词频</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> line:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">in</span> stop_words:</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> freq_dict:</span><br><span class=\"line\">                freq_dict[word] = <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                freq_dict[word] += <span class=\"number\">1</span></span><br><span class=\"line\">    words_list = []</span><br><span class=\"line\">    values = sorted(list(set(freq_dict.values())), reverse=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> values:  <span class=\"comment\"># 通过阈值筛选词表 算法可以优化？？？</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> w &lt; threshold:</span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> freq_dict.items():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> v == w:</span><br><span class=\"line\">                words_list.append((k, v))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> words_list</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"通过TF-IDF算法筛选单词\"><a href=\"#通过TF-IDF算法筛选单词\" class=\"headerlink\" title=\"通过TF-IDF算法筛选单词\"></a>通过TF-IDF算法筛选单词</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">tf_idf</span><span class=\"params\">(self, data)</span>:</span></span><br><span class=\"line\">    doc_num = len(data)</span><br><span class=\"line\">    df = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> sample <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> set(sample):  <span class=\"comment\"># 避免一个单词在一个Sample里出现多次</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> df:</span><br><span class=\"line\">                df[word] = <span class=\"number\">1.0</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                df[word] += <span class=\"number\">1.0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> df:  <span class=\"comment\"># 计算document frequency 文档总数/单词出现过的文档数</span></span><br><span class=\"line\">        df[word] = log10(doc_num / df[word])</span><br><span class=\"line\">    res = &#123;&#125;</span><br><span class=\"line\">    index = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> sample <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        res[index] = &#123;&#125;</span><br><span class=\"line\">        tf = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> sample:  <span class=\"comment\"># 计算term frequency 一个样本里单词的频率</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> tf:</span><br><span class=\"line\">                tf[word] = <span class=\"number\">1.0</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                tf[word] += <span class=\"number\">1.0</span></span><br><span class=\"line\">        sample_len = len(sample)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> sample:  <span class=\"comment\"># 计算tf * idf 一个样本中各单词的tf_idf</span></span><br><span class=\"line\">            tf_idf = tf[word] / sample_len * df[word]</span><br><span class=\"line\">            res[index][word] = tf_idf</span><br><span class=\"line\">        index += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res  <span class=\"comment\"># res格式为每一个样本中每一个单词对应的tf_idf值</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。</strong></p>\n<h2 id=\"3-建立词典\"><a href=\"#3-建立词典\" class=\"headerlink\" title=\"3. 建立词典\"></a>3. 建立词典</h2><p>词典 = {‘单词’:索引}</p>\n<h2 id=\"4-提取特征\"><a href=\"#4-提取特征\" class=\"headerlink\" title=\"4. 提取特征\"></a>4. 提取特征</h2><h3 id=\"词袋模型（BOW）\"><a href=\"#词袋模型（BOW）\" class=\"headerlink\" title=\"词袋模型（BOW）\"></a>词袋模型（BOW）</h3><p>假设建立的词典有1000维，那么我们将为数据集中的每一个Sample建立一个1000维的向量。</p>\n<p>词袋模型有三种形式：</p>\n<ul>\n<li>对于每个Smaple单词是否出现</li>\n<li>对于每个Sample单词出现次数</li>\n<li>对于每个Smaple单词的TF-IDF值</li>\n</ul>\n<p><strong>在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。</strong></p>\n<p>例：<br>词典：1000. [北京，天气，真，好，北京] = [0, 1, 0, …,0], 或 [0, 2, 0, …,0]，或 [0, 0.4, 0, …, 0]</p>\n<h4 id=\"独热编码（One-Hot）\"><a href=\"#独热编码（One-Hot）\" class=\"headerlink\" title=\"独热编码（One-Hot）\"></a>独热编码（One-Hot）</h4><p>对于一个特征有N个状态则可以用N位来表示</p>\n<p>例：Feature_2有2个状态</p>\n<p>Sample_1 = [0, 1], Sample_2 = [1, 0] …</p>\n<p>例：Feature_1有4个状态</p>\n<p>Sample_1 = [0, 0, 1, 0], Sample_2 = [0, 1, 0, 0] …</p>\n<p>当一个样本有多个状态时</p>\n<p>Sample_1 = [0, 1, 0, 0, 1, 0], Sample_2 = [1, 0, 0, 1, 0, 0] …</p>\n<hr>\n<p>一点想法<br>不确定应该建立多大的词典时，可以考虑Corpus的大小或是每个Sample中Word的个数<br>词典的大小就与Corpus或Sample中Word的个数成某个比例</p>\n<h2 id=\"zh\"><a href=\"#zh\" class=\"headerlink\" title=\"zh\"></a>zh</h2><h2 id=\"1-数据处理\"><a href=\"#1-数据处理\" class=\"headerlink\" title=\"1. 数据处理\"></a>1. 数据处理</h2><ul>\n<li>去除空格</li>\n<li>符号转换（省略号-&gt;句号）？</li>\n<li>去除无意义符号</li>\n<li>繁体转换简体</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"NLP文本分类引导\"><a href=\"#NLP文本分类引导\" class=\"headerlink\" title=\"NLP文本分类引导\"></a>NLP文本分类引导</h1><h2 id=\"en\"><a href=\"#en\" class=\"headerlink\" title=\"en\"></a>en</h2><h2 id=\"1-数据读取\"><a href=\"#1-数据读取\" class=\"headerlink\" title=\"1. 数据读取\"></a>1. 数据读取</h2><h3 id=\"python原生读取txt文件\"><a href=\"#python原生读取txt文件\" class=\"headerlink\" title=\"python原生读取txt文件\"></a>python原生读取txt文件</h3><figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f = open(filedir, mode=<span class=\"string\">'r'</span>)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>f.read()</code>一次读取全部数据。</li>\n<li><code>f.readline()</code>分行读取，一次读取一行。</li>\n<li><code>f.readlines()</code>读取全部数据，保留<code>\\n</code>换行符。</li>\n</ul>\n<h3 id=\"pandas读取txt文件\"><a href=\"#pandas读取txt文件\" class=\"headerlink\" title=\"pandas读取txt文件\"></a>pandas读取txt文件</h3><p>pd.read_table(filedir, splitsign, header=指定第几行为列名, names=如果没有列名手动指定[‘x’, ‘y’])</p>\n<h2 id=\"2-数据预处理\"><a href=\"#2-数据预处理\" class=\"headerlink\" title=\"2. 数据预处理\"></a>2. 数据预处理</h2><h3 id=\"分词\"><a href=\"#分词\" class=\"headerlink\" title=\"分词\"></a>分词</h3><h3 id=\"去除停词-去除低频词\"><a href=\"#去除停词-去除低频词\" class=\"headerlink\" title=\"去除停词 去除低频词\"></a>去除停词 去除低频词</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">optimize_words_dict</span><span class=\"params\">(self, data, stop_words, threshold)</span>:</span></span><br><span class=\"line\">    freq_dict = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> data:  <span class=\"comment\"># 去除停词 + 计算词频</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> line:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">in</span> stop_words:</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> freq_dict:</span><br><span class=\"line\">                freq_dict[word] = <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                freq_dict[word] += <span class=\"number\">1</span></span><br><span class=\"line\">    words_list = []</span><br><span class=\"line\">    values = sorted(list(set(freq_dict.values())), reverse=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> values:  <span class=\"comment\"># 通过阈值筛选词表 算法可以优化？？？</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> w &lt; threshold:</span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> freq_dict.items():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> v == w:</span><br><span class=\"line\">                words_list.append((k, v))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> words_list</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"通过TF-IDF算法筛选单词\"><a href=\"#通过TF-IDF算法筛选单词\" class=\"headerlink\" title=\"通过TF-IDF算法筛选单词\"></a>通过TF-IDF算法筛选单词</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">tf_idf</span><span class=\"params\">(self, data)</span>:</span></span><br><span class=\"line\">    doc_num = len(data)</span><br><span class=\"line\">    df = &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> sample <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> set(sample):  <span class=\"comment\"># 避免一个单词在一个Sample里出现多次</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> df:</span><br><span class=\"line\">                df[word] = <span class=\"number\">1.0</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                df[word] += <span class=\"number\">1.0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> df:  <span class=\"comment\"># 计算document frequency 文档总数/单词出现过的文档数</span></span><br><span class=\"line\">        df[word] = log10(doc_num / df[word])</span><br><span class=\"line\">    res = &#123;&#125;</span><br><span class=\"line\">    index = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> sample <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        res[index] = &#123;&#125;</span><br><span class=\"line\">        tf = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> sample:  <span class=\"comment\"># 计算term frequency 一个样本里单词的频率</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> word <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> tf:</span><br><span class=\"line\">                tf[word] = <span class=\"number\">1.0</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                tf[word] += <span class=\"number\">1.0</span></span><br><span class=\"line\">        sample_len = len(sample)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> sample:  <span class=\"comment\"># 计算tf * idf 一个样本中各单词的tf_idf</span></span><br><span class=\"line\">            tf_idf = tf[word] / sample_len * df[word]</span><br><span class=\"line\">            res[index][word] = tf_idf</span><br><span class=\"line\">        index += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res  <span class=\"comment\"># res格式为每一个样本中每一个单词对应的tf_idf值</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。</strong></p>\n<h2 id=\"3-建立词典\"><a href=\"#3-建立词典\" class=\"headerlink\" title=\"3. 建立词典\"></a>3. 建立词典</h2><p>词典 = {‘单词’:索引}</p>\n<h2 id=\"4-提取特征\"><a href=\"#4-提取特征\" class=\"headerlink\" title=\"4. 提取特征\"></a>4. 提取特征</h2><h3 id=\"词袋模型（BOW）\"><a href=\"#词袋模型（BOW）\" class=\"headerlink\" title=\"词袋模型（BOW）\"></a>词袋模型（BOW）</h3><p>假设建立的词典有1000维，那么我们将为数据集中的每一个Sample建立一个1000维的向量。</p>\n<p>词袋模型有三种形式：</p>\n<ul>\n<li>对于每个Smaple单词是否出现</li>\n<li>对于每个Sample单词出现次数</li>\n<li>对于每个Smaple单词的TF-IDF值</li>\n</ul>\n<p><strong>在预处理时，因为是要为生成词典做准备，所以TF-IDF应该是以整个corpus计算TF，而提取特征时建立词袋模型中的TF-IDF方法则是对每个Sample的单词计算TF-IDF值。</strong></p>\n<p>例：<br>词典：1000. [北京，天气，真，好，北京] = [0, 1, 0, …,0], 或 [0, 2, 0, …,0]，或 [0, 0.4, 0, …, 0]</p>\n<h4 id=\"独热编码（One-Hot）\"><a href=\"#独热编码（One-Hot）\" class=\"headerlink\" title=\"独热编码（One-Hot）\"></a>独热编码（One-Hot）</h4><p>对于一个特征有N个状态则可以用N位来表示</p>\n<p>例：Feature_2有2个状态</p>\n<p>Sample_1 = [0, 1], Sample_2 = [1, 0] …</p>\n<p>例：Feature_1有4个状态</p>\n<p>Sample_1 = [0, 0, 1, 0], Sample_2 = [0, 1, 0, 0] …</p>\n<p>当一个样本有多个状态时</p>\n<p>Sample_1 = [0, 1, 0, 0, 1, 0], Sample_2 = [1, 0, 0, 1, 0, 0] …</p>\n<hr>\n<p>一点想法<br>不确定应该建立多大的词典时，可以考虑Corpus的大小或是每个Sample中Word的个数<br>词典的大小就与Corpus或Sample中Word的个数成某个比例</p>\n<h2 id=\"zh\"><a href=\"#zh\" class=\"headerlink\" title=\"zh\"></a>zh</h2><h2 id=\"1-数据处理\"><a href=\"#1-数据处理\" class=\"headerlink\" title=\"1. 数据处理\"></a>1. 数据处理</h2><ul>\n<li>去除空格</li>\n<li>符号转换（省略号-&gt;句号）？</li>\n<li>去除无意义符号</li>\n<li>繁体转换简体</li>\n</ul>\n"},{"_content":"# Transfomer 概述       \n\n和经典的 seq2seq 模型一样，Transformer 模型中也采用了 encoer-decoder 架构。上图的左半边用 NX 框出来的，就代表一层 encoder，其中论文里面的 encoder 一共有6层这样的结构。上图的右半边用 NX 框出来的，则代表一层 decoder，同样也有6层。\n\n定义输入序列首先经过 word embedding，再和 positional encoding 相加后，输入到 encoder 中。输出序列经过的处理和输入序列一样，然后输入到 decoder。\n\n最后，decoder 的输出经过一个线性层，再接 Softmax。\n\n于上便是 Transformer 的整体框架，下面先来介绍 encoder 和 decoder。\n\n**Encoder**\n\n由 6 层相同的层组成，每一层分别由两部分组成：\n\n- 第一部分是 multi-head self-attention\n\n- 第二部分是 position-wise feed-forward network，是一个全连接层\n\n两个部分，都有一个残差连接(residual connection)，然后接着一个 Layer Normalization。\n\n**Decoder**\n\n和 encoder 类似，decoder 也是由6个相同的层组成，每一层由三个部分组成：\n\n- 第一个部分是 multi-head self-attention mechanism\n- 第二部分是 multi-head context-attention mechanism\n- 第三部分是一个 position-wise feed-forward network和encoder 一样，上面三个部分的每一个部分，都有一个残差连接，后接一个 Layer Normalization。\n\ndecoder 和 encoder 不同的地方在 multi-head context-attention mechanism\n\n**Attention**\n\nAttention用一句话来描述，就是encoder层的输出经过加权平均后再输入到decoder层中。它主要应用在seq2seq模型中，这个加权可以用矩阵来表示，也叫Attention矩阵。它表示对于某个时刻的输出y，他在输入x上各个部分的注意力。这个注意力就是加权。\n\n**Self-Attention**\n\nattention有两个隐状态，hi和st。前者是输入序列第i个位置产生的隐状态，后者是输出序列在第t个位置产生的隐状态。self-attention就是，输出序列就是输入序列。自己计算自己的attention得分。\n\n**Context-Attention**\n\ncontext-attention是encoder和decoder之间的attention，是两个不同序列之间的attention，与来源于自身的self-attention相区别。\n\n计算attention权重的方法：\n- additive attention\n- local-base\n- general\n- dot-product\n- scaled dot-product\n\n**Scaled Dot-Product Attention**\n\n通过query和key的相似性程度来确定value的权重分布。\n\n![img-scaled-dot-attention](https://pic4.zhimg.com/80/v2-e2bc3a470b359e8bdce750843140897e_720w.jpg)\n\n\n\n----\nReference\n\nTransformer\nhttps://easyai.tech/ai-definition/transformer/\n\nAttention\nhttps://easyai.tech/ai-definition/attention/\n\nEncoderDecoder Seq2Seq\n\nhttps://easyai.tech/ai-definition/encoder-decoder-seq2seq/\n","source":"_posts/nlp/Transformer.md","raw":"# Transfomer 概述       \n\n和经典的 seq2seq 模型一样，Transformer 模型中也采用了 encoer-decoder 架构。上图的左半边用 NX 框出来的，就代表一层 encoder，其中论文里面的 encoder 一共有6层这样的结构。上图的右半边用 NX 框出来的，则代表一层 decoder，同样也有6层。\n\n定义输入序列首先经过 word embedding，再和 positional encoding 相加后，输入到 encoder 中。输出序列经过的处理和输入序列一样，然后输入到 decoder。\n\n最后，decoder 的输出经过一个线性层，再接 Softmax。\n\n于上便是 Transformer 的整体框架，下面先来介绍 encoder 和 decoder。\n\n**Encoder**\n\n由 6 层相同的层组成，每一层分别由两部分组成：\n\n- 第一部分是 multi-head self-attention\n\n- 第二部分是 position-wise feed-forward network，是一个全连接层\n\n两个部分，都有一个残差连接(residual connection)，然后接着一个 Layer Normalization。\n\n**Decoder**\n\n和 encoder 类似，decoder 也是由6个相同的层组成，每一层由三个部分组成：\n\n- 第一个部分是 multi-head self-attention mechanism\n- 第二部分是 multi-head context-attention mechanism\n- 第三部分是一个 position-wise feed-forward network和encoder 一样，上面三个部分的每一个部分，都有一个残差连接，后接一个 Layer Normalization。\n\ndecoder 和 encoder 不同的地方在 multi-head context-attention mechanism\n\n**Attention**\n\nAttention用一句话来描述，就是encoder层的输出经过加权平均后再输入到decoder层中。它主要应用在seq2seq模型中，这个加权可以用矩阵来表示，也叫Attention矩阵。它表示对于某个时刻的输出y，他在输入x上各个部分的注意力。这个注意力就是加权。\n\n**Self-Attention**\n\nattention有两个隐状态，hi和st。前者是输入序列第i个位置产生的隐状态，后者是输出序列在第t个位置产生的隐状态。self-attention就是，输出序列就是输入序列。自己计算自己的attention得分。\n\n**Context-Attention**\n\ncontext-attention是encoder和decoder之间的attention，是两个不同序列之间的attention，与来源于自身的self-attention相区别。\n\n计算attention权重的方法：\n- additive attention\n- local-base\n- general\n- dot-product\n- scaled dot-product\n\n**Scaled Dot-Product Attention**\n\n通过query和key的相似性程度来确定value的权重分布。\n\n![img-scaled-dot-attention](https://pic4.zhimg.com/80/v2-e2bc3a470b359e8bdce750843140897e_720w.jpg)\n\n\n\n----\nReference\n\nTransformer\nhttps://easyai.tech/ai-definition/transformer/\n\nAttention\nhttps://easyai.tech/ai-definition/attention/\n\nEncoderDecoder Seq2Seq\n\nhttps://easyai.tech/ai-definition/encoder-decoder-seq2seq/\n","slug":"nlp/Transformer","published":1,"date":"2020-09-23T03:57:22.472Z","updated":"2021-10-10T14:35:09.158Z","title":"nlp/Transformer","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982c00d8018oguvvhvbf","content":"<h1 id=\"Transfomer-概述\"><a href=\"#Transfomer-概述\" class=\"headerlink\" title=\"Transfomer 概述\"></a>Transfomer 概述</h1><p>和经典的 seq2seq 模型一样，Transformer 模型中也采用了 encoer-decoder 架构。上图的左半边用 NX 框出来的，就代表一层 encoder，其中论文里面的 encoder 一共有6层这样的结构。上图的右半边用 NX 框出来的，则代表一层 decoder，同样也有6层。</p>\n<p>定义输入序列首先经过 word embedding，再和 positional encoding 相加后，输入到 encoder 中。输出序列经过的处理和输入序列一样，然后输入到 decoder。</p>\n<p>最后，decoder 的输出经过一个线性层，再接 Softmax。</p>\n<p>于上便是 Transformer 的整体框架，下面先来介绍 encoder 和 decoder。</p>\n<p><strong>Encoder</strong></p>\n<p>由 6 层相同的层组成，每一层分别由两部分组成：</p>\n<ul>\n<li><p>第一部分是 multi-head self-attention</p>\n</li>\n<li><p>第二部分是 position-wise feed-forward network，是一个全连接层</p>\n</li>\n</ul>\n<p>两个部分，都有一个残差连接(residual connection)，然后接着一个 Layer Normalization。</p>\n<p><strong>Decoder</strong></p>\n<p>和 encoder 类似，decoder 也是由6个相同的层组成，每一层由三个部分组成：</p>\n<ul>\n<li>第一个部分是 multi-head self-attention mechanism</li>\n<li>第二部分是 multi-head context-attention mechanism</li>\n<li>第三部分是一个 position-wise feed-forward network和encoder 一样，上面三个部分的每一个部分，都有一个残差连接，后接一个 Layer Normalization。</li>\n</ul>\n<p>decoder 和 encoder 不同的地方在 multi-head context-attention mechanism</p>\n<p><strong>Attention</strong></p>\n<p>Attention用一句话来描述，就是encoder层的输出经过加权平均后再输入到decoder层中。它主要应用在seq2seq模型中，这个加权可以用矩阵来表示，也叫Attention矩阵。它表示对于某个时刻的输出y，他在输入x上各个部分的注意力。这个注意力就是加权。</p>\n<p><strong>Self-Attention</strong></p>\n<p>attention有两个隐状态，hi和st。前者是输入序列第i个位置产生的隐状态，后者是输出序列在第t个位置产生的隐状态。self-attention就是，输出序列就是输入序列。自己计算自己的attention得分。</p>\n<p><strong>Context-Attention</strong></p>\n<p>context-attention是encoder和decoder之间的attention，是两个不同序列之间的attention，与来源于自身的self-attention相区别。</p>\n<p>计算attention权重的方法：</p>\n<ul>\n<li>additive attention</li>\n<li>local-base</li>\n<li>general</li>\n<li>dot-product</li>\n<li>scaled dot-product</li>\n</ul>\n<p><strong>Scaled Dot-Product Attention</strong></p>\n<p>通过query和key的相似性程度来确定value的权重分布。</p>\n<p><img src=\"https://pic4.zhimg.com/80/v2-e2bc3a470b359e8bdce750843140897e_720w.jpg\" alt=\"img-scaled-dot-attention\"></p>\n<hr>\n<p>Reference</p>\n<p>Transformer<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3RyYW5zZm9ybWVyLw==\">https://easyai.tech/ai-definition/transformer/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>Attention<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2F0dGVudGlvbi8=\">https://easyai.tech/ai-definition/attention/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>EncoderDecoder Seq2Seq</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2VuY29kZXItZGVjb2Rlci1zZXEyc2VxLw==\">https://easyai.tech/ai-definition/encoder-decoder-seq2seq/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Transfomer-概述\"><a href=\"#Transfomer-概述\" class=\"headerlink\" title=\"Transfomer 概述\"></a>Transfomer 概述</h1><p>和经典的 seq2seq 模型一样，Transformer 模型中也采用了 encoer-decoder 架构。上图的左半边用 NX 框出来的，就代表一层 encoder，其中论文里面的 encoder 一共有6层这样的结构。上图的右半边用 NX 框出来的，则代表一层 decoder，同样也有6层。</p>\n<p>定义输入序列首先经过 word embedding，再和 positional encoding 相加后，输入到 encoder 中。输出序列经过的处理和输入序列一样，然后输入到 decoder。</p>\n<p>最后，decoder 的输出经过一个线性层，再接 Softmax。</p>\n<p>于上便是 Transformer 的整体框架，下面先来介绍 encoder 和 decoder。</p>\n<p><strong>Encoder</strong></p>\n<p>由 6 层相同的层组成，每一层分别由两部分组成：</p>\n<ul>\n<li><p>第一部分是 multi-head self-attention</p>\n</li>\n<li><p>第二部分是 position-wise feed-forward network，是一个全连接层</p>\n</li>\n</ul>\n<p>两个部分，都有一个残差连接(residual connection)，然后接着一个 Layer Normalization。</p>\n<p><strong>Decoder</strong></p>\n<p>和 encoder 类似，decoder 也是由6个相同的层组成，每一层由三个部分组成：</p>\n<ul>\n<li>第一个部分是 multi-head self-attention mechanism</li>\n<li>第二部分是 multi-head context-attention mechanism</li>\n<li>第三部分是一个 position-wise feed-forward network和encoder 一样，上面三个部分的每一个部分，都有一个残差连接，后接一个 Layer Normalization。</li>\n</ul>\n<p>decoder 和 encoder 不同的地方在 multi-head context-attention mechanism</p>\n<p><strong>Attention</strong></p>\n<p>Attention用一句话来描述，就是encoder层的输出经过加权平均后再输入到decoder层中。它主要应用在seq2seq模型中，这个加权可以用矩阵来表示，也叫Attention矩阵。它表示对于某个时刻的输出y，他在输入x上各个部分的注意力。这个注意力就是加权。</p>\n<p><strong>Self-Attention</strong></p>\n<p>attention有两个隐状态，hi和st。前者是输入序列第i个位置产生的隐状态，后者是输出序列在第t个位置产生的隐状态。self-attention就是，输出序列就是输入序列。自己计算自己的attention得分。</p>\n<p><strong>Context-Attention</strong></p>\n<p>context-attention是encoder和decoder之间的attention，是两个不同序列之间的attention，与来源于自身的self-attention相区别。</p>\n<p>计算attention权重的方法：</p>\n<ul>\n<li>additive attention</li>\n<li>local-base</li>\n<li>general</li>\n<li>dot-product</li>\n<li>scaled dot-product</li>\n</ul>\n<p><strong>Scaled Dot-Product Attention</strong></p>\n<p>通过query和key的相似性程度来确定value的权重分布。</p>\n<p><img src=\"https://pic4.zhimg.com/80/v2-e2bc3a470b359e8bdce750843140897e_720w.jpg\" alt=\"img-scaled-dot-attention\"></p>\n<hr>\n<p>Reference</p>\n<p>Transformer<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3RyYW5zZm9ybWVyLw==\">https://easyai.tech/ai-definition/transformer/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>Attention<br><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2F0dGVudGlvbi8=\">https://easyai.tech/ai-definition/attention/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>EncoderDecoder Seq2Seq</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL2VuY29kZXItZGVjb2Rlci1zZXEyc2VxLw==\">https://easyai.tech/ai-definition/encoder-decoder-seq2seq/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# Word2Vec note\n\n## 引入\nWord2Vec是从大量文本语料中以无监督的方式学习语义知识的一种模型，它被大量的用在自然语言处理中。Word2Vec其实就是通过学习文本来用词向量的方式表征词的语义信息，即通过一个嵌入空间使得语义上相似的单词在该空间内距离很近。Embedding其实就是一个映射，将单词从原先所属的空间映射到新的多维空间中，也就是把原先词所在的空间嵌入到一个新的空间中去。\n\n","source":"_posts/nlp/word2vec.md","raw":"# Word2Vec note\n\n## 引入\nWord2Vec是从大量文本语料中以无监督的方式学习语义知识的一种模型，它被大量的用在自然语言处理中。Word2Vec其实就是通过学习文本来用词向量的方式表征词的语义信息，即通过一个嵌入空间使得语义上相似的单词在该空间内距离很近。Embedding其实就是一个映射，将单词从原先所属的空间映射到新的多维空间中，也就是把原先词所在的空间嵌入到一个新的空间中去。\n\n","slug":"nlp/word2vec","published":1,"date":"2020-08-01T16:44:10.923Z","updated":"2020-08-03T05:06:37.005Z","title":"nlp/word2vec","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982d00da018o9t6i1evj","content":"<h1 id=\"Word2Vec-note\"><a href=\"#Word2Vec-note\" class=\"headerlink\" title=\"Word2Vec note\"></a>Word2Vec note</h1><h2 id=\"引入\"><a href=\"#引入\" class=\"headerlink\" title=\"引入\"></a>引入</h2><p>Word2Vec是从大量文本语料中以无监督的方式学习语义知识的一种模型，它被大量的用在自然语言处理中。Word2Vec其实就是通过学习文本来用词向量的方式表征词的语义信息，即通过一个嵌入空间使得语义上相似的单词在该空间内距离很近。Embedding其实就是一个映射，将单词从原先所属的空间映射到新的多维空间中，也就是把原先词所在的空间嵌入到一个新的空间中去。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Word2Vec-note\"><a href=\"#Word2Vec-note\" class=\"headerlink\" title=\"Word2Vec note\"></a>Word2Vec note</h1><h2 id=\"引入\"><a href=\"#引入\" class=\"headerlink\" title=\"引入\"></a>引入</h2><p>Word2Vec是从大量文本语料中以无监督的方式学习语义知识的一种模型，它被大量的用在自然语言处理中。Word2Vec其实就是通过学习文本来用词向量的方式表征词的语义信息，即通过一个嵌入空间使得语义上相似的单词在该空间内距离很近。Embedding其实就是一个映射，将单词从原先所属的空间映射到新的多维空间中，也就是把原先词所在的空间嵌入到一个新的空间中去。</p>\n"},{"_content":"# Week 2\n深度学习与神经网络基础，pytorch基础。\n\n## 神经网络训练过程\n\n- 将DataSet生成iter(train_iter, test_iter), 每个iter由X,y构成 (X:Sample的所有特征[samples * features], y:真实标签).\n- 计算y_hat (y_hat:通过构造的神经网络模型得到的预测值).\n- 计算损失函数 (均方差, 交叉熵).\n- 对所有params梯度清零.\n- loss.backward反向传播, 对损失函数求梯度, 也就是得所有的到权重和偏置的梯度param.grad.\n- params带入梯度下降算法, 更新params.\n- 每个epoch后, 将测试数据带入训练后的网络模型中计算准确率.\n\n## 注意\n**1. W初始化**  \n首先介绍一下我们不应该做的事情（即初始化为0）。需要注意的是我们并不知道在训练神经网络中每一个权重最后的值，但是如果进行了恰当的数据归一化后，我们可以有理由认为有一半的权重是正的，另一半是负的。令所有权重都初始化为0这个一个听起来还蛮合理的想法也许是一个我们假设中最好的一个假设了。但结果正确是一个错误(的想法)，因为如果神经网络计算出来的输出值都一个样，那么反向传播算法计算出来的梯度值一样，并且参数更新值也一样(w=w−α∗dw)。更一般地说，如果权重初始化为同一个值，网络就不可能不对称(即是对称的)。\n\n**2. 梯度清零**  \n每次反向传播前需要将params的梯度清零，否则每次计算的梯度为上一个梯度的累加。\n\n**3. 反向传播**  \n计算的是给定图的叶子结点的梯度，对Loss函数进行反向传播计算所得即为所有的W与b。\n\n**4. python方法**  \nmethod()代表执行完该函数  \nmethod仅函数对象\n\n**5. 二分类问题不小心将最后一层设为10维**  \n最后训练出来的权重使得结果在0, 1上的概率更大，不排除最后的结果为2 ~ 9。\n\n**6. 网络的层次**  \n每一层为激活函数\n\n层数-1 为连接层 连接层对应[W, b]\n\nX = [batch_size * features]  \n\n- 第一层输入为([-1, features])  \n\n- 矩阵计算: [-1, features] * [W1(input_num, hidden_num)] + b1  \n\n- 隐藏层输入为(input_num, hidden_num)  \n\n- 矩阵计算: [-1, hidden_num] * [W2(hidden_num, output_num)] + b2  \n\n- 输出层为(hidden_num, output_num)  \n\n- 最终矩阵格式: [-1, output_num]\n\n**7. 特殊第一层input输入层**  \n输入的特征可能type为Long, 一定要转为float.  \nbatch_size与input_num无关, 但features一定与input_num相等.\n\n**8. X.permute**  \nmodel的forward必须要X.permute(1, 0)  \n`LSTM(batch_first=True)`没用？？？\n\n**9. python路径问题**  \n相对路径取决于调用该函数的python文件位置，不是子函数所在python文件相对于文件的位置。\n\n**10. pytorch使用GPU计算**  \n- 训练及评价集需要X.cuda()将数据移至GPU  \n- model与loss函数需要model.cuda(), loss.cuda()移至GPU\n\n**11. 导出数据**  \nTestLoader导出预测结果时，一定不能将导入的数据Shuffle!!!\n\n**12. pad**  \n`<pad>`对应一个随机生成的向量\n\n**13. torch.no_grad()**  \n- requires_grad=True 要求计算梯度\n- requires_grad=False 不要求计算梯度\n- with torch.no_grad()或者@torch.no_grad()中的数据不需要计算梯度，也不会进行反向传播\n\n即使一个tensor（命名为x）的requires_grad = True，由x得到的新tensor（命名为w-标量）requires_grad也为False，且grad_fn也为None,即不会对w求导。\n```py\nx = torch.randn(10, 5, requires_grad = True)\ny = torch.randn(10, 5, requires_grad = True)\nz = torch.randn(10, 5, requires_grad = True)\nwith torch.no_grad():\n    w = x + y + z\n    print(w.requires_grad)\n    print(w.grad_fn)\n    print(w.requires_grad)\nFalse\nNone\nFalse\n```\n\n**14. train()/eval()**  \n- 在训练模型时，前面加上`model.train()`  \n启用 BatchNormalization 和 Dropout\n\n- 在测试模型时，前面加上`model.eval()`  \n不启用 BatchNormalization 和 Dropout  \n即使不训练，它也会改变权值。这是model中含有batch normalization层所带来的的性质。\n\n\n## 问题\n最后一层输出不加激活函数 含义(最后预测值是数值最大的 因此没有影响)？？？\n\n隐藏层没有激活函数 含义？？？\n\n`LSTM(batch_first=True)`没用？？？\n\nembedding_layer(X)中X.shape为(batch,seq)或(seq,batch)没影响？？？\n若batch_first了embedding后要(batch,seq)后传入rnn？？？\n\nlstm门使用sigmoid代表门开程度，而不是四舍五入为0或1？？？\n\n\n\n## 词向量框架\n\n- 拿到每个样本\n- 每个样本分词\n- 构建词典{word: index}\n- 对每个Sample标准化处理， 长度不足补`<pad>`\n- 将每个Sample中的word对应index，没有的对应`<pad>`的index\n- 获取预训练的词向量\n","source":"_posts/nlp/week-2.md","raw":"# Week 2\n深度学习与神经网络基础，pytorch基础。\n\n## 神经网络训练过程\n\n- 将DataSet生成iter(train_iter, test_iter), 每个iter由X,y构成 (X:Sample的所有特征[samples * features], y:真实标签).\n- 计算y_hat (y_hat:通过构造的神经网络模型得到的预测值).\n- 计算损失函数 (均方差, 交叉熵).\n- 对所有params梯度清零.\n- loss.backward反向传播, 对损失函数求梯度, 也就是得所有的到权重和偏置的梯度param.grad.\n- params带入梯度下降算法, 更新params.\n- 每个epoch后, 将测试数据带入训练后的网络模型中计算准确率.\n\n## 注意\n**1. W初始化**  \n首先介绍一下我们不应该做的事情（即初始化为0）。需要注意的是我们并不知道在训练神经网络中每一个权重最后的值，但是如果进行了恰当的数据归一化后，我们可以有理由认为有一半的权重是正的，另一半是负的。令所有权重都初始化为0这个一个听起来还蛮合理的想法也许是一个我们假设中最好的一个假设了。但结果正确是一个错误(的想法)，因为如果神经网络计算出来的输出值都一个样，那么反向传播算法计算出来的梯度值一样，并且参数更新值也一样(w=w−α∗dw)。更一般地说，如果权重初始化为同一个值，网络就不可能不对称(即是对称的)。\n\n**2. 梯度清零**  \n每次反向传播前需要将params的梯度清零，否则每次计算的梯度为上一个梯度的累加。\n\n**3. 反向传播**  \n计算的是给定图的叶子结点的梯度，对Loss函数进行反向传播计算所得即为所有的W与b。\n\n**4. python方法**  \nmethod()代表执行完该函数  \nmethod仅函数对象\n\n**5. 二分类问题不小心将最后一层设为10维**  \n最后训练出来的权重使得结果在0, 1上的概率更大，不排除最后的结果为2 ~ 9。\n\n**6. 网络的层次**  \n每一层为激活函数\n\n层数-1 为连接层 连接层对应[W, b]\n\nX = [batch_size * features]  \n\n- 第一层输入为([-1, features])  \n\n- 矩阵计算: [-1, features] * [W1(input_num, hidden_num)] + b1  \n\n- 隐藏层输入为(input_num, hidden_num)  \n\n- 矩阵计算: [-1, hidden_num] * [W2(hidden_num, output_num)] + b2  \n\n- 输出层为(hidden_num, output_num)  \n\n- 最终矩阵格式: [-1, output_num]\n\n**7. 特殊第一层input输入层**  \n输入的特征可能type为Long, 一定要转为float.  \nbatch_size与input_num无关, 但features一定与input_num相等.\n\n**8. X.permute**  \nmodel的forward必须要X.permute(1, 0)  \n`LSTM(batch_first=True)`没用？？？\n\n**9. python路径问题**  \n相对路径取决于调用该函数的python文件位置，不是子函数所在python文件相对于文件的位置。\n\n**10. pytorch使用GPU计算**  \n- 训练及评价集需要X.cuda()将数据移至GPU  \n- model与loss函数需要model.cuda(), loss.cuda()移至GPU\n\n**11. 导出数据**  \nTestLoader导出预测结果时，一定不能将导入的数据Shuffle!!!\n\n**12. pad**  \n`<pad>`对应一个随机生成的向量\n\n**13. torch.no_grad()**  \n- requires_grad=True 要求计算梯度\n- requires_grad=False 不要求计算梯度\n- with torch.no_grad()或者@torch.no_grad()中的数据不需要计算梯度，也不会进行反向传播\n\n即使一个tensor（命名为x）的requires_grad = True，由x得到的新tensor（命名为w-标量）requires_grad也为False，且grad_fn也为None,即不会对w求导。\n```py\nx = torch.randn(10, 5, requires_grad = True)\ny = torch.randn(10, 5, requires_grad = True)\nz = torch.randn(10, 5, requires_grad = True)\nwith torch.no_grad():\n    w = x + y + z\n    print(w.requires_grad)\n    print(w.grad_fn)\n    print(w.requires_grad)\nFalse\nNone\nFalse\n```\n\n**14. train()/eval()**  \n- 在训练模型时，前面加上`model.train()`  \n启用 BatchNormalization 和 Dropout\n\n- 在测试模型时，前面加上`model.eval()`  \n不启用 BatchNormalization 和 Dropout  \n即使不训练，它也会改变权值。这是model中含有batch normalization层所带来的的性质。\n\n\n## 问题\n最后一层输出不加激活函数 含义(最后预测值是数值最大的 因此没有影响)？？？\n\n隐藏层没有激活函数 含义？？？\n\n`LSTM(batch_first=True)`没用？？？\n\nembedding_layer(X)中X.shape为(batch,seq)或(seq,batch)没影响？？？\n若batch_first了embedding后要(batch,seq)后传入rnn？？？\n\nlstm门使用sigmoid代表门开程度，而不是四舍五入为0或1？？？\n\n\n\n## 词向量框架\n\n- 拿到每个样本\n- 每个样本分词\n- 构建词典{word: index}\n- 对每个Sample标准化处理， 长度不足补`<pad>`\n- 将每个Sample中的word对应index，没有的对应`<pad>`的index\n- 获取预训练的词向量\n","slug":"nlp/week-2","published":1,"date":"2020-07-26T10:28:47.408Z","updated":"2020-08-14T04:10:32.196Z","title":"nlp/week-2","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982g00dc018o9w486l3x","content":"<h1 id=\"Week-2\"><a href=\"#Week-2\" class=\"headerlink\" title=\"Week 2\"></a>Week 2</h1><p>深度学习与神经网络基础，pytorch基础。</p>\n<h2 id=\"神经网络训练过程\"><a href=\"#神经网络训练过程\" class=\"headerlink\" title=\"神经网络训练过程\"></a>神经网络训练过程</h2><ul>\n<li>将DataSet生成iter(train_iter, test_iter), 每个iter由X,y构成 (X:Sample的所有特征[samples * features], y:真实标签).</li>\n<li>计算y_hat (y_hat:通过构造的神经网络模型得到的预测值).</li>\n<li>计算损失函数 (均方差, 交叉熵).</li>\n<li>对所有params梯度清零.</li>\n<li>loss.backward反向传播, 对损失函数求梯度, 也就是得所有的到权重和偏置的梯度param.grad.</li>\n<li>params带入梯度下降算法, 更新params.</li>\n<li>每个epoch后, 将测试数据带入训练后的网络模型中计算准确率.</li>\n</ul>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p><strong>1. W初始化</strong><br>首先介绍一下我们不应该做的事情（即初始化为0）。需要注意的是我们并不知道在训练神经网络中每一个权重最后的值，但是如果进行了恰当的数据归一化后，我们可以有理由认为有一半的权重是正的，另一半是负的。令所有权重都初始化为0这个一个听起来还蛮合理的想法也许是一个我们假设中最好的一个假设了。但结果正确是一个错误(的想法)，因为如果神经网络计算出来的输出值都一个样，那么反向传播算法计算出来的梯度值一样，并且参数更新值也一样(w=w−α∗dw)。更一般地说，如果权重初始化为同一个值，网络就不可能不对称(即是对称的)。</p>\n<p><strong>2. 梯度清零</strong><br>每次反向传播前需要将params的梯度清零，否则每次计算的梯度为上一个梯度的累加。</p>\n<p><strong>3. 反向传播</strong><br>计算的是给定图的叶子结点的梯度，对Loss函数进行反向传播计算所得即为所有的W与b。</p>\n<p><strong>4. python方法</strong><br>method()代表执行完该函数<br>method仅函数对象</p>\n<p><strong>5. 二分类问题不小心将最后一层设为10维</strong><br>最后训练出来的权重使得结果在0, 1上的概率更大，不排除最后的结果为2 ~ 9。</p>\n<p><strong>6. 网络的层次</strong><br>每一层为激活函数</p>\n<p>层数-1 为连接层 连接层对应[W, b]</p>\n<p>X = [batch_size * features]  </p>\n<ul>\n<li><p>第一层输入为([-1, features])  </p>\n</li>\n<li><p>矩阵计算: [-1, features] * [W1(input_num, hidden_num)] + b1  </p>\n</li>\n<li><p>隐藏层输入为(input_num, hidden_num)  </p>\n</li>\n<li><p>矩阵计算: [-1, hidden_num] * [W2(hidden_num, output_num)] + b2  </p>\n</li>\n<li><p>输出层为(hidden_num, output_num)  </p>\n</li>\n<li><p>最终矩阵格式: [-1, output_num]</p>\n</li>\n</ul>\n<p><strong>7. 特殊第一层input输入层</strong><br>输入的特征可能type为Long, 一定要转为float.<br>batch_size与input_num无关, 但features一定与input_num相等.</p>\n<p><strong>8. X.permute</strong><br>model的forward必须要X.permute(1, 0)<br><code>LSTM(batch_first=True)</code>没用？？？</p>\n<p><strong>9. python路径问题</strong><br>相对路径取决于调用该函数的python文件位置，不是子函数所在python文件相对于文件的位置。</p>\n<p><strong>10. pytorch使用GPU计算</strong>  </p>\n<ul>\n<li>训练及评价集需要X.cuda()将数据移至GPU  </li>\n<li>model与loss函数需要model.cuda(), loss.cuda()移至GPU</li>\n</ul>\n<p><strong>11. 导出数据</strong><br>TestLoader导出预测结果时，一定不能将导入的数据Shuffle!!!</p>\n<p><strong>12. pad</strong><br><code>&lt;pad&gt;</code>对应一个随机生成的向量</p>\n<p><strong>13. torch.no_grad()</strong>  </p>\n<ul>\n<li>requires_grad=True 要求计算梯度</li>\n<li>requires_grad=False 不要求计算梯度</li>\n<li>with torch.no_grad()或者@torch.no_grad()中的数据不需要计算梯度，也不会进行反向传播</li>\n</ul>\n<p>即使一个tensor（命名为x）的requires_grad = True，由x得到的新tensor（命名为w-标量）requires_grad也为False，且grad_fn也为None,即不会对w求导。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\">y = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\">z = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">    w = x + y + z</span><br><span class=\"line\">    print(w.requires_grad)</span><br><span class=\"line\">    print(w.grad_fn)</span><br><span class=\"line\">    print(w.requires_grad)</span><br><span class=\"line\"><span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"literal\">None</span></span><br><span class=\"line\"><span class=\"literal\">False</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>14. train()/eval()</strong>  </p>\n<ul>\n<li><p>在训练模型时，前面加上<code>model.train()</code><br>启用 BatchNormalization 和 Dropout</p>\n</li>\n<li><p>在测试模型时，前面加上<code>model.eval()</code><br>不启用 BatchNormalization 和 Dropout<br>即使不训练，它也会改变权值。这是model中含有batch normalization层所带来的的性质。</p>\n</li>\n</ul>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>最后一层输出不加激活函数 含义(最后预测值是数值最大的 因此没有影响)？？？</p>\n<p>隐藏层没有激活函数 含义？？？</p>\n<p><code>LSTM(batch_first=True)</code>没用？？？</p>\n<p>embedding_layer(X)中X.shape为(batch,seq)或(seq,batch)没影响？？？<br>若batch_first了embedding后要(batch,seq)后传入rnn？？？</p>\n<p>lstm门使用sigmoid代表门开程度，而不是四舍五入为0或1？？？</p>\n<h2 id=\"词向量框架\"><a href=\"#词向量框架\" class=\"headerlink\" title=\"词向量框架\"></a>词向量框架</h2><ul>\n<li>拿到每个样本</li>\n<li>每个样本分词</li>\n<li>构建词典{word: index}</li>\n<li>对每个Sample标准化处理， 长度不足补<code>&lt;pad&gt;</code></li>\n<li>将每个Sample中的word对应index，没有的对应<code>&lt;pad&gt;</code>的index</li>\n<li>获取预训练的词向量</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Week-2\"><a href=\"#Week-2\" class=\"headerlink\" title=\"Week 2\"></a>Week 2</h1><p>深度学习与神经网络基础，pytorch基础。</p>\n<h2 id=\"神经网络训练过程\"><a href=\"#神经网络训练过程\" class=\"headerlink\" title=\"神经网络训练过程\"></a>神经网络训练过程</h2><ul>\n<li>将DataSet生成iter(train_iter, test_iter), 每个iter由X,y构成 (X:Sample的所有特征[samples * features], y:真实标签).</li>\n<li>计算y_hat (y_hat:通过构造的神经网络模型得到的预测值).</li>\n<li>计算损失函数 (均方差, 交叉熵).</li>\n<li>对所有params梯度清零.</li>\n<li>loss.backward反向传播, 对损失函数求梯度, 也就是得所有的到权重和偏置的梯度param.grad.</li>\n<li>params带入梯度下降算法, 更新params.</li>\n<li>每个epoch后, 将测试数据带入训练后的网络模型中计算准确率.</li>\n</ul>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p><strong>1. W初始化</strong><br>首先介绍一下我们不应该做的事情（即初始化为0）。需要注意的是我们并不知道在训练神经网络中每一个权重最后的值，但是如果进行了恰当的数据归一化后，我们可以有理由认为有一半的权重是正的，另一半是负的。令所有权重都初始化为0这个一个听起来还蛮合理的想法也许是一个我们假设中最好的一个假设了。但结果正确是一个错误(的想法)，因为如果神经网络计算出来的输出值都一个样，那么反向传播算法计算出来的梯度值一样，并且参数更新值也一样(w=w−α∗dw)。更一般地说，如果权重初始化为同一个值，网络就不可能不对称(即是对称的)。</p>\n<p><strong>2. 梯度清零</strong><br>每次反向传播前需要将params的梯度清零，否则每次计算的梯度为上一个梯度的累加。</p>\n<p><strong>3. 反向传播</strong><br>计算的是给定图的叶子结点的梯度，对Loss函数进行反向传播计算所得即为所有的W与b。</p>\n<p><strong>4. python方法</strong><br>method()代表执行完该函数<br>method仅函数对象</p>\n<p><strong>5. 二分类问题不小心将最后一层设为10维</strong><br>最后训练出来的权重使得结果在0, 1上的概率更大，不排除最后的结果为2 ~ 9。</p>\n<p><strong>6. 网络的层次</strong><br>每一层为激活函数</p>\n<p>层数-1 为连接层 连接层对应[W, b]</p>\n<p>X = [batch_size * features]  </p>\n<ul>\n<li><p>第一层输入为([-1, features])  </p>\n</li>\n<li><p>矩阵计算: [-1, features] * [W1(input_num, hidden_num)] + b1  </p>\n</li>\n<li><p>隐藏层输入为(input_num, hidden_num)  </p>\n</li>\n<li><p>矩阵计算: [-1, hidden_num] * [W2(hidden_num, output_num)] + b2  </p>\n</li>\n<li><p>输出层为(hidden_num, output_num)  </p>\n</li>\n<li><p>最终矩阵格式: [-1, output_num]</p>\n</li>\n</ul>\n<p><strong>7. 特殊第一层input输入层</strong><br>输入的特征可能type为Long, 一定要转为float.<br>batch_size与input_num无关, 但features一定与input_num相等.</p>\n<p><strong>8. X.permute</strong><br>model的forward必须要X.permute(1, 0)<br><code>LSTM(batch_first=True)</code>没用？？？</p>\n<p><strong>9. python路径问题</strong><br>相对路径取决于调用该函数的python文件位置，不是子函数所在python文件相对于文件的位置。</p>\n<p><strong>10. pytorch使用GPU计算</strong>  </p>\n<ul>\n<li>训练及评价集需要X.cuda()将数据移至GPU  </li>\n<li>model与loss函数需要model.cuda(), loss.cuda()移至GPU</li>\n</ul>\n<p><strong>11. 导出数据</strong><br>TestLoader导出预测结果时，一定不能将导入的数据Shuffle!!!</p>\n<p><strong>12. pad</strong><br><code>&lt;pad&gt;</code>对应一个随机生成的向量</p>\n<p><strong>13. torch.no_grad()</strong>  </p>\n<ul>\n<li>requires_grad=True 要求计算梯度</li>\n<li>requires_grad=False 不要求计算梯度</li>\n<li>with torch.no_grad()或者@torch.no_grad()中的数据不需要计算梯度，也不会进行反向传播</li>\n</ul>\n<p>即使一个tensor（命名为x）的requires_grad = True，由x得到的新tensor（命名为w-标量）requires_grad也为False，且grad_fn也为None,即不会对w求导。</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\">y = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\">z = torch.randn(<span class=\"number\">10</span>, <span class=\"number\">5</span>, requires_grad = <span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">    w = x + y + z</span><br><span class=\"line\">    print(w.requires_grad)</span><br><span class=\"line\">    print(w.grad_fn)</span><br><span class=\"line\">    print(w.requires_grad)</span><br><span class=\"line\"><span class=\"literal\">False</span></span><br><span class=\"line\"><span class=\"literal\">None</span></span><br><span class=\"line\"><span class=\"literal\">False</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>14. train()/eval()</strong>  </p>\n<ul>\n<li><p>在训练模型时，前面加上<code>model.train()</code><br>启用 BatchNormalization 和 Dropout</p>\n</li>\n<li><p>在测试模型时，前面加上<code>model.eval()</code><br>不启用 BatchNormalization 和 Dropout<br>即使不训练，它也会改变权值。这是model中含有batch normalization层所带来的的性质。</p>\n</li>\n</ul>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>最后一层输出不加激活函数 含义(最后预测值是数值最大的 因此没有影响)？？？</p>\n<p>隐藏层没有激活函数 含义？？？</p>\n<p><code>LSTM(batch_first=True)</code>没用？？？</p>\n<p>embedding_layer(X)中X.shape为(batch,seq)或(seq,batch)没影响？？？<br>若batch_first了embedding后要(batch,seq)后传入rnn？？？</p>\n<p>lstm门使用sigmoid代表门开程度，而不是四舍五入为0或1？？？</p>\n<h2 id=\"词向量框架\"><a href=\"#词向量框架\" class=\"headerlink\" title=\"词向量框架\"></a>词向量框架</h2><ul>\n<li>拿到每个样本</li>\n<li>每个样本分词</li>\n<li>构建词典{word: index}</li>\n<li>对每个Sample标准化处理， 长度不足补<code>&lt;pad&gt;</code></li>\n<li>将每个Sample中的word对应index，没有的对应<code>&lt;pad&gt;</code>的index</li>\n<li>获取预训练的词向量</li>\n</ul>\n"},{"_content":"# NLP中处理文本方法\n\n由于文本是一种非架构化的数据，我们要将这种非结构化的数据转化为结构化的信息，这样我们才能对其进行处理。\n\n现在文本表示大致有三种方式。\n\n![img](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2020-02-17-guanxi.png)\n\n\n\n## One-Hot\n\n**向量中每一个位置代表一个词**\n\n**one-hot的缺点：**\n- 无法表达词语之间的关系\n- 这种过于稀疏的向量，导致计算和存储的效率不高\n\n\n\n## 整数编码\n\n**整数编码的缺点**\n- 无法表达词语之间的关系\n- 对于模型解释而言，整数编码可能具有挑战性\n\n\n\n## Word Embedding (词嵌入)\n\n优点：\n- 可以将文本通过一个低维向量来表达，不像one-hot长\n- 语义相似的词在向量空间上比较相近\n- 通用性强，可用在不同的任务中\n\n\n\n### Word2Vec\n\n基于统计方法来获得词向量的方法。\n\n两种训练模式：\n- 通过上下文来预测当前词(CBOW)\n- 通过当前词来预测上下文(Skip-gram)\n\n提高速度的优化方法：\n- Negtive Sample (负采样)\n- Hierarchical Softmax\n\n优点：\n- 由于Word2Vec会考虑上下文，跟之前的Embedding方法相比，效果要更好\n- 比之前的Embedding方法维度更少，速度更快\n- 通用性强，用于各种NLP任务\n\n**缺点：**\n- 由于词和向量是一对一的关系，所以多义词的问题无法解决\n- Word2Vec是一种静态的方式，虽然通用性强，但是无法针对特定任务做动态优化\n\n\n\n### GloVe\n\n实现有三步：\n- 根据语料库构建一个共现矩阵，矩阵中的每一个元素代表单词和上下文单词在特定大小的上下文窗口内共同出现的次数。\n- 构建词向量和共现矩阵之间的近似关系。\n- loss function\n\n\n\nReference\n\n词嵌入 | Word embedding\n\nhttps://easyai.tech/ai-definition/word-embedding/\n\nWord2vec\n\nhttps://easyai.tech/ai-definition/word2vec/\n\nGloVe详解\n\nhttp://www.fanyeong.com/2018/02/19/glove-in-detail/\n","source":"_posts/nlp/文本表示.md","raw":"# NLP中处理文本方法\n\n由于文本是一种非架构化的数据，我们要将这种非结构化的数据转化为结构化的信息，这样我们才能对其进行处理。\n\n现在文本表示大致有三种方式。\n\n![img](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2020-02-17-guanxi.png)\n\n\n\n## One-Hot\n\n**向量中每一个位置代表一个词**\n\n**one-hot的缺点：**\n- 无法表达词语之间的关系\n- 这种过于稀疏的向量，导致计算和存储的效率不高\n\n\n\n## 整数编码\n\n**整数编码的缺点**\n- 无法表达词语之间的关系\n- 对于模型解释而言，整数编码可能具有挑战性\n\n\n\n## Word Embedding (词嵌入)\n\n优点：\n- 可以将文本通过一个低维向量来表达，不像one-hot长\n- 语义相似的词在向量空间上比较相近\n- 通用性强，可用在不同的任务中\n\n\n\n### Word2Vec\n\n基于统计方法来获得词向量的方法。\n\n两种训练模式：\n- 通过上下文来预测当前词(CBOW)\n- 通过当前词来预测上下文(Skip-gram)\n\n提高速度的优化方法：\n- Negtive Sample (负采样)\n- Hierarchical Softmax\n\n优点：\n- 由于Word2Vec会考虑上下文，跟之前的Embedding方法相比，效果要更好\n- 比之前的Embedding方法维度更少，速度更快\n- 通用性强，用于各种NLP任务\n\n**缺点：**\n- 由于词和向量是一对一的关系，所以多义词的问题无法解决\n- Word2Vec是一种静态的方式，虽然通用性强，但是无法针对特定任务做动态优化\n\n\n\n### GloVe\n\n实现有三步：\n- 根据语料库构建一个共现矩阵，矩阵中的每一个元素代表单词和上下文单词在特定大小的上下文窗口内共同出现的次数。\n- 构建词向量和共现矩阵之间的近似关系。\n- loss function\n\n\n\nReference\n\n词嵌入 | Word embedding\n\nhttps://easyai.tech/ai-definition/word-embedding/\n\nWord2vec\n\nhttps://easyai.tech/ai-definition/word2vec/\n\nGloVe详解\n\nhttp://www.fanyeong.com/2018/02/19/glove-in-detail/\n","slug":"nlp/文本表示","published":1,"date":"2020-09-23T03:47:08.165Z","updated":"2020-11-11T16:30:47.196Z","title":"nlp/文本表示","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982h00df018o6x0tenga","content":"<h1 id=\"NLP中处理文本方法\"><a href=\"#NLP中处理文本方法\" class=\"headerlink\" title=\"NLP中处理文本方法\"></a>NLP中处理文本方法</h1><p>由于文本是一种非架构化的数据，我们要将这种非结构化的数据转化为结构化的信息，这样我们才能对其进行处理。</p>\n<p>现在文本表示大致有三种方式。</p>\n<p><img src=\"https://easy-ai.oss-cn-shanghai.aliyuncs.com/2020-02-17-guanxi.png\" alt=\"img\"></p>\n<h2 id=\"One-Hot\"><a href=\"#One-Hot\" class=\"headerlink\" title=\"One-Hot\"></a>One-Hot</h2><p><strong>向量中每一个位置代表一个词</strong></p>\n<p><strong>one-hot的缺点：</strong></p>\n<ul>\n<li>无法表达词语之间的关系</li>\n<li>这种过于稀疏的向量，导致计算和存储的效率不高</li>\n</ul>\n<h2 id=\"整数编码\"><a href=\"#整数编码\" class=\"headerlink\" title=\"整数编码\"></a>整数编码</h2><p><strong>整数编码的缺点</strong></p>\n<ul>\n<li>无法表达词语之间的关系</li>\n<li>对于模型解释而言，整数编码可能具有挑战性</li>\n</ul>\n<h2 id=\"Word-Embedding-词嵌入\"><a href=\"#Word-Embedding-词嵌入\" class=\"headerlink\" title=\"Word Embedding (词嵌入)\"></a>Word Embedding (词嵌入)</h2><p>优点：</p>\n<ul>\n<li>可以将文本通过一个低维向量来表达，不像one-hot长</li>\n<li>语义相似的词在向量空间上比较相近</li>\n<li>通用性强，可用在不同的任务中</li>\n</ul>\n<h3 id=\"Word2Vec\"><a href=\"#Word2Vec\" class=\"headerlink\" title=\"Word2Vec\"></a>Word2Vec</h3><p>基于统计方法来获得词向量的方法。</p>\n<p>两种训练模式：</p>\n<ul>\n<li>通过上下文来预测当前词(CBOW)</li>\n<li>通过当前词来预测上下文(Skip-gram)</li>\n</ul>\n<p>提高速度的优化方法：</p>\n<ul>\n<li>Negtive Sample (负采样)</li>\n<li>Hierarchical Softmax</li>\n</ul>\n<p>优点：</p>\n<ul>\n<li>由于Word2Vec会考虑上下文，跟之前的Embedding方法相比，效果要更好</li>\n<li>比之前的Embedding方法维度更少，速度更快</li>\n<li>通用性强，用于各种NLP任务</li>\n</ul>\n<p><strong>缺点：</strong></p>\n<ul>\n<li>由于词和向量是一对一的关系，所以多义词的问题无法解决</li>\n<li>Word2Vec是一种静态的方式，虽然通用性强，但是无法针对特定任务做动态优化</li>\n</ul>\n<h3 id=\"GloVe\"><a href=\"#GloVe\" class=\"headerlink\" title=\"GloVe\"></a>GloVe</h3><p>实现有三步：</p>\n<ul>\n<li>根据语料库构建一个共现矩阵，矩阵中的每一个元素代表单词和上下文单词在特定大小的上下文窗口内共同出现的次数。</li>\n<li>构建词向量和共现矩阵之间的近似关系。</li>\n<li>loss function</li>\n</ul>\n<p>Reference</p>\n<p>词嵌入 | Word embedding</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3dvcmQtZW1iZWRkaW5nLw==\">https://easyai.tech/ai-definition/word-embedding/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>Word2vec</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3dvcmQydmVjLw==\">https://easyai.tech/ai-definition/word2vec/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>GloVe详解</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5mYW55ZW9uZy5jb20vMjAxOC8wMi8xOS9nbG92ZS1pbi1kZXRhaWwv\">http://www.fanyeong.com/2018/02/19/glove-in-detail/<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"NLP中处理文本方法\"><a href=\"#NLP中处理文本方法\" class=\"headerlink\" title=\"NLP中处理文本方法\"></a>NLP中处理文本方法</h1><p>由于文本是一种非架构化的数据，我们要将这种非结构化的数据转化为结构化的信息，这样我们才能对其进行处理。</p>\n<p>现在文本表示大致有三种方式。</p>\n<p><img src=\"https://easy-ai.oss-cn-shanghai.aliyuncs.com/2020-02-17-guanxi.png\" alt=\"img\"></p>\n<h2 id=\"One-Hot\"><a href=\"#One-Hot\" class=\"headerlink\" title=\"One-Hot\"></a>One-Hot</h2><p><strong>向量中每一个位置代表一个词</strong></p>\n<p><strong>one-hot的缺点：</strong></p>\n<ul>\n<li>无法表达词语之间的关系</li>\n<li>这种过于稀疏的向量，导致计算和存储的效率不高</li>\n</ul>\n<h2 id=\"整数编码\"><a href=\"#整数编码\" class=\"headerlink\" title=\"整数编码\"></a>整数编码</h2><p><strong>整数编码的缺点</strong></p>\n<ul>\n<li>无法表达词语之间的关系</li>\n<li>对于模型解释而言，整数编码可能具有挑战性</li>\n</ul>\n<h2 id=\"Word-Embedding-词嵌入\"><a href=\"#Word-Embedding-词嵌入\" class=\"headerlink\" title=\"Word Embedding (词嵌入)\"></a>Word Embedding (词嵌入)</h2><p>优点：</p>\n<ul>\n<li>可以将文本通过一个低维向量来表达，不像one-hot长</li>\n<li>语义相似的词在向量空间上比较相近</li>\n<li>通用性强，可用在不同的任务中</li>\n</ul>\n<h3 id=\"Word2Vec\"><a href=\"#Word2Vec\" class=\"headerlink\" title=\"Word2Vec\"></a>Word2Vec</h3><p>基于统计方法来获得词向量的方法。</p>\n<p>两种训练模式：</p>\n<ul>\n<li>通过上下文来预测当前词(CBOW)</li>\n<li>通过当前词来预测上下文(Skip-gram)</li>\n</ul>\n<p>提高速度的优化方法：</p>\n<ul>\n<li>Negtive Sample (负采样)</li>\n<li>Hierarchical Softmax</li>\n</ul>\n<p>优点：</p>\n<ul>\n<li>由于Word2Vec会考虑上下文，跟之前的Embedding方法相比，效果要更好</li>\n<li>比之前的Embedding方法维度更少，速度更快</li>\n<li>通用性强，用于各种NLP任务</li>\n</ul>\n<p><strong>缺点：</strong></p>\n<ul>\n<li>由于词和向量是一对一的关系，所以多义词的问题无法解决</li>\n<li>Word2Vec是一种静态的方式，虽然通用性强，但是无法针对特定任务做动态优化</li>\n</ul>\n<h3 id=\"GloVe\"><a href=\"#GloVe\" class=\"headerlink\" title=\"GloVe\"></a>GloVe</h3><p>实现有三步：</p>\n<ul>\n<li>根据语料库构建一个共现矩阵，矩阵中的每一个元素代表单词和上下文单词在特定大小的上下文窗口内共同出现的次数。</li>\n<li>构建词向量和共现矩阵之间的近似关系。</li>\n<li>loss function</li>\n</ul>\n<p>Reference</p>\n<p>词嵌入 | Word embedding</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3dvcmQtZW1iZWRkaW5nLw==\">https://easyai.tech/ai-definition/word-embedding/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>Word2vec</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lYXN5YWkudGVjaC9haS1kZWZpbml0aW9uL3dvcmQydmVjLw==\">https://easyai.tech/ai-definition/word2vec/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>GloVe详解</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5mYW55ZW9uZy5jb20vMjAxOC8wMi8xOS9nbG92ZS1pbi1kZXRhaWwv\">http://www.fanyeong.com/2018/02/19/glove-in-detail/<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models","_content":"\n## Abstract\n\n对于多视图的异常检测提出了概率隐变量模型。\n\n## Introduction\n\n多视图的异常检测与传统的单视图的异常检测不同。单视图的异常检测发现那些与预期行为不符的实例。图1显示了在一个2个视图的数据上，一个多视图异常与一个单视图异常的不同。M是一个多视图异常，M在不同的视图上属于不同的聚类，且M的视图不连续。S是一个单视图异常，S在任何视图上与其它实例都很远。然而，视图S与其它实例有相同的关系。\n\nS不是一个多视图的异常。单视图的异常检测方法，例如SVM或是基于张量的异常检测，就认为S是异常的。另一方面我们想开发一个多视图的异常检测方法去检测M是否为异常而不是S。尽管单视图的异常不是普遍的实例，如果他们是不连续的跨了多个视图，多视图的异常检测会是主要的成分。\n\n我们针对多视图的异常检测提出了一个概率隐空间变量模型。有一个隐空间跨了所有视图。我们假设正常实例的所有视图都是用一个单一隐向量生成。另一方面，一个异常实例被假设有多个隐向量，它的不同视图使用不同的隐向量生成。\n\n每一个非多视图的两个视图的异常(?)可以由隐向量生成。另一方面，两个视图的多视图异常M不是连续的，由两个视图使用映射向量生成。\n\n对于每个实例的隐向量的数量是未知的，我们根据数据使用Dirichlet priors自动的推测。预测模型是基于EM算法。\n\n在E-step中...\n\n在M-step中...\n\n通过迭代E,M-steps我们推测每一个实例使用的隐向量，并计算它的异常分数通过使用多余一个隐向量的可能性。\n\n## Conclusion\n\n先生成隐向量，只要拿到隐向量，就可以通过**EM算法**，对类别进行判断。\n\n","source":"_posts/paper_read/AnomalyDetectionViaRobust.md","raw":"---\ntitle: Multi-view Anomaly Detection via Robust Probabilistic Latent Variable Models\ncategories:\n- Paper\ntags:\n- paper\n---\n\n## Abstract\n\n对于多视图的异常检测提出了概率隐变量模型。\n\n## Introduction\n\n多视图的异常检测与传统的单视图的异常检测不同。单视图的异常检测发现那些与预期行为不符的实例。图1显示了在一个2个视图的数据上，一个多视图异常与一个单视图异常的不同。M是一个多视图异常，M在不同的视图上属于不同的聚类，且M的视图不连续。S是一个单视图异常，S在任何视图上与其它实例都很远。然而，视图S与其它实例有相同的关系。\n\nS不是一个多视图的异常。单视图的异常检测方法，例如SVM或是基于张量的异常检测，就认为S是异常的。另一方面我们想开发一个多视图的异常检测方法去检测M是否为异常而不是S。尽管单视图的异常不是普遍的实例，如果他们是不连续的跨了多个视图，多视图的异常检测会是主要的成分。\n\n我们针对多视图的异常检测提出了一个概率隐空间变量模型。有一个隐空间跨了所有视图。我们假设正常实例的所有视图都是用一个单一隐向量生成。另一方面，一个异常实例被假设有多个隐向量，它的不同视图使用不同的隐向量生成。\n\n每一个非多视图的两个视图的异常(?)可以由隐向量生成。另一方面，两个视图的多视图异常M不是连续的，由两个视图使用映射向量生成。\n\n对于每个实例的隐向量的数量是未知的，我们根据数据使用Dirichlet priors自动的推测。预测模型是基于EM算法。\n\n在E-step中...\n\n在M-step中...\n\n通过迭代E,M-steps我们推测每一个实例使用的隐向量，并计算它的异常分数通过使用多余一个隐向量的可能性。\n\n## Conclusion\n\n先生成隐向量，只要拿到隐向量，就可以通过**EM算法**，对类别进行判断。\n\n","slug":"paper_read/AnomalyDetectionViaRobust","published":1,"date":"2021-01-15T05:24:35.971Z","updated":"2021-02-04T05:49:35.465Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982i00dh018o21jjht95","content":"<h2 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h2><p>对于多视图的异常检测提出了概率隐变量模型。</p>\n<h2 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h2><p>多视图的异常检测与传统的单视图的异常检测不同。单视图的异常检测发现那些与预期行为不符的实例。图1显示了在一个2个视图的数据上，一个多视图异常与一个单视图异常的不同。M是一个多视图异常，M在不同的视图上属于不同的聚类，且M的视图不连续。S是一个单视图异常，S在任何视图上与其它实例都很远。然而，视图S与其它实例有相同的关系。</p>\n<p>S不是一个多视图的异常。单视图的异常检测方法，例如SVM或是基于张量的异常检测，就认为S是异常的。另一方面我们想开发一个多视图的异常检测方法去检测M是否为异常而不是S。尽管单视图的异常不是普遍的实例，如果他们是不连续的跨了多个视图，多视图的异常检测会是主要的成分。</p>\n<p>我们针对多视图的异常检测提出了一个概率隐空间变量模型。有一个隐空间跨了所有视图。我们假设正常实例的所有视图都是用一个单一隐向量生成。另一方面，一个异常实例被假设有多个隐向量，它的不同视图使用不同的隐向量生成。</p>\n<p>每一个非多视图的两个视图的异常(?)可以由隐向量生成。另一方面，两个视图的多视图异常M不是连续的，由两个视图使用映射向量生成。</p>\n<p>对于每个实例的隐向量的数量是未知的，我们根据数据使用Dirichlet priors自动的推测。预测模型是基于EM算法。</p>\n<p>在E-step中…</p>\n<p>在M-step中…</p>\n<p>通过迭代E,M-steps我们推测每一个实例使用的隐向量，并计算它的异常分数通过使用多余一个隐向量的可能性。</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>先生成隐向量，只要拿到隐向量，就可以通过<strong>EM算法</strong>，对类别进行判断。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h2><p>对于多视图的异常检测提出了概率隐变量模型。</p>\n<h2 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h2><p>多视图的异常检测与传统的单视图的异常检测不同。单视图的异常检测发现那些与预期行为不符的实例。图1显示了在一个2个视图的数据上，一个多视图异常与一个单视图异常的不同。M是一个多视图异常，M在不同的视图上属于不同的聚类，且M的视图不连续。S是一个单视图异常，S在任何视图上与其它实例都很远。然而，视图S与其它实例有相同的关系。</p>\n<p>S不是一个多视图的异常。单视图的异常检测方法，例如SVM或是基于张量的异常检测，就认为S是异常的。另一方面我们想开发一个多视图的异常检测方法去检测M是否为异常而不是S。尽管单视图的异常不是普遍的实例，如果他们是不连续的跨了多个视图，多视图的异常检测会是主要的成分。</p>\n<p>我们针对多视图的异常检测提出了一个概率隐空间变量模型。有一个隐空间跨了所有视图。我们假设正常实例的所有视图都是用一个单一隐向量生成。另一方面，一个异常实例被假设有多个隐向量，它的不同视图使用不同的隐向量生成。</p>\n<p>每一个非多视图的两个视图的异常(?)可以由隐向量生成。另一方面，两个视图的多视图异常M不是连续的，由两个视图使用映射向量生成。</p>\n<p>对于每个实例的隐向量的数量是未知的，我们根据数据使用Dirichlet priors自动的推测。预测模型是基于EM算法。</p>\n<p>在E-step中…</p>\n<p>在M-step中…</p>\n<p>通过迭代E,M-steps我们推测每一个实例使用的隐向量，并计算它的异常分数通过使用多余一个隐向量的可能性。</p>\n<h2 id=\"Conclusion\"><a href=\"#Conclusion\" class=\"headerlink\" title=\"Conclusion\"></a>Conclusion</h2><p>先生成隐向量，只要拿到隐向量，就可以通过<strong>EM算法</strong>，对类别进行判断。</p>\n"},{"_content":"# Transformer\n\n","source":"_posts/paper_read/Attention-Transformer.md","raw":"# Transformer\n\n","slug":"paper_read/Attention-Transformer","published":1,"date":"2020-09-18T13:39:50.128Z","updated":"2020-09-18T13:40:18.024Z","title":"paper_read/Attention-Transformer","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982i00dj018o0ssrd1gd","content":"<h1 id=\"Transformer\"><a href=\"#Transformer\" class=\"headerlink\" title=\"Transformer\"></a>Transformer</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Transformer\"><a href=\"#Transformer\" class=\"headerlink\" title=\"Transformer\"></a>Transformer</h1>"},{"title":"Attention Is All You Need","_content":"\n# Attention Is All You Need\n\n## Abstract\n\n我们提出一种全新的简洁的网络架构--Transfomer，它完全基于Attention机制，舍弃了循环与卷积。\n\n## 1 Introduction\n\nTransformer的并行性很好的解决了RNN模型的序列化输入输出。\n\n## 2 Background\n\n## 3 Model Architecture\n\n大部分序列神经网络模型都具有encoder-decoder结构。\n\n### 3.1 Encoder and Decoder Stacks\n\nencoder由6个相同的层构成，每一层有两个子层。第一个是一个多Attention机制，第二个是一个简单的全连接feed-forward网络。两个子层中间部署一个参差网络，后接一个正则化。\n\ndecoder也是由6个相同的层构成。除了两个子层外中间还加入了一个第三子层Multi-head Attention.\n\n### 3.2 Attention\n\nAttention的核心内容是为输入向量的每个单词(512d)学习一个权重。在self-attention中，每个单词有3个不同的向量，Query，Key，Value，长度均是64. 他们通过3个不同的权值矩阵由嵌入向量X乘以三个不同的权值矩阵WQ，WK，WV(512 * 64)得到。\n\nAttention计算步骤：\n- 将输入单词转换成词向量\n- 根据词向量得到q, k, v三个向量\n- 为每个向量计算一个score: score = q * kT\n- 为了梯度的稳定，Transformer使用了score归一化，即除以根号dk\n- 对score过一遍softmax函数\n- softmax点乘value得到每个输入向量的评分v\n- 想家之后得到最终的输出结果z=∑v\n\n### 3.3 Multi-Head Attention\n\nMulti-Head Attention相当于h个不同的self-attention的集成。\n\nMulti-Head输出分三步\n- 将X分别输入到8个self-attention中得到8个加权后的特征矩阵Z\n- 将8个Z按列拼接成一个大的特征矩阵\n- 将特征矩阵经过一层fc后得到输出Z\n\n### 3.4 损失层\n\n解码器解码后，解码的特征向量通过一层激活函数为softmax的全连接层之后得到反应每个单词概率的输出向量。此时通过CTC等损失函数训练模型。\n\n## 4 位置编码\n\nTransfomer无法捕捉循序序列的能力。论文在编码词向量时引入了位置编码的特征，位置编码会在词向量中加入单词的位置信息。\n\n在上式中， [公式] 表示单词的位置， [公式] 表示单词的维度。关于位置编码的实现可在Google开源的算法中get_timing_signal_1d()函数找到对应的代码。\n\n作者这么设计的原因是考虑到在NLP任务重，除了单词的绝对位置，单词的相对位置也非常重要。根据公式 [公式] 以及[公式] ，这表明位置 [公式] 的位置向量可以表示为位置 [公式] 的特征向量的线性变化，这为模型捕捉单词之间的相对位置关系提供了非常大的便利。\n\n## 问题\n\n位置编码对词袋模型等具有普适性？\nencoder/decoder通过self-attention层所得到的向量即理解为加密/解密？\n得到最后的Z之后怎么用？","source":"_posts/paper_read/Attention.md","raw":"---\ntitle: Attention Is All You Need\ncategories:\n- Paper\ntags:\n- attention\n---\n\n# Attention Is All You Need\n\n## Abstract\n\n我们提出一种全新的简洁的网络架构--Transfomer，它完全基于Attention机制，舍弃了循环与卷积。\n\n## 1 Introduction\n\nTransformer的并行性很好的解决了RNN模型的序列化输入输出。\n\n## 2 Background\n\n## 3 Model Architecture\n\n大部分序列神经网络模型都具有encoder-decoder结构。\n\n### 3.1 Encoder and Decoder Stacks\n\nencoder由6个相同的层构成，每一层有两个子层。第一个是一个多Attention机制，第二个是一个简单的全连接feed-forward网络。两个子层中间部署一个参差网络，后接一个正则化。\n\ndecoder也是由6个相同的层构成。除了两个子层外中间还加入了一个第三子层Multi-head Attention.\n\n### 3.2 Attention\n\nAttention的核心内容是为输入向量的每个单词(512d)学习一个权重。在self-attention中，每个单词有3个不同的向量，Query，Key，Value，长度均是64. 他们通过3个不同的权值矩阵由嵌入向量X乘以三个不同的权值矩阵WQ，WK，WV(512 * 64)得到。\n\nAttention计算步骤：\n- 将输入单词转换成词向量\n- 根据词向量得到q, k, v三个向量\n- 为每个向量计算一个score: score = q * kT\n- 为了梯度的稳定，Transformer使用了score归一化，即除以根号dk\n- 对score过一遍softmax函数\n- softmax点乘value得到每个输入向量的评分v\n- 想家之后得到最终的输出结果z=∑v\n\n### 3.3 Multi-Head Attention\n\nMulti-Head Attention相当于h个不同的self-attention的集成。\n\nMulti-Head输出分三步\n- 将X分别输入到8个self-attention中得到8个加权后的特征矩阵Z\n- 将8个Z按列拼接成一个大的特征矩阵\n- 将特征矩阵经过一层fc后得到输出Z\n\n### 3.4 损失层\n\n解码器解码后，解码的特征向量通过一层激活函数为softmax的全连接层之后得到反应每个单词概率的输出向量。此时通过CTC等损失函数训练模型。\n\n## 4 位置编码\n\nTransfomer无法捕捉循序序列的能力。论文在编码词向量时引入了位置编码的特征，位置编码会在词向量中加入单词的位置信息。\n\n在上式中， [公式] 表示单词的位置， [公式] 表示单词的维度。关于位置编码的实现可在Google开源的算法中get_timing_signal_1d()函数找到对应的代码。\n\n作者这么设计的原因是考虑到在NLP任务重，除了单词的绝对位置，单词的相对位置也非常重要。根据公式 [公式] 以及[公式] ，这表明位置 [公式] 的位置向量可以表示为位置 [公式] 的特征向量的线性变化，这为模型捕捉单词之间的相对位置关系提供了非常大的便利。\n\n## 问题\n\n位置编码对词袋模型等具有普适性？\nencoder/decoder通过self-attention层所得到的向量即理解为加密/解密？\n得到最后的Z之后怎么用？","slug":"paper_read/Attention","published":1,"date":"2020-09-13T12:32:41.635Z","updated":"2021-02-04T05:49:28.793Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982j00dk018o1yl4ar8p","content":"<h1 id=\"Attention-Is-All-You-Need\"><a href=\"#Attention-Is-All-You-Need\" class=\"headerlink\" title=\"Attention Is All You Need\"></a>Attention Is All You Need</h1><h2 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h2><p>我们提出一种全新的简洁的网络架构–Transfomer，它完全基于Attention机制，舍弃了循环与卷积。</p>\n<h2 id=\"1-Introduction\"><a href=\"#1-Introduction\" class=\"headerlink\" title=\"1 Introduction\"></a>1 Introduction</h2><p>Transformer的并行性很好的解决了RNN模型的序列化输入输出。</p>\n<h2 id=\"2-Background\"><a href=\"#2-Background\" class=\"headerlink\" title=\"2 Background\"></a>2 Background</h2><h2 id=\"3-Model-Architecture\"><a href=\"#3-Model-Architecture\" class=\"headerlink\" title=\"3 Model Architecture\"></a>3 Model Architecture</h2><p>大部分序列神经网络模型都具有encoder-decoder结构。</p>\n<h3 id=\"3-1-Encoder-and-Decoder-Stacks\"><a href=\"#3-1-Encoder-and-Decoder-Stacks\" class=\"headerlink\" title=\"3.1 Encoder and Decoder Stacks\"></a>3.1 Encoder and Decoder Stacks</h3><p>encoder由6个相同的层构成，每一层有两个子层。第一个是一个多Attention机制，第二个是一个简单的全连接feed-forward网络。两个子层中间部署一个参差网络，后接一个正则化。</p>\n<p>decoder也是由6个相同的层构成。除了两个子层外中间还加入了一个第三子层Multi-head Attention.</p>\n<h3 id=\"3-2-Attention\"><a href=\"#3-2-Attention\" class=\"headerlink\" title=\"3.2 Attention\"></a>3.2 Attention</h3><p>Attention的核心内容是为输入向量的每个单词(512d)学习一个权重。在self-attention中，每个单词有3个不同的向量，Query，Key，Value，长度均是64. 他们通过3个不同的权值矩阵由嵌入向量X乘以三个不同的权值矩阵WQ，WK，WV(512 * 64)得到。</p>\n<p>Attention计算步骤：</p>\n<ul>\n<li>将输入单词转换成词向量</li>\n<li>根据词向量得到q, k, v三个向量</li>\n<li>为每个向量计算一个score: score = q * kT</li>\n<li>为了梯度的稳定，Transformer使用了score归一化，即除以根号dk</li>\n<li>对score过一遍softmax函数</li>\n<li>softmax点乘value得到每个输入向量的评分v</li>\n<li>想家之后得到最终的输出结果z=∑v</li>\n</ul>\n<h3 id=\"3-3-Multi-Head-Attention\"><a href=\"#3-3-Multi-Head-Attention\" class=\"headerlink\" title=\"3.3 Multi-Head Attention\"></a>3.3 Multi-Head Attention</h3><p>Multi-Head Attention相当于h个不同的self-attention的集成。</p>\n<p>Multi-Head输出分三步</p>\n<ul>\n<li>将X分别输入到8个self-attention中得到8个加权后的特征矩阵Z</li>\n<li>将8个Z按列拼接成一个大的特征矩阵</li>\n<li>将特征矩阵经过一层fc后得到输出Z</li>\n</ul>\n<h3 id=\"3-4-损失层\"><a href=\"#3-4-损失层\" class=\"headerlink\" title=\"3.4 损失层\"></a>3.4 损失层</h3><p>解码器解码后，解码的特征向量通过一层激活函数为softmax的全连接层之后得到反应每个单词概率的输出向量。此时通过CTC等损失函数训练模型。</p>\n<h2 id=\"4-位置编码\"><a href=\"#4-位置编码\" class=\"headerlink\" title=\"4 位置编码\"></a>4 位置编码</h2><p>Transfomer无法捕捉循序序列的能力。论文在编码词向量时引入了位置编码的特征，位置编码会在词向量中加入单词的位置信息。</p>\n<p>在上式中， [公式] 表示单词的位置， [公式] 表示单词的维度。关于位置编码的实现可在Google开源的算法中get_timing_signal_1d()函数找到对应的代码。</p>\n<p>作者这么设计的原因是考虑到在NLP任务重，除了单词的绝对位置，单词的相对位置也非常重要。根据公式 [公式] 以及[公式] ，这表明位置 [公式] 的位置向量可以表示为位置 [公式] 的特征向量的线性变化，这为模型捕捉单词之间的相对位置关系提供了非常大的便利。</p>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>位置编码对词袋模型等具有普适性？<br>encoder/decoder通过self-attention层所得到的向量即理解为加密/解密？<br>得到最后的Z之后怎么用？</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Attention-Is-All-You-Need\"><a href=\"#Attention-Is-All-You-Need\" class=\"headerlink\" title=\"Attention Is All You Need\"></a>Attention Is All You Need</h1><h2 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h2><p>我们提出一种全新的简洁的网络架构–Transfomer，它完全基于Attention机制，舍弃了循环与卷积。</p>\n<h2 id=\"1-Introduction\"><a href=\"#1-Introduction\" class=\"headerlink\" title=\"1 Introduction\"></a>1 Introduction</h2><p>Transformer的并行性很好的解决了RNN模型的序列化输入输出。</p>\n<h2 id=\"2-Background\"><a href=\"#2-Background\" class=\"headerlink\" title=\"2 Background\"></a>2 Background</h2><h2 id=\"3-Model-Architecture\"><a href=\"#3-Model-Architecture\" class=\"headerlink\" title=\"3 Model Architecture\"></a>3 Model Architecture</h2><p>大部分序列神经网络模型都具有encoder-decoder结构。</p>\n<h3 id=\"3-1-Encoder-and-Decoder-Stacks\"><a href=\"#3-1-Encoder-and-Decoder-Stacks\" class=\"headerlink\" title=\"3.1 Encoder and Decoder Stacks\"></a>3.1 Encoder and Decoder Stacks</h3><p>encoder由6个相同的层构成，每一层有两个子层。第一个是一个多Attention机制，第二个是一个简单的全连接feed-forward网络。两个子层中间部署一个参差网络，后接一个正则化。</p>\n<p>decoder也是由6个相同的层构成。除了两个子层外中间还加入了一个第三子层Multi-head Attention.</p>\n<h3 id=\"3-2-Attention\"><a href=\"#3-2-Attention\" class=\"headerlink\" title=\"3.2 Attention\"></a>3.2 Attention</h3><p>Attention的核心内容是为输入向量的每个单词(512d)学习一个权重。在self-attention中，每个单词有3个不同的向量，Query，Key，Value，长度均是64. 他们通过3个不同的权值矩阵由嵌入向量X乘以三个不同的权值矩阵WQ，WK，WV(512 * 64)得到。</p>\n<p>Attention计算步骤：</p>\n<ul>\n<li>将输入单词转换成词向量</li>\n<li>根据词向量得到q, k, v三个向量</li>\n<li>为每个向量计算一个score: score = q * kT</li>\n<li>为了梯度的稳定，Transformer使用了score归一化，即除以根号dk</li>\n<li>对score过一遍softmax函数</li>\n<li>softmax点乘value得到每个输入向量的评分v</li>\n<li>想家之后得到最终的输出结果z=∑v</li>\n</ul>\n<h3 id=\"3-3-Multi-Head-Attention\"><a href=\"#3-3-Multi-Head-Attention\" class=\"headerlink\" title=\"3.3 Multi-Head Attention\"></a>3.3 Multi-Head Attention</h3><p>Multi-Head Attention相当于h个不同的self-attention的集成。</p>\n<p>Multi-Head输出分三步</p>\n<ul>\n<li>将X分别输入到8个self-attention中得到8个加权后的特征矩阵Z</li>\n<li>将8个Z按列拼接成一个大的特征矩阵</li>\n<li>将特征矩阵经过一层fc后得到输出Z</li>\n</ul>\n<h3 id=\"3-4-损失层\"><a href=\"#3-4-损失层\" class=\"headerlink\" title=\"3.4 损失层\"></a>3.4 损失层</h3><p>解码器解码后，解码的特征向量通过一层激活函数为softmax的全连接层之后得到反应每个单词概率的输出向量。此时通过CTC等损失函数训练模型。</p>\n<h2 id=\"4-位置编码\"><a href=\"#4-位置编码\" class=\"headerlink\" title=\"4 位置编码\"></a>4 位置编码</h2><p>Transfomer无法捕捉循序序列的能力。论文在编码词向量时引入了位置编码的特征，位置编码会在词向量中加入单词的位置信息。</p>\n<p>在上式中， [公式] 表示单词的位置， [公式] 表示单词的维度。关于位置编码的实现可在Google开源的算法中get_timing_signal_1d()函数找到对应的代码。</p>\n<p>作者这么设计的原因是考虑到在NLP任务重，除了单词的绝对位置，单词的相对位置也非常重要。根据公式 [公式] 以及[公式] ，这表明位置 [公式] 的位置向量可以表示为位置 [公式] 的特征向量的线性变化，这为模型捕捉单词之间的相对位置关系提供了非常大的便利。</p>\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>位置编码对词袋模型等具有普适性？<br>encoder/decoder通过self-attention层所得到的向量即理解为加密/解密？<br>得到最后的Z之后怎么用？</p>\n"},{"title":"XLNet","_content":"\n# XLNet Generalized Autoregressive Pretraining for Language Understanding\n\n# Abstract\n\nBert基于去噪自编码器的预训练模型，性能优于自回归语言模型的预训练方法。而由于mask一部分输入，bert忽略了被mask位置之间的依赖关系。\n\nXLNet基于此优缺点可以\n- 通过最大化所有可能的因式分解顺序的对数似然，学习双向语境信息\n- 用自回归本身的特点克服bert的缺点\n- 融合了自回归模型Transformer-XT的思路\n\n作者从自回归(autoregressive)和自编码(autoencoding)两大范式分析了当前的预训练语言模型。\n\n# 1 介绍\n## 1.1 AutoRegression与AutoEncoding两大阵营\n\nXLNet是一个类似BERT的模型，XLNet是一种通用的自回归预训练方法。\n\n### 自回归(AutoRegression)语言模型\n\nAR语言模型是一种使用上下文词来预测下一个词的模型，但是上下文单词被限制在两个方向，前向和后向。(例如：GPT，GPT-2)\n\n![img-前向后向](https://img-blog.csdnimg.cn/20190810224951812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70)\n\nAR语言模型擅长生成式NLP任务，生成上下文时总是前向的。\n\n但是AR只能使用前向上下文或后向上下文，这意味着它不能同时使用前向和后向上下文。\n\n### 自编码(AutoEncoding)语言模型\n\nBERT被归类为自编码器语言模型。AE旨在从损坏的输入中重建原始数据。\n\n损坏的输入意味着我们在预训练阶段用[MASK]替换原始词，目标是预测得到原始句子。\n![img-双向](https://img-blog.csdnimg.cn/20190810225020688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70)\n\nAE语言模型的优势是，它可以从前向和后向的方向看到上下文。\n\nAE语言模型的缺点是\n- [MASK]这种人为的符号在调优时在真实数据中并不存在，会导致预训练-调优的差异(pretrain-finetune discrepancy)\n- [MASK]假设mask词在给定未mask词的情况下彼此独立（例：住房危机已经变成银行业危机。 其忽略了 银行业 与 危机 间的关系）。\n\n## 1.2 两大阵营需要新的XLNet\n\nXLNet提出了一种让AR语言模型从双向上下文中学习的新方法，以避免[MASK]方法在AE语言模型中带来的缺点。\n\nXLNet是一种泛化自回归(AR)方法，既集合了AR和AE方法的优势，又避免了二者的缺陷。\n- XLNet不使用传统AR模型中固定的前向或后向因式分解顺序，而是最大化所有可能因式分解顺序的期望对数似然，由于对因式分解顺序的排列操作，每个位置的语境都包含来自左侧和右侧的token。因此，每个位置都能学习来自所有位置的语境信息，即捕获双向语境。\n- 作为一个泛化自回归(AR)模型，XLNet不依赖残缺数据。不会有BERT的预训练-微调差异。自回归目标提供一种自然的方式，来利用乘法法则对预测token的联合概率执行因式分解(factorize)，这消除了BERT中的独立性假设。\n- XLNet将Transformer-XL的分割循环机制和相对编码范式整合到预训练中。\n\n\n\n# 2 Proposed Solution\n\n## 2.1 在自回归模型中引入双向语言模型基本思想\n\nXLNet仍然遵循两阶段的过程(pretrain fine-tune)。其主要希望改动第一阶段的过程，即不像BERT那样带[MASK]的Denoising-autoencoder的模式，而是采用AR语言模型的模式。\n\n简单来说就是，输入句子X仍然使自左向右的输入，看到Ti单词的上文Context-before来预测Ti这个单词，又希望Context-before例不仅看到上文单词又能看到后面的Context-after里的下文单词。这样一来BERT预训练阶段引入的[MASK]符号就不需要了。\n\n基本思想：在预训练阶段引入Permutation LM的训练目标。\n\n举例：比如包含单词Ti的当前输入的句子X，由顺序的几个单词构成x1, x2, x3, x4四个单词顺序组成。假设x3为要预测的单词Ti，其所在的位置为Position 3，要想让它能够在上文Context-before中，也就是Pos 1或Pos 2的位置看到Pos 4的单词x4。可以这么做，假设固定住x3的位置，也就是仍在x3，之后随机排列组合句子中的4个单词，在所有可能里训责一部分作为模型的预训练的输入X。比如随机排列组合后x4, x2, x3, x1这样一个排列组合作为模型的输入X。于是x3就能同时看到上文x2以及下文x4的内容了。\n\n![img-permutation-language-model](https://pic3.zhimg.com/80/v2-05d785e9d8f810d118e4fa93f8e9b39f_1440w.jpg)\n\n看上去仍然是个自回归的从左到右的模型，但是其实通过对句子中单词排列组合，把一部分Ti下文的单词排到Ti上文位置中，于是就看到了上文和下文，但是形式上看上去仍然是从左到右在预测后一个单词。\n\n## 2.2 具体实现\n\n尽管基本思想里提到把句子X的单词排列组合后，再随机抽取例子作为输入，但实际上不可以，因为Fine-tune阶段不可能去排列组合原始输入。所以必须让预训练阶段的输入部分**看上去**仍然是x1, x2, x3, x4这个顺序，但是可以在Transformer部分做些工作，来达成目标。\n\nXLNet采取了Attention掩码机制，输入的X没有任何变化，单词Ti还是第i个单词，前面有1到i-1个单词。但是Transformer内部，通过Attention掩码从X的输入单词里，也就是Ti的Context-before和Context-after中随机选择i-1个单词，放到Ti的Context-before上，把其他单词的输入通过Attention掩码隐藏掉。（当然这个所谓放到Ti的上文位置，只是一种形象的说法，其实在内部，就是通过Attention Mask，把其它没有被选到的单词Mask掉，不让它们在预测单词Ti的时候发生作用，如此而已。看着就类似于把这些被选中的单词放到了上文Context_before的位置了）。\n\nXLNet是用**双流自注意力模型**实现的。一个是内容流自注意力，其实就是标准的Transformer的计算过程，主要引入了Query流自注意力。其实就是用来替代[MASK]标记的，XLNet因为要抛弃[MASK]又不能看到x3的输入，于是Query流就直接忽略掉x3的输入，只保留这个位置信息，用参数w来代表位置的embedding编码。**其实XLNet只是抛弃了[MASK]这个占位符号，内部还是引入Query流来忽略掉被MASK的这个单词。和BERT比只是实现方式不同而已**。\n\n![img-two-stream-attention](https://picb.zhimg.com/80/v2-2bb1a60af4fe2fa751647fdce48e337c_1440w.jpg)\n\n如图所示，输入序列仍是x1, x2, x3, x4，通过不同的掩码矩阵，让当前单词Xi只能看到被排列组合后的顺序x3->x2->x4->x1中自己前面的单词。\n\n\n\n## 2.3 XLNet与BERT\n\n通过改造BERT预训练的过程，其实可以模拟XLNet的PLM过程。\n\n第一种思路：Bert目前的做法是，给定输入句子X，随机Mask掉15%的单词，然后要求利用剩下的85%的单词去预测任意一个被Mask掉的单词。对于输入句子，随机选择X中的任意i个单词，只用这i个单词去预测被Mask的单词。这个过程理论上可以在Transformer内采用Attention Mask来实现，这样BERT的预训练模型就和XLNet基本等价了。\n\n第二种思路：假设仍使用BERT目前的Mask机制，将Mask 15%改为，每次一个句子只Mask掉一个单词，利用剩下的单词来预测被Mask掉的单词。因为XLNet在实现的时候，为了提升效率，其实是选择每个句子最后末尾的1/K个单词被预测，假设K=7，意味着一个句子X，只有末尾的1/7的单词会被预测。这样两者基本是等价的。\n\nXLNet维持了自回归(AR)语言模型的从左向右的模式，这个BERT做不到。明显的好处是，对于生成类的任务，能够在维持表面从左向右的生成过程前提下，模型里隐含了上下文的信息。XLNet貌似应该对于生成类型的NLP任务，会比BERT又明显优势。此外，XLNet还引入了Transformer XL机制，所以对于长文档输入类型的NLP任务，也会比BERT有明显优势。\n\n\n\n## 3 总结\nPermutation Language Model是XLNet的主要理论创新，**它开启了自回归(AR)语言模型如何引入下文的一个思路**。\n\nXLNet也相当于是BERT, GPT2.0, Transformer XL的综合体。\n- 通过Permutation LM 预训练目标，吸收了BERT的双向语言模型；\n- 吸收了GPT2.0使用更多更高质量的预训练数据；\n- 吸收了Transformer XL的主要思想。\n\nXLNet其实本质上还是ELMO/GPT/BERT这一系列两阶段模型的进一步延伸。在自回归(AR)语言模型方向引入双向语言模型打开了新思路。\n\n未来预期\n- Transformer天然对长文档任务处理有弱点，所以XLNet对于长文档NLP任务相比BERT应该有直接且比较明显的性能提升；\n- 对于生成类的NLP任务，XLNet的预训练模式符合下游任务序列生成结果。\n\n\n\n----\nRreference\n\nhttps://zhuanlan.zhihu.com/p/70257427\n\nhttps://blog.csdn.net/weixin_37947156/article/details/93035607\n\n\n\n\n\n\n// AR AE LM 实现步骤？  \n// TODO Transformer 较于 RNN？  \n// TODO encoding decoding？    \n// TODO denoising-autoencoder?  \n\n\n\n// TODO Transformer-XL 分割循环机制 相对编码范式??  \n// TODO BERT 预训练-微调两阶段模式(pretrain fine-tune) 抛弃mask使两阶段保持一致？ fine-tune阶段？  \n// TODO AR模型前向后向因式分解顺序？  \n","source":"_posts/paper_read/XLNet.md","raw":"---\ntitle: XLNet\ncategories:\n- Paper\n- NLP\ntags:\n- XLNet\n---\n\n# XLNet Generalized Autoregressive Pretraining for Language Understanding\n\n# Abstract\n\nBert基于去噪自编码器的预训练模型，性能优于自回归语言模型的预训练方法。而由于mask一部分输入，bert忽略了被mask位置之间的依赖关系。\n\nXLNet基于此优缺点可以\n- 通过最大化所有可能的因式分解顺序的对数似然，学习双向语境信息\n- 用自回归本身的特点克服bert的缺点\n- 融合了自回归模型Transformer-XT的思路\n\n作者从自回归(autoregressive)和自编码(autoencoding)两大范式分析了当前的预训练语言模型。\n\n# 1 介绍\n## 1.1 AutoRegression与AutoEncoding两大阵营\n\nXLNet是一个类似BERT的模型，XLNet是一种通用的自回归预训练方法。\n\n### 自回归(AutoRegression)语言模型\n\nAR语言模型是一种使用上下文词来预测下一个词的模型，但是上下文单词被限制在两个方向，前向和后向。(例如：GPT，GPT-2)\n\n![img-前向后向](https://img-blog.csdnimg.cn/20190810224951812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70)\n\nAR语言模型擅长生成式NLP任务，生成上下文时总是前向的。\n\n但是AR只能使用前向上下文或后向上下文，这意味着它不能同时使用前向和后向上下文。\n\n### 自编码(AutoEncoding)语言模型\n\nBERT被归类为自编码器语言模型。AE旨在从损坏的输入中重建原始数据。\n\n损坏的输入意味着我们在预训练阶段用[MASK]替换原始词，目标是预测得到原始句子。\n![img-双向](https://img-blog.csdnimg.cn/20190810225020688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70)\n\nAE语言模型的优势是，它可以从前向和后向的方向看到上下文。\n\nAE语言模型的缺点是\n- [MASK]这种人为的符号在调优时在真实数据中并不存在，会导致预训练-调优的差异(pretrain-finetune discrepancy)\n- [MASK]假设mask词在给定未mask词的情况下彼此独立（例：住房危机已经变成银行业危机。 其忽略了 银行业 与 危机 间的关系）。\n\n## 1.2 两大阵营需要新的XLNet\n\nXLNet提出了一种让AR语言模型从双向上下文中学习的新方法，以避免[MASK]方法在AE语言模型中带来的缺点。\n\nXLNet是一种泛化自回归(AR)方法，既集合了AR和AE方法的优势，又避免了二者的缺陷。\n- XLNet不使用传统AR模型中固定的前向或后向因式分解顺序，而是最大化所有可能因式分解顺序的期望对数似然，由于对因式分解顺序的排列操作，每个位置的语境都包含来自左侧和右侧的token。因此，每个位置都能学习来自所有位置的语境信息，即捕获双向语境。\n- 作为一个泛化自回归(AR)模型，XLNet不依赖残缺数据。不会有BERT的预训练-微调差异。自回归目标提供一种自然的方式，来利用乘法法则对预测token的联合概率执行因式分解(factorize)，这消除了BERT中的独立性假设。\n- XLNet将Transformer-XL的分割循环机制和相对编码范式整合到预训练中。\n\n\n\n# 2 Proposed Solution\n\n## 2.1 在自回归模型中引入双向语言模型基本思想\n\nXLNet仍然遵循两阶段的过程(pretrain fine-tune)。其主要希望改动第一阶段的过程，即不像BERT那样带[MASK]的Denoising-autoencoder的模式，而是采用AR语言模型的模式。\n\n简单来说就是，输入句子X仍然使自左向右的输入，看到Ti单词的上文Context-before来预测Ti这个单词，又希望Context-before例不仅看到上文单词又能看到后面的Context-after里的下文单词。这样一来BERT预训练阶段引入的[MASK]符号就不需要了。\n\n基本思想：在预训练阶段引入Permutation LM的训练目标。\n\n举例：比如包含单词Ti的当前输入的句子X，由顺序的几个单词构成x1, x2, x3, x4四个单词顺序组成。假设x3为要预测的单词Ti，其所在的位置为Position 3，要想让它能够在上文Context-before中，也就是Pos 1或Pos 2的位置看到Pos 4的单词x4。可以这么做，假设固定住x3的位置，也就是仍在x3，之后随机排列组合句子中的4个单词，在所有可能里训责一部分作为模型的预训练的输入X。比如随机排列组合后x4, x2, x3, x1这样一个排列组合作为模型的输入X。于是x3就能同时看到上文x2以及下文x4的内容了。\n\n![img-permutation-language-model](https://pic3.zhimg.com/80/v2-05d785e9d8f810d118e4fa93f8e9b39f_1440w.jpg)\n\n看上去仍然是个自回归的从左到右的模型，但是其实通过对句子中单词排列组合，把一部分Ti下文的单词排到Ti上文位置中，于是就看到了上文和下文，但是形式上看上去仍然是从左到右在预测后一个单词。\n\n## 2.2 具体实现\n\n尽管基本思想里提到把句子X的单词排列组合后，再随机抽取例子作为输入，但实际上不可以，因为Fine-tune阶段不可能去排列组合原始输入。所以必须让预训练阶段的输入部分**看上去**仍然是x1, x2, x3, x4这个顺序，但是可以在Transformer部分做些工作，来达成目标。\n\nXLNet采取了Attention掩码机制，输入的X没有任何变化，单词Ti还是第i个单词，前面有1到i-1个单词。但是Transformer内部，通过Attention掩码从X的输入单词里，也就是Ti的Context-before和Context-after中随机选择i-1个单词，放到Ti的Context-before上，把其他单词的输入通过Attention掩码隐藏掉。（当然这个所谓放到Ti的上文位置，只是一种形象的说法，其实在内部，就是通过Attention Mask，把其它没有被选到的单词Mask掉，不让它们在预测单词Ti的时候发生作用，如此而已。看着就类似于把这些被选中的单词放到了上文Context_before的位置了）。\n\nXLNet是用**双流自注意力模型**实现的。一个是内容流自注意力，其实就是标准的Transformer的计算过程，主要引入了Query流自注意力。其实就是用来替代[MASK]标记的，XLNet因为要抛弃[MASK]又不能看到x3的输入，于是Query流就直接忽略掉x3的输入，只保留这个位置信息，用参数w来代表位置的embedding编码。**其实XLNet只是抛弃了[MASK]这个占位符号，内部还是引入Query流来忽略掉被MASK的这个单词。和BERT比只是实现方式不同而已**。\n\n![img-two-stream-attention](https://picb.zhimg.com/80/v2-2bb1a60af4fe2fa751647fdce48e337c_1440w.jpg)\n\n如图所示，输入序列仍是x1, x2, x3, x4，通过不同的掩码矩阵，让当前单词Xi只能看到被排列组合后的顺序x3->x2->x4->x1中自己前面的单词。\n\n\n\n## 2.3 XLNet与BERT\n\n通过改造BERT预训练的过程，其实可以模拟XLNet的PLM过程。\n\n第一种思路：Bert目前的做法是，给定输入句子X，随机Mask掉15%的单词，然后要求利用剩下的85%的单词去预测任意一个被Mask掉的单词。对于输入句子，随机选择X中的任意i个单词，只用这i个单词去预测被Mask的单词。这个过程理论上可以在Transformer内采用Attention Mask来实现，这样BERT的预训练模型就和XLNet基本等价了。\n\n第二种思路：假设仍使用BERT目前的Mask机制，将Mask 15%改为，每次一个句子只Mask掉一个单词，利用剩下的单词来预测被Mask掉的单词。因为XLNet在实现的时候，为了提升效率，其实是选择每个句子最后末尾的1/K个单词被预测，假设K=7，意味着一个句子X，只有末尾的1/7的单词会被预测。这样两者基本是等价的。\n\nXLNet维持了自回归(AR)语言模型的从左向右的模式，这个BERT做不到。明显的好处是，对于生成类的任务，能够在维持表面从左向右的生成过程前提下，模型里隐含了上下文的信息。XLNet貌似应该对于生成类型的NLP任务，会比BERT又明显优势。此外，XLNet还引入了Transformer XL机制，所以对于长文档输入类型的NLP任务，也会比BERT有明显优势。\n\n\n\n## 3 总结\nPermutation Language Model是XLNet的主要理论创新，**它开启了自回归(AR)语言模型如何引入下文的一个思路**。\n\nXLNet也相当于是BERT, GPT2.0, Transformer XL的综合体。\n- 通过Permutation LM 预训练目标，吸收了BERT的双向语言模型；\n- 吸收了GPT2.0使用更多更高质量的预训练数据；\n- 吸收了Transformer XL的主要思想。\n\nXLNet其实本质上还是ELMO/GPT/BERT这一系列两阶段模型的进一步延伸。在自回归(AR)语言模型方向引入双向语言模型打开了新思路。\n\n未来预期\n- Transformer天然对长文档任务处理有弱点，所以XLNet对于长文档NLP任务相比BERT应该有直接且比较明显的性能提升；\n- 对于生成类的NLP任务，XLNet的预训练模式符合下游任务序列生成结果。\n\n\n\n----\nRreference\n\nhttps://zhuanlan.zhihu.com/p/70257427\n\nhttps://blog.csdn.net/weixin_37947156/article/details/93035607\n\n\n\n\n\n\n// AR AE LM 实现步骤？  \n// TODO Transformer 较于 RNN？  \n// TODO encoding decoding？    \n// TODO denoising-autoencoder?  \n\n\n\n// TODO Transformer-XL 分割循环机制 相对编码范式??  \n// TODO BERT 预训练-微调两阶段模式(pretrain fine-tune) 抛弃mask使两阶段保持一致？ fine-tune阶段？  \n// TODO AR模型前向后向因式分解顺序？  \n","slug":"paper_read/XLNet","published":1,"date":"2020-09-18T09:33:11.939Z","updated":"2021-02-04T05:49:16.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982k00dm018ofum7aqed","content":"<h1 id=\"XLNet-Generalized-Autoregressive-Pretraining-for-Language-Understanding\"><a href=\"#XLNet-Generalized-Autoregressive-Pretraining-for-Language-Understanding\" class=\"headerlink\" title=\"XLNet Generalized Autoregressive Pretraining for Language Understanding\"></a>XLNet Generalized Autoregressive Pretraining for Language Understanding</h1><h1 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h1><p>Bert基于去噪自编码器的预训练模型，性能优于自回归语言模型的预训练方法。而由于mask一部分输入，bert忽略了被mask位置之间的依赖关系。</p>\n<p>XLNet基于此优缺点可以</p>\n<ul>\n<li>通过最大化所有可能的因式分解顺序的对数似然，学习双向语境信息</li>\n<li>用自回归本身的特点克服bert的缺点</li>\n<li>融合了自回归模型Transformer-XT的思路</li>\n</ul>\n<p>作者从自回归(autoregressive)和自编码(autoencoding)两大范式分析了当前的预训练语言模型。</p>\n<h1 id=\"1-介绍\"><a href=\"#1-介绍\" class=\"headerlink\" title=\"1 介绍\"></a>1 介绍</h1><h2 id=\"1-1-AutoRegression与AutoEncoding两大阵营\"><a href=\"#1-1-AutoRegression与AutoEncoding两大阵营\" class=\"headerlink\" title=\"1.1 AutoRegression与AutoEncoding两大阵营\"></a>1.1 AutoRegression与AutoEncoding两大阵营</h2><p>XLNet是一个类似BERT的模型，XLNet是一种通用的自回归预训练方法。</p>\n<h3 id=\"自回归-AutoRegression-语言模型\"><a href=\"#自回归-AutoRegression-语言模型\" class=\"headerlink\" title=\"自回归(AutoRegression)语言模型\"></a>自回归(AutoRegression)语言模型</h3><p>AR语言模型是一种使用上下文词来预测下一个词的模型，但是上下文单词被限制在两个方向，前向和后向。(例如：GPT，GPT-2)</p>\n<p><img src=\"https://img-blog.csdnimg.cn/20190810224951812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70\" alt=\"img-前向后向\"></p>\n<p>AR语言模型擅长生成式NLP任务，生成上下文时总是前向的。</p>\n<p>但是AR只能使用前向上下文或后向上下文，这意味着它不能同时使用前向和后向上下文。</p>\n<h3 id=\"自编码-AutoEncoding-语言模型\"><a href=\"#自编码-AutoEncoding-语言模型\" class=\"headerlink\" title=\"自编码(AutoEncoding)语言模型\"></a>自编码(AutoEncoding)语言模型</h3><p>BERT被归类为自编码器语言模型。AE旨在从损坏的输入中重建原始数据。</p>\n<p>损坏的输入意味着我们在预训练阶段用[MASK]替换原始词，目标是预测得到原始句子。<br><img src=\"https://img-blog.csdnimg.cn/20190810225020688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70\" alt=\"img-双向\"></p>\n<p>AE语言模型的优势是，它可以从前向和后向的方向看到上下文。</p>\n<p>AE语言模型的缺点是</p>\n<ul>\n<li>[MASK]这种人为的符号在调优时在真实数据中并不存在，会导致预训练-调优的差异(pretrain-finetune discrepancy)</li>\n<li>[MASK]假设mask词在给定未mask词的情况下彼此独立（例：住房危机已经变成银行业危机。 其忽略了 银行业 与 危机 间的关系）。</li>\n</ul>\n<h2 id=\"1-2-两大阵营需要新的XLNet\"><a href=\"#1-2-两大阵营需要新的XLNet\" class=\"headerlink\" title=\"1.2 两大阵营需要新的XLNet\"></a>1.2 两大阵营需要新的XLNet</h2><p>XLNet提出了一种让AR语言模型从双向上下文中学习的新方法，以避免[MASK]方法在AE语言模型中带来的缺点。</p>\n<p>XLNet是一种泛化自回归(AR)方法，既集合了AR和AE方法的优势，又避免了二者的缺陷。</p>\n<ul>\n<li>XLNet不使用传统AR模型中固定的前向或后向因式分解顺序，而是最大化所有可能因式分解顺序的期望对数似然，由于对因式分解顺序的排列操作，每个位置的语境都包含来自左侧和右侧的token。因此，每个位置都能学习来自所有位置的语境信息，即捕获双向语境。</li>\n<li>作为一个泛化自回归(AR)模型，XLNet不依赖残缺数据。不会有BERT的预训练-微调差异。自回归目标提供一种自然的方式，来利用乘法法则对预测token的联合概率执行因式分解(factorize)，这消除了BERT中的独立性假设。</li>\n<li>XLNet将Transformer-XL的分割循环机制和相对编码范式整合到预训练中。</li>\n</ul>\n<h1 id=\"2-Proposed-Solution\"><a href=\"#2-Proposed-Solution\" class=\"headerlink\" title=\"2 Proposed Solution\"></a>2 Proposed Solution</h1><h2 id=\"2-1-在自回归模型中引入双向语言模型基本思想\"><a href=\"#2-1-在自回归模型中引入双向语言模型基本思想\" class=\"headerlink\" title=\"2.1 在自回归模型中引入双向语言模型基本思想\"></a>2.1 在自回归模型中引入双向语言模型基本思想</h2><p>XLNet仍然遵循两阶段的过程(pretrain fine-tune)。其主要希望改动第一阶段的过程，即不像BERT那样带[MASK]的Denoising-autoencoder的模式，而是采用AR语言模型的模式。</p>\n<p>简单来说就是，输入句子X仍然使自左向右的输入，看到Ti单词的上文Context-before来预测Ti这个单词，又希望Context-before例不仅看到上文单词又能看到后面的Context-after里的下文单词。这样一来BERT预训练阶段引入的[MASK]符号就不需要了。</p>\n<p>基本思想：在预训练阶段引入Permutation LM的训练目标。</p>\n<p>举例：比如包含单词Ti的当前输入的句子X，由顺序的几个单词构成x1, x2, x3, x4四个单词顺序组成。假设x3为要预测的单词Ti，其所在的位置为Position 3，要想让它能够在上文Context-before中，也就是Pos 1或Pos 2的位置看到Pos 4的单词x4。可以这么做，假设固定住x3的位置，也就是仍在x3，之后随机排列组合句子中的4个单词，在所有可能里训责一部分作为模型的预训练的输入X。比如随机排列组合后x4, x2, x3, x1这样一个排列组合作为模型的输入X。于是x3就能同时看到上文x2以及下文x4的内容了。</p>\n<p><img src=\"https://pic3.zhimg.com/80/v2-05d785e9d8f810d118e4fa93f8e9b39f_1440w.jpg\" alt=\"img-permutation-language-model\"></p>\n<p>看上去仍然是个自回归的从左到右的模型，但是其实通过对句子中单词排列组合，把一部分Ti下文的单词排到Ti上文位置中，于是就看到了上文和下文，但是形式上看上去仍然是从左到右在预测后一个单词。</p>\n<h2 id=\"2-2-具体实现\"><a href=\"#2-2-具体实现\" class=\"headerlink\" title=\"2.2 具体实现\"></a>2.2 具体实现</h2><p>尽管基本思想里提到把句子X的单词排列组合后，再随机抽取例子作为输入，但实际上不可以，因为Fine-tune阶段不可能去排列组合原始输入。所以必须让预训练阶段的输入部分<strong>看上去</strong>仍然是x1, x2, x3, x4这个顺序，但是可以在Transformer部分做些工作，来达成目标。</p>\n<p>XLNet采取了Attention掩码机制，输入的X没有任何变化，单词Ti还是第i个单词，前面有1到i-1个单词。但是Transformer内部，通过Attention掩码从X的输入单词里，也就是Ti的Context-before和Context-after中随机选择i-1个单词，放到Ti的Context-before上，把其他单词的输入通过Attention掩码隐藏掉。（当然这个所谓放到Ti的上文位置，只是一种形象的说法，其实在内部，就是通过Attention Mask，把其它没有被选到的单词Mask掉，不让它们在预测单词Ti的时候发生作用，如此而已。看着就类似于把这些被选中的单词放到了上文Context_before的位置了）。</p>\n<p>XLNet是用<strong>双流自注意力模型</strong>实现的。一个是内容流自注意力，其实就是标准的Transformer的计算过程，主要引入了Query流自注意力。其实就是用来替代[MASK]标记的，XLNet因为要抛弃[MASK]又不能看到x3的输入，于是Query流就直接忽略掉x3的输入，只保留这个位置信息，用参数w来代表位置的embedding编码。<strong>其实XLNet只是抛弃了[MASK]这个占位符号，内部还是引入Query流来忽略掉被MASK的这个单词。和BERT比只是实现方式不同而已</strong>。</p>\n<p><img src=\"https://picb.zhimg.com/80/v2-2bb1a60af4fe2fa751647fdce48e337c_1440w.jpg\" alt=\"img-two-stream-attention\"></p>\n<p>如图所示，输入序列仍是x1, x2, x3, x4，通过不同的掩码矩阵，让当前单词Xi只能看到被排列组合后的顺序x3-&gt;x2-&gt;x4-&gt;x1中自己前面的单词。</p>\n<h2 id=\"2-3-XLNet与BERT\"><a href=\"#2-3-XLNet与BERT\" class=\"headerlink\" title=\"2.3 XLNet与BERT\"></a>2.3 XLNet与BERT</h2><p>通过改造BERT预训练的过程，其实可以模拟XLNet的PLM过程。</p>\n<p>第一种思路：Bert目前的做法是，给定输入句子X，随机Mask掉15%的单词，然后要求利用剩下的85%的单词去预测任意一个被Mask掉的单词。对于输入句子，随机选择X中的任意i个单词，只用这i个单词去预测被Mask的单词。这个过程理论上可以在Transformer内采用Attention Mask来实现，这样BERT的预训练模型就和XLNet基本等价了。</p>\n<p>第二种思路：假设仍使用BERT目前的Mask机制，将Mask 15%改为，每次一个句子只Mask掉一个单词，利用剩下的单词来预测被Mask掉的单词。因为XLNet在实现的时候，为了提升效率，其实是选择每个句子最后末尾的1/K个单词被预测，假设K=7，意味着一个句子X，只有末尾的1/7的单词会被预测。这样两者基本是等价的。</p>\n<p>XLNet维持了自回归(AR)语言模型的从左向右的模式，这个BERT做不到。明显的好处是，对于生成类的任务，能够在维持表面从左向右的生成过程前提下，模型里隐含了上下文的信息。XLNet貌似应该对于生成类型的NLP任务，会比BERT又明显优势。此外，XLNet还引入了Transformer XL机制，所以对于长文档输入类型的NLP任务，也会比BERT有明显优势。</p>\n<h2 id=\"3-总结\"><a href=\"#3-总结\" class=\"headerlink\" title=\"3 总结\"></a>3 总结</h2><p>Permutation Language Model是XLNet的主要理论创新，<strong>它开启了自回归(AR)语言模型如何引入下文的一个思路</strong>。</p>\n<p>XLNet也相当于是BERT, GPT2.0, Transformer XL的综合体。</p>\n<ul>\n<li>通过Permutation LM 预训练目标，吸收了BERT的双向语言模型；</li>\n<li>吸收了GPT2.0使用更多更高质量的预训练数据；</li>\n<li>吸收了Transformer XL的主要思想。</li>\n</ul>\n<p>XLNet其实本质上还是ELMO/GPT/BERT这一系列两阶段模型的进一步延伸。在自回归(AR)语言模型方向引入双向语言模型打开了新思路。</p>\n<p>未来预期</p>\n<ul>\n<li>Transformer天然对长文档任务处理有弱点，所以XLNet对于长文档NLP任务相比BERT应该有直接且比较明显的性能提升；</li>\n<li>对于生成类的NLP任务，XLNet的预训练模式符合下游任务序列生成结果。</li>\n</ul>\n<hr>\n<p>Rreference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC83MDI1NzQyNw==\">https://zhuanlan.zhihu.com/p/70257427<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ni9hcnRpY2xlL2RldGFpbHMvOTMwMzU2MDc=\">https://blog.csdn.net/weixin_37947156/article/details/93035607<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>// AR AE LM 实现步骤？<br>// TODO Transformer 较于 RNN？<br>// TODO encoding decoding？<br>// TODO denoising-autoencoder?  </p>\n<p>// TODO Transformer-XL 分割循环机制 相对编码范式??<br>// TODO BERT 预训练-微调两阶段模式(pretrain fine-tune) 抛弃mask使两阶段保持一致？ fine-tune阶段？<br>// TODO AR模型前向后向因式分解顺序？  </p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"XLNet-Generalized-Autoregressive-Pretraining-for-Language-Understanding\"><a href=\"#XLNet-Generalized-Autoregressive-Pretraining-for-Language-Understanding\" class=\"headerlink\" title=\"XLNet Generalized Autoregressive Pretraining for Language Understanding\"></a>XLNet Generalized Autoregressive Pretraining for Language Understanding</h1><h1 id=\"Abstract\"><a href=\"#Abstract\" class=\"headerlink\" title=\"Abstract\"></a>Abstract</h1><p>Bert基于去噪自编码器的预训练模型，性能优于自回归语言模型的预训练方法。而由于mask一部分输入，bert忽略了被mask位置之间的依赖关系。</p>\n<p>XLNet基于此优缺点可以</p>\n<ul>\n<li>通过最大化所有可能的因式分解顺序的对数似然，学习双向语境信息</li>\n<li>用自回归本身的特点克服bert的缺点</li>\n<li>融合了自回归模型Transformer-XT的思路</li>\n</ul>\n<p>作者从自回归(autoregressive)和自编码(autoencoding)两大范式分析了当前的预训练语言模型。</p>\n<h1 id=\"1-介绍\"><a href=\"#1-介绍\" class=\"headerlink\" title=\"1 介绍\"></a>1 介绍</h1><h2 id=\"1-1-AutoRegression与AutoEncoding两大阵营\"><a href=\"#1-1-AutoRegression与AutoEncoding两大阵营\" class=\"headerlink\" title=\"1.1 AutoRegression与AutoEncoding两大阵营\"></a>1.1 AutoRegression与AutoEncoding两大阵营</h2><p>XLNet是一个类似BERT的模型，XLNet是一种通用的自回归预训练方法。</p>\n<h3 id=\"自回归-AutoRegression-语言模型\"><a href=\"#自回归-AutoRegression-语言模型\" class=\"headerlink\" title=\"自回归(AutoRegression)语言模型\"></a>自回归(AutoRegression)语言模型</h3><p>AR语言模型是一种使用上下文词来预测下一个词的模型，但是上下文单词被限制在两个方向，前向和后向。(例如：GPT，GPT-2)</p>\n<p><img src=\"https://img-blog.csdnimg.cn/20190810224951812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70\" alt=\"img-前向后向\"></p>\n<p>AR语言模型擅长生成式NLP任务，生成上下文时总是前向的。</p>\n<p>但是AR只能使用前向上下文或后向上下文，这意味着它不能同时使用前向和后向上下文。</p>\n<h3 id=\"自编码-AutoEncoding-语言模型\"><a href=\"#自编码-AutoEncoding-语言模型\" class=\"headerlink\" title=\"自编码(AutoEncoding)语言模型\"></a>自编码(AutoEncoding)语言模型</h3><p>BERT被归类为自编码器语言模型。AE旨在从损坏的输入中重建原始数据。</p>\n<p>损坏的输入意味着我们在预训练阶段用[MASK]替换原始词，目标是预测得到原始句子。<br><img src=\"https://img-blog.csdnimg.cn/20190810225020688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ng==,size_16,color_FFFFFF,t_70\" alt=\"img-双向\"></p>\n<p>AE语言模型的优势是，它可以从前向和后向的方向看到上下文。</p>\n<p>AE语言模型的缺点是</p>\n<ul>\n<li>[MASK]这种人为的符号在调优时在真实数据中并不存在，会导致预训练-调优的差异(pretrain-finetune discrepancy)</li>\n<li>[MASK]假设mask词在给定未mask词的情况下彼此独立（例：住房危机已经变成银行业危机。 其忽略了 银行业 与 危机 间的关系）。</li>\n</ul>\n<h2 id=\"1-2-两大阵营需要新的XLNet\"><a href=\"#1-2-两大阵营需要新的XLNet\" class=\"headerlink\" title=\"1.2 两大阵营需要新的XLNet\"></a>1.2 两大阵营需要新的XLNet</h2><p>XLNet提出了一种让AR语言模型从双向上下文中学习的新方法，以避免[MASK]方法在AE语言模型中带来的缺点。</p>\n<p>XLNet是一种泛化自回归(AR)方法，既集合了AR和AE方法的优势，又避免了二者的缺陷。</p>\n<ul>\n<li>XLNet不使用传统AR模型中固定的前向或后向因式分解顺序，而是最大化所有可能因式分解顺序的期望对数似然，由于对因式分解顺序的排列操作，每个位置的语境都包含来自左侧和右侧的token。因此，每个位置都能学习来自所有位置的语境信息，即捕获双向语境。</li>\n<li>作为一个泛化自回归(AR)模型，XLNet不依赖残缺数据。不会有BERT的预训练-微调差异。自回归目标提供一种自然的方式，来利用乘法法则对预测token的联合概率执行因式分解(factorize)，这消除了BERT中的独立性假设。</li>\n<li>XLNet将Transformer-XL的分割循环机制和相对编码范式整合到预训练中。</li>\n</ul>\n<h1 id=\"2-Proposed-Solution\"><a href=\"#2-Proposed-Solution\" class=\"headerlink\" title=\"2 Proposed Solution\"></a>2 Proposed Solution</h1><h2 id=\"2-1-在自回归模型中引入双向语言模型基本思想\"><a href=\"#2-1-在自回归模型中引入双向语言模型基本思想\" class=\"headerlink\" title=\"2.1 在自回归模型中引入双向语言模型基本思想\"></a>2.1 在自回归模型中引入双向语言模型基本思想</h2><p>XLNet仍然遵循两阶段的过程(pretrain fine-tune)。其主要希望改动第一阶段的过程，即不像BERT那样带[MASK]的Denoising-autoencoder的模式，而是采用AR语言模型的模式。</p>\n<p>简单来说就是，输入句子X仍然使自左向右的输入，看到Ti单词的上文Context-before来预测Ti这个单词，又希望Context-before例不仅看到上文单词又能看到后面的Context-after里的下文单词。这样一来BERT预训练阶段引入的[MASK]符号就不需要了。</p>\n<p>基本思想：在预训练阶段引入Permutation LM的训练目标。</p>\n<p>举例：比如包含单词Ti的当前输入的句子X，由顺序的几个单词构成x1, x2, x3, x4四个单词顺序组成。假设x3为要预测的单词Ti，其所在的位置为Position 3，要想让它能够在上文Context-before中，也就是Pos 1或Pos 2的位置看到Pos 4的单词x4。可以这么做，假设固定住x3的位置，也就是仍在x3，之后随机排列组合句子中的4个单词，在所有可能里训责一部分作为模型的预训练的输入X。比如随机排列组合后x4, x2, x3, x1这样一个排列组合作为模型的输入X。于是x3就能同时看到上文x2以及下文x4的内容了。</p>\n<p><img src=\"https://pic3.zhimg.com/80/v2-05d785e9d8f810d118e4fa93f8e9b39f_1440w.jpg\" alt=\"img-permutation-language-model\"></p>\n<p>看上去仍然是个自回归的从左到右的模型，但是其实通过对句子中单词排列组合，把一部分Ti下文的单词排到Ti上文位置中，于是就看到了上文和下文，但是形式上看上去仍然是从左到右在预测后一个单词。</p>\n<h2 id=\"2-2-具体实现\"><a href=\"#2-2-具体实现\" class=\"headerlink\" title=\"2.2 具体实现\"></a>2.2 具体实现</h2><p>尽管基本思想里提到把句子X的单词排列组合后，再随机抽取例子作为输入，但实际上不可以，因为Fine-tune阶段不可能去排列组合原始输入。所以必须让预训练阶段的输入部分<strong>看上去</strong>仍然是x1, x2, x3, x4这个顺序，但是可以在Transformer部分做些工作，来达成目标。</p>\n<p>XLNet采取了Attention掩码机制，输入的X没有任何变化，单词Ti还是第i个单词，前面有1到i-1个单词。但是Transformer内部，通过Attention掩码从X的输入单词里，也就是Ti的Context-before和Context-after中随机选择i-1个单词，放到Ti的Context-before上，把其他单词的输入通过Attention掩码隐藏掉。（当然这个所谓放到Ti的上文位置，只是一种形象的说法，其实在内部，就是通过Attention Mask，把其它没有被选到的单词Mask掉，不让它们在预测单词Ti的时候发生作用，如此而已。看着就类似于把这些被选中的单词放到了上文Context_before的位置了）。</p>\n<p>XLNet是用<strong>双流自注意力模型</strong>实现的。一个是内容流自注意力，其实就是标准的Transformer的计算过程，主要引入了Query流自注意力。其实就是用来替代[MASK]标记的，XLNet因为要抛弃[MASK]又不能看到x3的输入，于是Query流就直接忽略掉x3的输入，只保留这个位置信息，用参数w来代表位置的embedding编码。<strong>其实XLNet只是抛弃了[MASK]这个占位符号，内部还是引入Query流来忽略掉被MASK的这个单词。和BERT比只是实现方式不同而已</strong>。</p>\n<p><img src=\"https://picb.zhimg.com/80/v2-2bb1a60af4fe2fa751647fdce48e337c_1440w.jpg\" alt=\"img-two-stream-attention\"></p>\n<p>如图所示，输入序列仍是x1, x2, x3, x4，通过不同的掩码矩阵，让当前单词Xi只能看到被排列组合后的顺序x3-&gt;x2-&gt;x4-&gt;x1中自己前面的单词。</p>\n<h2 id=\"2-3-XLNet与BERT\"><a href=\"#2-3-XLNet与BERT\" class=\"headerlink\" title=\"2.3 XLNet与BERT\"></a>2.3 XLNet与BERT</h2><p>通过改造BERT预训练的过程，其实可以模拟XLNet的PLM过程。</p>\n<p>第一种思路：Bert目前的做法是，给定输入句子X，随机Mask掉15%的单词，然后要求利用剩下的85%的单词去预测任意一个被Mask掉的单词。对于输入句子，随机选择X中的任意i个单词，只用这i个单词去预测被Mask的单词。这个过程理论上可以在Transformer内采用Attention Mask来实现，这样BERT的预训练模型就和XLNet基本等价了。</p>\n<p>第二种思路：假设仍使用BERT目前的Mask机制，将Mask 15%改为，每次一个句子只Mask掉一个单词，利用剩下的单词来预测被Mask掉的单词。因为XLNet在实现的时候，为了提升效率，其实是选择每个句子最后末尾的1/K个单词被预测，假设K=7，意味着一个句子X，只有末尾的1/7的单词会被预测。这样两者基本是等价的。</p>\n<p>XLNet维持了自回归(AR)语言模型的从左向右的模式，这个BERT做不到。明显的好处是，对于生成类的任务，能够在维持表面从左向右的生成过程前提下，模型里隐含了上下文的信息。XLNet貌似应该对于生成类型的NLP任务，会比BERT又明显优势。此外，XLNet还引入了Transformer XL机制，所以对于长文档输入类型的NLP任务，也会比BERT有明显优势。</p>\n<h2 id=\"3-总结\"><a href=\"#3-总结\" class=\"headerlink\" title=\"3 总结\"></a>3 总结</h2><p>Permutation Language Model是XLNet的主要理论创新，<strong>它开启了自回归(AR)语言模型如何引入下文的一个思路</strong>。</p>\n<p>XLNet也相当于是BERT, GPT2.0, Transformer XL的综合体。</p>\n<ul>\n<li>通过Permutation LM 预训练目标，吸收了BERT的双向语言模型；</li>\n<li>吸收了GPT2.0使用更多更高质量的预训练数据；</li>\n<li>吸收了Transformer XL的主要思想。</li>\n</ul>\n<p>XLNet其实本质上还是ELMO/GPT/BERT这一系列两阶段模型的进一步延伸。在自回归(AR)语言模型方向引入双向语言模型打开了新思路。</p>\n<p>未来预期</p>\n<ul>\n<li>Transformer天然对长文档任务处理有弱点，所以XLNet对于长文档NLP任务相比BERT应该有直接且比较明显的性能提升；</li>\n<li>对于生成类的NLP任务，XLNet的预训练模式符合下游任务序列生成结果。</li>\n</ul>\n<hr>\n<p>Rreference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC83MDI1NzQyNw==\">https://zhuanlan.zhihu.com/p/70257427<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNzk0NzE1Ni9hcnRpY2xlL2RldGFpbHMvOTMwMzU2MDc=\">https://blog.csdn.net/weixin_37947156/article/details/93035607<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>// AR AE LM 实现步骤？<br>// TODO Transformer 较于 RNN？<br>// TODO encoding decoding？<br>// TODO denoising-autoencoder?  </p>\n<p>// TODO Transformer-XL 分割循环机制 相对编码范式??<br>// TODO BERT 预训练-微调两阶段模式(pretrain fine-tune) 抛弃mask使两阶段保持一致？ fine-tune阶段？<br>// TODO AR模型前向后向因式分解顺序？  </p>\n"},{"title":"ClusterGAN代码实现","catagories":["代码复现"],"_content":"\n# ClusterGAN-Pytorch Implement\n\n## 跑通源代码\n\nhttps://github.com/zhampel/clusterGAN\n\n### cuDNN error: CUDNN_STATUS_EXECUTION_FAILED\n\n可能由于Python, Pytorch, cuda, cudnn版本之间匹配问题导致。\n\n**方案1:**\n\n直接关闭cudnn加速\n\n```python\ntorch.backends.cudnn.enabled = False\n```\n\n### matplotlib报错no display name and no $DISPLAY environment variable.\n\n在matplotlib**首次**import之后进行配置\n\n```python\nmatplotlib.use('Agg')\n```\n\n\n\n# 理解源代码\n\n跑完一个epoch需要每一次迭代一个batch直到迭代全部的数据集。而参数的更新需要在每个batch迭代完后更新。\n\n","source":"_posts/paper_reprod/ClusterGAN.md","raw":"---\ntitle: ClusterGAN代码实现\ncatagories: \n- 代码复现\ntags: \n- python\n---\n\n# ClusterGAN-Pytorch Implement\n\n## 跑通源代码\n\nhttps://github.com/zhampel/clusterGAN\n\n### cuDNN error: CUDNN_STATUS_EXECUTION_FAILED\n\n可能由于Python, Pytorch, cuda, cudnn版本之间匹配问题导致。\n\n**方案1:**\n\n直接关闭cudnn加速\n\n```python\ntorch.backends.cudnn.enabled = False\n```\n\n### matplotlib报错no display name and no $DISPLAY environment variable.\n\n在matplotlib**首次**import之后进行配置\n\n```python\nmatplotlib.use('Agg')\n```\n\n\n\n# 理解源代码\n\n跑完一个epoch需要每一次迭代一个batch直到迭代全部的数据集。而参数的更新需要在每个batch迭代完后更新。\n\n","slug":"paper_reprod/ClusterGAN","published":1,"date":"2021-01-21T02:12:58.746Z","updated":"2021-02-04T05:48:06.192Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982k00do018oeoctbwg6","content":"<h1 id=\"ClusterGAN-Pytorch-Implement\"><a href=\"#ClusterGAN-Pytorch-Implement\" class=\"headerlink\" title=\"ClusterGAN-Pytorch Implement\"></a>ClusterGAN-Pytorch Implement</h1><h2 id=\"跑通源代码\"><a href=\"#跑通源代码\" class=\"headerlink\" title=\"跑通源代码\"></a>跑通源代码</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3poYW1wZWwvY2x1c3RlckdBTg==\">https://github.com/zhampel/clusterGAN<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"cuDNN-error-CUDNN-STATUS-EXECUTION-FAILED\"><a href=\"#cuDNN-error-CUDNN-STATUS-EXECUTION-FAILED\" class=\"headerlink\" title=\"cuDNN error: CUDNN_STATUS_EXECUTION_FAILED\"></a>cuDNN error: CUDNN_STATUS_EXECUTION_FAILED</h3><p>可能由于Python, Pytorch, cuda, cudnn版本之间匹配问题导致。</p>\n<p><strong>方案1:</strong></p>\n<p>直接关闭cudnn加速</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.backends.cudnn.enabled = <span class=\"literal\">False</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"matplotlib报错no-display-name-and-no-DISPLAY-environment-variable\"><a href=\"#matplotlib报错no-display-name-and-no-DISPLAY-environment-variable\" class=\"headerlink\" title=\"matplotlib报错no display name and no $DISPLAY environment variable.\"></a>matplotlib报错no display name and no $DISPLAY environment variable.</h3><p>在matplotlib<strong>首次</strong>import之后进行配置</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">matplotlib.use(<span class=\"string\">'Agg'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"理解源代码\"><a href=\"#理解源代码\" class=\"headerlink\" title=\"理解源代码\"></a>理解源代码</h1><p>跑完一个epoch需要每一次迭代一个batch直到迭代全部的数据集。而参数的更新需要在每个batch迭代完后更新。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"ClusterGAN-Pytorch-Implement\"><a href=\"#ClusterGAN-Pytorch-Implement\" class=\"headerlink\" title=\"ClusterGAN-Pytorch Implement\"></a>ClusterGAN-Pytorch Implement</h1><h2 id=\"跑通源代码\"><a href=\"#跑通源代码\" class=\"headerlink\" title=\"跑通源代码\"></a>跑通源代码</h2><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3poYW1wZWwvY2x1c3RlckdBTg==\">https://github.com/zhampel/clusterGAN<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h3 id=\"cuDNN-error-CUDNN-STATUS-EXECUTION-FAILED\"><a href=\"#cuDNN-error-CUDNN-STATUS-EXECUTION-FAILED\" class=\"headerlink\" title=\"cuDNN error: CUDNN_STATUS_EXECUTION_FAILED\"></a>cuDNN error: CUDNN_STATUS_EXECUTION_FAILED</h3><p>可能由于Python, Pytorch, cuda, cudnn版本之间匹配问题导致。</p>\n<p><strong>方案1:</strong></p>\n<p>直接关闭cudnn加速</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.backends.cudnn.enabled = <span class=\"literal\">False</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"matplotlib报错no-display-name-and-no-DISPLAY-environment-variable\"><a href=\"#matplotlib报错no-display-name-and-no-DISPLAY-environment-variable\" class=\"headerlink\" title=\"matplotlib报错no display name and no $DISPLAY environment variable.\"></a>matplotlib报错no display name and no $DISPLAY environment variable.</h3><p>在matplotlib<strong>首次</strong>import之后进行配置</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">matplotlib.use(<span class=\"string\">'Agg'</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"理解源代码\"><a href=\"#理解源代码\" class=\"headerlink\" title=\"理解源代码\"></a>理解源代码</h1><p>跑完一个epoch需要每一次迭代一个batch直到迭代全部的数据集。而参数的更新需要在每个batch迭代完后更新。</p>\n"},{"title":"Spark - start","_content":"\n# 简介\n\nSpark是一个集群计算的框架，类似于Hadoop. 其最大的优化是让计算任务的中间结果存储在内存中，不需要每次都写入HDFS。\n\nSpark是基于RDD的核心编程，使用内存进行计算，比死板的MapReduce模型的性能大大提高。\n\n\n\n# Spark RDDs 弹性分布式数据集\n\n一个可并行操作的有容错机制的数据集合。\n\n\n\n# Spark Streaming\n\n对事实数据流进行处理，处理后的数据再应用。\n\n一个处理过程。\n\n\n\n# Spark SQL\n\n允许Spark执行用SQL, Scala等表示的关系查询。\n\n\n\n# GraphX\n\n用于图和并行图计算。\n\n\n\n----\n\nReference\n\nhttps://www.w3cschool.cn/spark\n\n","source":"_posts/spark/start.md","raw":"---\ntitle: Spark - start\ncategories:\n- Notebook\ntags:\n- spark\n---\n\n# 简介\n\nSpark是一个集群计算的框架，类似于Hadoop. 其最大的优化是让计算任务的中间结果存储在内存中，不需要每次都写入HDFS。\n\nSpark是基于RDD的核心编程，使用内存进行计算，比死板的MapReduce模型的性能大大提高。\n\n\n\n# Spark RDDs 弹性分布式数据集\n\n一个可并行操作的有容错机制的数据集合。\n\n\n\n# Spark Streaming\n\n对事实数据流进行处理，处理后的数据再应用。\n\n一个处理过程。\n\n\n\n# Spark SQL\n\n允许Spark执行用SQL, Scala等表示的关系查询。\n\n\n\n# GraphX\n\n用于图和并行图计算。\n\n\n\n----\n\nReference\n\nhttps://www.w3cschool.cn/spark\n\n","slug":"spark/start","published":1,"date":"2021-01-27T03:48:52.551Z","updated":"2021-01-29T03:32:44.040Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982l00dq018og7brh9n7","content":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Spark是一个集群计算的框架，类似于Hadoop. 其最大的优化是让计算任务的中间结果存储在内存中，不需要每次都写入HDFS。</p>\n<p>Spark是基于RDD的核心编程，使用内存进行计算，比死板的MapReduce模型的性能大大提高。</p>\n<h1 id=\"Spark-RDDs-弹性分布式数据集\"><a href=\"#Spark-RDDs-弹性分布式数据集\" class=\"headerlink\" title=\"Spark RDDs 弹性分布式数据集\"></a>Spark RDDs 弹性分布式数据集</h1><p>一个可并行操作的有容错机制的数据集合。</p>\n<h1 id=\"Spark-Streaming\"><a href=\"#Spark-Streaming\" class=\"headerlink\" title=\"Spark Streaming\"></a>Spark Streaming</h1><p>对事实数据流进行处理，处理后的数据再应用。</p>\n<p>一个处理过程。</p>\n<h1 id=\"Spark-SQL\"><a href=\"#Spark-SQL\" class=\"headerlink\" title=\"Spark SQL\"></a>Spark SQL</h1><p>允许Spark执行用SQL, Scala等表示的关系查询。</p>\n<h1 id=\"GraphX\"><a href=\"#GraphX\" class=\"headerlink\" title=\"GraphX\"></a>GraphX</h1><p>用于图和并行图计算。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudzNjc2Nob29sLmNuL3NwYXJr\">https://www.w3cschool.cn/spark<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Spark是一个集群计算的框架，类似于Hadoop. 其最大的优化是让计算任务的中间结果存储在内存中，不需要每次都写入HDFS。</p>\n<p>Spark是基于RDD的核心编程，使用内存进行计算，比死板的MapReduce模型的性能大大提高。</p>\n<h1 id=\"Spark-RDDs-弹性分布式数据集\"><a href=\"#Spark-RDDs-弹性分布式数据集\" class=\"headerlink\" title=\"Spark RDDs 弹性分布式数据集\"></a>Spark RDDs 弹性分布式数据集</h1><p>一个可并行操作的有容错机制的数据集合。</p>\n<h1 id=\"Spark-Streaming\"><a href=\"#Spark-Streaming\" class=\"headerlink\" title=\"Spark Streaming\"></a>Spark Streaming</h1><p>对事实数据流进行处理，处理后的数据再应用。</p>\n<p>一个处理过程。</p>\n<h1 id=\"Spark-SQL\"><a href=\"#Spark-SQL\" class=\"headerlink\" title=\"Spark SQL\"></a>Spark SQL</h1><p>允许Spark执行用SQL, Scala等表示的关系查询。</p>\n<h1 id=\"GraphX\"><a href=\"#GraphX\" class=\"headerlink\" title=\"GraphX\"></a>GraphX</h1><p>用于图和并行图计算。</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudzNjc2Nob29sLmNuL3NwYXJr\">https://www.w3cschool.cn/spark<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Spark - 部署","_content":"\n# 安装\n\n从腾讯云镜像安装(这是内网地址)\n\n`wget http://mirrors.tencentyun.com/apache/xxx`\n\n解压到`~/applications`\n\n创建软连接，方便管理不同版本。\n\n`ln -s spark-3.0.1-bin-hadoop2.7 spark`\n\n`export SPARK_HOME=/home/ubuntu/applications/spark`\n\n以后只要将软连接的指向改动到新版本，不需要改动环境变量。\n\n# 启动\n\n## 安装JDK\n\n`sudo apt install openjdk-11-jdk`\n\n## 使用Scala Shell启动Spark\n\n`spark-shell`\n\n## 简单的例子\n\n```scala\nvar file = sc.textFile(\"/home/ubuntu/documents/xxx.txt\")\n// 打印行数\nfile.count()\n// 打印第一行\nfile.first()\n// 过滤打印\nfile.filter(line => line.contains(\"spark\")).count()\n```\n\n## 启动节点\n\n### 主节点\n\n`cd $SPARK_HOME/sbin`\n\n`./start-master.sh`\n\n通过`ip:8080`可以web访问\n\n获取Master节点的Url\n\n`spark://localhost.localdomain:7077`\n\n### 从节点\n\n`./start-slave.sh spark://localhost.localdomain:7077`\n\n可以通过`jps`（显示当前的Java进程）查看启动的服务\n\nWeb端可以看到有了Workers\n\n### 用Shell连接Master\n\n```sh\nMASTER=spark://localhost.localdomain:7077 spark-shell\n```\n\nWeb端可以看到RunningApplications有了Shell\n\n### 停止服务\n\n`./stop-all.sh`\n\n`jps`查看\n\n# 集群部署\n\n## 配置文件\n\n主节点配置环境变量`conf/spark-env.sh`\n\n主节点配置从节点的主机名`conf/slaves`, 此时主机名要写入hosts中\n\n将spark整体文件拷贝到所有从节点，路径与主节点一致\n\n配置**主节点到从节点**的SSH Key无密码登录\n\n启动集群`sbin/start-all.sh`\n\n\n\n\n\n\n\n","source":"_posts/spark/deploy.md","raw":"---\ntitle: Spark - 部署\ncategories:\n- Notebook\ntags:\n- spark\n---\n\n# 安装\n\n从腾讯云镜像安装(这是内网地址)\n\n`wget http://mirrors.tencentyun.com/apache/xxx`\n\n解压到`~/applications`\n\n创建软连接，方便管理不同版本。\n\n`ln -s spark-3.0.1-bin-hadoop2.7 spark`\n\n`export SPARK_HOME=/home/ubuntu/applications/spark`\n\n以后只要将软连接的指向改动到新版本，不需要改动环境变量。\n\n# 启动\n\n## 安装JDK\n\n`sudo apt install openjdk-11-jdk`\n\n## 使用Scala Shell启动Spark\n\n`spark-shell`\n\n## 简单的例子\n\n```scala\nvar file = sc.textFile(\"/home/ubuntu/documents/xxx.txt\")\n// 打印行数\nfile.count()\n// 打印第一行\nfile.first()\n// 过滤打印\nfile.filter(line => line.contains(\"spark\")).count()\n```\n\n## 启动节点\n\n### 主节点\n\n`cd $SPARK_HOME/sbin`\n\n`./start-master.sh`\n\n通过`ip:8080`可以web访问\n\n获取Master节点的Url\n\n`spark://localhost.localdomain:7077`\n\n### 从节点\n\n`./start-slave.sh spark://localhost.localdomain:7077`\n\n可以通过`jps`（显示当前的Java进程）查看启动的服务\n\nWeb端可以看到有了Workers\n\n### 用Shell连接Master\n\n```sh\nMASTER=spark://localhost.localdomain:7077 spark-shell\n```\n\nWeb端可以看到RunningApplications有了Shell\n\n### 停止服务\n\n`./stop-all.sh`\n\n`jps`查看\n\n# 集群部署\n\n## 配置文件\n\n主节点配置环境变量`conf/spark-env.sh`\n\n主节点配置从节点的主机名`conf/slaves`, 此时主机名要写入hosts中\n\n将spark整体文件拷贝到所有从节点，路径与主节点一致\n\n配置**主节点到从节点**的SSH Key无密码登录\n\n启动集群`sbin/start-all.sh`\n\n\n\n\n\n\n\n","slug":"spark/deploy","published":1,"date":"2021-01-29T03:32:37.487Z","updated":"2021-01-29T07:19:33.671Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982m00du018o1kvwehkl","content":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><p>从腾讯云镜像安装(这是内网地址)</p>\n<p><code>wget http://mirrors.tencentyun.com/apache/xxx</code></p>\n<p>解压到<code>~/applications</code></p>\n<p>创建软连接，方便管理不同版本。</p>\n<p><code>ln -s spark-3.0.1-bin-hadoop2.7 spark</code></p>\n<p><code>export SPARK_HOME=/home/ubuntu/applications/spark</code></p>\n<p>以后只要将软连接的指向改动到新版本，不需要改动环境变量。</p>\n<h1 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h1><h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p><code>sudo apt install openjdk-11-jdk</code></p>\n<h2 id=\"使用Scala-Shell启动Spark\"><a href=\"#使用Scala-Shell启动Spark\" class=\"headerlink\" title=\"使用Scala Shell启动Spark\"></a>使用Scala Shell启动Spark</h2><p><code>spark-shell</code></p>\n<h2 id=\"简单的例子\"><a href=\"#简单的例子\" class=\"headerlink\" title=\"简单的例子\"></a>简单的例子</h2><figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> file = sc.textFile(<span class=\"string\">\"/home/ubuntu/documents/xxx.txt\"</span>)</span><br><span class=\"line\"><span class=\"comment\">// 打印行数</span></span><br><span class=\"line\">file.count()</span><br><span class=\"line\"><span class=\"comment\">// 打印第一行</span></span><br><span class=\"line\">file.first()</span><br><span class=\"line\"><span class=\"comment\">// 过滤打印</span></span><br><span class=\"line\">file.filter(line =&gt; line.contains(<span class=\"string\">\"spark\"</span>)).count()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动节点\"><a href=\"#启动节点\" class=\"headerlink\" title=\"启动节点\"></a>启动节点</h2><h3 id=\"主节点\"><a href=\"#主节点\" class=\"headerlink\" title=\"主节点\"></a>主节点</h3><p><code>cd $SPARK_HOME/sbin</code></p>\n<p><code>./start-master.sh</code></p>\n<p>通过<code>ip:8080</code>可以web访问</p>\n<p>获取Master节点的Url</p>\n<p><code>spark://localhost.localdomain:7077</code></p>\n<h3 id=\"从节点\"><a href=\"#从节点\" class=\"headerlink\" title=\"从节点\"></a>从节点</h3><p><code>./start-slave.sh spark://localhost.localdomain:7077</code></p>\n<p>可以通过<code>jps</code>（显示当前的Java进程）查看启动的服务</p>\n<p>Web端可以看到有了Workers</p>\n<h3 id=\"用Shell连接Master\"><a href=\"#用Shell连接Master\" class=\"headerlink\" title=\"用Shell连接Master\"></a>用Shell连接Master</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MASTER=spark://localhost.localdomain:7077 spark-shell</span><br></pre></td></tr></table></figure>\n\n<p>Web端可以看到RunningApplications有了Shell</p>\n<h3 id=\"停止服务\"><a href=\"#停止服务\" class=\"headerlink\" title=\"停止服务\"></a>停止服务</h3><p><code>./stop-all.sh</code></p>\n<p><code>jps</code>查看</p>\n<h1 id=\"集群部署\"><a href=\"#集群部署\" class=\"headerlink\" title=\"集群部署\"></a>集群部署</h1><h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>主节点配置环境变量<code>conf/spark-env.sh</code></p>\n<p>主节点配置从节点的主机名<code>conf/slaves</code>, 此时主机名要写入hosts中</p>\n<p>将spark整体文件拷贝到所有从节点，路径与主节点一致</p>\n<p>配置<strong>主节点到从节点</strong>的SSH Key无密码登录</p>\n<p>启动集群<code>sbin/start-all.sh</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><p>从腾讯云镜像安装(这是内网地址)</p>\n<p><code>wget http://mirrors.tencentyun.com/apache/xxx</code></p>\n<p>解压到<code>~/applications</code></p>\n<p>创建软连接，方便管理不同版本。</p>\n<p><code>ln -s spark-3.0.1-bin-hadoop2.7 spark</code></p>\n<p><code>export SPARK_HOME=/home/ubuntu/applications/spark</code></p>\n<p>以后只要将软连接的指向改动到新版本，不需要改动环境变量。</p>\n<h1 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h1><h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p><code>sudo apt install openjdk-11-jdk</code></p>\n<h2 id=\"使用Scala-Shell启动Spark\"><a href=\"#使用Scala-Shell启动Spark\" class=\"headerlink\" title=\"使用Scala Shell启动Spark\"></a>使用Scala Shell启动Spark</h2><p><code>spark-shell</code></p>\n<h2 id=\"简单的例子\"><a href=\"#简单的例子\" class=\"headerlink\" title=\"简单的例子\"></a>简单的例子</h2><figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> file = sc.textFile(<span class=\"string\">\"/home/ubuntu/documents/xxx.txt\"</span>)</span><br><span class=\"line\"><span class=\"comment\">// 打印行数</span></span><br><span class=\"line\">file.count()</span><br><span class=\"line\"><span class=\"comment\">// 打印第一行</span></span><br><span class=\"line\">file.first()</span><br><span class=\"line\"><span class=\"comment\">// 过滤打印</span></span><br><span class=\"line\">file.filter(line =&gt; line.contains(<span class=\"string\">\"spark\"</span>)).count()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动节点\"><a href=\"#启动节点\" class=\"headerlink\" title=\"启动节点\"></a>启动节点</h2><h3 id=\"主节点\"><a href=\"#主节点\" class=\"headerlink\" title=\"主节点\"></a>主节点</h3><p><code>cd $SPARK_HOME/sbin</code></p>\n<p><code>./start-master.sh</code></p>\n<p>通过<code>ip:8080</code>可以web访问</p>\n<p>获取Master节点的Url</p>\n<p><code>spark://localhost.localdomain:7077</code></p>\n<h3 id=\"从节点\"><a href=\"#从节点\" class=\"headerlink\" title=\"从节点\"></a>从节点</h3><p><code>./start-slave.sh spark://localhost.localdomain:7077</code></p>\n<p>可以通过<code>jps</code>（显示当前的Java进程）查看启动的服务</p>\n<p>Web端可以看到有了Workers</p>\n<h3 id=\"用Shell连接Master\"><a href=\"#用Shell连接Master\" class=\"headerlink\" title=\"用Shell连接Master\"></a>用Shell连接Master</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MASTER=spark://localhost.localdomain:7077 spark-shell</span><br></pre></td></tr></table></figure>\n\n<p>Web端可以看到RunningApplications有了Shell</p>\n<h3 id=\"停止服务\"><a href=\"#停止服务\" class=\"headerlink\" title=\"停止服务\"></a>停止服务</h3><p><code>./stop-all.sh</code></p>\n<p><code>jps</code>查看</p>\n<h1 id=\"集群部署\"><a href=\"#集群部署\" class=\"headerlink\" title=\"集群部署\"></a>集群部署</h1><h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>主节点配置环境变量<code>conf/spark-env.sh</code></p>\n<p>主节点配置从节点的主机名<code>conf/slaves</code>, 此时主机名要写入hosts中</p>\n<p>将spark整体文件拷贝到所有从节点，路径与主节点一致</p>\n<p>配置<strong>主节点到从节点</strong>的SSH Key无密码登录</p>\n<p>启动集群<code>sbin/start-all.sh</code></p>\n"},{"title":"CluasteringGANSiamese","catagories":["代码复现"],"_content":"\n# CluasteringGANSiamese\n\n## 代码复现\n\nST-SiameseNet\n\n安装依赖`pip install -r requirement`  \n\npip指定版本安装`pip install xxx==version`\n\nconda指定版本安装`conda install xx=version`\n\n作为Keras后台的Tensorflow有一些版本约束-[版本匹配](https://docs.floydhub.com/guides/environments/)\n\n\n\n## GAN\n\n报错信息 \n`Error while reading resource variable _AnonymousVar41 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/_AnonymousVar41/class tensorflow::Var does not exist.`\n\n解决办法 \nkeras改为tensorflow.keras\n\n","source":"_posts/paper_reprod/ClusteringGANSiamese.md","raw":"---\ntitle: CluasteringGANSiamese\ncatagories: \n- 代码复现\ntags: \n- python\n---\n\n# CluasteringGANSiamese\n\n## 代码复现\n\nST-SiameseNet\n\n安装依赖`pip install -r requirement`  \n\npip指定版本安装`pip install xxx==version`\n\nconda指定版本安装`conda install xx=version`\n\n作为Keras后台的Tensorflow有一些版本约束-[版本匹配](https://docs.floydhub.com/guides/environments/)\n\n\n\n## GAN\n\n报错信息 \n`Error while reading resource variable _AnonymousVar41 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/_AnonymousVar41/class tensorflow::Var does not exist.`\n\n解决办法 \nkeras改为tensorflow.keras\n\n","slug":"paper_reprod/ClusteringGANSiamese","published":1,"date":"2020-11-06T12:25:17.043Z","updated":"2021-02-27T11:58:49.735Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982n00dx018ogvo0gn6e","content":"<h1 id=\"CluasteringGANSiamese\"><a href=\"#CluasteringGANSiamese\" class=\"headerlink\" title=\"CluasteringGANSiamese\"></a>CluasteringGANSiamese</h1><h2 id=\"代码复现\"><a href=\"#代码复现\" class=\"headerlink\" title=\"代码复现\"></a>代码复现</h2><p>ST-SiameseNet</p>\n<p>安装依赖<code>pip install -r requirement</code>  </p>\n<p>pip指定版本安装<code>pip install xxx==version</code></p>\n<p>conda指定版本安装<code>conda install xx=version</code></p>\n<p>作为Keras后台的Tensorflow有一些版本约束-<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmZsb3lkaHViLmNvbS9ndWlkZXMvZW52aXJvbm1lbnRzLw==\">版本匹配<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h2 id=\"GAN\"><a href=\"#GAN\" class=\"headerlink\" title=\"GAN\"></a>GAN</h2><p>报错信息<br><code>Error while reading resource variable _AnonymousVar41 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/_AnonymousVar41/class tensorflow::Var does not exist.</code></p>\n<p>解决办法<br>keras改为tensorflow.keras</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"CluasteringGANSiamese\"><a href=\"#CluasteringGANSiamese\" class=\"headerlink\" title=\"CluasteringGANSiamese\"></a>CluasteringGANSiamese</h1><h2 id=\"代码复现\"><a href=\"#代码复现\" class=\"headerlink\" title=\"代码复现\"></a>代码复现</h2><p>ST-SiameseNet</p>\n<p>安装依赖<code>pip install -r requirement</code>  </p>\n<p>pip指定版本安装<code>pip install xxx==version</code></p>\n<p>conda指定版本安装<code>conda install xx=version</code></p>\n<p>作为Keras后台的Tensorflow有一些版本约束-<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmZsb3lkaHViLmNvbS9ndWlkZXMvZW52aXJvbm1lbnRzLw==\">版本匹配<i class=\"fa fa-external-link-alt\"></i></span></p>\n<h2 id=\"GAN\"><a href=\"#GAN\" class=\"headerlink\" title=\"GAN\"></a>GAN</h2><p>报错信息<br><code>Error while reading resource variable _AnonymousVar41 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/_AnonymousVar41/class tensorflow::Var does not exist.</code></p>\n<p>解决办法<br>keras改为tensorflow.keras</p>\n"},{"title":"Spark - RDD","_content":"\n","source":"_posts/spark/rdd.md","raw":"---\ntitle: Spark - RDD\ncategories:\n- Notebook\ntags:\n- spark\n- rdd\n---\n\n","slug":"spark/rdd","published":1,"date":"2021-01-29T09:57:12.303Z","updated":"2021-01-29T09:57:35.868Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982o00dz018oc1oee1gs","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"SpringAOP - 动态代理","_content":"\n# 引入\n\n相较于静态代理模式，所有的方法动态生成。\n\n这里介绍基于JDK的方式实现动态代理。\n\n\n\n# 实例\n\n```java\npublic class ProxyInvocationHandler implements InvocationHandler {\n    \n    // 被代理的接口\n    private Object target;\n\n    // 传入被代理的接口\n    public void setTarget(Object target) {\n        this.target = target;\n    }\n\n    // 生成代理类\n    public Object getProxy() {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(), this);\n    }\n\n    // 唤醒方法 返回结果\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        log(method.getName());\n        Object result = method.invoke(target, args);\n        return result;\n    }\n\n    // 定义唤起方法执行前后进行装饰的方法\n    private void log(String msg) {\n        System.out.println(\"[Log] \" + msg);\n    }\n}\n```\n\n## Proxy\n\n返回代理类，需要传入：\n\n- 当前作为Proxy的`Class加载器`.\n- 需要代理的`对象的接口`。\n- 自定义的InvocationHandler，实现了`InvocationHandler`接口。\n\n```java\npublic Object getProxy() {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(), this);\n}\n```\n\n## InvocationHandler\n\n唤起事务处理。\n\n```java\n@Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        log(method.getName());\n        Object result = method.invoke(target, args);\n        return result;\n    }\n```\n\n实现了`InvocationHandler`，需要重写`invoke`方法。\n\n使用反射的方法执行`method.invoke`传入\n\n- 被代理的接口(target)\n- 执行时的形参(args)\n\n在唤起执行**方法前后**，可以加入**自定义的事务处理**。\n\n\n\n# 自定义\n\n可以实现将一个`ProxyInvocationHandler`分成一个`CustomProxy`和一个`CustomInvocationHandler`。\n\n## CustomInvocationHandler\n\n```java\npublic class CustomInvocationHandler implements InvocationHandler {\n\n    private IndexService indexService;\n\n    public CustomInvocationHandler(IndexService indexService) {\n        this.indexService = indexService;\n    }\n\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {  // TODO Proxy的作用？\n        logBefore(method.getName());\n        Object res = method.invoke(indexService, args);\n        logAfter(indexService.getClass().getName());\n        return res;\n    }\n\n    // 以下定义 前后装饰方法\n    private void logBefore(String msg) {\n        System.out.println(\"[Log] \" + msg);\n    }\n\n    private void logAfter(String msg) {\n        System.out.println(\"[Log] \" + msg + \"has been done!\");\n    }\n}\n```\n\n## CustomProxy\n\n```java\npublic class CustomProxy {\n\n    public Object getProxy(IndexService indexService, InvocationHandler invocationHandler) {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), indexService.getClass().getInterfaces(), invocationHandler);\n    }\n}\n```\n\n## Client\n\n```java\npublic class CustomClient {\n    public static void main(String[] args) {\n        // 需要代理的接口\n        IndexService indexService = new IndexServiceImpl();\n        // 实例化 自定义代理接口需要进行的处理类\n        CustomInvocationHandler customInvocationHandler = new CustomInvocationHandler(indexService);\n        // 实例化 自定义的代理类\n        CustomProxy customProxy = new CustomProxy();\n        // 获取代理 需要传入代理的接口及自定义的处理类\n        IndexService proxy = (IndexService) customProxy.getProxy(indexService, customInvocationHandler);\n        // 执行测试\n        proxy.add();\n    }\n}\n```\n\n`Proxy`与`InvocationHandler`可以分离。\n\n- `InvocationHandler`必须要传需要代理的接口。\n- `Proxy`必须要传需要代理的接口，以及自定义的`Handler`。\n\n\n\n# 问题\n\n`Proxy`与`InvocationHandler`可以解藕，但是他们都需要被代理的接口。\n\n进行**接口实现接口**的设计？\n\n`InvocationHandler`中实现了`invoke`后其中传的`Proxy`的作用？","source":"_posts/spring/aop-proxy.md","raw":"---\ntitle: SpringAOP - 动态代理\ncategories:\n- Notebook\ntags:\n- java\n- spring\n- aop\n- proxy\n---\n\n# 引入\n\n相较于静态代理模式，所有的方法动态生成。\n\n这里介绍基于JDK的方式实现动态代理。\n\n\n\n# 实例\n\n```java\npublic class ProxyInvocationHandler implements InvocationHandler {\n    \n    // 被代理的接口\n    private Object target;\n\n    // 传入被代理的接口\n    public void setTarget(Object target) {\n        this.target = target;\n    }\n\n    // 生成代理类\n    public Object getProxy() {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(), this);\n    }\n\n    // 唤醒方法 返回结果\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        log(method.getName());\n        Object result = method.invoke(target, args);\n        return result;\n    }\n\n    // 定义唤起方法执行前后进行装饰的方法\n    private void log(String msg) {\n        System.out.println(\"[Log] \" + msg);\n    }\n}\n```\n\n## Proxy\n\n返回代理类，需要传入：\n\n- 当前作为Proxy的`Class加载器`.\n- 需要代理的`对象的接口`。\n- 自定义的InvocationHandler，实现了`InvocationHandler`接口。\n\n```java\npublic Object getProxy() {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), target.getClass().getInterfaces(), this);\n}\n```\n\n## InvocationHandler\n\n唤起事务处理。\n\n```java\n@Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        log(method.getName());\n        Object result = method.invoke(target, args);\n        return result;\n    }\n```\n\n实现了`InvocationHandler`，需要重写`invoke`方法。\n\n使用反射的方法执行`method.invoke`传入\n\n- 被代理的接口(target)\n- 执行时的形参(args)\n\n在唤起执行**方法前后**，可以加入**自定义的事务处理**。\n\n\n\n# 自定义\n\n可以实现将一个`ProxyInvocationHandler`分成一个`CustomProxy`和一个`CustomInvocationHandler`。\n\n## CustomInvocationHandler\n\n```java\npublic class CustomInvocationHandler implements InvocationHandler {\n\n    private IndexService indexService;\n\n    public CustomInvocationHandler(IndexService indexService) {\n        this.indexService = indexService;\n    }\n\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {  // TODO Proxy的作用？\n        logBefore(method.getName());\n        Object res = method.invoke(indexService, args);\n        logAfter(indexService.getClass().getName());\n        return res;\n    }\n\n    // 以下定义 前后装饰方法\n    private void logBefore(String msg) {\n        System.out.println(\"[Log] \" + msg);\n    }\n\n    private void logAfter(String msg) {\n        System.out.println(\"[Log] \" + msg + \"has been done!\");\n    }\n}\n```\n\n## CustomProxy\n\n```java\npublic class CustomProxy {\n\n    public Object getProxy(IndexService indexService, InvocationHandler invocationHandler) {\n        return Proxy.newProxyInstance(this.getClass().getClassLoader(), indexService.getClass().getInterfaces(), invocationHandler);\n    }\n}\n```\n\n## Client\n\n```java\npublic class CustomClient {\n    public static void main(String[] args) {\n        // 需要代理的接口\n        IndexService indexService = new IndexServiceImpl();\n        // 实例化 自定义代理接口需要进行的处理类\n        CustomInvocationHandler customInvocationHandler = new CustomInvocationHandler(indexService);\n        // 实例化 自定义的代理类\n        CustomProxy customProxy = new CustomProxy();\n        // 获取代理 需要传入代理的接口及自定义的处理类\n        IndexService proxy = (IndexService) customProxy.getProxy(indexService, customInvocationHandler);\n        // 执行测试\n        proxy.add();\n    }\n}\n```\n\n`Proxy`与`InvocationHandler`可以分离。\n\n- `InvocationHandler`必须要传需要代理的接口。\n- `Proxy`必须要传需要代理的接口，以及自定义的`Handler`。\n\n\n\n# 问题\n\n`Proxy`与`InvocationHandler`可以解藕，但是他们都需要被代理的接口。\n\n进行**接口实现接口**的设计？\n\n`InvocationHandler`中实现了`invoke`后其中传的`Proxy`的作用？","slug":"spring/aop-proxy","published":1,"date":"2021-02-02T08:47:49.128Z","updated":"2021-02-02T09:53:29.625Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982p00e3018od07mdufh","content":"<h1 id=\"引入\"><a href=\"#引入\" class=\"headerlink\" title=\"引入\"></a>引入</h1><p>相较于静态代理模式，所有的方法动态生成。</p>\n<p>这里介绍基于JDK的方式实现动态代理。</p>\n<h1 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 被代理的接口</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 传入被代理的接口</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setTarget</span><span class=\"params\">(Object target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成代理类</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(), <span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 唤醒方法 返回结果</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        log(method.getName());</span><br><span class=\"line\">        Object result = method.invoke(target, args);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义唤起方法执行前后进行装饰的方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Proxy\"><a href=\"#Proxy\" class=\"headerlink\" title=\"Proxy\"></a>Proxy</h2><p>返回代理类，需要传入：</p>\n<ul>\n<li>当前作为Proxy的<code>Class加载器</code>.</li>\n<li>需要代理的<code>对象的接口</code>。</li>\n<li>自定义的InvocationHandler，实现了<code>InvocationHandler</code>接口。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(), <span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InvocationHandler\"><a href=\"#InvocationHandler\" class=\"headerlink\" title=\"InvocationHandler\"></a>InvocationHandler</h2><p>唤起事务处理。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        log(method.getName());</span><br><span class=\"line\">        Object result = method.invoke(target, args);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>实现了<code>InvocationHandler</code>，需要重写<code>invoke</code>方法。</p>\n<p>使用反射的方法执行<code>method.invoke</code>传入</p>\n<ul>\n<li>被代理的接口(target)</li>\n<li>执行时的形参(args)</li>\n</ul>\n<p>在唤起执行<strong>方法前后</strong>，可以加入<strong>自定义的事务处理</strong>。</p>\n<h1 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h1><p>可以实现将一个<code>ProxyInvocationHandler</code>分成一个<code>CustomProxy</code>和一个<code>CustomInvocationHandler</code>。</p>\n<h2 id=\"CustomInvocationHandler\"><a href=\"#CustomInvocationHandler\" class=\"headerlink\" title=\"CustomInvocationHandler\"></a>CustomInvocationHandler</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> IndexService indexService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomInvocationHandler</span><span class=\"params\">(IndexService indexService)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.indexService = indexService;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;  <span class=\"comment\">// TODO Proxy的作用？</span></span><br><span class=\"line\">        logBefore(method.getName());</span><br><span class=\"line\">        Object res = method.invoke(indexService, args);</span><br><span class=\"line\">        logAfter(indexService.getClass().getName());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 以下定义 前后装饰方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">logBefore</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">logAfter</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg + <span class=\"string\">\"has been done!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"CustomProxy\"><a href=\"#CustomProxy\" class=\"headerlink\" title=\"CustomProxy\"></a>CustomProxy</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomProxy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">(IndexService indexService, InvocationHandler invocationHandler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), indexService.getClass().getInterfaces(), invocationHandler);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 需要代理的接口</span></span><br><span class=\"line\">        IndexService indexService = <span class=\"keyword\">new</span> IndexServiceImpl();</span><br><span class=\"line\">        <span class=\"comment\">// 实例化 自定义代理接口需要进行的处理类</span></span><br><span class=\"line\">        CustomInvocationHandler customInvocationHandler = <span class=\"keyword\">new</span> CustomInvocationHandler(indexService);</span><br><span class=\"line\">        <span class=\"comment\">// 实例化 自定义的代理类</span></span><br><span class=\"line\">        CustomProxy customProxy = <span class=\"keyword\">new</span> CustomProxy();</span><br><span class=\"line\">        <span class=\"comment\">// 获取代理 需要传入代理的接口及自定义的处理类</span></span><br><span class=\"line\">        IndexService proxy = (IndexService) customProxy.getProxy(indexService, customInvocationHandler);</span><br><span class=\"line\">        <span class=\"comment\">// 执行测试</span></span><br><span class=\"line\">        proxy.add();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>Proxy</code>与<code>InvocationHandler</code>可以分离。</p>\n<ul>\n<li><code>InvocationHandler</code>必须要传需要代理的接口。</li>\n<li><code>Proxy</code>必须要传需要代理的接口，以及自定义的<code>Handler</code>。</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p><code>Proxy</code>与<code>InvocationHandler</code>可以解藕，但是他们都需要被代理的接口。</p>\n<p>进行<strong>接口实现接口</strong>的设计？</p>\n<p><code>InvocationHandler</code>中实现了<code>invoke</code>后其中传的<code>Proxy</code>的作用？</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"引入\"><a href=\"#引入\" class=\"headerlink\" title=\"引入\"></a>引入</h1><p>相较于静态代理模式，所有的方法动态生成。</p>\n<p>这里介绍基于JDK的方式实现动态代理。</p>\n<h1 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 被代理的接口</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 传入被代理的接口</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setTarget</span><span class=\"params\">(Object target)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成代理类</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(), <span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 唤醒方法 返回结果</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        log(method.getName());</span><br><span class=\"line\">        Object result = method.invoke(target, args);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义唤起方法执行前后进行装饰的方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Proxy\"><a href=\"#Proxy\" class=\"headerlink\" title=\"Proxy\"></a>Proxy</h2><p>返回代理类，需要传入：</p>\n<ul>\n<li>当前作为Proxy的<code>Class加载器</code>.</li>\n<li>需要代理的<code>对象的接口</code>。</li>\n<li>自定义的InvocationHandler，实现了<code>InvocationHandler</code>接口。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(), <span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InvocationHandler\"><a href=\"#InvocationHandler\" class=\"headerlink\" title=\"InvocationHandler\"></a>InvocationHandler</h2><p>唤起事务处理。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        log(method.getName());</span><br><span class=\"line\">        Object result = method.invoke(target, args);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>实现了<code>InvocationHandler</code>，需要重写<code>invoke</code>方法。</p>\n<p>使用反射的方法执行<code>method.invoke</code>传入</p>\n<ul>\n<li>被代理的接口(target)</li>\n<li>执行时的形参(args)</li>\n</ul>\n<p>在唤起执行<strong>方法前后</strong>，可以加入<strong>自定义的事务处理</strong>。</p>\n<h1 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h1><p>可以实现将一个<code>ProxyInvocationHandler</code>分成一个<code>CustomProxy</code>和一个<code>CustomInvocationHandler</code>。</p>\n<h2 id=\"CustomInvocationHandler\"><a href=\"#CustomInvocationHandler\" class=\"headerlink\" title=\"CustomInvocationHandler\"></a>CustomInvocationHandler</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomInvocationHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> IndexService indexService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomInvocationHandler</span><span class=\"params\">(IndexService indexService)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.indexService = indexService;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;  <span class=\"comment\">// TODO Proxy的作用？</span></span><br><span class=\"line\">        logBefore(method.getName());</span><br><span class=\"line\">        Object res = method.invoke(indexService, args);</span><br><span class=\"line\">        logAfter(indexService.getClass().getName());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 以下定义 前后装饰方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">logBefore</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">logAfter</span><span class=\"params\">(String msg)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] \"</span> + msg + <span class=\"string\">\"has been done!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"CustomProxy\"><a href=\"#CustomProxy\" class=\"headerlink\" title=\"CustomProxy\"></a>CustomProxy</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomProxy</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getProxy</span><span class=\"params\">(IndexService indexService, InvocationHandler invocationHandler)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Proxy.newProxyInstance(<span class=\"keyword\">this</span>.getClass().getClassLoader(), indexService.getClass().getInterfaces(), invocationHandler);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 需要代理的接口</span></span><br><span class=\"line\">        IndexService indexService = <span class=\"keyword\">new</span> IndexServiceImpl();</span><br><span class=\"line\">        <span class=\"comment\">// 实例化 自定义代理接口需要进行的处理类</span></span><br><span class=\"line\">        CustomInvocationHandler customInvocationHandler = <span class=\"keyword\">new</span> CustomInvocationHandler(indexService);</span><br><span class=\"line\">        <span class=\"comment\">// 实例化 自定义的代理类</span></span><br><span class=\"line\">        CustomProxy customProxy = <span class=\"keyword\">new</span> CustomProxy();</span><br><span class=\"line\">        <span class=\"comment\">// 获取代理 需要传入代理的接口及自定义的处理类</span></span><br><span class=\"line\">        IndexService proxy = (IndexService) customProxy.getProxy(indexService, customInvocationHandler);</span><br><span class=\"line\">        <span class=\"comment\">// 执行测试</span></span><br><span class=\"line\">        proxy.add();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>Proxy</code>与<code>InvocationHandler</code>可以分离。</p>\n<ul>\n<li><code>InvocationHandler</code>必须要传需要代理的接口。</li>\n<li><code>Proxy</code>必须要传需要代理的接口，以及自定义的<code>Handler</code>。</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p><code>Proxy</code>与<code>InvocationHandler</code>可以解藕，但是他们都需要被代理的接口。</p>\n<p>进行<strong>接口实现接口</strong>的设计？</p>\n<p><code>InvocationHandler</code>中实现了<code>invoke</code>后其中传的<code>Proxy</code>的作用？</p>\n"},{"title":"SpringAOP - 使用Spring的API接口实现AOP","_content":"\n# 术语\n\nSpring AOP最重要的是可以让用户**自定义切面**。\n\n![image-20210202221824940](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221824940.png)\n\n# 使用Spring的API接口实现AOP\n\n## 需要实现的接口\n\n![image-20210202221950162](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221950162.png)\n\n## 前置通知\n\n```java\npublic class LogBefore implements MethodBeforeAdvice {\n    @Override\n    // method: 要执行的目标对象的方法，objects: 参数，o: 目标对象\n    public void before(Method method, Object[] objects, Object o) throws Throwable {\n        System.out.println(\"[Log Before]ClassName: \" + o.getClass().getSimpleName() + \" MethodName: \" + method.getName());\n    }\n}\n```\n\n## 后置通知\n\n```java\npublic class LogAfter implements AfterReturningAdvice {\n    @Override\n    public void afterReturning(Object returnValue, Method method, Object[] args, Object target) throws Throwable {\n        System.out.println(\"[Log After]ClassName: \" + target.getClass().getSimpleName() + \" MethodName: \" + method.getName());\n    }\n}\n```\n\n## 配置文件\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/aop\n        http://www.springframework.org/schema/aop/spring-aop.xsd\">\n    <bean id=\"userService\" class=\"com.edlison.design.spring.aop.style_one.service.UserServiceImpl\"/>\n    <bean id=\"logBefore\" class=\"com.edlison.design.spring.aop.style_one.log.LogBefore\"/>\n    <bean id=\"logAfter\" class=\"com.edlison.design.spring.aop.style_one.log.LogAfter\"/>\n    <aop:config>\n        <aop:pointcut id=\"first\"\n                      expression=\"execution(* com.edlison.design.spring.aop.style_one.service.UserServiceImpl.* (..))\"/>\n        <aop:advisor advice-ref=\"logBefore\" pointcut-ref=\"first\"/>\n        <aop:advisor advice-ref=\"logAfter\" pointcut-ref=\"first\"/>\n    </aop:config>\n</beans>\n```\n\n配置文件中，首先注册`Bean`，引入AOP约束，对AOP进行配置。\n\n- 定义切入点(PointCut).\n- 写表达式(Expression).\n- 配置通知器(advisor)，并将其与切入点绑定。\n\n通知器执行前后，完全靠**实现的接口**决定。\n\n\n\n**注意**：\n\n表达式见Google\n\n","source":"_posts/spring/aop-one.md","raw":"---\ntitle: SpringAOP - 使用Spring的API接口实现AOP\ncategories:\n- Notebook\n- Spring\ntags:\n- java\n- spring\n- aop\n---\n\n# 术语\n\nSpring AOP最重要的是可以让用户**自定义切面**。\n\n![image-20210202221824940](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221824940.png)\n\n# 使用Spring的API接口实现AOP\n\n## 需要实现的接口\n\n![image-20210202221950162](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221950162.png)\n\n## 前置通知\n\n```java\npublic class LogBefore implements MethodBeforeAdvice {\n    @Override\n    // method: 要执行的目标对象的方法，objects: 参数，o: 目标对象\n    public void before(Method method, Object[] objects, Object o) throws Throwable {\n        System.out.println(\"[Log Before]ClassName: \" + o.getClass().getSimpleName() + \" MethodName: \" + method.getName());\n    }\n}\n```\n\n## 后置通知\n\n```java\npublic class LogAfter implements AfterReturningAdvice {\n    @Override\n    public void afterReturning(Object returnValue, Method method, Object[] args, Object target) throws Throwable {\n        System.out.println(\"[Log After]ClassName: \" + target.getClass().getSimpleName() + \" MethodName: \" + method.getName());\n    }\n}\n```\n\n## 配置文件\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/aop\n        http://www.springframework.org/schema/aop/spring-aop.xsd\">\n    <bean id=\"userService\" class=\"com.edlison.design.spring.aop.style_one.service.UserServiceImpl\"/>\n    <bean id=\"logBefore\" class=\"com.edlison.design.spring.aop.style_one.log.LogBefore\"/>\n    <bean id=\"logAfter\" class=\"com.edlison.design.spring.aop.style_one.log.LogAfter\"/>\n    <aop:config>\n        <aop:pointcut id=\"first\"\n                      expression=\"execution(* com.edlison.design.spring.aop.style_one.service.UserServiceImpl.* (..))\"/>\n        <aop:advisor advice-ref=\"logBefore\" pointcut-ref=\"first\"/>\n        <aop:advisor advice-ref=\"logAfter\" pointcut-ref=\"first\"/>\n    </aop:config>\n</beans>\n```\n\n配置文件中，首先注册`Bean`，引入AOP约束，对AOP进行配置。\n\n- 定义切入点(PointCut).\n- 写表达式(Expression).\n- 配置通知器(advisor)，并将其与切入点绑定。\n\n通知器执行前后，完全靠**实现的接口**决定。\n\n\n\n**注意**：\n\n表达式见Google\n\n","slug":"spring/aop-one","published":1,"date":"2021-02-02T13:43:43.929Z","updated":"2021-02-02T14:34:24.453Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982q00e6018oht69f2s5","content":"<h1 id=\"术语\"><a href=\"#术语\" class=\"headerlink\" title=\"术语\"></a>术语</h1><p>Spring AOP最重要的是可以让用户<strong>自定义切面</strong>。</p>\n<p>![image-20210202221824940](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221824940.png)</p>\n<h1 id=\"使用Spring的API接口实现AOP\"><a href=\"#使用Spring的API接口实现AOP\" class=\"headerlink\" title=\"使用Spring的API接口实现AOP\"></a>使用Spring的API接口实现AOP</h1><h2 id=\"需要实现的接口\"><a href=\"#需要实现的接口\" class=\"headerlink\" title=\"需要实现的接口\"></a>需要实现的接口</h2><p>![image-20210202221950162](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221950162.png)</p>\n<h2 id=\"前置通知\"><a href=\"#前置通知\" class=\"headerlink\" title=\"前置通知\"></a>前置通知</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogBefore</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodBeforeAdvice</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"comment\">// method: 要执行的目标对象的方法，objects: 参数，o: 目标对象</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">(Method method, Object[] objects, Object o)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log Before]ClassName: \"</span> + o.getClass().getSimpleName() + <span class=\"string\">\" MethodName: \"</span> + method.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后置通知\"><a href=\"#后置通知\" class=\"headerlink\" title=\"后置通知\"></a>后置通知</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogAfter</span> <span class=\"keyword\">implements</span> <span class=\"title\">AfterReturningAdvice</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterReturning</span><span class=\"params\">(Object returnValue, Method method, Object[] args, Object target)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log After]ClassName: \"</span> + target.getClass().getSimpleName() + <span class=\"string\">\" MethodName: \"</span> + method.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:aop</span>=<span class=\"string\">\"http://www.springframework.org/schema/aop\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/aop</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/aop/spring-aop.xsd\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userService\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.service.UserServiceImpl\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"logBefore\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.log.LogBefore\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"logAfter\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.log.LogAfter\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">\"first\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      <span class=\"attr\">expression</span>=<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_one.service.UserServiceImpl.* (..))\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">\"logBefore\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">\"logAfter\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>配置文件中，首先注册<code>Bean</code>，引入AOP约束，对AOP进行配置。</p>\n<ul>\n<li>定义切入点(PointCut).</li>\n<li>写表达式(Expression).</li>\n<li>配置通知器(advisor)，并将其与切入点绑定。</li>\n</ul>\n<p>通知器执行前后，完全靠<strong>实现的接口</strong>决定。</p>\n<p><strong>注意</strong>：</p>\n<p>表达式见Google</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"术语\"><a href=\"#术语\" class=\"headerlink\" title=\"术语\"></a>术语</h1><p>Spring AOP最重要的是可以让用户<strong>自定义切面</strong>。</p>\n<p>![image-20210202221824940](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221824940.png)</p>\n<h1 id=\"使用Spring的API接口实现AOP\"><a href=\"#使用Spring的API接口实现AOP\" class=\"headerlink\" title=\"使用Spring的API接口实现AOP\"></a>使用Spring的API接口实现AOP</h1><h2 id=\"需要实现的接口\"><a href=\"#需要实现的接口\" class=\"headerlink\" title=\"需要实现的接口\"></a>需要实现的接口</h2><p>![image-20210202221950162](/Users/edlison/Library/Application Support/typora-user-images/image-20210202221950162.png)</p>\n<h2 id=\"前置通知\"><a href=\"#前置通知\" class=\"headerlink\" title=\"前置通知\"></a>前置通知</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogBefore</span> <span class=\"keyword\">implements</span> <span class=\"title\">MethodBeforeAdvice</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"comment\">// method: 要执行的目标对象的方法，objects: 参数，o: 目标对象</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">(Method method, Object[] objects, Object o)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log Before]ClassName: \"</span> + o.getClass().getSimpleName() + <span class=\"string\">\" MethodName: \"</span> + method.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后置通知\"><a href=\"#后置通知\" class=\"headerlink\" title=\"后置通知\"></a>后置通知</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogAfter</span> <span class=\"keyword\">implements</span> <span class=\"title\">AfterReturningAdvice</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterReturning</span><span class=\"params\">(Object returnValue, Method method, Object[] args, Object target)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log After]ClassName: \"</span> + target.getClass().getSimpleName() + <span class=\"string\">\" MethodName: \"</span> + method.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:aop</span>=<span class=\"string\">\"http://www.springframework.org/schema/aop\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/aop</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/aop/spring-aop.xsd\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userService\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.service.UserServiceImpl\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"logBefore\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.log.LogBefore\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"logAfter\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.aop.style_one.log.LogAfter\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">\"first\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                      <span class=\"attr\">expression</span>=<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_one.service.UserServiceImpl.* (..))\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">\"logBefore\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">\"logAfter\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>配置文件中，首先注册<code>Bean</code>，引入AOP约束，对AOP进行配置。</p>\n<ul>\n<li>定义切入点(PointCut).</li>\n<li>写表达式(Expression).</li>\n<li>配置通知器(advisor)，并将其与切入点绑定。</li>\n</ul>\n<p>通知器执行前后，完全靠<strong>实现的接口</strong>决定。</p>\n<p><strong>注意</strong>：</p>\n<p>表达式见Google</p>\n"},{"title":"SpringAOP - Start","_content":"\n# 静态代理模式\n\n![image-20210202095609829](/Users/edlison/Library/Application Support/typora-user-images/image-20210202095609829.png)\n\n## 架构分析\n\n- 抽象角色：用于设计被代理角色的方法。一般使用抽象类或接口。\n- 真实角色：被代理的角色。\n- 代理角色：对真实角色进行代理，一般还会有一些代理角色附加的业务。\n- 客户：访问代理。\n\n## 好处\n\n- 真实角色只需要专注他需要处理的业务，更加纯粹。\n- 公共业务交给代理，实现了**业务分工**。\n- 业务**扩展方便**，方便**集中管理**。\n\n## 缺点\n\n- 一个真实角色就会产生一个代理角色。**代码量**翻倍。\n\n\n\n# 问题\n\n代理模式使用**组合**(作为数据成员)的方式，将`Host`传入`Proxy`。\n\n如果使用**继承**(extends)的方式，灵活度降低。\n\n","source":"_posts/spring/aop-start.md","raw":"---\ntitle: SpringAOP - Start\ncategories:\n- Notebook\ntags:\n- java\n- spring\n- aop\n---\n\n# 静态代理模式\n\n![image-20210202095609829](/Users/edlison/Library/Application Support/typora-user-images/image-20210202095609829.png)\n\n## 架构分析\n\n- 抽象角色：用于设计被代理角色的方法。一般使用抽象类或接口。\n- 真实角色：被代理的角色。\n- 代理角色：对真实角色进行代理，一般还会有一些代理角色附加的业务。\n- 客户：访问代理。\n\n## 好处\n\n- 真实角色只需要专注他需要处理的业务，更加纯粹。\n- 公共业务交给代理，实现了**业务分工**。\n- 业务**扩展方便**，方便**集中管理**。\n\n## 缺点\n\n- 一个真实角色就会产生一个代理角色。**代码量**翻倍。\n\n\n\n# 问题\n\n代理模式使用**组合**(作为数据成员)的方式，将`Host`传入`Proxy`。\n\n如果使用**继承**(extends)的方式，灵活度降低。\n\n","slug":"spring/aop-start","published":1,"date":"2021-02-02T01:34:03.281Z","updated":"2021-02-02T08:47:46.891Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982r00ea018ohsfyebb0","content":"<h1 id=\"静态代理模式\"><a href=\"#静态代理模式\" class=\"headerlink\" title=\"静态代理模式\"></a>静态代理模式</h1><p>![image-20210202095609829](/Users/edlison/Library/Application Support/typora-user-images/image-20210202095609829.png)</p>\n<h2 id=\"架构分析\"><a href=\"#架构分析\" class=\"headerlink\" title=\"架构分析\"></a>架构分析</h2><ul>\n<li>抽象角色：用于设计被代理角色的方法。一般使用抽象类或接口。</li>\n<li>真实角色：被代理的角色。</li>\n<li>代理角色：对真实角色进行代理，一般还会有一些代理角色附加的业务。</li>\n<li>客户：访问代理。</li>\n</ul>\n<h2 id=\"好处\"><a href=\"#好处\" class=\"headerlink\" title=\"好处\"></a>好处</h2><ul>\n<li>真实角色只需要专注他需要处理的业务，更加纯粹。</li>\n<li>公共业务交给代理，实现了<strong>业务分工</strong>。</li>\n<li>业务<strong>扩展方便</strong>，方便<strong>集中管理</strong>。</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><ul>\n<li>一个真实角色就会产生一个代理角色。<strong>代码量</strong>翻倍。</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>代理模式使用<strong>组合</strong>(作为数据成员)的方式，将<code>Host</code>传入<code>Proxy</code>。</p>\n<p>如果使用<strong>继承</strong>(extends)的方式，灵活度降低。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"静态代理模式\"><a href=\"#静态代理模式\" class=\"headerlink\" title=\"静态代理模式\"></a>静态代理模式</h1><p>![image-20210202095609829](/Users/edlison/Library/Application Support/typora-user-images/image-20210202095609829.png)</p>\n<h2 id=\"架构分析\"><a href=\"#架构分析\" class=\"headerlink\" title=\"架构分析\"></a>架构分析</h2><ul>\n<li>抽象角色：用于设计被代理角色的方法。一般使用抽象类或接口。</li>\n<li>真实角色：被代理的角色。</li>\n<li>代理角色：对真实角色进行代理，一般还会有一些代理角色附加的业务。</li>\n<li>客户：访问代理。</li>\n</ul>\n<h2 id=\"好处\"><a href=\"#好处\" class=\"headerlink\" title=\"好处\"></a>好处</h2><ul>\n<li>真实角色只需要专注他需要处理的业务，更加纯粹。</li>\n<li>公共业务交给代理，实现了<strong>业务分工</strong>。</li>\n<li>业务<strong>扩展方便</strong>，方便<strong>集中管理</strong>。</li>\n</ul>\n<h2 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h2><ul>\n<li>一个真实角色就会产生一个代理角色。<strong>代码量</strong>翻倍。</li>\n</ul>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>代理模式使用<strong>组合</strong>(作为数据成员)的方式，将<code>Host</code>传入<code>Proxy</code>。</p>\n<p>如果使用<strong>继承</strong>(extends)的方式，灵活度降低。</p>\n"},{"title":"SpringIOC - Bean","_content":"\n# Bean Scope\n\n![image-20210201120028673](/Users/edlison/Library/Application Support/typora-user-images/image-20210201120028673.png)\n\nBean默认的作用域是**单例模式**，也就是内存中只有一个实例。\n\n\n\n# Bean的自动装配\n\n自动装配是Spring满足Bean的依赖的一种方式。Spring会在上下文中寻找并自动给Bean装配属性。\n\nSpring有三种装配方式\n\n- xml中显式的装配\n- java中显示的装配\n- 隐式的**自动装配**\n\n## 自动装配byName\n\n要保证Bean的id唯一，Spring会在上下文中寻找和自己对象所需要Setter注入属性的相同id的Bean。\n\n```xml\n<bean name=\"peopleAutoByName\" class=\"com.edlison.design.spring.ioc.pojo.People\" autowire=\"byName\"/>\n```\n\n## 自动装配byType\n\n要保证Bean的类型唯一，Spring会在上下文中寻找自己对象需要Setter注入的值的类型相同的Bean。\n\n```xml\n<bean name=\"peopleAutoByType\" class=\"com.edlison.design.spring.ioc.pojo.People\" autowire=\"byType\"/>\n```\n\n## 通过注解自动装配\n\n首先引入规范\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\">\n\n    <context:annotation-config/>\n\n    <bean class=\"example.SimpleMovieCatalog\" primary=\"true\">\n        <!-- inject any dependencies required by this bean -->\n    </bean>\n\n    <bean class=\"example.SimpleMovieCatalog\">\n        <!-- inject any dependencies required by this bean -->\n    </bean>\n\n    <bean id=\"movieRecommender\" class=\"example.MovieRecommender\"/>\n\n</beans>\n```\n\n对需要自动装配的对象打上注解`@Autowired`\n\n```java\npublic class People {\n    @Autowired\n    @Qualifier(value = \"dog2\")\n    private Dog dog;\n\n    @Autowired\n    @Qualifier(value = \"cat\")\n    private Cat cat;\n}\n```\n\n`@Autowired`可以通过byType或byName的方式实现自动装配。\n\n\n\n# 注解开发\n\n使用注解首先要引入context约束，Spring4.0后还需要AOP的包。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\">\n\n    <context:annotation-config/>\n    <context:component-scan base-package=\"com.edlison.design.spring.ioc\"/>\n\n</beans>\n```\n\n## 1. Bean\n\n```java\n@Component\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Component`相当于\n\n```xml\n<bean name=\"role\" class=\"com.edlison.design.spring.ioc.pojo.Role\"/>\n```\n\n**注意：**\n注入后的`Bean`的name为相应的**驼峰**形式。\n\n## 2. 属性的注入\n\n```java\n@Component\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Value`相当于\n\n```xml\n<property name=\"username\" value=\"This is username\"/>\n```\n\n## 3. 衍生的注解\n\n`@Component`有几个衍生注解，在Web开发中有MVC三层架构分层。\n\n- `@Repository`DAO层\n- `@Service`Service层\n- `@Controller`Controller层\n\n这些注解与`@Component`完全一致，只是Alias.\n\n## 4. 自动装配\n\n见上面\n\n## 5. 作用域\n\n```java\n@Component\n@Scope(\"prototype\")\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Scope`相当于\n\n```xml\n<bean id=\"role\" class=\"com.edlison.design.spring.ioc.pojo.Role\" scope=\"prototype\">\n```\n\n## 6. 总结\n\n- xml更万能适用于任何场合。维护简单方便。\n- 注解不是自己的类使用不了，维护复杂。\n\n最佳实践：\n\n- xml用来管理Bean\n- 注解用来注入属性\n\n\n\n# 注解开发-完全舍弃XML\n\n完全使用Java类实现配置。\n\n**配置类**\n\n```java\n@Configuration\n@ComponentScan(\"com.edlison.design.spring.ioc.pojo\")\n@Import(AppConfigPlus.class)\npublic class AppConfig {\n\n    @Bean\n    @Scope(\"prototype\")\n    public Student getStu() {\n        return new Student();\n    }\n\n    @Bean\n    public Card card() {\n        return new Card();\n    }\n  \n    @Autowired\n    public Student student;\n}\n```\n\n`@Configuration会使Spring容器托管，注册到容器中，它本身也有`@Component`。\n\n`@Configuration`是一个配置类，相当于xml开发时的`applicationContext.xml`。\n\n因此这个类可以配置各种在xml文件中的配置，比如`@ComponentScan`可以用来扫描指定包下的`@Component`，`@Import`可以导入其他配置类，导入其他配置类中注册的`Bean`。\n\n`@Scope`可以对`Bean`的作用域做出规定。\n\n还可以通过`@Autowired`直接对`Bean`进行装载。\n\n\n\n**Bean对象**\n\n```java\n@Component\npublic class Student {\n    @Value(\"edlison\")  // 字符对象\n    private String name;\n    @Value(\"#{card}\")  // 复杂类\n    private Card card;\n    @Autowired\n    private Bike bike;\n}\n```\n\n`@Value`可以对任何类型的属性进行注入。\n\n也可以通过`@Autowired`对复杂类型进行自动装配。\n\n\n\n**测试类**\n\n```java\n    @Test\n    public void testConfig() {\n        ApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);\n        Student student = context.getBean(\"getStu\", Student.class);\n        System.out.println(student);\n    }\n```\n\n完全使用配置类，需要通过`AnnotationConfig`上下文来获取容器，通过传入配置类的`class`对象加载。\n\n也可以直接获取`config`类，通过其方法获取实例。\n\n\n\n# 总结\n\nSpring的IOC机制实质上就是一个容器，统一管理项目开发中的各种类型，可以很方便的控制其是单例模型还是远行模型。\n\n**自动装配**机制很大的简化了**依赖注入**，可以直接匹配名称或类型，使得开发进一步简化。\n\n\n\n# 问题\n\n如果一个对象有一个复杂的数据成员对象，且该对象已经装配为`Bean`，也可以用`@Autowired`对其进行自动装配？与`@Value`功能/实质一样？\n\n","source":"_posts/spring/ioc-bean.md","raw":"---\ntitle: SpringIOC - Bean\ncategories:\n- Notebook\ntags:\n- java\n- spring\n- ioc\n- bean\n---\n\n# Bean Scope\n\n![image-20210201120028673](/Users/edlison/Library/Application Support/typora-user-images/image-20210201120028673.png)\n\nBean默认的作用域是**单例模式**，也就是内存中只有一个实例。\n\n\n\n# Bean的自动装配\n\n自动装配是Spring满足Bean的依赖的一种方式。Spring会在上下文中寻找并自动给Bean装配属性。\n\nSpring有三种装配方式\n\n- xml中显式的装配\n- java中显示的装配\n- 隐式的**自动装配**\n\n## 自动装配byName\n\n要保证Bean的id唯一，Spring会在上下文中寻找和自己对象所需要Setter注入属性的相同id的Bean。\n\n```xml\n<bean name=\"peopleAutoByName\" class=\"com.edlison.design.spring.ioc.pojo.People\" autowire=\"byName\"/>\n```\n\n## 自动装配byType\n\n要保证Bean的类型唯一，Spring会在上下文中寻找自己对象需要Setter注入的值的类型相同的Bean。\n\n```xml\n<bean name=\"peopleAutoByType\" class=\"com.edlison.design.spring.ioc.pojo.People\" autowire=\"byType\"/>\n```\n\n## 通过注解自动装配\n\n首先引入规范\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\">\n\n    <context:annotation-config/>\n\n    <bean class=\"example.SimpleMovieCatalog\" primary=\"true\">\n        <!-- inject any dependencies required by this bean -->\n    </bean>\n\n    <bean class=\"example.SimpleMovieCatalog\">\n        <!-- inject any dependencies required by this bean -->\n    </bean>\n\n    <bean id=\"movieRecommender\" class=\"example.MovieRecommender\"/>\n\n</beans>\n```\n\n对需要自动装配的对象打上注解`@Autowired`\n\n```java\npublic class People {\n    @Autowired\n    @Qualifier(value = \"dog2\")\n    private Dog dog;\n\n    @Autowired\n    @Qualifier(value = \"cat\")\n    private Cat cat;\n}\n```\n\n`@Autowired`可以通过byType或byName的方式实现自动装配。\n\n\n\n# 注解开发\n\n使用注解首先要引入context约束，Spring4.0后还需要AOP的包。\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\">\n\n    <context:annotation-config/>\n    <context:component-scan base-package=\"com.edlison.design.spring.ioc\"/>\n\n</beans>\n```\n\n## 1. Bean\n\n```java\n@Component\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Component`相当于\n\n```xml\n<bean name=\"role\" class=\"com.edlison.design.spring.ioc.pojo.Role\"/>\n```\n\n**注意：**\n注入后的`Bean`的name为相应的**驼峰**形式。\n\n## 2. 属性的注入\n\n```java\n@Component\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Value`相当于\n\n```xml\n<property name=\"username\" value=\"This is username\"/>\n```\n\n## 3. 衍生的注解\n\n`@Component`有几个衍生注解，在Web开发中有MVC三层架构分层。\n\n- `@Repository`DAO层\n- `@Service`Service层\n- `@Controller`Controller层\n\n这些注解与`@Component`完全一致，只是Alias.\n\n## 4. 自动装配\n\n见上面\n\n## 5. 作用域\n\n```java\n@Component\n@Scope(\"prototype\")\npublic class Role {\n\n    @Value(\"admin\")\n    private String role_name;\n\n    public String getRole_name() {\n        return role_name;\n    }\n}\n```\n\n`@Scope`相当于\n\n```xml\n<bean id=\"role\" class=\"com.edlison.design.spring.ioc.pojo.Role\" scope=\"prototype\">\n```\n\n## 6. 总结\n\n- xml更万能适用于任何场合。维护简单方便。\n- 注解不是自己的类使用不了，维护复杂。\n\n最佳实践：\n\n- xml用来管理Bean\n- 注解用来注入属性\n\n\n\n# 注解开发-完全舍弃XML\n\n完全使用Java类实现配置。\n\n**配置类**\n\n```java\n@Configuration\n@ComponentScan(\"com.edlison.design.spring.ioc.pojo\")\n@Import(AppConfigPlus.class)\npublic class AppConfig {\n\n    @Bean\n    @Scope(\"prototype\")\n    public Student getStu() {\n        return new Student();\n    }\n\n    @Bean\n    public Card card() {\n        return new Card();\n    }\n  \n    @Autowired\n    public Student student;\n}\n```\n\n`@Configuration会使Spring容器托管，注册到容器中，它本身也有`@Component`。\n\n`@Configuration`是一个配置类，相当于xml开发时的`applicationContext.xml`。\n\n因此这个类可以配置各种在xml文件中的配置，比如`@ComponentScan`可以用来扫描指定包下的`@Component`，`@Import`可以导入其他配置类，导入其他配置类中注册的`Bean`。\n\n`@Scope`可以对`Bean`的作用域做出规定。\n\n还可以通过`@Autowired`直接对`Bean`进行装载。\n\n\n\n**Bean对象**\n\n```java\n@Component\npublic class Student {\n    @Value(\"edlison\")  // 字符对象\n    private String name;\n    @Value(\"#{card}\")  // 复杂类\n    private Card card;\n    @Autowired\n    private Bike bike;\n}\n```\n\n`@Value`可以对任何类型的属性进行注入。\n\n也可以通过`@Autowired`对复杂类型进行自动装配。\n\n\n\n**测试类**\n\n```java\n    @Test\n    public void testConfig() {\n        ApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);\n        Student student = context.getBean(\"getStu\", Student.class);\n        System.out.println(student);\n    }\n```\n\n完全使用配置类，需要通过`AnnotationConfig`上下文来获取容器，通过传入配置类的`class`对象加载。\n\n也可以直接获取`config`类，通过其方法获取实例。\n\n\n\n# 总结\n\nSpring的IOC机制实质上就是一个容器，统一管理项目开发中的各种类型，可以很方便的控制其是单例模型还是远行模型。\n\n**自动装配**机制很大的简化了**依赖注入**，可以直接匹配名称或类型，使得开发进一步简化。\n\n\n\n# 问题\n\n如果一个对象有一个复杂的数据成员对象，且该对象已经装配为`Bean`，也可以用`@Autowired`对其进行自动装配？与`@Value`功能/实质一样？\n\n","slug":"spring/ioc-bean","published":1,"date":"2021-02-01T03:53:07.259Z","updated":"2021-02-02T01:20:14.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982s00ed018o1vnv646w","content":"<h1 id=\"Bean-Scope\"><a href=\"#Bean-Scope\" class=\"headerlink\" title=\"Bean Scope\"></a>Bean Scope</h1><p>![image-20210201120028673](/Users/edlison/Library/Application Support/typora-user-images/image-20210201120028673.png)</p>\n<p>Bean默认的作用域是<strong>单例模式</strong>，也就是内存中只有一个实例。</p>\n<h1 id=\"Bean的自动装配\"><a href=\"#Bean的自动装配\" class=\"headerlink\" title=\"Bean的自动装配\"></a>Bean的自动装配</h1><p>自动装配是Spring满足Bean的依赖的一种方式。Spring会在上下文中寻找并自动给Bean装配属性。</p>\n<p>Spring有三种装配方式</p>\n<ul>\n<li>xml中显式的装配</li>\n<li>java中显示的装配</li>\n<li>隐式的<strong>自动装配</strong></li>\n</ul>\n<h2 id=\"自动装配byName\"><a href=\"#自动装配byName\" class=\"headerlink\" title=\"自动装配byName\"></a>自动装配byName</h2><p>要保证Bean的id唯一，Spring会在上下文中寻找和自己对象所需要Setter注入属性的相同id的Bean。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"peopleAutoByName\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.People\"</span> <span class=\"attr\">autowire</span>=<span class=\"string\">\"byName\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"自动装配byType\"><a href=\"#自动装配byType\" class=\"headerlink\" title=\"自动装配byType\"></a>自动装配byType</h2><p>要保证Bean的类型唯一，Spring会在上下文中寻找自己对象需要Setter注入的值的类型相同的Bean。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"peopleAutoByType\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.People\"</span> <span class=\"attr\">autowire</span>=<span class=\"string\">\"byType\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"通过注解自动装配\"><a href=\"#通过注解自动装配\" class=\"headerlink\" title=\"通过注解自动装配\"></a>通过注解自动装配</h2><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:context</span>=<span class=\"string\">\"http://www.springframework.org/schema/context\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context/spring-context.xsd\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:annotation-config</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.SimpleMovieCatalog\"</span> <span class=\"attr\">primary</span>=<span class=\"string\">\"true\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- inject any dependencies required by this bean --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.SimpleMovieCatalog\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- inject any dependencies required by this bean --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"movieRecommender\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.MovieRecommender\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>对需要自动装配的对象打上注解<code>@Autowired</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">People</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"meta\">@Qualifier</span>(value = <span class=\"string\">\"dog2\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dog dog;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"meta\">@Qualifier</span>(value = <span class=\"string\">\"cat\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Cat cat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Autowired</code>可以通过byType或byName的方式实现自动装配。</p>\n<h1 id=\"注解开发\"><a href=\"#注解开发\" class=\"headerlink\" title=\"注解开发\"></a>注解开发</h1><p>使用注解首先要引入context约束，Spring4.0后还需要AOP的包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:context</span>=<span class=\"string\">\"http://www.springframework.org/schema/context\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context/spring-context.xsd\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:annotation-config</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.edlison.design.spring.ioc\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-Bean\"><a href=\"#1-Bean\" class=\"headerlink\" title=\"1. Bean\"></a>1. Bean</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Component</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"role\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Role\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong><br>注入后的<code>Bean</code>的name为相应的<strong>驼峰</strong>形式。</p>\n<h2 id=\"2-属性的注入\"><a href=\"#2-属性的注入\" class=\"headerlink\" title=\"2. 属性的注入\"></a>2. 属性的注入</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Value</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"This is username\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-衍生的注解\"><a href=\"#3-衍生的注解\" class=\"headerlink\" title=\"3. 衍生的注解\"></a>3. 衍生的注解</h2><p><code>@Component</code>有几个衍生注解，在Web开发中有MVC三层架构分层。</p>\n<ul>\n<li><code>@Repository</code>DAO层</li>\n<li><code>@Service</code>Service层</li>\n<li><code>@Controller</code>Controller层</li>\n</ul>\n<p>这些注解与<code>@Component</code>完全一致，只是Alias.</p>\n<h2 id=\"4-自动装配\"><a href=\"#4-自动装配\" class=\"headerlink\" title=\"4. 自动装配\"></a>4. 自动装配</h2><p>见上面</p>\n<h2 id=\"5-作用域\"><a href=\"#5-作用域\" class=\"headerlink\" title=\"5. 作用域\"></a>5. 作用域</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Scope</span>(<span class=\"string\">\"prototype\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Scope</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"role\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Role\"</span> <span class=\"attr\">scope</span>=<span class=\"string\">\"prototype\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-总结\"><a href=\"#6-总结\" class=\"headerlink\" title=\"6. 总结\"></a>6. 总结</h2><ul>\n<li>xml更万能适用于任何场合。维护简单方便。</li>\n<li>注解不是自己的类使用不了，维护复杂。</li>\n</ul>\n<p>最佳实践：</p>\n<ul>\n<li>xml用来管理Bean</li>\n<li>注解用来注入属性</li>\n</ul>\n<h1 id=\"注解开发-完全舍弃XML\"><a href=\"#注解开发-完全舍弃XML\" class=\"headerlink\" title=\"注解开发-完全舍弃XML\"></a>注解开发-完全舍弃XML</h1><p>完全使用Java类实现配置。</p>\n<p><strong>配置类</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan</span>(<span class=\"string\">\"com.edlison.design.spring.ioc.pojo\"</span>)</span><br><span class=\"line\"><span class=\"meta\">@Import</span>(AppConfigPlus<span class=\"class\">.<span class=\"keyword\">class</span>)</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">public</span> <span class=\"title\">class</span> <span class=\"title\">AppConfig</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@Scope</span>(<span class=\"string\">\"prototype\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Student <span class=\"title\">getStu</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Student();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Card <span class=\"title\">card</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Card();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Student student;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Configuration会使Spring容器托管，注册到容器中，它本身也有</code>@Component`。</p>\n<p><code>@Configuration</code>是一个配置类，相当于xml开发时的<code>applicationContext.xml</code>。</p>\n<p>因此这个类可以配置各种在xml文件中的配置，比如<code>@ComponentScan</code>可以用来扫描指定包下的<code>@Component</code>，<code>@Import</code>可以导入其他配置类，导入其他配置类中注册的<code>Bean</code>。</p>\n<p><code>@Scope</code>可以对<code>Bean</code>的作用域做出规定。</p>\n<p>还可以通过<code>@Autowired</code>直接对<code>Bean</code>进行装载。</p>\n<p><strong>Bean对象</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"edlison\"</span>)  <span class=\"comment\">// 字符对象</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"#&#123;card&#125;\"</span>)  <span class=\"comment\">// 复杂类</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Card card;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Bike bike;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Value</code>可以对任何类型的属性进行注入。</p>\n<p>也可以通过<code>@Autowired</code>对复杂类型进行自动装配。</p>\n<p><strong>测试类</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ApplicationContext context = <span class=\"keyword\">new</span> AnnotationConfigApplicationContext(AppConfig<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">    Student student = context.getBean(<span class=\"string\">\"getStu\"</span>, Student<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">    System.out.println(student);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>完全使用配置类，需要通过<code>AnnotationConfig</code>上下文来获取容器，通过传入配置类的<code>class</code>对象加载。</p>\n<p>也可以直接获取<code>config</code>类，通过其方法获取实例。</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>Spring的IOC机制实质上就是一个容器，统一管理项目开发中的各种类型，可以很方便的控制其是单例模型还是远行模型。</p>\n<p><strong>自动装配</strong>机制很大的简化了<strong>依赖注入</strong>，可以直接匹配名称或类型，使得开发进一步简化。</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>如果一个对象有一个复杂的数据成员对象，且该对象已经装配为<code>Bean</code>，也可以用<code>@Autowired</code>对其进行自动装配？与<code>@Value</code>功能/实质一样？</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Bean-Scope\"><a href=\"#Bean-Scope\" class=\"headerlink\" title=\"Bean Scope\"></a>Bean Scope</h1><p>![image-20210201120028673](/Users/edlison/Library/Application Support/typora-user-images/image-20210201120028673.png)</p>\n<p>Bean默认的作用域是<strong>单例模式</strong>，也就是内存中只有一个实例。</p>\n<h1 id=\"Bean的自动装配\"><a href=\"#Bean的自动装配\" class=\"headerlink\" title=\"Bean的自动装配\"></a>Bean的自动装配</h1><p>自动装配是Spring满足Bean的依赖的一种方式。Spring会在上下文中寻找并自动给Bean装配属性。</p>\n<p>Spring有三种装配方式</p>\n<ul>\n<li>xml中显式的装配</li>\n<li>java中显示的装配</li>\n<li>隐式的<strong>自动装配</strong></li>\n</ul>\n<h2 id=\"自动装配byName\"><a href=\"#自动装配byName\" class=\"headerlink\" title=\"自动装配byName\"></a>自动装配byName</h2><p>要保证Bean的id唯一，Spring会在上下文中寻找和自己对象所需要Setter注入属性的相同id的Bean。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"peopleAutoByName\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.People\"</span> <span class=\"attr\">autowire</span>=<span class=\"string\">\"byName\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"自动装配byType\"><a href=\"#自动装配byType\" class=\"headerlink\" title=\"自动装配byType\"></a>自动装配byType</h2><p>要保证Bean的类型唯一，Spring会在上下文中寻找自己对象需要Setter注入的值的类型相同的Bean。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"peopleAutoByType\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.People\"</span> <span class=\"attr\">autowire</span>=<span class=\"string\">\"byType\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"通过注解自动装配\"><a href=\"#通过注解自动装配\" class=\"headerlink\" title=\"通过注解自动装配\"></a>通过注解自动装配</h2><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:context</span>=<span class=\"string\">\"http://www.springframework.org/schema/context\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context/spring-context.xsd\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:annotation-config</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.SimpleMovieCatalog\"</span> <span class=\"attr\">primary</span>=<span class=\"string\">\"true\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- inject any dependencies required by this bean --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.SimpleMovieCatalog\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- inject any dependencies required by this bean --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"movieRecommender\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"example.MovieRecommender\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>对需要自动装配的对象打上注解<code>@Autowired</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">People</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"meta\">@Qualifier</span>(value = <span class=\"string\">\"dog2\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dog dog;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"meta\">@Qualifier</span>(value = <span class=\"string\">\"cat\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Cat cat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Autowired</code>可以通过byType或byName的方式实现自动装配。</p>\n<h1 id=\"注解开发\"><a href=\"#注解开发\" class=\"headerlink\" title=\"注解开发\"></a>注解开发</h1><p>使用注解首先要引入context约束，Spring4.0后还需要AOP的包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:context</span>=<span class=\"string\">\"http://www.springframework.org/schema/context\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">        http://www.springframework.org/schema/context/spring-context.xsd\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:annotation-config</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.edlison.design.spring.ioc\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-Bean\"><a href=\"#1-Bean\" class=\"headerlink\" title=\"1. Bean\"></a>1. Bean</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Component</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">name</span>=<span class=\"string\">\"role\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Role\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong><br>注入后的<code>Bean</code>的name为相应的<strong>驼峰</strong>形式。</p>\n<h2 id=\"2-属性的注入\"><a href=\"#2-属性的注入\" class=\"headerlink\" title=\"2. 属性的注入\"></a>2. 属性的注入</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Value</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"This is username\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-衍生的注解\"><a href=\"#3-衍生的注解\" class=\"headerlink\" title=\"3. 衍生的注解\"></a>3. 衍生的注解</h2><p><code>@Component</code>有几个衍生注解，在Web开发中有MVC三层架构分层。</p>\n<ul>\n<li><code>@Repository</code>DAO层</li>\n<li><code>@Service</code>Service层</li>\n<li><code>@Controller</code>Controller层</li>\n</ul>\n<p>这些注解与<code>@Component</code>完全一致，只是Alias.</p>\n<h2 id=\"4-自动装配\"><a href=\"#4-自动装配\" class=\"headerlink\" title=\"4. 自动装配\"></a>4. 自动装配</h2><p>见上面</p>\n<h2 id=\"5-作用域\"><a href=\"#5-作用域\" class=\"headerlink\" title=\"5. 作用域\"></a>5. 作用域</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Scope</span>(<span class=\"string\">\"prototype\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Role</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String role_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getRole_name</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> role_name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Scope</code>相当于</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"role\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Role\"</span> <span class=\"attr\">scope</span>=<span class=\"string\">\"prototype\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-总结\"><a href=\"#6-总结\" class=\"headerlink\" title=\"6. 总结\"></a>6. 总结</h2><ul>\n<li>xml更万能适用于任何场合。维护简单方便。</li>\n<li>注解不是自己的类使用不了，维护复杂。</li>\n</ul>\n<p>最佳实践：</p>\n<ul>\n<li>xml用来管理Bean</li>\n<li>注解用来注入属性</li>\n</ul>\n<h1 id=\"注解开发-完全舍弃XML\"><a href=\"#注解开发-完全舍弃XML\" class=\"headerlink\" title=\"注解开发-完全舍弃XML\"></a>注解开发-完全舍弃XML</h1><p>完全使用Java类实现配置。</p>\n<p><strong>配置类</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan</span>(<span class=\"string\">\"com.edlison.design.spring.ioc.pojo\"</span>)</span><br><span class=\"line\"><span class=\"meta\">@Import</span>(AppConfigPlus<span class=\"class\">.<span class=\"keyword\">class</span>)</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">public</span> <span class=\"title\">class</span> <span class=\"title\">AppConfig</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@Scope</span>(<span class=\"string\">\"prototype\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Student <span class=\"title\">getStu</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Student();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Card <span class=\"title\">card</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Card();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Student student;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Configuration会使Spring容器托管，注册到容器中，它本身也有</code>@Component`。</p>\n<p><code>@Configuration</code>是一个配置类，相当于xml开发时的<code>applicationContext.xml</code>。</p>\n<p>因此这个类可以配置各种在xml文件中的配置，比如<code>@ComponentScan</code>可以用来扫描指定包下的<code>@Component</code>，<code>@Import</code>可以导入其他配置类，导入其他配置类中注册的<code>Bean</code>。</p>\n<p><code>@Scope</code>可以对<code>Bean</code>的作用域做出规定。</p>\n<p>还可以通过<code>@Autowired</code>直接对<code>Bean</code>进行装载。</p>\n<p><strong>Bean对象</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"edlison\"</span>)  <span class=\"comment\">// 字符对象</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"meta\">@Value</span>(<span class=\"string\">\"#&#123;card&#125;\"</span>)  <span class=\"comment\">// 复杂类</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Card card;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Bike bike;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Value</code>可以对任何类型的属性进行注入。</p>\n<p>也可以通过<code>@Autowired</code>对复杂类型进行自动装配。</p>\n<p><strong>测试类</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">testConfig</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ApplicationContext context = <span class=\"keyword\">new</span> AnnotationConfigApplicationContext(AppConfig<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">    Student student = context.getBean(<span class=\"string\">\"getStu\"</span>, Student<span class=\"class\">.<span class=\"keyword\">class</span>)</span>;</span><br><span class=\"line\">    System.out.println(student);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>完全使用配置类，需要通过<code>AnnotationConfig</code>上下文来获取容器，通过传入配置类的<code>class</code>对象加载。</p>\n<p>也可以直接获取<code>config</code>类，通过其方法获取实例。</p>\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>Spring的IOC机制实质上就是一个容器，统一管理项目开发中的各种类型，可以很方便的控制其是单例模型还是远行模型。</p>\n<p><strong>自动装配</strong>机制很大的简化了<strong>依赖注入</strong>，可以直接匹配名称或类型，使得开发进一步简化。</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>如果一个对象有一个复杂的数据成员对象，且该对象已经装配为<code>Bean</code>，也可以用<code>@Autowired</code>对其进行自动装配？与<code>@Value</code>功能/实质一样？</p>\n"},{"title":"SpringAOP - 注解实现AOP","_content":"\n# 注解实现AOP\n\n## 配置类\n\n```java\n@Configuration\n@EnableAspectJAutoProxy\npublic class AnnoAOPConfig {\n    @Bean\n    public LogAnno logAnno() {\n        return new LogAnno();\n    }\n    @Bean\n    public LoginService loginService() {\n        return new LoginServiceImpl();\n    }\n}\n```\n\n注意`@EnableAspectJAutoProxy`**开启自动Proxy**。\n\n如果是使用xml进行配置，也需要开启自动Proxy。\n\n业务类应该返回**相应的接口**，动态路由的底层实现即是对接口进行调用。\n\n## 切面类\n\n```java\n@Aspect\n@Component\npublic class LogAnno {\n    @Before(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void before() {\n        System.out.println(\"[Log] Before...\");\n    }\n    @After(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void after() {\n        System.out.println(\"[Log] After...\");\n    }\n    @Around(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void around(ProceedingJoinPoint joinPoint) throws Throwable {\n        System.out.println(\"[Log] Point Start\");\n        joinPoint.proceed();\n        System.out.println(\"[Log] Point End\");\n        System.out.println(\"joinPoint.getSignature() = \" + joinPoint.getSignature());\n    }\n}\n```\n\n`@Aspect`实际上是引用的`org.aspectj`包。\n\n切面类`@Component`注册为`Bean`。\n\n\n\n# 问题\n\n- 执行先后顺序与视频中的不一样，与Python装饰器的不一样，使用配置类的原因？\n- `@Component`与`@Bean`重复？\n\n","source":"_posts/spring/aop-three.md","raw":"---\ntitle: SpringAOP - 注解实现AOP\ncategories:\n- Notebook\n- Spring\ntags:\n- java\n- spring\n- aop\n---\n\n# 注解实现AOP\n\n## 配置类\n\n```java\n@Configuration\n@EnableAspectJAutoProxy\npublic class AnnoAOPConfig {\n    @Bean\n    public LogAnno logAnno() {\n        return new LogAnno();\n    }\n    @Bean\n    public LoginService loginService() {\n        return new LoginServiceImpl();\n    }\n}\n```\n\n注意`@EnableAspectJAutoProxy`**开启自动Proxy**。\n\n如果是使用xml进行配置，也需要开启自动Proxy。\n\n业务类应该返回**相应的接口**，动态路由的底层实现即是对接口进行调用。\n\n## 切面类\n\n```java\n@Aspect\n@Component\npublic class LogAnno {\n    @Before(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void before() {\n        System.out.println(\"[Log] Before...\");\n    }\n    @After(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void after() {\n        System.out.println(\"[Log] After...\");\n    }\n    @Around(\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\")\n    public void around(ProceedingJoinPoint joinPoint) throws Throwable {\n        System.out.println(\"[Log] Point Start\");\n        joinPoint.proceed();\n        System.out.println(\"[Log] Point End\");\n        System.out.println(\"joinPoint.getSignature() = \" + joinPoint.getSignature());\n    }\n}\n```\n\n`@Aspect`实际上是引用的`org.aspectj`包。\n\n切面类`@Component`注册为`Bean`。\n\n\n\n# 问题\n\n- 执行先后顺序与视频中的不一样，与Python装饰器的不一样，使用配置类的原因？\n- `@Component`与`@Bean`重复？\n\n","slug":"spring/aop-three","published":1,"date":"2021-02-02T15:03:38.828Z","updated":"2021-02-02T15:58:10.095Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982t00eh018ohzr70p6b","content":"<h1 id=\"注解实现AOP\"><a href=\"#注解实现AOP\" class=\"headerlink\" title=\"注解实现AOP\"></a>注解实现AOP</h1><h2 id=\"配置类\"><a href=\"#配置类\" class=\"headerlink\" title=\"配置类\"></a>配置类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAspectJAutoProxy</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AnnoAOPConfig</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LogAnno <span class=\"title\">logAnno</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LogAnno();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LoginService <span class=\"title\">loginService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LoginServiceImpl();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意<code>@EnableAspectJAutoProxy</code><strong>开启自动Proxy</strong>。</p>\n<p>如果是使用xml进行配置，也需要开启自动Proxy。</p>\n<p>业务类应该返回<strong>相应的接口</strong>，动态路由的底层实现即是对接口进行调用。</p>\n<h2 id=\"切面类\"><a href=\"#切面类\" class=\"headerlink\" title=\"切面类\"></a>切面类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogAnno</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Before...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@After</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">after</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] After...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Around</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">around</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Point Start\"</span>);</span><br><span class=\"line\">        joinPoint.proceed();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Point End\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"joinPoint.getSignature() = \"</span> + joinPoint.getSignature());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Aspect</code>实际上是引用的<code>org.aspectj</code>包。</p>\n<p>切面类<code>@Component</code>注册为<code>Bean</code>。</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><ul>\n<li>执行先后顺序与视频中的不一样，与Python装饰器的不一样，使用配置类的原因？</li>\n<li><code>@Component</code>与<code>@Bean</code>重复？</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"注解实现AOP\"><a href=\"#注解实现AOP\" class=\"headerlink\" title=\"注解实现AOP\"></a>注解实现AOP</h1><h2 id=\"配置类\"><a href=\"#配置类\" class=\"headerlink\" title=\"配置类\"></a>配置类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAspectJAutoProxy</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AnnoAOPConfig</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LogAnno <span class=\"title\">logAnno</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LogAnno();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LoginService <span class=\"title\">loginService</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LoginServiceImpl();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意<code>@EnableAspectJAutoProxy</code><strong>开启自动Proxy</strong>。</p>\n<p>如果是使用xml进行配置，也需要开启自动Proxy。</p>\n<p>业务类应该返回<strong>相应的接口</strong>，动态路由的底层实现即是对接口进行调用。</p>\n<h2 id=\"切面类\"><a href=\"#切面类\" class=\"headerlink\" title=\"切面类\"></a>切面类</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LogAnno</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Before...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@After</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">after</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] After...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Around</span>(<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_anno.LoginServiceImpl.*(..))\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">around</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Point Start\"</span>);</span><br><span class=\"line\">        joinPoint.proceed();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Point End\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"joinPoint.getSignature() = \"</span> + joinPoint.getSignature());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>@Aspect</code>实际上是引用的<code>org.aspectj</code>包。</p>\n<p>切面类<code>@Component</code>注册为<code>Bean</code>。</p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><ul>\n<li>执行先后顺序与视频中的不一样，与Python装饰器的不一样，使用配置类的原因？</li>\n<li><code>@Component</code>与<code>@Bean</code>重复？</li>\n</ul>\n"},{"title":"SpringAOP - 自定义切面实现AOP","_content":"\n# 自定义切面实现AOP\n\n通过切面来实现AOP\n\n## Aspect\n\n```java\npublic class CustomAspect {\n    public void before() {\n        System.out.println(\"[Log] Before...\");\n    }\n    public void after() {\n        System.out.println(\"[Log] After...\");\n    }\n}\n```\n\n## 配置文件\n\n```xml\n<aop:config>\n        <aop:aspect ref=\"customAspect\">\n            <aop:pointcut id=\"first\"\n                          expression=\"execution(* com.edlison.design.spring.aop.style_api.service.UserServiceImpl.*(..))\"/>\n\n            <aop:before method=\"before\" pointcut-ref=\"first\"/>\n            <aop:after method=\"after\" pointcut-ref=\"first\"/>\n        </aop:aspect>\n    </aop:config>\n```\n\n这种方式更加简便，只需要定义一个切面类，类中的方法即可通过配置，来对切点进行操作，不再需要繁琐的实现接口。\n\n但是无法实现更复杂的操作，比如打印调用的切点方法，类名等。","source":"_posts/spring/aop-two.md","raw":"---\ntitle: SpringAOP - 自定义切面实现AOP\ncategories:\n- Notebook\n- Spring\ntags:\n- java\n- spring\n- aop\n---\n\n# 自定义切面实现AOP\n\n通过切面来实现AOP\n\n## Aspect\n\n```java\npublic class CustomAspect {\n    public void before() {\n        System.out.println(\"[Log] Before...\");\n    }\n    public void after() {\n        System.out.println(\"[Log] After...\");\n    }\n}\n```\n\n## 配置文件\n\n```xml\n<aop:config>\n        <aop:aspect ref=\"customAspect\">\n            <aop:pointcut id=\"first\"\n                          expression=\"execution(* com.edlison.design.spring.aop.style_api.service.UserServiceImpl.*(..))\"/>\n\n            <aop:before method=\"before\" pointcut-ref=\"first\"/>\n            <aop:after method=\"after\" pointcut-ref=\"first\"/>\n        </aop:aspect>\n    </aop:config>\n```\n\n这种方式更加简便，只需要定义一个切面类，类中的方法即可通过配置，来对切点进行操作，不再需要繁琐的实现接口。\n\n但是无法实现更复杂的操作，比如打印调用的切点方法，类名等。","slug":"spring/aop-two","published":1,"date":"2021-02-02T14:33:19.586Z","updated":"2021-02-02T14:55:33.362Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982u00ej018o6q8oc6y2","content":"<h1 id=\"自定义切面实现AOP\"><a href=\"#自定义切面实现AOP\" class=\"headerlink\" title=\"自定义切面实现AOP\"></a>自定义切面实现AOP</h1><p>通过切面来实现AOP</p>\n<h2 id=\"Aspect\"><a href=\"#Aspect\" class=\"headerlink\" title=\"Aspect\"></a>Aspect</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomAspect</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Before...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">after</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] After...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:aspect</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"customAspect\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">\"first\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                          <span class=\"attr\">expression</span>=<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_api.service.UserServiceImpl.*(..))\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:before</span> <span class=\"attr\">method</span>=<span class=\"string\">\"before\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:after</span> <span class=\"attr\">method</span>=<span class=\"string\">\"after\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">aop:aspect</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这种方式更加简便，只需要定义一个切面类，类中的方法即可通过配置，来对切点进行操作，不再需要繁琐的实现接口。</p>\n<p>但是无法实现更复杂的操作，比如打印调用的切点方法，类名等。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"自定义切面实现AOP\"><a href=\"#自定义切面实现AOP\" class=\"headerlink\" title=\"自定义切面实现AOP\"></a>自定义切面实现AOP</h1><p>通过切面来实现AOP</p>\n<h2 id=\"Aspect\"><a href=\"#Aspect\" class=\"headerlink\" title=\"Aspect\"></a>Aspect</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomAspect</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] Before...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">after</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"[Log] After...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:aspect</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"customAspect\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">\"first\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                          <span class=\"attr\">expression</span>=<span class=\"string\">\"execution(* com.edlison.design.spring.aop.style_api.service.UserServiceImpl.*(..))\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:before</span> <span class=\"attr\">method</span>=<span class=\"string\">\"before\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">aop:after</span> <span class=\"attr\">method</span>=<span class=\"string\">\"after\"</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">\"first\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">aop:aspect</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这种方式更加简便，只需要定义一个切面类，类中的方法即可通过配置，来对切点进行操作，不再需要繁琐的实现接口。</p>\n<p>但是无法实现更复杂的操作，比如打印调用的切点方法，类名等。</p>\n"},{"title":"SpringIOC - Dependency Injection","_content":"\n# 依赖注入\n\n## 构造器注入\n\n见上一篇\n\n在创建对象的时候注入。\n\n\n\n## Setter方法注入\n\n可以注入任何的类型，如Bean(复杂对象)，一般类型，集合等数据结构。\n\n### String\n\n```xml\n<property name=\"username\" value=\"This is username\"/>\n```\n\n### Bean\n\n```xml\n<property name=\"address\" ref=\"address\"/>\n```\n\n### Array\n\n```xml\n<property name=\"books\">\n            <array>\n                <value>Java</value>\n                <value>Python</value>\n                <value>Scala</value>\n            </array>\n</property>\n```\n\n### List\n\n```xml\n<property name=\"hobbies\">\n            <list>\n                <value>movies</value>\n                <value>tennis</value>\n            </list>\n</property>\n```\n\n### Set\n\n```xml\n<property name=\"games\">\n            <set>\n                <value>SC2</value>\n                <value>LOL</value>\n                <value>CSGO</value>\n            </set>\n        </property>\n```\n\n### Map\n\n```xml\n<property name=\"cards\">\n            <map>\n                <entry key=\"idcard\" value=\"320325\"/>\n                <entry key=\"stucard\" value=\"1801\"/>\n            </map>\n</property>\n```\n\n### Properties\n\n```xml\n<property name=\"info\">\n            <props>\n                <prop key=\"Title\">CEO</prop>\n            </props>\n</property>\n```\n\n### Null\n\n```xml\n<property name=\"wife\">\n            <null>null_value</null>\n</property>\n```\n\n### 注意\n\n发现对Array或List赋值，标签`<array>`和`list`可以互换，没有影响。\n\n\n\n## 扩展方式注入\n\n### P命名空间\n\n首先引入规范\n\n```xml\nxmlns:p=\"http://www.springframework.org/schema/p\"\n```\n\n其实就对应Setter方法注入，只不过简化了，使用`p:`.\n\n```xml\n<bean id=\"userServicePlus\" class=\"com.edlison.design.spring.ioc.service.UserService\" p:userDAO-ref=\"user\" p:userServiceLog=\"This is a log.\"/>\n```\n\n### C命名空间\n\n首先引入规范\n\n```xml\nxmlns:c=\"http://www.springframework.org/schema/c\"\n```\n\n其实就对应构造器注入，只不过简化了，使用`c:`.\n\n使用有参构造。\n\n```xml\n<bean id=\"addressPlus\" class=\"com.edlison.design.spring.ioc.pojo.Address\" c:city=\"Nanjing\"/>\n```\n\n\n\n","source":"_posts/spring/ioc-di.md","raw":"---\ntitle: SpringIOC - Dependency Injection\ncategories:\n- Notebook\ntags:\n- java\n- spring\n- ioc\n---\n\n# 依赖注入\n\n## 构造器注入\n\n见上一篇\n\n在创建对象的时候注入。\n\n\n\n## Setter方法注入\n\n可以注入任何的类型，如Bean(复杂对象)，一般类型，集合等数据结构。\n\n### String\n\n```xml\n<property name=\"username\" value=\"This is username\"/>\n```\n\n### Bean\n\n```xml\n<property name=\"address\" ref=\"address\"/>\n```\n\n### Array\n\n```xml\n<property name=\"books\">\n            <array>\n                <value>Java</value>\n                <value>Python</value>\n                <value>Scala</value>\n            </array>\n</property>\n```\n\n### List\n\n```xml\n<property name=\"hobbies\">\n            <list>\n                <value>movies</value>\n                <value>tennis</value>\n            </list>\n</property>\n```\n\n### Set\n\n```xml\n<property name=\"games\">\n            <set>\n                <value>SC2</value>\n                <value>LOL</value>\n                <value>CSGO</value>\n            </set>\n        </property>\n```\n\n### Map\n\n```xml\n<property name=\"cards\">\n            <map>\n                <entry key=\"idcard\" value=\"320325\"/>\n                <entry key=\"stucard\" value=\"1801\"/>\n            </map>\n</property>\n```\n\n### Properties\n\n```xml\n<property name=\"info\">\n            <props>\n                <prop key=\"Title\">CEO</prop>\n            </props>\n</property>\n```\n\n### Null\n\n```xml\n<property name=\"wife\">\n            <null>null_value</null>\n</property>\n```\n\n### 注意\n\n发现对Array或List赋值，标签`<array>`和`list`可以互换，没有影响。\n\n\n\n## 扩展方式注入\n\n### P命名空间\n\n首先引入规范\n\n```xml\nxmlns:p=\"http://www.springframework.org/schema/p\"\n```\n\n其实就对应Setter方法注入，只不过简化了，使用`p:`.\n\n```xml\n<bean id=\"userServicePlus\" class=\"com.edlison.design.spring.ioc.service.UserService\" p:userDAO-ref=\"user\" p:userServiceLog=\"This is a log.\"/>\n```\n\n### C命名空间\n\n首先引入规范\n\n```xml\nxmlns:c=\"http://www.springframework.org/schema/c\"\n```\n\n其实就对应构造器注入，只不过简化了，使用`c:`.\n\n使用有参构造。\n\n```xml\n<bean id=\"addressPlus\" class=\"com.edlison.design.spring.ioc.pojo.Address\" c:city=\"Nanjing\"/>\n```\n\n\n\n","slug":"spring/ioc-di","published":1,"date":"2021-02-01T02:26:19.080Z","updated":"2021-02-01T05:41:42.723Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982v00em018oebxm9lon","content":"<h1 id=\"依赖注入\"><a href=\"#依赖注入\" class=\"headerlink\" title=\"依赖注入\"></a>依赖注入</h1><h2 id=\"构造器注入\"><a href=\"#构造器注入\" class=\"headerlink\" title=\"构造器注入\"></a>构造器注入</h2><p>见上一篇</p>\n<p>在创建对象的时候注入。</p>\n<h2 id=\"Setter方法注入\"><a href=\"#Setter方法注入\" class=\"headerlink\" title=\"Setter方法注入\"></a>Setter方法注入</h2><p>可以注入任何的类型，如Bean(复杂对象)，一般类型，集合等数据结构。</p>\n<h3 id=\"String\"><a href=\"#String\" class=\"headerlink\" title=\"String\"></a>String</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"This is username\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Bean\"><a href=\"#Bean\" class=\"headerlink\" title=\"Bean\"></a>Bean</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"address\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"address\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Array\"><a href=\"#Array\" class=\"headerlink\" title=\"Array\"></a>Array</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"books\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Java<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Python<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Scala<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"hobbies\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>movies<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>tennis<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Set\"><a href=\"#Set\" class=\"headerlink\" title=\"Set\"></a>Set</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"games\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>SC2<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>LOL<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>CSGO<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"cards\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">\"idcard\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"320325\"</span>/&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">\"stucard\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1801\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Properties\"><a href=\"#Properties\" class=\"headerlink\" title=\"Properties\"></a>Properties</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"info\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">prop</span> <span class=\"attr\">key</span>=<span class=\"string\">\"Title\"</span>&gt;</span>CEO<span class=\"tag\">&lt;/<span class=\"name\">prop</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Null\"><a href=\"#Null\" class=\"headerlink\" title=\"Null\"></a>Null</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"wife\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">null</span>&gt;</span>null_value<span class=\"tag\">&lt;/<span class=\"name\">null</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h3><p>发现对Array或List赋值，标签<code>&lt;array&gt;</code>和<code>list</code>可以互换，没有影响。</p>\n<h2 id=\"扩展方式注入\"><a href=\"#扩展方式注入\" class=\"headerlink\" title=\"扩展方式注入\"></a>扩展方式注入</h2><h3 id=\"P命名空间\"><a href=\"#P命名空间\" class=\"headerlink\" title=\"P命名空间\"></a>P命名空间</h3><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xmlns:p=\"http://www.springframework.org/schema/p\"</span><br></pre></td></tr></table></figure>\n\n<p>其实就对应Setter方法注入，只不过简化了，使用<code>p:</code>.</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userServicePlus\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.service.UserService\"</span> <span class=\"attr\">p:userDAO-ref</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">p:userServiceLog</span>=<span class=\"string\">\"This is a log.\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"C命名空间\"><a href=\"#C命名空间\" class=\"headerlink\" title=\"C命名空间\"></a>C命名空间</h3><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xmlns:c=\"http://www.springframework.org/schema/c\"</span><br></pre></td></tr></table></figure>\n\n<p>其实就对应构造器注入，只不过简化了，使用<code>c:</code>.</p>\n<p>使用有参构造。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"addressPlus\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Address\"</span> <span class=\"attr\">c:city</span>=<span class=\"string\">\"Nanjing\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"依赖注入\"><a href=\"#依赖注入\" class=\"headerlink\" title=\"依赖注入\"></a>依赖注入</h1><h2 id=\"构造器注入\"><a href=\"#构造器注入\" class=\"headerlink\" title=\"构造器注入\"></a>构造器注入</h2><p>见上一篇</p>\n<p>在创建对象的时候注入。</p>\n<h2 id=\"Setter方法注入\"><a href=\"#Setter方法注入\" class=\"headerlink\" title=\"Setter方法注入\"></a>Setter方法注入</h2><p>可以注入任何的类型，如Bean(复杂对象)，一般类型，集合等数据结构。</p>\n<h3 id=\"String\"><a href=\"#String\" class=\"headerlink\" title=\"String\"></a>String</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"This is username\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Bean\"><a href=\"#Bean\" class=\"headerlink\" title=\"Bean\"></a>Bean</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"address\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"address\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Array\"><a href=\"#Array\" class=\"headerlink\" title=\"Array\"></a>Array</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"books\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Java<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Python<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Scala<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"hobbies\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>movies<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>tennis<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Set\"><a href=\"#Set\" class=\"headerlink\" title=\"Set\"></a>Set</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"games\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>SC2<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>LOL<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>CSGO<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"cards\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">\"idcard\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"320325\"</span>/&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">\"stucard\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"1801\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Properties\"><a href=\"#Properties\" class=\"headerlink\" title=\"Properties\"></a>Properties</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"info\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">prop</span> <span class=\"attr\">key</span>=<span class=\"string\">\"Title\"</span>&gt;</span>CEO<span class=\"tag\">&lt;/<span class=\"name\">prop</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Null\"><a href=\"#Null\" class=\"headerlink\" title=\"Null\"></a>Null</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"wife\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">null</span>&gt;</span>null_value<span class=\"tag\">&lt;/<span class=\"name\">null</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h3><p>发现对Array或List赋值，标签<code>&lt;array&gt;</code>和<code>list</code>可以互换，没有影响。</p>\n<h2 id=\"扩展方式注入\"><a href=\"#扩展方式注入\" class=\"headerlink\" title=\"扩展方式注入\"></a>扩展方式注入</h2><h3 id=\"P命名空间\"><a href=\"#P命名空间\" class=\"headerlink\" title=\"P命名空间\"></a>P命名空间</h3><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xmlns:p=\"http://www.springframework.org/schema/p\"</span><br></pre></td></tr></table></figure>\n\n<p>其实就对应Setter方法注入，只不过简化了，使用<code>p:</code>.</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userServicePlus\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.service.UserService\"</span> <span class=\"attr\">p:userDAO-ref</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">p:userServiceLog</span>=<span class=\"string\">\"This is a log.\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"C命名空间\"><a href=\"#C命名空间\" class=\"headerlink\" title=\"C命名空间\"></a>C命名空间</h3><p>首先引入规范</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xmlns:c=\"http://www.springframework.org/schema/c\"</span><br></pre></td></tr></table></figure>\n\n<p>其实就对应构造器注入，只不过简化了，使用<code>c:</code>.</p>\n<p>使用有参构造。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"addressPlus\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.Address\"</span> <span class=\"attr\">c:city</span>=<span class=\"string\">\"Nanjing\"</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n"},{"title":"SpringIOC - Start","_content":"\n# IOC的本质\n\n![image-20210201102417224](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102417224.png)\n\n![image-20210201102430827](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102430827.png)\n\n![image-20210201102454419](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102454419.png)\n\n# IOC创建对象的方式\n\n使用配置文件设置变量的值。将类注册为 `Bean`，通过`ApplicationContext`获取上下文。再用上下文取出`Bean`。\n\n\n\n## 变量赋值\n\n简单的通过Setter方法赋值。\n\n1. 直接赋值\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n\t\t<property name=\"username\" value=\"this is username\"/>\n</bean>\n```\n\n2. 引用\n\n```xml\n<bean id=\"userService\" class=\"com.edlison.design.spring.ioc.service.UserService\">\n        <property name=\"userDAO\" ref=\"user\"/>\n</bean>\n```\n\n## 创建对象\n\n默认是无参构造。如果有构造函数，则有以下三种构造方式。\n\n1. 通过下标构造\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n        <constructor-arg index=\"0\" value=\"this is username by constructor\"/>\n</bean>\n```\n\n2. 通过类型构造\n3.  直接通过参数名\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n        <constructor-arg name=\"username\" value=\"this is username by constructor\"/>\n</bean>\n```\n\n# 总结\n\n在配置文件加载的时候，容器里的实例就已经被创建了，并且内存中**仅有一个实例**。\n\n","source":"_posts/spring/ioc-start.md","raw":"---\ntitle: SpringIOC - Start\ncategories:\n- Notebook\ntags:\n- java\n- spring\n- ioc\n---\n\n# IOC的本质\n\n![image-20210201102417224](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102417224.png)\n\n![image-20210201102430827](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102430827.png)\n\n![image-20210201102454419](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102454419.png)\n\n# IOC创建对象的方式\n\n使用配置文件设置变量的值。将类注册为 `Bean`，通过`ApplicationContext`获取上下文。再用上下文取出`Bean`。\n\n\n\n## 变量赋值\n\n简单的通过Setter方法赋值。\n\n1. 直接赋值\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n\t\t<property name=\"username\" value=\"this is username\"/>\n</bean>\n```\n\n2. 引用\n\n```xml\n<bean id=\"userService\" class=\"com.edlison.design.spring.ioc.service.UserService\">\n        <property name=\"userDAO\" ref=\"user\"/>\n</bean>\n```\n\n## 创建对象\n\n默认是无参构造。如果有构造函数，则有以下三种构造方式。\n\n1. 通过下标构造\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n        <constructor-arg index=\"0\" value=\"this is username by constructor\"/>\n</bean>\n```\n\n2. 通过类型构造\n3.  直接通过参数名\n\n```xml\n<bean id=\"user\" class=\"com.edlison.design.spring.ioc.pojo.UserDAO\">\n        <constructor-arg name=\"username\" value=\"this is username by constructor\"/>\n</bean>\n```\n\n# 总结\n\n在配置文件加载的时候，容器里的实例就已经被创建了，并且内存中**仅有一个实例**。\n\n","slug":"spring/ioc-start","published":1,"date":"2021-02-01T01:30:45.643Z","updated":"2021-02-01T05:40:02.433Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982v00ep018oepfahz7s","content":"<h1 id=\"IOC的本质\"><a href=\"#IOC的本质\" class=\"headerlink\" title=\"IOC的本质\"></a>IOC的本质</h1><p>![image-20210201102417224](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102417224.png)</p>\n<p>![image-20210201102430827](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102430827.png)</p>\n<p>![image-20210201102454419](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102454419.png)</p>\n<h1 id=\"IOC创建对象的方式\"><a href=\"#IOC创建对象的方式\" class=\"headerlink\" title=\"IOC创建对象的方式\"></a>IOC创建对象的方式</h1><p>使用配置文件设置变量的值。将类注册为 <code>Bean</code>，通过<code>ApplicationContext</code>获取上下文。再用上下文取出<code>Bean</code>。</p>\n<h2 id=\"变量赋值\"><a href=\"#变量赋值\" class=\"headerlink\" title=\"变量赋值\"></a>变量赋值</h2><p>简单的通过Setter方法赋值。</p>\n<ol>\n<li>直接赋值</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>引用</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userService\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.service.UserService\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userDAO\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"user\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建对象\"><a href=\"#创建对象\" class=\"headerlink\" title=\"创建对象\"></a>创建对象</h2><p>默认是无参构造。如果有构造函数，则有以下三种构造方式。</p>\n<ol>\n<li>通过下标构造</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">index</span>=<span class=\"string\">\"0\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username by constructor\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>通过类型构造</li>\n<li>直接通过参数名</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username by constructor\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>在配置文件加载的时候，容器里的实例就已经被创建了，并且内存中<strong>仅有一个实例</strong>。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"IOC的本质\"><a href=\"#IOC的本质\" class=\"headerlink\" title=\"IOC的本质\"></a>IOC的本质</h1><p>![image-20210201102417224](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102417224.png)</p>\n<p>![image-20210201102430827](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102430827.png)</p>\n<p>![image-20210201102454419](/Users/edlison/Library/Application Support/typora-user-images/image-20210201102454419.png)</p>\n<h1 id=\"IOC创建对象的方式\"><a href=\"#IOC创建对象的方式\" class=\"headerlink\" title=\"IOC创建对象的方式\"></a>IOC创建对象的方式</h1><p>使用配置文件设置变量的值。将类注册为 <code>Bean</code>，通过<code>ApplicationContext</code>获取上下文。再用上下文取出<code>Bean</code>。</p>\n<h2 id=\"变量赋值\"><a href=\"#变量赋值\" class=\"headerlink\" title=\"变量赋值\"></a>变量赋值</h2><p>简单的通过Setter方法赋值。</p>\n<ol>\n<li>直接赋值</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>引用</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"userService\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.service.UserService\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userDAO\"</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"user\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建对象\"><a href=\"#创建对象\" class=\"headerlink\" title=\"创建对象\"></a>创建对象</h2><p>默认是无参构造。如果有构造函数，则有以下三种构造方式。</p>\n<ol>\n<li>通过下标构造</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">index</span>=<span class=\"string\">\"0\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username by constructor\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>通过类型构造</li>\n<li>直接通过参数名</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.edlison.design.spring.ioc.pojo.UserDAO\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"this is username by constructor\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>在配置文件加载的时候，容器里的实例就已经被创建了，并且内存中<strong>仅有一个实例</strong>。</p>\n"},{"title":"Dead Poets Society","_content":"\n> But poetry, beauty, romance, love... these are what we stay alive for.\n\n*但是，诗歌，美，浪漫，爱。这些是我们活着的意义。*\n\n> Most men lead lives of quiet desperation.\n\n*大多数人，都生活在平静的绝望中。*\n\n> To quote from Whitman, \"O me, O life of the questions of these recurring. Of the endless trains of the faithless. Of cities filled with the foolish. What good amid these, O me, O life? Answer: That you are here. That life exists and identity. That the powerful play goes on and you may contribute a verse. That the powerful play goes on, and you can contrubute a verse.\" What will your verse be?\n\n*惠特曼写道：“自我？生命？这些问题总在不停出现。毫无信仰的人川流不息。城市充斥着愚昧。生活其中有什么意义？自我？生命？答案：因为你在这里。因为生命存在并各有特性。因为伟大的戏剧在继续，并且你可以奉献一段。因为伟大的戏剧在继续，并且你可以奉献一段。你的段落会是什么样？”*\n\n\n\n\n\n\n\n于2021.1.30 0:55:30 与章章 她在家里我在南京宿舍\n\n","source":"_posts/poets/deadpoetssociety.md","raw":"---\ntitle: Dead Poets Society\ncategories:\n- Poets\ntags:\n- deadpoetssociety\n---\n\n> But poetry, beauty, romance, love... these are what we stay alive for.\n\n*但是，诗歌，美，浪漫，爱。这些是我们活着的意义。*\n\n> Most men lead lives of quiet desperation.\n\n*大多数人，都生活在平静的绝望中。*\n\n> To quote from Whitman, \"O me, O life of the questions of these recurring. Of the endless trains of the faithless. Of cities filled with the foolish. What good amid these, O me, O life? Answer: That you are here. That life exists and identity. That the powerful play goes on and you may contribute a verse. That the powerful play goes on, and you can contrubute a verse.\" What will your verse be?\n\n*惠特曼写道：“自我？生命？这些问题总在不停出现。毫无信仰的人川流不息。城市充斥着愚昧。生活其中有什么意义？自我？生命？答案：因为你在这里。因为生命存在并各有特性。因为伟大的戏剧在继续，并且你可以奉献一段。因为伟大的戏剧在继续，并且你可以奉献一段。你的段落会是什么样？”*\n\n\n\n\n\n\n\n于2021.1.30 0:55:30 与章章 她在家里我在南京宿舍\n\n","slug":"poets/deadpoetssociety","published":1,"date":"2021-01-29T16:36:52.959Z","updated":"2021-01-29T17:24:40.984Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982w00es018octkahtpm","content":"<blockquote>\n<p>But poetry, beauty, romance, love… these are what we stay alive for.</p>\n</blockquote>\n<p><em>但是，诗歌，美，浪漫，爱。这些是我们活着的意义。</em></p>\n<blockquote>\n<p>Most men lead lives of quiet desperation.</p>\n</blockquote>\n<p><em>大多数人，都生活在平静的绝望中。</em></p>\n<blockquote>\n<p>To quote from Whitman, “O me, O life of the questions of these recurring. Of the endless trains of the faithless. Of cities filled with the foolish. What good amid these, O me, O life? Answer: That you are here. That life exists and identity. That the powerful play goes on and you may contribute a verse. That the powerful play goes on, and you can contrubute a verse.” What will your verse be?</p>\n</blockquote>\n<p><em>惠特曼写道：“自我？生命？这些问题总在不停出现。毫无信仰的人川流不息。城市充斥着愚昧。生活其中有什么意义？自我？生命？答案：因为你在这里。因为生命存在并各有特性。因为伟大的戏剧在继续，并且你可以奉献一段。因为伟大的戏剧在继续，并且你可以奉献一段。你的段落会是什么样？”</em></p>\n<p>于2021.1.30 0:55:30 与章章 她在家里我在南京宿舍</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>But poetry, beauty, romance, love… these are what we stay alive for.</p>\n</blockquote>\n<p><em>但是，诗歌，美，浪漫，爱。这些是我们活着的意义。</em></p>\n<blockquote>\n<p>Most men lead lives of quiet desperation.</p>\n</blockquote>\n<p><em>大多数人，都生活在平静的绝望中。</em></p>\n<blockquote>\n<p>To quote from Whitman, “O me, O life of the questions of these recurring. Of the endless trains of the faithless. Of cities filled with the foolish. What good amid these, O me, O life? Answer: That you are here. That life exists and identity. That the powerful play goes on and you may contribute a verse. That the powerful play goes on, and you can contrubute a verse.” What will your verse be?</p>\n</blockquote>\n<p><em>惠特曼写道：“自我？生命？这些问题总在不停出现。毫无信仰的人川流不息。城市充斥着愚昧。生活其中有什么意义？自我？生命？答案：因为你在这里。因为生命存在并各有特性。因为伟大的戏剧在继续，并且你可以奉献一段。因为伟大的戏剧在继续，并且你可以奉献一段。你的段落会是什么样？”</em></p>\n<p>于2021.1.30 0:55:30 与章章 她在家里我在南京宿舍</p>\n"},{"title":"口语中gonna, wanna, gotta","catagories":["TOEFL"],"_content":"\n# 介绍\n\n口语中会出现吞音(contraction)的情况。\n\n这些单词也就是非正式缩略语。\n\n# gonna\n\n= going to 将要\n\ngonna 也就是 going to的简化说法，在使用前需要加上be。\n\n## 例句\n\n> Nothing's gonna change my love for you.\n\n# gotta\n\n= got to / have got a 不得不，必须做\n\n## 例句\n\n> Have they gotta work?\n\n# wanna\n\n= want to 想要\n\n## 例句\n\n> I wanna learn TOEFL.\n\n# dunno\n\n = don't know 不知道\n\n## 例句\n\n> I dunno\n\n# 其它\n\nkinda = kink of 有点儿\n\noutta = out of 从...出去 I'm outta here.\n\nhafta = have to 不得不\n\nletcha = let you 让你\n\ngotcha = got you 明白你的意思\n\nwhatcha = what are you\n\nain't = am not/ is not/ are not 不是\n\ngimme = give me 给我\n\nlemme = let me 让我\n\nya = you 你 see ya\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/82478569","source":"_posts/toefl/toefl-gona.md","raw":"---\ntitle: 口语中gonna, wanna, gotta\ncatagories:\n- TOEFL\ntags:\n- speaking\n---\n\n# 介绍\n\n口语中会出现吞音(contraction)的情况。\n\n这些单词也就是非正式缩略语。\n\n# gonna\n\n= going to 将要\n\ngonna 也就是 going to的简化说法，在使用前需要加上be。\n\n## 例句\n\n> Nothing's gonna change my love for you.\n\n# gotta\n\n= got to / have got a 不得不，必须做\n\n## 例句\n\n> Have they gotta work?\n\n# wanna\n\n= want to 想要\n\n## 例句\n\n> I wanna learn TOEFL.\n\n# dunno\n\n = don't know 不知道\n\n## 例句\n\n> I dunno\n\n# 其它\n\nkinda = kink of 有点儿\n\noutta = out of 从...出去 I'm outta here.\n\nhafta = have to 不得不\n\nletcha = let you 让你\n\ngotcha = got you 明白你的意思\n\nwhatcha = what are you\n\nain't = am not/ is not/ are not 不是\n\ngimme = give me 给我\n\nlemme = let me 让我\n\nya = you 你 see ya\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhuanlan.zhihu.com/p/82478569","slug":"toefl/toefl-gona","published":1,"date":"2021-03-13T10:32:54.100Z","updated":"2021-03-13T10:49:36.472Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982y00ew018o09fxhj0c","content":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>口语中会出现吞音(contraction)的情况。</p>\n<p>这些单词也就是非正式缩略语。</p>\n<h1 id=\"gonna\"><a href=\"#gonna\" class=\"headerlink\" title=\"gonna\"></a>gonna</h1><p>= going to 将要</p>\n<p>gonna 也就是 going to的简化说法，在使用前需要加上be。</p>\n<h2 id=\"例句\"><a href=\"#例句\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>Nothing’s gonna change my love for you.</p>\n</blockquote>\n<h1 id=\"gotta\"><a href=\"#gotta\" class=\"headerlink\" title=\"gotta\"></a>gotta</h1><p>= got to / have got a 不得不，必须做</p>\n<h2 id=\"例句-1\"><a href=\"#例句-1\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>Have they gotta work?</p>\n</blockquote>\n<h1 id=\"wanna\"><a href=\"#wanna\" class=\"headerlink\" title=\"wanna\"></a>wanna</h1><p>= want to 想要</p>\n<h2 id=\"例句-2\"><a href=\"#例句-2\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>I wanna learn TOEFL.</p>\n</blockquote>\n<h1 id=\"dunno\"><a href=\"#dunno\" class=\"headerlink\" title=\"dunno\"></a>dunno</h1><p> = don’t know 不知道</p>\n<h2 id=\"例句-3\"><a href=\"#例句-3\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>I dunno</p>\n</blockquote>\n<h1 id=\"其它\"><a href=\"#其它\" class=\"headerlink\" title=\"其它\"></a>其它</h1><p>kinda = kink of 有点儿</p>\n<p>outta = out of 从…出去 I’m outta here.</p>\n<p>hafta = have to 不得不</p>\n<p>letcha = let you 让你</p>\n<p>gotcha = got you 明白你的意思</p>\n<p>whatcha = what are you</p>\n<p>ain’t = am not/ is not/ are not 不是</p>\n<p>gimme = give me 给我</p>\n<p>lemme = let me 让我</p>\n<p>ya = you 你 see ya</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84MjQ3ODU2OQ==\">https://zhuanlan.zhihu.com/p/82478569<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h1><p>口语中会出现吞音(contraction)的情况。</p>\n<p>这些单词也就是非正式缩略语。</p>\n<h1 id=\"gonna\"><a href=\"#gonna\" class=\"headerlink\" title=\"gonna\"></a>gonna</h1><p>= going to 将要</p>\n<p>gonna 也就是 going to的简化说法，在使用前需要加上be。</p>\n<h2 id=\"例句\"><a href=\"#例句\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>Nothing’s gonna change my love for you.</p>\n</blockquote>\n<h1 id=\"gotta\"><a href=\"#gotta\" class=\"headerlink\" title=\"gotta\"></a>gotta</h1><p>= got to / have got a 不得不，必须做</p>\n<h2 id=\"例句-1\"><a href=\"#例句-1\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>Have they gotta work?</p>\n</blockquote>\n<h1 id=\"wanna\"><a href=\"#wanna\" class=\"headerlink\" title=\"wanna\"></a>wanna</h1><p>= want to 想要</p>\n<h2 id=\"例句-2\"><a href=\"#例句-2\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>I wanna learn TOEFL.</p>\n</blockquote>\n<h1 id=\"dunno\"><a href=\"#dunno\" class=\"headerlink\" title=\"dunno\"></a>dunno</h1><p> = don’t know 不知道</p>\n<h2 id=\"例句-3\"><a href=\"#例句-3\" class=\"headerlink\" title=\"例句\"></a>例句</h2><blockquote>\n<p>I dunno</p>\n</blockquote>\n<h1 id=\"其它\"><a href=\"#其它\" class=\"headerlink\" title=\"其它\"></a>其它</h1><p>kinda = kink of 有点儿</p>\n<p>outta = out of 从…出去 I’m outta here.</p>\n<p>hafta = have to 不得不</p>\n<p>letcha = let you 让你</p>\n<p>gotcha = got you 明白你的意思</p>\n<p>whatcha = what are you</p>\n<p>ain’t = am not/ is not/ are not 不是</p>\n<p>gimme = give me 给我</p>\n<p>lemme = let me 让我</p>\n<p>ya = you 你 see ya</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84MjQ3ODU2OQ==\">https://zhuanlan.zhihu.com/p/82478569<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"TOEFL听力 Biology词汇","catagories":["TOEFL"],"_content":"\n# Biology\n\nPlant Vegetation Flora 植物\n\nOak 橡树 橡木家具\n\nPine 松树\n\nMaple 枫树\n\nBirch 桦树\n\nAspen 杨树\n\nWillow 柳树\n\nPalm 棕榈树\n\nElm 榆树\n\nSapling 树苗\n\nBud Sprout 芽\n\nGerminate Sprout 发芽\n\nLeaves\n\nStem 茎\n\nVine 藤\n\nBranch 树枝\n\nTwig 小树枝\n\nLimb 大树枝\n\nTrunk 树干\n\nBark 树皮\n\nWood Log Timber Lumber 木材\n\nRing 年轮\n\nResin 树脂\n\nStump 树桩\n\nChlorophyll 叶绿素\n\nPhoto synthesis 光合作用\n\nBush Shrub 灌木\n\nFern 蕨类植物\n\nFungi Fungus 真菌\n\nMushroom 蘑菇\n\nGrass Weed Herb Straw 草\n\nCluster 花丛\n\nBundle 花束\n\nRose 玫瑰\n\nLily 百合\n\nJasmine 茉莉\n\nTulip 郁金香\n\nViolet 紫罗兰\n\nLotus 荷花\n\nChrysanthemum 菊花\n\nBud Bulb 花苞\n\nBloom Blossom 开花\n\nPetal 花瓣\n\nStamen Pistil 雄蕊 雌蕊\n\nPollen 花粉\n\nPollinate 传粉\n\nNectar Honey 蜜\n\nFruit 果实\n\nPeel 果皮\n\nSeed 种子\n\nHusk 种皮\n\n","source":"_posts/toefl/toefl-l-bio-word.md","raw":"---\ntitle: TOEFL听力 Biology词汇\ncatagories:\n- TOEFL\n---\n\n# Biology\n\nPlant Vegetation Flora 植物\n\nOak 橡树 橡木家具\n\nPine 松树\n\nMaple 枫树\n\nBirch 桦树\n\nAspen 杨树\n\nWillow 柳树\n\nPalm 棕榈树\n\nElm 榆树\n\nSapling 树苗\n\nBud Sprout 芽\n\nGerminate Sprout 发芽\n\nLeaves\n\nStem 茎\n\nVine 藤\n\nBranch 树枝\n\nTwig 小树枝\n\nLimb 大树枝\n\nTrunk 树干\n\nBark 树皮\n\nWood Log Timber Lumber 木材\n\nRing 年轮\n\nResin 树脂\n\nStump 树桩\n\nChlorophyll 叶绿素\n\nPhoto synthesis 光合作用\n\nBush Shrub 灌木\n\nFern 蕨类植物\n\nFungi Fungus 真菌\n\nMushroom 蘑菇\n\nGrass Weed Herb Straw 草\n\nCluster 花丛\n\nBundle 花束\n\nRose 玫瑰\n\nLily 百合\n\nJasmine 茉莉\n\nTulip 郁金香\n\nViolet 紫罗兰\n\nLotus 荷花\n\nChrysanthemum 菊花\n\nBud Bulb 花苞\n\nBloom Blossom 开花\n\nPetal 花瓣\n\nStamen Pistil 雄蕊 雌蕊\n\nPollen 花粉\n\nPollinate 传粉\n\nNectar Honey 蜜\n\nFruit 果实\n\nPeel 果皮\n\nSeed 种子\n\nHusk 种皮\n\n","slug":"toefl/toefl-l-bio-word","published":1,"date":"2021-03-13T09:27:26.520Z","updated":"2021-03-13T10:30:59.872Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx982z00f0018o7jz7h6qj","content":"<h1 id=\"Biology\"><a href=\"#Biology\" class=\"headerlink\" title=\"Biology\"></a>Biology</h1><p>Plant Vegetation Flora 植物</p>\n<p>Oak 橡树 橡木家具</p>\n<p>Pine 松树</p>\n<p>Maple 枫树</p>\n<p>Birch 桦树</p>\n<p>Aspen 杨树</p>\n<p>Willow 柳树</p>\n<p>Palm 棕榈树</p>\n<p>Elm 榆树</p>\n<p>Sapling 树苗</p>\n<p>Bud Sprout 芽</p>\n<p>Germinate Sprout 发芽</p>\n<p>Leaves</p>\n<p>Stem 茎</p>\n<p>Vine 藤</p>\n<p>Branch 树枝</p>\n<p>Twig 小树枝</p>\n<p>Limb 大树枝</p>\n<p>Trunk 树干</p>\n<p>Bark 树皮</p>\n<p>Wood Log Timber Lumber 木材</p>\n<p>Ring 年轮</p>\n<p>Resin 树脂</p>\n<p>Stump 树桩</p>\n<p>Chlorophyll 叶绿素</p>\n<p>Photo synthesis 光合作用</p>\n<p>Bush Shrub 灌木</p>\n<p>Fern 蕨类植物</p>\n<p>Fungi Fungus 真菌</p>\n<p>Mushroom 蘑菇</p>\n<p>Grass Weed Herb Straw 草</p>\n<p>Cluster 花丛</p>\n<p>Bundle 花束</p>\n<p>Rose 玫瑰</p>\n<p>Lily 百合</p>\n<p>Jasmine 茉莉</p>\n<p>Tulip 郁金香</p>\n<p>Violet 紫罗兰</p>\n<p>Lotus 荷花</p>\n<p>Chrysanthemum 菊花</p>\n<p>Bud Bulb 花苞</p>\n<p>Bloom Blossom 开花</p>\n<p>Petal 花瓣</p>\n<p>Stamen Pistil 雄蕊 雌蕊</p>\n<p>Pollen 花粉</p>\n<p>Pollinate 传粉</p>\n<p>Nectar Honey 蜜</p>\n<p>Fruit 果实</p>\n<p>Peel 果皮</p>\n<p>Seed 种子</p>\n<p>Husk 种皮</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Biology\"><a href=\"#Biology\" class=\"headerlink\" title=\"Biology\"></a>Biology</h1><p>Plant Vegetation Flora 植物</p>\n<p>Oak 橡树 橡木家具</p>\n<p>Pine 松树</p>\n<p>Maple 枫树</p>\n<p>Birch 桦树</p>\n<p>Aspen 杨树</p>\n<p>Willow 柳树</p>\n<p>Palm 棕榈树</p>\n<p>Elm 榆树</p>\n<p>Sapling 树苗</p>\n<p>Bud Sprout 芽</p>\n<p>Germinate Sprout 发芽</p>\n<p>Leaves</p>\n<p>Stem 茎</p>\n<p>Vine 藤</p>\n<p>Branch 树枝</p>\n<p>Twig 小树枝</p>\n<p>Limb 大树枝</p>\n<p>Trunk 树干</p>\n<p>Bark 树皮</p>\n<p>Wood Log Timber Lumber 木材</p>\n<p>Ring 年轮</p>\n<p>Resin 树脂</p>\n<p>Stump 树桩</p>\n<p>Chlorophyll 叶绿素</p>\n<p>Photo synthesis 光合作用</p>\n<p>Bush Shrub 灌木</p>\n<p>Fern 蕨类植物</p>\n<p>Fungi Fungus 真菌</p>\n<p>Mushroom 蘑菇</p>\n<p>Grass Weed Herb Straw 草</p>\n<p>Cluster 花丛</p>\n<p>Bundle 花束</p>\n<p>Rose 玫瑰</p>\n<p>Lily 百合</p>\n<p>Jasmine 茉莉</p>\n<p>Tulip 郁金香</p>\n<p>Violet 紫罗兰</p>\n<p>Lotus 荷花</p>\n<p>Chrysanthemum 菊花</p>\n<p>Bud Bulb 花苞</p>\n<p>Bloom Blossom 开花</p>\n<p>Petal 花瓣</p>\n<p>Stamen Pistil 雄蕊 雌蕊</p>\n<p>Pollen 花粉</p>\n<p>Pollinate 传粉</p>\n<p>Nectar Honey 蜜</p>\n<p>Fruit 果实</p>\n<p>Peel 果皮</p>\n<p>Seed 种子</p>\n<p>Husk 种皮</p>\n"},{"title":"TOEFL - 句子和连词的关系","catagories":["TOEFL"],"_content":"\n# 英语中句子与连词的关系\n\n不能有because... so... 的情况出现\n\n**本质是** 句子个数 >= 连词个数 + 1\n\n","source":"_posts/toefl/toefl-conn.md","raw":"---\ntitle: TOEFL - 句子和连词的关系\ncatagories:\n- TOEFL\n---\n\n# 英语中句子与连词的关系\n\n不能有because... so... 的情况出现\n\n**本质是** 句子个数 >= 连词个数 + 1\n\n","slug":"toefl/toefl-conn","published":1,"date":"2021-04-15T13:51:47.883Z","updated":"2021-04-15T13:53:31.097Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983000f4018o5qrkevyw","content":"<h1 id=\"英语中句子与连词的关系\"><a href=\"#英语中句子与连词的关系\" class=\"headerlink\" title=\"英语中句子与连词的关系\"></a>英语中句子与连词的关系</h1><p>不能有because… so… 的情况出现</p>\n<p><strong>本质是</strong> 句子个数 &gt;= 连词个数 + 1</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"英语中句子与连词的关系\"><a href=\"#英语中句子与连词的关系\" class=\"headerlink\" title=\"英语中句子与连词的关系\"></a>英语中句子与连词的关系</h1><p>不能有because… so… 的情况出现</p>\n<p><strong>本质是</strong> 句子个数 &gt;= 连词个数 + 1</p>\n"},{"title":"连读现象","catagories":["TOEFL"],"_content":"\n","source":"_posts/toefl/word-conn.md","raw":"---\ntitle: 连读现象\ncatagories:\n- TOEFL\n---\n\n","slug":"toefl/word-conn","published":1,"date":"2021-02-26T14:05:12.466Z","updated":"2021-02-26T14:06:09.975Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983100f7018oeuoc8szh","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"TOEFL - 学校 学生 的英文","catagories":["TOEFL"],"_content":"\n# 学校\n\nnursery - 托儿所\n\nkindergarten - 幼儿园\n\nelementary / primary school - 小学\n\nsecondary / middle school - 中学（初中 + 高中）\n\njunior / junior middle schoole - 初中\n\nsenior / senior middle / high school - 高中\n\ncollege - 学院\n\nuniversity - 大学\n\n# 学生\n\nfreshman - 大一\n\nsophomore - 大二\n\njunior - 大三\n\nsenior - 大四\n\nundergraduate - 本科生\n\ngraduate / bachelor - 学士（本科毕业）\n\npostgraduate - 硕士生\n\nmaster - 硕士（硕士毕业）\n\ndoctoral student / doctoral candidate - 博士生\n\ndoctor - 博士（博士毕业）\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?type=content&q=%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%9A%84%E8%8B%B1%E8%AF%AD%E8%A1%A8%E7%A4%BA","source":"_posts/toefl/toefl-school.md","raw":"---\ntitle: TOEFL - 学校 学生 的英文\ncatagories:\n- TOEFL\n---\n\n# 学校\n\nnursery - 托儿所\n\nkindergarten - 幼儿园\n\nelementary / primary school - 小学\n\nsecondary / middle school - 中学（初中 + 高中）\n\njunior / junior middle schoole - 初中\n\nsenior / senior middle / high school - 高中\n\ncollege - 学院\n\nuniversity - 大学\n\n# 学生\n\nfreshman - 大一\n\nsophomore - 大二\n\njunior - 大三\n\nsenior - 大四\n\nundergraduate - 本科生\n\ngraduate / bachelor - 学士（本科毕业）\n\npostgraduate - 硕士生\n\nmaster - 硕士（硕士毕业）\n\ndoctoral student / doctoral candidate - 博士生\n\ndoctor - 博士（博士毕业）\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.zhihu.com/search?type=content&q=%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%9A%84%E8%8B%B1%E8%AF%AD%E8%A1%A8%E7%A4%BA","slug":"toefl/toefl-school","published":1,"date":"2021-04-14T02:17:37.558Z","updated":"2021-04-14T02:23:30.445Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983200fb018o7kvkc87e","content":"<h1 id=\"学校\"><a href=\"#学校\" class=\"headerlink\" title=\"学校\"></a>学校</h1><p>nursery - 托儿所</p>\n<p>kindergarten - 幼儿园</p>\n<p>elementary / primary school - 小学</p>\n<p>secondary / middle school - 中学（初中 + 高中）</p>\n<p>junior / junior middle schoole - 初中</p>\n<p>senior / senior middle / high school - 高中</p>\n<p>college - 学院</p>\n<p>university - 大学</p>\n<h1 id=\"学生\"><a href=\"#学生\" class=\"headerlink\" title=\"学生\"></a>学生</h1><p>freshman - 大一</p>\n<p>sophomore - 大二</p>\n<p>junior - 大三</p>\n<p>senior - 大四</p>\n<p>undergraduate - 本科生</p>\n<p>graduate / bachelor - 学士（本科毕业）</p>\n<p>postgraduate - 硕士生</p>\n<p>master - 硕士（硕士毕业）</p>\n<p>doctoral student / doctoral candidate - 博士生</p>\n<p>doctor - 博士（博士毕业）</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD90eXBlPWNvbnRlbnQmYW1wO3E9JUU1JUE0JUE3JUU1JUFEJUE2JUU3JTk0JTlGJUU3JTlBJTg0JUU4JThCJUIxJUU4JUFGJUFEJUU4JUExJUE4JUU3JUE0JUJB\">https://www.zhihu.com/search?type=content&amp;q=%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%9A%84%E8%8B%B1%E8%AF%AD%E8%A1%A8%E7%A4%BA<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"学校\"><a href=\"#学校\" class=\"headerlink\" title=\"学校\"></a>学校</h1><p>nursery - 托儿所</p>\n<p>kindergarten - 幼儿园</p>\n<p>elementary / primary school - 小学</p>\n<p>secondary / middle school - 中学（初中 + 高中）</p>\n<p>junior / junior middle schoole - 初中</p>\n<p>senior / senior middle / high school - 高中</p>\n<p>college - 学院</p>\n<p>university - 大学</p>\n<h1 id=\"学生\"><a href=\"#学生\" class=\"headerlink\" title=\"学生\"></a>学生</h1><p>freshman - 大一</p>\n<p>sophomore - 大二</p>\n<p>junior - 大三</p>\n<p>senior - 大四</p>\n<p>undergraduate - 本科生</p>\n<p>graduate / bachelor - 学士（本科毕业）</p>\n<p>postgraduate - 硕士生</p>\n<p>master - 硕士（硕士毕业）</p>\n<p>doctoral student / doctoral candidate - 博士生</p>\n<p>doctor - 博士（博士毕业）</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD90eXBlPWNvbnRlbnQmYW1wO3E9JUU1JUE0JUE3JUU1JUFEJUE2JUU3JTk0JTlGJUU3JTlBJTg0JUU4JThCJUIxJUU4JUFGJUFEJUU4JUExJUE4JUU3JUE0JUJB\">https://www.zhihu.com/search?type=content&amp;q=%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%9A%84%E8%8B%B1%E8%AF%AD%E8%A1%A8%E7%A4%BA<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"TOEFL - 社会主义核心价值观","catagories":["TOEFL"],"_content":"\n# 社会主义核心价值观英文\n\nProsperity Democracy Civility Harmony\n\nFreedom Equality Justice Rule-of-Law\n\nPatriotism Dedication Integrity Friendship\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhidao.baidu.com/question/1819212565350596828.html","source":"_posts/toefl/toefl-socialmetavalue.md","raw":"---\ntitle: TOEFL - 社会主义核心价值观\ncatagories:\n- TOEFL\n---\n\n# 社会主义核心价值观英文\n\nProsperity Democracy Civility Harmony\n\nFreedom Equality Justice Rule-of-Law\n\nPatriotism Dedication Integrity Friendship\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://zhidao.baidu.com/question/1819212565350596828.html","slug":"toefl/toefl-socialmetavalue","published":1,"date":"2021-04-15T00:49:46.617Z","updated":"2021-10-15T19:22:48.102Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983400fe018odvfg98du","content":"<h1 id=\"社会主义核心价值观英文\"><a href=\"#社会主义核心价值观英文\" class=\"headerlink\" title=\"社会主义核心价值观英文\"></a>社会主义核心价值观英文</h1><p>Prosperity Democracy Civility Harmony</p>\n<p>Freedom Equality Justice Rule-of-Law</p>\n<p>Patriotism Dedication Integrity Friendship</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aGlkYW8uYmFpZHUuY29tL3F1ZXN0aW9uLzE4MTkyMTI1NjUzNTA1OTY4MjguaHRtbA==\">https://zhidao.baidu.com/question/1819212565350596828.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"社会主义核心价值观英文\"><a href=\"#社会主义核心价值观英文\" class=\"headerlink\" title=\"社会主义核心价值观英文\"></a>社会主义核心价值观英文</h1><p>Prosperity Democracy Civility Harmony</p>\n<p>Freedom Equality Justice Rule-of-Law</p>\n<p>Patriotism Dedication Integrity Friendship</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aGlkYW8uYmFpZHUuY29tL3F1ZXN0aW9uLzE4MTkyMTI1NjUzNTA1OTY4MjguaHRtbA==\">https://zhidao.baidu.com/question/1819212565350596828.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Vim配置","_content":"\n# Vim配置文件\n\nVim有两个配置文件\n\n- /etc/vim/vimrc\n- ~/.vimrc\n\n第一个全局有效，第二个针对当前用户有效。\n\n# Vim插件\n\n## Vundle插件管理插件\n\n下载到~/.vim/bundle/Vundle.vim\n\n```sh\ngit clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim\n```\n\n### 配置文件\n\n```\nset nocompatible              \" be iMproved, required\nfiletype off                  \" required\nset rtp+=~/.vim/bundle/Vundle.vim\ncall vundle#begin()\nPlugin 'VundleVim/Vundle.vim', {'rtp': 'vim/'} \" 指定用户/仓库. 还可以指定run_time_path到仓库的子目录\nPlugin 'http://github.com/xxx/xxx.git', {'name': 'nerdtree'} \" 指定仓库url, 还可以指定名字\nPlugin 'file:///home/xxx/xxx' \" 指定本地插件\n\" ...\ncall vundle#end()            \" required\nfiletype plugin indent on    \" required\n```\n\n### 安装插件\n\n`:PluginInstall`\n\n### 删除插件\n\n`:PluginClean`\n\n或在配置文件下注释掉\n\n\n\n\n\n\n\n----\n\nhttps://www.cnblogs.com/zhaodehua/articles/14174336.html\n\nhttps://blog.csdn.net/weixin_38815998/article/details/103589090\n\n","source":"_posts/vim/vim-config.md","raw":"---\ntitle: Vim配置\ncategories: \n- Vim\ntags: \n- vim\n- config\n- linux\n---\n\n# Vim配置文件\n\nVim有两个配置文件\n\n- /etc/vim/vimrc\n- ~/.vimrc\n\n第一个全局有效，第二个针对当前用户有效。\n\n# Vim插件\n\n## Vundle插件管理插件\n\n下载到~/.vim/bundle/Vundle.vim\n\n```sh\ngit clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim\n```\n\n### 配置文件\n\n```\nset nocompatible              \" be iMproved, required\nfiletype off                  \" required\nset rtp+=~/.vim/bundle/Vundle.vim\ncall vundle#begin()\nPlugin 'VundleVim/Vundle.vim', {'rtp': 'vim/'} \" 指定用户/仓库. 还可以指定run_time_path到仓库的子目录\nPlugin 'http://github.com/xxx/xxx.git', {'name': 'nerdtree'} \" 指定仓库url, 还可以指定名字\nPlugin 'file:///home/xxx/xxx' \" 指定本地插件\n\" ...\ncall vundle#end()            \" required\nfiletype plugin indent on    \" required\n```\n\n### 安装插件\n\n`:PluginInstall`\n\n### 删除插件\n\n`:PluginClean`\n\n或在配置文件下注释掉\n\n\n\n\n\n\n\n----\n\nhttps://www.cnblogs.com/zhaodehua/articles/14174336.html\n\nhttps://blog.csdn.net/weixin_38815998/article/details/103589090\n\n","slug":"vim/vim-config","published":1,"date":"2021-05-27T03:57:03.000Z","updated":"2021-07-24T11:08:32.305Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983500fi018o5h04cc75","content":"<h1 id=\"Vim配置文件\"><a href=\"#Vim配置文件\" class=\"headerlink\" title=\"Vim配置文件\"></a>Vim配置文件</h1><p>Vim有两个配置文件</p>\n<ul>\n<li>/etc/vim/vimrc</li>\n<li>~/.vimrc</li>\n</ul>\n<p>第一个全局有效，第二个针对当前用户有效。</p>\n<h1 id=\"Vim插件\"><a href=\"#Vim插件\" class=\"headerlink\" title=\"Vim插件\"></a>Vim插件</h1><h2 id=\"Vundle插件管理插件\"><a href=\"#Vundle插件管理插件\" class=\"headerlink\" title=\"Vundle插件管理插件\"></a>Vundle插件管理插件</h2><p>下载到~/.vim/bundle/Vundle.vim</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set nocompatible              &quot; be iMproved, required</span><br><span class=\"line\">filetype off                  &quot; required</span><br><span class=\"line\">set rtp+&#x3D;~&#x2F;.vim&#x2F;bundle&#x2F;Vundle.vim</span><br><span class=\"line\">call vundle#begin()</span><br><span class=\"line\">Plugin &#39;VundleVim&#x2F;Vundle.vim&#39;, &#123;&#39;rtp&#39;: &#39;vim&#x2F;&#39;&#125; &quot; 指定用户&#x2F;仓库. 还可以指定run_time_path到仓库的子目录</span><br><span class=\"line\">Plugin &#39;http:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.git&#39;, &#123;&#39;name&#39;: &#39;nerdtree&#39;&#125; &quot; 指定仓库url, 还可以指定名字</span><br><span class=\"line\">Plugin &#39;file:&#x2F;&#x2F;&#x2F;home&#x2F;xxx&#x2F;xxx&#39; &quot; 指定本地插件</span><br><span class=\"line\">&quot; ...</span><br><span class=\"line\">call vundle#end()            &quot; required</span><br><span class=\"line\">filetype plugin indent on    &quot; required</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><p><code>:PluginInstall</code></p>\n<h3 id=\"删除插件\"><a href=\"#删除插件\" class=\"headerlink\" title=\"删除插件\"></a>删除插件</h3><p><code>:PluginClean</code></p>\n<p>或在配置文件下注释掉</p>\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vemhhb2RlaHVhL2FydGljbGVzLzE0MTc0MzM2Lmh0bWw=\">https://www.cnblogs.com/zhaodehua/articles/14174336.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODgxNTk5OC9hcnRpY2xlL2RldGFpbHMvMTAzNTg5MDkw\">https://blog.csdn.net/weixin_38815998/article/details/103589090<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Vim配置文件\"><a href=\"#Vim配置文件\" class=\"headerlink\" title=\"Vim配置文件\"></a>Vim配置文件</h1><p>Vim有两个配置文件</p>\n<ul>\n<li>/etc/vim/vimrc</li>\n<li>~/.vimrc</li>\n</ul>\n<p>第一个全局有效，第二个针对当前用户有效。</p>\n<h1 id=\"Vim插件\"><a href=\"#Vim插件\" class=\"headerlink\" title=\"Vim插件\"></a>Vim插件</h1><h2 id=\"Vundle插件管理插件\"><a href=\"#Vundle插件管理插件\" class=\"headerlink\" title=\"Vundle插件管理插件\"></a>Vundle插件管理插件</h2><p>下载到~/.vim/bundle/Vundle.vim</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set nocompatible              &quot; be iMproved, required</span><br><span class=\"line\">filetype off                  &quot; required</span><br><span class=\"line\">set rtp+&#x3D;~&#x2F;.vim&#x2F;bundle&#x2F;Vundle.vim</span><br><span class=\"line\">call vundle#begin()</span><br><span class=\"line\">Plugin &#39;VundleVim&#x2F;Vundle.vim&#39;, &#123;&#39;rtp&#39;: &#39;vim&#x2F;&#39;&#125; &quot; 指定用户&#x2F;仓库. 还可以指定run_time_path到仓库的子目录</span><br><span class=\"line\">Plugin &#39;http:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx.git&#39;, &#123;&#39;name&#39;: &#39;nerdtree&#39;&#125; &quot; 指定仓库url, 还可以指定名字</span><br><span class=\"line\">Plugin &#39;file:&#x2F;&#x2F;&#x2F;home&#x2F;xxx&#x2F;xxx&#39; &quot; 指定本地插件</span><br><span class=\"line\">&quot; ...</span><br><span class=\"line\">call vundle#end()            &quot; required</span><br><span class=\"line\">filetype plugin indent on    &quot; required</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><p><code>:PluginInstall</code></p>\n<h3 id=\"删除插件\"><a href=\"#删除插件\" class=\"headerlink\" title=\"删除插件\"></a>删除插件</h3><p><code>:PluginClean</code></p>\n<p>或在配置文件下注释掉</p>\n<hr>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vemhhb2RlaHVhL2FydGljbGVzLzE0MTc0MzM2Lmh0bWw=\">https://www.cnblogs.com/zhaodehua/articles/14174336.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODgxNTk5OC9hcnRpY2xlL2RldGFpbHMvMTAzNTg5MDkw\">https://blog.csdn.net/weixin_38815998/article/details/103589090<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Vim Frequently-used","_content":"\n```\nyank\nnyy\t// yank n lines\n\ngoto\nnG\t// go to nth line\n\ndelete\nndd\t// delete n lines\ndnw\t// delete n words\n\n\n\n```\n\n","source":"_posts/vim/vim-frequent.md","raw":"---\ntitle: Vim Frequently-used\ncategories:\n- Vim\n---\n\n```\nyank\nnyy\t// yank n lines\n\ngoto\nnG\t// go to nth line\n\ndelete\nndd\t// delete n lines\ndnw\t// delete n words\n\n\n\n```\n\n","slug":"vim/vim-frequent","published":1,"date":"2021-07-24T11:12:31.959Z","updated":"2021-07-24T11:23:00.916Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983600fl018ogjo5c91z","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yank</span><br><span class=\"line\">nyy\t&#x2F;&#x2F; yank n lines</span><br><span class=\"line\"></span><br><span class=\"line\">goto</span><br><span class=\"line\">nG\t&#x2F;&#x2F; go to nth line</span><br><span class=\"line\"></span><br><span class=\"line\">delete</span><br><span class=\"line\">ndd\t&#x2F;&#x2F; delete n lines</span><br><span class=\"line\">dnw\t&#x2F;&#x2F; delete n words</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yank</span><br><span class=\"line\">nyy\t&#x2F;&#x2F; yank n lines</span><br><span class=\"line\"></span><br><span class=\"line\">goto</span><br><span class=\"line\">nG\t&#x2F;&#x2F; go to nth line</span><br><span class=\"line\"></span><br><span class=\"line\">delete</span><br><span class=\"line\">ndd\t&#x2F;&#x2F; delete n lines</span><br><span class=\"line\">dnw\t&#x2F;&#x2F; delete n words</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Vim 模式","_content":"\n# Vim的模式\n\n- Normal-mode 正常模式\n- Insert-mode 插入模式\n- Command-mode 命令模式\n- Visual-mode 可视模式\n\n## Normal Mode\n\n正常模式下，各种移动逛遍，对文本进行各种操作。\n\n## Insert Mode\n\n插入模式下，会进入编辑状态，键盘会输入内容。\n\n## Command Mode\n\n命令行模式下，可以执行Vim指令。\n\n`:` 输入指令\n\n`/` 按关键字查找\n\n## Visual Mode\n\n可视化模式下，可以使用鼠标进行选择。\n\n","source":"_posts/vim/vim-mode.md","raw":"---\ntitle: Vim 模式\ncategories:\n- Vim\ntags:\n- vim\n- linux\n---\n\n# Vim的模式\n\n- Normal-mode 正常模式\n- Insert-mode 插入模式\n- Command-mode 命令模式\n- Visual-mode 可视模式\n\n## Normal Mode\n\n正常模式下，各种移动逛遍，对文本进行各种操作。\n\n## Insert Mode\n\n插入模式下，会进入编辑状态，键盘会输入内容。\n\n## Command Mode\n\n命令行模式下，可以执行Vim指令。\n\n`:` 输入指令\n\n`/` 按关键字查找\n\n## Visual Mode\n\n可视化模式下，可以使用鼠标进行选择。\n\n","slug":"vim/vim-mode","published":1,"date":"2021-05-27T08:58:57.338Z","updated":"2021-05-27T09:41:39.203Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983700fp018oeixt5dsr","content":"<h1 id=\"Vim的模式\"><a href=\"#Vim的模式\" class=\"headerlink\" title=\"Vim的模式\"></a>Vim的模式</h1><ul>\n<li>Normal-mode 正常模式</li>\n<li>Insert-mode 插入模式</li>\n<li>Command-mode 命令模式</li>\n<li>Visual-mode 可视模式</li>\n</ul>\n<h2 id=\"Normal-Mode\"><a href=\"#Normal-Mode\" class=\"headerlink\" title=\"Normal Mode\"></a>Normal Mode</h2><p>正常模式下，各种移动逛遍，对文本进行各种操作。</p>\n<h2 id=\"Insert-Mode\"><a href=\"#Insert-Mode\" class=\"headerlink\" title=\"Insert Mode\"></a>Insert Mode</h2><p>插入模式下，会进入编辑状态，键盘会输入内容。</p>\n<h2 id=\"Command-Mode\"><a href=\"#Command-Mode\" class=\"headerlink\" title=\"Command Mode\"></a>Command Mode</h2><p>命令行模式下，可以执行Vim指令。</p>\n<p><code>:</code> 输入指令</p>\n<p><code>/</code> 按关键字查找</p>\n<h2 id=\"Visual-Mode\"><a href=\"#Visual-Mode\" class=\"headerlink\" title=\"Visual Mode\"></a>Visual Mode</h2><p>可视化模式下，可以使用鼠标进行选择。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Vim的模式\"><a href=\"#Vim的模式\" class=\"headerlink\" title=\"Vim的模式\"></a>Vim的模式</h1><ul>\n<li>Normal-mode 正常模式</li>\n<li>Insert-mode 插入模式</li>\n<li>Command-mode 命令模式</li>\n<li>Visual-mode 可视模式</li>\n</ul>\n<h2 id=\"Normal-Mode\"><a href=\"#Normal-Mode\" class=\"headerlink\" title=\"Normal Mode\"></a>Normal Mode</h2><p>正常模式下，各种移动逛遍，对文本进行各种操作。</p>\n<h2 id=\"Insert-Mode\"><a href=\"#Insert-Mode\" class=\"headerlink\" title=\"Insert Mode\"></a>Insert Mode</h2><p>插入模式下，会进入编辑状态，键盘会输入内容。</p>\n<h2 id=\"Command-Mode\"><a href=\"#Command-Mode\" class=\"headerlink\" title=\"Command Mode\"></a>Command Mode</h2><p>命令行模式下，可以执行Vim指令。</p>\n<p><code>:</code> 输入指令</p>\n<p><code>/</code> 按关键字查找</p>\n<h2 id=\"Visual-Mode\"><a href=\"#Visual-Mode\" class=\"headerlink\" title=\"Visual Mode\"></a>Visual Mode</h2><p>可视化模式下，可以使用鼠标进行选择。</p>\n"},{"title":"Vim插件 - Python Mode","_content":"\n# 安装\n\n```\nPlugin 'python-mode/python-mode'\nPlugin 'https://github.com.cnpmjs.org/python-mode/python-mode.git'\n```\n\n## 问题\n\n由于repo中有`submodule`导致如果Github被墙的话，其中的包仍然下载不了。\n\n且clone默认是不加载`submodules`的\n\n```\ngit submodule update --init --recursive\n```\n\n## 解决\n\n1. clone时下载\n\n```sh\ngit clone --recurse-submodules https://github.com/xxx/xxx.git\n```\n\n2. 在主项目中执行\n\n```sh\ngit submodule init\ngit submodule update\n```\n\n","source":"_posts/vim/vim-pymode.md","raw":"---\ntitle: Vim插件 - Python Mode\ncategories:\n- Vim\ntags:\n- vim\n- python\n- linux\n---\n\n# 安装\n\n```\nPlugin 'python-mode/python-mode'\nPlugin 'https://github.com.cnpmjs.org/python-mode/python-mode.git'\n```\n\n## 问题\n\n由于repo中有`submodule`导致如果Github被墙的话，其中的包仍然下载不了。\n\n且clone默认是不加载`submodules`的\n\n```\ngit submodule update --init --recursive\n```\n\n## 解决\n\n1. clone时下载\n\n```sh\ngit clone --recurse-submodules https://github.com/xxx/xxx.git\n```\n\n2. 在主项目中执行\n\n```sh\ngit submodule init\ngit submodule update\n```\n\n","slug":"vim/vim-pymode","published":1,"date":"2021-05-27T11:47:09.498Z","updated":"2021-05-27T12:33:00.064Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983700fr018of9ka64jx","content":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Plugin &#39;python-mode&#x2F;python-mode&#39;</span><br><span class=\"line\">Plugin &#39;https:&#x2F;&#x2F;github.com.cnpmjs.org&#x2F;python-mode&#x2F;python-mode.git&#39;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>由于repo中有<code>submodule</code>导致如果Github被墙的话，其中的包仍然下载不了。</p>\n<p>且clone默认是不加载<code>submodules</code>的</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git submodule update --init --recursive</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h2><ol>\n<li>clone时下载</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> --recurse-submodules https://github.com/xxx/xxx.git</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>在主项目中执行</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git submodule init</span><br><span class=\"line\">git submodule update</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Plugin &#39;python-mode&#x2F;python-mode&#39;</span><br><span class=\"line\">Plugin &#39;https:&#x2F;&#x2F;github.com.cnpmjs.org&#x2F;python-mode&#x2F;python-mode.git&#39;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>由于repo中有<code>submodule</code>导致如果Github被墙的话，其中的包仍然下载不了。</p>\n<p>且clone默认是不加载<code>submodules</code>的</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git submodule update --init --recursive</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h2><ol>\n<li>clone时下载</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> --recurse-submodules https://github.com/xxx/xxx.git</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>在主项目中执行</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git submodule init</span><br><span class=\"line\">git submodule update</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Vim入门","_content":"\n# Norm Mode\n\n## 插入\n\n`i`在光标前插入\n\n`I`在所在行行首插入\n\n`a`在光标所在字符后\n\n`A`在所在行行尾插入\n\n`o`在光标所在行下一行行首插入\n\n`O`在光标所在行上一行行首插入\n\n`s`删除光标所在处的字符然后插入\n\n`S`删除所在行并在行首插入\n\n## 快速移动光标\n\n`h`左移\n\n`j`下移\n\n`k`上移\n\n`l`右移\n\n### 词上的移动\n\n`0`移动到行头\n\n`$`移动到行尾\n\n`w`移动到下一个单词的开头\n\n`e`移动到下一个单词的结尾\n\n`b`移动到上一个单词的开头\n\n`ge`移动到上一个单词的结尾\n\n### 行上的移动\n\n`nG`定位到第n行行首\n\n`gg`定位到第一行的行首\n\n`G`定位到最后一行的行首\n\n`H`定位到当前屏幕的第一行行首\n\n`M`定位到当前屏幕的中间\n\n`L`定位到当前屏幕的尾部\n\n### 页上的移动\n\n`ctrl+f`下一页\n\n`ctrl+b`上一页\n\n## 编辑操作\n\n`dw`删除一个单词（dnw删除n个单词，ndd删除n行）\n\n`dd`删除一行\n\n`yw`复制一个单词\n\n`yy`复制一行\n\n`p`在光标后开始复制\n\n`P`在光标前开始复制\n\n## 撤销恢复\n\n`u`undo\n\n`ctrl+r`reundo\n\n\n\n# Command Mode\n\n`:set nu`显示行号\n\n`:set nonu `取消行号\n\n","source":"_posts/vim/vim-start.md","raw":"---\ntitle: Vim入门\ncategories: \n- Vim\ntags: \n- vim\n---\n\n# Norm Mode\n\n## 插入\n\n`i`在光标前插入\n\n`I`在所在行行首插入\n\n`a`在光标所在字符后\n\n`A`在所在行行尾插入\n\n`o`在光标所在行下一行行首插入\n\n`O`在光标所在行上一行行首插入\n\n`s`删除光标所在处的字符然后插入\n\n`S`删除所在行并在行首插入\n\n## 快速移动光标\n\n`h`左移\n\n`j`下移\n\n`k`上移\n\n`l`右移\n\n### 词上的移动\n\n`0`移动到行头\n\n`$`移动到行尾\n\n`w`移动到下一个单词的开头\n\n`e`移动到下一个单词的结尾\n\n`b`移动到上一个单词的开头\n\n`ge`移动到上一个单词的结尾\n\n### 行上的移动\n\n`nG`定位到第n行行首\n\n`gg`定位到第一行的行首\n\n`G`定位到最后一行的行首\n\n`H`定位到当前屏幕的第一行行首\n\n`M`定位到当前屏幕的中间\n\n`L`定位到当前屏幕的尾部\n\n### 页上的移动\n\n`ctrl+f`下一页\n\n`ctrl+b`上一页\n\n## 编辑操作\n\n`dw`删除一个单词（dnw删除n个单词，ndd删除n行）\n\n`dd`删除一行\n\n`yw`复制一个单词\n\n`yy`复制一行\n\n`p`在光标后开始复制\n\n`P`在光标前开始复制\n\n## 撤销恢复\n\n`u`undo\n\n`ctrl+r`reundo\n\n\n\n# Command Mode\n\n`:set nu`显示行号\n\n`:set nonu `取消行号\n\n","slug":"vim/vim-start","published":1,"date":"2021-01-20T07:13:20.224Z","updated":"2021-05-27T04:00:14.396Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983800fu018o1hrt8tlt","content":"<h1 id=\"Norm-Mode\"><a href=\"#Norm-Mode\" class=\"headerlink\" title=\"Norm Mode\"></a>Norm Mode</h1><h2 id=\"插入\"><a href=\"#插入\" class=\"headerlink\" title=\"插入\"></a>插入</h2><p><code>i</code>在光标前插入</p>\n<p><code>I</code>在所在行行首插入</p>\n<p><code>a</code>在光标所在字符后</p>\n<p><code>A</code>在所在行行尾插入</p>\n<p><code>o</code>在光标所在行下一行行首插入</p>\n<p><code>O</code>在光标所在行上一行行首插入</p>\n<p><code>s</code>删除光标所在处的字符然后插入</p>\n<p><code>S</code>删除所在行并在行首插入</p>\n<h2 id=\"快速移动光标\"><a href=\"#快速移动光标\" class=\"headerlink\" title=\"快速移动光标\"></a>快速移动光标</h2><p><code>h</code>左移</p>\n<p><code>j</code>下移</p>\n<p><code>k</code>上移</p>\n<p><code>l</code>右移</p>\n<h3 id=\"词上的移动\"><a href=\"#词上的移动\" class=\"headerlink\" title=\"词上的移动\"></a>词上的移动</h3><p><code>0</code>移动到行头</p>\n<p><code>$</code>移动到行尾</p>\n<p><code>w</code>移动到下一个单词的开头</p>\n<p><code>e</code>移动到下一个单词的结尾</p>\n<p><code>b</code>移动到上一个单词的开头</p>\n<p><code>ge</code>移动到上一个单词的结尾</p>\n<h3 id=\"行上的移动\"><a href=\"#行上的移动\" class=\"headerlink\" title=\"行上的移动\"></a>行上的移动</h3><p><code>nG</code>定位到第n行行首</p>\n<p><code>gg</code>定位到第一行的行首</p>\n<p><code>G</code>定位到最后一行的行首</p>\n<p><code>H</code>定位到当前屏幕的第一行行首</p>\n<p><code>M</code>定位到当前屏幕的中间</p>\n<p><code>L</code>定位到当前屏幕的尾部</p>\n<h3 id=\"页上的移动\"><a href=\"#页上的移动\" class=\"headerlink\" title=\"页上的移动\"></a>页上的移动</h3><p><code>ctrl+f</code>下一页</p>\n<p><code>ctrl+b</code>上一页</p>\n<h2 id=\"编辑操作\"><a href=\"#编辑操作\" class=\"headerlink\" title=\"编辑操作\"></a>编辑操作</h2><p><code>dw</code>删除一个单词（dnw删除n个单词，ndd删除n行）</p>\n<p><code>dd</code>删除一行</p>\n<p><code>yw</code>复制一个单词</p>\n<p><code>yy</code>复制一行</p>\n<p><code>p</code>在光标后开始复制</p>\n<p><code>P</code>在光标前开始复制</p>\n<h2 id=\"撤销恢复\"><a href=\"#撤销恢复\" class=\"headerlink\" title=\"撤销恢复\"></a>撤销恢复</h2><p><code>u</code>undo</p>\n<p><code>ctrl+r</code>reundo</p>\n<h1 id=\"Command-Mode\"><a href=\"#Command-Mode\" class=\"headerlink\" title=\"Command Mode\"></a>Command Mode</h1><p><code>:set nu</code>显示行号</p>\n<p><code>:set nonu</code>取消行号</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Norm-Mode\"><a href=\"#Norm-Mode\" class=\"headerlink\" title=\"Norm Mode\"></a>Norm Mode</h1><h2 id=\"插入\"><a href=\"#插入\" class=\"headerlink\" title=\"插入\"></a>插入</h2><p><code>i</code>在光标前插入</p>\n<p><code>I</code>在所在行行首插入</p>\n<p><code>a</code>在光标所在字符后</p>\n<p><code>A</code>在所在行行尾插入</p>\n<p><code>o</code>在光标所在行下一行行首插入</p>\n<p><code>O</code>在光标所在行上一行行首插入</p>\n<p><code>s</code>删除光标所在处的字符然后插入</p>\n<p><code>S</code>删除所在行并在行首插入</p>\n<h2 id=\"快速移动光标\"><a href=\"#快速移动光标\" class=\"headerlink\" title=\"快速移动光标\"></a>快速移动光标</h2><p><code>h</code>左移</p>\n<p><code>j</code>下移</p>\n<p><code>k</code>上移</p>\n<p><code>l</code>右移</p>\n<h3 id=\"词上的移动\"><a href=\"#词上的移动\" class=\"headerlink\" title=\"词上的移动\"></a>词上的移动</h3><p><code>0</code>移动到行头</p>\n<p><code>$</code>移动到行尾</p>\n<p><code>w</code>移动到下一个单词的开头</p>\n<p><code>e</code>移动到下一个单词的结尾</p>\n<p><code>b</code>移动到上一个单词的开头</p>\n<p><code>ge</code>移动到上一个单词的结尾</p>\n<h3 id=\"行上的移动\"><a href=\"#行上的移动\" class=\"headerlink\" title=\"行上的移动\"></a>行上的移动</h3><p><code>nG</code>定位到第n行行首</p>\n<p><code>gg</code>定位到第一行的行首</p>\n<p><code>G</code>定位到最后一行的行首</p>\n<p><code>H</code>定位到当前屏幕的第一行行首</p>\n<p><code>M</code>定位到当前屏幕的中间</p>\n<p><code>L</code>定位到当前屏幕的尾部</p>\n<h3 id=\"页上的移动\"><a href=\"#页上的移动\" class=\"headerlink\" title=\"页上的移动\"></a>页上的移动</h3><p><code>ctrl+f</code>下一页</p>\n<p><code>ctrl+b</code>上一页</p>\n<h2 id=\"编辑操作\"><a href=\"#编辑操作\" class=\"headerlink\" title=\"编辑操作\"></a>编辑操作</h2><p><code>dw</code>删除一个单词（dnw删除n个单词，ndd删除n行）</p>\n<p><code>dd</code>删除一行</p>\n<p><code>yw</code>复制一个单词</p>\n<p><code>yy</code>复制一行</p>\n<p><code>p</code>在光标后开始复制</p>\n<p><code>P</code>在光标前开始复制</p>\n<h2 id=\"撤销恢复\"><a href=\"#撤销恢复\" class=\"headerlink\" title=\"撤销恢复\"></a>撤销恢复</h2><p><code>u</code>undo</p>\n<p><code>ctrl+r</code>reundo</p>\n<h1 id=\"Command-Mode\"><a href=\"#Command-Mode\" class=\"headerlink\" title=\"Command Mode\"></a>Command Mode</h1><p><code>:set nu</code>显示行号</p>\n<p><code>:set nonu</code>取消行号</p>\n"},{"title":"Vim NerdTree","_content":"\n# NerdTree\n\n### 配置文件\n\n```\nautocmd vimenter * NERDTree\nmap <F3> :NERDTreeMirror<CR>\nmap <F3> :NERDTreeToggle<CR>\n```\n\n- 打开vim自动开启NerdTree\n- F3 开关NerdTree\n\n### 基本操作\n\n`o` 打开并转到页面\n\n`go` 打开但不跳转\n\n`t` 新tab中打开\n\n`T` 新tab中打开但不跳转\n\n`i` split新窗口打开\n\n`gi` split新窗口但不跳转\n\n`s` vsplit新窗口打开\n\n`gs` vsplit新窗口但不跳转\n\n`gt` 后一个tab\n\n`gT` 前一个tab\n\n### 分屏操作\n\n`ctrl w w` 光标来回切换\n\n`ctrl w h/j/k/l` 光标左/下/上/右切换","source":"_posts/vim/vim-nerdtree.md","raw":"---\ntitle: Vim NerdTree\ncategories:\n- Vim\ntags:\n- nerdtree\n---\n\n# NerdTree\n\n### 配置文件\n\n```\nautocmd vimenter * NERDTree\nmap <F3> :NERDTreeMirror<CR>\nmap <F3> :NERDTreeToggle<CR>\n```\n\n- 打开vim自动开启NerdTree\n- F3 开关NerdTree\n\n### 基本操作\n\n`o` 打开并转到页面\n\n`go` 打开但不跳转\n\n`t` 新tab中打开\n\n`T` 新tab中打开但不跳转\n\n`i` split新窗口打开\n\n`gi` split新窗口但不跳转\n\n`s` vsplit新窗口打开\n\n`gs` vsplit新窗口但不跳转\n\n`gt` 后一个tab\n\n`gT` 前一个tab\n\n### 分屏操作\n\n`ctrl w w` 光标来回切换\n\n`ctrl w h/j/k/l` 光标左/下/上/右切换","slug":"vim/vim-nerdtree","published":1,"date":"2021-07-24T09:35:32.404Z","updated":"2021-07-24T11:19:22.532Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983900fx018ob0q185oo","content":"<h1 id=\"NerdTree\"><a href=\"#NerdTree\" class=\"headerlink\" title=\"NerdTree\"></a>NerdTree</h1><h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">autocmd vimenter * NERDTree</span><br><span class=\"line\">map &lt;F3&gt; :NERDTreeMirror&lt;CR&gt;</span><br><span class=\"line\">map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>打开vim自动开启NerdTree</li>\n<li>F3 开关NerdTree</li>\n</ul>\n<h3 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h3><p><code>o</code> 打开并转到页面</p>\n<p><code>go</code> 打开但不跳转</p>\n<p><code>t</code> 新tab中打开</p>\n<p><code>T</code> 新tab中打开但不跳转</p>\n<p><code>i</code> split新窗口打开</p>\n<p><code>gi</code> split新窗口但不跳转</p>\n<p><code>s</code> vsplit新窗口打开</p>\n<p><code>gs</code> vsplit新窗口但不跳转</p>\n<p><code>gt</code> 后一个tab</p>\n<p><code>gT</code> 前一个tab</p>\n<h3 id=\"分屏操作\"><a href=\"#分屏操作\" class=\"headerlink\" title=\"分屏操作\"></a>分屏操作</h3><p><code>ctrl w w</code> 光标来回切换</p>\n<p><code>ctrl w h/j/k/l</code> 光标左/下/上/右切换</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"NerdTree\"><a href=\"#NerdTree\" class=\"headerlink\" title=\"NerdTree\"></a>NerdTree</h1><h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">autocmd vimenter * NERDTree</span><br><span class=\"line\">map &lt;F3&gt; :NERDTreeMirror&lt;CR&gt;</span><br><span class=\"line\">map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>打开vim自动开启NerdTree</li>\n<li>F3 开关NerdTree</li>\n</ul>\n<h3 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h3><p><code>o</code> 打开并转到页面</p>\n<p><code>go</code> 打开但不跳转</p>\n<p><code>t</code> 新tab中打开</p>\n<p><code>T</code> 新tab中打开但不跳转</p>\n<p><code>i</code> split新窗口打开</p>\n<p><code>gi</code> split新窗口但不跳转</p>\n<p><code>s</code> vsplit新窗口打开</p>\n<p><code>gs</code> vsplit新窗口但不跳转</p>\n<p><code>gt</code> 后一个tab</p>\n<p><code>gT</code> 前一个tab</p>\n<h3 id=\"分屏操作\"><a href=\"#分屏操作\" class=\"headerlink\" title=\"分屏操作\"></a>分屏操作</h3><p><code>ctrl w w</code> 光标来回切换</p>\n<p><code>ctrl w h/j/k/l</code> 光标左/下/上/右切换</p>\n"},{"title":"offline download solution","_content":"\n# aria2 ariang\n\n## docker pull\n\n```sh\ndocker pull p3terx/aria2\ndocker pull p3terx/ariang\n```\n\n## docker compose\n\n```yaml\nversion: \"3.8\"\n\nservices:\n  Aria2-Pro:\n    container_name: aria2-pro\n    image: p3terx/aria2-pro\n    environment:\n      - PUID=65534\n      - PGID=65534\n      - UMASK_SET=022\n      - RPC_SECRET=GTX690\n      - RPC_PORT=6800\n      - LISTEN_PORT=6888\n      - DISK_CACHE=64M\n      - IPV6_MODE=false\n      - UPDATE_TRACKERS=true\n      - CUSTOM_TRACKER_URL=\n      - TZ=Asia/Shanghai\n    volumes:\n      - ./config:/config\n      - /mnt/GoogleDrive/aria2:/downloads\n    network_mode: bridge\n    ports:\n      - 6800:6800\n      - 6888:6888\n      - 6888:6888/udp\n    restart: unless-stopped\n    logging:\n      driver: json-file\n      options:\n        max-size: 1m\n\n  AriaNg:\n    container_name: ariang\n    image: p3terx/ariang\n    network_mode: bridge\n    ports:\n      - 6880:6880\n    restart: unless-stopped\n    logging:\n      driver: json-file\n      options:\n        max-size: 1m\n```\n\n## config\n\n```\ncat ~/Applications/aria2/config/script.conf\n```\n\n# h5ai\n\nh5ai realize static file could be shown online eazily\n\n## docker pull\n\n```sh\ndocker pull clue/h5ai\n```\n\n## docker compose\n\n```yaml\nversion: \"3.8\"\n\nservices:\n  Aria2-Pro:\n    container_name: h5ai\n    image: clue/h5ai\n    volumes:\n      - /mnt/GoogleDrive:/var/www\n    ports:\n      - 11000:80\n```\n\n\n\n\n\n----\n\nReference\n\nhttps://p3terx.com/archives/docker-aria2-pro.html","source":"_posts/vps/aria.md","raw":"---\ntitle: offline download solution\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- aria2\n- ariang\n---\n\n# aria2 ariang\n\n## docker pull\n\n```sh\ndocker pull p3terx/aria2\ndocker pull p3terx/ariang\n```\n\n## docker compose\n\n```yaml\nversion: \"3.8\"\n\nservices:\n  Aria2-Pro:\n    container_name: aria2-pro\n    image: p3terx/aria2-pro\n    environment:\n      - PUID=65534\n      - PGID=65534\n      - UMASK_SET=022\n      - RPC_SECRET=GTX690\n      - RPC_PORT=6800\n      - LISTEN_PORT=6888\n      - DISK_CACHE=64M\n      - IPV6_MODE=false\n      - UPDATE_TRACKERS=true\n      - CUSTOM_TRACKER_URL=\n      - TZ=Asia/Shanghai\n    volumes:\n      - ./config:/config\n      - /mnt/GoogleDrive/aria2:/downloads\n    network_mode: bridge\n    ports:\n      - 6800:6800\n      - 6888:6888\n      - 6888:6888/udp\n    restart: unless-stopped\n    logging:\n      driver: json-file\n      options:\n        max-size: 1m\n\n  AriaNg:\n    container_name: ariang\n    image: p3terx/ariang\n    network_mode: bridge\n    ports:\n      - 6880:6880\n    restart: unless-stopped\n    logging:\n      driver: json-file\n      options:\n        max-size: 1m\n```\n\n## config\n\n```\ncat ~/Applications/aria2/config/script.conf\n```\n\n# h5ai\n\nh5ai realize static file could be shown online eazily\n\n## docker pull\n\n```sh\ndocker pull clue/h5ai\n```\n\n## docker compose\n\n```yaml\nversion: \"3.8\"\n\nservices:\n  Aria2-Pro:\n    container_name: h5ai\n    image: clue/h5ai\n    volumes:\n      - /mnt/GoogleDrive:/var/www\n    ports:\n      - 11000:80\n```\n\n\n\n\n\n----\n\nReference\n\nhttps://p3terx.com/archives/docker-aria2-pro.html","slug":"vps/aria","published":1,"date":"2021-10-09T13:18:10.067Z","updated":"2021-10-15T10:10:10.366Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983a00g0018ocjg27dxd","content":"<h1 id=\"aria2-ariang\"><a href=\"#aria2-ariang\" class=\"headerlink\" title=\"aria2 ariang\"></a>aria2 ariang</h1><h2 id=\"docker-pull\"><a href=\"#docker-pull\" class=\"headerlink\" title=\"docker pull\"></a>docker pull</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull p3terx/aria2</span><br><span class=\"line\">docker pull p3terx/ariang</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.8\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Aria2-Pro:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">aria2-pro</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">p3terx/aria2-pro</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">PUID=65534</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">PGID=65534</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">UMASK_SET=022</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">RPC_SECRET=GTX690</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">RPC_PORT=6800</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">LISTEN_PORT=6888</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">DISK_CACHE=64M</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">IPV6_MODE=false</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">UPDATE_TRACKERS=true</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">CUSTOM_TRACKER_URL=</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">TZ=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./config:/config</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/mnt/GoogleDrive/aria2:/downloads</span></span><br><span class=\"line\">    <span class=\"attr\">network_mode:</span> <span class=\"string\">bridge</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6800</span><span class=\"string\">:6800</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6888</span><span class=\"string\">:6888</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6888</span><span class=\"string\">:6888/udp</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">logging:</span></span><br><span class=\"line\">      <span class=\"attr\">driver:</span> <span class=\"string\">json-file</span></span><br><span class=\"line\">      <span class=\"attr\">options:</span></span><br><span class=\"line\">        <span class=\"attr\">max-size:</span> <span class=\"string\">1m</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">AriaNg:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">ariang</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">p3terx/ariang</span></span><br><span class=\"line\">    <span class=\"attr\">network_mode:</span> <span class=\"string\">bridge</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6880</span><span class=\"string\">:6880</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">logging:</span></span><br><span class=\"line\">      <span class=\"attr\">driver:</span> <span class=\"string\">json-file</span></span><br><span class=\"line\">      <span class=\"attr\">options:</span></span><br><span class=\"line\">        <span class=\"attr\">max-size:</span> <span class=\"string\">1m</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ~&#x2F;Applications&#x2F;aria2&#x2F;config&#x2F;script.conf</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"h5ai\"><a href=\"#h5ai\" class=\"headerlink\" title=\"h5ai\"></a>h5ai</h1><p>h5ai realize static file could be shown online eazily</p>\n<h2 id=\"docker-pull-1\"><a href=\"#docker-pull-1\" class=\"headerlink\" title=\"docker pull\"></a>docker pull</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull clue/h5ai</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-compose-1\"><a href=\"#docker-compose-1\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.8\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Aria2-Pro:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">h5ai</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">clue/h5ai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/mnt/GoogleDrive:/var/www</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">11000</span><span class=\"string\">:80</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wM3RlcnguY29tL2FyY2hpdmVzL2RvY2tlci1hcmlhMi1wcm8uaHRtbA==\">https://p3terx.com/archives/docker-aria2-pro.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"aria2-ariang\"><a href=\"#aria2-ariang\" class=\"headerlink\" title=\"aria2 ariang\"></a>aria2 ariang</h1><h2 id=\"docker-pull\"><a href=\"#docker-pull\" class=\"headerlink\" title=\"docker pull\"></a>docker pull</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull p3terx/aria2</span><br><span class=\"line\">docker pull p3terx/ariang</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.8\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Aria2-Pro:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">aria2-pro</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">p3terx/aria2-pro</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">PUID=65534</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">PGID=65534</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">UMASK_SET=022</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">RPC_SECRET=GTX690</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">RPC_PORT=6800</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">LISTEN_PORT=6888</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">DISK_CACHE=64M</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">IPV6_MODE=false</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">UPDATE_TRACKERS=true</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">CUSTOM_TRACKER_URL=</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">TZ=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./config:/config</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/mnt/GoogleDrive/aria2:/downloads</span></span><br><span class=\"line\">    <span class=\"attr\">network_mode:</span> <span class=\"string\">bridge</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6800</span><span class=\"string\">:6800</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6888</span><span class=\"string\">:6888</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6888</span><span class=\"string\">:6888/udp</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">logging:</span></span><br><span class=\"line\">      <span class=\"attr\">driver:</span> <span class=\"string\">json-file</span></span><br><span class=\"line\">      <span class=\"attr\">options:</span></span><br><span class=\"line\">        <span class=\"attr\">max-size:</span> <span class=\"string\">1m</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">AriaNg:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">ariang</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">p3terx/ariang</span></span><br><span class=\"line\">    <span class=\"attr\">network_mode:</span> <span class=\"string\">bridge</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">6880</span><span class=\"string\">:6880</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">logging:</span></span><br><span class=\"line\">      <span class=\"attr\">driver:</span> <span class=\"string\">json-file</span></span><br><span class=\"line\">      <span class=\"attr\">options:</span></span><br><span class=\"line\">        <span class=\"attr\">max-size:</span> <span class=\"string\">1m</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ~&#x2F;Applications&#x2F;aria2&#x2F;config&#x2F;script.conf</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"h5ai\"><a href=\"#h5ai\" class=\"headerlink\" title=\"h5ai\"></a>h5ai</h1><p>h5ai realize static file could be shown online eazily</p>\n<h2 id=\"docker-pull-1\"><a href=\"#docker-pull-1\" class=\"headerlink\" title=\"docker pull\"></a>docker pull</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull clue/h5ai</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"docker-compose-1\"><a href=\"#docker-compose-1\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.8\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Aria2-Pro:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">h5ai</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">clue/h5ai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/mnt/GoogleDrive:/var/www</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">11000</span><span class=\"string\">:80</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wM3RlcnguY29tL2FyY2hpdmVzL2RvY2tlci1hcmlhMi1wcm8uaHRtbA==\">https://p3terx.com/archives/docker-aria2-pro.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"configure new VPS","_content":"\n# user\n\n## add new user\n\n```sh\nadduser ubuntu  # new user's direction automatically\nuseradd ubuntu  # need to new dir manually\n```\n\n## add user to admin group / edit sudoers\n\n```sh\ngroupadd superadmin\nusermod -g superadmin ubuntu\n```\n\n```sh\nadduser ubuntu --ingroup sudo  # new user and assign to sudo group\n```\n\n```sh\nvim /etc/sudoers\n```\n\n## user state\n\n```sh\nid ubuntu\n```\n\n# upload public key\n\n```sh\nssh-keygen\n```\n\nnew file `authorized_keys` and paste your own public key into this file.\n\n# change login method\n\n```sh\ncd /etc/ssh\nvim sshd_config\n```\n\n```\nRSAAuthentication yes\nPubkeyAuthentication yes\nPermitRootLogin yes\nPasswordAuthentication no\n```\n\n","source":"_posts/vps/first-conf.md","raw":"---\ntitle: configure new VPS\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n---\n\n# user\n\n## add new user\n\n```sh\nadduser ubuntu  # new user's direction automatically\nuseradd ubuntu  # need to new dir manually\n```\n\n## add user to admin group / edit sudoers\n\n```sh\ngroupadd superadmin\nusermod -g superadmin ubuntu\n```\n\n```sh\nadduser ubuntu --ingroup sudo  # new user and assign to sudo group\n```\n\n```sh\nvim /etc/sudoers\n```\n\n## user state\n\n```sh\nid ubuntu\n```\n\n# upload public key\n\n```sh\nssh-keygen\n```\n\nnew file `authorized_keys` and paste your own public key into this file.\n\n# change login method\n\n```sh\ncd /etc/ssh\nvim sshd_config\n```\n\n```\nRSAAuthentication yes\nPubkeyAuthentication yes\nPermitRootLogin yes\nPasswordAuthentication no\n```\n\n","slug":"vps/first-conf","published":1,"date":"2021-10-09T02:57:44.964Z","updated":"2021-10-11T05:06:13.287Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983b00g4018oh0rn9f69","content":"<h1 id=\"user\"><a href=\"#user\" class=\"headerlink\" title=\"user\"></a>user</h1><h2 id=\"add-new-user\"><a href=\"#add-new-user\" class=\"headerlink\" title=\"add new user\"></a>add new user</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser ubuntu  <span class=\"comment\"># new user's direction automatically</span></span><br><span class=\"line\">useradd ubuntu  <span class=\"comment\"># need to new dir manually</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"add-user-to-admin-group-edit-sudoers\"><a href=\"#add-user-to-admin-group-edit-sudoers\" class=\"headerlink\" title=\"add user to admin group / edit sudoers\"></a>add user to admin group / edit sudoers</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">groupadd superadmin</span><br><span class=\"line\">usermod -g superadmin ubuntu</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser ubuntu --ingroup sudo  <span class=\"comment\"># new user and assign to sudo group</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sudoers</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"user-state\"><a href=\"#user-state\" class=\"headerlink\" title=\"user state\"></a>user state</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id ubuntu</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"upload-public-key\"><a href=\"#upload-public-key\" class=\"headerlink\" title=\"upload public key\"></a>upload public key</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen</span><br></pre></td></tr></table></figure>\n\n<p>new file <code>authorized_keys</code> and paste your own public key into this file.</p>\n<h1 id=\"change-login-method\"><a href=\"#change-login-method\" class=\"headerlink\" title=\"change login method\"></a>change login method</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /etc/ssh</span><br><span class=\"line\">vim sshd_config</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RSAAuthentication yes</span><br><span class=\"line\">PubkeyAuthentication yes</span><br><span class=\"line\">PermitRootLogin yes</span><br><span class=\"line\">PasswordAuthentication no</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"user\"><a href=\"#user\" class=\"headerlink\" title=\"user\"></a>user</h1><h2 id=\"add-new-user\"><a href=\"#add-new-user\" class=\"headerlink\" title=\"add new user\"></a>add new user</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser ubuntu  <span class=\"comment\"># new user's direction automatically</span></span><br><span class=\"line\">useradd ubuntu  <span class=\"comment\"># need to new dir manually</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"add-user-to-admin-group-edit-sudoers\"><a href=\"#add-user-to-admin-group-edit-sudoers\" class=\"headerlink\" title=\"add user to admin group / edit sudoers\"></a>add user to admin group / edit sudoers</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">groupadd superadmin</span><br><span class=\"line\">usermod -g superadmin ubuntu</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser ubuntu --ingroup sudo  <span class=\"comment\"># new user and assign to sudo group</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sudoers</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"user-state\"><a href=\"#user-state\" class=\"headerlink\" title=\"user state\"></a>user state</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id ubuntu</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"upload-public-key\"><a href=\"#upload-public-key\" class=\"headerlink\" title=\"upload public key\"></a>upload public key</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen</span><br></pre></td></tr></table></figure>\n\n<p>new file <code>authorized_keys</code> and paste your own public key into this file.</p>\n<h1 id=\"change-login-method\"><a href=\"#change-login-method\" class=\"headerlink\" title=\"change login method\"></a>change login method</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /etc/ssh</span><br><span class=\"line\">vim sshd_config</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RSAAuthentication yes</span><br><span class=\"line\">PubkeyAuthentication yes</span><br><span class=\"line\">PermitRootLogin yes</span><br><span class=\"line\">PasswordAuthentication no</span><br></pre></td></tr></table></figure>\n\n"},{"title":"first in Github Actions","_content":"\n# coscmd\n\n```sh\npip install coscmd\ncoscmd config -a xxxx -s xxxx -b bucket_name -r region_name\ncoscmd upload file_name dest_name\n```\n\n# picgo\n\ndownload from github\n\n","source":"_posts/vps/cos.md","raw":"---\ntitle: first in Github Actions\ncategories: \n- VPS\ntags: \n- ci\n---\n\n# coscmd\n\n```sh\npip install coscmd\ncoscmd config -a xxxx -s xxxx -b bucket_name -r region_name\ncoscmd upload file_name dest_name\n```\n\n# picgo\n\ndownload from github\n\n","slug":"vps/cos","published":1,"date":"2021-10-10T17:28:41.084Z","updated":"2021-10-10T18:31:49.310Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983d00g7018oh5en4gqm","content":"<h1 id=\"coscmd\"><a href=\"#coscmd\" class=\"headerlink\" title=\"coscmd\"></a>coscmd</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install coscmd</span><br><span class=\"line\">coscmd config -a xxxx -s xxxx -b bucket_name -r region_name</span><br><span class=\"line\">coscmd upload file_name dest_name</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h1><p>download from github</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"coscmd\"><a href=\"#coscmd\" class=\"headerlink\" title=\"coscmd\"></a>coscmd</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install coscmd</span><br><span class=\"line\">coscmd config -a xxxx -s xxxx -b bucket_name -r region_name</span><br><span class=\"line\">coscmd upload file_name dest_name</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h1><p>download from github</p>\n"},{"title":"install docker and compose","_content":"\n# engine\n\n> https://docs.docker.com/engine/install/\n\n# compose\n\n> https://docs.docker.com/compose/install/\n\n","source":"_posts/vps/docker.md","raw":"---\ntitle: install docker and compose\ncategories: \n- VPS\ntags: \n- linux\n- docker\n---\n\n# engine\n\n> https://docs.docker.com/engine/install/\n\n# compose\n\n> https://docs.docker.com/compose/install/\n\n","slug":"vps/docker","published":1,"date":"2021-10-11T05:25:34.510Z","updated":"2021-10-11T05:28:12.112Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983e00gb018oh2hl0gy3","content":"<h1 id=\"engine\"><a href=\"#engine\" class=\"headerlink\" title=\"engine\"></a>engine</h1><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZW5naW5lL2luc3RhbGwv\">https://docs.docker.com/engine/install/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<h1 id=\"compose\"><a href=\"#compose\" class=\"headerlink\" title=\"compose\"></a>compose</h1><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9pbnN0YWxsLw==\">https://docs.docker.com/compose/install/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"engine\"><a href=\"#engine\" class=\"headerlink\" title=\"engine\"></a>engine</h1><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZW5naW5lL2luc3RhbGwv\">https://docs.docker.com/engine/install/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n<h1 id=\"compose\"><a href=\"#compose\" class=\"headerlink\" title=\"compose\"></a>compose</h1><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9pbnN0YWxsLw==\">https://docs.docker.com/compose/install/<i class=\"fa fa-external-link-alt\"></i></span></p>\n</blockquote>\n"},{"title":"bbr","_content":"\n# bbr script\n\n```sh\nwget --no-check-certificate -O /opt/bbr.sh https://github.com/teddysun/across/raw/master/bbr.sh\nchmod 755 /opt/bbr.sh\n/opt/bbr.sh\n```\n\ncontributed by [teddysun](http://teddysun.com)\n\nIf you counter some exceptional mistakes, chose lower version of the kernel.\n\n\n\n----\n\nReference\n\nhttps://teddysun.com/489.html","source":"_posts/vps/bbr.md","raw":"---\ntitle: bbr\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- bbr\n---\n\n# bbr script\n\n```sh\nwget --no-check-certificate -O /opt/bbr.sh https://github.com/teddysun/across/raw/master/bbr.sh\nchmod 755 /opt/bbr.sh\n/opt/bbr.sh\n```\n\ncontributed by [teddysun](http://teddysun.com)\n\nIf you counter some exceptional mistakes, chose lower version of the kernel.\n\n\n\n----\n\nReference\n\nhttps://teddysun.com/489.html","slug":"vps/bbr","published":1,"date":"2021-10-09T09:05:15.054Z","updated":"2021-10-09T09:08:47.883Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983f00gf018oe0agf2rf","content":"<h1 id=\"bbr-script\"><a href=\"#bbr-script\" class=\"headerlink\" title=\"bbr script\"></a>bbr script</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget --no-check-certificate -O /opt/bbr.sh https://github.com/teddysun/across/raw/master/bbr.sh</span><br><span class=\"line\">chmod 755 /opt/bbr.sh</span><br><span class=\"line\">/opt/bbr.sh</span><br></pre></td></tr></table></figure>\n\n<p>contributed by <span class=\"exturl\" data-url=\"aHR0cDovL3RlZGR5c3VuLmNvbQ==\">teddysun<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>If you counter some exceptional mistakes, chose lower version of the kernel.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZWRkeXN1bi5jb20vNDg5Lmh0bWw=\">https://teddysun.com/489.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"bbr-script\"><a href=\"#bbr-script\" class=\"headerlink\" title=\"bbr script\"></a>bbr script</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget --no-check-certificate -O /opt/bbr.sh https://github.com/teddysun/across/raw/master/bbr.sh</span><br><span class=\"line\">chmod 755 /opt/bbr.sh</span><br><span class=\"line\">/opt/bbr.sh</span><br></pre></td></tr></table></figure>\n\n<p>contributed by <span class=\"exturl\" data-url=\"aHR0cDovL3RlZGR5c3VuLmNvbQ==\">teddysun<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p>If you counter some exceptional mistakes, chose lower version of the kernel.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90ZWRkeXN1bi5jb20vNDg5Lmh0bWw=\">https://teddysun.com/489.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"nginx","_content":"\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  nginx:\n    image: nginx\n    volumes:\n     - ./html:/usr/share/nginx/html\n     - ./config:/etc/nginx\n     - ./logs:/var/log/nginx\n     - ./www:/etc/www\n    ports:\n     - 80:80\n    environment:\n     - NGINX_HOST=edlison.com\n     - NGINX_PORT=80\n```\n\n\n\n# config\n\n```nginx\nworker_processes  1;\n\nevents {\n   accept_mutex on;\n   multi_accept on;\n   worker_connections 1024;\n}\n\nhttp {\n\nserver{\n  listen 80;\n  server_name  edlison.com www.edlison.com;\n\n  location / {\n\t  root\t/usr/share/nginx/html;\n\t  index\tindex.html;\n  }\n}\n\nserver{\n  listen 80;\n  server_name  v2ray.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:2000;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n\nserver{\n  listen 80;\n  server_name  aria2.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:6880;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n  \nserver{\n  listen 80;\n  server_name  lib.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:11000;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n\n}\n```\n\ntodo: seperate into meta config","source":"_posts/vps/nginx.md","raw":"---\ntitle: nginx\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- nginx\n---\n\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  nginx:\n    image: nginx\n    volumes:\n     - ./html:/usr/share/nginx/html\n     - ./config:/etc/nginx\n     - ./logs:/var/log/nginx\n     - ./www:/etc/www\n    ports:\n     - 80:80\n    environment:\n     - NGINX_HOST=edlison.com\n     - NGINX_PORT=80\n```\n\n\n\n# config\n\n```nginx\nworker_processes  1;\n\nevents {\n   accept_mutex on;\n   multi_accept on;\n   worker_connections 1024;\n}\n\nhttp {\n\nserver{\n  listen 80;\n  server_name  edlison.com www.edlison.com;\n\n  location / {\n\t  root\t/usr/share/nginx/html;\n\t  index\tindex.html;\n  }\n}\n\nserver{\n  listen 80;\n  server_name  v2ray.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:2000;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n\nserver{\n  listen 80;\n  server_name  aria2.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:6880;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n  \nserver{\n  listen 80;\n  server_name  lib.edlison.com;\n\n  location / {\n    \t\t\t\tproxy_pass http://107.172.102.205:11000;\n            proxy_set_header X_Real_IP $remote_addr;\n            proxy_set_header X-Forwarded-For $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Host $host;\n  }\n}\n\n}\n```\n\ntodo: seperate into meta config","slug":"vps/nginx","published":1,"date":"2021-10-09T16:12:49.128Z","updated":"2021-10-10T14:21:53.274Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983g00gj018o12vghz18","content":"<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">nginx:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">nginx</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./html:/usr/share/nginx/html</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/nginx</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/nginx</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./www:/etc/www</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">80</span><span class=\"string\">:80</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">NGINX_HOST=edlison.com</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">NGINX_PORT=80</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h1><figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">worker_processes</span>  <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">events</span> &#123;</span><br><span class=\"line\">   <span class=\"attribute\">accept_mutex</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">   <span class=\"attribute\">multi_accept</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">   <span class=\"attribute\">worker_connections</span> <span class=\"number\">1024</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">http</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  edlison.com www.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">\t  <span class=\"attribute\">root</span>\t/usr/share/nginx/html;</span><br><span class=\"line\">\t  <span class=\"attribute\">index</span>\tindex.html;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  v2ray.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:2000;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  aria2.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:6880;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  lib.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:11000;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>todo: seperate into meta config</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">nginx:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">nginx</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./html:/usr/share/nginx/html</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/nginx</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/nginx</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./www:/etc/www</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">80</span><span class=\"string\">:80</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">NGINX_HOST=edlison.com</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">NGINX_PORT=80</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h1><figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">worker_processes</span>  <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">events</span> &#123;</span><br><span class=\"line\">   <span class=\"attribute\">accept_mutex</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">   <span class=\"attribute\">multi_accept</span> <span class=\"literal\">on</span>;</span><br><span class=\"line\">   <span class=\"attribute\">worker_connections</span> <span class=\"number\">1024</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">http</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  edlison.com www.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">\t  <span class=\"attribute\">root</span>\t/usr/share/nginx/html;</span><br><span class=\"line\">\t  <span class=\"attribute\">index</span>\tindex.html;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  v2ray.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:2000;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  aria2.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:6880;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">server&#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>  lib.edlison.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">    \t\t\t\t<span class=\"attribute\">proxy_pass</span> http://107.172.102.205:11000;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X_Real_IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">            <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>todo: seperate into meta config</p>\n"},{"title":"freenom auto renew","_content":"\n# compose\n\n```yaml\nversion: \"3.9\"\n\nservices:\n  Freenom-auto:\n    container_name: freenom-auto\n    image: luolongfei/freenom\n    volumes:\n      - ./config:/conf\n      - ./logs:/app/logs\n    restart: always\n```\n\n","source":"_posts/vps/freenom-auto.md","raw":"---\ntitle: freenom auto renew\ncategories:\n- VPS\ntags:\n- docker\n- domain\n---\n\n# compose\n\n```yaml\nversion: \"3.9\"\n\nservices:\n  Freenom-auto:\n    container_name: freenom-auto\n    image: luolongfei/freenom\n    volumes:\n      - ./config:/conf\n      - ./logs:/app/logs\n    restart: always\n```\n\n","slug":"vps/freenom-auto","published":1,"date":"2021-10-13T06:22:44.724Z","updated":"2021-10-13T06:38:52.657Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983i00gn018ocrtl4ty6","content":"<h1 id=\"compose\"><a href=\"#compose\" class=\"headerlink\" title=\"compose\"></a>compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.9\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Freenom-auto:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">freenom-auto</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">luolongfei/freenom</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./config:/conf</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./logs:/app/logs</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"compose\"><a href=\"#compose\" class=\"headerlink\" title=\"compose\"></a>compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3.9\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">Freenom-auto:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">freenom-auto</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">luolongfei/freenom</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./config:/conf</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./logs:/app/logs</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br></pre></td></tr></table></figure>\n\n"},{"title":"auto upload cos by Github Actions","_content":"\n# tencent cos\n\n1. 开通cos的api账号\n2. 将api密钥添加到github项目secret\n\n## workflows\n\n```yaml\n# This is a basic workflow to help you get started with Actions\n\nname: homepage-ci\n\n# Controls when the workflow will run\non:\n  # Triggers the workflow on push or pull request events but only for the main branch\n  push:\n    branches: [ main ]\n\n# A workflow run is made up of one or more jobs that can run sequentially or in parallel\njobs:\n  # This workflow contains a single job called \"build\"\n  build:\n    # The type of runner that the job will run on\n    runs-on: ubuntu-latest\n\n    # Steps represent a sequence of tasks that will be executed as part of the job\n    steps:\n      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\n      - uses: actions/checkout@v2\n\n      # Runs a single command using the runners shell\n      - name: Install coscmd\n        run: sudo pip install coscmd\n\n      # Runs a set of commands using the runners shell\n      - name: Configure coscmd\n        env: \n          SECRETID: ${{ secrets.SECRETID }}\n          SECRETKEY: ${{ secrets.SECRETKEY }}\n          BUCKET: homepage-1304875656\n          REGION: ap-shanghai\n        run: coscmd config -a $SECRETID -s $SECRETKEY -b $BUCKET -r $REGION\n      - name: Upload file\n        run: coscmd upload -r ./ / --ignore \"./.git/*\"\n```\n\n\n\n---\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1545303","source":"_posts/vps/gihubactions.md","raw":"---\ntitle: auto upload cos by Github Actions\ncategories: \n- VPS\ntags: \n- ci\n---\n\n# tencent cos\n\n1. 开通cos的api账号\n2. 将api密钥添加到github项目secret\n\n## workflows\n\n```yaml\n# This is a basic workflow to help you get started with Actions\n\nname: homepage-ci\n\n# Controls when the workflow will run\non:\n  # Triggers the workflow on push or pull request events but only for the main branch\n  push:\n    branches: [ main ]\n\n# A workflow run is made up of one or more jobs that can run sequentially or in parallel\njobs:\n  # This workflow contains a single job called \"build\"\n  build:\n    # The type of runner that the job will run on\n    runs-on: ubuntu-latest\n\n    # Steps represent a sequence of tasks that will be executed as part of the job\n    steps:\n      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\n      - uses: actions/checkout@v2\n\n      # Runs a single command using the runners shell\n      - name: Install coscmd\n        run: sudo pip install coscmd\n\n      # Runs a set of commands using the runners shell\n      - name: Configure coscmd\n        env: \n          SECRETID: ${{ secrets.SECRETID }}\n          SECRETKEY: ${{ secrets.SECRETKEY }}\n          BUCKET: homepage-1304875656\n          REGION: ap-shanghai\n        run: coscmd config -a $SECRETID -s $SECRETKEY -b $BUCKET -r $REGION\n      - name: Upload file\n        run: coscmd upload -r ./ / --ignore \"./.git/*\"\n```\n\n\n\n---\n\nReference\n\nhttps://cloud.tencent.com/developer/article/1545303","slug":"vps/gihubactions","published":1,"date":"2021-10-10T15:59:29.528Z","updated":"2021-10-15T14:09:03.859Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983j00gr018o50wg7hm3","content":"<h1 id=\"tencent-cos\"><a href=\"#tencent-cos\" class=\"headerlink\" title=\"tencent cos\"></a>tencent cos</h1><ol>\n<li>开通cos的api账号</li>\n<li>将api密钥添加到github项目secret</li>\n</ol>\n<h2 id=\"workflows\"><a href=\"#workflows\" class=\"headerlink\" title=\"workflows\"></a>workflows</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># This is a basic workflow to help you get started with Actions</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">homepage-ci</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Controls when the workflow will run</span></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"comment\"># Triggers the workflow on push or pull request events but only for the main branch</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> <span class=\"string\">[</span> <span class=\"string\">main</span> <span class=\"string\">]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"comment\"># This workflow contains a single job called \"build\"</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"comment\"># The type of runner that the job will run on</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Steps represent a sequence of tasks that will be executed as part of the job</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"comment\"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\"># Runs a single command using the runners shell</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">sudo</span> <span class=\"string\">pip</span> <span class=\"string\">install</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\"># Runs a set of commands using the runners shell</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Configure</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\">        <span class=\"attr\">env:</span> </span><br><span class=\"line\">          <span class=\"attr\">SECRETID:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.SECRETID</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">SECRETKEY:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.SECRETKEY</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">BUCKET:</span> <span class=\"string\">homepage-1304875656</span></span><br><span class=\"line\">          <span class=\"attr\">REGION:</span> <span class=\"string\">ap-shanghai</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">coscmd</span> <span class=\"string\">config</span> <span class=\"string\">-a</span> <span class=\"string\">$SECRETID</span> <span class=\"string\">-s</span> <span class=\"string\">$SECRETKEY</span> <span class=\"string\">-b</span> <span class=\"string\">$BUCKET</span> <span class=\"string\">-r</span> <span class=\"string\">$REGION</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Upload</span> <span class=\"string\">file</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">coscmd</span> <span class=\"string\">upload</span> <span class=\"string\">-r</span> <span class=\"string\">./</span> <span class=\"string\">/</span> <span class=\"string\">--ignore</span> <span class=\"string\">\"./.git/*\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNTQ1MzAz\">https://cloud.tencent.com/developer/article/1545303<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"tencent-cos\"><a href=\"#tencent-cos\" class=\"headerlink\" title=\"tencent cos\"></a>tencent cos</h1><ol>\n<li>开通cos的api账号</li>\n<li>将api密钥添加到github项目secret</li>\n</ol>\n<h2 id=\"workflows\"><a href=\"#workflows\" class=\"headerlink\" title=\"workflows\"></a>workflows</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># This is a basic workflow to help you get started with Actions</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">homepage-ci</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Controls when the workflow will run</span></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"comment\"># Triggers the workflow on push or pull request events but only for the main branch</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span> <span class=\"string\">[</span> <span class=\"string\">main</span> <span class=\"string\">]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"comment\"># This workflow contains a single job called \"build\"</span></span><br><span class=\"line\">  <span class=\"attr\">build:</span></span><br><span class=\"line\">    <span class=\"comment\"># The type of runner that the job will run on</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Steps represent a sequence of tasks that will be executed as part of the job</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"comment\"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\"># Runs a single command using the runners shell</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">sudo</span> <span class=\"string\">pip</span> <span class=\"string\">install</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\"># Runs a set of commands using the runners shell</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Configure</span> <span class=\"string\">coscmd</span></span><br><span class=\"line\">        <span class=\"attr\">env:</span> </span><br><span class=\"line\">          <span class=\"attr\">SECRETID:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.SECRETID</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">SECRETKEY:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.SECRETKEY</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">BUCKET:</span> <span class=\"string\">homepage-1304875656</span></span><br><span class=\"line\">          <span class=\"attr\">REGION:</span> <span class=\"string\">ap-shanghai</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">coscmd</span> <span class=\"string\">config</span> <span class=\"string\">-a</span> <span class=\"string\">$SECRETID</span> <span class=\"string\">-s</span> <span class=\"string\">$SECRETKEY</span> <span class=\"string\">-b</span> <span class=\"string\">$BUCKET</span> <span class=\"string\">-r</span> <span class=\"string\">$REGION</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Upload</span> <span class=\"string\">file</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">coscmd</span> <span class=\"string\">upload</span> <span class=\"string\">-r</span> <span class=\"string\">./</span> <span class=\"string\">/</span> <span class=\"string\">--ignore</span> <span class=\"string\">\"./.git/*\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNTQ1MzAz\">https://cloud.tencent.com/developer/article/1545303<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"homepage hook","_content":"\n# 方案\n\n本地编译, 将编译好的文件上传git并且文件自动部署到nginx\n\ntodo: 后期将原文件上传git通过action自动编译并部署\n\n## 思路1\n\n本地push到github, 通过webhook发送POST请求到VPS, 执行shell进行clone然后拷贝至nginx\n\n问题: 服务器需要处理http请求\n\n## 思路2\n\n本地同时push到VPS和github, VPS通过hook执行shell拷贝至nginx\n\n问题: 同时push两个仓库感觉不是很优雅\n\n# git\n\n```sh\nadduser git --ingroup sudo  # add user\n```\n\n```sh\nmkdir ~/edlison/Home.git -p  # new user dir and git repo\n```\n\ncopy local public key to git\n\n```sh\ngit remote set-url sj git@sj:edlison/Home.git  # set push url\n```\n\n# hook\n\n```sh\ncd ~/edlison/Home.git/hooks\nvim post-receive\n```\n\n```sh\necho \"post-receive hook is running...\"\n\nGIT_REPO=/home/git/edlison/Home.git\nTMP_GIT_CLONE=/tmp/homepage\nPUBLIC_WWW=/home/ubuntu/Applications/nginx/html\n\nrm -rf $TMP_GIT_CLONE\ngit clone $GIT_REPO $TMP_GIT_CLONE\nrm -rf ${PUBLIC_WWW}/*\ncp -rf ${TMP_GIT_CLONE}/* ${PUBLIC_WWW}/\n\necho \"post-receive hook is done!\"\n```\n\n\n\n----\n\nReferences\n\nhttps://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook\n\nhttp://yearito.cn/posts/hexo-deploy-to-VPS.html","source":"_posts/vps/git+hook.md","raw":"---\ntitle: homepage hook\ncategories: \n- VPS\ntags: \n- linux\n- webhook\n---\n\n# 方案\n\n本地编译, 将编译好的文件上传git并且文件自动部署到nginx\n\ntodo: 后期将原文件上传git通过action自动编译并部署\n\n## 思路1\n\n本地push到github, 通过webhook发送POST请求到VPS, 执行shell进行clone然后拷贝至nginx\n\n问题: 服务器需要处理http请求\n\n## 思路2\n\n本地同时push到VPS和github, VPS通过hook执行shell拷贝至nginx\n\n问题: 同时push两个仓库感觉不是很优雅\n\n# git\n\n```sh\nadduser git --ingroup sudo  # add user\n```\n\n```sh\nmkdir ~/edlison/Home.git -p  # new user dir and git repo\n```\n\ncopy local public key to git\n\n```sh\ngit remote set-url sj git@sj:edlison/Home.git  # set push url\n```\n\n# hook\n\n```sh\ncd ~/edlison/Home.git/hooks\nvim post-receive\n```\n\n```sh\necho \"post-receive hook is running...\"\n\nGIT_REPO=/home/git/edlison/Home.git\nTMP_GIT_CLONE=/tmp/homepage\nPUBLIC_WWW=/home/ubuntu/Applications/nginx/html\n\nrm -rf $TMP_GIT_CLONE\ngit clone $GIT_REPO $TMP_GIT_CLONE\nrm -rf ${PUBLIC_WWW}/*\ncp -rf ${TMP_GIT_CLONE}/* ${PUBLIC_WWW}/\n\necho \"post-receive hook is done!\"\n```\n\n\n\n----\n\nReferences\n\nhttps://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook\n\nhttp://yearito.cn/posts/hexo-deploy-to-VPS.html","slug":"vps/git+hook","published":1,"date":"2021-10-10T10:54:08.322Z","updated":"2021-10-10T14:21:55.832Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983k00gu018o2nafbaqx","content":"<h1 id=\"方案\"><a href=\"#方案\" class=\"headerlink\" title=\"方案\"></a>方案</h1><p>本地编译, 将编译好的文件上传git并且文件自动部署到nginx</p>\n<p>todo: 后期将原文件上传git通过action自动编译并部署</p>\n<h2 id=\"思路1\"><a href=\"#思路1\" class=\"headerlink\" title=\"思路1\"></a>思路1</h2><p>本地push到github, 通过webhook发送POST请求到VPS, 执行shell进行clone然后拷贝至nginx</p>\n<p>问题: 服务器需要处理http请求</p>\n<h2 id=\"思路2\"><a href=\"#思路2\" class=\"headerlink\" title=\"思路2\"></a>思路2</h2><p>本地同时push到VPS和github, VPS通过hook执行shell拷贝至nginx</p>\n<p>问题: 同时push两个仓库感觉不是很优雅</p>\n<h1 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser git --ingroup sudo  <span class=\"comment\"># add user</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/edlison/Home.git -p  <span class=\"comment\"># new user dir and git repo</span></span><br></pre></td></tr></table></figure>\n\n<p>copy local public key to git</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote <span class=\"built_in\">set</span>-url sj git@sj:edlison/Home.git  <span class=\"comment\"># set push url</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"hook\"><a href=\"#hook\" class=\"headerlink\" title=\"hook\"></a>hook</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~/edlison/Home.git/hooks</span><br><span class=\"line\">vim post-receive</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"post-receive hook is running...\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">GIT_REPO=/home/git/edlison/Home.git</span><br><span class=\"line\">TMP_GIT_CLONE=/tmp/homepage</span><br><span class=\"line\">PUBLIC_WWW=/home/ubuntu/Applications/nginx/html</span><br><span class=\"line\"></span><br><span class=\"line\">rm -rf <span class=\"variable\">$TMP_GIT_CLONE</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> <span class=\"variable\">$GIT_REPO</span> <span class=\"variable\">$TMP_GIT_CLONE</span></span><br><span class=\"line\">rm -rf <span class=\"variable\">$&#123;PUBLIC_WWW&#125;</span>/*</span><br><span class=\"line\">cp -rf <span class=\"variable\">$&#123;TMP_GIT_CLONE&#125;</span>/* <span class=\"variable\">$&#123;PUBLIC_WWW&#125;</span>/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"post-receive hook is done!\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zYW1wd29vZC5naXRodWIuaW8vMjAxOC8xMC8xNy92cHMtZ2l0LXJlcG8tbmd4aW4tZ2l0LWhvb2s=\">https://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3llYXJpdG8uY24vcG9zdHMvaGV4by1kZXBsb3ktdG8tVlBTLmh0bWw=\">http://yearito.cn/posts/hexo-deploy-to-VPS.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"方案\"><a href=\"#方案\" class=\"headerlink\" title=\"方案\"></a>方案</h1><p>本地编译, 将编译好的文件上传git并且文件自动部署到nginx</p>\n<p>todo: 后期将原文件上传git通过action自动编译并部署</p>\n<h2 id=\"思路1\"><a href=\"#思路1\" class=\"headerlink\" title=\"思路1\"></a>思路1</h2><p>本地push到github, 通过webhook发送POST请求到VPS, 执行shell进行clone然后拷贝至nginx</p>\n<p>问题: 服务器需要处理http请求</p>\n<h2 id=\"思路2\"><a href=\"#思路2\" class=\"headerlink\" title=\"思路2\"></a>思路2</h2><p>本地同时push到VPS和github, VPS通过hook执行shell拷贝至nginx</p>\n<p>问题: 同时push两个仓库感觉不是很优雅</p>\n<h1 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adduser git --ingroup sudo  <span class=\"comment\"># add user</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir ~/edlison/Home.git -p  <span class=\"comment\"># new user dir and git repo</span></span><br></pre></td></tr></table></figure>\n\n<p>copy local public key to git</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote <span class=\"built_in\">set</span>-url sj git@sj:edlison/Home.git  <span class=\"comment\"># set push url</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"hook\"><a href=\"#hook\" class=\"headerlink\" title=\"hook\"></a>hook</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~/edlison/Home.git/hooks</span><br><span class=\"line\">vim post-receive</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"post-receive hook is running...\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">GIT_REPO=/home/git/edlison/Home.git</span><br><span class=\"line\">TMP_GIT_CLONE=/tmp/homepage</span><br><span class=\"line\">PUBLIC_WWW=/home/ubuntu/Applications/nginx/html</span><br><span class=\"line\"></span><br><span class=\"line\">rm -rf <span class=\"variable\">$TMP_GIT_CLONE</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> <span class=\"variable\">$GIT_REPO</span> <span class=\"variable\">$TMP_GIT_CLONE</span></span><br><span class=\"line\">rm -rf <span class=\"variable\">$&#123;PUBLIC_WWW&#125;</span>/*</span><br><span class=\"line\">cp -rf <span class=\"variable\">$&#123;TMP_GIT_CLONE&#125;</span>/* <span class=\"variable\">$&#123;PUBLIC_WWW&#125;</span>/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"post-receive hook is done!\"</span></span><br></pre></td></tr></table></figure>\n\n\n\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zYW1wd29vZC5naXRodWIuaW8vMjAxOC8xMC8xNy92cHMtZ2l0LXJlcG8tbmd4aW4tZ2l0LWhvb2s=\">https://sampwood.github.io/2018/10/17/vps-git-repo-ngxin-git-hook<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3llYXJpdG8uY24vcG9zdHMvaGV4by1kZXBsb3ktdG8tVlBTLmh0bWw=\">http://yearito.cn/posts/hexo-deploy-to-VPS.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"sh of testing performance on VPS","_content":"\n# Superbench\n\n```sh\nwget -N --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh\nsudo bash superbench.sh\n# or\ncurl -Lso- https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash\n```\n\n# Lemonbench\n\n```sh\ncurl -fsL https://ilemonra.in/LemonBenchIntl | bash -s fast\ncurl -fsL https://ilemonra.in/LemonBenchIntl | bash -s full\n```\n\n# Zench\n\n```sh\nwget -N --no-check-certificate https://raw.githubusercontent.com/FunctionClub/ZBench/master/ZBench-CN.sh\nsudo bash ZBench-CN.sh\n```\n\n# Superspeed\n\n```sh\nwget https://raw.githubusercontent.com/oooldking/script/master/superspeed.sh\nchmod +x superspeed.sh\nsudo ./superspeed.sh\n```\n\n\n\n\n\n----\n\nReference\n\nhttps://blog.zeruns.tech/archives/533.html","source":"_posts/vps/performance.md","raw":"---\ntitle: sh of testing performance on VPS\ncategories: \n- VPS\ntags: \n- sh\n- linux\n---\n\n# Superbench\n\n```sh\nwget -N --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh\nsudo bash superbench.sh\n# or\ncurl -Lso- https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash\n```\n\n# Lemonbench\n\n```sh\ncurl -fsL https://ilemonra.in/LemonBenchIntl | bash -s fast\ncurl -fsL https://ilemonra.in/LemonBenchIntl | bash -s full\n```\n\n# Zench\n\n```sh\nwget -N --no-check-certificate https://raw.githubusercontent.com/FunctionClub/ZBench/master/ZBench-CN.sh\nsudo bash ZBench-CN.sh\n```\n\n# Superspeed\n\n```sh\nwget https://raw.githubusercontent.com/oooldking/script/master/superspeed.sh\nchmod +x superspeed.sh\nsudo ./superspeed.sh\n```\n\n\n\n\n\n----\n\nReference\n\nhttps://blog.zeruns.tech/archives/533.html","slug":"vps/performance","published":1,"date":"2021-10-08T16:57:37.259Z","updated":"2021-10-09T04:20:55.505Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983l00gy018oeb1b2324","content":"<h1 id=\"Superbench\"><a href=\"#Superbench\" class=\"headerlink\" title=\"Superbench\"></a>Superbench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -N --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh</span><br><span class=\"line\">sudo bash superbench.sh</span><br><span class=\"line\"><span class=\"comment\"># or</span></span><br><span class=\"line\">curl -Lso- https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Lemonbench\"><a href=\"#Lemonbench\" class=\"headerlink\" title=\"Lemonbench\"></a>Lemonbench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -fsL https://ilemonra.in/LemonBenchIntl | bash -s fast</span><br><span class=\"line\">curl -fsL https://ilemonra.in/LemonBenchIntl | bash -s full</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Zench\"><a href=\"#Zench\" class=\"headerlink\" title=\"Zench\"></a>Zench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -N --no-check-certificate https://raw.githubusercontent.com/FunctionClub/ZBench/master/ZBench-CN.sh</span><br><span class=\"line\">sudo bash ZBench-CN.sh</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Superspeed\"><a href=\"#Superspeed\" class=\"headerlink\" title=\"Superspeed\"></a>Superspeed</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://raw.githubusercontent.com/oooldking/script/master/superspeed.sh</span><br><span class=\"line\">chmod +x superspeed.sh</span><br><span class=\"line\">sudo ./superspeed.sh</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLnplcnVucy50ZWNoL2FyY2hpdmVzLzUzMy5odG1s\">https://blog.zeruns.tech/archives/533.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Superbench\"><a href=\"#Superbench\" class=\"headerlink\" title=\"Superbench\"></a>Superbench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -N --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh</span><br><span class=\"line\">sudo bash superbench.sh</span><br><span class=\"line\"><span class=\"comment\"># or</span></span><br><span class=\"line\">curl -Lso- https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Lemonbench\"><a href=\"#Lemonbench\" class=\"headerlink\" title=\"Lemonbench\"></a>Lemonbench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -fsL https://ilemonra.in/LemonBenchIntl | bash -s fast</span><br><span class=\"line\">curl -fsL https://ilemonra.in/LemonBenchIntl | bash -s full</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Zench\"><a href=\"#Zench\" class=\"headerlink\" title=\"Zench\"></a>Zench</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -N --no-check-certificate https://raw.githubusercontent.com/FunctionClub/ZBench/master/ZBench-CN.sh</span><br><span class=\"line\">sudo bash ZBench-CN.sh</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Superspeed\"><a href=\"#Superspeed\" class=\"headerlink\" title=\"Superspeed\"></a>Superspeed</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://raw.githubusercontent.com/oooldking/script/master/superspeed.sh</span><br><span class=\"line\">chmod +x superspeed.sh</span><br><span class=\"line\">sudo ./superspeed.sh</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLnplcnVucy50ZWNoL2FyY2hpdmVzLzUzMy5odG1s\">https://blog.zeruns.tech/archives/533.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"x-ui for v2ray via docker","_content":"\n# docker image\n\n```sh\ndocker pull thesadboy/x-ui\n```\n\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  xui:\n    image: thesadboy/x-ui\n    restart: always\n    volumes:\n     - /sys/fs/cgroup:/sys/fs/cgroup:ro\n     - ./config:/etc/x-ui\n    ports:\n     - 2000:54321\n     - 8000-8010:8000-8010/tcp\n     - 8000-8010:8000-8010/udp\n    tmpfs:\n     - /tmp\n     - /run\n     - /run/lock\n```\n\n","source":"_posts/vps/v2ray-xui.md","raw":"---\ntitle: x-ui for v2ray via docker\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- docker\n- v2ray\n- x-ui\n---\n\n# docker image\n\n```sh\ndocker pull thesadboy/x-ui\n```\n\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  xui:\n    image: thesadboy/x-ui\n    restart: always\n    volumes:\n     - /sys/fs/cgroup:/sys/fs/cgroup:ro\n     - ./config:/etc/x-ui\n    ports:\n     - 2000:54321\n     - 8000-8010:8000-8010/tcp\n     - 8000-8010:8000-8010/udp\n    tmpfs:\n     - /tmp\n     - /run\n     - /run/lock\n```\n\n","slug":"vps/v2ray-xui","published":1,"date":"2021-10-09T08:32:50.461Z","updated":"2021-10-09T16:12:54.088Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983m00h1018o80vf7x12","content":"<h1 id=\"docker-image\"><a href=\"#docker-image\" class=\"headerlink\" title=\"docker image\"></a>docker image</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull thesadboy/x-ui</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">xui:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">thesadboy/x-ui</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/sys/fs/cgroup:/sys/fs/cgroup:ro</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/x-ui</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">2000</span><span class=\"string\">:54321</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">8000</span><span class=\"number\">-8010</span><span class=\"string\">:8000-8010/tcp</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">8000</span><span class=\"number\">-8010</span><span class=\"string\">:8000-8010/udp</span></span><br><span class=\"line\">    <span class=\"attr\">tmpfs:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/tmp</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/run</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/run/lock</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker-image\"><a href=\"#docker-image\" class=\"headerlink\" title=\"docker image\"></a>docker image</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull thesadboy/x-ui</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">xui:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">thesadboy/x-ui</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/sys/fs/cgroup:/sys/fs/cgroup:ro</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/x-ui</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">2000</span><span class=\"string\">:54321</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">8000</span><span class=\"number\">-8010</span><span class=\"string\">:8000-8010/tcp</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">8000</span><span class=\"number\">-8010</span><span class=\"string\">:8000-8010/udp</span></span><br><span class=\"line\">    <span class=\"attr\">tmpfs:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/tmp</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/run</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">/run/lock</span></span><br></pre></td></tr></table></figure>\n\n"},{"_content":"# TLS\n从 v1.19 起引入了 TLS，TLS 中文译名是传输层安全，如果你没听说过，请 Google 了解一下。以下给出些我认为介绍较好的文章链接：\n\nSSL/TLS 协议运行机制的概述\n\n传输层安全协议\n\n# 注册一个域名\n如果已经注册有域名了可以跳过。 TLS 需要一个域名，域名有免费的和有付费的，如果你不舍得为一个域名每年花点钱，用个免费域名也可以，但总体来说付费的会优于免费的。为了方便，在本文中我就忽略如何注册购买域名了。关于如何获取域名，具体搜索相关文章教程。\n\n注册好域名之后务必记得添加一个 A 记录指向你的 VPS!\n\n以下假设注册的域名为 mydomain.me，请将之替换成自己的域名。\n\n# 证书生成\nTLS 是证书认证机制，所以使用 TLS 需要证书，证书也有免费付费的，同样的这里使用免费证书，证书认证机构为 Let's Encrypt。 证书的生成有许多方法，这里使用的是比较简单的方法：使用 acme.sh 脚本生成，本部分说明部分内容参考于acme.sh README。\n\n证书有两种，一种是 ECC 证书（内置公钥是 ECDSA 公钥），一种是 RSA 证书（内置 RSA 公钥）。简单来说，同等长度 ECC 比 RSA 更安全,也就是说在具有同样安全性的情况下，ECC 的密钥长度比 RSA 短得多（加密解密会更快）。但问题是 ECC 的兼容性会差一些，Android 4.x 以下和 Windows XP 不支持。只要您的设备不是非常老的老古董，建议使用 ECC 证书。\n\n以下将给出这两类证书的生成方法，请大家根据自身的情况自行选择其中一种证书类型。\n\n证书生成只需在服务器上操作。\n\n# 安装 acme.sh\n执行以下命令，acme.sh 会安装到 ~/.acme.sh 目录下。\n\n```bash\n$ curl  https://get.acme.sh | sh\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                               Dload  Upload   Total   Spent    Left  Speed\n100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                               Dload  Upload   Total   Spent    Left  Speed\n100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k\n\n[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.\n[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz\n[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz\n[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installing alias to '/home/user/.profile'\n[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job\nno crontab for user\nno crontab for user\n[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.\n[Fri 30 Dec 01:03:33 GMT 2016] OK\n[Fri 30 Dec 01:03:33 GMT 2016] Install success!\n```\n\n安装成功后执行 `source ~/.bashrc` 以确保脚本所设置的命令别名生效。\n\n如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:\n\n`$ sudo apt-get install openssl cron socat curl`\n# 使用 acme.sh 生成证书\n# 证书生成\n执行以下命令生成证书：\n\n以下的命令会临时监听 80 端口，请确保执行该命令前 80 端口没有使用\n```shell script\n\n\n$ sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256\n[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.\n[Fri Dec 30 08:59:12 HKT 2016] Single domain='mydomain.me'\n[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token for each domain\n[Fri Dec 30 08:59:12 HKT 2016] Getting webroot for domain='mydomain.me'\n[Fri Dec 30 08:59:12 HKT 2016] _w='no'\n[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz for domain='mydomain.me'\n[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.\n[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.\n[Fri Dec 30 08:59:16 HKT 2016] Cert success.\n-----BEGIN CERTIFICATE-----\nMIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA\nMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD\nExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x\nNzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49\n****************************************************************\n4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9\n+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40\nzweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2\nVAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9\ngPUI45eltrjcv8FCSTOUcT7PWCa3\n-----END CERTIFICATE-----\n[Fri Dec 30 08:59:16 HKT 2016] Your cert is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer\n[Fri Dec 30 08:59:16 HKT 2016] Your cert key is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key\n[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is in  /root/.acme.sh/mydomain.me_ecc/ca.cer\n[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer\n```\n`-k` 表示密钥长度，后面的值可以是 `ec-256` 、`ec-384`、`2048`、`3072`、`4096`、`8192`，带有 `ec` 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书。\n\n#证书更新\n由于 Let's Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。\n\n手动更新 ECC 证书，执行：\n\n`$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc`\n如果是 RSA 证书则执行：\n\n`$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force`\n由于本例中将证书生成到 /etc/v2ray/ 文件夹，更新证书之后还得把新证书生成到 /etc/v2ray。\n\n#安装证书和密钥\n#ECC 证书\n将证书和密钥安装到 /etc/v2ray 中：\n\n`$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc`\n#RSA 证书\n`$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key`\n注意：无论什么情况，密钥(即上面的 v2ray.key)都不能泄漏，如果你不幸泄漏了密钥，可以使用 acme.sh 将原证书吊销，再生成新的证书，吊销方法请自行参考 acme.sh 的手册\n\n#配置 V2Ray\n#服务器\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 443, // 建议使用 443 端口\n      \"protocol\": \"vmess\",    \n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",  \n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\", // security 要设置为 tls 才会启用 TLS\n        \"tlsSettings\": {\n          \"certificates\": [\n            {\n              \"certificateFile\": \"/etc/v2ray/v2ray.crt\", // 证书文件\n              \"keyFile\": \"/etc/v2ray/v2ray.key\" // 密钥文件\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n#客户端\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 1080,\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\"http\", \"tls\"]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\"\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \"mydomain.me\", // tls 需要域名，所以这里应该填自己的域名\n            \"port\": 443,\n            \"users\": [\n              {\n                \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",\n                \"alterId\": 64\n              }\n            ]\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\" // 客户端的 security 也要设置为 tls\n      }\n    }\n  ]\n}\n```\n#验证\n一般来说，按照以上步骤操作完成，V2Ray 客户端能够正常联网说明 TLS 已经成功启用。但要是有个可靠的方法来验证是否正常开启 TLS 无疑更令人放心。 验证的方法有很多，我仅介绍一种小白化一点的，便是 Qualys SSL Labs's SSL Server Test。\n\n注意：使用 Qualys SSL Labs's SSL Server Test 要求使用 443 端口，意味着你服务器配置的 inbound.port 应当是 443\n\n打开 Qualys SSL Labs's SSL Server Test，在 Hostname 中输入你的域名，点提交，过一会结果就出来了。 \n\n 这是对于你的 TLS/SSL 的一个总体评分，我这里评分为 A，看来还不错。有这样的界面算是成功了。\n\n 这是关于证书的信息。从图中可以看出，我的这个证书有效期是从 2016 年 12 月 27 号到 2017 年的 3 月 27 号，密钥是 256 位的 ECC，证书签发机构是 Let's Encrypt，重要的是最后一行，Trusted 为 Yes，表明我这个证书可信。\n\n#温馨提醒\nV2Ray 的 TLS 不是伪装或混淆，这是完整、真正的 TLS。因此才需要域名和证书。后文提到的 WS(WebSocket) 也不是伪装。","source":"_posts/v2ray/v2ray-tls.md","raw":"# TLS\n从 v1.19 起引入了 TLS，TLS 中文译名是传输层安全，如果你没听说过，请 Google 了解一下。以下给出些我认为介绍较好的文章链接：\n\nSSL/TLS 协议运行机制的概述\n\n传输层安全协议\n\n# 注册一个域名\n如果已经注册有域名了可以跳过。 TLS 需要一个域名，域名有免费的和有付费的，如果你不舍得为一个域名每年花点钱，用个免费域名也可以，但总体来说付费的会优于免费的。为了方便，在本文中我就忽略如何注册购买域名了。关于如何获取域名，具体搜索相关文章教程。\n\n注册好域名之后务必记得添加一个 A 记录指向你的 VPS!\n\n以下假设注册的域名为 mydomain.me，请将之替换成自己的域名。\n\n# 证书生成\nTLS 是证书认证机制，所以使用 TLS 需要证书，证书也有免费付费的，同样的这里使用免费证书，证书认证机构为 Let's Encrypt。 证书的生成有许多方法，这里使用的是比较简单的方法：使用 acme.sh 脚本生成，本部分说明部分内容参考于acme.sh README。\n\n证书有两种，一种是 ECC 证书（内置公钥是 ECDSA 公钥），一种是 RSA 证书（内置 RSA 公钥）。简单来说，同等长度 ECC 比 RSA 更安全,也就是说在具有同样安全性的情况下，ECC 的密钥长度比 RSA 短得多（加密解密会更快）。但问题是 ECC 的兼容性会差一些，Android 4.x 以下和 Windows XP 不支持。只要您的设备不是非常老的老古董，建议使用 ECC 证书。\n\n以下将给出这两类证书的生成方法，请大家根据自身的情况自行选择其中一种证书类型。\n\n证书生成只需在服务器上操作。\n\n# 安装 acme.sh\n执行以下命令，acme.sh 会安装到 ~/.acme.sh 目录下。\n\n```bash\n$ curl  https://get.acme.sh | sh\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                               Dload  Upload   Total   Spent    Left  Speed\n100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679\n% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                               Dload  Upload   Total   Spent    Left  Speed\n100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k\n\n[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.\n[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz\n[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz\n[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installing alias to '/home/user/.profile'\n[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh\n[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job\nno crontab for user\nno crontab for user\n[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.\n[Fri 30 Dec 01:03:33 GMT 2016] OK\n[Fri 30 Dec 01:03:33 GMT 2016] Install success!\n```\n\n安装成功后执行 `source ~/.bashrc` 以确保脚本所设置的命令别名生效。\n\n如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:\n\n`$ sudo apt-get install openssl cron socat curl`\n# 使用 acme.sh 生成证书\n# 证书生成\n执行以下命令生成证书：\n\n以下的命令会临时监听 80 端口，请确保执行该命令前 80 端口没有使用\n```shell script\n\n\n$ sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256\n[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.\n[Fri Dec 30 08:59:12 HKT 2016] Single domain='mydomain.me'\n[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token for each domain\n[Fri Dec 30 08:59:12 HKT 2016] Getting webroot for domain='mydomain.me'\n[Fri Dec 30 08:59:12 HKT 2016] _w='no'\n[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz for domain='mydomain.me'\n[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.\n[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.\n[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.\n[Fri Dec 30 08:59:16 HKT 2016] Cert success.\n-----BEGIN CERTIFICATE-----\nMIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA\nMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD\nExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x\nNzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49\n****************************************************************\n4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9\n+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40\nzweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2\nVAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9\ngPUI45eltrjcv8FCSTOUcT7PWCa3\n-----END CERTIFICATE-----\n[Fri Dec 30 08:59:16 HKT 2016] Your cert is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer\n[Fri Dec 30 08:59:16 HKT 2016] Your cert key is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key\n[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is in  /root/.acme.sh/mydomain.me_ecc/ca.cer\n[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer\n```\n`-k` 表示密钥长度，后面的值可以是 `ec-256` 、`ec-384`、`2048`、`3072`、`4096`、`8192`，带有 `ec` 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书。\n\n#证书更新\n由于 Let's Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。\n\n手动更新 ECC 证书，执行：\n\n`$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc`\n如果是 RSA 证书则执行：\n\n`$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force`\n由于本例中将证书生成到 /etc/v2ray/ 文件夹，更新证书之后还得把新证书生成到 /etc/v2ray。\n\n#安装证书和密钥\n#ECC 证书\n将证书和密钥安装到 /etc/v2ray 中：\n\n`$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc`\n#RSA 证书\n`$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key`\n注意：无论什么情况，密钥(即上面的 v2ray.key)都不能泄漏，如果你不幸泄漏了密钥，可以使用 acme.sh 将原证书吊销，再生成新的证书，吊销方法请自行参考 acme.sh 的手册\n\n#配置 V2Ray\n#服务器\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 443, // 建议使用 443 端口\n      \"protocol\": \"vmess\",    \n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",  \n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\", // security 要设置为 tls 才会启用 TLS\n        \"tlsSettings\": {\n          \"certificates\": [\n            {\n              \"certificateFile\": \"/etc/v2ray/v2ray.crt\", // 证书文件\n              \"keyFile\": \"/etc/v2ray/v2ray.key\" // 密钥文件\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n#客户端\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 1080,\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\"http\", \"tls\"]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\"\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \"mydomain.me\", // tls 需要域名，所以这里应该填自己的域名\n            \"port\": 443,\n            \"users\": [\n              {\n                \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",\n                \"alterId\": 64\n              }\n            ]\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\" // 客户端的 security 也要设置为 tls\n      }\n    }\n  ]\n}\n```\n#验证\n一般来说，按照以上步骤操作完成，V2Ray 客户端能够正常联网说明 TLS 已经成功启用。但要是有个可靠的方法来验证是否正常开启 TLS 无疑更令人放心。 验证的方法有很多，我仅介绍一种小白化一点的，便是 Qualys SSL Labs's SSL Server Test。\n\n注意：使用 Qualys SSL Labs's SSL Server Test 要求使用 443 端口，意味着你服务器配置的 inbound.port 应当是 443\n\n打开 Qualys SSL Labs's SSL Server Test，在 Hostname 中输入你的域名，点提交，过一会结果就出来了。 \n\n 这是对于你的 TLS/SSL 的一个总体评分，我这里评分为 A，看来还不错。有这样的界面算是成功了。\n\n 这是关于证书的信息。从图中可以看出，我的这个证书有效期是从 2016 年 12 月 27 号到 2017 年的 3 月 27 号，密钥是 256 位的 ECC，证书签发机构是 Let's Encrypt，重要的是最后一行，Trusted 为 Yes，表明我这个证书可信。\n\n#温馨提醒\nV2Ray 的 TLS 不是伪装或混淆，这是完整、真正的 TLS。因此才需要域名和证书。后文提到的 WS(WebSocket) 也不是伪装。","slug":"v2ray/v2ray-tls","published":1,"date":"2020-03-29T18:33:16.292Z","updated":"2020-03-29T18:38:29.021Z","title":"v2ray/v2ray-tls","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983n00h5018obm3890nn","content":"<h1 id=\"TLS\"><a href=\"#TLS\" class=\"headerlink\" title=\"TLS\"></a>TLS</h1><p>从 v1.19 起引入了 TLS，TLS 中文译名是传输层安全，如果你没听说过，请 Google 了解一下。以下给出些我认为介绍较好的文章链接：</p>\n<p>SSL/TLS 协议运行机制的概述</p>\n<p>传输层安全协议</p>\n<h1 id=\"注册一个域名\"><a href=\"#注册一个域名\" class=\"headerlink\" title=\"注册一个域名\"></a>注册一个域名</h1><p>如果已经注册有域名了可以跳过。 TLS 需要一个域名，域名有免费的和有付费的，如果你不舍得为一个域名每年花点钱，用个免费域名也可以，但总体来说付费的会优于免费的。为了方便，在本文中我就忽略如何注册购买域名了。关于如何获取域名，具体搜索相关文章教程。</p>\n<p>注册好域名之后务必记得添加一个 A 记录指向你的 VPS!</p>\n<p>以下假设注册的域名为 mydomain.me，请将之替换成自己的域名。</p>\n<h1 id=\"证书生成\"><a href=\"#证书生成\" class=\"headerlink\" title=\"证书生成\"></a>证书生成</h1><p>TLS 是证书认证机制，所以使用 TLS 需要证书，证书也有免费付费的，同样的这里使用免费证书，证书认证机构为 Let’s Encrypt。 证书的生成有许多方法，这里使用的是比较简单的方法：使用 acme.sh 脚本生成，本部分说明部分内容参考于acme.sh README。</p>\n<p>证书有两种，一种是 ECC 证书（内置公钥是 ECDSA 公钥），一种是 RSA 证书（内置 RSA 公钥）。简单来说，同等长度 ECC 比 RSA 更安全,也就是说在具有同样安全性的情况下，ECC 的密钥长度比 RSA 短得多（加密解密会更快）。但问题是 ECC 的兼容性会差一些，Android 4.x 以下和 Windows XP 不支持。只要您的设备不是非常老的老古董，建议使用 ECC 证书。</p>\n<p>以下将给出这两类证书的生成方法，请大家根据自身的情况自行选择其中一种证书类型。</p>\n<p>证书生成只需在服务器上操作。</p>\n<h1 id=\"安装-acme-sh\"><a href=\"#安装-acme-sh\" class=\"headerlink\" title=\"安装 acme.sh\"></a>安装 acme.sh</h1><p>执行以下命令，acme.sh 会安装到 ~/.acme.sh 目录下。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl  https://get.acme.sh | sh</span><br><span class=\"line\">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class=\"line\">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class=\"line\">100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679</span><br><span class=\"line\">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class=\"line\">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class=\"line\">100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k</span><br><span class=\"line\"></span><br><span class=\"line\">[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.</span><br><span class=\"line\">[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing <span class=\"built_in\">alias</span> to <span class=\"string\">'/home/user/.profile'</span></span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job</span><br><span class=\"line\">no crontab <span class=\"keyword\">for</span> user</span><br><span class=\"line\">no crontab <span class=\"keyword\">for</span> user</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] OK</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Install success!</span><br></pre></td></tr></table></figure>\n\n<p>安装成功后执行 <code>source ~/.bashrc</code> 以确保脚本所设置的命令别名生效。</p>\n<p>如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:</p>\n<p><code>$ sudo apt-get install openssl cron socat curl</code></p>\n<h1 id=\"使用-acme-sh-生成证书\"><a href=\"#使用-acme-sh-生成证书\" class=\"headerlink\" title=\"使用 acme.sh 生成证书\"></a>使用 acme.sh 生成证书</h1><h1 id=\"证书生成-1\"><a href=\"#证书生成-1\" class=\"headerlink\" title=\"证书生成\"></a>证书生成</h1><p>执行以下命令生成证书：</p>\n<p>以下的命令会临时监听 80 端口，请确保执行该命令前 80 端口没有使用</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256</span></span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Single domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token for each domain</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting webroot for domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] _w='no'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz for domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Cert success.</span><br><span class=\"line\">-----BEGIN CERTIFICATE-----</span><br><span class=\"line\">MIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA</span><br><span class=\"line\">MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD</span><br><span class=\"line\">ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x</span><br><span class=\"line\">NzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49</span><br><span class=\"line\">****************************************************************</span><br><span class=\"line\">4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9</span><br><span class=\"line\">+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40</span><br><span class=\"line\">zweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2</span><br><span class=\"line\">VAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9</span><br><span class=\"line\">gPUI45eltrjcv8FCSTOUcT7PWCa3</span><br><span class=\"line\">-----END CERTIFICATE-----</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Your cert is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Your cert key is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is in  /root/.acme.sh/mydomain.me_ecc/ca.cer</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer</span><br></pre></td></tr></table></figure>\n<p><code>-k</code> 表示密钥长度，后面的值可以是 <code>ec-256</code> 、<code>ec-384</code>、<code>2048</code>、<code>3072</code>、<code>4096</code>、<code>8192</code>，带有 <code>ec</code> 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书。</p>\n<p>#证书更新<br>由于 Let’s Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。</p>\n<p>手动更新 ECC 证书，执行：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc</code><br>如果是 RSA 证书则执行：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force</code><br>由于本例中将证书生成到 /etc/v2ray/ 文件夹，更新证书之后还得把新证书生成到 /etc/v2ray。</p>\n<p>#安装证书和密钥<br>#ECC 证书<br>将证书和密钥安装到 /etc/v2ray 中：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc</code><br>#RSA 证书<br><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key</code><br>注意：无论什么情况，密钥(即上面的 v2ray.key)都不能泄漏，如果你不幸泄漏了密钥，可以使用 acme.sh 将原证书吊销，再生成新的证书，吊销方法请自行参考 acme.sh 的手册</p>\n<p>#配置 V2Ray<br>#服务器</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>, <span class=\"comment\">// 建议使用 443 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,    </span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,  </span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>, <span class=\"comment\">// security 要设置为 tls 才会启用 TLS</span></span><br><span class=\"line\">        <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"certificates\"</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              <span class=\"attr\">\"certificateFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.crt\"</span>, <span class=\"comment\">// 证书文件</span></span><br><span class=\"line\">              <span class=\"attr\">\"keyFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.key\"</span> <span class=\"comment\">// 密钥文件</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#客户端</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"socks\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sniffing\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"destOverride\"</span>: [<span class=\"string\">\"http\"</span>, <span class=\"string\">\"tls\"</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"auth\"</span>: <span class=\"string\">\"noauth\"</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"vnext\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"address\"</span>: <span class=\"string\">\"mydomain.me\"</span>, <span class=\"comment\">// tls 需要域名，所以这里应该填自己的域名</span></span><br><span class=\"line\">            <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"users\"</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span> <span class=\"comment\">// 客户端的 security 也要设置为 tls</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#验证<br>一般来说，按照以上步骤操作完成，V2Ray 客户端能够正常联网说明 TLS 已经成功启用。但要是有个可靠的方法来验证是否正常开启 TLS 无疑更令人放心。 验证的方法有很多，我仅介绍一种小白化一点的，便是 Qualys SSL Labs’s SSL Server Test。</p>\n<p>注意：使用 Qualys SSL Labs’s SSL Server Test 要求使用 443 端口，意味着你服务器配置的 inbound.port 应当是 443</p>\n<p>打开 Qualys SSL Labs’s SSL Server Test，在 Hostname 中输入你的域名，点提交，过一会结果就出来了。 </p>\n<p> 这是对于你的 TLS/SSL 的一个总体评分，我这里评分为 A，看来还不错。有这样的界面算是成功了。</p>\n<p> 这是关于证书的信息。从图中可以看出，我的这个证书有效期是从 2016 年 12 月 27 号到 2017 年的 3 月 27 号，密钥是 256 位的 ECC，证书签发机构是 Let’s Encrypt，重要的是最后一行，Trusted 为 Yes，表明我这个证书可信。</p>\n<p>#温馨提醒<br>V2Ray 的 TLS 不是伪装或混淆，这是完整、真正的 TLS。因此才需要域名和证书。后文提到的 WS(WebSocket) 也不是伪装。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"TLS\"><a href=\"#TLS\" class=\"headerlink\" title=\"TLS\"></a>TLS</h1><p>从 v1.19 起引入了 TLS，TLS 中文译名是传输层安全，如果你没听说过，请 Google 了解一下。以下给出些我认为介绍较好的文章链接：</p>\n<p>SSL/TLS 协议运行机制的概述</p>\n<p>传输层安全协议</p>\n<h1 id=\"注册一个域名\"><a href=\"#注册一个域名\" class=\"headerlink\" title=\"注册一个域名\"></a>注册一个域名</h1><p>如果已经注册有域名了可以跳过。 TLS 需要一个域名，域名有免费的和有付费的，如果你不舍得为一个域名每年花点钱，用个免费域名也可以，但总体来说付费的会优于免费的。为了方便，在本文中我就忽略如何注册购买域名了。关于如何获取域名，具体搜索相关文章教程。</p>\n<p>注册好域名之后务必记得添加一个 A 记录指向你的 VPS!</p>\n<p>以下假设注册的域名为 mydomain.me，请将之替换成自己的域名。</p>\n<h1 id=\"证书生成\"><a href=\"#证书生成\" class=\"headerlink\" title=\"证书生成\"></a>证书生成</h1><p>TLS 是证书认证机制，所以使用 TLS 需要证书，证书也有免费付费的，同样的这里使用免费证书，证书认证机构为 Let’s Encrypt。 证书的生成有许多方法，这里使用的是比较简单的方法：使用 acme.sh 脚本生成，本部分说明部分内容参考于acme.sh README。</p>\n<p>证书有两种，一种是 ECC 证书（内置公钥是 ECDSA 公钥），一种是 RSA 证书（内置 RSA 公钥）。简单来说，同等长度 ECC 比 RSA 更安全,也就是说在具有同样安全性的情况下，ECC 的密钥长度比 RSA 短得多（加密解密会更快）。但问题是 ECC 的兼容性会差一些，Android 4.x 以下和 Windows XP 不支持。只要您的设备不是非常老的老古董，建议使用 ECC 证书。</p>\n<p>以下将给出这两类证书的生成方法，请大家根据自身的情况自行选择其中一种证书类型。</p>\n<p>证书生成只需在服务器上操作。</p>\n<h1 id=\"安装-acme-sh\"><a href=\"#安装-acme-sh\" class=\"headerlink\" title=\"安装 acme.sh\"></a>安装 acme.sh</h1><p>执行以下命令，acme.sh 会安装到 ~/.acme.sh 目录下。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl  https://get.acme.sh | sh</span><br><span class=\"line\">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class=\"line\">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class=\"line\">100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679</span><br><span class=\"line\">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class=\"line\">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class=\"line\">100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k</span><br><span class=\"line\"></span><br><span class=\"line\">[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.</span><br><span class=\"line\">[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing <span class=\"built_in\">alias</span> to <span class=\"string\">'/home/user/.profile'</span></span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job</span><br><span class=\"line\">no crontab <span class=\"keyword\">for</span> user</span><br><span class=\"line\">no crontab <span class=\"keyword\">for</span> user</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] OK</span><br><span class=\"line\">[Fri 30 Dec 01:03:33 GMT 2016] Install success!</span><br></pre></td></tr></table></figure>\n\n<p>安装成功后执行 <code>source ~/.bashrc</code> 以确保脚本所设置的命令别名生效。</p>\n<p>如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:</p>\n<p><code>$ sudo apt-get install openssl cron socat curl</code></p>\n<h1 id=\"使用-acme-sh-生成证书\"><a href=\"#使用-acme-sh-生成证书\" class=\"headerlink\" title=\"使用 acme.sh 生成证书\"></a>使用 acme.sh 生成证书</h1><h1 id=\"证书生成-1\"><a href=\"#证书生成-1\" class=\"headerlink\" title=\"证书生成\"></a>证书生成</h1><p>执行以下命令生成证书：</p>\n<p>以下的命令会临时监听 80 端口，请确保执行该命令前 80 端口没有使用</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256</span></span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Single domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token for each domain</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting webroot for domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] _w='no'</span><br><span class=\"line\">[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz for domain='mydomain.me'</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class=\"line\">[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Cert success.</span><br><span class=\"line\">-----BEGIN CERTIFICATE-----</span><br><span class=\"line\">MIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA</span><br><span class=\"line\">MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD</span><br><span class=\"line\">ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x</span><br><span class=\"line\">NzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49</span><br><span class=\"line\">****************************************************************</span><br><span class=\"line\">4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9</span><br><span class=\"line\">+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40</span><br><span class=\"line\">zweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2</span><br><span class=\"line\">VAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9</span><br><span class=\"line\">gPUI45eltrjcv8FCSTOUcT7PWCa3</span><br><span class=\"line\">-----END CERTIFICATE-----</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Your cert is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] Your cert key is in  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is in  /root/.acme.sh/mydomain.me_ecc/ca.cer</span><br><span class=\"line\">[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer</span><br></pre></td></tr></table></figure>\n<p><code>-k</code> 表示密钥长度，后面的值可以是 <code>ec-256</code> 、<code>ec-384</code>、<code>2048</code>、<code>3072</code>、<code>4096</code>、<code>8192</code>，带有 <code>ec</code> 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书。</p>\n<p>#证书更新<br>由于 Let’s Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。</p>\n<p>手动更新 ECC 证书，执行：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc</code><br>如果是 RSA 证书则执行：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force</code><br>由于本例中将证书生成到 /etc/v2ray/ 文件夹，更新证书之后还得把新证书生成到 /etc/v2ray。</p>\n<p>#安装证书和密钥<br>#ECC 证书<br>将证书和密钥安装到 /etc/v2ray 中：</p>\n<p><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc</code><br>#RSA 证书<br><code>$ sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key</code><br>注意：无论什么情况，密钥(即上面的 v2ray.key)都不能泄漏，如果你不幸泄漏了密钥，可以使用 acme.sh 将原证书吊销，再生成新的证书，吊销方法请自行参考 acme.sh 的手册</p>\n<p>#配置 V2Ray<br>#服务器</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>, <span class=\"comment\">// 建议使用 443 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,    </span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,  </span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>, <span class=\"comment\">// security 要设置为 tls 才会启用 TLS</span></span><br><span class=\"line\">        <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"certificates\"</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              <span class=\"attr\">\"certificateFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.crt\"</span>, <span class=\"comment\">// 证书文件</span></span><br><span class=\"line\">              <span class=\"attr\">\"keyFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.key\"</span> <span class=\"comment\">// 密钥文件</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#客户端</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"socks\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sniffing\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"destOverride\"</span>: [<span class=\"string\">\"http\"</span>, <span class=\"string\">\"tls\"</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"auth\"</span>: <span class=\"string\">\"noauth\"</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"vnext\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"address\"</span>: <span class=\"string\">\"mydomain.me\"</span>, <span class=\"comment\">// tls 需要域名，所以这里应该填自己的域名</span></span><br><span class=\"line\">            <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"users\"</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span> <span class=\"comment\">// 客户端的 security 也要设置为 tls</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#验证<br>一般来说，按照以上步骤操作完成，V2Ray 客户端能够正常联网说明 TLS 已经成功启用。但要是有个可靠的方法来验证是否正常开启 TLS 无疑更令人放心。 验证的方法有很多，我仅介绍一种小白化一点的，便是 Qualys SSL Labs’s SSL Server Test。</p>\n<p>注意：使用 Qualys SSL Labs’s SSL Server Test 要求使用 443 端口，意味着你服务器配置的 inbound.port 应当是 443</p>\n<p>打开 Qualys SSL Labs’s SSL Server Test，在 Hostname 中输入你的域名，点提交，过一会结果就出来了。 </p>\n<p> 这是对于你的 TLS/SSL 的一个总体评分，我这里评分为 A，看来还不错。有这样的界面算是成功了。</p>\n<p> 这是关于证书的信息。从图中可以看出，我的这个证书有效期是从 2016 年 12 月 27 号到 2017 年的 3 月 27 号，密钥是 256 位的 ECC，证书签发机构是 Let’s Encrypt，重要的是最后一行，Trusted 为 Yes，表明我这个证书可信。</p>\n<p>#温馨提醒<br>V2Ray 的 TLS 不是伪装或混淆，这是完整、真正的 TLS。因此才需要域名和证书。后文提到的 WS(WebSocket) 也不是伪装。</p>\n"},{"title":"lite v2ray via docker","_content":"\n# docker image\n\n```sh\ndocker pull teddysun/v2ray\n```\n\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  v2ray:\n    image: teddysun/v2ray\n    restart: always\n    volumes:\n     - ./config:/etc/v2ray\n    ports:\n     - 9000:9000\n```\n\n# config.json\n\n```json\n{\n  \"inbounds\": [{\n    \"port\": 9000,\n    \"protocol\": \"vmess\",\n    \"settings\": {\n      \"clients\": [\n        {\n          \"id\": \"100xxxxx-xxxx-xxxx-xxxx-00xxxxxxxxxx\",\n          \"level\": 1,\n          \"alterId\": 64\n        }\n      ]\n    }\n  }],\n  \"outbounds\": [{\n    \"protocol\": \"freedom\",\n    \"settings\": {}\n  }]\n}\n```\n\n","source":"_posts/vps/v2ray-lite.md","raw":"---\ntitle: lite v2ray via docker\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- docker\n- v2ray\n---\n\n# docker image\n\n```sh\ndocker pull teddysun/v2ray\n```\n\n# docker compose\n\n```yaml\nversion: '3.9'\n\nservices:\n  v2ray:\n    image: teddysun/v2ray\n    restart: always\n    volumes:\n     - ./config:/etc/v2ray\n    ports:\n     - 9000:9000\n```\n\n# config.json\n\n```json\n{\n  \"inbounds\": [{\n    \"port\": 9000,\n    \"protocol\": \"vmess\",\n    \"settings\": {\n      \"clients\": [\n        {\n          \"id\": \"100xxxxx-xxxx-xxxx-xxxx-00xxxxxxxxxx\",\n          \"level\": 1,\n          \"alterId\": 64\n        }\n      ]\n    }\n  }],\n  \"outbounds\": [{\n    \"protocol\": \"freedom\",\n    \"settings\": {}\n  }]\n}\n```\n\n","slug":"vps/v2ray-lite","published":1,"date":"2021-10-09T04:21:01.679Z","updated":"2021-10-09T16:12:37.280Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983o00h8018o5r1fdikw","content":"<h1 id=\"docker-image\"><a href=\"#docker-image\" class=\"headerlink\" title=\"docker image\"></a>docker image</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull teddysun/v2ray</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">v2ray:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">teddysun/v2ray</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/v2ray</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">9000</span><span class=\"string\">:9000</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"config-json\"><a href=\"#config-json\" class=\"headerlink\" title=\"config.json\"></a>config.json</h1><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"port\"</span>: <span class=\"number\">9000</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"100xxxxx-xxxx-xxxx-xxxx-00xxxxxxxxxx\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"level\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker-image\"><a href=\"#docker-image\" class=\"headerlink\" title=\"docker image\"></a>docker image</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull teddysun/v2ray</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker compose\"></a>docker compose</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">'3.9'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">v2ray:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">teddysun/v2ray</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/v2ray</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"number\">9000</span><span class=\"string\">:9000</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"config-json\"><a href=\"#config-json\" class=\"headerlink\" title=\"config.json\"></a>config.json</h1><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"port\"</span>: <span class=\"number\">9000</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"100xxxxx-xxxx-xxxx-xxxx-00xxxxxxxxxx\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"level\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"status of VPS","_content":"\n# top\n\n```sh\ntop\n```\n\n## cmd\n\n- P: rank by cpu usage\n- T: rank by time\n- M: rank by memory\n- q: quit\n- m: change view of memory\n- t: change view of cpu\n- W: write into ~/.toprc\n\n# disk usage\n\n```sh\ndu -h  # show current dir\ndu -h /usr/bin\ndf -h  # show disk usage\n```\n\n# log\n\n```sh\ncd /var/log\n```\n\nauth.log: authentication log","source":"_posts/vps/usage.md","raw":"---\ntitle: status of VPS\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n---\n\n# top\n\n```sh\ntop\n```\n\n## cmd\n\n- P: rank by cpu usage\n- T: rank by time\n- M: rank by memory\n- q: quit\n- m: change view of memory\n- t: change view of cpu\n- W: write into ~/.toprc\n\n# disk usage\n\n```sh\ndu -h  # show current dir\ndu -h /usr/bin\ndf -h  # show disk usage\n```\n\n# log\n\n```sh\ncd /var/log\n```\n\nauth.log: authentication log","slug":"vps/usage","published":1,"date":"2021-10-09T05:11:40.594Z","updated":"2021-10-10T10:22:30.591Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983o00hc018ogsjh2hzr","content":"<h1 id=\"top\"><a href=\"#top\" class=\"headerlink\" title=\"top\"></a>top</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">top</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"cmd\"><a href=\"#cmd\" class=\"headerlink\" title=\"cmd\"></a>cmd</h2><ul>\n<li>P: rank by cpu usage</li>\n<li>T: rank by time</li>\n<li>M: rank by memory</li>\n<li>q: quit</li>\n<li>m: change view of memory</li>\n<li>t: change view of cpu</li>\n<li>W: write into ~/.toprc</li>\n</ul>\n<h1 id=\"disk-usage\"><a href=\"#disk-usage\" class=\"headerlink\" title=\"disk usage\"></a>disk usage</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h  <span class=\"comment\"># show current dir</span></span><br><span class=\"line\">du -h /usr/bin</span><br><span class=\"line\">df -h  <span class=\"comment\"># show disk usage</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"log\"><a href=\"#log\" class=\"headerlink\" title=\"log\"></a>log</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/<span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n\n<p>auth.log: authentication log</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"top\"><a href=\"#top\" class=\"headerlink\" title=\"top\"></a>top</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">top</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"cmd\"><a href=\"#cmd\" class=\"headerlink\" title=\"cmd\"></a>cmd</h2><ul>\n<li>P: rank by cpu usage</li>\n<li>T: rank by time</li>\n<li>M: rank by memory</li>\n<li>q: quit</li>\n<li>m: change view of memory</li>\n<li>t: change view of cpu</li>\n<li>W: write into ~/.toprc</li>\n</ul>\n<h1 id=\"disk-usage\"><a href=\"#disk-usage\" class=\"headerlink\" title=\"disk usage\"></a>disk usage</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h  <span class=\"comment\"># show current dir</span></span><br><span class=\"line\">du -h /usr/bin</span><br><span class=\"line\">df -h  <span class=\"comment\"># show disk usage</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"log\"><a href=\"#log\" class=\"headerlink\" title=\"log\"></a>log</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /var/<span class=\"built_in\">log</span></span><br></pre></td></tr></table></figure>\n\n<p>auth.log: authentication log</p>\n"},{"title":"customize PAC on V2rayU","_content":"\nadd user rule\n\n```\n||github.com  # this will apply to all the github page\nraw.github.com  # this will ony apply to specific page\n```\n\n\n\n","source":"_posts/v2ray/v2rayu.md","raw":"---\ntitle: customize PAC on V2rayU\ncategories: \n- V2ray\ntags: \n- macos\n---\n\nadd user rule\n\n```\n||github.com  # this will apply to all the github page\nraw.github.com  # this will ony apply to specific page\n```\n\n\n\n","slug":"v2ray/v2rayu","published":1,"date":"2021-10-09T07:28:59.596Z","updated":"2021-10-09T07:32:16.406Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983p00hf018oh2tzd854","content":"<p>add user rule</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">||github.com  # this will apply to all the github page</span><br><span class=\"line\">raw.github.com  # this will ony apply to specific page</span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<p>add user rule</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">||github.com  # this will apply to all the github page</span><br><span class=\"line\">raw.github.com  # this will ony apply to specific page</span><br></pre></td></tr></table></figure>\n\n\n\n"},{"title":"mount GDrive","_content":"\n# rclone\n\ndownload\n\n```sh\ncurl https://rclone.org/install.sh | sudo bash\n```\n\nconfigure\n\n```sh\nrclone config\n```\n\nfollow the promt\n\n# mount\n\n```sh\nnohup rclone mount 'remote':/remoteLoc /mnt/GoogleDrive --allow-other &> mnt_gd.out&\n```\n\nif there's an exception about `fuse`\n\n```sh\napt install fuse\n```\n\n**the mount process need to be hang on at backgrount!**\n\n# deamon file\n\n[refer](https://zhujitips.com/sh/rcloned)\n\n\n\n----\n\nReferences\n\nhttps://www.misterma.com/archives/900/\n\nhttps://zhuanlan.zhihu.com/p/190224369\n\nhttps://rclone.org","source":"_posts/vps/rclone.md","raw":"---\ntitle: mount GDrive\ncategories: \n- VPS\ntags: \n- linux\n- ubuntu\n- mount\n---\n\n# rclone\n\ndownload\n\n```sh\ncurl https://rclone.org/install.sh | sudo bash\n```\n\nconfigure\n\n```sh\nrclone config\n```\n\nfollow the promt\n\n# mount\n\n```sh\nnohup rclone mount 'remote':/remoteLoc /mnt/GoogleDrive --allow-other &> mnt_gd.out&\n```\n\nif there's an exception about `fuse`\n\n```sh\napt install fuse\n```\n\n**the mount process need to be hang on at backgrount!**\n\n# deamon file\n\n[refer](https://zhujitips.com/sh/rcloned)\n\n\n\n----\n\nReferences\n\nhttps://www.misterma.com/archives/900/\n\nhttps://zhuanlan.zhihu.com/p/190224369\n\nhttps://rclone.org","slug":"vps/rclone","published":1,"date":"2021-10-09T11:27:48.747Z","updated":"2021-10-15T05:43:30.017Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983q00hj018oavb34zo1","content":"<h1 id=\"rclone\"><a href=\"#rclone\" class=\"headerlink\" title=\"rclone\"></a>rclone</h1><p>download</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://rclone.org/install.sh | sudo bash</span><br></pre></td></tr></table></figure>\n\n<p>configure</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rclone config</span><br></pre></td></tr></table></figure>\n\n<p>follow the promt</p>\n<h1 id=\"mount\"><a href=\"#mount\" class=\"headerlink\" title=\"mount\"></a>mount</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup rclone mount <span class=\"string\">'remote'</span>:/remoteLoc /mnt/GoogleDrive --allow-other &amp;&gt; mnt_gd.out&amp;</span><br></pre></td></tr></table></figure>\n\n<p>if there’s an exception about <code>fuse</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install fuse</span><br></pre></td></tr></table></figure>\n\n<p><strong>the mount process need to be hang on at backgrount!</strong></p>\n<h1 id=\"deamon-file\"><a href=\"#deamon-file\" class=\"headerlink\" title=\"deamon file\"></a>deamon file</h1><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVqaXRpcHMuY29tL3NoL3JjbG9uZWQ=\">refer<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWlzdGVybWEuY29tL2FyY2hpdmVzLzkwMC8=\">https://www.misterma.com/archives/900/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xOTAyMjQzNjk=\">https://zhuanlan.zhihu.com/p/190224369<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yY2xvbmUub3Jn\">https://rclone.org<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"rclone\"><a href=\"#rclone\" class=\"headerlink\" title=\"rclone\"></a>rclone</h1><p>download</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://rclone.org/install.sh | sudo bash</span><br></pre></td></tr></table></figure>\n\n<p>configure</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rclone config</span><br></pre></td></tr></table></figure>\n\n<p>follow the promt</p>\n<h1 id=\"mount\"><a href=\"#mount\" class=\"headerlink\" title=\"mount\"></a>mount</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup rclone mount <span class=\"string\">'remote'</span>:/remoteLoc /mnt/GoogleDrive --allow-other &amp;&gt; mnt_gd.out&amp;</span><br></pre></td></tr></table></figure>\n\n<p>if there’s an exception about <code>fuse</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install fuse</span><br></pre></td></tr></table></figure>\n\n<p><strong>the mount process need to be hang on at backgrount!</strong></p>\n<h1 id=\"deamon-file\"><a href=\"#deamon-file\" class=\"headerlink\" title=\"deamon file\"></a>deamon file</h1><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVqaXRpcHMuY29tL3NoL3JjbG9uZWQ=\">refer<i class=\"fa fa-external-link-alt\"></i></span></p>\n<hr>\n<p>References</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWlzdGVybWEuY29tL2FyY2hpdmVzLzkwMC8=\">https://www.misterma.com/archives/900/<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xOTAyMjQzNjk=\">https://zhuanlan.zhihu.com/p/190224369<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yY2xvbmUub3Jn\">https://rclone.org<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"_content":"# V2ray\n\n## 安装V2ray\n- 安装脚本\n\n执行安装脚本\n\n`$ wget https://install.direct/go.sh`\n\n运行脚本\n\n`$ sudo bash go.sh`\n\n- 运行V2ray\n\n`$ sudo systemctl start v2ray`\n\n- V2ray配置文件\n\n`/etc/v2ray/config.json`\n\n## TLS\n- 安装脚本\n\n执行以下命令，acme.sh 会安装到 `~/.acme.sh` 目录下。\n`$ curl https://get.acme.sh | sh`\n\n安装成功后执行 `source ~/.bashrc` 以确保脚本所设置的命令别名生效。\n\n如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:\n\n`$ sudo apt-get install openssl cron socat curl`\n\n- 分发证书\n\n使用Nginx监听80端口进行证书分发\n\n`$ acme.sh --issue  -d tunnel.edlison.xyz  --nginx`\n\n使用acme自带的standalone进行端口监听\n\n`$ acme.sh --issue -d tunnel.edlieon.xyz --standalone`\n\nExample\n\n`$ acme.sh --issue -d tunnel.edlison.xyz --nginx --keylength ec-256`\n\n`--keylength` 表示密钥长度，后面的值可以是 ec-256 、ec-384、2048、3072、4096、8192，带有 ec 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书\n\n- 更新证书\n\n`$ acme.sh --renew -d tunnel.edlison.xyz --force --ecc`\n\n由于 Let's Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。`--ecc`生成的ECC证书\n\n- 安装证书和密钥\n\n将证书安装到V2ray目录下\n\n```bash\n$ acme.sh --installcert -d tunnel.edlison.xyz --ecc \\\n                          --fullchain-file /etc/v2ray/v2ray.crt \\\n                          --key-file /etc/v2ray/v2ray.key\n```\n\n- 配置文件\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 443, // 建议使用 443 端口\n      \"protocol\": \"vmess\",    \n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",  \n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\", // security 要设置为 tls 才会启用 TLS\n        \"tlsSettings\": {\n          \"certificates\": [\n            {\n              \"certificateFile\": \"/etc/v2ray/v2ray.crt\", // 证书文件\n              \"keyFile\": \"/etc/v2ray/v2ray.key\" // 密钥文件\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n\n## Nginx\n\n- Start\n\n配置文件\n\n`$ nginx -c /etc/nginx/nginx.conf`\n\n启动Nginx\n\n`$ nginx -s reload`\n\n- config\n\nNginx 仅需监听80端口\n\n```nginx\nserver {\n        listen       80;\n        listen       [::]:80;\n        server_name  tunnel.edlison.xyz;\n\n        #return  301 https://$server_name$request_uri; // 可以将流量转向https\n\n        root         /usr/share/nginx/html;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n```\n\n## WebSocket + TLS + Web\n\n这次 TLS 的配置将写入 Nginx/Caddy/Apache 配置中，由这些软件来监听 443 端口（443 比较常用，并非 443 不可），然后将流量转发到 V2Ray 的 WebSocket 所监听的内网端口（本例是 10000），V2Ray 服务器端不需要配置 TLS。\n\n- V2ray Settings\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 10000,\n      \"listen\":\"127.0.0.1\",//只监听 127.0.0.1，避免除本机外的机器探测到开放了 10000 端口\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"b831381d-6324-4d53-ad4f-8cda48b30811\",\n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"wsSettings\": {\n        \"path\": \"/ray\"  // 路径\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n\n- TLS\n\n证书生成见上文\n\n- Nginx Setting\n\n```nginx\nserver {\n  listen 443 ssl;\n  listen [::]:443 ssl;\n  \n  ssl_certificate       /etc/v2ray/v2ray.crt;\n  ssl_certificate_key   /etc/v2ray/v2ray.key;\n  ssl_session_timeout 1d;\n  ssl_session_cache shared:MozSSL:10m;\n  ssl_session_tickets off;\n  \n  ssl_protocols         TLSv1.2 TLSv1.3;\n  ssl_ciphers           ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n  ssl_prefer_server_ciphers off;\n  \n  server_name           tunnel.edlison.xyz;\n  location /ray { # 与 V2Ray 配置中的 path 保持一致\n    if ($http_upgrade != \"websocket\") { # WebSocket协商失败时返回404\n        return 404;\n    }\n    proxy_redirect off;\n    proxy_pass http://127.0.0.1:10000; # 假设WebSocket监听在环回地址的10000端口上\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_set_header Host $host;\n    # Show real IP in v2ray access.log\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n}\n```\n\n- Client Setting\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 1080,\n      \"listen\": \"127.0.0.1\",\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\"http\", \"tls\"]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\",\n        \"udp\": false\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \"mydomain.me\",\n            \"port\": 443,\n            \"users\": [\n              {\n                \"id\": \"b831381d-6324-4d53-ad4f-8cda48b30811\",\n                \"alterId\": 64\n              }\n            ]\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"security\": \"tls\",\n        \"wsSettings\": {\n          \"path\": \"/ray\"\n        }\n      }\n    }\n  ]\n}\n```\n\n- 注意事项\n\n注意事项\nV2Ray 自 4.18.1 后支持 TLS1.3，如果开启并强制 TLS1.3 请注意 v2ray 客户端版本.\n较低版本的 nginx 的 location 需要写为 /ray/ 才能正常工作\n如果在设置完成之后不能成功使用，可能是由于 SElinux 机制(如果你是 CentOS 7 的用户请特别留意 SElinux 这一机制)阻止了 Nginx 转发向内网的数据。如果是这样的话，在 V2Ray 的日志里不会有访问信息，在 Nginx 的日志里会出现大量的 \"Permission Denied\" 字段，要解决这一问题需要在终端下键入以下命令：\nsetsebool -P httpd_can_network_connect 1\n请保持服务器和客户端的 wsSettings 严格一致，对于 V2Ray，/ray 和 /ray/ 是不一样的\n较低版本的系统/浏览器可能无法完成握手. 如 Chrome 49/XP SP3, Safari 8/iOS 8.4, Safari 8/OS X 10.10 及更低的版本. 如果你的设备比较旧, 则可以通过在配置中添加较旧的 TLS 协议以完成握手.\n\n## BBR\n\n- 一键安装脚本\n\n`$ wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh && chmod +x bbr.sh && ./bbr.sh`\n\n- 检测内核\n\n`$ uname -r`\n\n- 检测安装情况\n\n`$ sysctl net.ipv4.tcp_available_congestion_control`","source":"_posts/v2ray/v2ray.md","raw":"# V2ray\n\n## 安装V2ray\n- 安装脚本\n\n执行安装脚本\n\n`$ wget https://install.direct/go.sh`\n\n运行脚本\n\n`$ sudo bash go.sh`\n\n- 运行V2ray\n\n`$ sudo systemctl start v2ray`\n\n- V2ray配置文件\n\n`/etc/v2ray/config.json`\n\n## TLS\n- 安装脚本\n\n执行以下命令，acme.sh 会安装到 `~/.acme.sh` 目录下。\n`$ curl https://get.acme.sh | sh`\n\n安装成功后执行 `source ~/.bashrc` 以确保脚本所设置的命令别名生效。\n\n如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:\n\n`$ sudo apt-get install openssl cron socat curl`\n\n- 分发证书\n\n使用Nginx监听80端口进行证书分发\n\n`$ acme.sh --issue  -d tunnel.edlison.xyz  --nginx`\n\n使用acme自带的standalone进行端口监听\n\n`$ acme.sh --issue -d tunnel.edlieon.xyz --standalone`\n\nExample\n\n`$ acme.sh --issue -d tunnel.edlison.xyz --nginx --keylength ec-256`\n\n`--keylength` 表示密钥长度，后面的值可以是 ec-256 、ec-384、2048、3072、4096、8192，带有 ec 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书\n\n- 更新证书\n\n`$ acme.sh --renew -d tunnel.edlison.xyz --force --ecc`\n\n由于 Let's Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。`--ecc`生成的ECC证书\n\n- 安装证书和密钥\n\n将证书安装到V2ray目录下\n\n```bash\n$ acme.sh --installcert -d tunnel.edlison.xyz --ecc \\\n                          --fullchain-file /etc/v2ray/v2ray.crt \\\n                          --key-file /etc/v2ray/v2ray.key\n```\n\n- 配置文件\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 443, // 建议使用 443 端口\n      \"protocol\": \"vmess\",    \n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\",  \n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"tcp\",\n        \"security\": \"tls\", // security 要设置为 tls 才会启用 TLS\n        \"tlsSettings\": {\n          \"certificates\": [\n            {\n              \"certificateFile\": \"/etc/v2ray/v2ray.crt\", // 证书文件\n              \"keyFile\": \"/etc/v2ray/v2ray.key\" // 密钥文件\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n\n## Nginx\n\n- Start\n\n配置文件\n\n`$ nginx -c /etc/nginx/nginx.conf`\n\n启动Nginx\n\n`$ nginx -s reload`\n\n- config\n\nNginx 仅需监听80端口\n\n```nginx\nserver {\n        listen       80;\n        listen       [::]:80;\n        server_name  tunnel.edlison.xyz;\n\n        #return  301 https://$server_name$request_uri; // 可以将流量转向https\n\n        root         /usr/share/nginx/html;\n\n        # Load configuration files for the default server block.\n        include /etc/nginx/default.d/*.conf;\n\n        location / {\n        }\n\n        error_page 404 /404.html;\n            location = /40x.html {\n        }\n\n        error_page 500 502 503 504 /50x.html;\n            location = /50x.html {\n        }\n    }\n```\n\n## WebSocket + TLS + Web\n\n这次 TLS 的配置将写入 Nginx/Caddy/Apache 配置中，由这些软件来监听 443 端口（443 比较常用，并非 443 不可），然后将流量转发到 V2Ray 的 WebSocket 所监听的内网端口（本例是 10000），V2Ray 服务器端不需要配置 TLS。\n\n- V2ray Settings\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 10000,\n      \"listen\":\"127.0.0.1\",//只监听 127.0.0.1，避免除本机外的机器探测到开放了 10000 端口\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"b831381d-6324-4d53-ad4f-8cda48b30811\",\n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"wsSettings\": {\n        \"path\": \"/ray\"  // 路径\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n```\n\n- TLS\n\n证书生成见上文\n\n- Nginx Setting\n\n```nginx\nserver {\n  listen 443 ssl;\n  listen [::]:443 ssl;\n  \n  ssl_certificate       /etc/v2ray/v2ray.crt;\n  ssl_certificate_key   /etc/v2ray/v2ray.key;\n  ssl_session_timeout 1d;\n  ssl_session_cache shared:MozSSL:10m;\n  ssl_session_tickets off;\n  \n  ssl_protocols         TLSv1.2 TLSv1.3;\n  ssl_ciphers           ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n  ssl_prefer_server_ciphers off;\n  \n  server_name           tunnel.edlison.xyz;\n  location /ray { # 与 V2Ray 配置中的 path 保持一致\n    if ($http_upgrade != \"websocket\") { # WebSocket协商失败时返回404\n        return 404;\n    }\n    proxy_redirect off;\n    proxy_pass http://127.0.0.1:10000; # 假设WebSocket监听在环回地址的10000端口上\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_set_header Host $host;\n    # Show real IP in v2ray access.log\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  }\n}\n```\n\n- Client Setting\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 1080,\n      \"listen\": \"127.0.0.1\",\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\"http\", \"tls\"]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\",\n        \"udp\": false\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \"mydomain.me\",\n            \"port\": 443,\n            \"users\": [\n              {\n                \"id\": \"b831381d-6324-4d53-ad4f-8cda48b30811\",\n                \"alterId\": 64\n              }\n            ]\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"security\": \"tls\",\n        \"wsSettings\": {\n          \"path\": \"/ray\"\n        }\n      }\n    }\n  ]\n}\n```\n\n- 注意事项\n\n注意事项\nV2Ray 自 4.18.1 后支持 TLS1.3，如果开启并强制 TLS1.3 请注意 v2ray 客户端版本.\n较低版本的 nginx 的 location 需要写为 /ray/ 才能正常工作\n如果在设置完成之后不能成功使用，可能是由于 SElinux 机制(如果你是 CentOS 7 的用户请特别留意 SElinux 这一机制)阻止了 Nginx 转发向内网的数据。如果是这样的话，在 V2Ray 的日志里不会有访问信息，在 Nginx 的日志里会出现大量的 \"Permission Denied\" 字段，要解决这一问题需要在终端下键入以下命令：\nsetsebool -P httpd_can_network_connect 1\n请保持服务器和客户端的 wsSettings 严格一致，对于 V2Ray，/ray 和 /ray/ 是不一样的\n较低版本的系统/浏览器可能无法完成握手. 如 Chrome 49/XP SP3, Safari 8/iOS 8.4, Safari 8/OS X 10.10 及更低的版本. 如果你的设备比较旧, 则可以通过在配置中添加较旧的 TLS 协议以完成握手.\n\n## BBR\n\n- 一键安装脚本\n\n`$ wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh && chmod +x bbr.sh && ./bbr.sh`\n\n- 检测内核\n\n`$ uname -r`\n\n- 检测安装情况\n\n`$ sysctl net.ipv4.tcp_available_congestion_control`","slug":"v2ray/v2ray","published":1,"date":"2020-04-03T14:44:04.526Z","updated":"2020-04-04T06:41:37.742Z","title":"v2ray/v2ray","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983r00hn018ocqsf4ex8","content":"<h1 id=\"V2ray\"><a href=\"#V2ray\" class=\"headerlink\" title=\"V2ray\"></a>V2ray</h1><h2 id=\"安装V2ray\"><a href=\"#安装V2ray\" class=\"headerlink\" title=\"安装V2ray\"></a>安装V2ray</h2><ul>\n<li>安装脚本</li>\n</ul>\n<p>执行安装脚本</p>\n<p><code>$ wget https://install.direct/go.sh</code></p>\n<p>运行脚本</p>\n<p><code>$ sudo bash go.sh</code></p>\n<ul>\n<li>运行V2ray</li>\n</ul>\n<p><code>$ sudo systemctl start v2ray</code></p>\n<ul>\n<li>V2ray配置文件</li>\n</ul>\n<p><code>/etc/v2ray/config.json</code></p>\n<h2 id=\"TLS\"><a href=\"#TLS\" class=\"headerlink\" title=\"TLS\"></a>TLS</h2><ul>\n<li>安装脚本</li>\n</ul>\n<p>执行以下命令，acme.sh 会安装到 <code>~/.acme.sh</code> 目录下。<br><code>$ curl https://get.acme.sh | sh</code></p>\n<p>安装成功后执行 <code>source ~/.bashrc</code> 以确保脚本所设置的命令别名生效。</p>\n<p>如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:</p>\n<p><code>$ sudo apt-get install openssl cron socat curl</code></p>\n<ul>\n<li>分发证书</li>\n</ul>\n<p>使用Nginx监听80端口进行证书分发</p>\n<p><code>$ acme.sh --issue  -d tunnel.edlison.xyz  --nginx</code></p>\n<p>使用acme自带的standalone进行端口监听</p>\n<p><code>$ acme.sh --issue -d tunnel.edlieon.xyz --standalone</code></p>\n<p>Example</p>\n<p><code>$ acme.sh --issue -d tunnel.edlison.xyz --nginx --keylength ec-256</code></p>\n<p><code>--keylength</code> 表示密钥长度，后面的值可以是 ec-256 、ec-384、2048、3072、4096、8192，带有 ec 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书</p>\n<ul>\n<li>更新证书</li>\n</ul>\n<p><code>$ acme.sh --renew -d tunnel.edlison.xyz --force --ecc</code></p>\n<p>由于 Let’s Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。<code>--ecc</code>生成的ECC证书</p>\n<ul>\n<li>安装证书和密钥</li>\n</ul>\n<p>将证书安装到V2ray目录下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ acme.sh --installcert -d tunnel.edlison.xyz --ecc \\</span><br><span class=\"line\">                          --fullchain-file /etc/v2ray/v2ray.crt \\</span><br><span class=\"line\">                          --key-file /etc/v2ray/v2ray.key</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>配置文件</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>, <span class=\"comment\">// 建议使用 443 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,    </span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,  </span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>, <span class=\"comment\">// security 要设置为 tls 才会启用 TLS</span></span><br><span class=\"line\">        <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"certificates\"</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              <span class=\"attr\">\"certificateFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.crt\"</span>, <span class=\"comment\">// 证书文件</span></span><br><span class=\"line\">              <span class=\"attr\">\"keyFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.key\"</span> <span class=\"comment\">// 密钥文件</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h2><ul>\n<li>Start</li>\n</ul>\n<p>配置文件</p>\n<p><code>$ nginx -c /etc/nginx/nginx.conf</code></p>\n<p>启动Nginx</p>\n<p><code>$ nginx -s reload</code></p>\n<ul>\n<li>config</li>\n</ul>\n<p>Nginx 仅需监听80端口</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>       <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>       [::]:<span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>  tunnel.edlison.xyz;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">#return  301 https://$server_name$request_uri; // 可以将流量转向https</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">root</span>         /usr/share/nginx/html;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Load configuration files for the default server block.</span></span><br><span class=\"line\">        <span class=\"attribute\">include</span> /etc/nginx/default.d/<span class=\"regexp\">*.conf</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span> <span class=\"number\">404</span> /<span class=\"number\">404</span>.html;</span><br><span class=\"line\">            <span class=\"attribute\">location</span> = /40x.html &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span> <span class=\"number\">500</span> <span class=\"number\">502</span> <span class=\"number\">503</span> <span class=\"number\">504</span> /50x.html;</span><br><span class=\"line\">            <span class=\"attribute\">location</span> = /50x.html &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WebSocket-TLS-Web\"><a href=\"#WebSocket-TLS-Web\" class=\"headerlink\" title=\"WebSocket + TLS + Web\"></a>WebSocket + TLS + Web</h2><p>这次 TLS 的配置将写入 Nginx/Caddy/Apache 配置中，由这些软件来监听 443 端口（443 比较常用，并非 443 不可），然后将流量转发到 V2Ray 的 WebSocket 所监听的内网端口（本例是 10000），V2Ray 服务器端不需要配置 TLS。</p>\n<ul>\n<li>V2ray Settings</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">10000</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"listen\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"comment\">//只监听 127.0.0.1，避免除本机外的机器探测到开放了 10000 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"b831381d-6324-4d53-ad4f-8cda48b30811\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"ws\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"wsSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"path\"</span>: <span class=\"string\">\"/ray\"</span>  <span class=\"comment\">// 路径</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>TLS</li>\n</ul>\n<p>证书生成见上文</p>\n<ul>\n<li>Nginx Setting</li>\n</ul>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> [::]:<span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate</span>       /etc/v2ray/v2ray.crt;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate_key</span>   /etc/v2ray/v2ray.key;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_timeout</span> <span class=\"number\">1d</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_cache</span> shared:MozSSL:<span class=\"number\">10m</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_tickets</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">ssl_protocols</span>         TLSv1.<span class=\"number\">2</span> TLSv1.<span class=\"number\">3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_ciphers</span>           ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_prefer_server_ciphers</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>           tunnel.edlison.xyz;</span><br><span class=\"line\">  <span class=\"attribute\">location</span> /ray &#123; <span class=\"comment\"># 与 V2Ray 配置中的 path 保持一致</span></span><br><span class=\"line\">    <span class=\"attribute\">if</span> (<span class=\"variable\">$http_upgrade</span> != <span class=\"string\">\"websocket\"</span>) &#123; <span class=\"comment\"># WebSocket协商失败时返回404</span></span><br><span class=\"line\">        <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_redirect</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_pass</span> http://127.0.0.1:10000; <span class=\"comment\"># 假设WebSocket监听在环回地址的10000端口上</span></span><br><span class=\"line\">    <span class=\"attribute\">proxy_http_version</span> <span class=\"number\">1</span>.<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Connection <span class=\"string\">\"upgrade\"</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">    <span class=\"comment\"># Show real IP in v2ray access.log</span></span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Client Setting</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"listen\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"socks\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sniffing\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"destOverride\"</span>: [<span class=\"string\">\"http\"</span>, <span class=\"string\">\"tls\"</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"auth\"</span>: <span class=\"string\">\"noauth\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"udp\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"vnext\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"address\"</span>: <span class=\"string\">\"mydomain.me\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"users\"</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"b831381d-6324-4d53-ad4f-8cda48b30811\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"ws\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"wsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"path\"</span>: <span class=\"string\">\"/ray\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>注意事项</li>\n</ul>\n<p>注意事项<br>V2Ray 自 4.18.1 后支持 TLS1.3，如果开启并强制 TLS1.3 请注意 v2ray 客户端版本.<br>较低版本的 nginx 的 location 需要写为 /ray/ 才能正常工作<br>如果在设置完成之后不能成功使用，可能是由于 SElinux 机制(如果你是 CentOS 7 的用户请特别留意 SElinux 这一机制)阻止了 Nginx 转发向内网的数据。如果是这样的话，在 V2Ray 的日志里不会有访问信息，在 Nginx 的日志里会出现大量的 “Permission Denied” 字段，要解决这一问题需要在终端下键入以下命令：<br>setsebool -P httpd_can_network_connect 1<br>请保持服务器和客户端的 wsSettings 严格一致，对于 V2Ray，/ray 和 /ray/ 是不一样的<br>较低版本的系统/浏览器可能无法完成握手. 如 Chrome 49/XP SP3, Safari 8/iOS 8.4, Safari 8/OS X 10.10 及更低的版本. 如果你的设备比较旧, 则可以通过在配置中添加较旧的 TLS 协议以完成握手.</p>\n<h2 id=\"BBR\"><a href=\"#BBR\" class=\"headerlink\" title=\"BBR\"></a>BBR</h2><ul>\n<li>一键安装脚本</li>\n</ul>\n<p><code>$ wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh</code></p>\n<ul>\n<li>检测内核</li>\n</ul>\n<p><code>$ uname -r</code></p>\n<ul>\n<li>检测安装情况</li>\n</ul>\n<p><code>$ sysctl net.ipv4.tcp_available_congestion_control</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"V2ray\"><a href=\"#V2ray\" class=\"headerlink\" title=\"V2ray\"></a>V2ray</h1><h2 id=\"安装V2ray\"><a href=\"#安装V2ray\" class=\"headerlink\" title=\"安装V2ray\"></a>安装V2ray</h2><ul>\n<li>安装脚本</li>\n</ul>\n<p>执行安装脚本</p>\n<p><code>$ wget https://install.direct/go.sh</code></p>\n<p>运行脚本</p>\n<p><code>$ sudo bash go.sh</code></p>\n<ul>\n<li>运行V2ray</li>\n</ul>\n<p><code>$ sudo systemctl start v2ray</code></p>\n<ul>\n<li>V2ray配置文件</li>\n</ul>\n<p><code>/etc/v2ray/config.json</code></p>\n<h2 id=\"TLS\"><a href=\"#TLS\" class=\"headerlink\" title=\"TLS\"></a>TLS</h2><ul>\n<li>安装脚本</li>\n</ul>\n<p>执行以下命令，acme.sh 会安装到 <code>~/.acme.sh</code> 目录下。<br><code>$ curl https://get.acme.sh | sh</code></p>\n<p>安装成功后执行 <code>source ~/.bashrc</code> 以确保脚本所设置的命令别名生效。</p>\n<p>如果安装报错，那么可能是因为系统缺少 acme.sh 所需要的依赖项，acme.sh 的依赖项主要是 socat，我们通过以下命令来安装这些依赖项，然后重新安装一遍 acme.sh:</p>\n<p><code>$ sudo apt-get install openssl cron socat curl</code></p>\n<ul>\n<li>分发证书</li>\n</ul>\n<p>使用Nginx监听80端口进行证书分发</p>\n<p><code>$ acme.sh --issue  -d tunnel.edlison.xyz  --nginx</code></p>\n<p>使用acme自带的standalone进行端口监听</p>\n<p><code>$ acme.sh --issue -d tunnel.edlieon.xyz --standalone</code></p>\n<p>Example</p>\n<p><code>$ acme.sh --issue -d tunnel.edlison.xyz --nginx --keylength ec-256</code></p>\n<p><code>--keylength</code> 表示密钥长度，后面的值可以是 ec-256 、ec-384、2048、3072、4096、8192，带有 ec 表示生成的是 ECC 证书，没有则是 RSA 证书。在安全性上 256 位的 ECC 证书等同于 3072 位的 RSA 证书</p>\n<ul>\n<li>更新证书</li>\n</ul>\n<p><code>$ acme.sh --renew -d tunnel.edlison.xyz --force --ecc</code></p>\n<p>由于 Let’s Encrypt 的证书有效期只有 3 个月，因此需要 90 天至少要更新一次证书，acme.sh 脚本会每 60 天自动更新证书。也可以手动更新。<code>--ecc</code>生成的ECC证书</p>\n<ul>\n<li>安装证书和密钥</li>\n</ul>\n<p>将证书安装到V2ray目录下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ acme.sh --installcert -d tunnel.edlison.xyz --ecc \\</span><br><span class=\"line\">                          --fullchain-file /etc/v2ray/v2ray.crt \\</span><br><span class=\"line\">                          --key-file /etc/v2ray/v2ray.key</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>配置文件</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>, <span class=\"comment\">// 建议使用 443 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,    </span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297\"</span>,  </span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"tcp\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>, <span class=\"comment\">// security 要设置为 tls 才会启用 TLS</span></span><br><span class=\"line\">        <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"certificates\"</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              <span class=\"attr\">\"certificateFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.crt\"</span>, <span class=\"comment\">// 证书文件</span></span><br><span class=\"line\">              <span class=\"attr\">\"keyFile\"</span>: <span class=\"string\">\"/etc/v2ray/v2ray.key\"</span> <span class=\"comment\">// 密钥文件</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Nginx\"><a href=\"#Nginx\" class=\"headerlink\" title=\"Nginx\"></a>Nginx</h2><ul>\n<li>Start</li>\n</ul>\n<p>配置文件</p>\n<p><code>$ nginx -c /etc/nginx/nginx.conf</code></p>\n<p>启动Nginx</p>\n<p><code>$ nginx -s reload</code></p>\n<ul>\n<li>config</li>\n</ul>\n<p>Nginx 仅需监听80端口</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>       <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>       [::]:<span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>  tunnel.edlison.xyz;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">#return  301 https://$server_name$request_uri; // 可以将流量转向https</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">root</span>         /usr/share/nginx/html;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Load configuration files for the default server block.</span></span><br><span class=\"line\">        <span class=\"attribute\">include</span> /etc/nginx/default.d/<span class=\"regexp\">*.conf</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span> <span class=\"number\">404</span> /<span class=\"number\">404</span>.html;</span><br><span class=\"line\">            <span class=\"attribute\">location</span> = /40x.html &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"attribute\">error_page</span> <span class=\"number\">500</span> <span class=\"number\">502</span> <span class=\"number\">503</span> <span class=\"number\">504</span> /50x.html;</span><br><span class=\"line\">            <span class=\"attribute\">location</span> = /50x.html &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WebSocket-TLS-Web\"><a href=\"#WebSocket-TLS-Web\" class=\"headerlink\" title=\"WebSocket + TLS + Web\"></a>WebSocket + TLS + Web</h2><p>这次 TLS 的配置将写入 Nginx/Caddy/Apache 配置中，由这些软件来监听 443 端口（443 比较常用，并非 443 不可），然后将流量转发到 V2Ray 的 WebSocket 所监听的内网端口（本例是 10000），V2Ray 服务器端不需要配置 TLS。</p>\n<ul>\n<li>V2ray Settings</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">10000</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"listen\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"comment\">//只监听 127.0.0.1，避免除本机外的机器探测到开放了 10000 端口</span></span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"b831381d-6324-4d53-ad4f-8cda48b30811\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"ws\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"wsSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"path\"</span>: <span class=\"string\">\"/ray\"</span>  <span class=\"comment\">// 路径</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>TLS</li>\n</ul>\n<p>证书生成见上文</p>\n<ul>\n<li>Nginx Setting</li>\n</ul>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> [::]:<span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate</span>       /etc/v2ray/v2ray.crt;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate_key</span>   /etc/v2ray/v2ray.key;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_timeout</span> <span class=\"number\">1d</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_cache</span> shared:MozSSL:<span class=\"number\">10m</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_session_tickets</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">ssl_protocols</span>         TLSv1.<span class=\"number\">2</span> TLSv1.<span class=\"number\">3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_ciphers</span>           ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_prefer_server_ciphers</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"attribute\">server_name</span>           tunnel.edlison.xyz;</span><br><span class=\"line\">  <span class=\"attribute\">location</span> /ray &#123; <span class=\"comment\"># 与 V2Ray 配置中的 path 保持一致</span></span><br><span class=\"line\">    <span class=\"attribute\">if</span> (<span class=\"variable\">$http_upgrade</span> != <span class=\"string\">\"websocket\"</span>) &#123; <span class=\"comment\"># WebSocket协商失败时返回404</span></span><br><span class=\"line\">        <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_redirect</span> <span class=\"literal\">off</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_pass</span> http://127.0.0.1:10000; <span class=\"comment\"># 假设WebSocket监听在环回地址的10000端口上</span></span><br><span class=\"line\">    <span class=\"attribute\">proxy_http_version</span> <span class=\"number\">1</span>.<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Connection <span class=\"string\">\"upgrade\"</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">    <span class=\"comment\"># Show real IP in v2ray access.log</span></span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Client Setting</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"listen\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"socks\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sniffing\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"destOverride\"</span>: [<span class=\"string\">\"http\"</span>, <span class=\"string\">\"tls\"</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"auth\"</span>: <span class=\"string\">\"noauth\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"udp\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"vnext\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"address\"</span>: <span class=\"string\">\"mydomain.me\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"port\"</span>: <span class=\"number\">443</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"users\"</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"b831381d-6324-4d53-ad4f-8cda48b30811\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"ws\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"wsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"path\"</span>: <span class=\"string\">\"/ray\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>注意事项</li>\n</ul>\n<p>注意事项<br>V2Ray 自 4.18.1 后支持 TLS1.3，如果开启并强制 TLS1.3 请注意 v2ray 客户端版本.<br>较低版本的 nginx 的 location 需要写为 /ray/ 才能正常工作<br>如果在设置完成之后不能成功使用，可能是由于 SElinux 机制(如果你是 CentOS 7 的用户请特别留意 SElinux 这一机制)阻止了 Nginx 转发向内网的数据。如果是这样的话，在 V2Ray 的日志里不会有访问信息，在 Nginx 的日志里会出现大量的 “Permission Denied” 字段，要解决这一问题需要在终端下键入以下命令：<br>setsebool -P httpd_can_network_connect 1<br>请保持服务器和客户端的 wsSettings 严格一致，对于 V2Ray，/ray 和 /ray/ 是不一样的<br>较低版本的系统/浏览器可能无法完成握手. 如 Chrome 49/XP SP3, Safari 8/iOS 8.4, Safari 8/OS X 10.10 及更低的版本. 如果你的设备比较旧, 则可以通过在配置中添加较旧的 TLS 协议以完成握手.</p>\n<h2 id=\"BBR\"><a href=\"#BBR\" class=\"headerlink\" title=\"BBR\"></a>BBR</h2><ul>\n<li>一键安装脚本</li>\n</ul>\n<p><code>$ wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh</code></p>\n<ul>\n<li>检测内核</li>\n</ul>\n<p><code>$ uname -r</code></p>\n<ul>\n<li>检测安装情况</li>\n</ul>\n<p><code>$ sysctl net.ipv4.tcp_available_congestion_control</code></p>\n"},{"title":"Flask-Socktio","_content":"\n# Start\n\n```python\nfrom flask_socketio import SocketIO\n\nsocketio = SocketIO(app)\n```\n\n# Receiving Messages\n\nThe event name is determined. `'message', 'json', 'xxx event'`, you can determine these name as socket name. Particularly `'connect', 'disconnecte'` can be called when connecting or disconnecting.\n\n```python\n@socketio.on('xxx event', namespace='/test')\ndef handler(json):\n  print('receive json: ', str(json))\n```\n\n```html\n<script>\n\tvar socket = io.connect('http://0.0.0.0:5001')\n  socket.on('connect', function() {\n    socket.emit('xxx event', {'data': 'connected.'})\n  })\n</script>\n\n```\n\n\n\n# Sending Messages\n\n`emit()` used for named events , `send()` used for unamed events.\n\n```python\n@socketio.on('xxx event', namespace='/chatroom')\ndef xxx_event():\n  emit('xxx event', {'data': 'xxx'}, namespace='/chatroom')\n```\n\n**Important**\n\nYou can emit message in a router with `socketio.emit('xxx event', resp, namespace='/chatroom')`.\n\n```python\n@app.rout('/send')\ndef send():\n\tsocketio.emit('xxx event', resp, namespace='/chatroom')\n```\n\nYou can't use `emit()` without context of `socketio`, you should use `socketio.emit()`.\n\n\n\n# Broadcasting\n\nIf broadcasting is enabled, all the clients connected to the namespace will receive the message.\n\n```python\n@socketio.on('xxx event', namespace='/chatroom')\ndef xxx_event():\n  emit('xxx event', {'data': 'xxx'}, namespace='/chatroom', broadcast=True)\n```\n\n\n\n# Rooms\n\nUsers can receive messages from the room they are in.\n\n```python\n@socketio.on('join')\ndef on_join(data):\n    username = data['username']\n    room = data['room']\n    join_room(room)\n    send(username + ' has entered the room.', to=room)\n\n@socketio.on('leave')\ndef on_leave(data):\n    username = data['username']\n    room = data['room']\n    leave_room(room)\n    send(username + ' has left the room.', to=room)\n```\n\nUse `to` argument set which room the message should be sent to.\n\n\n\n# Class-Based Events\n\n```python\nfrom flask_socketio import Namespace, emit\n\nclass MyCustomNamespace(Namespace):\n    def on_connect(self):\n        pass\n\n    def on_disconnect(self):\n        pass\n\n    def on_my_event(self, data):\n        emit('my_response', data)\n\nsocketio.on_namespace(MyCustomNamespace('/test'))  # Assign namespace\n```\n\nAll the event is defined by the methods with `on_` prefix.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://flask-socketio.readthedocs.io","source":"_posts/web/socketio.md","raw":"---\ntitle: Flask-Socktio\ncategories:\n- Web\ntags:\n- python\n- flask\n- socket\n---\n\n# Start\n\n```python\nfrom flask_socketio import SocketIO\n\nsocketio = SocketIO(app)\n```\n\n# Receiving Messages\n\nThe event name is determined. `'message', 'json', 'xxx event'`, you can determine these name as socket name. Particularly `'connect', 'disconnecte'` can be called when connecting or disconnecting.\n\n```python\n@socketio.on('xxx event', namespace='/test')\ndef handler(json):\n  print('receive json: ', str(json))\n```\n\n```html\n<script>\n\tvar socket = io.connect('http://0.0.0.0:5001')\n  socket.on('connect', function() {\n    socket.emit('xxx event', {'data': 'connected.'})\n  })\n</script>\n\n```\n\n\n\n# Sending Messages\n\n`emit()` used for named events , `send()` used for unamed events.\n\n```python\n@socketio.on('xxx event', namespace='/chatroom')\ndef xxx_event():\n  emit('xxx event', {'data': 'xxx'}, namespace='/chatroom')\n```\n\n**Important**\n\nYou can emit message in a router with `socketio.emit('xxx event', resp, namespace='/chatroom')`.\n\n```python\n@app.rout('/send')\ndef send():\n\tsocketio.emit('xxx event', resp, namespace='/chatroom')\n```\n\nYou can't use `emit()` without context of `socketio`, you should use `socketio.emit()`.\n\n\n\n# Broadcasting\n\nIf broadcasting is enabled, all the clients connected to the namespace will receive the message.\n\n```python\n@socketio.on('xxx event', namespace='/chatroom')\ndef xxx_event():\n  emit('xxx event', {'data': 'xxx'}, namespace='/chatroom', broadcast=True)\n```\n\n\n\n# Rooms\n\nUsers can receive messages from the room they are in.\n\n```python\n@socketio.on('join')\ndef on_join(data):\n    username = data['username']\n    room = data['room']\n    join_room(room)\n    send(username + ' has entered the room.', to=room)\n\n@socketio.on('leave')\ndef on_leave(data):\n    username = data['username']\n    room = data['room']\n    leave_room(room)\n    send(username + ' has left the room.', to=room)\n```\n\nUse `to` argument set which room the message should be sent to.\n\n\n\n# Class-Based Events\n\n```python\nfrom flask_socketio import Namespace, emit\n\nclass MyCustomNamespace(Namespace):\n    def on_connect(self):\n        pass\n\n    def on_disconnect(self):\n        pass\n\n    def on_my_event(self, data):\n        emit('my_response', data)\n\nsocketio.on_namespace(MyCustomNamespace('/test'))  # Assign namespace\n```\n\nAll the event is defined by the methods with `on_` prefix.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://flask-socketio.readthedocs.io","slug":"web/socketio","published":1,"date":"2021-07-10T08:28:05.854Z","updated":"2021-07-11T04:33:59.880Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983r00hq018o53mx2ls1","content":"<h1 id=\"Start\"><a href=\"#Start\" class=\"headerlink\" title=\"Start\"></a>Start</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_socketio <span class=\"keyword\">import</span> SocketIO</span><br><span class=\"line\"></span><br><span class=\"line\">socketio = SocketIO(app)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Receiving-Messages\"><a href=\"#Receiving-Messages\" class=\"headerlink\" title=\"Receiving Messages\"></a>Receiving Messages</h1><p>The event name is determined. <code>&#39;message&#39;, &#39;json&#39;, &#39;xxx event&#39;</code>, you can determine these name as socket name. Particularly <code>&#39;connect&#39;, &#39;disconnecte&#39;</code> can be called when connecting or disconnecting.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/test')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">handler</span><span class=\"params\">(json)</span>:</span></span><br><span class=\"line\">  print(<span class=\"string\">'receive json: '</span>, str(json))</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">\t<span class=\"keyword\">var</span> socket = io.connect(<span class=\"string\">'http://0.0.0.0:5001'</span>)</span></span><br><span class=\"line\"><span class=\"actionscript\">  socket.on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">()</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">    socket.emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'connected.'</span>&#125;)</span></span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Sending-Messages\"><a href=\"#Sending-Messages\" class=\"headerlink\" title=\"Sending Messages\"></a>Sending Messages</h1><p><code>emit()</code> used for named events , <code>send()</code> used for unamed events.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/chatroom')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx_event</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'xxx'</span>&#125;, namespace=<span class=\"string\">'/chatroom'</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>Important</strong></p>\n<p>You can emit message in a router with <code>socketio.emit(&#39;xxx event&#39;, resp, namespace=&#39;/chatroom&#39;)</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@app.rout('/send')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">send</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">\tsocketio.emit(<span class=\"string\">'xxx event'</span>, resp, namespace=<span class=\"string\">'/chatroom'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>You can’t use <code>emit()</code> without context of <code>socketio</code>, you should use <code>socketio.emit()</code>.</p>\n<h1 id=\"Broadcasting\"><a href=\"#Broadcasting\" class=\"headerlink\" title=\"Broadcasting\"></a>Broadcasting</h1><p>If broadcasting is enabled, all the clients connected to the namespace will receive the message.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/chatroom')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx_event</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'xxx'</span>&#125;, namespace=<span class=\"string\">'/chatroom'</span>, broadcast=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Rooms\"><a href=\"#Rooms\" class=\"headerlink\" title=\"Rooms\"></a>Rooms</h1><p>Users can receive messages from the room they are in.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('join')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_join</span><span class=\"params\">(data)</span>:</span></span><br><span class=\"line\">    username = data[<span class=\"string\">'username'</span>]</span><br><span class=\"line\">    room = data[<span class=\"string\">'room'</span>]</span><br><span class=\"line\">    join_room(room)</span><br><span class=\"line\">    send(username + <span class=\"string\">' has entered the room.'</span>, to=room)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@socketio.on('leave')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_leave</span><span class=\"params\">(data)</span>:</span></span><br><span class=\"line\">    username = data[<span class=\"string\">'username'</span>]</span><br><span class=\"line\">    room = data[<span class=\"string\">'room'</span>]</span><br><span class=\"line\">    leave_room(room)</span><br><span class=\"line\">    send(username + <span class=\"string\">' has left the room.'</span>, to=room)</span><br></pre></td></tr></table></figure>\n\n<p>Use <code>to</code> argument set which room the message should be sent to.</p>\n<h1 id=\"Class-Based-Events\"><a href=\"#Class-Based-Events\" class=\"headerlink\" title=\"Class-Based Events\"></a>Class-Based Events</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_socketio <span class=\"keyword\">import</span> Namespace, emit</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyCustomNamespace</span><span class=\"params\">(Namespace)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_connect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_disconnect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_my_event</span><span class=\"params\">(self, data)</span>:</span></span><br><span class=\"line\">        emit(<span class=\"string\">'my_response'</span>, data)</span><br><span class=\"line\"></span><br><span class=\"line\">socketio.on_namespace(MyCustomNamespace(<span class=\"string\">'/test'</span>))  <span class=\"comment\"># Assign namespace</span></span><br></pre></td></tr></table></figure>\n\n<p>All the event is defined by the methods with <code>on_</code> prefix.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9mbGFzay1zb2NrZXRpby5yZWFkdGhlZG9jcy5pbw==\">https://flask-socketio.readthedocs.io<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Start\"><a href=\"#Start\" class=\"headerlink\" title=\"Start\"></a>Start</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_socketio <span class=\"keyword\">import</span> SocketIO</span><br><span class=\"line\"></span><br><span class=\"line\">socketio = SocketIO(app)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Receiving-Messages\"><a href=\"#Receiving-Messages\" class=\"headerlink\" title=\"Receiving Messages\"></a>Receiving Messages</h1><p>The event name is determined. <code>&#39;message&#39;, &#39;json&#39;, &#39;xxx event&#39;</code>, you can determine these name as socket name. Particularly <code>&#39;connect&#39;, &#39;disconnecte&#39;</code> can be called when connecting or disconnecting.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/test')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">handler</span><span class=\"params\">(json)</span>:</span></span><br><span class=\"line\">  print(<span class=\"string\">'receive json: '</span>, str(json))</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\">\t<span class=\"keyword\">var</span> socket = io.connect(<span class=\"string\">'http://0.0.0.0:5001'</span>)</span></span><br><span class=\"line\"><span class=\"actionscript\">  socket.on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">()</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">    socket.emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'connected.'</span>&#125;)</span></span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Sending-Messages\"><a href=\"#Sending-Messages\" class=\"headerlink\" title=\"Sending Messages\"></a>Sending Messages</h1><p><code>emit()</code> used for named events , <code>send()</code> used for unamed events.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/chatroom')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx_event</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'xxx'</span>&#125;, namespace=<span class=\"string\">'/chatroom'</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>Important</strong></p>\n<p>You can emit message in a router with <code>socketio.emit(&#39;xxx event&#39;, resp, namespace=&#39;/chatroom&#39;)</code>.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@app.rout('/send')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">send</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">\tsocketio.emit(<span class=\"string\">'xxx event'</span>, resp, namespace=<span class=\"string\">'/chatroom'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>You can’t use <code>emit()</code> without context of <code>socketio</code>, you should use <code>socketio.emit()</code>.</p>\n<h1 id=\"Broadcasting\"><a href=\"#Broadcasting\" class=\"headerlink\" title=\"Broadcasting\"></a>Broadcasting</h1><p>If broadcasting is enabled, all the clients connected to the namespace will receive the message.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('xxx event', namespace='/chatroom')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">xxx_event</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  emit(<span class=\"string\">'xxx event'</span>, &#123;<span class=\"string\">'data'</span>: <span class=\"string\">'xxx'</span>&#125;, namespace=<span class=\"string\">'/chatroom'</span>, broadcast=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"Rooms\"><a href=\"#Rooms\" class=\"headerlink\" title=\"Rooms\"></a>Rooms</h1><p>Users can receive messages from the room they are in.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@socketio.on('join')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_join</span><span class=\"params\">(data)</span>:</span></span><br><span class=\"line\">    username = data[<span class=\"string\">'username'</span>]</span><br><span class=\"line\">    room = data[<span class=\"string\">'room'</span>]</span><br><span class=\"line\">    join_room(room)</span><br><span class=\"line\">    send(username + <span class=\"string\">' has entered the room.'</span>, to=room)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@socketio.on('leave')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_leave</span><span class=\"params\">(data)</span>:</span></span><br><span class=\"line\">    username = data[<span class=\"string\">'username'</span>]</span><br><span class=\"line\">    room = data[<span class=\"string\">'room'</span>]</span><br><span class=\"line\">    leave_room(room)</span><br><span class=\"line\">    send(username + <span class=\"string\">' has left the room.'</span>, to=room)</span><br></pre></td></tr></table></figure>\n\n<p>Use <code>to</code> argument set which room the message should be sent to.</p>\n<h1 id=\"Class-Based-Events\"><a href=\"#Class-Based-Events\" class=\"headerlink\" title=\"Class-Based Events\"></a>Class-Based Events</h1><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask_socketio <span class=\"keyword\">import</span> Namespace, emit</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyCustomNamespace</span><span class=\"params\">(Namespace)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_connect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_disconnect</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_my_event</span><span class=\"params\">(self, data)</span>:</span></span><br><span class=\"line\">        emit(<span class=\"string\">'my_response'</span>, data)</span><br><span class=\"line\"></span><br><span class=\"line\">socketio.on_namespace(MyCustomNamespace(<span class=\"string\">'/test'</span>))  <span class=\"comment\"># Assign namespace</span></span><br></pre></td></tr></table></figure>\n\n<p>All the event is defined by the methods with <code>on_</code> prefix.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9mbGFzay1zb2NrZXRpby5yZWFkdGhlZG9jcy5pbw==\">https://flask-socketio.readthedocs.io<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"HTTP comprehension","_content":"\n# Introduction\n\n## Features\n\n- no connection: process one request in each connection.\n- no status: if current transaction needs previous information, it should be transfered again.\n- media independent: any type of media that is able to process can be transferred.\n\n## URI & URL\n\nURI (Uniform Resource Identifiers), is a abstract concept.\n\nURL (Uniform Resource Locator), a specific URI, can locate a specific resource.\n\n# Request\n\n## Request contains\n\n- Request line(Method, URL, HTTP version)\n- Header(key&value)\n- CR LF\n- Body(Only in POST method*)\n\n## GET\n\n```http\nGET /xxxxxxx.jpg HTTP/1.1  # section 1\nHost:img.mukewang.com  # section 2\nAccept:image/webp,image/*,*/*;q=0.8\nAccept-Encoding:gzip, deflate, sdch\nAccept-Language:zh-CN,zh;q=0.8\nCR(carriage reture) LF(line feed)  # section 3\n```\n\nSection1: Request line\n\nSection2: Header\n\nSection3: CR LF\n\nBody not in GET method.\n\n## POST\n\n```http\nPOST / HTTP1.1  # seciton 1\nHost:www.wrox.com  # section 2\nUser-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)\nContent-Type:application/x-www-form-urlencoded\nContent-Length:40\nConnection: Keep-Alive\n  # section 3\nname=Professional%20Ajax&publisher=Wiley  # section 4\n```\n\nSection1: Request line\n\nSection2: Header\n\nSection3: CR LF\n\nSection4: Body(type defined by Content-Type in Header)\n\n## GET & POST\n\nUsually GET method pass value through params which is attached to URL, and body is empty. Although in current HTTP version, GET method pass value through body is accepted. We should follow the common sense that do not put value in body.\n\n# Respond\n\n## Respond contains\n\n- Respond line(HTTP version, Status code, Reason phrase)\n- Header\n- CR LF\n- Body\n\n```http\nHTTP/1.1 200 OK  # section 1\nDate: Fri, 22 May 2009 06:07:21 GMT  # section 2\nContent-Type: text/html; charset=UTF-8\n  # section 3\n<html>  # section 4\n      <head></head>\n      <body>\n            <!--body goes here-->\n      </body>\n</html>\n```\n\nSection1: Respond line\n\nSection2: Header\n\nSection3: CR LF\n\nSection4: Body\n\n# Parameters\n\n## Status code\n\n| code | describe     |\n| ---- | ------------ |\n| 1xx  | infomation   |\n| 2xx  | success      |\n| 3xx  | redirection  |\n| 4xx  | client error |\n| 5xx  | server error |\n\n## Content-Type\n\n**application/x-www-form-urlencoded**\n\ndefault method, only tansfer text\n\n```\nPOST  HTTP/1.1\nHost: test.app.com\nContent-Type: application/x-www-form-urlencoded\nCache-Control: no-cache\nPostman-Token: e00dbaf5-15e8-3667-6fc5-48ee3cc89758\n\nkey1=value1&key2=value2\n```\n\n**multipart/form-data**\n\ntransfer text or files\n\n```\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\n\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"filekey\"; filename=\"\"\nContent-Type: \n\n\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"textkey\"\n```\n\nYou can transfer text and files at one time. The Body is seperated by boundary.\n\n**application/json**\n\nassign date type in Body\n\n```\n{\n\t'name': 'edlison'\n}\n```\n\nYou need to serialize the data before tansfering.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/ranyonsue/p/5984001.html\n\nhttps://zhuanlan.zhihu.com/p/45173862\n\nhttps://www.cnblogs.com/wbl001/p/12050751.html","source":"_posts/web/http.md","raw":"---\ntitle: HTTP comprehension\ncategories:\n- Web\ntags:\n- http\n---\n\n# Introduction\n\n## Features\n\n- no connection: process one request in each connection.\n- no status: if current transaction needs previous information, it should be transfered again.\n- media independent: any type of media that is able to process can be transferred.\n\n## URI & URL\n\nURI (Uniform Resource Identifiers), is a abstract concept.\n\nURL (Uniform Resource Locator), a specific URI, can locate a specific resource.\n\n# Request\n\n## Request contains\n\n- Request line(Method, URL, HTTP version)\n- Header(key&value)\n- CR LF\n- Body(Only in POST method*)\n\n## GET\n\n```http\nGET /xxxxxxx.jpg HTTP/1.1  # section 1\nHost:img.mukewang.com  # section 2\nAccept:image/webp,image/*,*/*;q=0.8\nAccept-Encoding:gzip, deflate, sdch\nAccept-Language:zh-CN,zh;q=0.8\nCR(carriage reture) LF(line feed)  # section 3\n```\n\nSection1: Request line\n\nSection2: Header\n\nSection3: CR LF\n\nBody not in GET method.\n\n## POST\n\n```http\nPOST / HTTP1.1  # seciton 1\nHost:www.wrox.com  # section 2\nUser-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)\nContent-Type:application/x-www-form-urlencoded\nContent-Length:40\nConnection: Keep-Alive\n  # section 3\nname=Professional%20Ajax&publisher=Wiley  # section 4\n```\n\nSection1: Request line\n\nSection2: Header\n\nSection3: CR LF\n\nSection4: Body(type defined by Content-Type in Header)\n\n## GET & POST\n\nUsually GET method pass value through params which is attached to URL, and body is empty. Although in current HTTP version, GET method pass value through body is accepted. We should follow the common sense that do not put value in body.\n\n# Respond\n\n## Respond contains\n\n- Respond line(HTTP version, Status code, Reason phrase)\n- Header\n- CR LF\n- Body\n\n```http\nHTTP/1.1 200 OK  # section 1\nDate: Fri, 22 May 2009 06:07:21 GMT  # section 2\nContent-Type: text/html; charset=UTF-8\n  # section 3\n<html>  # section 4\n      <head></head>\n      <body>\n            <!--body goes here-->\n      </body>\n</html>\n```\n\nSection1: Respond line\n\nSection2: Header\n\nSection3: CR LF\n\nSection4: Body\n\n# Parameters\n\n## Status code\n\n| code | describe     |\n| ---- | ------------ |\n| 1xx  | infomation   |\n| 2xx  | success      |\n| 3xx  | redirection  |\n| 4xx  | client error |\n| 5xx  | server error |\n\n## Content-Type\n\n**application/x-www-form-urlencoded**\n\ndefault method, only tansfer text\n\n```\nPOST  HTTP/1.1\nHost: test.app.com\nContent-Type: application/x-www-form-urlencoded\nCache-Control: no-cache\nPostman-Token: e00dbaf5-15e8-3667-6fc5-48ee3cc89758\n\nkey1=value1&key2=value2\n```\n\n**multipart/form-data**\n\ntransfer text or files\n\n```\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\n\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"filekey\"; filename=\"\"\nContent-Type: \n\n\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"textkey\"\n```\n\nYou can transfer text and files at one time. The Body is seperated by boundary.\n\n**application/json**\n\nassign date type in Body\n\n```\n{\n\t'name': 'edlison'\n}\n```\n\nYou need to serialize the data before tansfering.\n\n\n\n\n\n\n\n----\n\nReference\n\nhttps://www.cnblogs.com/ranyonsue/p/5984001.html\n\nhttps://zhuanlan.zhihu.com/p/45173862\n\nhttps://www.cnblogs.com/wbl001/p/12050751.html","slug":"web/http","published":1,"date":"2021-07-07T13:59:04.040Z","updated":"2021-07-11T09:11:37.525Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983s00hu018o6321gw47","content":"<h1 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h1><h2 id=\"Features\"><a href=\"#Features\" class=\"headerlink\" title=\"Features\"></a>Features</h2><ul>\n<li>no connection: process one request in each connection.</li>\n<li>no status: if current transaction needs previous information, it should be transfered again.</li>\n<li>media independent: any type of media that is able to process can be transferred.</li>\n</ul>\n<h2 id=\"URI-amp-URL\"><a href=\"#URI-amp-URL\" class=\"headerlink\" title=\"URI &amp; URL\"></a>URI &amp; URL</h2><p>URI (Uniform Resource Identifiers), is a abstract concept.</p>\n<p>URL (Uniform Resource Locator), a specific URI, can locate a specific resource.</p>\n<h1 id=\"Request\"><a href=\"#Request\" class=\"headerlink\" title=\"Request\"></a>Request</h1><h2 id=\"Request-contains\"><a href=\"#Request-contains\" class=\"headerlink\" title=\"Request contains\"></a>Request contains</h2><ul>\n<li>Request line(Method, URL, HTTP version)</li>\n<li>Header(key&amp;value)</li>\n<li>CR LF</li>\n<li>Body(Only in POST method*)</li>\n</ul>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /xxxxxxx.jpg HTTP/1.1  # section 1</span><br><span class=\"line\">Host:img.mukewang.com  # section 2</span><br><span class=\"line\">Accept:image/webp,image/*,*/*;q=0.8</span><br><span class=\"line\">Accept-Encoding:gzip, deflate, sdch</span><br><span class=\"line\">Accept-Language:zh-CN,zh;q=0.8</span><br><span class=\"line\">CR(carriage reture) LF(line feed)  # section 3</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Request line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Body not in GET method.</p>\n<h2 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST / HTTP1.1  # seciton 1</span><br><span class=\"line\">Host:www.wrox.com  # section 2</span><br><span class=\"line\">User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)</span><br><span class=\"line\"><span class=\"attribute\">Content-Type:application/x-www-form-urlencoded</span></span><br><span class=\"line\"><span class=\"attribute\">Content-Length:40</span></span><br><span class=\"line\"><span class=\"attribute\">Connection</span>: Keep-Alive</span><br><span class=\"line\">  # section 3</span><br><span class=\"line\">name=Professional%20Ajax&amp;publisher=Wiley  # section 4</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Request line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Section4: Body(type defined by Content-Type in Header)</p>\n<h2 id=\"GET-amp-POST\"><a href=\"#GET-amp-POST\" class=\"headerlink\" title=\"GET &amp; POST\"></a>GET &amp; POST</h2><p>Usually GET method pass value through params which is attached to URL, and body is empty. Although in current HTTP version, GET method pass value through body is accepted. We should follow the common sense that do not put value in body.</p>\n<h1 id=\"Respond\"><a href=\"#Respond\" class=\"headerlink\" title=\"Respond\"></a>Respond</h1><h2 id=\"Respond-contains\"><a href=\"#Respond-contains\" class=\"headerlink\" title=\"Respond contains\"></a>Respond contains</h2><ul>\n<li>Respond line(HTTP version, Status code, Reason phrase)</li>\n<li>Header</li>\n<li>CR LF</li>\n<li>Body</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 <span class=\"number\">200</span> OK  # section 1</span><br><span class=\"line\"><span class=\"attribute\">Date</span>: Fri, 22 May 2009 06:07:21 GMT  # section 2</span><br><span class=\"line\"><span class=\"attribute\">Content-Type</span>: text/html; charset=UTF-8</span><br><span class=\"line\">  # section 3</span><br><span class=\"line\">&lt;html&gt;  # section 4</span><br><span class=\"line\">      &lt;head&gt;&lt;/head&gt;</span><br><span class=\"line\">      &lt;body&gt;</span><br><span class=\"line\">            &lt;!--body goes here--&gt;</span><br><span class=\"line\">      &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Respond line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Section4: Body</p>\n<h1 id=\"Parameters\"><a href=\"#Parameters\" class=\"headerlink\" title=\"Parameters\"></a>Parameters</h1><h2 id=\"Status-code\"><a href=\"#Status-code\" class=\"headerlink\" title=\"Status code\"></a>Status code</h2><table>\n<thead>\n<tr>\n<th>code</th>\n<th>describe</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1xx</td>\n<td>infomation</td>\n</tr>\n<tr>\n<td>2xx</td>\n<td>success</td>\n</tr>\n<tr>\n<td>3xx</td>\n<td>redirection</td>\n</tr>\n<tr>\n<td>4xx</td>\n<td>client error</td>\n</tr>\n<tr>\n<td>5xx</td>\n<td>server error</td>\n</tr>\n</tbody></table>\n<h2 id=\"Content-Type\"><a href=\"#Content-Type\" class=\"headerlink\" title=\"Content-Type\"></a>Content-Type</h2><p><strong>application/x-www-form-urlencoded</strong></p>\n<p>default method, only tansfer text</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST  HTTP&#x2F;1.1</span><br><span class=\"line\">Host: test.app.com</span><br><span class=\"line\">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class=\"line\">Cache-Control: no-cache</span><br><span class=\"line\">Postman-Token: e00dbaf5-15e8-3667-6fc5-48ee3cc89758</span><br><span class=\"line\"></span><br><span class=\"line\">key1&#x3D;value1&amp;key2&#x3D;value2</span><br></pre></td></tr></table></figure>\n\n<p><strong>multipart/form-data</strong></p>\n<p>transfer text or files</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\"></span><br><span class=\"line\">------WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\">Content-Disposition: form-data; name&#x3D;&quot;filekey&quot;; filename&#x3D;&quot;&quot;</span><br><span class=\"line\">Content-Type: </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">------WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\">Content-Disposition: form-data; name&#x3D;&quot;textkey&quot;</span><br></pre></td></tr></table></figure>\n\n<p>You can transfer text and files at one time. The Body is seperated by boundary.</p>\n<p><strong>application/json</strong></p>\n<p>assign date type in Body</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">\t&#39;name&#39;: &#39;edlison&#39;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You need to serialize the data before tansfering.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcmFueW9uc3VlL3AvNTk4NDAwMS5odG1s\">https://www.cnblogs.com/ranyonsue/p/5984001.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80NTE3Mzg2Mg==\">https://zhuanlan.zhihu.com/p/45173862<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2JsMDAxL3AvMTIwNTA3NTEuaHRtbA==\">https://www.cnblogs.com/wbl001/p/12050751.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h1><h2 id=\"Features\"><a href=\"#Features\" class=\"headerlink\" title=\"Features\"></a>Features</h2><ul>\n<li>no connection: process one request in each connection.</li>\n<li>no status: if current transaction needs previous information, it should be transfered again.</li>\n<li>media independent: any type of media that is able to process can be transferred.</li>\n</ul>\n<h2 id=\"URI-amp-URL\"><a href=\"#URI-amp-URL\" class=\"headerlink\" title=\"URI &amp; URL\"></a>URI &amp; URL</h2><p>URI (Uniform Resource Identifiers), is a abstract concept.</p>\n<p>URL (Uniform Resource Locator), a specific URI, can locate a specific resource.</p>\n<h1 id=\"Request\"><a href=\"#Request\" class=\"headerlink\" title=\"Request\"></a>Request</h1><h2 id=\"Request-contains\"><a href=\"#Request-contains\" class=\"headerlink\" title=\"Request contains\"></a>Request contains</h2><ul>\n<li>Request line(Method, URL, HTTP version)</li>\n<li>Header(key&amp;value)</li>\n<li>CR LF</li>\n<li>Body(Only in POST method*)</li>\n</ul>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /xxxxxxx.jpg HTTP/1.1  # section 1</span><br><span class=\"line\">Host:img.mukewang.com  # section 2</span><br><span class=\"line\">Accept:image/webp,image/*,*/*;q=0.8</span><br><span class=\"line\">Accept-Encoding:gzip, deflate, sdch</span><br><span class=\"line\">Accept-Language:zh-CN,zh;q=0.8</span><br><span class=\"line\">CR(carriage reture) LF(line feed)  # section 3</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Request line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Body not in GET method.</p>\n<h2 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST / HTTP1.1  # seciton 1</span><br><span class=\"line\">Host:www.wrox.com  # section 2</span><br><span class=\"line\">User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)</span><br><span class=\"line\"><span class=\"attribute\">Content-Type:application/x-www-form-urlencoded</span></span><br><span class=\"line\"><span class=\"attribute\">Content-Length:40</span></span><br><span class=\"line\"><span class=\"attribute\">Connection</span>: Keep-Alive</span><br><span class=\"line\">  # section 3</span><br><span class=\"line\">name=Professional%20Ajax&amp;publisher=Wiley  # section 4</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Request line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Section4: Body(type defined by Content-Type in Header)</p>\n<h2 id=\"GET-amp-POST\"><a href=\"#GET-amp-POST\" class=\"headerlink\" title=\"GET &amp; POST\"></a>GET &amp; POST</h2><p>Usually GET method pass value through params which is attached to URL, and body is empty. Although in current HTTP version, GET method pass value through body is accepted. We should follow the common sense that do not put value in body.</p>\n<h1 id=\"Respond\"><a href=\"#Respond\" class=\"headerlink\" title=\"Respond\"></a>Respond</h1><h2 id=\"Respond-contains\"><a href=\"#Respond-contains\" class=\"headerlink\" title=\"Respond contains\"></a>Respond contains</h2><ul>\n<li>Respond line(HTTP version, Status code, Reason phrase)</li>\n<li>Header</li>\n<li>CR LF</li>\n<li>Body</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 <span class=\"number\">200</span> OK  # section 1</span><br><span class=\"line\"><span class=\"attribute\">Date</span>: Fri, 22 May 2009 06:07:21 GMT  # section 2</span><br><span class=\"line\"><span class=\"attribute\">Content-Type</span>: text/html; charset=UTF-8</span><br><span class=\"line\">  # section 3</span><br><span class=\"line\">&lt;html&gt;  # section 4</span><br><span class=\"line\">      &lt;head&gt;&lt;/head&gt;</span><br><span class=\"line\">      &lt;body&gt;</span><br><span class=\"line\">            &lt;!--body goes here--&gt;</span><br><span class=\"line\">      &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p>Section1: Respond line</p>\n<p>Section2: Header</p>\n<p>Section3: CR LF</p>\n<p>Section4: Body</p>\n<h1 id=\"Parameters\"><a href=\"#Parameters\" class=\"headerlink\" title=\"Parameters\"></a>Parameters</h1><h2 id=\"Status-code\"><a href=\"#Status-code\" class=\"headerlink\" title=\"Status code\"></a>Status code</h2><table>\n<thead>\n<tr>\n<th>code</th>\n<th>describe</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1xx</td>\n<td>infomation</td>\n</tr>\n<tr>\n<td>2xx</td>\n<td>success</td>\n</tr>\n<tr>\n<td>3xx</td>\n<td>redirection</td>\n</tr>\n<tr>\n<td>4xx</td>\n<td>client error</td>\n</tr>\n<tr>\n<td>5xx</td>\n<td>server error</td>\n</tr>\n</tbody></table>\n<h2 id=\"Content-Type\"><a href=\"#Content-Type\" class=\"headerlink\" title=\"Content-Type\"></a>Content-Type</h2><p><strong>application/x-www-form-urlencoded</strong></p>\n<p>default method, only tansfer text</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST  HTTP&#x2F;1.1</span><br><span class=\"line\">Host: test.app.com</span><br><span class=\"line\">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class=\"line\">Cache-Control: no-cache</span><br><span class=\"line\">Postman-Token: e00dbaf5-15e8-3667-6fc5-48ee3cc89758</span><br><span class=\"line\"></span><br><span class=\"line\">key1&#x3D;value1&amp;key2&#x3D;value2</span><br></pre></td></tr></table></figure>\n\n<p><strong>multipart/form-data</strong></p>\n<p>transfer text or files</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\"></span><br><span class=\"line\">------WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\">Content-Disposition: form-data; name&#x3D;&quot;filekey&quot;; filename&#x3D;&quot;&quot;</span><br><span class=\"line\">Content-Type: </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">------WebKitFormBoundary7MA4YWxkTrZu0gW</span><br><span class=\"line\">Content-Disposition: form-data; name&#x3D;&quot;textkey&quot;</span><br></pre></td></tr></table></figure>\n\n<p>You can transfer text and files at one time. The Body is seperated by boundary.</p>\n<p><strong>application/json</strong></p>\n<p>assign date type in Body</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">\t&#39;name&#39;: &#39;edlison&#39;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>You need to serialize the data before tansfering.</p>\n<hr>\n<p>Reference</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcmFueW9uc3VlL3AvNTk4NDAwMS5odG1s\">https://www.cnblogs.com/ranyonsue/p/5984001.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80NTE3Mzg2Mg==\">https://zhuanlan.zhihu.com/p/45173862<i class=\"fa fa-external-link-alt\"></i></span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2JsMDAxL3AvMTIwNTA3NTEuaHRtbA==\">https://www.cnblogs.com/wbl001/p/12050751.html<i class=\"fa fa-external-link-alt\"></i></span></p>\n"},{"title":"Flask-SocketIO development experience","_content":"\n# socketio init\n\nsocketio must input flask_app context, so the web service is constructed based socketio web service.\n\n\n\n# join_room\n\nIf you want to create private room, you need to apply `join_room(room_id)` when users entering. After this, we can use `emit(to=room_id)` to send message to specific room.\n\n\n\n# socketio.on\n\nis used to receive message.\n\n\n\n# socketio.emit\n\nis used to send message.","source":"_posts/web/socketio-dev.md","raw":"---\ntitle: Flask-SocketIO development experience\ncategories:\n- Web\ntags:\n- python\n- flask\n---\n\n# socketio init\n\nsocketio must input flask_app context, so the web service is constructed based socketio web service.\n\n\n\n# join_room\n\nIf you want to create private room, you need to apply `join_room(room_id)` when users entering. After this, we can use `emit(to=room_id)` to send message to specific room.\n\n\n\n# socketio.on\n\nis used to receive message.\n\n\n\n# socketio.emit\n\nis used to send message.","slug":"web/socketio-dev","published":1,"date":"2021-07-13T03:29:48.448Z","updated":"2021-07-13T03:39:27.318Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckutx983t00hy018o68qy9wlr","content":"<h1 id=\"socketio-init\"><a href=\"#socketio-init\" class=\"headerlink\" title=\"socketio init\"></a>socketio init</h1><p>socketio must input flask_app context, so the web service is constructed based socketio web service.</p>\n<h1 id=\"join-room\"><a href=\"#join-room\" class=\"headerlink\" title=\"join_room\"></a>join_room</h1><p>If you want to create private room, you need to apply <code>join_room(room_id)</code> when users entering. After this, we can use <code>emit(to=room_id)</code> to send message to specific room.</p>\n<h1 id=\"socketio-on\"><a href=\"#socketio-on\" class=\"headerlink\" title=\"socketio.on\"></a>socketio.on</h1><p>is used to receive message.</p>\n<h1 id=\"socketio-emit\"><a href=\"#socketio-emit\" class=\"headerlink\" title=\"socketio.emit\"></a>socketio.emit</h1><p>is used to send message.</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"socketio-init\"><a href=\"#socketio-init\" class=\"headerlink\" title=\"socketio init\"></a>socketio init</h1><p>socketio must input flask_app context, so the web service is constructed based socketio web service.</p>\n<h1 id=\"join-room\"><a href=\"#join-room\" class=\"headerlink\" title=\"join_room\"></a>join_room</h1><p>If you want to create private room, you need to apply <code>join_room(room_id)</code> when users entering. After this, we can use <code>emit(to=room_id)</code> to send message to specific room.</p>\n<h1 id=\"socketio-on\"><a href=\"#socketio-on\" class=\"headerlink\" title=\"socketio.on\"></a>socketio.on</h1><p>is used to receive message.</p>\n<h1 id=\"socketio-emit\"><a href=\"#socketio-emit\" class=\"headerlink\" title=\"socketio.emit\"></a>socketio.emit</h1><p>is used to send message.</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckutx97xi000a018o71oc73ow","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xn000g018obuui4re1"},{"post_id":"ckutx97xd0005018obiwz1q4i","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xp000k018oa38m9kyy"},{"post_id":"ckutx97xe0006018o5rd6913r","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xq000n018o3srz246r"},{"post_id":"ckutx97xh0009018ogjw41es0","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xs000s018ods51dxpj"},{"post_id":"ckutx97xt000x018oedougqvx","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xw0015018o7yil1rrn"},{"post_id":"ckutx97xu000z018ofp3y4343","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97xx0018018o0j4u8cnm"},{"post_id":"ckutx97xv0014018o8vb81axl","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97y0001e018odlt7gjt5"},{"post_id":"ckutx97y2001n018oc0lmgliy","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97y5001v018ocfx4ev8w"},{"post_id":"ckutx97y1001j018ohcc9aw4j","category_id":"ckutx97y2001m018o48vvek6x","_id":"ckutx97y6001x018o09swfwa1"},{"post_id":"ckutx97y4001r018od8at9e5d","category_id":"ckutx97y2001m018o48vvek6x","_id":"ckutx97y70020018o0s4q3mvz"},{"post_id":"ckutx97y5001u018o11z81erg","category_id":"ckutx97y2001m018o48vvek6x","_id":"ckutx97y80024018o3mg6ae2g"},{"post_id":"ckutx97y6001z018o7w4h0p4j","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97y90029018o7js00d34"},{"post_id":"ckutx97y80026018o0ovkcgze","category_id":"ckutx97y70022018ocevj08cg","_id":"ckutx97yg002f018o6vzg7k52"},{"post_id":"ckutx97y5001w018ohlg3bj25","category_id":"ckutx97y70022018ocevj08cg","_id":"ckutx97yh002i018oaddpe5n0"},{"post_id":"ckutx97ye002b018od770h4s5","category_id":"ckutx97y70022018ocevj08cg","_id":"ckutx97yh002k018o1ri4floq"},{"post_id":"ckutx97yf002e018oeekb5fvu","category_id":"ckutx97y70022018ocevj08cg","_id":"ckutx97yi002m018o55mo7bfg"},{"post_id":"ckutx97yg002h018o7x2vayp9","category_id":"ckutx97y70022018ocevj08cg","_id":"ckutx97yj002q018o0nnn8g0t"},{"post_id":"ckutx97y90028018oappx7719","category_id":"ckutx97yf002d018oclkj9ofd","_id":"ckutx97yk002t018oahc961ys"},{"post_id":"ckutx97yh002j018o2oub1mps","category_id":"ckutx97yf002d018oclkj9ofd","_id":"ckutx97yl002w018o0bvy67eh"},{"post_id":"ckutx97yh002l018ogd4sdkvg","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97ym002y018og9hu3qd8"},{"post_id":"ckutx97yj002p018oca7d5nk7","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97yn0031018od7gxd3gm"},{"post_id":"ckutx97yk002s018o2grb69ar","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97yn0034018obrljetna"},{"post_id":"ckutx97z5004k018o2txu9pfr","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97z8004s018o08pbbqy0"},{"post_id":"ckutx97z6004m018oh4ynajqv","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97z9004v018o3ik5g1oo"},{"post_id":"ckutx97za004y018oczdf97uu","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zd0056018o3q731643"},{"post_id":"ckutx97zd0055018o5nlo23cj","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zf005e018o292xeqjr"},{"post_id":"ckutx97zd0059018o1ehe1a2x","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zg005i018o3cnp30a6"},{"post_id":"ckutx97zg005h018o8oqxcbl1","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zj005q018obsppb8od"},{"post_id":"ckutx97zh005k018o1qoieoiz","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zk005u018o7nveasvr"},{"post_id":"ckutx97zj005t018o4y9m97h1","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zm0061018o1i1g9qkt"},{"post_id":"ckutx97zm0060018o61dkgm6j","category_id":"ckutx97zo0066018o0766a1nj","_id":"ckutx97zr006h018obrpy0y43"},{"post_id":"ckutx97zs006l018ocpyngp2n","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zw006t018o2yyi1i1s"},{"post_id":"ckutx97zu006n018o8mfoa4s4","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zx006w018o3fnladmr"},{"post_id":"ckutx97zu006p018odgiu57tz","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zx006z018o9iwx19nj"},{"post_id":"ckutx97zw006v018o1tm77xde","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx97zz0074018ogep7fie3"},{"post_id":"ckutx97zx006y018o75sc0g5s","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx98000078018o9phaa98p"},{"post_id":"ckutx9801007e018oepj65he1","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx9804007l018o1mag6yn7"},{"post_id":"ckutx9806007q018o6wuw7trb","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx9808007w018o27vc487d"},{"post_id":"ckutx9806007r018o0dzkbwcv","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx98090080018o8o5ma038"},{"post_id":"ckutx9808007v018o2zk6gfij","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx980a0084018ofbwkhs8x"},{"post_id":"ckutx9809007y018o0m047o5z","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx980b0087018oh24k3azh"},{"post_id":"ckutx9807007s018od5z26jbl","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx980c008a018ohfhkb1w2"},{"post_id":"ckutx9807007s018od5z26jbl","category_id":"ckutx9809007z018o61ez9ir9","_id":"ckutx980d008e018ogydb9r7n"},{"post_id":"ckutx9810009r018o8brr0sco","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx9813009w018ofazh88tq"},{"post_id":"ckutx9813009v018o4nam6ptb","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981500a1018o03rjd2sy"},{"post_id":"ckutx9813009x018oae438a4m","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981700a4018o2tmtd6rk"},{"post_id":"ckutx981500a0018ohaal7xyl","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981900aa018o1tio3idf"},{"post_id":"ckutx981700a6018o809hew9j","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981a00ag018o3c1ecoyy"},{"post_id":"ckutx981800a9018o079o4sac","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981c00aj018o1bid811k"},{"post_id":"ckutx981900ac018ohiy94qkc","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981d00an018oca4eg7b7"},{"post_id":"ckutx981a00af018oe3lf2xmq","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981d00aq018o4n1k8x2n"},{"post_id":"ckutx981b00ai018o7z5x0x66","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981e00at018ocpnq7tnw"},{"post_id":"ckutx981j00b6018o2zuu9k71","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx981l00bc018o7nstbrov"},{"post_id":"ckutx981i00b4018o6ze31eih","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981o00bj018ogwb26ayw"},{"post_id":"ckutx981l00bb018oajvcfdh5","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981s00bm018ogwelak3p"},{"post_id":"ckutx981j00b9018oaniffzks","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981t00bo018o18o6b658"},{"post_id":"ckutx981n00bi018oazopd622","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981u00br018o2wodawu4"},{"post_id":"ckutx981p00bl018o52ne4zqz","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981v00bu018o5h3cerfa"},{"post_id":"ckutx981u00bq018oadnb1qkz","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981x00c0018oc6ypb0pb"},{"post_id":"ckutx981v00bt018o3pr6fwt1","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981y00c3018o5wfkfom6"},{"post_id":"ckutx981v00bx018o92n9bq3m","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx981z00c7018o8a76d8em"},{"post_id":"ckutx981x00bz018o8o1j0cd9","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982100ca018ogg097130"},{"post_id":"ckutx981y00c2018obue70btw","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982200cd018o68nx6v66"},{"post_id":"ckutx981z00c6018o20sm4xtd","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982300cg018o6geg2gfm"},{"post_id":"ckutx982000c9018o78usaxs9","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982400cj018odjdk0g2t"},{"post_id":"ckutx982200cf018of6u27vp2","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982500co018od6wm1uad"},{"post_id":"ckutx982300ci018o5yohb0ks","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982700cr018o17dn6p4h"},{"post_id":"ckutx982500cn018o21la6loe","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982900cx018oamdd9ouy"},{"post_id":"ckutx982600cq018ohe0k5wyz","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982900d0018o30ht52vb"},{"post_id":"ckutx982700ct018oa1xq7ui0","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982a00d3018o2yy4ha4t"},{"post_id":"ckutx982b00d6018odb0e9qai","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982h00dd018oerdbgw3r"},{"post_id":"ckutx982900cz018oc2g4an57","category_id":"ckutx982b00d5018o0f4qh7e9","_id":"ckutx982h00dg018oc3w3ek3n"},{"post_id":"ckutx982i00dh018o21jjht95","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982k00dn018o3kz9gcm0"},{"post_id":"ckutx982j00dk018o1yl4ar8p","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982m00ds018ocgz84ov0"},{"post_id":"ckutx982l00dq018og7brh9n7","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982p00e0018o09mqb9p8"},{"post_id":"ckutx982m00du018o1kvwehkl","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982q00e4018oequi7alc"},{"post_id":"ckutx982k00dm018ofum7aqed","category_id":"ckutx981j00b7018odfnub5sx","_id":"ckutx982r00e7018o9so1h6g0"},{"post_id":"ckutx982k00dm018ofum7aqed","category_id":"ckutx982m00dr018o24o33euq","_id":"ckutx982r00eb018o1dr236xw"},{"post_id":"ckutx982o00dz018oc1oee1gs","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982s00ef018o2fg9gxjs"},{"post_id":"ckutx982p00e3018od07mdufh","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982t00ei018ogaf2610j"},{"post_id":"ckutx982r00ea018ohsfyebb0","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982u00ek018o9xvo6uh2"},{"post_id":"ckutx982s00ed018o1vnv646w","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982v00en018o1neghh31"},{"post_id":"ckutx982t00eh018ohzr70p6b","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982w00eq018og5rshake"},{"post_id":"ckutx982t00eh018ohzr70p6b","category_id":"ckutx982s00ee018o0pw37vhs","_id":"ckutx982x00eu018o1fxg7gxy"},{"post_id":"ckutx982q00e6018oht69f2s5","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx982y00ex018o4nt4byti"},{"post_id":"ckutx982q00e6018oht69f2s5","category_id":"ckutx982s00ee018o0pw37vhs","_id":"ckutx983000f2018o8c1nehez"},{"post_id":"ckutx982u00ej018o6q8oc6y2","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx983100f5018o9mk813rz"},{"post_id":"ckutx982u00ej018o6q8oc6y2","category_id":"ckutx982s00ee018o0pw37vhs","_id":"ckutx983100f8018o7gbggptc"},{"post_id":"ckutx982v00em018oebxm9lon","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx983200fc018o1pgl3hsd"},{"post_id":"ckutx982v00ep018oepfahz7s","category_id":"ckutx97xg0007018o1j7a72h0","_id":"ckutx983500ff018o3btde83r"},{"post_id":"ckutx982w00es018octkahtpm","category_id":"ckutx982z00ez018oav3c5i60","_id":"ckutx983600fj018ohsye2cmo"},{"post_id":"ckutx983700fr018of9ka64jx","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983b00g1018of4q3a6fx"},{"post_id":"ckutx983500fi018o5h04cc75","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983c00g5018o6dm85oqo"},{"post_id":"ckutx983800fu018o1hrt8tlt","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983e00g8018o8jxe0zor"},{"post_id":"ckutx983900fx018ob0q185oo","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983f00gc018oamnsd4ev"},{"post_id":"ckutx983600fl018ogjo5c91z","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983g00gg018o8r9u3fp7"},{"post_id":"ckutx983700fp018oeixt5dsr","category_id":"ckutx983700fo018o1js36klc","_id":"ckutx983h00gk018ochrhhlw3"},{"post_id":"ckutx983e00gb018oh2hl0gy3","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983i00go018odcdbgzy0"},{"post_id":"ckutx983a00g0018ocjg27dxd","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983j00gs018oapfz8387"},{"post_id":"ckutx983f00gf018oe0agf2rf","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983k00gv018ock166kzr"},{"post_id":"ckutx983g00gj018o12vghz18","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983m00gz018o6hi06vqc"},{"post_id":"ckutx983b00g4018oh0rn9f69","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983m00h2018o97gk7i6d"},{"post_id":"ckutx983i00gn018ocrtl4ty6","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983n00h6018o6eh25f2s"},{"post_id":"ckutx983j00gr018o50wg7hm3","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983o00h9018of41zbsuu"},{"post_id":"ckutx983d00g7018oh5en4gqm","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983p00hd018ofzz52ax5"},{"post_id":"ckutx983k00gu018o2nafbaqx","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983p00hg018o4cma5lm5"},{"post_id":"ckutx983l00gy018oeb1b2324","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983q00hk018o0gpcef9d"},{"post_id":"ckutx983m00h1018o80vf7x12","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983r00ho018obiq44jxy"},{"post_id":"ckutx983o00h8018o5r1fdikw","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983s00hr018o0ecl6p9l"},{"post_id":"ckutx983o00hc018ogsjh2hzr","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983t00hv018o92dmfdyl"},{"post_id":"ckutx983q00hj018oavb34zo1","category_id":"ckutx983e00g9018oaoip3ok2","_id":"ckutx983u00hz018oeuyna1dj"},{"post_id":"ckutx983p00hf018oh2tzd854","category_id":"ckutx983q00hm018odd7redrj","_id":"ckutx983u00i2018o59tr90do"},{"post_id":"ckutx983r00hq018o53mx2ls1","category_id":"ckutx983t00hx018ohy5t88uv","_id":"ckutx983v00i9018oclmg09lx"},{"post_id":"ckutx983s00hu018o6321gw47","category_id":"ckutx983t00hx018ohy5t88uv","_id":"ckutx983w00id018o7hv8hfq0"},{"post_id":"ckutx983t00hy018o68qy9wlr","category_id":"ckutx983t00hx018ohy5t88uv","_id":"ckutx983w00ih018o8ezjh49q"}],"PostTag":[{"post_id":"ckutx97xd0005018obiwz1q4i","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx97xp000l018o67sw5gsr"},{"post_id":"ckutx97xd0005018obiwz1q4i","tag_id":"ckutx97xj000d018o7aiugdqk","_id":"ckutx97xq000o018o0lwkfs7x"},{"post_id":"ckutx97xe0006018o5rd6913r","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx97xu000y018o87a4358j"},{"post_id":"ckutx97xe0006018o5rd6913r","tag_id":"ckutx97xq000p018o8nfmc6pl","_id":"ckutx97xu0010018o1wyaajvo"},{"post_id":"ckutx97xe0006018o5rd6913r","tag_id":"ckutx97xj000d018o7aiugdqk","_id":"ckutx97xv0013018odkbs5ilr"},{"post_id":"ckutx97xh0009018ogjw41es0","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx97xx0019018oawlg5z4o"},{"post_id":"ckutx97xh0009018ogjw41es0","tag_id":"ckutx97xq000p018o8nfmc6pl","_id":"ckutx97xx001b018oevtm6jrj"},{"post_id":"ckutx97xi000a018o71oc73ow","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx97y0001f018o94lg6w6x"},{"post_id":"ckutx97xi000a018o71oc73ow","tag_id":"ckutx97xq000p018o8nfmc6pl","_id":"ckutx97y0001h018o3zajcuhi"},{"post_id":"ckutx97xj000b018o7o6442ji","tag_id":"ckutx97xy001c018ohu8177o8","_id":"ckutx97y1001k018o2pnceuo8"},{"post_id":"ckutx97xm000e018o6r9g6wf2","tag_id":"ckutx97y0001i018o74aoc1j7","_id":"ckutx97y3001p018oa8no397b"},{"post_id":"ckutx97xp000m018o8by38md3","tag_id":"ckutx97y0001i018o74aoc1j7","_id":"ckutx97y5001t018o33th81io"},{"post_id":"ckutx97xq000q018o8vfw2ov2","tag_id":"ckutx97y4001s018oe94w8dw7","_id":"ckutx97y70021018o1czi1zc0"},{"post_id":"ckutx97xr000r018ob2gwc60e","tag_id":"ckutx97y6001y018ohff650sl","_id":"ckutx97y90027018ocwuh2xo2"},{"post_id":"ckutx97xs000u018o7rak9bgb","tag_id":"ckutx97y4001s018oe94w8dw7","_id":"ckutx97ye002c018o7ebogc1a"},{"post_id":"ckutx97xt000x018oedougqvx","tag_id":"ckutx97ya002a018o8bf30csb","_id":"ckutx97yj002o018o32ixafxd"},{"post_id":"ckutx97xt000x018oedougqvx","tag_id":"ckutx97yg002g018o3nkv68lr","_id":"ckutx97yj002r018oddii5vnl"},{"post_id":"ckutx97xu000z018ofp3y4343","tag_id":"ckutx97ya002a018o8bf30csb","_id":"ckutx97yn0032018o64a1cvgu"},{"post_id":"ckutx97xu000z018ofp3y4343","tag_id":"ckutx97yk002u018ohi1aafxq","_id":"ckutx97yn0035018ohu8j4il4"},{"post_id":"ckutx97xv0012018o1qyh9ifh","tag_id":"ckutx97ym002z018ohnte0oa2","_id":"ckutx97yo0038018ogki76w7p"},{"post_id":"ckutx97xv0014018o8vb81axl","tag_id":"ckutx97ya002a018o8bf30csb","_id":"ckutx97yr003f018oadfz3esm"},{"post_id":"ckutx97xv0014018o8vb81axl","tag_id":"ckutx97yp003a018oe7vo8rzr","_id":"ckutx97yr003h018o8k2sh6j5"},{"post_id":"ckutx97y0001g018o55ei3pqs","tag_id":"ckutx97yq003d018oetja88q9","_id":"ckutx97yt003k018o1dam7vjy"},{"post_id":"ckutx97y1001j018ohcc9aw4j","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97yw003s018oddz5evzb"},{"post_id":"ckutx97y1001j018ohcc9aw4j","tag_id":"ckutx97yu003n018o0owc8ca9","_id":"ckutx97yx003u018o9voabm5l"},{"post_id":"ckutx97y2001n018oc0lmgliy","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx97yz0040018ob0sifpe8"},{"post_id":"ckutx97y2001n018oc0lmgliy","tag_id":"ckutx97yx003v018o9ejq7i1n","_id":"ckutx97yz0042018ohtjwbgho"},{"post_id":"ckutx97y4001r018od8at9e5d","tag_id":"ckutx97yz003z018og2fc22u1","_id":"ckutx97z00046018oc8zxeucc"},{"post_id":"ckutx97y5001u018o11z81erg","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97z3004d018oh269fwmz"},{"post_id":"ckutx97y5001u018o11z81erg","tag_id":"ckutx97z10048018o95jwf8zz","_id":"ckutx97z4004f018o1zb51gqx"},{"post_id":"ckutx97y6001z018o7w4h0p4j","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx97z6004l018ofbhi09iv"},{"post_id":"ckutx97y6001z018o7w4h0p4j","tag_id":"ckutx97z4004g018o22oj4kj8","_id":"ckutx97z7004n018o1t97904t"},{"post_id":"ckutx97z5004k018o2txu9pfr","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97z8004q018oem7fasbf"},{"post_id":"ckutx97z6004m018oh4ynajqv","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97z8004t018o88skhq4w"},{"post_id":"ckutx97y80026018o0ovkcgze","tag_id":"ckutx97z5004j018odyjr3p18","_id":"ckutx97za004x018odgv234w3"},{"post_id":"ckutx97y90028018oappx7719","tag_id":"ckutx97z7004p018odn0r2dia","_id":"ckutx97zb004z018o576b3ok4"},{"post_id":"ckutx97z8004u018o69st9r67","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zc0052018o2jpf0ald"},{"post_id":"ckutx97za004y018oczdf97uu","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zc0054018o3w3m8v1q"},{"post_id":"ckutx97yf002e018oeekb5fvu","tag_id":"ckutx97z9004w018o9d6d0h7l","_id":"ckutx97zd0057018o4gribxxq"},{"post_id":"ckutx97zc0053018o21bog3op","tag_id":"ckutx97yz003z018og2fc22u1","_id":"ckutx97ze005a018o6sjieksf"},{"post_id":"ckutx97yh002j018o2oub1mps","tag_id":"ckutx97zc0051018o0kffgbg7","_id":"ckutx97ze005c018o3hbr8u2b"},{"post_id":"ckutx97zd0055018o5nlo23cj","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zg005g018ohgzg6ome"},{"post_id":"ckutx97zd0059018o1ehe1a2x","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zg005j018o97jrgnpo"},{"post_id":"ckutx97zg005h018o8oqxcbl1","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zi005m018oha8g51jp"},{"post_id":"ckutx97yh002l018ogd4sdkvg","tag_id":"ckutx97zd0058018oa05edkg3","_id":"ckutx97zi005o018ohafyb022"},{"post_id":"ckutx97yh002l018ogd4sdkvg","tag_id":"ckutx97zf005f018ofa4o5n74","_id":"ckutx97zj005s018ogz6h1j95"},{"post_id":"ckutx97zh005k018o1qoieoiz","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zk005v018o2dikgfut"},{"post_id":"ckutx97yj002p018oca7d5nk7","tag_id":"ckutx97zd0058018oa05edkg3","_id":"ckutx97zm005z018obr8ce7wk"},{"post_id":"ckutx97yj002p018oca7d5nk7","tag_id":"ckutx97zj005r018o7w833rd7","_id":"ckutx97zn0062018oeegvay4q"},{"post_id":"ckutx97yk002s018o2grb69ar","tag_id":"ckutx97zd0058018oa05edkg3","_id":"ckutx97zo0065018oac8kh5ns"},{"post_id":"ckutx97z7004o018o0j54a5es","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zp006a018odn3i61cd"},{"post_id":"ckutx97z7004o018o0j54a5es","tag_id":"ckutx97zn0063018o1x642538","_id":"ckutx97zq006c018o9pyz5hqn"},{"post_id":"ckutx97z8004r018ofzza6trb","tag_id":"ckutx97zp0068018o2t2ufo7h","_id":"ckutx97zr006f018o5qas009o"},{"post_id":"ckutx97zb0050018o9y0lar28","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx97zu006o018ohg8s9qse"},{"post_id":"ckutx97zb0050018o9y0lar28","tag_id":"ckutx97zs006j018o7c5b65rt","_id":"ckutx97zv006q018o31sm62s6"},{"post_id":"ckutx97zf005d018od3jf3csc","tag_id":"ckutx97zt006m018o5ljy449u","_id":"ckutx97zw006u018oa8midt9s"},{"post_id":"ckutx97zi005n018ogqh6hdcq","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zy0070018o1z7hfdp3"},{"post_id":"ckutx97zi005n018ogqh6hdcq","tag_id":"ckutx97zn0063018o1x642538","_id":"ckutx97zy0072018o0jhp532q"},{"post_id":"ckutx97zi005p018o0yuz4bqf","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx97zz0076018ogk0l8y8o"},{"post_id":"ckutx97zi005p018o0yuz4bqf","tag_id":"ckutx97zx006x018oemw70o6z","_id":"ckutx98000079018o2ylc6cc0"},{"post_id":"ckutx97zj005t018o4y9m97h1","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx9801007d018o8jzw8hs7"},{"post_id":"ckutx97zj005t018o4y9m97h1","tag_id":"ckutx97zz0075018o39555jwz","_id":"ckutx9802007f018o8cfp4fyv"},{"post_id":"ckutx97zl005y018o8vto41z3","tag_id":"ckutx9800007b018ocf5ve2qq","_id":"ckutx9805007m018o0g62g3mg"},{"post_id":"ckutx97zl005y018o8vto41z3","tag_id":"ckutx9802007g018odrujbnzn","_id":"ckutx9805007o018o3yyj9lky"},{"post_id":"ckutx97zp0069018o4pjia2f7","tag_id":"ckutx9800007b018ocf5ve2qq","_id":"ckutx9808007u018o5zjkards"},{"post_id":"ckutx97zp0069018o4pjia2f7","tag_id":"ckutx9805007p018o9svhb9uc","_id":"ckutx9808007x018o5ofag6ai"},{"post_id":"ckutx97zr006g018odcgp1jer","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx980b0088018ob0b8185m"},{"post_id":"ckutx97zr006g018odcgp1jer","tag_id":"ckutx98090081018o66x0dav5","_id":"ckutx980c008b018o0r8nhsjl"},{"post_id":"ckutx97zr006i018o2x8gdeh5","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx980d008f018od6mj2a8e"},{"post_id":"ckutx97zs006l018ocpyngp2n","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx980f008j018oflmngadq"},{"post_id":"ckutx97zs006l018ocpyngp2n","tag_id":"ckutx980c008c018o28q8bu4a","_id":"ckutx980f008k018oam5r49yb"},{"post_id":"ckutx97zu006n018o8mfoa4s4","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx980f008m018o0fwv1wd5"},{"post_id":"ckutx97zu006n018o8mfoa4s4","tag_id":"ckutx980e008h018ogg8p7e0j","_id":"ckutx980f008n018obbqzhj8h"},{"post_id":"ckutx97zu006p018odgiu57tz","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx980g008q018o5dem951m"},{"post_id":"ckutx97zu006p018odgiu57tz","tag_id":"ckutx980f008o018o0ml669at","_id":"ckutx980g008r018ogpkj8vhu"},{"post_id":"ckutx97zw006v018o1tm77xde","tag_id":"ckutx980g008p018o5l876waq","_id":"ckutx980g008t018odx1z85j8"},{"post_id":"ckutx97zx006y018o75sc0g5s","tag_id":"ckutx980g008s018o11d8gvv8","_id":"ckutx980h008w018obstsh2ei"},{"post_id":"ckutx97zx006y018o75sc0g5s","tag_id":"ckutx980g008u018o7p6y6fu3","_id":"ckutx980h008x018o0phnc5k4"},{"post_id":"ckutx97zy0071018o7z8x87a8","tag_id":"ckutx980g008v018o4wdmc4ku","_id":"ckutx980h008z018ob0iddiyx"},{"post_id":"ckutx97zz0077018ohbspebpt","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx980h0091018obn332qp9"},{"post_id":"ckutx97zz0077018ohbspebpt","tag_id":"ckutx980c008c018o28q8bu4a","_id":"ckutx980h0092018o9oij2emi"},{"post_id":"ckutx9800007a018o0wed7l0i","tag_id":"ckutx980h0090018o05mf3p37","_id":"ckutx980i0094018o1wntgmwy"},{"post_id":"ckutx9801007e018oepj65he1","tag_id":"ckutx980h0093018o6e0jgws2","_id":"ckutx980i0096018o24ifbgcv"},{"post_id":"ckutx9802007i018oe8pk3fbz","tag_id":"ckutx980i0095018odt4l3c58","_id":"ckutx980i0098018o6ka74uyt"},{"post_id":"ckutx9804007k018o0iengjlq","tag_id":"ckutx980h0093018o6e0jgws2","_id":"ckutx980j009a018obj4y0ywn"},{"post_id":"ckutx9806007q018o6wuw7trb","tag_id":"ckutx980h0093018o6e0jgws2","_id":"ckutx980j009c018oh9lj0l2e"},{"post_id":"ckutx9806007r018o0dzkbwcv","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx980k009f018o0gy5auhe"},{"post_id":"ckutx9806007r018o0dzkbwcv","tag_id":"ckutx980j009d018o0ybihnm1","_id":"ckutx980k009g018ohfoq7y9e"},{"post_id":"ckutx9807007s018od5z26jbl","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx980k009i018o8g064il6"},{"post_id":"ckutx9807007s018od5z26jbl","tag_id":"ckutx980j009e018oezdj54pq","_id":"ckutx980k009j018o9sam26rj"},{"post_id":"ckutx9808007v018o2zk6gfij","tag_id":"ckutx980h0093018o6e0jgws2","_id":"ckutx980k009l018ofqxvdogn"},{"post_id":"ckutx9809007y018o0m047o5z","tag_id":"ckutx980k009k018oaqdh98w9","_id":"ckutx980l009n018o8a0n47c3"},{"post_id":"ckutx980e008i018o8oizfad9","tag_id":"ckutx980l009m018ohsdl7g7z","_id":"ckutx980l009p018oebbe06qu"},{"post_id":"ckutx980e008i018o8oizfad9","tag_id":"ckutx980l009o018oeafog7d8","_id":"ckutx980l009q018o5thw10su"},{"post_id":"ckutx9810009r018o8brr0sco","tag_id":"ckutx9812009t018o2k53efpc","_id":"ckutx981700a5018o1hp9398g"},{"post_id":"ckutx9810009r018o8brr0sco","tag_id":"ckutx9814009y018o75ct55eq","_id":"ckutx981800a7018oboxkew87"},{"post_id":"ckutx981500a0018ohaal7xyl","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx981900ab018o2hxphlqx"},{"post_id":"ckutx9812009u018o1gd204ft","tag_id":"ckutx981500a2018o4b6jetku","_id":"ckutx981900ad018o9rf575i5"},{"post_id":"ckutx981700a6018o809hew9j","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx981b00ah018o5boqadrx"},{"post_id":"ckutx9813009v018o4nam6ptb","tag_id":"ckutx981800a8018o8anw5g06","_id":"ckutx981c00ak018ob798d6bo"},{"post_id":"ckutx981900ac018ohiy94qkc","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx981d00ao018o3x6k1id1"},{"post_id":"ckutx9813009x018oae438a4m","tag_id":"ckutx981800a8018o8anw5g06","_id":"ckutx981d00ar018ochmih5va"},{"post_id":"ckutx981700a3018o0clr0uzd","tag_id":"ckutx981c00al018odekb6cfj","_id":"ckutx981e00av018o1nxt216k"},{"post_id":"ckutx981a00af018oe3lf2xmq","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx981h00b0018o82fo35lw"},{"post_id":"ckutx981a00af018oe3lf2xmq","tag_id":"ckutx981e00au018obsb6hz6j","_id":"ckutx981i00b2018o6g2e9kqp"},{"post_id":"ckutx981b00ai018o7z5x0x66","tag_id":"ckutx981g00ay018o88wb2zzo","_id":"ckutx981i00b5018o062097dl"},{"post_id":"ckutx981d00ap018oh5czfm50","tag_id":"ckutx981i00b3018odukret71","_id":"ckutx981m00bf018oeo1p1x76"},{"post_id":"ckutx981d00ap018oh5czfm50","tag_id":"ckutx981j00b8018ofwjk8le3","_id":"ckutx981n00bh018o70s6fgka"},{"post_id":"ckutx981e00as018o3r4ydc5e","tag_id":"ckutx981l00be018o9oio6n3u","_id":"ckutx981u00bs018o52bzbb7p"},{"post_id":"ckutx981e00as018o3r4ydc5e","tag_id":"ckutx981o00bk018o6n9hfnoq","_id":"ckutx981v00bv018ofprf9y37"},{"post_id":"ckutx981u00bq018oadnb1qkz","tag_id":"ckutx97z5004j018odyjr3p18","_id":"ckutx981x00by018oculi6isv"},{"post_id":"ckutx981f00aw018o3atzhzbx","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx981x00c1018oaiu2gxib"},{"post_id":"ckutx981f00aw018o3atzhzbx","tag_id":"ckutx981t00bp018o6r2u4m87","_id":"ckutx981z00c5018ocwnyegs6"},{"post_id":"ckutx981g00az018o1cva16c3","tag_id":"ckutx981v00bw018objc55myd","_id":"ckutx981z00c8018od7wzeppy"},{"post_id":"ckutx981h00b1018o22bj24jv","tag_id":"ckutx981y00c4018oddm9h6gr","_id":"ckutx982200ce018oa2ln5tl4"},{"post_id":"ckutx981j00b9018oaniffzks","tag_id":"ckutx982100cb018ohf5a44ao","_id":"ckutx982400ck018ofiwmakdu"},{"post_id":"ckutx981m00bg018of1ij8lsz","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982600cp018oe37c0yeb"},{"post_id":"ckutx981m00bg018of1ij8lsz","tag_id":"ckutx982300ch018oe79vd6zy","_id":"ckutx982700cs018o5kkoea1m"},{"post_id":"ckutx982400cl018ohwbogfd3","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982800cv018odpoqb33o"},{"post_id":"ckutx981n00bi018oazopd622","tag_id":"ckutx982500cm018o7v5w0alj","_id":"ckutx982900cy018od76fgg3v"},{"post_id":"ckutx981p00bl018o52ne4zqz","tag_id":"ckutx982800cu018ocus8exph","_id":"ckutx982a00d4018o48kwenwi"},{"post_id":"ckutx981v00bx018o92n9bq3m","tag_id":"ckutx982a00d1018o7kax7jeo","_id":"ckutx982d00d9018o0lhd82bi"},{"post_id":"ckutx981x00bz018o8o1j0cd9","tag_id":"ckutx982c00d7018obs5rewfe","_id":"ckutx982h00de018o14suanb9"},{"post_id":"ckutx981y00c2018obue70btw","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982m00dt018oboyjcrgi"},{"post_id":"ckutx981y00c2018obue70btw","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx982n00dv018o97n3b71u"},{"post_id":"ckutx981y00c2018obue70btw","tag_id":"ckutx982800cu018ocus8exph","_id":"ckutx982o00dy018odnlz9itr"},{"post_id":"ckutx981y00c2018obue70btw","tag_id":"ckutx982j00dl018o6ib0bdpy","_id":"ckutx982p00e1018o5zzo6ma5"},{"post_id":"ckutx982k00do018oeoctbwg6","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982q00e5018o5htj4fyd"},{"post_id":"ckutx981z00c6018o20sm4xtd","tag_id":"ckutx982l00dp018oex9k339j","_id":"ckutx982r00e8018o4c1d8nip"},{"post_id":"ckutx982n00dx018ogvo0gn6e","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982r00ec018o17gihfeo"},{"post_id":"ckutx982000c9018o78usaxs9","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx982v00eo018o7vur5j4n"},{"post_id":"ckutx982000c9018o78usaxs9","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx982w00er018o8ex85h5v"},{"post_id":"ckutx982000c9018o78usaxs9","tag_id":"ckutx982j00dl018o6ib0bdpy","_id":"ckutx982y00ev018o86z1cpa3"},{"post_id":"ckutx982000c9018o78usaxs9","tag_id":"ckutx982r00e9018odm5u375c","_id":"ckutx982y00ey018ogjt4e5jo"},{"post_id":"ckutx982000c9018o78usaxs9","tag_id":"ckutx982800cu018ocus8exph","_id":"ckutx983000f3018o7e9n3aeg"},{"post_id":"ckutx982200cc018oc5q996dl","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983100f6018o7f4rem4p"},{"post_id":"ckutx982200cc018oc5q996dl","tag_id":"ckutx982u00el018o2q9wcp91","_id":"ckutx983200fa018o3ncnashv"},{"post_id":"ckutx982200cf018of6u27vp2","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983400fd018o8fva1h6t"},{"post_id":"ckutx982200cf018of6u27vp2","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983500fh018oag3l9mc8"},{"post_id":"ckutx982200cf018of6u27vp2","tag_id":"ckutx982z00f1018obl39834j","_id":"ckutx983600fk018o4ku05l49"},{"post_id":"ckutx982300ci018o5yohb0ks","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983700fn018ocsfh5q13"},{"post_id":"ckutx982300ci018o5yohb0ks","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983700fq018oezbc6klo"},{"post_id":"ckutx982500cn018o21la6loe","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983800ft018o3hkvgps7"},{"post_id":"ckutx982500cn018o21la6loe","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983900fw018o05cees07"},{"post_id":"ckutx982600cq018ohe0k5wyz","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983a00fz018oe8ml82wf"},{"post_id":"ckutx982600cq018ohe0k5wyz","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983b00g3018o6hac0ktd"},{"post_id":"ckutx982800cw018o0qn4c2nw","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983e00ga018ohta9576p"},{"post_id":"ckutx982800cw018o0qn4c2nw","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983f00gd018o9unffl5g"},{"post_id":"ckutx982800cw018o0qn4c2nw","tag_id":"ckutx983a00fy018og3j47i2e","_id":"ckutx983g00gi018oeor782aj"},{"post_id":"ckutx983b00g4018oh0rn9f69","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx983h00gl018o2uww1zhf"},{"post_id":"ckutx983b00g4018oh0rn9f69","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx983j00gq018o2k75houi"},{"post_id":"ckutx983e00gb018oh2hl0gy3","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx983k00gt018ohtsq3yo5"},{"post_id":"ckutx983e00gb018oh2hl0gy3","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx983l00gx018ofbjcbs6l"},{"post_id":"ckutx983g00gj018o12vghz18","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx983m00h0018ogm2ker91"},{"post_id":"ckutx983g00gj018o12vghz18","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx983n00h4018ofup0bhqf"},{"post_id":"ckutx983g00gj018o12vghz18","tag_id":"ckutx97z10048018o95jwf8zz","_id":"ckutx983n00h7018o8fmafo0y"},{"post_id":"ckutx982900cz018oc2g4an57","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983o00ha018og22vapww"},{"post_id":"ckutx982900cz018oc2g4an57","tag_id":"ckutx982g00db018o8i5faa7t","_id":"ckutx983p00he018oc0hj3lxq"},{"post_id":"ckutx982900cz018oc2g4an57","tag_id":"ckutx983f00ge018o3m8l9q25","_id":"ckutx983q00hh018oaiqw8c46"},{"post_id":"ckutx982900cz018oc2g4an57","tag_id":"ckutx983i00gm018o1ktx1o1w","_id":"ckutx983q00hl018o4smq724m"},{"post_id":"ckutx982b00d6018odb0e9qai","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983r00hp018ocv62hg0d"},{"post_id":"ckutx982b00d6018odb0e9qai","tag_id":"ckutx983k00gw018o4xtkgukk","_id":"ckutx983s00ht018ofhhb7z7v"},{"post_id":"ckutx982i00dh018o21jjht95","tag_id":"ckutx983n00h3018o9sip1y1d","_id":"ckutx983t00hw018odp6t7m4v"},{"post_id":"ckutx983o00h8018o5r1fdikw","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx983u00i1018o4hsqfktj"},{"post_id":"ckutx983o00h8018o5r1fdikw","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx983u00i3018o6ep27v6w"},{"post_id":"ckutx983o00h8018o5r1fdikw","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx983v00i6018o1axp42v2"},{"post_id":"ckutx983o00h8018o5r1fdikw","tag_id":"ckutx97yx003v018o9ejq7i1n","_id":"ckutx983v00i7018ofxb08bfk"},{"post_id":"ckutx983o00hc018ogsjh2hzr","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx983w00ib018o4sghfpsv"},{"post_id":"ckutx983o00hc018ogsjh2hzr","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx983w00ic018oavuf9e94"},{"post_id":"ckutx982j00dk018o1yl4ar8p","tag_id":"ckutx983o00hb018o7bj8azct","_id":"ckutx983w00ie018o1dmz4vhy"},{"post_id":"ckutx982k00dm018ofum7aqed","tag_id":"ckutx983q00hi018o70ih7sle","_id":"ckutx983w00ig018o6v0ud4df"},{"post_id":"ckutx982l00dq018og7brh9n7","tag_id":"ckutx983s00hs018od3wqcyt7","_id":"ckutx983x00ii018ogu04aj9z"},{"post_id":"ckutx983t00hy018o68qy9wlr","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx983x00ik018o3sve6ero"},{"post_id":"ckutx983t00hy018o68qy9wlr","tag_id":"ckutx980j009d018o0ybihnm1","_id":"ckutx983x00il018o014yereo"},{"post_id":"ckutx982m00du018o1kvwehkl","tag_id":"ckutx983s00hs018od3wqcyt7","_id":"ckutx983x00in018ogs4d9kff"},{"post_id":"ckutx982o00dz018oc1oee1gs","tag_id":"ckutx983s00hs018od3wqcyt7","_id":"ckutx983x00io018o4sqw33b0"},{"post_id":"ckutx982o00dz018oc1oee1gs","tag_id":"ckutx983w00ia018o6pv9f5qw","_id":"ckutx983x00iq018obyjj094b"},{"post_id":"ckutx982p00e3018od07mdufh","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx983y00ir018o7pks6z17"},{"post_id":"ckutx982p00e3018od07mdufh","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx983y00it018ogd5ratg8"},{"post_id":"ckutx982p00e3018od07mdufh","tag_id":"ckutx983x00ij018ohk11egti","_id":"ckutx983y00iu018of3gvho0y"},{"post_id":"ckutx982p00e3018od07mdufh","tag_id":"ckutx983x00im018oeokugp7l","_id":"ckutx983z00iw018oayqhf5q0"},{"post_id":"ckutx982q00e6018oht69f2s5","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx983z00ix018of62a7cvu"},{"post_id":"ckutx982q00e6018oht69f2s5","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984000iz018ocfkbb5yb"},{"post_id":"ckutx982q00e6018oht69f2s5","tag_id":"ckutx983x00ij018ohk11egti","_id":"ckutx984000j0018o3y9mdr0d"},{"post_id":"ckutx982r00ea018ohsfyebb0","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984100j2018o92tw1zc9"},{"post_id":"ckutx982r00ea018ohsfyebb0","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984100j3018o7e01apr2"},{"post_id":"ckutx982r00ea018ohsfyebb0","tag_id":"ckutx983x00ij018ohk11egti","_id":"ckutx984100j5018o6b9sebbv"},{"post_id":"ckutx982s00ed018o1vnv646w","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984200j8018o0nfv8q23"},{"post_id":"ckutx982s00ed018o1vnv646w","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984200j9018oamwzhkql"},{"post_id":"ckutx982s00ed018o1vnv646w","tag_id":"ckutx984100j4018od5ly1xj7","_id":"ckutx984200jb018obvfa26vq"},{"post_id":"ckutx982s00ed018o1vnv646w","tag_id":"ckutx984100j6018o6zud3l25","_id":"ckutx984300jc018odlt8a64u"},{"post_id":"ckutx982t00eh018ohzr70p6b","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984300je018o95qxa16x"},{"post_id":"ckutx982t00eh018ohzr70p6b","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984300jf018of22we2fe"},{"post_id":"ckutx982t00eh018ohzr70p6b","tag_id":"ckutx983x00ij018ohk11egti","_id":"ckutx984400jh018o66gnf26n"},{"post_id":"ckutx982u00ej018o6q8oc6y2","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984400jj018o9yfa4org"},{"post_id":"ckutx982u00ej018o6q8oc6y2","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984400jk018oe0wo1vyn"},{"post_id":"ckutx982u00ej018o6q8oc6y2","tag_id":"ckutx983x00ij018ohk11egti","_id":"ckutx984500jm018o75mu5lk9"},{"post_id":"ckutx982v00em018oebxm9lon","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984500jo018oajrwdkt2"},{"post_id":"ckutx982v00em018oebxm9lon","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984600jp018ob0vth8wg"},{"post_id":"ckutx982v00em018oebxm9lon","tag_id":"ckutx984100j4018od5ly1xj7","_id":"ckutx984600jr018o34qa9tnk"},{"post_id":"ckutx982v00ep018oepfahz7s","tag_id":"ckutx97xh0008018oa7o1g3zt","_id":"ckutx984600jt018o1tcd8vsx"},{"post_id":"ckutx982v00ep018oepfahz7s","tag_id":"ckutx983w00if018o8415fx9v","_id":"ckutx984700ju018o2h2h5old"},{"post_id":"ckutx982v00ep018oepfahz7s","tag_id":"ckutx984100j4018od5ly1xj7","_id":"ckutx984700jw018o6eue48o8"},{"post_id":"ckutx982w00es018octkahtpm","tag_id":"ckutx984600js018o547g84ng","_id":"ckutx984700jx018oa4xoch51"},{"post_id":"ckutx982y00ew018o09fxhj0c","tag_id":"ckutx984700jv018offhw97ml","_id":"ckutx984700jz018oc79l4w60"},{"post_id":"ckutx983500fi018o5h04cc75","tag_id":"ckutx984700jy018o6vab1tpo","_id":"ckutx984800k2018oa02n55hp"},{"post_id":"ckutx983500fi018o5h04cc75","tag_id":"ckutx984700k0018occhecc38","_id":"ckutx984800k3018ofpj35ra1"},{"post_id":"ckutx983500fi018o5h04cc75","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984800k5018oehq07kwv"},{"post_id":"ckutx983700fp018oeixt5dsr","tag_id":"ckutx984700jy018o6vab1tpo","_id":"ckutx984800k6018o9h6wbzqr"},{"post_id":"ckutx983700fp018oeixt5dsr","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984900k8018odd8u3pdp"},{"post_id":"ckutx983700fr018of9ka64jx","tag_id":"ckutx984700jy018o6vab1tpo","_id":"ckutx984900k9018o3oih9jf3"},{"post_id":"ckutx983700fr018of9ka64jx","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx984900kb018o5xa8gijh"},{"post_id":"ckutx983700fr018of9ka64jx","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984900kc018obgxz28s2"},{"post_id":"ckutx983800fu018o1hrt8tlt","tag_id":"ckutx984700jy018o6vab1tpo","_id":"ckutx984a00ke018ocijhddni"},{"post_id":"ckutx983900fx018ob0q185oo","tag_id":"ckutx984900ka018ohew843sa","_id":"ckutx984a00kf018o5lyfbuoq"},{"post_id":"ckutx983a00g0018ocjg27dxd","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984b00ki018o3togarv5"},{"post_id":"ckutx983a00g0018ocjg27dxd","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx984b00kj018o3zi5elqt"},{"post_id":"ckutx983a00g0018ocjg27dxd","tag_id":"ckutx984900kd018ohvv87d1q","_id":"ckutx984b00kl018o6q1d874q"},{"post_id":"ckutx983a00g0018ocjg27dxd","tag_id":"ckutx984a00kg018o4gf3574y","_id":"ckutx984b00km018o1acbc7kt"},{"post_id":"ckutx983d00g7018oh5en4gqm","tag_id":"ckutx984a00kh018ocjsk2ogx","_id":"ckutx984c00ko018o9it40nla"},{"post_id":"ckutx983f00gf018oe0agf2rf","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984c00kp018oduxua3yk"},{"post_id":"ckutx983f00gf018oe0agf2rf","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx984c00kr018o5he9hr7l"},{"post_id":"ckutx983f00gf018oe0agf2rf","tag_id":"ckutx984b00kk018o8i4h9y33","_id":"ckutx984c00ks018oh7zq8pme"},{"post_id":"ckutx983i00gn018ocrtl4ty6","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx984d00ku018o3jx46yjk"},{"post_id":"ckutx983i00gn018ocrtl4ty6","tag_id":"ckutx984b00kn018ob76heub8","_id":"ckutx984d00kv018o2al90g3z"},{"post_id":"ckutx983j00gr018o50wg7hm3","tag_id":"ckutx984a00kh018ocjsk2ogx","_id":"ckutx984d00kw018oaoj08ks2"},{"post_id":"ckutx983k00gu018o2nafbaqx","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984d00ky018ofvsm6hom"},{"post_id":"ckutx983k00gu018o2nafbaqx","tag_id":"ckutx984d00kt018oamvef5hg","_id":"ckutx984d00kz018o94hrf3ot"},{"post_id":"ckutx983l00gy018oeb1b2324","tag_id":"ckutx984d00kx018oenef453k","_id":"ckutx984e00l1018o0cf35p60"},{"post_id":"ckutx983l00gy018oeb1b2324","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984e00l2018odv3k6w73"},{"post_id":"ckutx983m00h1018o80vf7x12","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984e00l4018o03cladli"},{"post_id":"ckutx983m00h1018o80vf7x12","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx984e00l5018o1qzea7i4"},{"post_id":"ckutx983m00h1018o80vf7x12","tag_id":"ckutx97yv003q018o64m22pzt","_id":"ckutx984f00l7018od2eca8t4"},{"post_id":"ckutx983m00h1018o80vf7x12","tag_id":"ckutx97yx003v018o9ejq7i1n","_id":"ckutx984f00l8018oacdndoce"},{"post_id":"ckutx983m00h1018o80vf7x12","tag_id":"ckutx984d00l0018o5lrc2vf7","_id":"ckutx984f00la018oe1le908j"},{"post_id":"ckutx983p00hf018oh2tzd854","tag_id":"ckutx984e00l3018o3uvo4vr7","_id":"ckutx984f00lb018ogv6a6tuv"},{"post_id":"ckutx983q00hj018oavb34zo1","tag_id":"ckutx97ys003j018o2yo7fjc3","_id":"ckutx984f00ld018oao6y2t09"},{"post_id":"ckutx983q00hj018oavb34zo1","tag_id":"ckutx97zq006e018o90qbg076","_id":"ckutx984f00le018o9hdoes49"},{"post_id":"ckutx983q00hj018oavb34zo1","tag_id":"ckutx984e00l6018oervw94i4","_id":"ckutx984f00lf018oebx99mcb"},{"post_id":"ckutx983r00hq018o53mx2ls1","tag_id":"ckutx9807007t018ogkx65uun","_id":"ckutx984g00lg018oalehcghn"},{"post_id":"ckutx983r00hq018o53mx2ls1","tag_id":"ckutx980j009d018o0ybihnm1","_id":"ckutx984g00lh018oe80y9x1c"},{"post_id":"ckutx983r00hq018o53mx2ls1","tag_id":"ckutx984f00l9018ofw7h9th4","_id":"ckutx984g00li018o2pl38y8o"},{"post_id":"ckutx983s00hu018o6321gw47","tag_id":"ckutx984f00lc018o0n1bgdqh","_id":"ckutx984g00lj018o8fkngg6k"}],"Tag":[{"name":"java","_id":"ckutx97xh0008018oa7o1g3zt"},{"name":"注解","_id":"ckutx97xj000d018o7aiugdqk"},{"name":"反射","_id":"ckutx97xq000p018o8nfmc6pl"},{"name":"consensus","_id":"ckutx97xy001c018ohu8177o8"},{"name":"eth","_id":"ckutx97y0001i018o74aoc1j7"},{"name":"mine","_id":"ckutx97y4001s018oe94w8dw7"},{"name":"security","_id":"ckutx97y6001y018ohff650sl"},{"name":"design","_id":"ckutx97ya002a018o8bf30csb"},{"name":"builder","_id":"ckutx97yg002g018o3nkv68lr"},{"name":"abstractfactory","_id":"ckutx97yk002u018ohi1aafxq"},{"name":"ipfs","_id":"ckutx97ym002z018ohnte0oa2"},{"name":"singleton","_id":"ckutx97yp003a018oe7vo8rzr"},{"name":"compose","_id":"ckutx97yq003d018oetja88q9"},{"name":"linux","_id":"ckutx97ys003j018o2yo7fjc3"},{"name":"neo4j","_id":"ckutx97yu003n018o0owc8ca9"},{"name":"docker","_id":"ckutx97yv003q018o64m22pzt"},{"name":"v2ray","_id":"ckutx97yx003v018o9ejq7i1n"},{"name":"mariadb","_id":"ckutx97yz003z018og2fc22u1"},{"name":"nginx","_id":"ckutx97z10048018o95jwf8zz"},{"name":"wordpress","_id":"ckutx97z4004g018o22oj4kj8"},{"name":"conv","_id":"ckutx97z5004j018odyjr3p18"},{"name":"order","_id":"ckutx97z7004p018odn0r2dia"},{"name":"rnn","_id":"ckutx97z9004w018o9d6d0h7l"},{"name":"k-line","_id":"ckutx97zc0051018o0kffgbg7"},{"name":"hadoop","_id":"ckutx97zd0058018oa05edkg3"},{"name":"hdfs","_id":"ckutx97zf005f018ofa4o5n74"},{"name":"mapreduce","_id":"ckutx97zj005r018o7w833rd7"},{"name":"ssh","_id":"ckutx97zn0063018o1x642538"},{"name":"firewall","_id":"ckutx97zp0068018o2t2ufo7h"},{"name":"ubuntu","_id":"ckutx97zq006e018o90qbg076"},{"name":"host","_id":"ckutx97zs006j018o7c5b65rt"},{"name":"port","_id":"ckutx97zt006m018o5ljy449u"},{"name":"redis","_id":"ckutx97zx006x018oemw70o6z"},{"name":"ftp","_id":"ckutx97zz0075018o39555jwz"},{"name":"cards","_id":"ckutx9800007b018ocf5ve2qq"},{"name":"pass","_id":"ckutx9802007g018odrujbnzn"},{"name":"cut","_id":"ckutx9805007p018o9svhb9uc"},{"name":"python","_id":"ckutx9807007t018ogkx65uun"},{"name":"design-pattern","_id":"ckutx98090081018o66x0dav5"},{"name":"springboot","_id":"ckutx980c008c018o28q8bu4a"},{"name":"anaconda","_id":"ckutx980e008h018ogg8p7e0j"},{"name":"conda","_id":"ckutx980f008o018o0ml669at"},{"name":"base64","_id":"ckutx980g008p018o5l876waq"},{"name":"reverse","_id":"ckutx980g008s018o11d8gvv8"},{"name":"cheatengine","_id":"ckutx980g008u018o7p6y6fu3"},{"name":"craftbrew","_id":"ckutx980g008v018o4wdmc4ku"},{"name":"coffee","_id":"ckutx980h0090018o05mf3p37"},{"name":"git","_id":"ckutx980h0093018o6e0jgws2"},{"name":"github","_id":"ckutx980i0095018odt4l3c58"},{"name":"flask","_id":"ckutx980j009d018o0ybihnm1"},{"name":"idea","_id":"ckutx980j009e018oezdj54pq"},{"name":"hexo","_id":"ckutx980k009k018oaqdh98w9"},{"name":"keyboard","_id":"ckutx980l009m018ohsdl7g7z"},{"name":"keycap","_id":"ckutx980l009o018oeafog7d8"},{"name":"live","_id":"ckutx9812009t018o2k53efpc"},{"name":"obs","_id":"ckutx9814009y018o75ct55eq"},{"name":"Mysql","_id":"ckutx981500a2018o4b6jetku"},{"name":"mac","_id":"ckutx981800a8018o8anw5g06"},{"name":"notion","_id":"ckutx981c00al018odekb6cfj"},{"name":"sys","_id":"ckutx981e00au018obsb6hz6j"},{"name":"scala","_id":"ckutx981g00ay018o88wb2zzo"},{"name":"shell","_id":"ckutx981i00b3018odukret71"},{"name":"zsh","_id":"ckutx981j00b8018ofwjk8le3"},{"name":"cloud","_id":"ckutx981l00be018o9oio6n3u"},{"name":"vps","_id":"ckutx981o00bk018o6n9hfnoq"},{"name":"tensorflow","_id":"ckutx981t00bp018o6r2u4m87"},{"name":"websocket","_id":"ckutx981v00bw018objc55myd"},{"name":"vpn","_id":"ckutx981y00c4018oddm9h6gr"},{"name":"batch_size","_id":"ckutx982100cb018ohf5a44ao"},{"name":"buildin","_id":"ckutx982300ch018oe79vd6zy"},{"name":"features","_id":"ckutx982500cm018o7v5w0alj"},{"name":"gan","_id":"ckutx982800cu018ocus8exph"},{"name":"loss","_id":"ckutx982a00d1018o7kax7jeo"},{"name":"math","_id":"ckutx982c00d7018obs5rewfe"},{"name":"pytorch","_id":"ckutx982g00db018o8i5faa7t"},{"name":"multi_view","_id":"ckutx982j00dl018o6ib0bdpy"},{"name":"metric","_id":"ckutx982l00dp018oex9k339j"},{"name":"anomaly","_id":"ckutx982r00e9018odm5u375c"},{"name":"matplotlib","_id":"ckutx982u00el018o2q9wcp91"},{"name":"tensor","_id":"ckutx982z00f1018obl39834j"},{"name":"random","_id":"ckutx983a00fy018og3j47i2e"},{"name":"chatbot","_id":"ckutx983f00ge018o3m8l9q25"},{"name":"seq2seq","_id":"ckutx983i00gm018o1ktx1o1w"},{"name":"nlp","_id":"ckutx983k00gw018o4xtkgukk"},{"name":"paper","_id":"ckutx983n00h3018o9sip1y1d"},{"name":"attention","_id":"ckutx983o00hb018o7bj8azct"},{"name":"XLNet","_id":"ckutx983q00hi018o70ih7sle"},{"name":"spark","_id":"ckutx983s00hs018od3wqcyt7"},{"name":"rdd","_id":"ckutx983w00ia018o6pv9f5qw"},{"name":"spring","_id":"ckutx983w00if018o8415fx9v"},{"name":"aop","_id":"ckutx983x00ij018ohk11egti"},{"name":"proxy","_id":"ckutx983x00im018oeokugp7l"},{"name":"ioc","_id":"ckutx984100j4018od5ly1xj7"},{"name":"bean","_id":"ckutx984100j6018o6zud3l25"},{"name":"deadpoetssociety","_id":"ckutx984600js018o547g84ng"},{"name":"speaking","_id":"ckutx984700jv018offhw97ml"},{"name":"vim","_id":"ckutx984700jy018o6vab1tpo"},{"name":"config","_id":"ckutx984700k0018occhecc38"},{"name":"nerdtree","_id":"ckutx984900ka018ohew843sa"},{"name":"aria2","_id":"ckutx984900kd018ohvv87d1q"},{"name":"ariang","_id":"ckutx984a00kg018o4gf3574y"},{"name":"ci","_id":"ckutx984a00kh018ocjsk2ogx"},{"name":"bbr","_id":"ckutx984b00kk018o8i4h9y33"},{"name":"domain","_id":"ckutx984b00kn018ob76heub8"},{"name":"webhook","_id":"ckutx984d00kt018oamvef5hg"},{"name":"sh","_id":"ckutx984d00kx018oenef453k"},{"name":"x-ui","_id":"ckutx984d00l0018o5lrc2vf7"},{"name":"macos","_id":"ckutx984e00l3018o3uvo4vr7"},{"name":"mount","_id":"ckutx984e00l6018oervw94i4"},{"name":"socket","_id":"ckutx984f00l9018ofw7h9th4"},{"name":"http","_id":"ckutx984f00lc018o0n1bgdqh"}]}}